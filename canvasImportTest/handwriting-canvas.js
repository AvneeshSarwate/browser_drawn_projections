var HandwritingCanvas=function(Pi){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function br(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const At={},Je=[],me=()=>{},Xc=()=>!1,Ti=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Sr=t=>t.startsWith("onUpdate:"),Ut=Object.assign,xr=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Jc=Object.prototype.hasOwnProperty,Tt=(t,e)=>Jc.call(t,e),gt=Array.isArray,Qe=t=>gn(t)==="[object Map]",ki=t=>gn(t)==="[object Set]",Ws=t=>gn(t)==="[object Date]",mt=t=>typeof t=="function",Ft=t=>typeof t=="string",ye=t=>typeof t=="symbol",Mt=t=>t!==null&&typeof t=="object",$s=t=>(Mt(t)||mt(t))&&mt(t.then)&&mt(t.catch),js=Object.prototype.toString,gn=t=>js.call(t),Qc=t=>gn(t).slice(8,-1),Ai=t=>gn(t)==="[object Object]",wr=t=>Ft(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,pn=br(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ri=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Zc=/-(\w)/g,he=Ri(t=>t.replace(Zc,(e,n)=>n?n.toUpperCase():"")),th=/\B([A-Z])/g,ne=Ri(t=>t.replace(th,"-$1").toLowerCase()),qs=Ri(t=>t.charAt(0).toUpperCase()+t.slice(1)),Cr=Ri(t=>t?`on${qs(t)}`:""),De=(t,e)=>!Object.is(t,e),Ei=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Ks=(t,e,n,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:n})},Mi=t=>{const e=parseFloat(t);return isNaN(e)?t:e},Ys=t=>{const e=Ft(t)?Number(t):NaN;return isNaN(e)?t:e};let Xs;const Js=()=>Xs||(Xs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Be(t){if(gt(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],s=Ft(i)?rh(i):Be(i);if(s)for(const r in s)e[r]=s[r]}return e}else if(Ft(t)||Mt(t))return t}const eh=/;(?![^(]*\))/g,nh=/:([^]+)/,ih=/\/\*[^]*?\*\//g;function rh(t){const e={};return t.replace(ih,"").split(eh).forEach(n=>{if(n){const i=n.split(nh);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function we(t){let e="";if(Ft(t))e=t;else if(gt(t))for(let n=0;n<t.length;n++){const i=we(t[n]);i&&(e+=i+" ")}else if(Mt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const sh=br("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Qs(t){return!!t||t===""}function oh(t,e){if(t.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<t.length;i++)n=Fi(t[i],e[i]);return n}function Fi(t,e){if(t===e)return!0;let n=Ws(t),i=Ws(e);if(n||i)return n&&i?t.getTime()===e.getTime():!1;if(n=ye(t),i=ye(e),n||i)return t===e;if(n=gt(t),i=gt(e),n||i)return n&&i?oh(t,e):!1;if(n=Mt(t),i=Mt(e),n||i){if(!n||!i)return!1;const s=Object.keys(t).length,r=Object.keys(e).length;if(s!==r)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Fi(t[o],e[o]))return!1}}return String(t)===String(e)}function ah(t,e){return t.findIndex(n=>Fi(n,e))}const Zs=t=>!!(t&&t.__v_isRef===!0),ie=t=>Ft(t)?t:t==null?"":gt(t)||Mt(t)&&(t.toString===js||!mt(t.toString))?Zs(t)?ie(t.value):JSON.stringify(t,to,2):String(t),to=(t,e)=>Zs(e)?to(t,e.value):Qe(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,s],r)=>(n[Pr(i,r)+" =>"]=s,n),{})}:ki(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Pr(n))}:ye(e)?Pr(e):Mt(e)&&!gt(e)&&!Ai(e)?String(e):e,Pr=(t,e="")=>{var n;return ye(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Zt;class lh{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Zt,!e&&Zt&&(this.index=(Zt.scopes||(Zt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Zt;try{return Zt=this,e()}finally{Zt=n}}}on(){Zt=this}off(){Zt=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function ch(){return Zt}let Et;const Tr=new WeakSet;class eo{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Zt&&Zt.active&&Zt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Tr.has(this)&&(Tr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||io(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,lo(this),ro(this);const e=Et,n=de;Et=this,de=!0;try{return this.fn()}finally{so(this),Et=e,de=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Er(e);this.deps=this.depsTail=void 0,lo(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Tr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Rr(this)&&this.run()}get dirty(){return Rr(this)}}let no=0,mn,yn;function io(t,e=!1){if(t.flags|=8,e){t.next=yn,yn=t;return}t.next=mn,mn=t}function kr(){no++}function Ar(){if(--no>0)return;if(yn){let e=yn;for(yn=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;mn;){let e=mn;for(mn=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){t||(t=i)}e=n}}if(t)throw t}function ro(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function so(t){let e,n=t.depsTail,i=n;for(;i;){const s=i.prevDep;i.version===-1?(i===n&&(n=s),Er(i),hh(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}t.deps=e,t.depsTail=n}function Rr(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(oo(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function oo(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===_n))return;t.globalVersion=_n;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!Rr(t)){t.flags&=-3;return}const n=Et,i=de;Et=t,de=!0;try{ro(t);const s=t.fn(t._value);(e.version===0||De(s,t._value))&&(t._value=s,e.version++)}catch(s){throw e.version++,s}finally{Et=n,de=i,so(t),t.flags&=-3}}function Er(t,e=!1){const{dep:n,prevSub:i,nextSub:s}=t;if(i&&(i.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=i,t.nextSub=void 0),n.subs===t&&(n.subs=i),!n.subs&&n.computed){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)Er(r,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function hh(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let de=!0;const ao=[];function Ce(){ao.push(de),de=!1}function Pe(){const t=ao.pop();de=t===void 0?!0:t}function lo(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Et;Et=void 0;try{e()}finally{Et=n}}}let _n=0;class dh{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Mr{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Et||!de||Et===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Et)n=this.activeLink=new dh(Et,this),Et.deps?(n.prevDep=Et.depsTail,Et.depsTail.nextDep=n,Et.depsTail=n):Et.deps=Et.depsTail=n,co(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=Et.depsTail,n.nextDep=void 0,Et.depsTail.nextDep=n,Et.depsTail=n,Et.deps===n&&(Et.deps=i)}return n}trigger(e){this.version++,_n++,this.notify(e)}notify(e){kr();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Ar()}}}function co(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)co(i)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Fr=new WeakMap,He=Symbol(""),Dr=Symbol(""),vn=Symbol("");function zt(t,e,n){if(de&&Et){let i=Fr.get(t);i||Fr.set(t,i=new Map);let s=i.get(n);s||(i.set(n,s=new Mr),s.map=i,s.key=n),s.track()}}function Te(t,e,n,i,s,r){const o=Fr.get(t);if(!o){_n++;return}const a=l=>{l&&l.trigger()};if(kr(),e==="clear")o.forEach(a);else{const l=gt(t),c=l&&wr(n);if(l&&n==="length"){const h=Number(i);o.forEach((m,g)=>{(g==="length"||g===vn||!ye(g)&&g>=h)&&a(m)})}else switch(n!==void 0&&a(o.get(n)),c&&a(o.get(vn)),e){case"add":l?c&&a(o.get("length")):(a(o.get(He)),Qe(t)&&a(o.get(Dr)));break;case"delete":l||(a(o.get(He)),Qe(t)&&a(o.get(Dr)));break;case"set":Qe(t)&&a(o.get(He));break}}Ar()}function Ze(t){const e=wt(t);return e===t?e:(zt(e,"iterate",vn),re(t)?e:e.map(Wt))}function Di(t){return zt(t=wt(t),"iterate",vn),t}const uh={__proto__:null,[Symbol.iterator](){return Nr(this,Symbol.iterator,Wt)},concat(...t){return Ze(this).concat(...t.map(e=>gt(e)?Ze(e):e))},entries(){return Nr(this,"entries",t=>(t[1]=Wt(t[1]),t))},every(t,e){return ke(this,"every",t,e,void 0,arguments)},filter(t,e){return ke(this,"filter",t,e,n=>n.map(Wt),arguments)},find(t,e){return ke(this,"find",t,e,Wt,arguments)},findIndex(t,e){return ke(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return ke(this,"findLast",t,e,Wt,arguments)},findLastIndex(t,e){return ke(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return ke(this,"forEach",t,e,void 0,arguments)},includes(...t){return Or(this,"includes",t)},indexOf(...t){return Or(this,"indexOf",t)},join(t){return Ze(this).join(t)},lastIndexOf(...t){return Or(this,"lastIndexOf",t)},map(t,e){return ke(this,"map",t,e,void 0,arguments)},pop(){return bn(this,"pop")},push(...t){return bn(this,"push",t)},reduce(t,...e){return ho(this,"reduce",t,e)},reduceRight(t,...e){return ho(this,"reduceRight",t,e)},shift(){return bn(this,"shift")},some(t,e){return ke(this,"some",t,e,void 0,arguments)},splice(...t){return bn(this,"splice",t)},toReversed(){return Ze(this).toReversed()},toSorted(t){return Ze(this).toSorted(t)},toSpliced(...t){return Ze(this).toSpliced(...t)},unshift(...t){return bn(this,"unshift",t)},values(){return Nr(this,"values",Wt)}};function Nr(t,e,n){const i=Di(t),s=i[e]();return i!==t&&!re(t)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.value&&(r.value=n(r.value)),r}),s}const fh=Array.prototype;function ke(t,e,n,i,s,r){const o=Di(t),a=o!==t&&!re(t),l=o[e];if(l!==fh[e]){const m=l.apply(t,r);return a?Wt(m):m}let c=n;o!==t&&(a?c=function(m,g){return n.call(this,Wt(m),g,t)}:n.length>2&&(c=function(m,g){return n.call(this,m,g,t)}));const h=l.call(o,c,i);return a&&s?s(h):h}function ho(t,e,n,i){const s=Di(t);let r=n;return s!==t&&(re(t)?n.length>3&&(r=function(o,a,l){return n.call(this,o,a,l,t)}):r=function(o,a,l){return n.call(this,o,Wt(a),l,t)}),s[e](r,...i)}function Or(t,e,n){const i=wt(t);zt(i,"iterate",vn);const s=i[e](...n);return(s===-1||s===!1)&&Ir(n[0])?(n[0]=wt(n[0]),i[e](...n)):s}function bn(t,e,n=[]){Ce(),kr();const i=wt(t)[e].apply(t,n);return Ar(),Pe(),i}const gh=br("__proto__,__v_isRef,__isVue"),uo=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ye));function ph(t){ye(t)||(t=String(t));const e=wt(this);return zt(e,"has",t),e.hasOwnProperty(t)}class fo{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,i){const s=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return r;if(n==="__v_raw")return i===(s?r?wo:xo:r?So:bo).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=gt(e);if(!s){let l;if(o&&(l=uh[n]))return l;if(n==="hasOwnProperty")return ph}const a=Reflect.get(e,n,Bt(e)?e:i);return(ye(n)?uo.has(n):gh(n))||(s||zt(e,"get",n),r)?a:Bt(a)?o&&wr(n)?a:a.value:Mt(a)?s?Po(a):Lr(a):a}}class go extends fo{constructor(e=!1){super(!1,e)}set(e,n,i,s){let r=e[n];if(!this._isShallow){const l=Ve(r);if(!re(i)&&!Ve(i)&&(r=wt(r),i=wt(i)),!gt(e)&&Bt(r)&&!Bt(i))return l?!1:(r.value=i,!0)}const o=gt(e)&&wr(n)?Number(n)<e.length:Tt(e,n),a=Reflect.set(e,n,i,Bt(e)?e:s);return e===wt(s)&&(o?De(i,r)&&Te(e,"set",n,i):Te(e,"add",n,i)),a}deleteProperty(e,n){const i=Tt(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&i&&Te(e,"delete",n,void 0),s}has(e,n){const i=Reflect.has(e,n);return(!ye(n)||!uo.has(n))&&zt(e,"has",n),i}ownKeys(e){return zt(e,"iterate",gt(e)?"length":He),Reflect.ownKeys(e)}}class po extends fo{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const mh=new go,yh=new po,_h=new go(!0),vh=new po(!0),Gr=t=>t,Ni=t=>Reflect.getPrototypeOf(t);function Oi(t,e,n=!1,i=!1){t=t.__v_raw;const s=wt(t),r=wt(e);n||(De(e,r)&&zt(s,"get",e),zt(s,"get",r));const{has:o}=Ni(s),a=i?Gr:n?Ur:Wt;if(o.call(s,e))return a(t.get(e));if(o.call(s,r))return a(t.get(r));t!==s&&t.get(e)}function Gi(t,e=!1){const n=this.__v_raw,i=wt(n),s=wt(t);return e||(De(t,s)&&zt(i,"has",t),zt(i,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function Li(t,e=!1){return t=t.__v_raw,!e&&zt(wt(t),"iterate",He),Reflect.get(t,"size",t)}function mo(t,e=!1){!e&&!re(t)&&!Ve(t)&&(t=wt(t));const n=wt(this);return Ni(n).has.call(n,t)||(n.add(t),Te(n,"add",t,t)),this}function yo(t,e,n=!1){!n&&!re(e)&&!Ve(e)&&(e=wt(e));const i=wt(this),{has:s,get:r}=Ni(i);let o=s.call(i,t);o||(t=wt(t),o=s.call(i,t));const a=r.call(i,t);return i.set(t,e),o?De(e,a)&&Te(i,"set",t,e):Te(i,"add",t,e),this}function _o(t){const e=wt(this),{has:n,get:i}=Ni(e);let s=n.call(e,t);s||(t=wt(t),s=n.call(e,t)),i&&i.call(e,t);const r=e.delete(t);return s&&Te(e,"delete",t,void 0),r}function vo(){const t=wt(this),e=t.size!==0,n=t.clear();return e&&Te(t,"clear",void 0,void 0),n}function Ii(t,e){return function(i,s){const r=this,o=r.__v_raw,a=wt(o),l=e?Gr:t?Ur:Wt;return!t&&zt(a,"iterate",He),o.forEach((c,h)=>i.call(s,l(c),l(h),r))}}function Ui(t,e,n){return function(...i){const s=this.__v_raw,r=wt(s),o=Qe(r),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=s[t](...i),h=n?Gr:e?Ur:Wt;return!e&&zt(r,"iterate",l?Dr:He),{next(){const{value:m,done:g}=c.next();return g?{value:m,done:g}:{value:a?[h(m[0]),h(m[1])]:h(m),done:g}},[Symbol.iterator](){return this}}}}function Ne(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function bh(){const t={get(r){return Oi(this,r)},get size(){return Li(this)},has:Gi,add:mo,set:yo,delete:_o,clear:vo,forEach:Ii(!1,!1)},e={get(r){return Oi(this,r,!1,!0)},get size(){return Li(this)},has:Gi,add(r){return mo.call(this,r,!0)},set(r,o){return yo.call(this,r,o,!0)},delete:_o,clear:vo,forEach:Ii(!1,!0)},n={get(r){return Oi(this,r,!0)},get size(){return Li(this,!0)},has(r){return Gi.call(this,r,!0)},add:Ne("add"),set:Ne("set"),delete:Ne("delete"),clear:Ne("clear"),forEach:Ii(!0,!1)},i={get(r){return Oi(this,r,!0,!0)},get size(){return Li(this,!0)},has(r){return Gi.call(this,r,!0)},add:Ne("add"),set:Ne("set"),delete:Ne("delete"),clear:Ne("clear"),forEach:Ii(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=Ui(r,!1,!1),n[r]=Ui(r,!0,!1),e[r]=Ui(r,!1,!0),i[r]=Ui(r,!0,!0)}),[t,n,e,i]}const[Sh,xh,wh,Ch]=bh();function Bi(t,e){const n=e?t?Ch:wh:t?xh:Sh;return(i,s,r)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?i:Reflect.get(Tt(n,s)&&s in i?n:i,s,r)}const Ph={get:Bi(!1,!1)},Th={get:Bi(!1,!0)},kh={get:Bi(!0,!1)},Ah={get:Bi(!0,!0)},bo=new WeakMap,So=new WeakMap,xo=new WeakMap,wo=new WeakMap;function Rh(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Eh(t){return t.__v_skip||!Object.isExtensible(t)?0:Rh(Qc(t))}function Lr(t){return Ve(t)?t:Hi(t,!1,mh,Ph,bo)}function Co(t){return Hi(t,!1,_h,Th,So)}function Po(t){return Hi(t,!0,yh,kh,xo)}function Hg(t){return Hi(t,!0,vh,Ah,wo)}function Hi(t,e,n,i,s){if(!Mt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=s.get(t);if(r)return r;const o=Eh(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return s.set(t,a),a}function tn(t){return Ve(t)?tn(t.__v_raw):!!(t&&t.__v_isReactive)}function Ve(t){return!!(t&&t.__v_isReadonly)}function re(t){return!!(t&&t.__v_isShallow)}function Ir(t){return t?!!t.__v_raw:!1}function wt(t){const e=t&&t.__v_raw;return e?wt(e):t}function Mh(t){return!Tt(t,"__v_skip")&&Object.isExtensible(t)&&Ks(t,"__v_skip",!0),t}const Wt=t=>Mt(t)?Lr(t):t,Ur=t=>Mt(t)?Po(t):t;function Bt(t){return t?t.__v_isRef===!0:!1}function Rt(t){return To(t,!1)}function Fh(t){return To(t,!0)}function To(t,e){return Bt(t)?t:new Dh(t,e)}class Dh{constructor(e,n){this.dep=new Mr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:wt(e),this._value=n?e:Wt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,i=this.__v_isShallow||re(e)||Ve(e);e=i?e:wt(e),De(e,n)&&(this._rawValue=e,this._value=i?e:Wt(e),this.dep.trigger())}}function dt(t){return Bt(t)?t.value:t}const Nh={get:(t,e,n)=>e==="__v_raw"?t:dt(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const s=t[e];return Bt(s)&&!Bt(n)?(s.value=n,!0):Reflect.set(t,e,n,i)}};function ko(t){return tn(t)?t:new Proxy(t,Nh)}class Oh{constructor(e,n,i){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Mr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=_n-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Et!==this)return io(this,!0),!0}get value(){const e=this.dep.track();return oo(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Gh(t,e,n=!1){let i,s;return mt(t)?i=t:(i=t.get,s=t.set),new Oh(i,s,n)}const Vi={},zi=new WeakMap;let ze;function Lh(t,e=!1,n=ze){if(n){let i=zi.get(n);i||zi.set(n,i=[]),i.push(t)}}function Ih(t,e,n=At){const{immediate:i,deep:s,once:r,scheduler:o,augmentJob:a,call:l}=n,c=y=>s?y:re(y)||s===!1||s===0?Ae(y,1):Ae(y);let h,m,g,u,f=!1,_=!1;if(Bt(t)?(m=()=>t.value,f=re(t)):tn(t)?(m=()=>c(t),f=!0):gt(t)?(_=!0,f=t.some(y=>tn(y)||re(y)),m=()=>t.map(y=>{if(Bt(y))return y.value;if(tn(y))return c(y);if(mt(y))return l?l(y,2):y()})):mt(t)?e?m=l?()=>l(t,2):t:m=()=>{if(g){Ce();try{g()}finally{Pe()}}const y=ze;ze=h;try{return l?l(t,3,[u]):t(u)}finally{ze=y}}:m=me,e&&s){const y=m,b=s===!0?1/0:s;m=()=>Ae(y(),b)}const S=ch(),C=()=>{h.stop(),S&&xr(S.effects,h)};if(r&&e){const y=e;e=(...b)=>{y(...b),C()}}let p=_?new Array(t.length).fill(Vi):Vi;const d=y=>{if(!(!(h.flags&1)||!h.dirty&&!y))if(e){const b=h.run();if(s||f||(_?b.some((k,D)=>De(k,p[D])):De(b,p))){g&&g();const k=ze;ze=h;try{const D=[b,p===Vi?void 0:_&&p[0]===Vi?[]:p,u];l?l(e,3,D):e(...D),p=b}finally{ze=k}}}else h.run()};return a&&a(d),h=new eo(m),h.scheduler=o?()=>o(d,!1):d,u=y=>Lh(y,!1,h),g=h.onStop=()=>{const y=zi.get(h);if(y){if(l)l(y,4);else for(const b of y)b();zi.delete(h)}},e?i?d(!0):p=h.run():o?o(d.bind(null,!0),!0):h.run(),C.pause=h.pause.bind(h),C.resume=h.resume.bind(h),C.stop=C,C}function Ae(t,e=1/0,n){if(e<=0||!Mt(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,Bt(t))Ae(t.value,e,n);else if(gt(t))for(let i=0;i<t.length;i++)Ae(t[i],e,n);else if(ki(t)||Qe(t))t.forEach(i=>{Ae(i,e,n)});else if(Ai(t)){for(const i in t)Ae(t[i],e,n);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&Ae(t[i],e,n)}return t}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Sn=[];let Br=!1;function Vg(t,...e){if(Br)return;Br=!0,Ce();const n=Sn.length?Sn[Sn.length-1].component:null,i=n&&n.appContext.config.warnHandler,s=Uh();if(i)en(i,n,11,[t+e.map(r=>{var o,a;return(a=(o=r.toString)==null?void 0:o.call(r))!=null?a:JSON.stringify(r)}).join(""),n&&n.proxy,s.map(({vnode:r})=>`at <${xa(n,r.type)}>`).join(`
`),s]);else{const r=[`[Vue warn]: ${t}`,...e];s.length&&r.push(`
`,...Bh(s)),console.warn(...r)}Pe(),Br=!1}function Uh(){let t=Sn[Sn.length-1];if(!t)return[];const e=[];for(;t;){const n=e[0];n&&n.vnode===t?n.recurseCount++:e.push({vnode:t,recurseCount:0});const i=t.component&&t.component.parent;t=i&&i.vnode}return e}function Bh(t){const e=[];return t.forEach((n,i)=>{e.push(...i===0?[]:[`
`],...Hh(n))}),e}function Hh({vnode:t,recurseCount:e}){const n=e>0?`... (${e} recursive calls)`:"",i=t.component?t.component.parent==null:!1,s=` at <${xa(t.component,t.type,i)}`,r=">"+n;return t.props?[s,...Vh(t.props),r]:[s+r]}function Vh(t){const e=[],n=Object.keys(t);return n.slice(0,3).forEach(i=>{e.push(...Ao(i,t[i]))}),n.length>3&&e.push(" ..."),e}function Ao(t,e,n){return Ft(e)?(e=JSON.stringify(e),n?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?n?e:[`${t}=${e}`]:Bt(e)?(e=Ao(t,wt(e.value),!0),n?e:[`${t}=Ref<`,e,">"]):mt(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=wt(e),n?e:[`${t}=`,e])}function en(t,e,n,i){try{return i?t(...i):t()}catch(s){Wi(s,e,n)}}function _e(t,e,n,i){if(mt(t)){const s=en(t,e,n,i);return s&&$s(s)&&s.catch(r=>{Wi(r,e,n)}),s}if(gt(t)){const s=[];for(let r=0;r<t.length;r++)s.push(_e(t[r],e,n,i));return s}}function Wi(t,e,n,i=!0){const s=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||At;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let m=0;m<h.length;m++)if(h[m](t,l,c)===!1)return}a=a.parent}if(r){Ce(),en(r,null,10,[t,l,c]),Pe();return}}zh(t,n,s,i,o)}function zh(t,e,n,i=!0,s=!1){if(s)throw t;console.error(t)}const $t=[];let ve=-1;const nn=[];let Oe=null,rn=0;const Ro=Promise.resolve();let $i=null;function Hr(t){const e=$i||Ro;return t?e.then(this?t.bind(this):t):e}function Wh(t){let e=ve+1,n=$t.length;for(;e<n;){const i=e+n>>>1,s=$t[i],r=xn(s);r<t||r===t&&s.flags&2?e=i+1:n=i}return e}function Vr(t){if(!(t.flags&1)){const e=xn(t),n=$t[$t.length-1];!n||!(t.flags&2)&&e>=xn(n)?$t.push(t):$t.splice(Wh(e),0,t),t.flags|=1,Eo()}}function Eo(){$i||($i=Ro.then(Do))}function $h(t){gt(t)?nn.push(...t):Oe&&t.id===-1?Oe.splice(rn+1,0,t):t.flags&1||(nn.push(t),t.flags|=1),Eo()}function Mo(t,e,n=ve+1){for(;n<$t.length;n++){const i=$t[n];if(i&&i.flags&2){if(t&&i.id!==t.uid)continue;$t.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Fo(t){if(nn.length){const e=[...new Set(nn)].sort((n,i)=>xn(n)-xn(i));if(nn.length=0,Oe){Oe.push(...e);return}for(Oe=e,rn=0;rn<Oe.length;rn++){const n=Oe[rn];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Oe=null,rn=0}}const xn=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Do(t){try{for(ve=0;ve<$t.length;ve++){const e=$t[ve];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),en(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ve<$t.length;ve++){const e=$t[ve];e&&(e.flags&=-2)}ve=-1,$t.length=0,Fo(),$i=null,($t.length||nn.length)&&Do()}}let se=null,No=null;function ji(t){const e=se;return se=t,No=t&&t.type.__scopeId||null,e}function jh(t,e=se,n){if(!e||t._n)return t;const i=(...s)=>{i._d&&fa(-1);const r=ji(e);let o;try{o=t(...s)}finally{ji(r),i._d&&fa(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Oo(t,e){if(se===null)return t;const n=nr(se),i=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[r,o,a,l=At]=e[s];r&&(mt(r)&&(r={mounted:r,updated:r}),r.deep&&Ae(o),i.push({dir:r,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function We(t,e,n,i){const s=t.dirs,r=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];r&&(a.oldValue=r[o].value);let l=a.dir[i];l&&(Ce(),_e(l,n,8,[t.el,a,t,e]),Pe())}}const qh=Symbol("_vte"),Kh=t=>t.__isTeleport;function zr(t,e){t.shapeFlag&6&&t.component?(t.transition=e,zr(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function sn(t,e){return mt(t)?Ut({name:t.name},e,{setup:t}):t}function Go(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Wr(t,e,n,i,s=!1){if(gt(t)){t.forEach((f,_)=>Wr(f,e&&(gt(e)?e[_]:e),n,i,s));return}if(wn(i)&&!s)return;const r=i.shapeFlag&4?nr(i.component):i.el,o=s?null:r,{i:a,r:l}=t,c=e&&e.r,h=a.refs===At?a.refs={}:a.refs,m=a.setupState,g=wt(m),u=m===At?()=>!1:f=>Tt(g,f);if(c!=null&&c!==l&&(Ft(c)?(h[c]=null,u(c)&&(m[c]=null)):Bt(c)&&(c.value=null)),mt(l))en(l,a,12,[o,h]);else{const f=Ft(l),_=Bt(l);if(f||_){const S=()=>{if(t.f){const C=f?u(l)?m[l]:h[l]:l.value;s?gt(C)&&xr(C,r):gt(C)?C.includes(r)||C.push(r):f?(h[l]=[r],u(l)&&(m[l]=h[l])):(l.value=[r],t.k&&(h[t.k]=l.value))}else f?(h[l]=o,u(l)&&(m[l]=o)):_&&(l.value=o,t.k&&(h[t.k]=o))};o?(S.id=-1,te(S,n)):S()}}}const wn=t=>!!t.type.__asyncLoader,Lo=t=>t.type.__isKeepAlive;function Yh(t,e){Io(t,"a",e)}function Xh(t,e){Io(t,"da",e)}function Io(t,e,n=Yt){const i=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(qi(e,i,n),n){let s=n.parent;for(;s&&s.parent;)Lo(s.parent.vnode)&&Jh(i,e,n,s),s=s.parent}}function Jh(t,e,n,i){const s=qi(e,t,i,!0);Cn(()=>{xr(i[e],s)},n)}function qi(t,e,n=Yt,i=!1){if(n){const s=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{Ce();const a=En(n),l=_e(e,n,t,o);return a(),Pe(),l});return i?s.unshift(r):s.push(r),r}}const Re=t=>(e,n=Yt)=>{(!er||t==="sp")&&qi(t,(...i)=>e(...i),n)},Qh=Re("bm"),Uo=Re("m"),Zh=Re("bu"),td=Re("u"),ed=Re("bum"),Cn=Re("um"),nd=Re("sp"),id=Re("rtg"),rd=Re("rtc");function sd(t,e=Yt){qi("ec",t,e)}const od=Symbol.for("v-ndc");function Bo(t,e,n,i){let s;const r=n,o=gt(t);if(o||Ft(t)){const a=o&&tn(t);let l=!1;a&&(l=!re(t),t=Di(t)),s=new Array(t.length);for(let c=0,h=t.length;c<h;c++)s[c]=e(l?Wt(t[c]):t[c],c,void 0,r)}else if(typeof t=="number"){s=new Array(t);for(let a=0;a<t;a++)s[a]=e(a+1,a,void 0,r)}else if(Mt(t))if(t[Symbol.iterator])s=Array.from(t,(a,l)=>e(a,l,void 0,r));else{const a=Object.keys(t);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];s[l]=e(t[h],h,l,r)}}else s=[];return s}const $r=t=>t?va(t)?nr(t):$r(t.parent):null,Pn=Ut(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>$r(t.parent),$root:t=>$r(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Wo(t),$forceUpdate:t=>t.f||(t.f=()=>{Vr(t.update)}),$nextTick:t=>t.n||(t.n=Hr.bind(t.proxy)),$watch:t=>Ad.bind(t)}),jr=(t,e)=>t!==At&&!t.__isScriptSetup&&Tt(t,e),ad={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:i,data:s,props:r,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const u=o[e];if(u!==void 0)switch(u){case 1:return i[e];case 2:return s[e];case 4:return n[e];case 3:return r[e]}else{if(jr(i,e))return o[e]=1,i[e];if(s!==At&&Tt(s,e))return o[e]=2,s[e];if((c=t.propsOptions[0])&&Tt(c,e))return o[e]=3,r[e];if(n!==At&&Tt(n,e))return o[e]=4,n[e];qr&&(o[e]=0)}}const h=Pn[e];let m,g;if(h)return e==="$attrs"&&zt(t.attrs,"get",""),h(t);if((m=a.__cssModules)&&(m=m[e]))return m;if(n!==At&&Tt(n,e))return o[e]=4,n[e];if(g=l.config.globalProperties,Tt(g,e))return g[e]},set({_:t},e,n){const{data:i,setupState:s,ctx:r}=t;return jr(s,e)?(s[e]=n,!0):i!==At&&Tt(i,e)?(i[e]=n,!0):Tt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:s,propsOptions:r}},o){let a;return!!n[o]||t!==At&&Tt(t,o)||jr(e,o)||(a=r[0])&&Tt(a,o)||Tt(i,o)||Tt(Pn,o)||Tt(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Tt(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Ho(t){return gt(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let qr=!0;function ld(t){const e=Wo(t),n=t.proxy,i=t.ctx;qr=!1,e.beforeCreate&&Vo(e.beforeCreate,t,"bc");const{data:s,computed:r,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:m,mounted:g,beforeUpdate:u,updated:f,activated:_,deactivated:S,beforeDestroy:C,beforeUnmount:p,destroyed:d,unmounted:y,render:b,renderTracked:k,renderTriggered:D,errorCaptured:x,serverPrefetch:w,expose:T,inheritAttrs:M,components:G,directives:I,filters:B}=e;if(c&&cd(c,i,null),o)for(const v in o){const P=o[v];mt(P)&&(i[v]=P.bind(n))}if(s){const v=s.call(n,n);Mt(v)&&(t.data=Lr(v))}if(qr=!0,r)for(const v in r){const P=r[v],E=mt(P)?P.bind(n,n):mt(P.get)?P.get.bind(n,n):me,A=!mt(P)&&mt(P.set)?P.set.bind(n):me,O=Gt({get:E,set:A});Object.defineProperty(i,v,{enumerable:!0,configurable:!0,get:()=>O.value,set:j=>O.value=j})}if(a)for(const v in a)zo(a[v],i,n,v);if(l){const v=mt(l)?l.call(n):l;Reflect.ownKeys(v).forEach(P=>{pd(P,v[P])})}h&&Vo(h,t,"c");function X(v,P){gt(P)?P.forEach(E=>v(E.bind(n))):P&&v(P.bind(n))}if(X(Qh,m),X(Uo,g),X(Zh,u),X(td,f),X(Yh,_),X(Xh,S),X(sd,x),X(rd,k),X(id,D),X(ed,p),X(Cn,y),X(nd,w),gt(T))if(T.length){const v=t.exposed||(t.exposed={});T.forEach(P=>{Object.defineProperty(v,P,{get:()=>n[P],set:E=>n[P]=E})})}else t.exposed||(t.exposed={});b&&t.render===me&&(t.render=b),M!=null&&(t.inheritAttrs=M),G&&(t.components=G),I&&(t.directives=I),w&&Go(t)}function cd(t,e,n=me){gt(t)&&(t=Kr(t));for(const i in t){const s=t[i];let r;Mt(s)?"default"in s?r=Yi(s.from||i,s.default,!0):r=Yi(s.from||i):r=Yi(s),Bt(r)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[i]=r}}function Vo(t,e,n){_e(gt(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function zo(t,e,n,i){let s=i.includes(".")?la(n,i):()=>n[i];if(Ft(t)){const r=e[t];mt(r)&&It(s,r)}else if(mt(t))It(s,t.bind(n));else if(Mt(t))if(gt(t))t.forEach(r=>zo(r,e,n,i));else{const r=mt(t.handler)?t.handler.bind(n):e[t.handler];mt(r)&&It(s,r,t)}}function Wo(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,a=r.get(e);let l;return a?l=a:!s.length&&!n&&!i?l=e:(l={},s.length&&s.forEach(c=>Ki(l,c,o,!0)),Ki(l,e,o)),Mt(e)&&r.set(e,l),l}function Ki(t,e,n,i=!1){const{mixins:s,extends:r}=e;r&&Ki(t,r,n,!0),s&&s.forEach(o=>Ki(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=hd[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const hd={data:$o,props:jo,emits:jo,methods:Tn,computed:Tn,beforeCreate:jt,created:jt,beforeMount:jt,mounted:jt,beforeUpdate:jt,updated:jt,beforeDestroy:jt,beforeUnmount:jt,destroyed:jt,unmounted:jt,activated:jt,deactivated:jt,errorCaptured:jt,serverPrefetch:jt,components:Tn,directives:Tn,watch:ud,provide:$o,inject:dd};function $o(t,e){return e?t?function(){return Ut(mt(t)?t.call(this,this):t,mt(e)?e.call(this,this):e)}:e:t}function dd(t,e){return Tn(Kr(t),Kr(e))}function Kr(t){if(gt(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function jt(t,e){return t?[...new Set([].concat(t,e))]:e}function Tn(t,e){return t?Ut(Object.create(null),t,e):e}function jo(t,e){return t?gt(t)&&gt(e)?[...new Set([...t,...e])]:Ut(Object.create(null),Ho(t),Ho(e??{})):e}function ud(t,e){if(!t)return e;if(!e)return t;const n=Ut(Object.create(null),t);for(const i in e)n[i]=jt(t[i],e[i]);return n}function qo(){return{app:null,config:{isNativeTag:Xc,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let fd=0;function gd(t,e){return function(i,s=null){mt(i)||(i=Ut({},i)),s!=null&&!Mt(s)&&(s=null);const r=qo(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:fd++,_component:i,_props:s,_container:null,_context:r,_instance:null,version:Jd,get config(){return r.config},set config(h){},use(h,...m){return o.has(h)||(h&&mt(h.install)?(o.add(h),h.install(c,...m)):mt(h)&&(o.add(h),h(c,...m))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,m){return m?(r.components[h]=m,c):r.components[h]},directive(h,m){return m?(r.directives[h]=m,c):r.directives[h]},mount(h,m,g){if(!l){const u=c._ceVNode||oe(i,s);return u.appContext=r,g===!0?g="svg":g===!1&&(g=void 0),t(u,h,g),l=!0,c._container=h,h.__vue_app__=c,nr(u.component)}},onUnmount(h){a.push(h)},unmount(){l&&(_e(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(h,m){return r.provides[h]=m,c},runWithContext(h){const m=on;on=c;try{return h()}finally{on=m}}};return c}}let on=null;function pd(t,e){if(Yt){let n=Yt.provides;const i=Yt.parent&&Yt.parent.provides;i===n&&(n=Yt.provides=Object.create(i)),n[t]=e}}function Yi(t,e,n=!1){const i=Yt||se;if(i||on){const s=on?on._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return n&&mt(e)?e.call(i&&i.proxy):e}}const Ko={},Yo=()=>Object.create(Ko),Xo=t=>Object.getPrototypeOf(t)===Ko;function md(t,e,n,i=!1){const s={},r=Yo();t.propsDefaults=Object.create(null),Jo(t,e,s,r);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=i?s:Co(s):t.type.props?t.props=s:t.props=r,t.attrs=r}function yd(t,e,n,i){const{props:s,attrs:r,vnode:{patchFlag:o}}=t,a=wt(s),[l]=t.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let m=0;m<h.length;m++){let g=h[m];if(Xi(t.emitsOptions,g))continue;const u=e[g];if(l)if(Tt(r,g))u!==r[g]&&(r[g]=u,c=!0);else{const f=he(g);s[f]=Yr(l,a,f,u,t,!1)}else u!==r[g]&&(r[g]=u,c=!0)}}}else{Jo(t,e,s,r)&&(c=!0);let h;for(const m in a)(!e||!Tt(e,m)&&((h=ne(m))===m||!Tt(e,h)))&&(l?n&&(n[m]!==void 0||n[h]!==void 0)&&(s[m]=Yr(l,a,m,void 0,t,!0)):delete s[m]);if(r!==a)for(const m in r)(!e||!Tt(e,m))&&(delete r[m],c=!0)}c&&Te(t.attrs,"set","")}function Jo(t,e,n,i){const[s,r]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(pn(l))continue;const c=e[l];let h;s&&Tt(s,h=he(l))?!r||!r.includes(h)?n[h]=c:(a||(a={}))[h]=c:Xi(t.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(r){const l=wt(n),c=a||At;for(let h=0;h<r.length;h++){const m=r[h];n[m]=Yr(s,l,m,c[m],t,!Tt(c,m))}}return o}function Yr(t,e,n,i,s,r){const o=t[n];if(o!=null){const a=Tt(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&mt(l)){const{propsDefaults:c}=s;if(n in c)i=c[n];else{const h=En(s);i=c[n]=l.call(null,e),h()}}else i=l;s.ce&&s.ce._setProp(n,i)}o[0]&&(r&&!a?i=!1:o[1]&&(i===""||i===ne(n))&&(i=!0))}return i}const _d=new WeakMap;function Qo(t,e,n=!1){const i=n?_d:e.propsCache,s=i.get(t);if(s)return s;const r=t.props,o={},a=[];let l=!1;if(!mt(t)){const h=m=>{l=!0;const[g,u]=Qo(m,e,!0);Ut(o,g),u&&a.push(...u)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!r&&!l)return Mt(t)&&i.set(t,Je),Je;if(gt(r))for(let h=0;h<r.length;h++){const m=he(r[h]);Zo(m)&&(o[m]=At)}else if(r)for(const h in r){const m=he(h);if(Zo(m)){const g=r[h],u=o[m]=gt(g)||mt(g)?{type:g}:Ut({},g),f=u.type;let _=!1,S=!0;if(gt(f))for(let C=0;C<f.length;++C){const p=f[C],d=mt(p)&&p.name;if(d==="Boolean"){_=!0;break}else d==="String"&&(S=!1)}else _=mt(f)&&f.name==="Boolean";u[0]=_,u[1]=S,(_||Tt(u,"default"))&&a.push(m)}}const c=[o,a];return Mt(t)&&i.set(t,c),c}function Zo(t){return t[0]!=="$"&&!pn(t)}const ta=t=>t[0]==="_"||t==="$stable",Xr=t=>gt(t)?t.map(be):[be(t)],vd=(t,e,n)=>{if(e._n)return e;const i=jh((...s)=>Xr(e(...s)),n);return i._c=!1,i},ea=(t,e,n)=>{const i=t._ctx;for(const s in t){if(ta(s))continue;const r=t[s];if(mt(r))e[s]=vd(s,r,i);else if(r!=null){const o=Xr(r);e[s]=()=>o}}},na=(t,e)=>{const n=Xr(e);t.slots.default=()=>n},ia=(t,e,n)=>{for(const i in e)(n||i!=="_")&&(t[i]=e[i])},bd=(t,e,n)=>{const i=t.slots=Yo();if(t.vnode.shapeFlag&32){const s=e._;s?(ia(i,e,n),n&&Ks(i,"_",s,!0)):ea(e,i)}else e&&na(t,e)},Sd=(t,e,n)=>{const{vnode:i,slots:s}=t;let r=!0,o=At;if(i.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:ia(s,e,n):(r=!e.$stable,ea(e,s)),o=e}else e&&(na(t,e),o={default:1});if(r)for(const a in s)!ta(a)&&o[a]==null&&delete s[a]},te=Od;function xd(t){return wd(t)}function wd(t,e){const n=Js();n.__VUE__=!0;const{insert:i,remove:s,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:m,nextSibling:g,setScopeId:u=me,insertStaticContent:f}=t,_=(R,N,z,q=null,Y=null,K=null,tt=void 0,rt=null,et=!!N.dynamicChildren)=>{if(R===N)return;R&&!Rn(R,N)&&(q=F(R),j(R,Y,K,!0),R=null),N.patchFlag===-2&&(et=!1,N.dynamicChildren=null);const{type:H,ref:V,shapeFlag:Z}=N;switch(H){case Ji:S(R,N,z,q);break;case je:C(R,N,z,q);break;case Qr:R==null&&p(N,z,q,tt);break;case qt:G(R,N,z,q,Y,K,tt,rt,et);break;default:Z&1?b(R,N,z,q,Y,K,tt,rt,et):Z&6?I(R,N,z,q,Y,K,tt,rt,et):(Z&64||Z&128)&&H.process(R,N,z,q,Y,K,tt,rt,et,it)}V!=null&&Y&&Wr(V,R&&R.ref,K,N||R,!N)},S=(R,N,z,q)=>{if(R==null)i(N.el=a(N.children),z,q);else{const Y=N.el=R.el;N.children!==R.children&&c(Y,N.children)}},C=(R,N,z,q)=>{R==null?i(N.el=l(N.children||""),z,q):N.el=R.el},p=(R,N,z,q)=>{[R.el,R.anchor]=f(R.children,N,z,q,R.el,R.anchor)},d=({el:R,anchor:N},z,q)=>{let Y;for(;R&&R!==N;)Y=g(R),i(R,z,q),R=Y;i(N,z,q)},y=({el:R,anchor:N})=>{let z;for(;R&&R!==N;)z=g(R),s(R),R=z;s(N)},b=(R,N,z,q,Y,K,tt,rt,et)=>{N.type==="svg"?tt="svg":N.type==="math"&&(tt="mathml"),R==null?k(N,z,q,Y,K,tt,rt,et):w(R,N,Y,K,tt,rt,et)},k=(R,N,z,q,Y,K,tt,rt)=>{let et,H;const{props:V,shapeFlag:Z,transition:ot,dirs:lt}=R;if(et=R.el=o(R.type,K,V&&V.is,V),Z&8?h(et,R.children):Z&16&&x(R.children,et,null,q,Y,Jr(R,K),tt,rt),lt&&We(R,null,q,"created"),D(et,R,R.scopeId,tt,q),V){for(const pt in V)pt!=="value"&&!pn(pt)&&r(et,pt,null,V[pt],K,q);"value"in V&&r(et,"value",null,V.value,K),(H=V.onVnodeBeforeMount)&&Se(H,q,R)}lt&&We(R,null,q,"beforeMount");const ht=Cd(Y,ot);ht&&ot.beforeEnter(et),i(et,N,z),((H=V&&V.onVnodeMounted)||ht||lt)&&te(()=>{H&&Se(H,q,R),ht&&ot.enter(et),lt&&We(R,null,q,"mounted")},Y)},D=(R,N,z,q,Y)=>{if(z&&u(R,z),q)for(let K=0;K<q.length;K++)u(R,q[K]);if(Y){let K=Y.subTree;if(N===K||ua(K.type)&&(K.ssContent===N||K.ssFallback===N)){const tt=Y.vnode;D(R,tt,tt.scopeId,tt.slotScopeIds,Y.parent)}}},x=(R,N,z,q,Y,K,tt,rt,et=0)=>{for(let H=et;H<R.length;H++){const V=R[H]=rt?Ge(R[H]):be(R[H]);_(null,V,N,z,q,Y,K,tt,rt)}},w=(R,N,z,q,Y,K,tt)=>{const rt=N.el=R.el;let{patchFlag:et,dynamicChildren:H,dirs:V}=N;et|=R.patchFlag&16;const Z=R.props||At,ot=N.props||At;let lt;if(z&&$e(z,!1),(lt=ot.onVnodeBeforeUpdate)&&Se(lt,z,N,R),V&&We(N,R,z,"beforeUpdate"),z&&$e(z,!0),(Z.innerHTML&&ot.innerHTML==null||Z.textContent&&ot.textContent==null)&&h(rt,""),H?T(R.dynamicChildren,H,rt,z,q,Jr(N,Y),K):tt||P(R,N,rt,null,z,q,Jr(N,Y),K,!1),et>0){if(et&16)M(rt,Z,ot,z,Y);else if(et&2&&Z.class!==ot.class&&r(rt,"class",null,ot.class,Y),et&4&&r(rt,"style",Z.style,ot.style,Y),et&8){const ht=N.dynamicProps;for(let pt=0;pt<ht.length;pt++){const ut=ht[pt],Ct=Z[ut],vt=ot[ut];(vt!==Ct||ut==="value")&&r(rt,ut,Ct,vt,Y,z)}}et&1&&R.children!==N.children&&h(rt,N.children)}else!tt&&H==null&&M(rt,Z,ot,z,Y);((lt=ot.onVnodeUpdated)||V)&&te(()=>{lt&&Se(lt,z,N,R),V&&We(N,R,z,"updated")},q)},T=(R,N,z,q,Y,K,tt)=>{for(let rt=0;rt<N.length;rt++){const et=R[rt],H=N[rt],V=et.el&&(et.type===qt||!Rn(et,H)||et.shapeFlag&70)?m(et.el):z;_(et,H,V,null,q,Y,K,tt,!0)}},M=(R,N,z,q,Y)=>{if(N!==z){if(N!==At)for(const K in N)!pn(K)&&!(K in z)&&r(R,K,N[K],null,Y,q);for(const K in z){if(pn(K))continue;const tt=z[K],rt=N[K];tt!==rt&&K!=="value"&&r(R,K,rt,tt,Y,q)}"value"in z&&r(R,"value",N.value,z.value,Y)}},G=(R,N,z,q,Y,K,tt,rt,et)=>{const H=N.el=R?R.el:a(""),V=N.anchor=R?R.anchor:a("");let{patchFlag:Z,dynamicChildren:ot,slotScopeIds:lt}=N;lt&&(rt=rt?rt.concat(lt):lt),R==null?(i(H,z,q),i(V,z,q),x(N.children||[],z,V,Y,K,tt,rt,et)):Z>0&&Z&64&&ot&&R.dynamicChildren?(T(R.dynamicChildren,ot,z,Y,K,tt,rt),(N.key!=null||Y&&N===Y.subTree)&&ra(R,N,!0)):P(R,N,z,V,Y,K,tt,rt,et)},I=(R,N,z,q,Y,K,tt,rt,et)=>{N.slotScopeIds=rt,R==null?N.shapeFlag&512?Y.ctx.activate(N,z,q,tt,et):B(N,z,q,Y,K,tt,et):L(R,N,et)},B=(R,N,z,q,Y,K,tt)=>{const rt=R.component=Vd(R,q,Y);if(Lo(R)&&(rt.ctx.renderer=it),zd(rt,!1,tt),rt.asyncDep){if(Y&&Y.registerDep(rt,X,tt),!R.el){const et=rt.subTree=oe(je);C(null,et,N,z)}}else X(rt,R,N,z,Y,K,tt)},L=(R,N,z)=>{const q=N.component=R.component;if(Dd(R,N,z))if(q.asyncDep&&!q.asyncResolved){v(q,N,z);return}else q.next=N,q.update();else N.el=R.el,q.vnode=N},X=(R,N,z,q,Y,K,tt)=>{const rt=()=>{if(R.isMounted){let{next:Z,bu:ot,u:lt,parent:ht,vnode:pt}=R;{const yt=sa(R);if(yt){Z&&(Z.el=pt.el,v(R,Z,tt)),yt.asyncDep.then(()=>{R.isUnmounted||rt()});return}}let ut=Z,Ct;$e(R,!1),Z?(Z.el=pt.el,v(R,Z,tt)):Z=pt,ot&&Ei(ot),(Ct=Z.props&&Z.props.onVnodeBeforeUpdate)&&Se(Ct,ht,Z,pt),$e(R,!0);const vt=ha(R),ft=R.subTree;R.subTree=vt,_(ft,vt,m(ft.el),F(ft),R,Y,K),Z.el=vt.el,ut===null&&Nd(R,vt.el),lt&&te(lt,Y),(Ct=Z.props&&Z.props.onVnodeUpdated)&&te(()=>Se(Ct,ht,Z,pt),Y)}else{let Z;const{el:ot,props:lt}=N,{bm:ht,m:pt,parent:ut,root:Ct,type:vt}=R,ft=wn(N);$e(R,!1),ht&&Ei(ht),!ft&&(Z=lt&&lt.onVnodeBeforeMount)&&Se(Z,ut,N),$e(R,!0);{Ct.ce&&Ct.ce._injectChildStyle(vt);const yt=R.subTree=ha(R);_(null,yt,z,q,R,Y,K),N.el=yt.el}if(pt&&te(pt,Y),!ft&&(Z=lt&&lt.onVnodeMounted)){const yt=N;te(()=>Se(Z,ut,yt),Y)}(N.shapeFlag&256||ut&&wn(ut.vnode)&&ut.vnode.shapeFlag&256)&&R.a&&te(R.a,Y),R.isMounted=!0,N=z=q=null}};R.scope.on();const et=R.effect=new eo(rt);R.scope.off();const H=R.update=et.run.bind(et),V=R.job=et.runIfDirty.bind(et);V.i=R,V.id=R.uid,et.scheduler=()=>Vr(V),$e(R,!0),H()},v=(R,N,z)=>{N.component=R;const q=R.vnode.props;R.vnode=N,R.next=null,yd(R,N.props,q,z),Sd(R,N.children,z),Ce(),Mo(R),Pe()},P=(R,N,z,q,Y,K,tt,rt,et=!1)=>{const H=R&&R.children,V=R?R.shapeFlag:0,Z=N.children,{patchFlag:ot,shapeFlag:lt}=N;if(ot>0){if(ot&128){A(H,Z,z,q,Y,K,tt,rt,et);return}else if(ot&256){E(H,Z,z,q,Y,K,tt,rt,et);return}}lt&8?(V&16&&$(H,Y,K),Z!==H&&h(z,Z)):V&16?lt&16?A(H,Z,z,q,Y,K,tt,rt,et):$(H,Y,K,!0):(V&8&&h(z,""),lt&16&&x(Z,z,q,Y,K,tt,rt,et))},E=(R,N,z,q,Y,K,tt,rt,et)=>{R=R||Je,N=N||Je;const H=R.length,V=N.length,Z=Math.min(H,V);let ot;for(ot=0;ot<Z;ot++){const lt=N[ot]=et?Ge(N[ot]):be(N[ot]);_(R[ot],lt,z,null,Y,K,tt,rt,et)}H>V?$(R,Y,K,!0,!1,Z):x(N,z,q,Y,K,tt,rt,et,Z)},A=(R,N,z,q,Y,K,tt,rt,et)=>{let H=0;const V=N.length;let Z=R.length-1,ot=V-1;for(;H<=Z&&H<=ot;){const lt=R[H],ht=N[H]=et?Ge(N[H]):be(N[H]);if(Rn(lt,ht))_(lt,ht,z,null,Y,K,tt,rt,et);else break;H++}for(;H<=Z&&H<=ot;){const lt=R[Z],ht=N[ot]=et?Ge(N[ot]):be(N[ot]);if(Rn(lt,ht))_(lt,ht,z,null,Y,K,tt,rt,et);else break;Z--,ot--}if(H>Z){if(H<=ot){const lt=ot+1,ht=lt<V?N[lt].el:q;for(;H<=ot;)_(null,N[H]=et?Ge(N[H]):be(N[H]),z,ht,Y,K,tt,rt,et),H++}}else if(H>ot)for(;H<=Z;)j(R[H],Y,K,!0),H++;else{const lt=H,ht=H,pt=new Map;for(H=ht;H<=ot;H++){const Nt=N[H]=et?Ge(N[H]):be(N[H]);Nt.key!=null&&pt.set(Nt.key,H)}let ut,Ct=0;const vt=ot-ht+1;let ft=!1,yt=0;const xt=new Array(vt);for(H=0;H<vt;H++)xt[H]=0;for(H=lt;H<=Z;H++){const Nt=R[H];if(Ct>=vt){j(Nt,Y,K,!0);continue}let Vt;if(Nt.key!=null)Vt=pt.get(Nt.key);else for(ut=ht;ut<=ot;ut++)if(xt[ut-ht]===0&&Rn(Nt,N[ut])){Vt=ut;break}Vt===void 0?j(Nt,Y,K,!0):(xt[Vt-ht]=H+1,Vt>=yt?yt=Vt:ft=!0,_(Nt,N[Vt],z,null,Y,K,tt,rt,et),Ct++)}const Lt=ft?Pd(xt):Je;for(ut=Lt.length-1,H=vt-1;H>=0;H--){const Nt=ht+H,Vt=N[Nt],pe=Nt+1<V?N[Nt+1].el:q;xt[H]===0?_(null,Vt,z,pe,Y,K,tt,rt,et):ft&&(ut<0||H!==Lt[ut]?O(Vt,z,pe,2):ut--)}}},O=(R,N,z,q,Y=null)=>{const{el:K,type:tt,transition:rt,children:et,shapeFlag:H}=R;if(H&6){O(R.component.subTree,N,z,q);return}if(H&128){R.suspense.move(N,z,q);return}if(H&64){tt.move(R,N,z,it);return}if(tt===qt){i(K,N,z);for(let Z=0;Z<et.length;Z++)O(et[Z],N,z,q);i(R.anchor,N,z);return}if(tt===Qr){d(R,N,z);return}if(q!==2&&H&1&&rt)if(q===0)rt.beforeEnter(K),i(K,N,z),te(()=>rt.enter(K),Y);else{const{leave:Z,delayLeave:ot,afterLeave:lt}=rt,ht=()=>i(K,N,z),pt=()=>{Z(K,()=>{ht(),lt&&lt()})};ot?ot(K,ht,pt):pt()}else i(K,N,z)},j=(R,N,z,q=!1,Y=!1)=>{const{type:K,props:tt,ref:rt,children:et,dynamicChildren:H,shapeFlag:V,patchFlag:Z,dirs:ot,cacheIndex:lt}=R;if(Z===-2&&(Y=!1),rt!=null&&Wr(rt,null,z,R,!0),lt!=null&&(N.renderCache[lt]=void 0),V&256){N.ctx.deactivate(R);return}const ht=V&1&&ot,pt=!wn(R);let ut;if(pt&&(ut=tt&&tt.onVnodeBeforeUnmount)&&Se(ut,N,R),V&6)st(R.component,z,q);else{if(V&128){R.suspense.unmount(z,q);return}ht&&We(R,null,N,"beforeUnmount"),V&64?R.type.remove(R,N,z,it,q):H&&!H.hasOnce&&(K!==qt||Z>0&&Z&64)?$(H,N,z,!1,!0):(K===qt&&Z&384||!Y&&V&16)&&$(et,N,z),q&&U(R)}(pt&&(ut=tt&&tt.onVnodeUnmounted)||ht)&&te(()=>{ut&&Se(ut,N,R),ht&&We(R,null,N,"unmounted")},z)},U=R=>{const{type:N,el:z,anchor:q,transition:Y}=R;if(N===qt){J(z,q);return}if(N===Qr){y(R);return}const K=()=>{s(z),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(R.shapeFlag&1&&Y&&!Y.persisted){const{leave:tt,delayLeave:rt}=Y,et=()=>tt(z,K);rt?rt(R.el,K,et):et()}else K()},J=(R,N)=>{let z;for(;R!==N;)z=g(R),s(R),R=z;s(N)},st=(R,N,z)=>{const{bum:q,scope:Y,job:K,subTree:tt,um:rt,m:et,a:H}=R;oa(et),oa(H),q&&Ei(q),Y.stop(),K&&(K.flags|=8,j(tt,R,N,z)),rt&&te(rt,N),te(()=>{R.isUnmounted=!0},N),N&&N.pendingBranch&&!N.isUnmounted&&R.asyncDep&&!R.asyncResolved&&R.suspenseId===N.pendingId&&(N.deps--,N.deps===0&&N.resolve())},$=(R,N,z,q=!1,Y=!1,K=0)=>{for(let tt=K;tt<R.length;tt++)j(R[tt],N,z,q,Y)},F=R=>{if(R.shapeFlag&6)return F(R.component.subTree);if(R.shapeFlag&128)return R.suspense.next();const N=g(R.anchor||R.el),z=N&&N[qh];return z?g(z):N};let W=!1;const nt=(R,N,z)=>{R==null?N._vnode&&j(N._vnode,null,null,!0):_(N._vnode||null,R,N,null,null,null,z),N._vnode=R,W||(W=!0,Mo(),Fo(),W=!1)},it={p:_,um:j,m:O,r:U,mt:B,mc:x,pc:P,pbc:T,n:F,o:t};return{render:nt,hydrate:void 0,createApp:gd(nt)}}function Jr({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function $e({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Cd(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function ra(t,e,n=!1){const i=t.children,s=e.children;if(gt(i)&&gt(s))for(let r=0;r<i.length;r++){const o=i[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=Ge(s[r]),a.el=o.el),!n&&a.patchFlag!==-2&&ra(o,a)),a.type===Ji&&(a.el=o.el)}}function Pd(t){const e=t.slice(),n=[0];let i,s,r,o,a;const l=t.length;for(i=0;i<l;i++){const c=t[i];if(c!==0){if(s=n[n.length-1],t[s]<c){e[i]=s,n.push(i);continue}for(r=0,o=n.length-1;r<o;)a=r+o>>1,t[n[a]]<c?r=a+1:o=a;c<t[n[r]]&&(r>0&&(e[i]=n[r-1]),n[r]=i)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}function sa(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:sa(e)}function oa(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Td=Symbol.for("v-scx"),kd=()=>Yi(Td);function It(t,e,n){return aa(t,e,n)}function aa(t,e,n=At){const{immediate:i,deep:s,flush:r,once:o}=n,a=Ut({},n);let l;if(er)if(r==="sync"){const g=kd();l=g.__watcherHandles||(g.__watcherHandles=[])}else if(!e||i)a.once=!0;else{const g=()=>{};return g.stop=me,g.resume=me,g.pause=me,g}const c=Yt;a.call=(g,u,f)=>_e(g,c,u,f);let h=!1;r==="post"?a.scheduler=g=>{te(g,c&&c.suspense)}:r!=="sync"&&(h=!0,a.scheduler=(g,u)=>{u?g():Vr(g)}),a.augmentJob=g=>{e&&(g.flags|=4),h&&(g.flags|=2,c&&(g.id=c.uid,g.i=c))};const m=Ih(t,e,a);return l&&l.push(m),m}function Ad(t,e,n){const i=this.proxy,s=Ft(t)?t.includes(".")?la(i,t):()=>i[t]:t.bind(i,i);let r;mt(e)?r=e:(r=e.handler,n=e);const o=En(this),a=aa(s,r.bind(i),n);return o(),a}function la(t,e){const n=e.split(".");return()=>{let i=t;for(let s=0;s<n.length&&i;s++)i=i[n[s]];return i}}const Rd=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${he(e)}Modifiers`]||t[`${ne(e)}Modifiers`];function Ed(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||At;let s=n;const r=e.startsWith("update:"),o=r&&Rd(i,e.slice(7));o&&(o.trim&&(s=n.map(h=>Ft(h)?h.trim():h)),o.number&&(s=n.map(Mi)));let a,l=i[a=Cr(e)]||i[a=Cr(he(e))];!l&&r&&(l=i[a=Cr(ne(e))]),l&&_e(l,t,6,s);const c=i[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,_e(c,t,6,s)}}function ca(t,e,n=!1){const i=e.emitsCache,s=i.get(t);if(s!==void 0)return s;const r=t.emits;let o={},a=!1;if(!mt(t)){const l=c=>{const h=ca(c,e,!0);h&&(a=!0,Ut(o,h))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(Mt(t)&&i.set(t,null),null):(gt(r)?r.forEach(l=>o[l]=null):Ut(o,r),Mt(t)&&i.set(t,o),o)}function Xi(t,e){return!t||!Ti(e)?!1:(e=e.slice(2).replace(/Once$/,""),Tt(t,e[0].toLowerCase()+e.slice(1))||Tt(t,ne(e))||Tt(t,e))}function zg(){}function ha(t){const{type:e,vnode:n,proxy:i,withProxy:s,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:m,data:g,setupState:u,ctx:f,inheritAttrs:_}=t,S=ji(t);let C,p;try{if(n.shapeFlag&4){const y=s||i,b=y;C=be(c.call(b,y,h,m,u,g,f)),p=a}else{const y=e;C=be(y.length>1?y(m,{attrs:a,slots:o,emit:l}):y(m,null)),p=e.props?a:Md(a)}}catch(y){kn.length=0,Wi(y,t,1),C=oe(je)}let d=C;if(p&&_!==!1){const y=Object.keys(p),{shapeFlag:b}=d;y.length&&b&7&&(r&&y.some(Sr)&&(p=Fd(p,r)),d=an(d,p,!1,!0))}return n.dirs&&(d=an(d,null,!1,!0),d.dirs=d.dirs?d.dirs.concat(n.dirs):n.dirs),n.transition&&zr(d,n.transition),C=d,ji(S),C}const Md=t=>{let e;for(const n in t)(n==="class"||n==="style"||Ti(n))&&((e||(e={}))[n]=t[n]);return e},Fd=(t,e)=>{const n={};for(const i in t)(!Sr(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function Dd(t,e,n){const{props:i,children:s,component:r}=t,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?da(i,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let m=0;m<h.length;m++){const g=h[m];if(o[g]!==i[g]&&!Xi(c,g))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?da(i,o,c):!0:!!o;return!1}function da(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let s=0;s<i.length;s++){const r=i[s];if(e[r]!==t[r]&&!Xi(n,r))return!0}return!1}function Nd({vnode:t,parent:e},n){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=n,e=e.parent;else break}}const ua=t=>t.__isSuspense;function Od(t,e){e&&e.pendingBranch?gt(t)?e.effects.push(...t):e.effects.push(t):$h(t)}const qt=Symbol.for("v-fgt"),Ji=Symbol.for("v-txt"),je=Symbol.for("v-cmt"),Qr=Symbol.for("v-stc"),kn=[];let ee=null;function Pt(t=!1){kn.push(ee=t?null:[])}function Gd(){kn.pop(),ee=kn[kn.length-1]||null}let An=1;function fa(t){An+=t,t<0&&ee&&(ee.hasOnce=!0)}function ga(t){return t.dynamicChildren=An>0?ee||Je:null,Gd(),An>0&&ee&&ee.push(t),t}function kt(t,e,n,i,s,r){return ga(at(t,e,n,i,s,r,!0))}function Qi(t,e,n,i,s){return ga(oe(t,e,n,i,s,!0))}function pa(t){return t?t.__v_isVNode===!0:!1}function Rn(t,e){return t.type===e.type&&t.key===e.key}const ma=({key:t})=>t??null,Zi=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Ft(t)||Bt(t)||mt(t)?{i:se,r:t,k:e,f:!!n}:t:null);function at(t,e=null,n=null,i=0,s=null,r=t===qt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&ma(e),ref:e&&Zi(e),scopeId:No,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:se};return a?(Zr(l,n),r&128&&t.normalize(l)):n&&(l.shapeFlag|=Ft(n)?8:16),An>0&&!o&&ee&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&ee.push(l),l}const oe=Ld;function Ld(t,e=null,n=null,i=0,s=null,r=!1){if((!t||t===od)&&(t=je),pa(t)){const a=an(t,e,!0);return n&&Zr(a,n),An>0&&!r&&ee&&(a.shapeFlag&6?ee[ee.indexOf(t)]=a:ee.push(a)),a.patchFlag=-2,a}if(Xd(t)&&(t=t.__vccOpts),e){e=Id(e);let{class:a,style:l}=e;a&&!Ft(a)&&(e.class=we(a)),Mt(l)&&(Ir(l)&&!gt(l)&&(l=Ut({},l)),e.style=Be(l))}const o=Ft(t)?1:ua(t)?128:Kh(t)?64:Mt(t)?4:mt(t)?2:0;return at(t,e,n,i,s,o,r,!0)}function Id(t){return t?Ir(t)||Xo(t)?Ut({},t):t:null}function an(t,e,n=!1,i=!1){const{props:s,ref:r,patchFlag:o,children:a,transition:l}=t,c=e?Ud(s||{},e):s,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&ma(c),ref:e&&e.ref?n&&r?gt(r)?r.concat(Zi(e)):[r,Zi(e)]:Zi(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==qt?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&an(t.ssContent),ssFallback:t.ssFallback&&an(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&i&&zr(h,l.clone(h)),h}function ya(t=" ",e=0){return oe(Ji,null,t,e)}function Kt(t="",e=!1){return e?(Pt(),Qi(je,null,t)):oe(je,null,t)}function be(t){return t==null||typeof t=="boolean"?oe(je):gt(t)?oe(qt,null,t.slice()):pa(t)?Ge(t):oe(Ji,null,String(t))}function Ge(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:an(t)}function Zr(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(gt(e))n=16;else if(typeof e=="object")if(i&65){const s=e.default;s&&(s._c&&(s._d=!1),Zr(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!Xo(e)?e._ctx=se:s===3&&se&&(se.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else mt(e)?(e={default:e,_ctx:se},n=32):(e=String(e),i&64?(n=16,e=[ya(e)]):n=8);t.children=e,t.shapeFlag|=n}function Ud(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const s in i)if(s==="class")e.class!==i.class&&(e.class=we([e.class,i.class]));else if(s==="style")e.style=Be([e.style,i.style]);else if(Ti(s)){const r=e[s],o=i[s];o&&r!==o&&!(gt(r)&&r.includes(o))&&(e[s]=r?[].concat(r,o):o)}else s!==""&&(e[s]=i[s])}return e}function Se(t,e,n,i=null){_e(t,e,7,[n,i])}const Bd=qo();let Hd=0;function Vd(t,e,n){const i=t.type,s=(e?e.appContext:t.appContext)||Bd,r={uid:Hd++,vnode:t,type:i,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new lh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Qo(i,s),emitsOptions:ca(i,s),emit:null,emitted:null,propsDefaults:At,inheritAttrs:i.inheritAttrs,ctx:At,data:At,props:At,attrs:At,slots:At,refs:At,setupState:At,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=Ed.bind(null,r),t.ce&&t.ce(r),r}let Yt=null,tr,ts;{const t=Js(),e=(n,i)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(i),r=>{s.length>1?s.forEach(o=>o(r)):s[0](r)}};tr=e("__VUE_INSTANCE_SETTERS__",n=>Yt=n),ts=e("__VUE_SSR_SETTERS__",n=>er=n)}const En=t=>{const e=Yt;return tr(t),t.scope.on(),()=>{t.scope.off(),tr(e)}},_a=()=>{Yt&&Yt.scope.off(),tr(null)};function va(t){return t.vnode.shapeFlag&4}let er=!1;function zd(t,e=!1,n=!1){e&&ts(e);const{props:i,children:s}=t.vnode,r=va(t);md(t,i,r,e),bd(t,s,n);const o=r?Wd(t,e):void 0;return e&&ts(!1),o}function Wd(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,ad);const{setup:i}=n;if(i){const s=t.setupContext=i.length>1?jd(t):null,r=En(t);Ce();const o=en(i,t,0,[t.props,s]);if(Pe(),r(),$s(o)){if(wn(t)||Go(t),o.then(_a,_a),e)return o.then(a=>{ba(t,a)}).catch(a=>{Wi(a,t,0)});t.asyncDep=o}else ba(t,o)}else Sa(t)}function ba(t,e,n){mt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Mt(e)&&(t.setupState=ko(e)),Sa(t)}function Sa(t,e,n){const i=t.type;t.render||(t.render=i.render||me);{const s=En(t);Ce();try{ld(t)}finally{Pe(),s()}}}const $d={get(t,e){return zt(t,"get",""),t[e]}};function jd(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,$d),slots:t.slots,emit:t.emit,expose:e}}function nr(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(ko(Mh(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Pn)return Pn[n](t)},has(e,n){return n in e||n in Pn}})):t.proxy}const qd=/(?:^|[-_])(\w)/g,Kd=t=>t.replace(qd,e=>e.toUpperCase()).replace(/[-_]/g,"");function Yd(t,e=!0){return mt(t)?t.displayName||t.name:t.name||e&&t.__name}function xa(t,e,n=!1){let i=Yd(e);if(!i&&e.__file){const s=e.__file.match(/([^/\\]+)\.\w+$/);s&&(i=s[1])}if(!i&&t&&t.parent){const s=r=>{for(const o in r)if(r[o]===e)return o};i=s(t.components||t.parent.type.components)||s(t.appContext.components)}return i?Kd(i):n?"App":"Anonymous"}function Xd(t){return mt(t)&&"__vccOpts"in t}const Gt=(t,e)=>Gh(t,e,er),Jd="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let es;const wa=typeof window<"u"&&window.trustedTypes;if(wa)try{es=wa.createPolicy("vue",{createHTML:t=>t})}catch{}const Ca=es?t=>es.createHTML(t):t=>t,Qd="http://www.w3.org/2000/svg",Zd="http://www.w3.org/1998/Math/MathML",Ee=typeof document<"u"?document:null,Pa=Ee&&Ee.createElement("template"),tu={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const s=e==="svg"?Ee.createElementNS(Qd,t):e==="mathml"?Ee.createElementNS(Zd,t):n?Ee.createElement(t,{is:n}):Ee.createElement(t);return t==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:t=>Ee.createTextNode(t),createComment:t=>Ee.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ee.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,s,r){const o=n?n.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===r||!(s=s.nextSibling)););else{Pa.innerHTML=Ca(i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t);const a=Pa.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},eu=Symbol("_vtc");function nu(t,e,n){const i=t[eu];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Ta=Symbol("_vod"),iu=Symbol("_vsh"),ru=Symbol(""),su=/(^|;)\s*display\s*:/;function ou(t,e,n){const i=t.style,s=Ft(n);let r=!1;if(n&&!s){if(e)if(Ft(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&ir(i,a,"")}else for(const o in e)n[o]==null&&ir(i,o,"");for(const o in n)o==="display"&&(r=!0),ir(i,o,n[o])}else if(s){if(e!==n){const o=i[ru];o&&(n+=";"+o),i.cssText=n,r=su.test(n)}}else e&&t.removeAttribute("style");Ta in t&&(t[Ta]=r?i.display:"",t[iu]&&(i.display="none"))}const ka=/\s*!important$/;function ir(t,e,n){if(gt(n))n.forEach(i=>ir(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=au(t,e);ka.test(n)?t.setProperty(ne(i),n.replace(ka,""),"important"):t[i]=n}}const Aa=["Webkit","Moz","ms"],ns={};function au(t,e){const n=ns[e];if(n)return n;let i=he(e);if(i!=="filter"&&i in t)return ns[e]=i;i=qs(i);for(let s=0;s<Aa.length;s++){const r=Aa[s]+i;if(r in t)return ns[e]=r}return e}const Ra="http://www.w3.org/1999/xlink";function Ea(t,e,n,i,s,r=sh(e)){i&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Ra,e.slice(6,e.length)):t.setAttributeNS(Ra,e,n):n==null||r&&!Qs(n)?t.removeAttribute(e):t.setAttribute(e,r?"":ye(n)?String(n):n)}function Ma(t,e,n,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Ca(n):n);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,a=n==null?t.type==="checkbox"?"on":"":String(n);(o!==a||!("_value"in t))&&(t.value=a),n==null&&t.removeAttribute(e),t._value=n;return}let r=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=Qs(n):n==null&&o==="string"?(n="",r=!0):o==="number"&&(n=0,r=!0)}try{t[e]=n}catch{}r&&t.removeAttribute(e)}function qe(t,e,n,i){t.addEventListener(e,n,i)}function lu(t,e,n,i){t.removeEventListener(e,n,i)}const Fa=Symbol("_vei");function cu(t,e,n,i,s=null){const r=t[Fa]||(t[Fa]={}),o=r[e];if(i&&o)o.value=i;else{const[a,l]=hu(e);if(i){const c=r[e]=fu(i,s);qe(t,a,c,l)}else o&&(lu(t,a,o,l),r[e]=void 0)}}const Da=/(?:Once|Passive|Capture)$/;function hu(t){let e;if(Da.test(t)){e={};let i;for(;i=t.match(Da);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ne(t.slice(2)),e]}let is=0;const du=Promise.resolve(),uu=()=>is||(du.then(()=>is=0),is=Date.now());function fu(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;_e(gu(i,n.value),e,5,[i])};return n.value=t,n.attached=uu(),n}function gu(t,e){if(gt(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>s=>!s._stopped&&i&&i(s))}else return e}const Na=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,pu=(t,e,n,i,s,r)=>{const o=s==="svg";e==="class"?nu(t,i,o):e==="style"?ou(t,n,i):Ti(e)?Sr(e)||cu(t,e,n,i,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):mu(t,e,i,o))?(Ma(t,e,i),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ea(t,e,i,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Ft(i))?Ma(t,he(e),i):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),Ea(t,e,i,o))};function mu(t,e,n,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&Na(e)&&mt(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Na(e)&&Ft(n)?!1:e in t}const Oa={};/*! #__NO_SIDE_EFFECTS__ */function yu(t,e,n){const i=sn(t,e);Ai(i)&&Ut(i,e);class s extends rs{constructor(o){super(i,o,n)}}return s.def=i,s}const _u=typeof HTMLElement<"u"?HTMLElement:class{};class rs extends _u{constructor(e,n={},i=Ba){super(),this._def=e,this._props=n,this._createApp=i,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&i!==Ba?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof rs){this._parent=e;break}this._instance||(this._resolved?(this._setParent(),this._update()):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._instance.provides=e._instance.provides)}disconnectedCallback(){this._connected=!1,Hr(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const s of i)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(i,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:r,styles:o}=i;let a;if(r&&!gt(r))for(const l in r){const c=r[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=Ys(this._props[l])),(a||(a=Object.create(null)))[he(l)]=!0)}this._numberProps=a,s&&this._resolveProps(i),this.shadowRoot&&this._applyStyles(o),this._mount(i)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(i=>e(this._def=i,!0)):e(this._def)}_mount(e){this._app=this._createApp(e),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const i in n)Tt(this,i)||Object.defineProperty(this,i,{get:()=>dt(n[i])})}_resolveProps(e){const{props:n}=e,i=gt(n)?n:Object.keys(n||{});for(const s of Object.keys(this))s[0]!=="_"&&i.includes(s)&&this._setProp(s,this[s]);for(const s of i.map(he))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(r){this._setProp(s,r,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const n=this.hasAttribute(e);let i=n?this.getAttribute(e):Oa;const s=he(e);n&&this._numberProps&&this._numberProps[s]&&(i=Ys(i)),this._setProp(s,i,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,n,i=!0,s=!1){n!==this._props[e]&&(n===Oa?delete this._props[e]:(this._props[e]=n,e==="key"&&this._app&&(this._app._ceVNode.key=n)),s&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(ne(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(ne(e),n+""):n||this.removeAttribute(ne(e))))}_update(){Tu(this._createVNode(),this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const n=oe(this._def,Ut(e,this._props));return this._instance||(n.ce=i=>{this._instance=i,i.ce=this,i.isCE=!0;const s=(r,o)=>{this.dispatchEvent(new CustomEvent(r,Ai(o[0])?Ut({detail:o},o[0]):{detail:o}))};i.emit=(r,...o)=>{s(r,o),ne(r)!==r&&s(ne(r),o)},this._setParent()}),n}_applyStyles(e,n){if(!e)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const i=this._nonce;for(let s=e.length-1;s>=0;s--){const r=document.createElement("style");i&&r.setAttribute("nonce",i),r.textContent=e[s],this.shadowRoot.prepend(r)}}_parseSlots(){const e=this._slots={};let n;for(;n=this.firstChild;){const i=n.nodeType===1&&n.getAttribute("slot")||"default";(e[i]||(e[i]=[])).push(n),this.removeChild(n)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let i=0;i<e.length;i++){const s=e[i],r=s.getAttribute("name")||"default",o=this._slots[r],a=s.parentNode;if(o)for(const l of o){if(n&&l.nodeType===1){const c=n+"-s",h=document.createTreeWalker(l,1);l.setAttribute(c,"");let m;for(;m=h.nextNode();)m.setAttribute(c,"")}a.insertBefore(l,s)}else for(;s.firstChild;)a.insertBefore(s.firstChild,s);a.removeChild(s)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}const rr=t=>{const e=t.props["onUpdate:modelValue"]||!1;return gt(e)?n=>Ei(e,n):e};function vu(t){t.target.composing=!0}function Ga(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ln=Symbol("_assign"),bu={created(t,{modifiers:{lazy:e,trim:n,number:i}},s){t[ln]=rr(s);const r=i||s.props&&s.props.type==="number";qe(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),r&&(a=Mi(a)),t[ln](a)}),n&&qe(t,"change",()=>{t.value=t.value.trim()}),e||(qe(t,"compositionstart",vu),qe(t,"compositionend",Ga),qe(t,"change",Ga))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:i,trim:s,number:r}},o){if(t[ln]=rr(o),t.composing)return;const a=(r||t.type==="number")&&!/^0\d/.test(t.value)?Mi(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(i&&e===n||s&&t.value.trim()===l)||(t.value=l))}},Su={deep:!0,created(t,{value:e,modifiers:{number:n}},i){const s=ki(e);qe(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Mi(sr(o)):sr(o));t[ln](t.multiple?s?new Set(r):r:r[0]),t._assigning=!0,Hr(()=>{t._assigning=!1})}),t[ln]=rr(i)},mounted(t,{value:e}){La(t,e)},beforeUpdate(t,e,n){t[ln]=rr(n)},updated(t,{value:e}){t._assigning||La(t,e)}};function La(t,e){const n=t.multiple,i=gt(e);if(!(n&&!i&&!ki(e))){for(let s=0,r=t.options.length;s<r;s++){const o=t.options[s],a=sr(o);if(n)if(i){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=ah(e,a)>-1}else o.selected=e.has(a);else if(Fi(sr(o),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function sr(t){return"_value"in t?t._value:t.value}const xu=["ctrl","shift","alt","meta"],wu={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>xu.some(n=>t[`${n}Key`]&&!e.includes(n))},Cu=(t,e)=>{const n=t._withMods||(t._withMods={}),i=e.join(".");return n[i]||(n[i]=(s,...r)=>{for(let o=0;o<e.length;o++){const a=wu[e[o]];if(a&&a(s,e))return}return t(s,...r)})},Pu=Ut({patchProp:pu},tu);let Ia;function Ua(){return Ia||(Ia=xd(Pu))}const Tu=(...t)=>{Ua().render(...t)},Ba=(...t)=>{const e=Ua().createApp(...t),{mount:n}=e;return e.mount=i=>{const s=Au(i);if(!s)return;const r=e._component;!mt(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=n(s,!1,ku(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function ku(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Au(t){return Ft(t)?document.querySelector(t):t}var Ha=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ru(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var or={exports:{}},Mn={},ss={},os={},Va;function _t(){return Va||(Va=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Ha<"u"?Ha:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.21",isBrowser:n(),isUnminified:/param/.test(function(s){}.toString()),dblClickWindow:400,getAngle(s){return t.Konva.angleDeg?s*e:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var s;return(s=t.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(s){t.glob.Konva=s}};const i=s=>{t.Konva[s.prototype.getClassName()]=s};t._registerNode=i,t.Konva._injectGlobal(t.Konva)}(os)),os}var as={},za;function Dt(){return za||(za=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=_t();class n{constructor(y=[1,0,0,1,0,0]){this.dirty=!1,this.m=y&&y.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(y){y.m[0]=this.m[0],y.m[1]=this.m[1],y.m[2]=this.m[2],y.m[3]=this.m[3],y.m[4]=this.m[4],y.m[5]=this.m[5]}point(y){const b=this.m;return{x:b[0]*y.x+b[2]*y.y+b[4],y:b[1]*y.x+b[3]*y.y+b[5]}}translate(y,b){return this.m[4]+=this.m[0]*y+this.m[2]*b,this.m[5]+=this.m[1]*y+this.m[3]*b,this}scale(y,b){return this.m[0]*=y,this.m[1]*=y,this.m[2]*=b,this.m[3]*=b,this}rotate(y){const b=Math.cos(y),k=Math.sin(y),D=this.m[0]*b+this.m[2]*k,x=this.m[1]*b+this.m[3]*k,w=this.m[0]*-k+this.m[2]*b,T=this.m[1]*-k+this.m[3]*b;return this.m[0]=D,this.m[1]=x,this.m[2]=w,this.m[3]=T,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(y,b){const k=this.m[0]+this.m[2]*b,D=this.m[1]+this.m[3]*b,x=this.m[2]+this.m[0]*y,w=this.m[3]+this.m[1]*y;return this.m[0]=k,this.m[1]=D,this.m[2]=x,this.m[3]=w,this}multiply(y){const b=this.m[0]*y.m[0]+this.m[2]*y.m[1],k=this.m[1]*y.m[0]+this.m[3]*y.m[1],D=this.m[0]*y.m[2]+this.m[2]*y.m[3],x=this.m[1]*y.m[2]+this.m[3]*y.m[3],w=this.m[0]*y.m[4]+this.m[2]*y.m[5]+this.m[4],T=this.m[1]*y.m[4]+this.m[3]*y.m[5]+this.m[5];return this.m[0]=b,this.m[1]=k,this.m[2]=D,this.m[3]=x,this.m[4]=w,this.m[5]=T,this}invert(){const y=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),b=this.m[3]*y,k=-this.m[1]*y,D=-this.m[2]*y,x=this.m[0]*y,w=y*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),T=y*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=b,this.m[1]=k,this.m[2]=D,this.m[3]=x,this.m[4]=w,this.m[5]=T,this}getMatrix(){return this.m}decompose(){const y=this.m[0],b=this.m[1],k=this.m[2],D=this.m[3],x=this.m[4],w=this.m[5],T=y*D-b*k,M={x,y:w,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(y!=0||b!=0){const G=Math.sqrt(y*y+b*b);M.rotation=b>0?Math.acos(y/G):-Math.acos(y/G),M.scaleX=G,M.scaleY=T/G,M.skewX=(y*k+b*D)/T,M.skewY=0}else if(k!=0||D!=0){const G=Math.sqrt(k*k+D*D);M.rotation=Math.PI/2-(D>0?Math.acos(-k/G):-Math.acos(k/G)),M.scaleX=T/G,M.scaleY=G,M.skewX=0,M.skewY=(y*k+b*D)/T}return M.rotation=t.Util._getRotation(M.rotation),M}}t.Transform=n;const i="[object Array]",s="[object Number]",r="[object String]",o="[object Boolean]",a=Math.PI/180,l=180/Math.PI,c="#",h="",m="0",g="Konva warning: ",u="Konva error: ",f="rgb(",_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const p=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(d){setTimeout(d,60)};t.Util={_isElement(d){return!!(d&&d.nodeType==1)},_isFunction(d){return!!(d&&d.constructor&&d.call&&d.apply)},_isPlainObject(d){return!!d&&d.constructor===Object},_isArray(d){return Object.prototype.toString.call(d)===i},_isNumber(d){return Object.prototype.toString.call(d)===s&&!isNaN(d)&&isFinite(d)},_isString(d){return Object.prototype.toString.call(d)===r},_isBoolean(d){return Object.prototype.toString.call(d)===o},isObject(d){return d instanceof Object},isValidSelector(d){if(typeof d!="string")return!1;const y=d[0];return y==="#"||y==="."||y===y.toUpperCase()},_sign(d){return d===0||d>0?1:-1},requestAnimFrame(d){C.push(d),C.length===1&&p(function(){const y=C;C=[],y.forEach(function(b){b()})})},createCanvasElement(){const d=document.createElement("canvas");try{d.style=d.style||{}}catch{}return d},createImageElement(){return document.createElement("img")},_isInDocument(d){for(;d=d.parentNode;)if(d==document)return!0;return!1},_urlToImage(d,y){const b=t.Util.createImageElement();b.onload=function(){y(b)},b.src=d},_rgbToHex(d,y,b){return(16777216+(d<<16)+(y<<8)+b).toString(16).slice(1)},_hexToRgb(d){d=d.replace(c,h);const y=parseInt(d,16);return{r:y>>16&255,g:y>>8&255,b:y&255}},getRandomColor(){let d=(Math.random()*16777215<<0).toString(16);for(;d.length<6;)d=m+d;return c+d},getRGB(d){let y;return d in _?(y=_[d],{r:y[0],g:y[1],b:y[2]}):d[0]===c?this._hexToRgb(d.substring(1)):d.substr(0,4)===f?(y=S.exec(d.replace(/ /g,"")),{r:parseInt(y[1],10),g:parseInt(y[2],10),b:parseInt(y[3],10)}):{r:0,g:0,b:0}},colorToRGBA(d){return d=d||"black",t.Util._namedColorToRBA(d)||t.Util._hex3ColorToRGBA(d)||t.Util._hex4ColorToRGBA(d)||t.Util._hex6ColorToRGBA(d)||t.Util._hex8ColorToRGBA(d)||t.Util._rgbColorToRGBA(d)||t.Util._rgbaColorToRGBA(d)||t.Util._hslColorToRGBA(d)},_namedColorToRBA(d){const y=_[d.toLowerCase()];return y?{r:y[0],g:y[1],b:y[2],a:1}:null},_rgbColorToRGBA(d){if(d.indexOf("rgb(")===0){d=d.match(/rgb\(([^)]+)\)/)[1];const y=d.split(/ *, */).map(Number);return{r:y[0],g:y[1],b:y[2],a:1}}},_rgbaColorToRGBA(d){if(d.indexOf("rgba(")===0){d=d.match(/rgba\(([^)]+)\)/)[1];const y=d.split(/ *, */).map((b,k)=>b.slice(-1)==="%"?k===3?parseInt(b)/100:parseInt(b)/100*255:Number(b));return{r:y[0],g:y[1],b:y[2],a:y[3]}}},_hex8ColorToRGBA(d){if(d[0]==="#"&&d.length===9)return{r:parseInt(d.slice(1,3),16),g:parseInt(d.slice(3,5),16),b:parseInt(d.slice(5,7),16),a:parseInt(d.slice(7,9),16)/255}},_hex6ColorToRGBA(d){if(d[0]==="#"&&d.length===7)return{r:parseInt(d.slice(1,3),16),g:parseInt(d.slice(3,5),16),b:parseInt(d.slice(5,7),16),a:1}},_hex4ColorToRGBA(d){if(d[0]==="#"&&d.length===5)return{r:parseInt(d[1]+d[1],16),g:parseInt(d[2]+d[2],16),b:parseInt(d[3]+d[3],16),a:parseInt(d[4]+d[4],16)/255}},_hex3ColorToRGBA(d){if(d[0]==="#"&&d.length===4)return{r:parseInt(d[1]+d[1],16),g:parseInt(d[2]+d[2],16),b:parseInt(d[3]+d[3],16),a:1}},_hslColorToRGBA(d){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(d)){const[y,...b]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(d),k=Number(b[0])/360,D=Number(b[1])/100,x=Number(b[2])/100;let w,T,M;if(D===0)return M=x*255,{r:Math.round(M),g:Math.round(M),b:Math.round(M),a:1};x<.5?w=x*(1+D):w=x+D-x*D;const G=2*x-w,I=[0,0,0];for(let B=0;B<3;B++)T=k+.3333333333333333*-(B-1),T<0&&T++,T>1&&T--,6*T<1?M=G+(w-G)*6*T:2*T<1?M=w:3*T<2?M=G+(w-G)*(.6666666666666666-T)*6:M=G,I[B]=M*255;return{r:Math.round(I[0]),g:Math.round(I[1]),b:Math.round(I[2]),a:1}}},haveIntersection(d,y){return!(y.x>d.x+d.width||y.x+y.width<d.x||y.y>d.y+d.height||y.y+y.height<d.y)},cloneObject(d){const y={};for(const b in d)this._isPlainObject(d[b])?y[b]=this.cloneObject(d[b]):this._isArray(d[b])?y[b]=this.cloneArray(d[b]):y[b]=d[b];return y},cloneArray(d){return d.slice(0)},degToRad(d){return d*a},radToDeg(d){return d*l},_degToRad(d){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(d)},_radToDeg(d){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(d)},_getRotation(d){return e.Konva.angleDeg?t.Util.radToDeg(d):d},_capitalize(d){return d.charAt(0).toUpperCase()+d.slice(1)},throw(d){throw new Error(u+d)},error(d){console.error(u+d)},warn(d){e.Konva.showWarnings&&console.warn(g+d)},each(d,y){for(const b in d)y(b,d[b])},_inRange(d,y,b){return y<=d&&d<b},_getProjectionToSegment(d,y,b,k,D,x){let w,T,M;const G=(d-b)*(d-b)+(y-k)*(y-k);if(G==0)w=d,T=y,M=(D-b)*(D-b)+(x-k)*(x-k);else{const I=((D-d)*(b-d)+(x-y)*(k-y))/G;I<0?(w=d,T=y,M=(d-D)*(d-D)+(y-x)*(y-x)):I>1?(w=b,T=k,M=(b-D)*(b-D)+(k-x)*(k-x)):(w=d+I*(b-d),T=y+I*(k-y),M=(w-D)*(w-D)+(T-x)*(T-x))}return[w,T,M]},_getProjectionToLine(d,y,b){const k=t.Util.cloneObject(d);let D=Number.MAX_VALUE;return y.forEach(function(x,w){if(!b&&w===y.length-1)return;const T=y[(w+1)%y.length],M=t.Util._getProjectionToSegment(x.x,x.y,T.x,T.y,d.x,d.y),G=M[0],I=M[1],B=M[2];B<D&&(k.x=G,k.y=I,D=B)}),k},_prepareArrayForTween(d,y,b){const k=[],D=[];if(d.length>y.length){const w=y;y=d,d=w}for(let w=0;w<d.length;w+=2)k.push({x:d[w],y:d[w+1]});for(let w=0;w<y.length;w+=2)D.push({x:y[w],y:y[w+1]});const x=[];return D.forEach(function(w){const T=t.Util._getProjectionToLine(w,k,b);x.push(T.x),x.push(T.y)}),x},_prepareToStringify(d){let y;d.visitedByCircularReferenceRemoval=!0;for(const b in d)if(d.hasOwnProperty(b)&&d[b]&&typeof d[b]=="object"){if(y=Object.getOwnPropertyDescriptor(d,b),d[b].visitedByCircularReferenceRemoval||t.Util._isElement(d[b]))if(y.configurable)delete d[b];else return null;else if(t.Util._prepareToStringify(d[b])===null)if(y.configurable)delete d[b];else return null}return delete d.visitedByCircularReferenceRemoval,d},_assign(d,y){for(const b in y)d[b]=y[b];return d},_getFirstPointerId(d){return d.touches?d.changedTouches[0].identifier:d.pointerId||999},releaseCanvas(...d){e.Konva.releaseCanvasOnDestroy&&d.forEach(y=>{y.width=0,y.height=0})},drawRoundedRectPath(d,y,b,k){let D=0,x=0,w=0,T=0;typeof k=="number"?D=x=w=T=Math.min(k,y/2,b/2):(D=Math.min(k[0]||0,y/2,b/2),x=Math.min(k[1]||0,y/2,b/2),T=Math.min(k[2]||0,y/2,b/2),w=Math.min(k[3]||0,y/2,b/2)),d.moveTo(D,0),d.lineTo(y-x,0),d.arc(y-x,x,x,Math.PI*3/2,0,!1),d.lineTo(y,b-T),d.arc(y-T,b-T,T,0,Math.PI/2,!1),d.lineTo(w,b),d.arc(w,b-w,w,Math.PI/2,Math.PI,!1),d.lineTo(0,D),d.arc(D,D,D,Math.PI,Math.PI*3/2,!1)}}}(as)),as}var Fn={},Me={},Fe={},Wa;function $a(){if(Wa)return Fe;Wa=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.HitContext=Fe.SceneContext=Fe.Context=void 0;const t=Dt(),e=_t();function n(C){const p=[],d=C.length,y=t.Util;for(let b=0;b<d;b++){let k=C[b];y._isNumber(k)?k=Math.round(k*1e3)/1e3:y._isString(k)||(k=k+""),p.push(k)}return p}const i=",",s="(",r=")",o="([",a="])",l=";",c="()",h="=",m=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],u=100;let f=class{constructor(p){this.canvas=p,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(p){p.fillEnabled()&&this._fill(p)}_fill(p){}strokeShape(p){p.hasStroke()&&this._stroke(p)}_stroke(p){}fillStrokeShape(p){p.attrs.fillAfterStrokeEnabled?(this.strokeShape(p),this.fillShape(p)):(this.fillShape(p),this.strokeShape(p))}getTrace(p,d){let y=this.traceArr,b=y.length,k="",D,x,w,T;for(D=0;D<b;D++)x=y[D],w=x.method,w?(T=x.args,k+=w,p?k+=c:t.Util._isArray(T[0])?k+=o+T.join(i)+a:(d&&(T=T.map(M=>typeof M=="number"?Math.floor(M):M)),k+=s+T.join(i)+r)):(k+=x.property,p||(k+=h+x.val)),k+=l;return k}clearTrace(){this.traceArr=[]}_trace(p){let d=this.traceArr,y;d.push(p),y=d.length,y>=u&&d.shift()}reset(){const p=this.getCanvas().getPixelRatio();this.setTransform(1*p,0,0,1*p,0,0)}getCanvas(){return this.canvas}clear(p){const d=this.getCanvas();p?this.clearRect(p.x||0,p.y||0,p.width||0,p.height||0):this.clearRect(0,0,d.getWidth()/d.pixelRatio,d.getHeight()/d.pixelRatio)}_applyLineCap(p){const d=p.attrs.lineCap;d&&this.setAttr("lineCap",d)}_applyOpacity(p){const d=p.getAbsoluteOpacity();d!==1&&this.setAttr("globalAlpha",d)}_applyLineJoin(p){const d=p.attrs.lineJoin;d&&this.setAttr("lineJoin",d)}setAttr(p,d){this._context[p]=d}arc(p,d,y,b,k,D){this._context.arc(p,d,y,b,k,D)}arcTo(p,d,y,b,k){this._context.arcTo(p,d,y,b,k)}beginPath(){this._context.beginPath()}bezierCurveTo(p,d,y,b,k,D){this._context.bezierCurveTo(p,d,y,b,k,D)}clearRect(p,d,y,b){this._context.clearRect(p,d,y,b)}clip(...p){this._context.clip.apply(this._context,p)}closePath(){this._context.closePath()}createImageData(p,d){const y=arguments;if(y.length===2)return this._context.createImageData(p,d);if(y.length===1)return this._context.createImageData(p)}createLinearGradient(p,d,y,b){return this._context.createLinearGradient(p,d,y,b)}createPattern(p,d){return this._context.createPattern(p,d)}createRadialGradient(p,d,y,b,k,D){return this._context.createRadialGradient(p,d,y,b,k,D)}drawImage(p,d,y,b,k,D,x,w,T){const M=arguments,G=this._context;M.length===3?G.drawImage(p,d,y):M.length===5?G.drawImage(p,d,y,b,k):M.length===9&&G.drawImage(p,d,y,b,k,D,x,w,T)}ellipse(p,d,y,b,k,D,x,w){this._context.ellipse(p,d,y,b,k,D,x,w)}isPointInPath(p,d,y,b){return y?this._context.isPointInPath(y,p,d,b):this._context.isPointInPath(p,d,b)}fill(...p){this._context.fill.apply(this._context,p)}fillRect(p,d,y,b){this._context.fillRect(p,d,y,b)}strokeRect(p,d,y,b){this._context.strokeRect(p,d,y,b)}fillText(p,d,y,b){b?this._context.fillText(p,d,y,b):this._context.fillText(p,d,y)}measureText(p){return this._context.measureText(p)}getImageData(p,d,y,b){return this._context.getImageData(p,d,y,b)}lineTo(p,d){this._context.lineTo(p,d)}moveTo(p,d){this._context.moveTo(p,d)}rect(p,d,y,b){this._context.rect(p,d,y,b)}roundRect(p,d,y,b,k){this._context.roundRect(p,d,y,b,k)}putImageData(p,d,y){this._context.putImageData(p,d,y)}quadraticCurveTo(p,d,y,b){this._context.quadraticCurveTo(p,d,y,b)}restore(){this._context.restore()}rotate(p){this._context.rotate(p)}save(){this._context.save()}scale(p,d){this._context.scale(p,d)}setLineDash(p){this._context.setLineDash?this._context.setLineDash(p):"mozDash"in this._context?this._context.mozDash=p:"webkitLineDash"in this._context&&(this._context.webkitLineDash=p)}getLineDash(){return this._context.getLineDash()}setTransform(p,d,y,b,k,D){this._context.setTransform(p,d,y,b,k,D)}stroke(p){p?this._context.stroke(p):this._context.stroke()}strokeText(p,d,y,b){this._context.strokeText(p,d,y,b)}transform(p,d,y,b,k,D){this._context.transform(p,d,y,b,k,D)}translate(p,d){this._context.translate(p,d)}_enableTrace(){let p=this,d=m.length,y=this.setAttr,b,k;const D=function(x){let w=p[x],T;p[x]=function(){return k=n(Array.prototype.slice.call(arguments,0)),T=w.apply(p,arguments),p._trace({method:x,args:k}),T}};for(b=0;b<d;b++)D(m[b]);p.setAttr=function(){y.apply(p,arguments);const x=arguments[0];let w=arguments[1];(x==="shadowOffsetX"||x==="shadowOffsetY"||x==="shadowBlur")&&(w=w/this.canvas.getPixelRatio()),p._trace({property:x,val:w})}}_applyGlobalCompositeOperation(p){const d=p.attrs.globalCompositeOperation;!d||d==="source-over"||this.setAttr("globalCompositeOperation",d)}};Fe.Context=f,g.forEach(function(C){Object.defineProperty(f.prototype,C,{get(){return this._context[C]},set(p){this._context[C]=p}})});class _ extends f{constructor(p,{willReadFrequently:d=!1}={}){super(p),this._context=p._canvas.getContext("2d",{willReadFrequently:d})}_fillColor(p){const d=p.fill();this.setAttr("fillStyle",d),p._fillFunc(this)}_fillPattern(p){this.setAttr("fillStyle",p._getFillPattern()),p._fillFunc(this)}_fillLinearGradient(p){const d=p._getLinearGradient();d&&(this.setAttr("fillStyle",d),p._fillFunc(this))}_fillRadialGradient(p){const d=p._getRadialGradient();d&&(this.setAttr("fillStyle",d),p._fillFunc(this))}_fill(p){const d=p.fill(),y=p.getFillPriority();if(d&&y==="color"){this._fillColor(p);return}const b=p.getFillPatternImage();if(b&&y==="pattern"){this._fillPattern(p);return}const k=p.getFillLinearGradientColorStops();if(k&&y==="linear-gradient"){this._fillLinearGradient(p);return}const D=p.getFillRadialGradientColorStops();if(D&&y==="radial-gradient"){this._fillRadialGradient(p);return}d?this._fillColor(p):b?this._fillPattern(p):k?this._fillLinearGradient(p):D&&this._fillRadialGradient(p)}_strokeLinearGradient(p){const d=p.getStrokeLinearGradientStartPoint(),y=p.getStrokeLinearGradientEndPoint(),b=p.getStrokeLinearGradientColorStops(),k=this.createLinearGradient(d.x,d.y,y.x,y.y);if(b){for(let D=0;D<b.length;D+=2)k.addColorStop(b[D],b[D+1]);this.setAttr("strokeStyle",k)}}_stroke(p){const d=p.dash(),y=p.getStrokeScaleEnabled();if(p.hasStroke()){if(!y){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(p),d&&p.dashEnabled()&&(this.setLineDash(d),this.setAttr("lineDashOffset",p.dashOffset())),this.setAttr("lineWidth",p.strokeWidth()),p.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),p.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(p):this.setAttr("strokeStyle",p.stroke()),p._strokeFunc(this),y||this.restore()}}_applyShadow(p){var d,y,b;const k=(d=p.getShadowRGBA())!==null&&d!==void 0?d:"black",D=(y=p.getShadowBlur())!==null&&y!==void 0?y:5,x=(b=p.getShadowOffset())!==null&&b!==void 0?b:{x:0,y:0},w=p.getAbsoluteScale(),T=this.canvas.getPixelRatio(),M=w.x*T,G=w.y*T;this.setAttr("shadowColor",k),this.setAttr("shadowBlur",D*Math.min(Math.abs(M),Math.abs(G))),this.setAttr("shadowOffsetX",x.x*M),this.setAttr("shadowOffsetY",x.y*G)}}Fe.SceneContext=_;class S extends f{constructor(p){super(p),this._context=p._canvas.getContext("2d",{willReadFrequently:!0})}_fill(p){this.save(),this.setAttr("fillStyle",p.colorKey),p._fillFuncHit(this),this.restore()}strokeShape(p){p.hasHitStroke()&&this._stroke(p)}_stroke(p){if(p.hasHitStroke()){const d=p.getStrokeScaleEnabled();if(!d){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(p);const y=p.hitStrokeWidth(),b=y==="auto"?p.strokeWidth():y;this.setAttr("lineWidth",b),this.setAttr("strokeStyle",p.colorKey),p._strokeFuncHit(this),d||this.restore()}}}return Fe.HitContext=S,Fe}var ja;function ar(){if(ja)return Me;ja=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.HitCanvas=Me.SceneCanvas=Me.Canvas=void 0;const t=Dt(),e=$a(),n=_t();let i;function s(){if(i)return i;const l=t.Util.createCanvasElement(),c=l.getContext("2d");return i=function(){const h=n.Konva._global.devicePixelRatio||1,m=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;return h/m}(),t.Util.releaseCanvas(l),i}let r=class{constructor(c){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const m=(c||{}).pixelRatio||n.Konva.pixelRatio||s();this.pixelRatio=m,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(c){const h=this.pixelRatio;this.pixelRatio=c,this.setSize(this.getWidth()/h,this.getHeight()/h)}setWidth(c){this.width=this._canvas.width=c*this.pixelRatio,this._canvas.style.width=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}setHeight(c){this.height=this._canvas.height=c*this.pixelRatio,this._canvas.style.height=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}getWidth(){return this.width}getHeight(){return this.height}setSize(c,h){this.setWidth(c||0),this.setHeight(h||0)}toDataURL(c,h){try{return this._canvas.toDataURL(c,h)}catch{try{return this._canvas.toDataURL()}catch(g){return t.Util.error("Unable to get data URL. "+g.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Me.Canvas=r;class o extends r{constructor(c={width:0,height:0,willReadFrequently:!1}){super(c),this.context=new e.SceneContext(this,{willReadFrequently:c.willReadFrequently}),this.setSize(c.width,c.height)}}Me.SceneCanvas=o;class a extends r{constructor(c={width:0,height:0}){super(c),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(c.width,c.height)}}return Me.HitCanvas=a,Me}var ls={},qa;function cs(){return qa||(qa=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=_t(),n=Dt();t.DD={get isDragging(){let i=!1;return t.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return t.DD._dragElements.forEach(s=>{i=s.node}),i},_dragElements:new Map,_drag(i){const s=[];t.DD._dragElements.forEach((r,o)=>{const{node:a}=r,l=a.getStage();l.setPointersPositions(i),r.pointerId===void 0&&(r.pointerId=n.Util._getFirstPointerId(i));const c=l._changedPointerPositions.find(h=>h.id===r.pointerId);if(c){if(r.dragStatus!=="dragging"){const h=a.dragDistance();if(Math.max(Math.abs(c.x-r.startPointerPos.x),Math.abs(c.y-r.startPointerPos.y))<h||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,r),s.push(a)}}),s.forEach(r=>{r.fire("dragmove",{type:"dragmove",target:r,evt:i},!0)})},_endDragBefore(i){const s=[];t.DD._dragElements.forEach(r=>{const{node:o}=r,a=o.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(h=>h.id===r.pointerId))return;(r.dragStatus==="dragging"||r.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,r.dragStatus="stopped");const c=r.node.getLayer()||r.node instanceof e.Konva.Stage&&r.node;c&&s.indexOf(c)===-1&&s.push(c)}),s.forEach(r=>{r.draw()})},_endDragAfter(i){t.DD._dragElements.forEach((s,r)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:i},!0),s.dragStatus!=="dragging"&&t.DD._dragElements.delete(r)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))}(ls)),ls}var hs={},Xt={},Ka;function St(){if(Ka)return Xt;Ka=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.RGBComponent=i,Xt.alphaComponent=s,Xt.getNumberValidator=r,Xt.getNumberOrArrayOfNumbersValidator=o,Xt.getNumberOrAutoValidator=a,Xt.getStringValidator=l,Xt.getStringOrGradientValidator=c,Xt.getFunctionValidator=h,Xt.getNumberArrayValidator=m,Xt.getBooleanValidator=g,Xt.getComponentValidator=u;const t=_t(),e=Dt();function n(f){return e.Util._isString(f)?'"'+f+'"':Object.prototype.toString.call(f)==="[object Number]"||e.Util._isBoolean(f)?f:Object.prototype.toString.call(f)}function i(f){return f>255?255:f<0?0:Math.round(f)}function s(f){return f>1?1:f<1e-4?1e-4:f}function r(){if(t.Konva.isUnminified)return function(f,_){return e.Util._isNumber(f)||e.Util.warn(n(f)+' is a not valid value for "'+_+'" attribute. The value should be a number.'),f}}function o(f){if(t.Konva.isUnminified)return function(_,S){let C=e.Util._isNumber(_),p=e.Util._isArray(_)&&_.length==f;return!C&&!p&&e.Util.warn(n(_)+' is a not valid value for "'+S+'" attribute. The value should be a number or Array<number>('+f+")"),_}}function a(){if(t.Konva.isUnminified)return function(f,_){return e.Util._isNumber(f)||f==="auto"||e.Util.warn(n(f)+' is a not valid value for "'+_+'" attribute. The value should be a number or "auto".'),f}}function l(){if(t.Konva.isUnminified)return function(f,_){return e.Util._isString(f)||e.Util.warn(n(f)+' is a not valid value for "'+_+'" attribute. The value should be a string.'),f}}function c(){if(t.Konva.isUnminified)return function(f,_){const S=e.Util._isString(f),C=Object.prototype.toString.call(f)==="[object CanvasGradient]"||f&&f.addColorStop;return S||C||e.Util.warn(n(f)+' is a not valid value for "'+_+'" attribute. The value should be a string or a native gradient.'),f}}function h(){if(t.Konva.isUnminified)return function(f,_){return e.Util._isFunction(f)||e.Util.warn(n(f)+' is a not valid value for "'+_+'" attribute. The value should be a function.'),f}}function m(){if(t.Konva.isUnminified)return function(f,_){const S=Int8Array?Object.getPrototypeOf(Int8Array):null;return S&&f instanceof S||(e.Util._isArray(f)?f.forEach(function(C){e.Util._isNumber(C)||e.Util.warn('"'+_+'" attribute has non numeric element '+C+". Make sure that all elements are numbers.")}):e.Util.warn(n(f)+' is a not valid value for "'+_+'" attribute. The value should be a array of numbers.')),f}}function g(){if(t.Konva.isUnminified)return function(f,_){return f===!0||f===!1||e.Util.warn(n(f)+' is a not valid value for "'+_+'" attribute. The value should be a boolean.'),f}}function u(f){if(t.Konva.isUnminified)return function(_,S){return _==null||e.Util.isObject(_)||e.Util.warn(n(_)+' is a not valid value for "'+S+'" attribute. The value should be an object with properties '+f),_}}return Xt}var Ya;function bt(){return Ya||(Ya=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Dt(),n=St(),i="get",s="set";t.Factory={addGetterSetter(r,o,a,l,c){t.Factory.addGetter(r,o,a),t.Factory.addSetter(r,o,l,c),t.Factory.addOverloadedGetterSetter(r,o)},addGetter(r,o,a){const l=i+e.Util._capitalize(o);r.prototype[l]=r.prototype[l]||function(){const c=this.attrs[o];return c===void 0?a:c}},addSetter(r,o,a,l){const c=s+e.Util._capitalize(o);r.prototype[c]||t.Factory.overWriteSetter(r,o,a,l)},overWriteSetter(r,o,a,l){const c=s+e.Util._capitalize(o);r.prototype[c]=function(h){return a&&h!==void 0&&h!==null&&(h=a.call(this,h,o)),this._setAttr(o,h),l&&l.call(this),this}},addComponentsGetterSetter(r,o,a,l,c){const h=a.length,m=e.Util._capitalize,g=i+m(o),u=s+m(o);r.prototype[g]=function(){const _={};for(let S=0;S<h;S++){const C=a[S];_[C]=this.getAttr(o+m(C))}return _};const f=(0,n.getComponentValidator)(a);r.prototype[u]=function(_){const S=this.attrs[o];l&&(_=l.call(this,_,o)),f&&f.call(this,_,o);for(const C in _)_.hasOwnProperty(C)&&this._setAttr(o+m(C),_[C]);return _||a.forEach(C=>{this._setAttr(o+m(C),void 0)}),this._fireChangeEvent(o,S,_),c&&c.call(this),this},t.Factory.addOverloadedGetterSetter(r,o)},addOverloadedGetterSetter(r,o){const a=e.Util._capitalize(o),l=s+a,c=i+a;r.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(r,o,a,l){e.Util.error("Adding deprecated "+o);const c=i+e.Util._capitalize(o),h=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";r.prototype[c]=function(){e.Util.error(h);const m=this.attrs[o];return m===void 0?a:m},t.Factory.addSetter(r,o,l,function(){e.Util.error(h)}),t.Factory.addOverloadedGetterSetter(r,o)},backCompat(r,o){e.Util.each(o,function(a,l){const c=r.prototype[l],h=i+e.Util._capitalize(a),m=s+e.Util._capitalize(a);function g(){c.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}r.prototype[a]=g,r.prototype[h]=g,r.prototype[m]=g})},afterSetFilter(){this._filterUpToDate=!1}}}(hs)),hs}var Xa;function Ot(){if(Xa)return Fn;Xa=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.Node=void 0;const t=ar(),e=cs(),n=bt(),i=_t(),s=Dt(),r=St(),o="absoluteOpacity",a="allEventListeners",l="absoluteTransform",c="absoluteScale",h="canvas",m="Change",g="children",u="konva",f="listening",_="mouseenter",S="mouseleave",C="pointerenter",p="pointerleave",d="touchenter",y="touchleave",b="set",k="Shape",D=" ",x="stage",w="transform",T="Stage",M="visible",G=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(D);let I=1,B=class zs{constructor(v){this._id=I++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(v),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(v){(v===w||v===l)&&this._cache.get(v)?this._cache.get(v).dirty=!0:v?this._cache.delete(v):this._cache.clear()}_getCache(v,P){let E=this._cache.get(v);return(E===void 0||(v===w||v===l)&&E.dirty===!0)&&(E=P.call(this),this._cache.set(v,E)),E}_calculate(v,P,E){if(!this._attachedDepsListeners.get(v)){const A=P.map(O=>O+"Change.konva").join(D);this.on(A,()=>{this._clearCache(v)}),this._attachedDepsListeners.set(v,!0)}return this._getCache(v,E)}_getCanvasCache(){return this._cache.get(h)}_clearSelfAndDescendantCache(v){this._clearCache(v),v===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(h)){const{scene:v,filter:P,hit:E,buffer:A}=this._cache.get(h);s.Util.releaseCanvas(v,P,E,A),this._cache.delete(h)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(v){const P=v||{};let E={};(P.x===void 0||P.y===void 0||P.width===void 0||P.height===void 0)&&(E=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let A=Math.ceil(P.width||E.width),O=Math.ceil(P.height||E.height),j=P.pixelRatio,U=P.x===void 0?Math.floor(E.x):P.x,J=P.y===void 0?Math.floor(E.y):P.y,st=P.offset||0,$=P.drawBorder||!1,F=P.hitCanvasPixelRatio||1;if(!A||!O){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const W=Math.abs(Math.round(E.x)-U)>.5?1:0,nt=Math.abs(Math.round(E.y)-J)>.5?1:0;A+=st*2+W,O+=st*2+nt,U-=st,J-=st;const it=new t.SceneCanvas({pixelRatio:j,width:A,height:O}),ct=new t.SceneCanvas({pixelRatio:j,width:0,height:0,willReadFrequently:!0}),R=new t.HitCanvas({pixelRatio:F,width:A,height:O}),N=it.getContext(),z=R.getContext(),q=new t.SceneCanvas({width:it.width/it.pixelRatio+Math.abs(U),height:it.height/it.pixelRatio+Math.abs(J),pixelRatio:it.pixelRatio}),Y=q.getContext();return R.isCache=!0,it.isCache=!0,this._cache.delete(h),this._filterUpToDate=!1,P.imageSmoothingEnabled===!1&&(it.getContext()._context.imageSmoothingEnabled=!1,ct.getContext()._context.imageSmoothingEnabled=!1),N.save(),z.save(),Y.save(),N.translate(-U,-J),z.translate(-U,-J),Y.translate(-U,-J),q.x=U,q.y=J,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this.drawScene(it,this,q),this.drawHit(R,this),this._isUnderCache=!1,N.restore(),z.restore(),$&&(N.save(),N.beginPath(),N.rect(0,0,A,O),N.closePath(),N.setAttr("strokeStyle","red"),N.setAttr("lineWidth",5),N.stroke(),N.restore()),this._cache.set(h,{scene:it,filter:ct,hit:R,buffer:q,x:U,y:J}),this._requestDraw(),this}isCached(){return this._cache.has(h)}getClientRect(v){throw new Error('abstract "getClientRect" method call')}_transformedRect(v,P){const E=[{x:v.x,y:v.y},{x:v.x+v.width,y:v.y},{x:v.x+v.width,y:v.y+v.height},{x:v.x,y:v.y+v.height}];let A=1/0,O=1/0,j=-1/0,U=-1/0;const J=this.getAbsoluteTransform(P);return E.forEach(function(st){const $=J.point(st);A===void 0&&(A=j=$.x,O=U=$.y),A=Math.min(A,$.x),O=Math.min(O,$.y),j=Math.max(j,$.x),U=Math.max(U,$.y)}),{x:A,y:O,width:j-A,height:U-O}}_drawCachedSceneCanvas(v){v.save(),v._applyOpacity(this),v._applyGlobalCompositeOperation(this);const P=this._getCanvasCache();v.translate(P.x,P.y);const E=this._getCachedSceneCanvas(),A=E.pixelRatio;v.drawImage(E._canvas,0,0,E.width/A,E.height/A),v.restore()}_drawCachedHitCanvas(v){const P=this._getCanvasCache(),E=P.hit;v.save(),v.translate(P.x,P.y),v.drawImage(E._canvas,0,0,E.width/E.pixelRatio,E.height/E.pixelRatio),v.restore()}_getCachedSceneCanvas(){let v=this.filters(),P=this._getCanvasCache(),E=P.scene,A=P.filter,O=A.getContext(),j,U,J,st;if(v){if(!this._filterUpToDate){const $=E.pixelRatio;A.setSize(E.width/E.pixelRatio,E.height/E.pixelRatio);try{for(j=v.length,O.clear(),O.drawImage(E._canvas,0,0,E.getWidth()/$,E.getHeight()/$),U=O.getImageData(0,0,A.getWidth(),A.getHeight()),J=0;J<j;J++){if(st=v[J],typeof st!="function"){s.Util.error("Filter should be type of function, but got "+typeof st+" instead. Please check correct filters");continue}st.call(this,U),O.putImageData(U,0,0)}}catch(F){s.Util.error("Unable to apply filter. "+F.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return A}return E}on(v,P){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const E=v.split(D);for(let A=0;A<E.length;A++){const j=E[A].split("."),U=j[0],J=j[1]||"";this.eventListeners[U]||(this.eventListeners[U]=[]),this.eventListeners[U].push({name:J,handler:P})}return this}off(v,P){let E=(v||"").split(D),A=E.length,O,j,U,J,st,$;if(this._cache&&this._cache.delete(a),!v)for(j in this.eventListeners)this._off(j);for(O=0;O<A;O++)if(U=E[O],J=U.split("."),st=J[0],$=J[1],st)this.eventListeners[st]&&this._off(st,$,P);else for(j in this.eventListeners)this._off(j,$,P);return this}dispatchEvent(v){const P={target:this,type:v.type,evt:v};return this.fire(v.type,P),this}addEventListener(v,P){return this.on(v,function(E){P.call(this,E.evt)}),this}removeEventListener(v){return this.off(v),this}_delegate(v,P,E){const A=this;this.on(v,function(O){const j=O.target.findAncestors(P,!0,A);for(let U=0;U<j.length;U++)O=s.Util.cloneObject(O),O.currentTarget=j[U],E.call(j[U],O)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(x),this._clearSelfAndDescendantCache(M),this._clearSelfAndDescendantCache(f)}_remove(){this._clearCaches();const v=this.getParent();v&&v.children&&(v.children.splice(this.index,1),v._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(v){const P="get"+s.Util._capitalize(v);return s.Util._isFunction(this[P])?this[P]():this.attrs[v]}getAncestors(){let v=this.getParent(),P=[];for(;v;)P.push(v),v=v.getParent();return P}getAttrs(){return this.attrs||{}}setAttrs(v){return this._batchTransformChanges(()=>{let P,E;if(!v)return this;for(P in v)P!==g&&(E=b+s.Util._capitalize(P),s.Util._isFunction(this[E])?this[E](v[P]):this._setAttr(P,v[P]))}),this}isListening(){return this._getCache(f,this._isListening)}_isListening(v){if(!this.listening())return!1;const E=this.getParent();return E&&E!==v&&this!==v?E._isListening(v):!0}isVisible(){return this._getCache(M,this._isVisible)}_isVisible(v){if(!this.visible())return!1;const E=this.getParent();return E&&E!==v&&this!==v?E._isVisible(v):!0}shouldDrawHit(v,P=!1){if(v)return this._isVisible(v)&&this._isListening(v);const E=this.getLayer();let A=!1;e.DD._dragElements.forEach(j=>{j.dragStatus==="dragging"&&(j.node.nodeType==="Stage"||j.node.getLayer()===E)&&(A=!0)});const O=!P&&!i.Konva.hitOnDragEnabled&&(A||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!O}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let v=this.getDepth(),P=this,E=0,A,O,j,U;function J($){for(A=[],O=$.length,j=0;j<O;j++)U=$[j],E++,U.nodeType!==k&&(A=A.concat(U.getChildren().slice())),U._id===P._id&&(j=O);A.length>0&&A[0].getDepth()<=v&&J(A)}const st=this.getStage();return P.nodeType!==T&&st&&J(st.getChildren()),E}getDepth(){let v=0,P=this.parent;for(;P;)v++,P=P.parent;return v}_batchTransformChanges(v){this._batchingTransformChange=!0,v(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(w),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(v){return this._batchTransformChanges(()=>{this.x(v.x),this.y(v.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const v=this.getStage();if(!v)return null;const P=v.getPointerPosition();if(!P)return null;const E=this.getAbsoluteTransform().copy();return E.invert(),E.point(P)}getAbsolutePosition(v){let P=!1,E=this.parent;for(;E;){if(E.isCached()){P=!0;break}E=E.parent}P&&!v&&(v=!0);const A=this.getAbsoluteTransform(v).getMatrix(),O=new s.Transform,j=this.offset();return O.m=A.slice(),O.translate(j.x,j.y),O.getTranslation()}setAbsolutePosition(v){const{x:P,y:E,...A}=this._clearTransform();this.attrs.x=P,this.attrs.y=E,this._clearCache(w);const O=this._getAbsoluteTransform().copy();return O.invert(),O.translate(v.x,v.y),v={x:this.attrs.x+O.getTranslation().x,y:this.attrs.y+O.getTranslation().y},this._setTransform(A),this.setPosition({x:v.x,y:v.y}),this._clearCache(w),this._clearSelfAndDescendantCache(l),this}_setTransform(v){let P;for(P in v)this.attrs[P]=v[P]}_clearTransform(){const v={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,v}move(v){let P=v.x,E=v.y,A=this.x(),O=this.y();return P!==void 0&&(A+=P),E!==void 0&&(O+=E),this.setPosition({x:A,y:O}),this}_eachAncestorReverse(v,P){let E=[],A=this.getParent(),O,j;if(!(P&&P._id===this._id)){for(E.unshift(this);A&&(!P||A._id!==P._id);)E.unshift(A),A=A.parent;for(O=E.length,j=0;j<O;j++)v(E[j])}}rotate(v){return this.rotation(this.rotation()+v),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const v=this.index,P=this.parent.getChildren().length;return v<P-1?(this.parent.children.splice(v,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const v=this.index,P=this.parent.getChildren().length;return v<P-1?(this.parent.children.splice(v,1),this.parent.children.splice(v+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const v=this.index;return v>0?(this.parent.children.splice(v,1),this.parent.children.splice(v-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const v=this.index;return v>0?(this.parent.children.splice(v,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(v){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(v<0||v>=this.parent.children.length)&&s.Util.warn("Unexpected value "+v+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const P=this.index;return this.parent.children.splice(P,1),this.parent.children.splice(v,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let v=this.opacity();const P=this.getParent();return P&&!P._isUnderCache&&(v*=P.getAbsoluteOpacity()),v}moveTo(v){return this.getParent()!==v&&(this._remove(),v.add(this)),this}toObject(){let v=this.getAttrs(),P,E,A,O,j;const U={attrs:{},className:this.getClassName()};for(P in v)E=v[P],j=s.Util.isObject(E)&&!s.Util._isPlainObject(E)&&!s.Util._isArray(E),!j&&(A=typeof this[P]=="function"&&this[P],delete v[P],O=A?A.call(this):null,v[P]=E,O!==E&&(U.attrs[P]=E));return s.Util._prepareToStringify(U)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(v,P,E){const A=[];P&&this._isMatch(v)&&A.push(this);let O=this.parent;for(;O;){if(O===E)return A;O._isMatch(v)&&A.push(O),O=O.parent}return A}isAncestorOf(v){return!1}findAncestor(v,P,E){return this.findAncestors(v,P,E)[0]}_isMatch(v){if(!v)return!1;if(typeof v=="function")return v(this);let P=v.replace(/ /g,"").split(","),E=P.length,A,O;for(A=0;A<E;A++)if(O=P[A],s.Util.isValidSelector(O)||(s.Util.warn('Selector "'+O+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),O.charAt(0)==="#"){if(this.id()===O.slice(1))return!0}else if(O.charAt(0)==="."){if(this.hasName(O.slice(1)))return!0}else if(this.className===O||this.nodeType===O)return!0;return!1}getLayer(){const v=this.getParent();return v?v.getLayer():null}getStage(){return this._getCache(x,this._getStage)}_getStage(){const v=this.getParent();return v?v.getStage():null}fire(v,P={},E){return P.target=P.target||this,E?this._fireAndBubble(v,P):this._fire(v,P),this}getAbsoluteTransform(v){return v?this._getAbsoluteTransform(v):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(v){let P;if(v)return P=new s.Transform,this._eachAncestorReverse(function(E){const A=E.transformsEnabled();A==="all"?P.multiply(E.getTransform()):A==="position"&&P.translate(E.x()-E.offsetX(),E.y()-E.offsetY())},v),P;{P=this._cache.get(l)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(P):P.reset();const E=this.transformsEnabled();if(E==="all")P.multiply(this.getTransform());else if(E==="position"){const A=this.attrs.x||0,O=this.attrs.y||0,j=this.attrs.offsetX||0,U=this.attrs.offsetY||0;P.translate(A-j,O-U)}return P.dirty=!1,P}}getAbsoluteScale(v){let P=this;for(;P;)P._isUnderCache&&(v=P),P=P.getParent();const A=this.getAbsoluteTransform(v).decompose();return{x:A.scaleX,y:A.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(w,this._getTransform)}_getTransform(){var v,P;const E=this._cache.get(w)||new s.Transform;E.reset();const A=this.x(),O=this.y(),j=i.Konva.getAngle(this.rotation()),U=(v=this.attrs.scaleX)!==null&&v!==void 0?v:1,J=(P=this.attrs.scaleY)!==null&&P!==void 0?P:1,st=this.attrs.skewX||0,$=this.attrs.skewY||0,F=this.attrs.offsetX||0,W=this.attrs.offsetY||0;return(A!==0||O!==0)&&E.translate(A,O),j!==0&&E.rotate(j),(st!==0||$!==0)&&E.skew(st,$),(U!==1||J!==1)&&E.scale(U,J),(F!==0||W!==0)&&E.translate(-1*F,-1*W),E.dirty=!1,E}clone(v){let P=s.Util.cloneObject(this.attrs),E,A,O,j,U;for(E in v)P[E]=v[E];const J=new this.constructor(P);for(E in this.eventListeners)for(A=this.eventListeners[E],O=A.length,j=0;j<O;j++)U=A[j],U.name.indexOf(u)<0&&(J.eventListeners[E]||(J.eventListeners[E]=[]),J.eventListeners[E].push(U));return J}_toKonvaCanvas(v){v=v||{};const P=this.getClientRect(),E=this.getStage(),A=v.x!==void 0?v.x:Math.floor(P.x),O=v.y!==void 0?v.y:Math.floor(P.y),j=v.pixelRatio||1,U=new t.SceneCanvas({width:v.width||Math.ceil(P.width)||(E?E.width():0),height:v.height||Math.ceil(P.height)||(E?E.height():0),pixelRatio:j}),J=U.getContext(),st=new t.SceneCanvas({width:U.width/U.pixelRatio+Math.abs(A),height:U.height/U.pixelRatio+Math.abs(O),pixelRatio:U.pixelRatio});return v.imageSmoothingEnabled===!1&&(J._context.imageSmoothingEnabled=!1),J.save(),(A||O)&&J.translate(-1*A,-1*O),this.drawScene(U,void 0,st),J.restore(),U}toCanvas(v){return this._toKonvaCanvas(v)._canvas}toDataURL(v){v=v||{};const P=v.mimeType||null,E=v.quality||null,A=this._toKonvaCanvas(v).toDataURL(P,E);return v.callback&&v.callback(A),A}toImage(v){return new Promise((P,E)=>{try{const A=v?.callback;A&&delete v.callback,s.Util._urlToImage(this.toDataURL(v),function(O){P(O),A?.(O)})}catch(A){E(A)}})}toBlob(v){return new Promise((P,E)=>{try{const A=v?.callback;A&&delete v.callback,this.toCanvas(v).toBlob(O=>{P(O),A?.(O)},v?.mimeType,v?.quality)}catch(A){E(A)}})}setSize(v){return this.width(v.width),this.height(v.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(v,P,E){let A=this.eventListeners[v],O,j,U;for(O=0;O<A.length;O++)if(j=A[O].name,U=A[O].handler,(j!=="konva"||P==="konva")&&(!P||j===P)&&(!E||E===U)){if(A.splice(O,1),A.length===0){delete this.eventListeners[v];break}O--}}_fireChangeEvent(v,P,E){this._fire(v+m,{oldVal:P,newVal:E})}addName(v){if(!this.hasName(v)){const P=this.name(),E=P?P+" "+v:v;this.name(E)}return this}hasName(v){if(!v)return!1;const P=this.name();return P?(P||"").split(/\s/g).indexOf(v)!==-1:!1}removeName(v){const P=(this.name()||"").split(/\s/g),E=P.indexOf(v);return E!==-1&&(P.splice(E,1),this.name(P.join(" "))),this}setAttr(v,P){const E=this[b+s.Util._capitalize(v)];return s.Util._isFunction(E)?E.call(this,P):this._setAttr(v,P),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const v=this.getLayer()||this.getStage();v?.batchDraw()}}_setAttr(v,P){const E=this.attrs[v];E===P&&!s.Util.isObject(P)||(P==null?delete this.attrs[v]:this.attrs[v]=P,this._shouldFireChangeEvents&&this._fireChangeEvent(v,E,P),this._requestDraw())}_setComponentAttr(v,P,E){let A;E!==void 0&&(A=this.attrs[v],A||(this.attrs[v]=this.getAttr(v)),this.attrs[v][P]=E,this._fireChangeEvent(v,A,E))}_fireAndBubble(v,P,E){P&&this.nodeType===k&&(P.target=this);const A=[_,S,C,p,d,y];if(!(A.indexOf(v)!==-1&&(E&&(this===E||this.isAncestorOf&&this.isAncestorOf(E))||this.nodeType==="Stage"&&!E))){this._fire(v,P);const j=A.indexOf(v)!==-1&&E&&E.isAncestorOf&&E.isAncestorOf(this)&&!E.isAncestorOf(this.parent);(P&&!P.cancelBubble||!P)&&this.parent&&this.parent.isListening()&&!j&&(E&&E.parent?this._fireAndBubble.call(this.parent,v,P,E):this._fireAndBubble.call(this.parent,v,P))}}_getProtoListeners(v){var P,E,A;const O=(P=this._cache.get(a))!==null&&P!==void 0?P:{};let j=O?.[v];if(j===void 0){j=[];let U=Object.getPrototypeOf(this);for(;U;){const J=(A=(E=U.eventListeners)===null||E===void 0?void 0:E[v])!==null&&A!==void 0?A:[];j.push(...J),U=Object.getPrototypeOf(U)}O[v]=j,this._cache.set(a,O)}return j}_fire(v,P){P=P||{},P.currentTarget=this,P.type=v;const E=this._getProtoListeners(v);if(E)for(let O=0;O<E.length;O++)E[O].handler.call(this,P);const A=this.eventListeners[v];if(A)for(let O=0;O<A.length;O++)A[O].handler.call(this,P)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(v){const P=v?v.pointerId:void 0,E=this.getStage(),A=this.getAbsolutePosition();if(!E)return;const O=E._getPointerById(P)||E._changedPointerPositions[0]||A;e.DD._dragElements.set(this._id,{node:this,startPointerPos:O,offset:{x:O.x-A.x,y:O.y-A.y},dragStatus:"ready",pointerId:P})}startDrag(v,P=!0){e.DD._dragElements.has(this._id)||this._createDragElement(v);const E=e.DD._dragElements.get(this._id);E.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:v&&v.evt},P)}_setDragPosition(v,P){const E=this.getStage()._getPointerById(P.pointerId);if(!E)return;let A={x:E.x-P.offset.x,y:E.y-P.offset.y};const O=this.dragBoundFunc();if(O!==void 0){const j=O.call(this,A,v);j?A=j:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==A.x||this._lastPos.y!==A.y)&&(this.setAbsolutePosition(A),this._requestDraw()),this._lastPos=A}stopDrag(v){const P=e.DD._dragElements.get(this._id);P&&(P.dragStatus="stopped"),e.DD._endDragBefore(v),e.DD._endDragAfter(v)}setDraggable(v){this._setAttr("draggable",v),this._dragChange()}isDragging(){const v=e.DD._dragElements.get(this._id);return v?v.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(v){if(!(!(v.evt.button!==void 0)||i.Konva.dragButtons.indexOf(v.evt.button)>=0)||this.isDragging())return;let A=!1;e.DD._dragElements.forEach(O=>{this.isAncestorOf(O.node)&&(A=!0)}),A||this._createDragElement(v)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const P=e.DD._dragElements.get(this._id),E=P&&P.dragStatus==="dragging",A=P&&P.dragStatus==="ready";E?this.stopDrag():A&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(v={x:0,y:0}){const P=this.getStage();if(!P)return!1;const E={x:-v.x,y:-v.y,width:P.width()+2*v.x,height:P.height()+2*v.y};return s.Util.haveIntersection(E,this.getClientRect())}static create(v,P){return s.Util._isString(v)&&(v=JSON.parse(v)),this._createNode(v,P)}static _createNode(v,P){let E=zs.prototype.getClassName.call(v),A=v.children,O,j,U;P&&(v.attrs.container=P),i.Konva[E]||(s.Util.warn('Can not find a node with class name "'+E+'". Fallback to "Shape".'),E="Shape");const J=i.Konva[E];if(O=new J(v.attrs),A)for(j=A.length,U=0;U<j;U++)O.add(zs._createNode(A[U]));return O}};Fn.Node=B,B.prototype.nodeType="Node",B.prototype._attrsAffectingSize=[],B.prototype.eventListeners={},B.prototype.on.call(B.prototype,G,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(w),this._clearSelfAndDescendantCache(l)}),B.prototype.on.call(B.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(M)}),B.prototype.on.call(B.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(f)}),B.prototype.on.call(B.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const L=n.Factory.addGetterSetter;return L(B,"zIndex"),L(B,"absolutePosition"),L(B,"position"),L(B,"x",0,(0,r.getNumberValidator)()),L(B,"y",0,(0,r.getNumberValidator)()),L(B,"globalCompositeOperation","source-over",(0,r.getStringValidator)()),L(B,"opacity",1,(0,r.getNumberValidator)()),L(B,"name","",(0,r.getStringValidator)()),L(B,"id","",(0,r.getStringValidator)()),L(B,"rotation",0,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(B,"scale",["x","y"]),L(B,"scaleX",1,(0,r.getNumberValidator)()),L(B,"scaleY",1,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(B,"skew",["x","y"]),L(B,"skewX",0,(0,r.getNumberValidator)()),L(B,"skewY",0,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(B,"offset",["x","y"]),L(B,"offsetX",0,(0,r.getNumberValidator)()),L(B,"offsetY",0,(0,r.getNumberValidator)()),L(B,"dragDistance",void 0,(0,r.getNumberValidator)()),L(B,"width",0,(0,r.getNumberValidator)()),L(B,"height",0,(0,r.getNumberValidator)()),L(B,"listening",!0,(0,r.getBooleanValidator)()),L(B,"preventDefault",!0,(0,r.getBooleanValidator)()),L(B,"filters",void 0,function(X){return this._filterUpToDate=!1,X}),L(B,"visible",!0,(0,r.getBooleanValidator)()),L(B,"transformsEnabled","all",(0,r.getStringValidator)()),L(B,"size"),L(B,"dragBoundFunc"),L(B,"draggable",!1,(0,r.getBooleanValidator)()),n.Factory.backCompat(B,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Fn}var Dn={},Ja;function lr(){if(Ja)return Dn;Ja=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.Container=void 0;const t=bt(),e=Ot(),n=St();let i=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(r){const o=this.children||[];return r?o.filter(r):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(r=>{r.parent=null,r.index=0,r.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(r=>{r.parent=null,r.index=0,r.destroy()}),this.children=[],this._requestDraw(),this}add(...r){if(r.length===0)return this;if(r.length>1){for(let a=0;a<r.length;a++)this.add(r[a]);return this}const o=r[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(r){return this._generalFind(r,!1)}findOne(r){const o=this._generalFind(r,!0);return o.length>0?o[0]:void 0}_generalFind(r,o){const a=[];return this._descendants(l=>{const c=l._isMatch(r);return c&&a.push(l),!!(c&&o)}),a}_descendants(r){let o=!1;const a=this.getChildren();for(const l of a){if(o=r(l),o)return!0;if(l.hasChildren()&&(o=l._descendants(r),o))return!0}return!1}toObject(){const r=e.Node.prototype.toObject.call(this);return r.children=[],this.getChildren().forEach(o=>{r.children.push(o.toObject())}),r}isAncestorOf(r){let o=r.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(r){const o=e.Node.prototype.clone.call(this,r);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(r){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(r)&&o.push(a)}),o}_clearSelfAndDescendantCache(r){var o;super._clearSelfAndDescendantCache(r),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(r)}))}_setChildrenIndices(){var r;(r=this.children)===null||r===void 0||r.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(r,o,a){const l=this.getLayer(),c=r||l&&l.getCanvas(),h=c&&c.getContext(),m=this._getCanvasCache(),g=m&&m.scene,u=c&&c.isCache;if(!this.isVisible()&&!u)return this;if(g){h.save();const f=this.getAbsoluteTransform(o).getMatrix();h.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(h),h.restore()}else this._drawChildren("drawScene",c,o,a);return this}drawHit(r,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),l=r||a&&a.hitCanvas,c=l&&l.getContext(),h=this._getCanvasCache();if(h&&h.hit){c.save();const g=this.getAbsoluteTransform(o).getMatrix();c.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",l,o);return this}_drawChildren(r,o,a,l){var c;const h=o&&o.getContext(),m=this.clipWidth(),g=this.clipHeight(),u=this.clipFunc(),f=typeof m=="number"&&typeof g=="number"||u,_=a===this;if(f){h.save();const C=this.getAbsoluteTransform(a);let p=C.getMatrix();h.transform(p[0],p[1],p[2],p[3],p[4],p[5]),h.beginPath();let d;if(u)d=u.call(this,h,this);else{const y=this.clipX(),b=this.clipY();h.rect(y||0,b||0,m,g)}h.clip.apply(h,d),p=C.copy().invert().getMatrix(),h.transform(p[0],p[1],p[2],p[3],p[4],p[5])}const S=!_&&this.globalCompositeOperation()!=="source-over"&&r==="drawScene";S&&(h.save(),h._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(C){C[r](o,a,l)}),S&&h.restore(),f&&h.restore()}getClientRect(r={}){var o;const a=r.skipTransform,l=r.relativeTo;let c,h,m,g,u={x:1/0,y:1/0,width:0,height:0};const f=this;(o=this.children)===null||o===void 0||o.forEach(function(C){if(!C.visible())return;const p=C.getClientRect({relativeTo:f,skipShadow:r.skipShadow,skipStroke:r.skipStroke});p.width===0&&p.height===0||(c===void 0?(c=p.x,h=p.y,m=p.x+p.width,g=p.y+p.height):(c=Math.min(c,p.x),h=Math.min(h,p.y),m=Math.max(m,p.x+p.width),g=Math.max(g,p.y+p.height)))});const _=this.find("Shape");let S=!1;for(let C=0;C<_.length;C++)if(_[C]._isVisible(this)){S=!0;break}return S&&c!==void 0?u={x:c,y:h,width:m-c,height:g-h}:u={x:0,y:0,width:0,height:0},a?u:this._transformedRect(u,l)}};return Dn.Container=i,t.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipFunc"),Dn}var ds={},Le={},Qa;function Za(){if(Qa)return Le;Qa=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.getCapturedShape=i,Le.createEvent=s,Le.hasPointerCapture=r,Le.setPointerCapture=o,Le.releaseCapture=a;const t=_t(),e=new Map,n=t.Konva._global.PointerEvent!==void 0;function i(l){return e.get(l)}function s(l){return{evt:l,pointerId:l.pointerId}}function r(l,c){return e.get(l)===c}function o(l,c){a(l),c.getStage()&&(e.set(l,c),n&&c._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function a(l,c){const h=e.get(l);if(!h)return;const m=h.getStage();m&&m.content,e.delete(l),n&&h._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return Le}var tl;function Eu(){return tl||(tl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Dt(),n=bt(),i=lr(),s=_t(),r=ar(),o=cs(),a=_t(),l=Za(),c="Stage",h="string",m="px",g="mouseout",u="mouseleave",f="mouseover",_="mouseenter",S="mousemove",C="mousedown",p="mouseup",d="pointermove",y="pointerdown",b="pointerup",k="pointercancel",D="lostpointercapture",x="pointerout",w="pointerleave",T="pointerover",M="pointerenter",G="contextmenu",I="touchstart",B="touchend",L="touchmove",X="touchcancel",v="wheel",P=5,E=[[_,"_pointerenter"],[C,"_pointerdown"],[S,"_pointermove"],[p,"_pointerup"],[u,"_pointerleave"],[I,"_pointerdown"],[L,"_pointermove"],[B,"_pointerup"],[X,"_pointercancel"],[f,"_pointerover"],[v,"_wheel"],[G,"_contextmenu"],[y,"_pointerdown"],[d,"_pointermove"],[b,"_pointerup"],[k,"_pointercancel"],[w,"_pointerleave"],[D,"_lostpointercapture"]],A={mouse:{[x]:g,[w]:u,[T]:f,[M]:_,[d]:S,[y]:C,[b]:p,[k]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[x]:"touchout",[w]:"touchleave",[T]:"touchover",[M]:"touchenter",[d]:L,[y]:I,[b]:B,[k]:X,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[x]:x,[w]:w,[T]:T,[M]:M,[d]:d,[y]:y,[b]:b,[k]:k,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},O=$=>$.indexOf("pointer")>=0?"pointer":$.indexOf("touch")>=0?"touch":"mouse",j=$=>{const F=O($);if(F==="pointer")return s.Konva.pointerEventsEnabled&&A.pointer;if(F==="touch")return A.touch;if(F==="mouse")return A.mouse};function U($={}){return($.clipFunc||$.clipWidth||$.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),$}const J="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class st extends i.Container{constructor(F){super(U(F)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{U(this.attrs)}),this._checkVisibility()}_validateAdd(F){const W=F.getType()==="Layer",nt=F.getType()==="FastLayer";W||nt||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const F=this.visible()?"":"none";this.content.style.display=F}setContainer(F){if(typeof F===h){let W;if(F.charAt(0)==="."){const nt=F.slice(1);F=document.getElementsByClassName(nt)[0]}else F.charAt(0)!=="#"?W=F:W=F.slice(1),F=document.getElementById(W);if(!F)throw"Can not find container in document with id "+W}return this._setAttr("container",F),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),F.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const F=this.children,W=F.length;for(let nt=0;nt<W;nt++)F[nt].clear();return this}clone(F){return F||(F={}),F.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,F)}destroy(){super.destroy();const F=this.content;F&&e.Util._isInDocument(F)&&this.container().removeChild(F);const W=t.stages.indexOf(this);return W>-1&&t.stages.splice(W,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const F=this._pointerPositions[0]||this._changedPointerPositions[0];return F?{x:F.x,y:F.y}:(e.Util.warn(J),null)}_getPointerById(F){return this._pointerPositions.find(W=>W.id===F)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(F){F=F||{},F.x=F.x||0,F.y=F.y||0,F.width=F.width||this.width(),F.height=F.height||this.height();const W=new r.SceneCanvas({width:F.width,height:F.height,pixelRatio:F.pixelRatio||1}),nt=W.getContext()._context,it=this.children;return(F.x||F.y)&&nt.translate(-1*F.x,-1*F.y),it.forEach(function(ct){if(!ct.isVisible())return;const R=ct._toKonvaCanvas(F);nt.drawImage(R._canvas,F.x,F.y,R.getWidth()/R.getPixelRatio(),R.getHeight()/R.getPixelRatio())}),W}getIntersection(F){if(!F)return null;const W=this.children,nt=W.length,it=nt-1;for(let ct=it;ct>=0;ct--){const R=W[ct].getIntersection(F);if(R)return R}return null}_resizeDOM(){const F=this.width(),W=this.height();this.content&&(this.content.style.width=F+m,this.content.style.height=W+m),this.bufferCanvas.setSize(F,W),this.bufferHitCanvas.setSize(F,W),this.children.forEach(nt=>{nt.setSize({width:F,height:W}),nt.draw()})}add(F,...W){if(arguments.length>1){for(let it=0;it<arguments.length;it++)this.add(arguments[it]);return this}super.add(F);const nt=this.children.length;return nt>P&&e.Util.warn("The stage has "+nt+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),F.setSize({width:this.width(),height:this.height()}),F.draw(),s.Konva.isBrowser&&this.content.appendChild(F.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(F){return l.hasPointerCapture(F,this)}setPointerCapture(F){l.setPointerCapture(F,this)}releaseCapture(F){l.releaseCapture(F,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&E.forEach(([F,W])=>{this.content.addEventListener(F,nt=>{this[W](nt)},{passive:!1})})}_pointerenter(F){this.setPointersPositions(F);const W=j(F.type);W&&this._fire(W.pointerenter,{evt:F,target:this,currentTarget:this})}_pointerover(F){this.setPointersPositions(F);const W=j(F.type);W&&this._fire(W.pointerover,{evt:F,target:this,currentTarget:this})}_getTargetShape(F){let W=this[F+"targetShape"];return W&&!W.getStage()&&(W=null),W}_pointerleave(F){const W=j(F.type),nt=O(F.type);if(!W)return;this.setPointersPositions(F);const it=this._getTargetShape(nt),ct=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;it&&ct?(it._fireAndBubble(W.pointerout,{evt:F}),it._fireAndBubble(W.pointerleave,{evt:F}),this._fire(W.pointerleave,{evt:F,target:this,currentTarget:this}),this[nt+"targetShape"]=null):ct&&(this._fire(W.pointerleave,{evt:F,target:this,currentTarget:this}),this._fire(W.pointerout,{evt:F,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(F){const W=j(F.type),nt=O(F.type);if(!W)return;this.setPointersPositions(F);let it=!1;this._changedPointerPositions.forEach(ct=>{const R=this.getIntersection(ct);if(o.DD.justDragged=!1,s.Konva["_"+nt+"ListenClick"]=!0,!R||!R.isListening()){this[nt+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&R.setPointerCapture(ct.id),this[nt+"ClickStartShape"]=R,R._fireAndBubble(W.pointerdown,{evt:F,pointerId:ct.id}),it=!0;const N=F.type.indexOf("touch")>=0;R.preventDefault()&&F.cancelable&&N&&F.preventDefault()}),it||this._fire(W.pointerdown,{evt:F,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(F){const W=j(F.type),nt=O(F.type);if(!W||(s.Konva.isDragging()&&o.DD.node.preventDefault()&&F.cancelable&&F.preventDefault(),this.setPointersPositions(F),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const ct={};let R=!1;const N=this._getTargetShape(nt);this._changedPointerPositions.forEach(z=>{const q=l.getCapturedShape(z.id)||this.getIntersection(z),Y=z.id,K={evt:F,pointerId:Y},tt=N!==q;if(tt&&N&&(N._fireAndBubble(W.pointerout,{...K},q),N._fireAndBubble(W.pointerleave,{...K},q)),q){if(ct[q._id])return;ct[q._id]=!0}q&&q.isListening()?(R=!0,tt&&(q._fireAndBubble(W.pointerover,{...K},N),q._fireAndBubble(W.pointerenter,{...K},N),this[nt+"targetShape"]=q),q._fireAndBubble(W.pointermove,{...K})):N&&(this._fire(W.pointerover,{evt:F,target:this,currentTarget:this,pointerId:Y}),this[nt+"targetShape"]=null)}),R||this._fire(W.pointermove,{evt:F,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(F){const W=j(F.type),nt=O(F.type);if(!W)return;this.setPointersPositions(F);const it=this[nt+"ClickStartShape"],ct=this[nt+"ClickEndShape"],R={};let N=!1;this._changedPointerPositions.forEach(z=>{const q=l.getCapturedShape(z.id)||this.getIntersection(z);if(q){if(q.releaseCapture(z.id),R[q._id])return;R[q._id]=!0}const Y=z.id,K={evt:F,pointerId:Y};let tt=!1;s.Konva["_"+nt+"InDblClickWindow"]?(tt=!0,clearTimeout(this[nt+"DblTimeout"])):o.DD.justDragged||(s.Konva["_"+nt+"InDblClickWindow"]=!0,clearTimeout(this[nt+"DblTimeout"])),this[nt+"DblTimeout"]=setTimeout(function(){s.Konva["_"+nt+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),q&&q.isListening()?(N=!0,this[nt+"ClickEndShape"]=q,q._fireAndBubble(W.pointerup,{...K}),s.Konva["_"+nt+"ListenClick"]&&it&&it===q&&(q._fireAndBubble(W.pointerclick,{...K}),tt&&ct&&ct===q&&q._fireAndBubble(W.pointerdblclick,{...K}))):(this[nt+"ClickEndShape"]=null,s.Konva["_"+nt+"ListenClick"]&&this._fire(W.pointerclick,{evt:F,target:this,currentTarget:this,pointerId:Y}),tt&&this._fire(W.pointerdblclick,{evt:F,target:this,currentTarget:this,pointerId:Y}))}),N||this._fire(W.pointerup,{evt:F,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+nt+"ListenClick"]=!1,F.cancelable&&nt!=="touch"&&nt!=="pointer"&&F.preventDefault()}_contextmenu(F){this.setPointersPositions(F);const W=this.getIntersection(this.getPointerPosition());W&&W.isListening()?W._fireAndBubble(G,{evt:F}):this._fire(G,{evt:F,target:this,currentTarget:this})}_wheel(F){this.setPointersPositions(F);const W=this.getIntersection(this.getPointerPosition());W&&W.isListening()?W._fireAndBubble(v,{evt:F}):this._fire(v,{evt:F,target:this,currentTarget:this})}_pointercancel(F){this.setPointersPositions(F);const W=l.getCapturedShape(F.pointerId)||this.getIntersection(this.getPointerPosition());W&&W._fireAndBubble(b,l.createEvent(F)),l.releaseCapture(F.pointerId)}_lostpointercapture(F){l.releaseCapture(F.pointerId)}setPointersPositions(F){const W=this._getContentPosition();let nt=null,it=null;F=F||window.event,F.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(F.touches,ct=>{this._pointerPositions.push({id:ct.identifier,x:(ct.clientX-W.left)/W.scaleX,y:(ct.clientY-W.top)/W.scaleY})}),Array.prototype.forEach.call(F.changedTouches||F.touches,ct=>{this._changedPointerPositions.push({id:ct.identifier,x:(ct.clientX-W.left)/W.scaleX,y:(ct.clientY-W.top)/W.scaleY})})):(nt=(F.clientX-W.left)/W.scaleX,it=(F.clientY-W.top)/W.scaleY,this.pointerPos={x:nt,y:it},this._pointerPositions=[{x:nt,y:it,id:e.Util._getFirstPointerId(F)}],this._changedPointerPositions=[{x:nt,y:it,id:e.Util._getFirstPointerId(F)}])}_setPointerPosition(F){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(F)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const F=this.content.getBoundingClientRect();return{top:F.top,left:F.left,scaleX:F.width/this.content.clientWidth||1,scaleY:F.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new r.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new r.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const F=this.container();if(!F)throw"Stage has no container. A container is required.";F.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),F.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(F){F.batchDraw()}),this}}t.Stage=st,st.prototype.nodeType=c,(0,a._registerNode)(st),n.Factory.addGetterSetter(st,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach($=>{$.batchDraw()})})}(ds)),ds}var Nn={},us={},el;function Ht(){return el||(el=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=_t(),n=Dt(),i=bt(),s=Ot(),r=St(),o=_t(),a=Za(),l="hasShadow",c="shadowRGBA",h="patternImage",m="linearGradient",g="radialGradient";let u;function f(){return u||(u=n.Util.createCanvasElement().getContext("2d"),u)}t.shapes={};function _(w){const T=this.attrs.fillRule;T?w.fill(T):w.fill()}function S(w){w.stroke()}function C(w){const T=this.attrs.fillRule;T?w.fill(T):w.fill()}function p(w){w.stroke()}function d(){this._clearCache(l)}function y(){this._clearCache(c)}function b(){this._clearCache(h)}function k(){this._clearCache(m)}function D(){this._clearCache(g)}class x extends s.Node{constructor(T){super(T);let M;for(;M=n.Util.getRandomColor(),!(M&&!(M in t.shapes)););this.colorKey=M,t.shapes[M]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const M=f().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(M&&M.setTransform){const G=new n.Transform;G.translate(this.fillPatternX(),this.fillPatternY()),G.rotate(e.Konva.getAngle(this.fillPatternRotation())),G.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),G.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const I=G.getMatrix(),B=typeof DOMMatrix>"u"?{a:I[0],b:I[1],c:I[2],d:I[3],e:I[4],f:I[5]}:new DOMMatrix(I);M.setTransform(B)}return M}}_getLinearGradient(){return this._getCache(m,this.__getLinearGradient)}__getLinearGradient(){const T=this.fillLinearGradientColorStops();if(T){const M=f(),G=this.fillLinearGradientStartPoint(),I=this.fillLinearGradientEndPoint(),B=M.createLinearGradient(G.x,G.y,I.x,I.y);for(let L=0;L<T.length;L+=2)B.addColorStop(T[L],T[L+1]);return B}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const T=this.fillRadialGradientColorStops();if(T){const M=f(),G=this.fillRadialGradientStartPoint(),I=this.fillRadialGradientEndPoint(),B=M.createRadialGradient(G.x,G.y,this.fillRadialGradientStartRadius(),I.x,I.y,this.fillRadialGradientEndRadius());for(let L=0;L<T.length;L+=2)B.addColorStop(T[L],T[L+1]);return B}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const T=n.Util.colorToRGBA(this.shadowColor());if(T)return"rgba("+T.r+","+T.g+","+T.b+","+T.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const T=this.hitStrokeWidth();return T==="auto"?this.hasStroke():this.strokeEnabled()&&!!T}intersects(T){const M=this.getStage();if(!M)return!1;const G=M.bufferHitCanvas;return G.getContext().clear(),this.drawHit(G,void 0,!0),G.context.getImageData(Math.round(T.x),Math.round(T.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(T){var M;if(!((M=this.attrs.perfectDrawEnabled)!==null&&M!==void 0?M:!0))return!1;const I=T||this.hasFill(),B=this.hasStroke(),L=this.getAbsoluteOpacity()!==1;if(I&&B&&L)return!0;const X=this.hasShadow(),v=this.shadowForStrokeEnabled();return!!(I&&B&&X&&v)}setStrokeHitEnabled(T){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),T?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const T=this.size();return{x:this._centroid?-T.width/2:0,y:this._centroid?-T.height/2:0,width:T.width,height:T.height}}getClientRect(T={}){let M=!1,G=this.getParent();for(;G;){if(G.isCached()){M=!0;break}G=G.getParent()}const I=T.skipTransform,B=T.relativeTo||M&&this.getStage()||void 0,L=this.getSelfRect(),v=!T.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,P=L.width+v,E=L.height+v,A=!T.skipShadow&&this.hasShadow(),O=A?this.shadowOffsetX():0,j=A?this.shadowOffsetY():0,U=P+Math.abs(O),J=E+Math.abs(j),st=A&&this.shadowBlur()||0,$=U+st*2,F=J+st*2,W={width:$,height:F,x:-(v/2+st)+Math.min(O,0)+L.x,y:-(v/2+st)+Math.min(j,0)+L.y};return I?W:this._transformedRect(W,B)}drawScene(T,M,G){const I=this.getLayer(),B=T||I.getCanvas(),L=B.getContext(),X=this._getCanvasCache(),v=this.getSceneFunc(),P=this.hasShadow();let E;const A=M===this;if(!this.isVisible()&&!A)return this;if(X){L.save();const O=this.getAbsoluteTransform(M).getMatrix();return L.transform(O[0],O[1],O[2],O[3],O[4],O[5]),this._drawCachedSceneCanvas(L),L.restore(),this}if(!v)return this;if(L.save(),this._useBufferCanvas()){E=this.getStage();const O=G||E.bufferCanvas,j=O.getContext();j.clear(),j.save(),j._applyLineJoin(this);const U=this.getAbsoluteTransform(M).getMatrix();j.transform(U[0],U[1],U[2],U[3],U[4],U[5]),v.call(this,j,this),j.restore();const J=O.pixelRatio;P&&L._applyShadow(this),L._applyOpacity(this),L._applyGlobalCompositeOperation(this),L.drawImage(O._canvas,O.x||0,O.y||0,O.width/J,O.height/J)}else{if(L._applyLineJoin(this),!A){const O=this.getAbsoluteTransform(M).getMatrix();L.transform(O[0],O[1],O[2],O[3],O[4],O[5]),L._applyOpacity(this),L._applyGlobalCompositeOperation(this)}P&&L._applyShadow(this),v.call(this,L,this)}return L.restore(),this}drawHit(T,M,G=!1){if(!this.shouldDrawHit(M,G))return this;const I=this.getLayer(),B=T||I.hitCanvas,L=B&&B.getContext(),X=this.hitFunc()||this.sceneFunc(),v=this._getCanvasCache(),P=v&&v.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),P){L.save();const A=this.getAbsoluteTransform(M).getMatrix();return L.transform(A[0],A[1],A[2],A[3],A[4],A[5]),this._drawCachedHitCanvas(L),L.restore(),this}if(!X)return this;if(L.save(),L._applyLineJoin(this),!(this===M)){const A=this.getAbsoluteTransform(M).getMatrix();L.transform(A[0],A[1],A[2],A[3],A[4],A[5])}return X.call(this,L,this),L.restore(),this}drawHitFromCache(T=0){const M=this._getCanvasCache(),G=this._getCachedSceneCanvas(),I=M.hit,B=I.getContext(),L=I.getWidth(),X=I.getHeight();B.clear(),B.drawImage(G._canvas,0,0,L,X);try{const v=B.getImageData(0,0,L,X),P=v.data,E=P.length,A=n.Util._hexToRgb(this.colorKey);for(let O=0;O<E;O+=4)P[O+3]>T?(P[O]=A.r,P[O+1]=A.g,P[O+2]=A.b,P[O+3]=255):P[O+3]=0;B.putImageData(v,0,0)}catch(v){n.Util.error("Unable to draw hit graph from cached scene canvas. "+v.message)}return this}hasPointerCapture(T){return a.hasPointerCapture(T,this)}setPointerCapture(T){a.setPointerCapture(T,this)}releaseCapture(T){a.releaseCapture(T,this)}}t.Shape=x,x.prototype._fillFunc=_,x.prototype._strokeFunc=S,x.prototype._fillFuncHit=C,x.prototype._strokeFuncHit=p,x.prototype._centroid=!1,x.prototype.nodeType="Shape",(0,o._registerNode)(x),x.prototype.eventListeners={},x.prototype.on.call(x.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",d),x.prototype.on.call(x.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",b),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",k),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",D),i.Factory.addGetterSetter(x,"stroke",void 0,(0,r.getStringOrGradientValidator)()),i.Factory.addGetterSetter(x,"strokeWidth",2,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(x,"hitStrokeWidth","auto",(0,r.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(x,"strokeHitEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"perfectDrawEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"shadowForStrokeEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"lineJoin"),i.Factory.addGetterSetter(x,"lineCap"),i.Factory.addGetterSetter(x,"sceneFunc"),i.Factory.addGetterSetter(x,"hitFunc"),i.Factory.addGetterSetter(x,"dash"),i.Factory.addGetterSetter(x,"dashOffset",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowColor",void 0,(0,r.getStringValidator)()),i.Factory.addGetterSetter(x,"shadowBlur",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowOpacity",1,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(x,"shadowOffsetX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowOffsetY",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternImage"),i.Factory.addGetterSetter(x,"fill",void 0,(0,r.getStringOrGradientValidator)()),i.Factory.addGetterSetter(x,"fillPatternX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternY",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(x,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(x,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(x,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(x,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(x,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(x,"fillEnabled",!0),i.Factory.addGetterSetter(x,"strokeEnabled",!0),i.Factory.addGetterSetter(x,"shadowEnabled",!0),i.Factory.addGetterSetter(x,"dashEnabled",!0),i.Factory.addGetterSetter(x,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(x,"fillPriority","color"),i.Factory.addComponentsGetterSetter(x,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(x,"fillPatternOffsetX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternOffsetY",0,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(x,"fillPatternScaleX",1,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternScaleY",1,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(x,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(x,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(x,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(x,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(x,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(x,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(x,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(x,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(x,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(x,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(x,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(x,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(x,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(x,"fillPatternRotation",0),i.Factory.addGetterSetter(x,"fillRule",void 0,(0,r.getStringValidator)()),i.Factory.backCompat(x,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(us)),us}var nl;function il(){if(nl)return Nn;nl=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.Layer=void 0;const t=Dt(),e=lr(),n=Ot(),i=bt(),s=ar(),r=St(),o=Ht(),a=_t(),l="#",c="beforeDraw",h="draw",m=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=m.length;let u=class extends e.Container{constructor(_){super(_),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(_){return this.getContext().clear(_),this.getHitCanvas().getContext().clear(_),this}setZIndex(_){super.setZIndex(_);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),_<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[_+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);const _=this.getStage();return _&&_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!n.Node.prototype.moveUp.call(this))return!1;const S=this.getStage();return!S||!S.content?!1:(S.content.removeChild(this.getNativeCanvasElement()),this.index<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[this.index+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){const _=this.getStage();if(_){const S=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),S[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){const _=this.getStage();if(_){const S=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),S[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const _=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),_&&_.parentNode&&t.Util._isInDocument(_)&&_.parentNode.removeChild(_),this}getStage(){return this.parent}setSize({width:_,height:S}){return this.canvas.setSize(_,S),this.hitCanvas.setSize(_,S),this._setSmoothEnabled(),this}_validateAdd(_){const S=_.getType();S!=="Group"&&S!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(_){return _=_||{},_.width=_.width||this.getWidth(),_.height=_.height||this.getHeight(),_.x=_.x!==void 0?_.x:this.x(),_.y=_.y!==void 0?_.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,_)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(_){if(!this.isListening()||!this.isVisible())return null;let S=1,C=!1;for(;;){for(let p=0;p<g;p++){const d=m[p],y=this._getIntersection({x:_.x+d.x*S,y:_.y+d.y*S}),b=y.shape;if(b)return b;if(C=!!y.antialiased,!y.antialiased)break}if(C)S+=1;else return null}}_getIntersection(_){const S=this.hitCanvas.pixelRatio,C=this.hitCanvas.context.getImageData(Math.round(_.x*S),Math.round(_.y*S),1,1).data,p=C[3];if(p===255){const d=t.Util._rgbToHex(C[0],C[1],C[2]),y=o.shapes[l+d];return y?{shape:y}:{antialiased:!0}}else if(p>0)return{antialiased:!0};return{}}drawScene(_,S,C){const p=this.getLayer(),d=_||p&&p.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&d.getContext().clear(),e.Container.prototype.drawScene.call(this,d,S,C),this._fire(h,{node:this}),this}drawHit(_,S){const C=this.getLayer(),p=_||C&&C.hitCanvas;return C&&C.clearBeforeDraw()&&C.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,p,S),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(_){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(_)}getHitGraphEnabled(_){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const _=this.parent;!!this.hitCanvas._canvas.parentNode?_.content.removeChild(this.hitCanvas._canvas):_.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return Nn.Layer=u,u.prototype.nodeType="Layer",(0,a._registerNode)(u),i.Factory.addGetterSetter(u,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(u,"clearBeforeDraw",!0),i.Factory.addGetterSetter(u,"hitGraphEnabled",!0,(0,r.getBooleanValidator)()),Nn}var On={},rl;function Mu(){if(rl)return On;rl=1,Object.defineProperty(On,"__esModule",{value:!0}),On.FastLayer=void 0;const t=Dt(),e=il(),n=_t();let i=class extends e.Layer{constructor(r){super(r),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return On.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),On}var Gn={},sl;function fs(){if(sl)return Gn;sl=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.Group=void 0;const t=Dt(),e=lr(),n=_t();let i=class extends e.Container{_validateAdd(r){const o=r.getType();o!=="Group"&&o!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return Gn.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),Gn}var Ln={},ol;function gs(){if(ol)return Ln;ol=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.Animation=void 0;const t=_t(),e=Dt(),n=function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}}();let i=class fn{constructor(r,o){this.id=fn.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=r,this.setLayers(o)}setLayers(r){let o=[];return r&&(o=Array.isArray(r)?r:[r]),this.layers=o,this}getLayers(){return this.layers}addLayer(r){const o=this.layers,a=o.length;for(let l=0;l<a;l++)if(o[l]._id===r._id)return!1;return this.layers.push(r),!0}isRunning(){const o=fn.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),fn._addAnimation(this),this}stop(){return fn._removeAnimation(this),this}_updateFrameObject(r){this.frame.timeDiff=r-this.frame.lastTime,this.frame.lastTime=r,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(r){this.animations.push(r),this._handleAnimation()}static _removeAnimation(r){const o=r.id,a=this.animations,l=a.length;for(let c=0;c<l;c++)if(a[c].id===o){this.animations.splice(c,1);break}}static _runFrames(){const r={},o=this.animations;for(let a=0;a<o.length;a++){const l=o[a],c=l.layers,h=l.func;l._updateFrameObject(n());const m=c.length;let g;if(h?g=h.call(l,l.frame)!==!1:g=!0,!!g)for(let u=0;u<m;u++){const f=c[u];f._id!==void 0&&(r[f._id]=f)}}for(const a in r)r.hasOwnProperty(a)&&r[a].batchDraw()}static _animationLoop(){const r=fn;r.animations.length?(r._runFrames(),e.Util.requestAnimFrame(r._animationLoop)):r.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return Ln.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,Ln}var ps={},al;function Fu(){return al||(al=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Dt(),n=gs(),i=Ot(),s=_t(),r={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,l=3,c=["fill","stroke","shadowColor"];let h=0;class m{constructor(f,_,S,C,p,d,y){this.prop=f,this.propFunc=_,this.begin=C,this._pos=C,this.duration=d,this._change=0,this.prevPos=0,this.yoyo=y,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=S,this._change=p-this.begin,this.pause()}fire(f){const _=this[f];_&&_()}setTime(f){f>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():f<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=f,this.update())}getTime(){return this._time}setPosition(f){this.prevPos=this._pos,this.propFunc(f),this._pos=f}getPosition(f){return f===void 0&&(f=this._time),this.func(f,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(f){this.pause(),this._time=f,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const f=this.getTimer()-this._startTime;this.state===a?this.setTime(f):this.state===l&&this.setTime(this.duration-f)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(f){const _=this,S=f.node,C=S._id,p=f.easing||t.Easings.Linear,d=!!f.yoyo;let y,b;typeof f.duration>"u"?y=.3:f.duration===0?y=.001:y=f.duration,this.node=S,this._id=h++;const k=S.getLayer()||(S instanceof s.Konva.Stage?S.getLayers():null);k||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){_.tween.onEnterFrame()},k),this.tween=new m(b,function(D){_._tweenFunc(D)},p,0,1,y*1e3,d),this._addListeners(),g.attrs[C]||(g.attrs[C]={}),g.attrs[C][this._id]||(g.attrs[C][this._id]={}),g.tweens[C]||(g.tweens[C]={});for(b in f)r[b]===void 0&&this._addAttr(b,f[b]);this.reset(),this.onFinish=f.onFinish,this.onReset=f.onReset,this.onUpdate=f.onUpdate}_addAttr(f,_){const S=this.node,C=S._id;let p,d,y,b,k;const D=g.tweens[C][f];D&&delete g.attrs[C][D][f];let x=S.getAttr(f);if(e.Util._isArray(_))if(p=[],d=Math.max(_.length,x.length),f==="points"&&_.length!==x.length&&(_.length>x.length?(b=x,x=e.Util._prepareArrayForTween(x,_,S.closed())):(y=_,_=e.Util._prepareArrayForTween(_,x,S.closed()))),f.indexOf("fill")===0)for(let w=0;w<d;w++)if(w%2===0)p.push(_[w]-x[w]);else{const T=e.Util.colorToRGBA(x[w]);k=e.Util.colorToRGBA(_[w]),x[w]=T,p.push({r:k.r-T.r,g:k.g-T.g,b:k.b-T.b,a:k.a-T.a})}else for(let w=0;w<d;w++)p.push(_[w]-x[w]);else c.indexOf(f)!==-1?(x=e.Util.colorToRGBA(x),k=e.Util.colorToRGBA(_),p={r:k.r-x.r,g:k.g-x.g,b:k.b-x.b,a:k.a-x.a}):p=_-x;g.attrs[C][this._id][f]={start:x,diff:p,end:_,trueEnd:y,trueStart:b},g.tweens[C][f]=this._id}_tweenFunc(f){const _=this.node,S=g.attrs[_._id][this._id];let C,p,d,y,b,k,D,x;for(C in S){if(p=S[C],d=p.start,y=p.diff,x=p.end,e.Util._isArray(d))if(b=[],D=Math.max(d.length,x.length),C.indexOf("fill")===0)for(k=0;k<D;k++)k%2===0?b.push((d[k]||0)+y[k]*f):b.push("rgba("+Math.round(d[k].r+y[k].r*f)+","+Math.round(d[k].g+y[k].g*f)+","+Math.round(d[k].b+y[k].b*f)+","+(d[k].a+y[k].a*f)+")");else for(k=0;k<D;k++)b.push((d[k]||0)+y[k]*f);else c.indexOf(C)!==-1?b="rgba("+Math.round(d.r+y.r*f)+","+Math.round(d.g+y.g*f)+","+Math.round(d.b+y.b*f)+","+(d.a+y.a*f)+")":b=d+y*f;_.setAttr(C,b)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const f=this.node,_=g.attrs[f._id][this._id];_.points&&_.points.trueEnd&&f.setAttr("points",_.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const f=this.node,_=g.attrs[f._id][this._id];_.points&&_.points.trueStart&&f.points(_.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(f){return this.tween.seek(f*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const f=this.node._id,_=this._id,S=g.tweens[f];this.pause(),this.anim&&this.anim.stop();for(const C in S)delete g.tweens[f][C];delete g.attrs[f][_],Object.keys(g.tweens[f]).length===0&&delete g.tweens[f],Object.keys(g.attrs[f]).length===0&&delete g.attrs[f]}}t.Tween=g,g.attrs={},g.tweens={},i.Node.prototype.to=function(u){const f=u.onFinish;u.node=this,u.onFinish=function(){this.destroy(),f&&f()},new g(u).play()},t.Easings={BackEaseIn(u,f,_,S){return _*(u/=S)*u*(2.70158*u-1.70158)+f},BackEaseOut(u,f,_,S){return _*((u=u/S-1)*u*(2.70158*u+1.70158)+1)+f},BackEaseInOut(u,f,_,S){let C=1.70158;return(u/=S/2)<1?_/2*(u*u*(((C*=1.525)+1)*u-C))+f:_/2*((u-=2)*u*(((C*=1.525)+1)*u+C)+2)+f},ElasticEaseIn(u,f,_,S,C,p){let d=0;return u===0?f:(u/=S)===1?f+_:(p||(p=S*.3),!C||C<Math.abs(_)?(C=_,d=p/4):d=p/(2*Math.PI)*Math.asin(_/C),-(C*Math.pow(2,10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/p))+f)},ElasticEaseOut(u,f,_,S,C,p){let d=0;return u===0?f:(u/=S)===1?f+_:(p||(p=S*.3),!C||C<Math.abs(_)?(C=_,d=p/4):d=p/(2*Math.PI)*Math.asin(_/C),C*Math.pow(2,-10*u)*Math.sin((u*S-d)*(2*Math.PI)/p)+_+f)},ElasticEaseInOut(u,f,_,S,C,p){let d=0;return u===0?f:(u/=S/2)===2?f+_:(p||(p=S*.44999999999999996),!C||C<Math.abs(_)?(C=_,d=p/4):d=p/(2*Math.PI)*Math.asin(_/C),u<1?-.5*(C*Math.pow(2,10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/p))+f:C*Math.pow(2,-10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/p)*.5+_+f)},BounceEaseOut(u,f,_,S){return(u/=S)<.36363636363636365?_*(7.5625*u*u)+f:u<.7272727272727273?_*(7.5625*(u-=.5454545454545454)*u+.75)+f:u<.9090909090909091?_*(7.5625*(u-=.8181818181818182)*u+.9375)+f:_*(7.5625*(u-=.9545454545454546)*u+.984375)+f},BounceEaseIn(u,f,_,S){return _-t.Easings.BounceEaseOut(S-u,0,_,S)+f},BounceEaseInOut(u,f,_,S){return u<S/2?t.Easings.BounceEaseIn(u*2,0,_,S)*.5+f:t.Easings.BounceEaseOut(u*2-S,0,_,S)*.5+_*.5+f},EaseIn(u,f,_,S){return _*(u/=S)*u+f},EaseOut(u,f,_,S){return-_*(u/=S)*(u-2)+f},EaseInOut(u,f,_,S){return(u/=S/2)<1?_/2*u*u+f:-_/2*(--u*(u-2)-1)+f},StrongEaseIn(u,f,_,S){return _*(u/=S)*u*u*u*u+f},StrongEaseOut(u,f,_,S){return _*((u=u/S-1)*u*u*u*u+1)+f},StrongEaseInOut(u,f,_,S){return(u/=S/2)<1?_/2*u*u*u*u*u+f:_/2*((u-=2)*u*u*u*u+2)+f},Linear(u,f,_,S){return _*u/S+f}}}(ps)),ps}var ll;function Du(){return ll||(ll=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=_t(),n=Dt(),i=Ot(),s=lr(),r=Eu(),o=il(),a=Mu(),l=fs(),c=cs(),h=Ht(),m=gs(),g=Fu(),u=$a(),f=ar();t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:s.Container,Stage:r.Stage,stages:r.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:c.DD,Shape:h.Shape,shapes:h.shapes,Animation:m.Animation,Tween:g.Tween,Easings:g.Easings,Context:u.Context,Canvas:f.Canvas}),t.default=t.Konva}(ss)),ss}var In={},cl;function Nu(){if(cl)return In;cl=1,Object.defineProperty(In,"__esModule",{value:!0}),In.Arc=void 0;const t=bt(),e=Ht(),n=_t(),i=St(),s=_t();let r=class extends e.Shape{_sceneFunc(a){const l=n.Konva.getAngle(this.angle()),c=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,c),a.arc(0,0,this.innerRadius(),l,0,!c),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),c=this.clockwise(),h=n.Konva.getAngle(c?360-this.angle():this.angle()),m=Math.cos(Math.min(h,Math.PI)),g=1,u=Math.sin(Math.min(Math.max(Math.PI,h),3*Math.PI/2)),f=Math.sin(Math.min(h,Math.PI/2)),_=m*(m>0?a:l),S=g*l,C=u*(u>0?a:l),p=f*(f>0?l:a);return{x:_,y:c?-1*p:C,width:S-_,height:p-C}}};return In.Arc=r,r.prototype._centroid=!0,r.prototype.className="Arc",r.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clockwise",!1,(0,i.getBooleanValidator)()),In}var Un={},Bn={},hl;function dl(){if(hl)return Bn;hl=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.Line=void 0;const t=bt(),e=_t(),n=Ht(),i=St();function s(a,l,c,h,m,g,u){const f=Math.sqrt(Math.pow(c-a,2)+Math.pow(h-l,2)),_=Math.sqrt(Math.pow(m-c,2)+Math.pow(g-h,2)),S=u*f/(f+_),C=u*_/(f+_),p=c-S*(m-a),d=h-S*(g-l),y=c+C*(m-a),b=h+C*(g-l);return[p,d,y,b]}function r(a,l){const c=a.length,h=[];for(let m=2;m<c-2;m+=2){const g=s(a[m-2],a[m-1],a[m],a[m+1],a[m+2],a[m+3],l);isNaN(g[0])||(h.push(g[0]),h.push(g[1]),h.push(a[m]),h.push(a[m+1]),h.push(g[2]),h.push(g[3]))}return h}let o=class extends n.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const c=this.points(),h=c.length,m=this.tension(),g=this.closed(),u=this.bezier();if(!h)return;let f=0;if(l.beginPath(),l.moveTo(c[0],c[1]),m!==0&&h>4){const _=this.getTensionPoints(),S=_.length;for(f=g?0:4,g||l.quadraticCurveTo(_[0],_[1],_[2],_[3]);f<S-2;)l.bezierCurveTo(_[f++],_[f++],_[f++],_[f++],_[f++],_[f++]);g||l.quadraticCurveTo(_[S-2],_[S-1],c[h-2],c[h-1])}else if(u)for(f=2;f<h;)l.bezierCurveTo(c[f++],c[f++],c[f++],c[f++],c[f++],c[f++]);else for(f=2;f<h;f+=2)l.lineTo(c[f],c[f+1]);g?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():r(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),c=l.length,h=this.tension(),m=s(l[c-2],l[c-1],l[0],l[1],l[2],l[3],h),g=s(l[c-4],l[c-3],l[c-2],l[c-1],l[0],l[1],h),u=r(l,h);return[m[2],m[3]].concat(u).concat([g[0],g[1],l[c-2],l[c-1],g[2],g[3],m[0],m[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let c=l[0],h=l[0],m=l[1],g=l[1],u,f;for(let _=0;_<l.length/2;_++)u=l[_*2],f=l[_*2+1],c=Math.min(c,u),h=Math.max(h,u),m=Math.min(m,f),g=Math.max(g,f);return{x:c,y:m,width:h-c,height:g-m}}};return Bn.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),t.Factory.addGetterSetter(o,"closed",!1),t.Factory.addGetterSetter(o,"bezier",!1),t.Factory.addGetterSetter(o,"tension",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,"points",[],(0,i.getNumberArrayValidator)()),Bn}var Hn={},ms={},ul;function Ou(){return ul||(ul=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,l)=>{let c,h;const g=l/2;c=0;for(let u=0;u<20;u++)h=g*t.tValues[20][u]+g,c+=t.cValues[20][u]*i(o,a,h);return g*c};t.getCubicArcLength=e;const n=(o,a,l)=>{l===void 0&&(l=1);const c=o[0]-2*o[1]+o[2],h=a[0]-2*a[1]+a[2],m=2*o[1]-2*o[0],g=2*a[1]-2*a[0],u=4*(c*c+h*h),f=4*(c*m+h*g),_=m*m+g*g;if(u===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const S=f/(2*u),C=_/u,p=l+S,d=C-S*S,y=p*p+d>0?Math.sqrt(p*p+d):0,b=S*S+d>0?Math.sqrt(S*S+d):0,k=S+Math.sqrt(S*S+d)!==0?d*Math.log(Math.abs((p+y)/(S+b))):0;return Math.sqrt(u)/2*(p*y-S*b+k)};t.getQuadraticArcLength=n;function i(o,a,l){const c=s(1,l,o),h=s(1,l,a),m=c*c+h*h;return Math.sqrt(m)}const s=(o,a,l)=>{const c=l.length-1;let h,m;if(c===0)return 0;if(o===0){m=0;for(let g=0;g<=c;g++)m+=t.binomialCoefficients[c][g]*Math.pow(1-a,c-g)*Math.pow(a,g)*l[g];return m}else{h=new Array(c);for(let g=0;g<c;g++)h[g]=c*(l[g+1]-l[g]);return s(o-1,a,h)}},r=(o,a,l)=>{let c=1,h=o/a,m=(o-l(h))/a,g=0;for(;c>.001;){const u=l(h+m),f=Math.abs(o-u)/a;if(f<c)c=f,h+=m;else{const _=l(h-m),S=Math.abs(o-_)/a;S<c?(c=S,h-=m):m/=2}if(g++,g>500)break}return h};t.t2length=r}(ms)),ms}var fl;function ys(){if(fl)return Hn;fl=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.Path=void 0;const t=bt(),e=_t(),n=Ht(),i=Ou();let s=class Qt extends n.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Qt.parsePathData(this.data()),this.pathLength=Qt.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let l=!1;for(let c=0;c<a.length;c++){const h=a[c].command,m=a[c].points;switch(h){case"L":o.lineTo(m[0],m[1]);break;case"M":o.moveTo(m[0],m[1]);break;case"C":o.bezierCurveTo(m[0],m[1],m[2],m[3],m[4],m[5]);break;case"Q":o.quadraticCurveTo(m[0],m[1],m[2],m[3]);break;case"A":const g=m[0],u=m[1],f=m[2],_=m[3],S=m[4],C=m[5],p=m[6],d=m[7],y=f>_?f:_,b=f>_?1:f/_,k=f>_?_/f:1;o.translate(g,u),o.rotate(p),o.scale(b,k),o.arc(0,0,y,S,S+C,1-d),o.scale(1/b,1/k),o.rotate(-p),o.translate(-g,-u);break;case"z":l=!0,o.closePath();break}}!l&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],_=u.points[5],S=u.points[4]+_;let C=Math.PI/180;if(Math.abs(f-S)<C&&(C=Math.abs(f-S)),_<0)for(let p=f-C;p>S;p-=C){const d=Qt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],p,0);o.push(d.x,d.y)}else for(let p=f+C;p<S;p+=C){const d=Qt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],p,0);o.push(d.x,d.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const _=Qt.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);o.push(_.x,_.y)}else o=o.concat(u.points)});let a=o[0],l=o[0],c=o[1],h=o[1],m,g;for(let u=0;u<o.length/2;u++)m=o[u*2],g=o[u*2+1],isNaN(m)||(a=Math.min(a,m),l=Math.max(l,m)),isNaN(g)||(c=Math.min(c,g),h=Math.max(h,g));return{x:a,y:c,width:l-a,height:h-c}}getLength(){return this.pathLength}getPointAtLength(o){return Qt.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,l,c){return Math.sqrt((l-o)*(l-o)+(c-a)*(c-a))}static getPathLength(o){let a=0;for(let l=0;l<o.length;++l)a+=o[l].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let l,c=0,h=a.length;if(!h)return null;for(;c<h&&o>a[c].pathLength;)o-=a[c].pathLength,++c;if(c===h)return l=a[c-1].points.slice(-2),{x:l[0],y:l[1]};if(o<.01)return a[c].command==="M"?(l=a[c].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[c].start.x,y:a[c].start.y};const m=a[c],g=m.points;switch(m.command){case"L":return Qt.getPointOnLine(o,m.start.x,m.start.y,g[0],g[1]);case"C":return Qt.getPointOnCubicBezier((0,i.t2length)(o,Qt.getPathLength(a),y=>(0,i.getCubicArcLength)([m.start.x,g[0],g[2],g[4]],[m.start.y,g[1],g[3],g[5]],y)),m.start.x,m.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return Qt.getPointOnQuadraticBezier((0,i.t2length)(o,Qt.getPathLength(a),y=>(0,i.getQuadraticArcLength)([m.start.x,g[0],g[2]],[m.start.y,g[1],g[3]],y)),m.start.x,m.start.y,g[0],g[1],g[2],g[3]);case"A":const u=g[0],f=g[1],_=g[2],S=g[3],C=g[5],p=g[6];let d=g[4];return d+=C*o/m.pathLength,Qt.getPointOnEllipticalArc(u,f,_,S,d,p)}return null}static getPointOnLine(o,a,l,c,h,m,g){m=m??a,g=g??l;const u=this.getLineLength(a,l,c,h);if(u<1e-10)return{x:a,y:l};if(c===a)return{x:m,y:g+(h>l?o:-o)};const f=(h-l)/(c-a),_=Math.sqrt(o*o/(1+f*f))*(c<a?-1:1),S=f*_;if(Math.abs(g-l-f*(m-a))<1e-10)return{x:m+_,y:g+S};const C=((m-a)*(c-a)+(g-l)*(h-l))/(u*u),p=a+C*(c-a),d=l+C*(h-l),y=this.getLineLength(m,g,p,d),b=Math.sqrt(o*o-y*y),k=Math.sqrt(b*b/(1+f*f))*(c<a?-1:1),D=f*k;return{x:p+k,y:d+D}}static getPointOnCubicBezier(o,a,l,c,h,m,g,u,f){function _(b){return b*b*b}function S(b){return 3*b*b*(1-b)}function C(b){return 3*b*(1-b)*(1-b)}function p(b){return(1-b)*(1-b)*(1-b)}const d=u*_(o)+m*S(o)+c*C(o)+a*p(o),y=f*_(o)+g*S(o)+h*C(o)+l*p(o);return{x:d,y}}static getPointOnQuadraticBezier(o,a,l,c,h,m,g){function u(p){return p*p}function f(p){return 2*p*(1-p)}function _(p){return(1-p)*(1-p)}const S=m*u(o)+c*f(o)+a*_(o),C=g*u(o)+h*f(o)+l*_(o);return{x:S,y:C}}static getPointOnEllipticalArc(o,a,l,c,h,m){const g=Math.cos(m),u=Math.sin(m),f={x:l*Math.cos(h),y:c*Math.sin(h)};return{x:o+(f.x*g-f.y*u),y:a+(f.x*u+f.y*g)}}static parsePathData(o){if(!o)return[];let a=o;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let S=0;S<l.length;S++)a=a.replace(new RegExp(l[S],"g"),"|"+l[S]);const c=a.split("|"),h=[],m=[];let g=0,u=0;const f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let S=1;S<c.length;S++){let C=c[S],p=C.charAt(0);for(C=C.slice(1),m.length=0;_=f.exec(C);)m.push(_[0]);const d=[];for(let y=0,b=m.length;y<b;y++){if(m[y]==="00"){d.push(0,0);continue}const k=parseFloat(m[y]);isNaN(k)?d.push(0):d.push(k)}for(;d.length>0&&!isNaN(d[0]);){let y="",b=[];const k=g,D=u;let x,w,T,M,G,I,B,L,X,v;switch(p){case"l":g+=d.shift(),u+=d.shift(),y="L",b.push(g,u);break;case"L":g=d.shift(),u=d.shift(),b.push(g,u);break;case"m":const P=d.shift(),E=d.shift();if(g+=P,u+=E,y="M",h.length>2&&h[h.length-1].command==="z"){for(let A=h.length-2;A>=0;A--)if(h[A].command==="M"){g=h[A].points[0]+P,u=h[A].points[1]+E;break}}b.push(g,u),p="l";break;case"M":g=d.shift(),u=d.shift(),y="M",b.push(g,u),p="L";break;case"h":g+=d.shift(),y="L",b.push(g,u);break;case"H":g=d.shift(),y="L",b.push(g,u);break;case"v":u+=d.shift(),y="L",b.push(g,u);break;case"V":u=d.shift(),y="L",b.push(g,u);break;case"C":b.push(d.shift(),d.shift(),d.shift(),d.shift()),g=d.shift(),u=d.shift(),b.push(g,u);break;case"c":b.push(g+d.shift(),u+d.shift(),g+d.shift(),u+d.shift()),g+=d.shift(),u+=d.shift(),y="C",b.push(g,u);break;case"S":w=g,T=u,x=h[h.length-1],x.command==="C"&&(w=g+(g-x.points[2]),T=u+(u-x.points[3])),b.push(w,T,d.shift(),d.shift()),g=d.shift(),u=d.shift(),y="C",b.push(g,u);break;case"s":w=g,T=u,x=h[h.length-1],x.command==="C"&&(w=g+(g-x.points[2]),T=u+(u-x.points[3])),b.push(w,T,g+d.shift(),u+d.shift()),g+=d.shift(),u+=d.shift(),y="C",b.push(g,u);break;case"Q":b.push(d.shift(),d.shift()),g=d.shift(),u=d.shift(),b.push(g,u);break;case"q":b.push(g+d.shift(),u+d.shift()),g+=d.shift(),u+=d.shift(),y="Q",b.push(g,u);break;case"T":w=g,T=u,x=h[h.length-1],x.command==="Q"&&(w=g+(g-x.points[0]),T=u+(u-x.points[1])),g=d.shift(),u=d.shift(),y="Q",b.push(w,T,g,u);break;case"t":w=g,T=u,x=h[h.length-1],x.command==="Q"&&(w=g+(g-x.points[0]),T=u+(u-x.points[1])),g+=d.shift(),u+=d.shift(),y="Q",b.push(w,T,g,u);break;case"A":M=d.shift(),G=d.shift(),I=d.shift(),B=d.shift(),L=d.shift(),X=g,v=u,g=d.shift(),u=d.shift(),y="A",b=this.convertEndpointToCenterParameterization(X,v,g,u,B,L,M,G,I);break;case"a":M=d.shift(),G=d.shift(),I=d.shift(),B=d.shift(),L=d.shift(),X=g,v=u,g+=d.shift(),u+=d.shift(),y="A",b=this.convertEndpointToCenterParameterization(X,v,g,u,B,L,M,G,I);break}h.push({command:y||p,points:b,start:{x:k,y:D},pathLength:this.calcLength(k,D,y||p,b)})}(p==="z"||p==="Z")&&h.push({command:"z",points:[],start:void 0,pathLength:0})}return h}static calcLength(o,a,l,c){let h,m,g,u;const f=Qt;switch(l){case"L":return f.getLineLength(o,a,c[0],c[1]);case"C":return(0,i.getCubicArcLength)([o,c[0],c[2],c[4]],[a,c[1],c[3],c[5]],1);case"Q":return(0,i.getQuadraticArcLength)([o,c[0],c[2]],[a,c[1],c[3]],1);case"A":h=0;const _=c[4],S=c[5],C=c[4]+S;let p=Math.PI/180;if(Math.abs(_-C)<p&&(p=Math.abs(_-C)),m=f.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],_,0),S<0)for(u=_-p;u>C;u-=p)g=f.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],u,0),h+=f.getLineLength(m.x,m.y,g.x,g.y),m=g;else for(u=_+p;u<C;u+=p)g=f.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],u,0),h+=f.getLineLength(m.x,m.y,g.x,g.y),m=g;return g=f.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],C,0),h+=f.getLineLength(m.x,m.y,g.x,g.y),h}return 0}static convertEndpointToCenterParameterization(o,a,l,c,h,m,g,u,f){const _=f*(Math.PI/180),S=Math.cos(_)*(o-l)/2+Math.sin(_)*(a-c)/2,C=-1*Math.sin(_)*(o-l)/2+Math.cos(_)*(a-c)/2,p=S*S/(g*g)+C*C/(u*u);p>1&&(g*=Math.sqrt(p),u*=Math.sqrt(p));let d=Math.sqrt((g*g*(u*u)-g*g*(C*C)-u*u*(S*S))/(g*g*(C*C)+u*u*(S*S)));h===m&&(d*=-1),isNaN(d)&&(d=0);const y=d*g*C/u,b=d*-u*S/g,k=(o+l)/2+Math.cos(_)*y-Math.sin(_)*b,D=(a+c)/2+Math.sin(_)*y+Math.cos(_)*b,x=function(L){return Math.sqrt(L[0]*L[0]+L[1]*L[1])},w=function(L,X){return(L[0]*X[0]+L[1]*X[1])/(x(L)*x(X))},T=function(L,X){return(L[0]*X[1]<L[1]*X[0]?-1:1)*Math.acos(w(L,X))},M=T([1,0],[(S-y)/g,(C-b)/u]),G=[(S-y)/g,(C-b)/u],I=[(-1*S-y)/g,(-1*C-b)/u];let B=T(G,I);return w(G,I)<=-1&&(B=Math.PI),w(G,I)>=1&&(B=0),m===0&&B>0&&(B=B-2*Math.PI),m===1&&B<0&&(B=B+2*Math.PI),[k,D,g,u,M,B,_,m]}};return Hn.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(s),t.Factory.addGetterSetter(s,"data"),Hn}var gl;function Gu(){if(gl)return Un;gl=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.Arrow=void 0;const t=bt(),e=dl(),n=St(),i=_t(),s=ys();let r=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,c=this.points();let h=c;const m=this.tension()!==0&&c.length>4;m&&(h=this.getTensionPoints());const g=this.pointerLength(),u=c.length;let f,_;if(m){const p=[h[h.length-4],h[h.length-3],h[h.length-2],h[h.length-1],c[u-2],c[u-1]],d=s.Path.calcLength(h[h.length-4],h[h.length-3],"C",p),y=s.Path.getPointOnQuadraticBezier(Math.min(1,1-g/d),p[0],p[1],p[2],p[3],p[4],p[5]);f=c[u-2]-y.x,_=c[u-1]-y.y}else f=c[u-2]-c[u-4],_=c[u-1]-c[u-3];const S=(Math.atan2(_,f)+l)%l,C=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(c[u-2],c[u-1]),a.rotate(S),a.moveTo(0,0),a.lineTo(-g,C/2),a.lineTo(-g,-C/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(c[0],c[1]),m?(f=(h[0]+h[2])/2-c[0],_=(h[1]+h[3])/2-c[1]):(f=c[2]-c[0],_=c[3]-c[1]),a.rotate((Math.atan2(-_,-f)+l)%l),a.moveTo(0,0),a.lineTo(-g,C/2),a.lineTo(-g,-C/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return Un.Arrow=r,r.prototype.className="Arrow",(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"pointerLength",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"pointerWidth",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"pointerAtBeginning",!1),t.Factory.addGetterSetter(r,"pointerAtEnding",!0),Un}var Vn={},pl;function Lu(){if(pl)return Vn;pl=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.Circle=void 0;const t=bt(),e=Ht(),n=St(),i=_t();let s=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}};return Vn.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),Vn}var zn={},ml;function Iu(){if(ml)return zn;ml=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.Ellipse=void 0;const t=bt(),e=Ht(),n=St(),i=_t();let s=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),l=this.radiusY();o.beginPath(),o.save(),a!==l&&o.scale(1,l/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return zn.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(s),t.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),t.Factory.addGetterSetter(s,"radiusX",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"radiusY",0,(0,n.getNumberValidator)()),zn}var Wn={},yl;function Uu(){if(yl)return Wn;yl=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.Image=void 0;const t=Dt(),e=bt(),n=Ht(),i=_t(),s=St();let r=class Yc extends n.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),c=this.getHeight(),h=this.cornerRadius(),m=this.attrs.image;let g;if(m){const u=this.attrs.cropWidth,f=this.attrs.cropHeight;u&&f?g=[m,this.cropX(),this.cropY(),u,f,0,0,l,c]:g=[m,0,0,l,c]}(this.hasFill()||this.hasStroke()||h)&&(a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)),m&&(h&&a.clip(),a.drawImage.apply(a,g))}_hitFunc(a){const l=this.width(),c=this.height(),h=this.cornerRadius();a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,c=null){const h=t.Util.createImageElement();h.onload=function(){const m=new Yc({image:h});l(m)},h.onerror=c,h.crossOrigin="Anonymous",h.src=a}};return Wn.Image=r,r.prototype.className="Image",(0,i._registerNode)(r),e.Factory.addGetterSetter(r,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(r,"image"),e.Factory.addComponentsGetterSetter(r,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(r,"cropX",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropY",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropWidth",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropHeight",0,(0,s.getNumberValidator)()),Wn}var Ke={},_l;function Bu(){if(_l)return Ke;_l=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.Tag=Ke.Label=void 0;const t=bt(),e=Ht(),n=fs(),i=St(),s=_t(),r=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",l="up",c="right",h="down",m="left",g=r.length;let u=class extends n.Group{constructor(S){super(S),this.on("add.konva",function(C){this._addListeners(C.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(S){let C=this,p;const d=function(){C._sync()};for(p=0;p<g;p++)S.on(r[p]+o,d)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let S=this.getText(),C=this.getTag(),p,d,y,b,k,D,x;if(S&&C){switch(p=S.width(),d=S.height(),y=C.pointerDirection(),b=C.pointerWidth(),x=C.pointerHeight(),k=0,D=0,y){case l:k=p/2,D=-1*x;break;case c:k=p+b,D=d/2;break;case h:k=p/2,D=d+x;break;case m:k=-1*b,D=d/2;break}C.setAttrs({x:-1*k,y:-1*D,width:p,height:d}),S.setAttrs({x:-1*k,y:-1*D})}}};Ke.Label=u,u.prototype.className="Label",(0,s._registerNode)(u);class f extends e.Shape{_sceneFunc(S){const C=this.width(),p=this.height(),d=this.pointerDirection(),y=this.pointerWidth(),b=this.pointerHeight(),k=this.cornerRadius();let D=0,x=0,w=0,T=0;typeof k=="number"?D=x=w=T=Math.min(k,C/2,p/2):(D=Math.min(k[0]||0,C/2,p/2),x=Math.min(k[1]||0,C/2,p/2),T=Math.min(k[2]||0,C/2,p/2),w=Math.min(k[3]||0,C/2,p/2)),S.beginPath(),S.moveTo(D,0),d===l&&(S.lineTo((C-y)/2,0),S.lineTo(C/2,-1*b),S.lineTo((C+y)/2,0)),S.lineTo(C-x,0),S.arc(C-x,x,x,Math.PI*3/2,0,!1),d===c&&(S.lineTo(C,(p-b)/2),S.lineTo(C+y,p/2),S.lineTo(C,(p+b)/2)),S.lineTo(C,p-T),S.arc(C-T,p-T,T,0,Math.PI/2,!1),d===h&&(S.lineTo((C+y)/2,p),S.lineTo(C/2,p+b),S.lineTo((C-y)/2,p)),S.lineTo(w,p),S.arc(w,p-w,w,Math.PI/2,Math.PI,!1),d===m&&(S.lineTo(0,(p+b)/2),S.lineTo(-1*y,p/2),S.lineTo(0,(p-b)/2)),S.lineTo(0,D),S.arc(D,D,D,Math.PI,Math.PI*3/2,!1),S.closePath(),S.fillStrokeShape(this)}getSelfRect(){let S=0,C=0,p=this.pointerWidth(),d=this.pointerHeight(),y=this.pointerDirection(),b=this.width(),k=this.height();return y===l?(C-=d,k+=d):y===h?k+=d:y===m?(S-=p*1.5,b+=p):y===c&&(b+=p*1.5),{x:S,y:C,width:b,height:k}}}return Ke.Tag=f,f.prototype.className="Tag",(0,s._registerNode)(f),t.Factory.addGetterSetter(f,"pointerDirection",a),t.Factory.addGetterSetter(f,"pointerWidth",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(f,"pointerHeight",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(f,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),Ke}var $n={},vl;function bl(){if(vl)return $n;vl=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.Rect=void 0;const t=bt(),e=Ht(),n=_t(),i=Dt(),s=St();let r=class extends e.Shape{_sceneFunc(a){const l=this.cornerRadius(),c=this.width(),h=this.height();a.beginPath(),l?i.Util.drawRoundedRectPath(a,c,h,l):a.rect(0,0,c,h),a.closePath(),a.fillStrokeShape(this)}};return $n.Rect=r,r.prototype.className="Rect",(0,n._registerNode)(r),t.Factory.addGetterSetter(r,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),$n}var jn={},Sl;function Hu(){if(Sl)return jn;Sl=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.RegularPolygon=void 0;const t=bt(),e=Ht(),n=St(),i=_t();let s=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)o.lineTo(a[l].x,a[l].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let c=0;c<o;c++)l.push({x:a*Math.sin(c*2*Math.PI/o),y:-1*a*Math.cos(c*2*Math.PI/o)});return l}getSelfRect(){const o=this._getPoints();let a=o[0].x,l=o[0].y,c=o[0].x,h=o[0].y;return o.forEach(m=>{a=Math.min(a,m.x),l=Math.max(l,m.x),c=Math.min(c,m.y),h=Math.max(h,m.y)}),{x:a,y:c,width:l-a,height:h-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return jn.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"sides",0,(0,n.getNumberValidator)()),jn}var qn={},xl;function Vu(){if(xl)return qn;xl=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.Ring=void 0;const t=bt(),e=Ht(),n=St(),i=_t(),s=Math.PI*2;let r=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,s,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),s,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return qn.Ring=r,r.prototype.className="Ring",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,n.getNumberValidator)()),qn}var Kn={},wl;function zu(){if(wl)return Kn;wl=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.Sprite=void 0;const t=bt(),e=Ht(),n=gs(),i=St(),s=_t();let r=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new n.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,m=this.animations()[l],g=this.frameOffsets(),u=m[h+0],f=m[h+1],_=m[h+2],S=m[h+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,_,S),a.closePath(),a.fillStrokeShape(this)),C)if(g){const p=g[l],d=c*2;a.drawImage(C,u,f,_,S,p[d+0],p[d+1],_,S)}else a.drawImage(C,u,f,_,S,0,0,_,S)}_hitFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,m=this.animations()[l],g=this.frameOffsets(),u=m[h+2],f=m[h+3];if(a.beginPath(),g){const _=g[l],S=c*2;a.rect(_[S+0],_[S+1],u,f)}else a.rect(0,0,u,f);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),c=this.animations(),h=c[l],m=h.length/4;a<m-1?this.frameIndex(a+1):this.frameIndex(0)}};return Kn.Sprite=r,r.prototype.className="Sprite",(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"animation"),t.Factory.addGetterSetter(r,"animations"),t.Factory.addGetterSetter(r,"frameOffsets"),t.Factory.addGetterSetter(r,"image"),t.Factory.addGetterSetter(r,"frameIndex",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"frameRate",17,(0,i.getNumberValidator)()),t.Factory.backCompat(r,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Kn}var Yn={},Cl;function Wu(){if(Cl)return Yn;Cl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.Star=void 0;const t=bt(),e=Ht(),n=St(),i=_t();let s=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),l=this.outerRadius(),c=this.numPoints();o.beginPath(),o.moveTo(0,0-l);for(let h=1;h<c*2;h++){const m=h%2===0?l:a,g=m*Math.sin(h*Math.PI/c),u=-1*m*Math.cos(h*Math.PI/c);o.lineTo(g,u)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return Yn.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"numPoints",5,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,n.getNumberValidator)()),Yn}var cn={},Pl;function Tl(){if(Pl)return cn;Pl=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.Text=void 0,cn.stringToArray=o;const t=Dt(),e=bt(),n=Ht(),i=_t(),s=St(),r=_t();function o(j){return[...j].reduce((U,J,st,$)=>{if(/\p{Emoji}/u.test(J)){const F=$[st+1];F&&/\p{Emoji_Modifier}|\u200D/u.test(F)?(U.push(J+F),$[st+1]=""):U.push(J)}else/\p{Regional_Indicator}{2}/u.test(J+($[st+1]||""))?U.push(J+$[st+1]):st>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(J)?U[U.length-1]+=J:J&&U.push(J);return U},[])}const a="auto",l="center",c="inherit",h="justify",m="Change.konva",g="2d",u="-",f="left",_="text",S="Text",C="top",p="bottom",d="middle",y="normal",b="px ",k=" ",D="right",x="rtl",w="word",T="char",M="none",G="…",I=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],B=I.length;function L(j){return j.split(",").map(U=>{U=U.trim();const J=U.indexOf(" ")>=0,st=U.indexOf('"')>=0||U.indexOf("'")>=0;return J&&!st&&(U=`"${U}"`),U}).join(", ")}let X;function v(){return X||(X=t.Util.createCanvasElement().getContext(g),X)}function P(j){j.fillText(this._partialText,this._partialTextX,this._partialTextY)}function E(j){j.setAttr("miterLimit",2),j.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function A(j){return j=j||{},!j.fillLinearGradientColorStops&&!j.fillRadialGradientColorStops&&!j.fillPatternImage&&(j.fill=j.fill||"black"),j}let O=class extends n.Shape{constructor(U){super(A(U)),this._partialTextX=0,this._partialTextY=0;for(let J=0;J<B;J++)this.on(I[J]+m,this._setTextData);this._setTextData()}_sceneFunc(U){const J=this.textArr,st=J.length;if(!this.text())return;let $=this.padding(),F=this.fontSize(),W=this.lineHeight()*F,nt=this.verticalAlign(),it=this.direction(),ct=0,R=this.align(),N=this.getWidth(),z=this.letterSpacing(),q=this.fill(),Y=this.textDecoration(),K=Y.indexOf("underline")!==-1,tt=Y.indexOf("line-through")!==-1,rt;it=it===c?U.direction:it;let et=W/2,H=d;if(i.Konva._fixTextRendering){const V=this.measureSize("M");H="alphabetic",et=(V.fontBoundingBoxAscent-V.fontBoundingBoxDescent)/2+W/2}for(it===x&&U.setAttr("direction",it),U.setAttr("font",this._getContextFont()),U.setAttr("textBaseline",H),U.setAttr("textAlign",f),nt===d?ct=(this.getHeight()-st*W-$*2)/2:nt===p&&(ct=this.getHeight()-st*W-$*2),U.translate($,ct+$),rt=0;rt<st;rt++){let V=0,Z=0;const ot=J[rt],lt=ot.text,ht=ot.width,pt=ot.lastInParagraph;if(U.save(),R===D?V+=N-ht-$*2:R===l&&(V+=(N-ht-$*2)/2),K){U.save(),U.beginPath();const ut=i.Konva._fixTextRendering?Math.round(F/4):Math.round(F/2),Ct=V,vt=et+Z+ut;U.moveTo(Ct,vt);const ft=R===h&&!pt?N-$*2:ht;U.lineTo(Ct+Math.round(ft),vt),U.lineWidth=F/15;const yt=this._getLinearGradient();U.strokeStyle=yt||q,U.stroke(),U.restore()}if(tt){U.save(),U.beginPath();const ut=i.Konva._fixTextRendering?-Math.round(F/4):0;U.moveTo(V,et+Z+ut);const Ct=R===h&&!pt?N-$*2:ht;U.lineTo(V+Math.round(Ct),et+Z+ut),U.lineWidth=F/15;const vt=this._getLinearGradient();U.strokeStyle=vt||q,U.stroke(),U.restore()}if(it!==x&&(z!==0||R===h)){const ut=lt.split(" ").length-1,Ct=o(lt);for(let vt=0;vt<Ct.length;vt++){const ft=Ct[vt];ft===" "&&!pt&&R===h&&(V+=(N-$*2-ht)/ut),this._partialTextX=V,this._partialTextY=et+Z,this._partialText=ft,U.fillStrokeShape(this),V+=this.measureSize(ft).width+z}}else z!==0&&U.setAttr("letterSpacing",`${z}px`),this._partialTextX=V,this._partialTextY=et+Z,this._partialText=lt,U.fillStrokeShape(this);U.restore(),st>1&&(et+=W)}}_hitFunc(U){const J=this.getWidth(),st=this.getHeight();U.beginPath(),U.rect(0,0,J,st),U.closePath(),U.fillStrokeShape(this)}setText(U){const J=t.Util._isString(U)?U:U==null?"":U+"";return this._setAttr(_,J),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(U){var J,st,$,F,W,nt,it,ct,R,N,z;let q=v(),Y=this.fontSize(),K;q.save(),q.font=this._getContextFont(),K=q.measureText(U),q.restore();const tt=Y/100;return{actualBoundingBoxAscent:(J=K.actualBoundingBoxAscent)!==null&&J!==void 0?J:71.58203125*tt,actualBoundingBoxDescent:(st=K.actualBoundingBoxDescent)!==null&&st!==void 0?st:0,actualBoundingBoxLeft:($=K.actualBoundingBoxLeft)!==null&&$!==void 0?$:-7.421875*tt,actualBoundingBoxRight:(F=K.actualBoundingBoxRight)!==null&&F!==void 0?F:75.732421875*tt,alphabeticBaseline:(W=K.alphabeticBaseline)!==null&&W!==void 0?W:0,emHeightAscent:(nt=K.emHeightAscent)!==null&&nt!==void 0?nt:100*tt,emHeightDescent:(it=K.emHeightDescent)!==null&&it!==void 0?it:-20*tt,fontBoundingBoxAscent:(ct=K.fontBoundingBoxAscent)!==null&&ct!==void 0?ct:91*tt,fontBoundingBoxDescent:(R=K.fontBoundingBoxDescent)!==null&&R!==void 0?R:21*tt,hangingBaseline:(N=K.hangingBaseline)!==null&&N!==void 0?N:72.80000305175781*tt,ideographicBaseline:(z=K.ideographicBaseline)!==null&&z!==void 0?z:-21*tt,width:K.width,height:Y}}_getContextFont(){return this.fontStyle()+k+this.fontVariant()+k+(this.fontSize()+b)+L(this.fontFamily())}_addTextLine(U){this.align()===h&&(U=U.trim());const st=this._getTextWidth(U);return this.textArr.push({text:U,width:st,lastInParagraph:!1})}_getTextWidth(U){const J=this.letterSpacing(),st=U.length;return v().measureText(U).width+J*st}_setTextData(){let U=this.text().split(`
`),J=+this.fontSize(),st=0,$=this.lineHeight()*J,F=this.attrs.width,W=this.attrs.height,nt=F!==a&&F!==void 0,it=W!==a&&W!==void 0,ct=this.padding(),R=F-ct*2,N=W-ct*2,z=0,q=this.wrap(),Y=q!==M,K=q!==T&&Y,tt=this.ellipsis();this.textArr=[],v().font=this._getContextFont();const rt=tt?this._getTextWidth(G):0;for(let et=0,H=U.length;et<H;++et){let V=U[et],Z=this._getTextWidth(V);if(nt&&Z>R)for(;V.length>0;){let ot=0,lt=o(V).length,ht="",pt=0;for(;ot<lt;){const ut=ot+lt>>>1,Ct=o(V),vt=Ct.slice(0,ut+1).join(""),ft=this._getTextWidth(vt);(tt&&it&&z+$>N?ft+rt:ft)<=R?(ot=ut+1,ht=vt,pt=ft):lt=ut}if(ht){if(K){const vt=o(V),ft=o(ht),yt=vt[ft.length],xt=yt===k||yt===u;let Lt;if(xt&&pt<=R)Lt=ft.length;else{const Nt=ft.lastIndexOf(k),Vt=ft.lastIndexOf(u);Lt=Math.max(Nt,Vt)+1}Lt>0&&(ot=Lt,ht=vt.slice(0,ot).join(""),pt=this._getTextWidth(ht))}if(ht=ht.trimRight(),this._addTextLine(ht),st=Math.max(st,pt),z+=$,this._shouldHandleEllipsis(z)){this._tryToAddEllipsisToLastLine();break}if(V=o(V).slice(ot).join("").trimLeft(),V.length>0&&(Z=this._getTextWidth(V),Z<=R)){this._addTextLine(V),z+=$,st=Math.max(st,Z);break}}else break}else this._addTextLine(V),z+=$,st=Math.max(st,Z),this._shouldHandleEllipsis(z)&&et<H-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),it&&z+$>N)break}this.textHeight=J,this.textWidth=st}_shouldHandleEllipsis(U){const J=+this.fontSize(),st=this.lineHeight()*J,$=this.attrs.height,F=$!==a&&$!==void 0,W=this.padding(),nt=$-W*2;return!(this.wrap()!==M)||F&&U+st>nt}_tryToAddEllipsisToLastLine(){const U=this.attrs.width,J=U!==a&&U!==void 0,st=this.padding(),$=U-st*2,F=this.ellipsis(),W=this.textArr[this.textArr.length-1];!W||!F||(J&&(this._getTextWidth(W.text+G)<$||(W.text=W.text.slice(0,W.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(W.text+G))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const U=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,J=this.hasShadow();return U&&J?!0:super._useBufferCanvas()}};return cn.Text=O,O.prototype._fillFunc=P,O.prototype._strokeFunc=E,O.prototype.className=S,O.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,r._registerNode)(O),e.Factory.overWriteSetter(O,"width",(0,s.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(O,"height",(0,s.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(O,"direction",c),e.Factory.addGetterSetter(O,"fontFamily","Arial"),e.Factory.addGetterSetter(O,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"fontStyle",y),e.Factory.addGetterSetter(O,"fontVariant",y),e.Factory.addGetterSetter(O,"padding",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"align",f),e.Factory.addGetterSetter(O,"verticalAlign",C),e.Factory.addGetterSetter(O,"lineHeight",1,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"wrap",w),e.Factory.addGetterSetter(O,"ellipsis",!1,(0,s.getBooleanValidator)()),e.Factory.addGetterSetter(O,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"text","",(0,s.getStringValidator)()),e.Factory.addGetterSetter(O,"textDecoration",""),cn}var Xn={},kl;function $u(){if(kl)return Xn;kl=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.TextPath=void 0;const t=Dt(),e=bt(),n=Ht(),i=ys(),s=Tl(),r=St(),o=_t(),a="",l="normal";function c(g){g.fillText(this.partialText,0,0)}function h(g){g.strokeText(this.partialText,0,0)}let m=class extends n.Shape{constructor(u){super(u),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(u){if(!this.attrs.data)return null;const f=this.pathLength;return u-1>f?null:i.Path.getPointAtLengthOfDataArray(u,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(u){u.setAttr("font",this._getContextFont()),u.setAttr("textBaseline",this.textBaseline()),u.setAttr("textAlign","left"),u.save();const f=this.textDecoration(),_=this.fill(),S=this.fontSize(),C=this.glyphInfo;f==="underline"&&u.beginPath();for(let p=0;p<C.length;p++){u.save();const d=C[p].p0;u.translate(d.x,d.y),u.rotate(C[p].rotation),this.partialText=C[p].text,u.fillStrokeShape(this),f==="underline"&&(p===0&&u.moveTo(0,S/2+1),u.lineTo(S,S/2+1)),u.restore()}f==="underline"&&(u.strokeStyle=_,u.lineWidth=S/20,u.stroke()),u.restore()}_hitFunc(u){u.beginPath();const f=this.glyphInfo;if(f.length>=1){const _=f[0].p0;u.moveTo(_.x,_.y)}for(let _=0;_<f.length;_++){const S=f[_].p1;u.lineTo(S.x,S.y)}u.setAttr("lineWidth",this.fontSize()),u.setAttr("strokeStyle",this.colorKey),u.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(u){return s.Text.prototype.setText.call(this,u)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(u){const _=this.dummyCanvas.getContext("2d");_.save(),_.font=this._getContextFont();const S=_.measureText(u);return _.restore(),{width:S.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:u,height:f}=this._getTextSize(this.attrs.text);if(this.textWidth=u,this.textHeight=f,this.glyphInfo=[],!this.attrs.data)return null;const _=this.letterSpacing(),S=this.align(),C=this.kerningFunc(),p=Math.max(this.textWidth+((this.attrs.text||"").length-1)*_,0);let d=0;S==="center"&&(d=Math.max(0,this.pathLength/2-p/2)),S==="right"&&(d=Math.max(0,this.pathLength-p));const y=(0,s.stringToArray)(this.text());let b=d;for(let k=0;k<y.length;k++){const D=this._getPointAtLength(b);if(!D)return;let x=this._getTextSize(y[k]).width+_;if(y[k]===" "&&S==="justify"){const B=this.text().split(" ").length-1;x+=(this.pathLength-p)/B}const w=this._getPointAtLength(b+x);if(!w)return;const T=i.Path.getLineLength(D.x,D.y,w.x,w.y);let M=0;if(C)try{M=C(y[k-1],y[k])*this.fontSize()}catch{M=0}D.x+=M,w.x+=M,this.textWidth+=M;const G=i.Path.getPointOnLine(M+T/2,D.x,D.y,w.x,w.y),I=Math.atan2(w.y-D.y,w.x-D.x);this.glyphInfo.push({transposeX:G.x,transposeY:G.y,text:y[k],rotation:I,p0:D,p1:w}),b+=x}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const u=[];this.glyphInfo.forEach(function(b){u.push(b.p0.x),u.push(b.p0.y),u.push(b.p1.x),u.push(b.p1.y)});let f=u[0]||0,_=u[0]||0,S=u[1]||0,C=u[1]||0,p,d;for(let b=0;b<u.length/2;b++)p=u[b*2],d=u[b*2+1],f=Math.min(f,p),_=Math.max(_,p),S=Math.min(S,d),C=Math.max(C,d);const y=this.fontSize();return{x:f-y/2,y:S-y/2,width:_-f+y,height:C-S+y}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Xn.TextPath=m,m.prototype._fillFunc=c,m.prototype._strokeFunc=h,m.prototype._fillFuncHit=c,m.prototype._strokeFuncHit=h,m.prototype.className="TextPath",m.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(m),e.Factory.addGetterSetter(m,"data"),e.Factory.addGetterSetter(m,"fontFamily","Arial"),e.Factory.addGetterSetter(m,"fontSize",12,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(m,"fontStyle",l),e.Factory.addGetterSetter(m,"align","left"),e.Factory.addGetterSetter(m,"letterSpacing",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(m,"textBaseline","middle"),e.Factory.addGetterSetter(m,"fontVariant",l),e.Factory.addGetterSetter(m,"text",a),e.Factory.addGetterSetter(m,"textDecoration",""),e.Factory.addGetterSetter(m,"kerningFunc",void 0),Xn}var Jn={},Al;function ju(){if(Al)return Jn;Al=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.Transformer=void 0;const t=Dt(),e=bt(),n=Ot(),i=Ht(),s=bl(),r=fs(),o=_t(),a=St(),l=_t(),c="tr-konva",h=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(x=>x+`.${c}`).join(" "),m="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],u={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},f="ontouchstart"in o.Konva._global;function _(x,w,T){if(x==="rotater")return T;w+=t.Util.degToRad(u[x]||0);const M=(t.Util.radToDeg(w)%360+360)%360;return t.Util._inRange(M,337.5,360)||t.Util._inRange(M,0,22.5)?"ns-resize":t.Util._inRange(M,22.5,67.5)?"nesw-resize":t.Util._inRange(M,67.5,112.5)?"ew-resize":t.Util._inRange(M,112.5,157.5)?"nwse-resize":t.Util._inRange(M,157.5,202.5)?"ns-resize":t.Util._inRange(M,202.5,247.5)?"nesw-resize":t.Util._inRange(M,247.5,292.5)?"ew-resize":t.Util._inRange(M,292.5,337.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+M),"pointer")}const S=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function C(x){return{x:x.x+x.width/2*Math.cos(x.rotation)+x.height/2*Math.sin(-x.rotation),y:x.y+x.height/2*Math.cos(x.rotation)+x.width/2*Math.sin(x.rotation)}}function p(x,w,T){const M=T.x+(x.x-T.x)*Math.cos(w)-(x.y-T.y)*Math.sin(w),G=T.y+(x.x-T.x)*Math.sin(w)+(x.y-T.y)*Math.cos(w);return{...x,rotation:x.rotation+w,x:M,y:G}}function d(x,w){const T=C(x);return p(x,w,T)}function y(x,w,T){let M=w;for(let G=0;G<x.length;G++){const I=o.Konva.getAngle(x[G]),B=Math.abs(I-w)%(Math.PI*2);Math.min(B,Math.PI*2-B)<T&&(M=I)}return M}let b=0,k=class extends r.Group{constructor(w){super(w),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(h,this.update),this.getNode()&&this.update()}attachTo(w){return this.setNode(w),this}setNode(w){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([w])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(w=[]){this._nodes&&this._nodes.length&&this.detach();const T=w.filter(G=>G.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=w=T,w.length===1&&this.useSingleNodeRotation()?this.rotation(w[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(G=>{const I=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(G._attrsAffectingSize.length){const B=G._attrsAffectingSize.map(L=>L+"Change."+this._getEventNamespace()).join(" ");G.on(B,I)}G.on(g.map(B=>B+`.${this._getEventNamespace()}`).join(" "),I),G.on(`absoluteTransformChange.${this._getEventNamespace()}`,I),this._proxyDrag(G)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(w){let T;w.on(`dragstart.${this._getEventNamespace()}`,M=>{T=w.getAbsolutePosition(),!this.isDragging()&&w!==this.findOne(".back")&&this.startDrag(M,!1)}),w.on(`dragmove.${this._getEventNamespace()}`,M=>{if(!T)return;const G=w.getAbsolutePosition(),I=G.x-T.x,B=G.y-T.y;this.nodes().forEach(L=>{if(L===w||L.isDragging())return;const X=L.getAbsolutePosition();L.setAbsolutePosition({x:X.x+I,y:X.y+B}),L.startDrag(M)}),T=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(w=>{w.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(m),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(m,this.__getNodeRect)}__getNodeShape(w,T=this.rotation(),M){const G=w.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),I=w.getAbsoluteScale(M),B=w.getAbsolutePosition(M),L=G.x*I.x-w.offsetX()*I.x,X=G.y*I.y-w.offsetY()*I.y,v=(o.Konva.getAngle(w.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),P={x:B.x+L*Math.cos(v)+X*Math.sin(-v),y:B.y+X*Math.cos(v)+L*Math.sin(v),width:G.width*I.x,height:G.height*I.y,rotation:v};return p(P,-o.Konva.getAngle(T),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const T=[];this.nodes().map(v=>{const P=v.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),E=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}],A=v.getAbsoluteTransform();E.forEach(function(O){const j=A.point(O);T.push(j)})});const M=new t.Transform;M.rotate(-o.Konva.getAngle(this.rotation()));let G=1/0,I=1/0,B=-1/0,L=-1/0;T.forEach(function(v){const P=M.point(v);G===void 0&&(G=B=P.x,I=L=P.y),G=Math.min(G,P.x),I=Math.min(I,P.y),B=Math.max(B,P.x),L=Math.max(L,P.y)}),M.invert();const X=M.point({x:G,y:I});return{x:X.x,y:X.y,width:B-G,height:L-I,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S.forEach(w=>{this._createAnchor(w)}),this._createAnchor("rotater")}_createAnchor(w){const T=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:w+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:f?10:"auto"}),M=this;T.on("mousedown touchstart",function(G){M._handleMouseDown(G)}),T.on("dragstart",G=>{T.stopDrag(),G.cancelBubble=!0}),T.on("dragend",G=>{G.cancelBubble=!0}),T.on("mouseenter",()=>{const G=o.Konva.getAngle(this.rotation()),I=this.rotateAnchorCursor(),B=_(w,G,I);T.getStage().content&&(T.getStage().content.style.cursor=B),this._cursorChange=!0}),T.on("mouseout",()=>{T.getStage().content&&(T.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(T)}_createBack(){const w=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(T,M){const G=M.getParent(),I=G.padding();T.beginPath(),T.rect(-I,-I,M.width()+I*2,M.height()+I*2),T.moveTo(M.width()/2,-I),G.rotateEnabled()&&G.rotateLineVisible()&&T.lineTo(M.width()/2,-G.rotateAnchorOffset()*t.Util._sign(M.height())-I),T.fillStrokeShape(M)},hitFunc:(T,M)=>{if(!this.shouldOverdrawWholeArea())return;const G=this.padding();T.beginPath(),T.rect(-G,-G,M.width()+G*2,M.height()+G*2),T.fillStrokeShape(M)}});this.add(w),this._proxyDrag(w),w.on("dragstart",T=>{T.cancelBubble=!0}),w.on("dragmove",T=>{T.cancelBubble=!0}),w.on("dragend",T=>{T.cancelBubble=!0}),this.on("dragmove",T=>{this.update()})}_handleMouseDown(w){if(this._transforming)return;this._movingAnchorName=w.target.name().split(" ")[0];const T=this._getNodeRect(),M=T.width,G=T.height,I=Math.sqrt(Math.pow(M,2)+Math.pow(G,2));this.sin=Math.abs(G/I),this.cos=Math.abs(M/I),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const B=w.target.getAbsolutePosition(),L=w.target.getStage().getPointerPosition();this._anchorDragOffset={x:L.x-B.x,y:L.y-B.y},b++,this._fire("transformstart",{evt:w.evt,target:this.getNode()}),this._nodes.forEach(X=>{X._fire("transformstart",{evt:w.evt,target:X})})}_handleMouseMove(w){let T,M,G;const I=this.findOne("."+this._movingAnchorName),B=I.getStage();B.setPointersPositions(w);const L=B.getPointerPosition();let X={x:L.x-this._anchorDragOffset.x,y:L.y-this._anchorDragOffset.y};const v=I.getAbsolutePosition();this.anchorDragBoundFunc()&&(X=this.anchorDragBoundFunc()(v,X,w)),I.setAbsolutePosition(X);const P=I.getAbsolutePosition();if(v.x===P.x&&v.y===P.y)return;if(this._movingAnchorName==="rotater"){const $=this._getNodeRect();T=I.x()-$.width/2,M=-I.y()+$.height/2;let F=Math.atan2(-M,T)+Math.PI/2;$.height<0&&(F-=Math.PI);const nt=o.Konva.getAngle(this.rotation())+F,it=o.Konva.getAngle(this.rotationSnapTolerance()),R=y(this.rotationSnaps(),nt,it)-$.rotation,N=d($,R);this._fitNodesInto(N,w);return}const E=this.shiftBehavior();let A;E==="inverted"?A=this.keepRatio()&&!w.shiftKey:E==="none"?A=this.keepRatio():A=this.keepRatio()||w.shiftKey;let O=this.centeredScaling()||w.altKey;if(this._movingAnchorName==="top-left"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};G=Math.sqrt(Math.pow($.x-I.x(),2)+Math.pow($.y-I.y(),2));const F=this.findOne(".top-left").x()>$.x?-1:1,W=this.findOne(".top-left").y()>$.y?-1:1;T=G*this.cos*F,M=G*this.sin*W,this.findOne(".top-left").x($.x-T),this.findOne(".top-left").y($.y-M)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(I.y());else if(this._movingAnchorName==="top-right"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};G=Math.sqrt(Math.pow(I.x()-$.x,2)+Math.pow($.y-I.y(),2));const F=this.findOne(".top-right").x()<$.x?-1:1,W=this.findOne(".top-right").y()>$.y?-1:1;T=G*this.cos*F,M=G*this.sin*W,this.findOne(".top-right").x($.x+T),this.findOne(".top-right").y($.y-M)}var j=I.position();this.findOne(".top-left").y(j.y),this.findOne(".bottom-right").x(j.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(I.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(I.x());else if(this._movingAnchorName==="bottom-left"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};G=Math.sqrt(Math.pow($.x-I.x(),2)+Math.pow(I.y()-$.y,2));const F=$.x<I.x()?-1:1,W=I.y()<$.y?-1:1;T=G*this.cos*F,M=G*this.sin*W,I.x($.x-T),I.y($.y+M)}j=I.position(),this.findOne(".top-left").x(j.x),this.findOne(".bottom-right").y(j.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(I.y());else if(this._movingAnchorName==="bottom-right"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};G=Math.sqrt(Math.pow(I.x()-$.x,2)+Math.pow(I.y()-$.y,2));const F=this.findOne(".bottom-right").x()<$.x?-1:1,W=this.findOne(".bottom-right").y()<$.y?-1:1;T=G*this.cos*F,M=G*this.sin*W,this.findOne(".bottom-right").x($.x+T),this.findOne(".bottom-right").y($.y+M)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(O=this.centeredScaling()||w.altKey,O){const $=this.findOne(".top-left"),F=this.findOne(".bottom-right"),W=$.x(),nt=$.y(),it=this.getWidth()-F.x(),ct=this.getHeight()-F.y();F.move({x:-W,y:-nt}),$.move({x:it,y:ct})}const U=this.findOne(".top-left").getAbsolutePosition();T=U.x,M=U.y;const J=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),st=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:T,y:M,width:J,height:st,rotation:o.Konva.getAngle(this.rotation())},w)}_handleMouseUp(w){this._removeEvents(w)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(w){var T;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const M=this.getNode();b--,this._fire("transformend",{evt:w,target:M}),(T=this.getLayer())===null||T===void 0||T.batchDraw(),M&&this._nodes.forEach(G=>{var I;G._fire("transformend",{evt:w,target:G}),(I=G.getLayer())===null||I===void 0||I.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(w,T){const M=this._getNodeRect(),G=1;if(t.Util._inRange(w.width,-this.padding()*2-G,G)){this.update();return}if(t.Util._inRange(w.height,-this.padding()*2-G,G)){this.update();return}const I=new t.Transform;if(I.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&w.width<0&&this._movingAnchorName.indexOf("left")>=0){const A=I.point({x:-this.padding()*2,y:0});w.x+=A.x,w.y+=A.y,w.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y}else if(this._movingAnchorName&&w.width<0&&this._movingAnchorName.indexOf("right")>=0){const A=I.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,w.width+=this.padding()*2}if(this._movingAnchorName&&w.height<0&&this._movingAnchorName.indexOf("top")>=0){const A=I.point({x:0,y:-this.padding()*2});w.x+=A.x,w.y+=A.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,w.height+=this.padding()*2}else if(this._movingAnchorName&&w.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const A=I.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,w.height+=this.padding()*2}if(this.boundBoxFunc()){const A=this.boundBoxFunc()(M,w);A?w=A:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const B=1e7,L=new t.Transform;L.translate(M.x,M.y),L.rotate(M.rotation),L.scale(M.width/B,M.height/B);const X=new t.Transform,v=w.width/B,P=w.height/B;this.flipEnabled()===!1?(X.translate(w.x,w.y),X.rotate(w.rotation),X.translate(w.width<0?w.width:0,w.height<0?w.height:0),X.scale(Math.abs(v),Math.abs(P))):(X.translate(w.x,w.y),X.rotate(w.rotation),X.scale(v,P));const E=X.multiply(L.invert());this._nodes.forEach(A=>{var O;const j=A.getParent().getAbsoluteTransform(),U=A.getTransform().copy();U.translate(A.offsetX(),A.offsetY());const J=new t.Transform;J.multiply(j.copy().invert()).multiply(E).multiply(j).multiply(U);const st=J.decompose();A.setAttrs(st),(O=A.getLayer())===null||O===void 0||O.batchDraw()}),this.rotation(t.Util._getRotation(w.rotation)),this._nodes.forEach(A=>{this._fire("transform",{evt:T,target:A}),A._fire("transform",{evt:T,target:A})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(w,T){this.findOne(w).setAttrs(T)}update(){var w;const T=this._getNodeRect();this.rotation(t.Util._getRotation(T.rotation));const M=T.width,G=T.height,I=this.enabledAnchors(),B=this.resizeEnabled(),L=this.padding(),X=this.anchorSize(),v=this.find("._anchor");v.forEach(E=>{E.setAttrs({width:X,height:X,offsetX:X/2,offsetY:X/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:X/2+L,offsetY:X/2+L,visible:B&&I.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:M/2,y:0,offsetY:X/2+L,visible:B&&I.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:M,y:0,offsetX:X/2-L,offsetY:X/2+L,visible:B&&I.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:G/2,offsetX:X/2+L,visible:B&&I.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:M,y:G/2,offsetX:X/2-L,visible:B&&I.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:G,offsetX:X/2+L,offsetY:X/2-L,visible:B&&I.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:M/2,y:G,offsetY:X/2-L,visible:B&&I.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:M,y:G,offsetX:X/2-L,offsetY:X/2-L,visible:B&&I.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:M/2,y:-this.rotateAnchorOffset()*t.Util._sign(G)-L,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:M,height:G,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const P=this.anchorStyleFunc();P&&v.forEach(E=>{P(E)}),(w=this.getLayer())===null||w===void 0||w.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const w=this.findOne("."+this._movingAnchorName);w&&w.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),r.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(w){return n.Node.prototype.clone.call(this,w)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Jn.Transformer=k,k.isTransforming=()=>b>0;function D(x){return x instanceof Array||t.Util.warn("enabledAnchors value should be an array"),x instanceof Array&&x.forEach(function(w){S.indexOf(w)===-1&&t.Util.warn("Unknown anchor name: "+w+". Available names are: "+S.join(", "))}),x||[]}return k.prototype.className="Transformer",(0,l._registerNode)(k),e.Factory.addGetterSetter(k,"enabledAnchors",S,D),e.Factory.addGetterSetter(k,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(k,"resizeEnabled",!0),e.Factory.addGetterSetter(k,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateEnabled",!0),e.Factory.addGetterSetter(k,"rotateLineVisible",!0),e.Factory.addGetterSetter(k,"rotationSnaps",[]),e.Factory.addGetterSetter(k,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(k,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderEnabled",!0),e.Factory.addGetterSetter(k,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"anchorFill","white"),e.Factory.addGetterSetter(k,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderDash"),e.Factory.addGetterSetter(k,"keepRatio",!0),e.Factory.addGetterSetter(k,"shiftBehavior","default"),e.Factory.addGetterSetter(k,"centeredScaling",!1),e.Factory.addGetterSetter(k,"ignoreStroke",!1),e.Factory.addGetterSetter(k,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"nodes"),e.Factory.addGetterSetter(k,"node"),e.Factory.addGetterSetter(k,"boundBoxFunc"),e.Factory.addGetterSetter(k,"anchorDragBoundFunc"),e.Factory.addGetterSetter(k,"anchorStyleFunc"),e.Factory.addGetterSetter(k,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(k,"useSingleNodeRotation",!0),e.Factory.backCompat(k,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Jn}var Qn={},Rl;function qu(){if(Rl)return Qn;Rl=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.Wedge=void 0;const t=bt(),e=Ht(),n=_t(),i=St(),s=_t();let r=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return Qn.Wedge=r,r.prototype.className="Wedge",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clockwise",!1),t.Factory.backCompat(r,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Qn}var Zn={},El;function Ku(){if(El)return Zn;El=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.Blur=void 0;const t=bt(),e=Ot(),n=St();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],r=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(l,c){const h=l.data,m=l.width,g=l.height;let u,f,_,S,C,p,d,y,b,k,D,x,w,T,M,G,I,B,L,X;const v=c+c+1,P=m-1,E=g-1,A=c+1,O=A*(A+1)/2,j=new i,U=s[c],J=r[c];let st=null,$=j,F=null,W=null;for(let nt=1;nt<v;nt++)$=$.next=new i,nt===A&&(st=$);$.next=j,_=f=0;for(let nt=0;nt<g;nt++){x=w=T=M=S=C=p=d=0,y=A*(G=h[f]),b=A*(I=h[f+1]),k=A*(B=h[f+2]),D=A*(L=h[f+3]),S+=O*G,C+=O*I,p+=O*B,d+=O*L,$=j;for(let it=0;it<A;it++)$.r=G,$.g=I,$.b=B,$.a=L,$=$.next;for(let it=1;it<A;it++)u=f+((P<it?P:it)<<2),S+=($.r=G=h[u])*(X=A-it),C+=($.g=I=h[u+1])*X,p+=($.b=B=h[u+2])*X,d+=($.a=L=h[u+3])*X,x+=G,w+=I,T+=B,M+=L,$=$.next;F=j,W=st;for(let it=0;it<m;it++)h[f+3]=L=d*U>>J,L!==0?(L=255/L,h[f]=(S*U>>J)*L,h[f+1]=(C*U>>J)*L,h[f+2]=(p*U>>J)*L):h[f]=h[f+1]=h[f+2]=0,S-=y,C-=b,p-=k,d-=D,y-=F.r,b-=F.g,k-=F.b,D-=F.a,u=_+((u=it+c+1)<P?u:P)<<2,x+=F.r=h[u],w+=F.g=h[u+1],T+=F.b=h[u+2],M+=F.a=h[u+3],S+=x,C+=w,p+=T,d+=M,F=F.next,y+=G=W.r,b+=I=W.g,k+=B=W.b,D+=L=W.a,x-=G,w-=I,T-=B,M-=L,W=W.next,f+=4;_+=m}for(let nt=0;nt<m;nt++){w=T=M=x=C=p=d=S=0,f=nt<<2,y=A*(G=h[f]),b=A*(I=h[f+1]),k=A*(B=h[f+2]),D=A*(L=h[f+3]),S+=O*G,C+=O*I,p+=O*B,d+=O*L,$=j;for(let ct=0;ct<A;ct++)$.r=G,$.g=I,$.b=B,$.a=L,$=$.next;let it=m;for(let ct=1;ct<=c;ct++)f=it+nt<<2,S+=($.r=G=h[f])*(X=A-ct),C+=($.g=I=h[f+1])*X,p+=($.b=B=h[f+2])*X,d+=($.a=L=h[f+3])*X,x+=G,w+=I,T+=B,M+=L,$=$.next,ct<E&&(it+=m);f=nt,F=j,W=st;for(let ct=0;ct<g;ct++)u=f<<2,h[u+3]=L=d*U>>J,L>0?(L=255/L,h[u]=(S*U>>J)*L,h[u+1]=(C*U>>J)*L,h[u+2]=(p*U>>J)*L):h[u]=h[u+1]=h[u+2]=0,S-=y,C-=b,p-=k,d-=D,y-=F.r,b-=F.g,k-=F.b,D-=F.a,u=nt+((u=ct+A)<E?u:E)*m<<2,S+=x+=F.r=h[u],C+=w+=F.g=h[u+1],p+=T+=F.b=h[u+2],d+=M+=F.a=h[u+3],F=F.next,y+=G=W.r,b+=I=W.g,k+=B=W.b,D+=L=W.a,x-=G,w-=I,T-=B,M-=L,W=W.next,f+=m}}const a=function(c){const h=Math.round(this.blurRadius());h>0&&o(c,h)};return Zn.Blur=a,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Zn}var ti={},Ml;function Yu(){if(Ml)return ti;Ml=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.Brighten=void 0;const t=bt(),e=Ot(),n=St(),i=function(s){const r=this.brightness()*255,o=s.data,a=o.length;for(let l=0;l<a;l+=4)o[l]+=r,o[l+1]+=r,o[l+2]+=r};return ti.Brighten=i,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ti}var ei={},Fl;function Xu(){if(Fl)return ei;Fl=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.Contrast=void 0;const t=bt(),e=Ot(),n=St(),i=function(s){const r=Math.pow((this.contrast()+100)/100,2),o=s.data,a=o.length;let l=150,c=150,h=150;for(let m=0;m<a;m+=4)l=o[m],c=o[m+1],h=o[m+2],l/=255,l-=.5,l*=r,l+=.5,l*=255,c/=255,c-=.5,c*=r,c+=.5,c*=255,h/=255,h-=.5,h*=r,h+=.5,h*=255,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,h=h<0?0:h>255?255:h,o[m]=l,o[m+1]=c,o[m+2]=h};return ei.Contrast=i,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ei}var ni={},Dl;function Ju(){if(Dl)return ni;Dl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.Emboss=void 0;const t=bt(),e=Ot(),n=Dt(),i=St(),s=function(r){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),c=this.embossBlend(),h=r.data,m=r.width,g=r.height,u=m*4;let f=0,_=0,S=g;switch(l){case"top-left":f=-1,_=-1;break;case"top":f=-1,_=0;break;case"top-right":f=-1,_=1;break;case"right":f=0,_=1;break;case"bottom-right":f=1,_=1;break;case"bottom":f=1,_=0;break;case"bottom-left":f=1,_=-1;break;case"left":f=0,_=-1;break;default:n.Util.error("Unknown emboss direction: "+l)}do{const C=(S-1)*u;let p=f;S+p<1&&(p=0),S+p>g&&(p=0);const d=(S-1+p)*m*4;let y=m;do{const b=C+(y-1)*4;let k=_;y+k<1&&(k=0),y+k>m&&(k=0);const D=d+(y-1+k)*4,x=h[b]-h[D],w=h[b+1]-h[D+1],T=h[b+2]-h[D+2];let M=x;const G=M>0?M:-M,I=w>0?w:-w,B=T>0?T:-T;if(I>G&&(M=w),B>G&&(M=T),M*=o,c){const L=h[b]+M,X=h[b+1]+M,v=h[b+2]+M;h[b]=L>255?255:L<0?0:L,h[b+1]=X>255?255:X<0?0:X,h[b+2]=v>255?255:v<0?0:v}else{let L=a-M;L<0?L=0:L>255&&(L=255),h[b]=h[b+1]=h[b+2]=L}}while(--y)}while(--S)};return ni.Emboss=s,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),ni}var ii={},Nl;function Qu(){if(Nl)return ii;Nl=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.Enhance=void 0;const t=bt(),e=Ot(),n=St();function i(r,o,a,l,c){const h=a-o,m=c-l;if(h===0)return l+m/2;if(m===0)return l;let g=(r-o)/h;return g=m*g+l,g}const s=function(r){const o=r.data,a=o.length;let l=o[0],c=l,h,m=o[1],g=m,u,f=o[2],_=f,S;const C=this.enhance();if(C===0)return;for(let x=0;x<a;x+=4)h=o[x+0],h<l?l=h:h>c&&(c=h),u=o[x+1],u<m?m=u:u>g&&(g=u),S=o[x+2],S<f?f=S:S>_&&(_=S);c===l&&(c=255,l=0),g===m&&(g=255,m=0),_===f&&(_=255,f=0);let p,d,y,b,k,D;if(C>0)p=c+C*(255-c),d=l-C*(l-0),y=g+C*(255-g),b=m-C*(m-0),k=_+C*(255-_),D=f-C*(f-0);else{const x=(c+l)*.5;p=c+C*(c-x),d=l+C*(l-x);const w=(g+m)*.5;y=g+C*(g-w),b=m+C*(m-w);const T=(_+f)*.5;k=_+C*(_-T),D=f+C*(f-T)}for(let x=0;x<a;x+=4)o[x+0]=i(o[x+0],l,c,d,p),o[x+1]=i(o[x+1],m,g,b,y),o[x+2]=i(o[x+2],f,_,D,k)};return ii.Enhance=s,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ii}var ri={},Ol;function Zu(){if(Ol)return ri;Ol=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.Grayscale=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4){const r=.34*n[s]+.5*n[s+1]+.16*n[s+2];n[s]=r,n[s+1]=r,n[s+2]=r}};return ri.Grayscale=t,ri}var si={},Gl;function tf(){if(Gl)return si;Gl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.HSL=void 0;const t=bt(),e=Ot(),n=St();t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter);const i=function(s){const r=s.data,o=r.length,a=1,l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=this.luminance()*127,m=a*l*Math.cos(c*Math.PI/180),g=a*l*Math.sin(c*Math.PI/180),u=.299*a+.701*m+.167*g,f=.587*a-.587*m+.33*g,_=.114*a-.114*m-.497*g,S=.299*a-.299*m-.328*g,C=.587*a+.413*m+.035*g,p=.114*a-.114*m+.293*g,d=.299*a-.3*m+1.25*g,y=.587*a-.586*m-1.05*g,b=.114*a+.886*m-.2*g;let k,D,x,w;for(let T=0;T<o;T+=4)k=r[T+0],D=r[T+1],x=r[T+2],w=r[T+3],r[T+0]=u*k+f*D+_*x+h,r[T+1]=S*k+C*D+p*x+h,r[T+2]=d*k+y*D+b*x+h,r[T+3]=w};return si.HSL=i,si}var oi={},Ll;function ef(){if(Ll)return oi;Ll=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.HSV=void 0;const t=bt(),e=Ot(),n=St(),i=function(s){const r=s.data,o=r.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=a*l*Math.cos(c*Math.PI/180),m=a*l*Math.sin(c*Math.PI/180),g=.299*a+.701*h+.167*m,u=.587*a-.587*h+.33*m,f=.114*a-.114*h-.497*m,_=.299*a-.299*h-.328*m,S=.587*a+.413*h+.035*m,C=.114*a-.114*h+.293*m,p=.299*a-.3*h+1.25*m,d=.587*a-.586*h-1.05*m,y=.114*a+.886*h-.2*m;for(let b=0;b<o;b+=4){const k=r[b+0],D=r[b+1],x=r[b+2],w=r[b+3];r[b+0]=g*k+u*D+f*x,r[b+1]=_*k+S*D+C*x,r[b+2]=p*k+d*D+y*x,r[b+3]=w}};return oi.HSV=i,t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),oi}var ai={},Il;function nf(){if(Il)return ai;Il=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.Invert=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4)n[s]=255-n[s],n[s+1]=255-n[s+1],n[s+2]=255-n[s+2]};return ai.Invert=t,ai}var li={},Ul;function rf(){if(Ul)return li;Ul=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Kaleidoscope=void 0;const t=bt(),e=Ot(),n=Dt(),i=St(),s=function(a,l,c){const h=a.data,m=l.data,g=a.width,u=a.height,f=c.polarCenterX||g/2,_=c.polarCenterY||u/2;let S=Math.sqrt(f*f+_*_),C=g-f,p=u-_;const d=Math.sqrt(C*C+p*p);S=d>S?d:S;const y=u,b=g,k=360/b*Math.PI/180;for(let D=0;D<b;D+=1){const x=Math.sin(D*k),w=Math.cos(D*k);for(let T=0;T<y;T+=1){C=Math.floor(f+S*T/y*w),p=Math.floor(_+S*T/y*x);let M=(p*g+C)*4;const G=h[M+0],I=h[M+1],B=h[M+2],L=h[M+3];M=(D+T*g)*4,m[M+0]=G,m[M+1]=I,m[M+2]=B,m[M+3]=L}}},r=function(a,l,c){const h=a.data,m=l.data,g=a.width,u=a.height,f=c.polarCenterX||g/2,_=c.polarCenterY||u/2;let S=Math.sqrt(f*f+_*_),C=g-f,p=u-_;const d=Math.sqrt(C*C+p*p);S=d>S?d:S;const y=u,b=g,k=0;let D,x;for(C=0;C<g;C+=1)for(p=0;p<u;p+=1){const w=C-f,T=p-_,M=Math.sqrt(w*w+T*T)*y/S;let G=(Math.atan2(T,w)*180/Math.PI+360+k)%360;G=G*b/360,D=Math.floor(G),x=Math.floor(M);let I=(x*g+D)*4;const B=h[I+0],L=h[I+1],X=h[I+2],v=h[I+3];I=(p*g+C)*4,m[I+0]=B,m[I+1]=L,m[I+2]=X,m[I+3]=v}},o=function(a){const l=a.width,c=a.height;let h,m,g,u,f,_,S,C,p,d,y=Math.round(this.kaleidoscopePower());const b=Math.round(this.kaleidoscopeAngle()),k=Math.floor(l*(b%360)/360);if(y<1)return;const D=n.Util.createCanvasElement();D.width=l,D.height=c;const x=D.getContext("2d").getImageData(0,0,l,c);n.Util.releaseCanvas(D),s(a,x,{polarCenterX:l/2,polarCenterY:c/2});let w=l/Math.pow(2,y);for(;w<=8;)w=w*2,y-=1;w=Math.ceil(w);let T=w,M=0,G=T,I=1;for(k+w>l&&(M=T,G=0,I=-1),m=0;m<c;m+=1)for(h=M;h!==G;h+=I)g=Math.round(h+k)%l,p=(l*m+g)*4,f=x.data[p+0],_=x.data[p+1],S=x.data[p+2],C=x.data[p+3],d=(l*m+h)*4,x.data[d+0]=f,x.data[d+1]=_,x.data[d+2]=S,x.data[d+3]=C;for(m=0;m<c;m+=1)for(T=Math.floor(w),u=0;u<y;u+=1){for(h=0;h<T+1;h+=1)p=(l*m+h)*4,f=x.data[p+0],_=x.data[p+1],S=x.data[p+2],C=x.data[p+3],d=(l*m+T*2-h-1)*4,x.data[d+0]=f,x.data[d+1]=_,x.data[d+2]=S,x.data[d+3]=C;T*=2}r(x,a,{})};return li.Kaleidoscope=o,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),li}var ci={},Bl;function sf(){if(Bl)return ci;Bl=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.Mask=void 0;const t=bt(),e=Ot(),n=St();function i(g,u,f){let _=(f*g.width+u)*4;const S=[];return S.push(g.data[_++],g.data[_++],g.data[_++],g.data[_++]),S}function s(g,u){return Math.sqrt(Math.pow(g[0]-u[0],2)+Math.pow(g[1]-u[1],2)+Math.pow(g[2]-u[2],2))}function r(g){const u=[0,0,0];for(let f=0;f<g.length;f++)u[0]+=g[f][0],u[1]+=g[f][1],u[2]+=g[f][2];return u[0]/=g.length,u[1]/=g.length,u[2]/=g.length,u}function o(g,u){const f=i(g,0,0),_=i(g,g.width-1,0),S=i(g,0,g.height-1),C=i(g,g.width-1,g.height-1),p=u||10;if(s(f,_)<p&&s(_,C)<p&&s(C,S)<p&&s(S,f)<p){const d=r([_,f,C,S]),y=[];for(let b=0;b<g.width*g.height;b++){const k=s(d,[g.data[b*4],g.data[b*4+1],g.data[b*4+2]]);y[b]=k<p?0:255}return y}}function a(g,u){for(let f=0;f<g.width*g.height;f++)g.data[4*f+3]=u[f]}function l(g,u,f){const _=[1,1,1,1,0,1,1,1,1],S=Math.round(Math.sqrt(_.length)),C=Math.floor(S/2),p=[];for(let d=0;d<f;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const w=d+D-C,T=y+x-C;if(w>=0&&w<f&&T>=0&&T<u){const M=w*u+T,G=_[D*S+x];k+=g[M]*G}}p[b]=k===2040?255:0}return p}function c(g,u,f){const _=[1,1,1,1,1,1,1,1,1],S=Math.round(Math.sqrt(_.length)),C=Math.floor(S/2),p=[];for(let d=0;d<f;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const w=d+D-C,T=y+x-C;if(w>=0&&w<f&&T>=0&&T<u){const M=w*u+T,G=_[D*S+x];k+=g[M]*G}}p[b]=k>=1020?255:0}return p}function h(g,u,f){const _=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],S=Math.round(Math.sqrt(_.length)),C=Math.floor(S/2),p=[];for(let d=0;d<f;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const w=d+D-C,T=y+x-C;if(w>=0&&w<f&&T>=0&&T<u){const M=w*u+T,G=_[D*S+x];k+=g[M]*G}}p[b]=k}return p}const m=function(g){const u=this.threshold();let f=o(g,u);return f&&(f=l(f,g.width,g.height),f=c(f,g.width,g.height),f=h(f,g.width,g.height),a(g,f)),g};return ci.Mask=m,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ci}var hi={},Hl;function of(){if(Hl)return hi;Hl=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Noise=void 0;const t=bt(),e=Ot(),n=St(),i=function(s){const r=this.noise()*255,o=s.data,a=o.length,l=r/2;for(let c=0;c<a;c+=4)o[c+0]+=l-2*l*Math.random(),o[c+1]+=l-2*l*Math.random(),o[c+2]+=l-2*l*Math.random()};return hi.Noise=i,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),hi}var di={},Vl;function af(){if(Vl)return di;Vl=1,Object.defineProperty(di,"__esModule",{value:!0}),di.Pixelate=void 0;const t=bt(),e=Dt(),n=Ot(),i=St(),s=function(r){let o=Math.ceil(this.pixelSize()),a=r.width,l=r.height,c=Math.ceil(a/o),h=Math.ceil(l/o),m=r.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let g=0;g<c;g+=1)for(let u=0;u<h;u+=1){let f=0,_=0,S=0,C=0;const p=g*o,d=p+o,y=u*o,b=y+o;let k=0;for(let D=p;D<d;D+=1)if(!(D>=a))for(let x=y;x<b;x+=1){if(x>=l)continue;const w=(a*x+D)*4;f+=m[w+0],_+=m[w+1],S+=m[w+2],C+=m[w+3],k+=1}f=f/k,_=_/k,S=S/k,C=C/k;for(let D=p;D<d;D+=1)if(!(D>=a))for(let x=y;x<b;x+=1){if(x>=l)continue;const w=(a*x+D)*4;m[w+0]=f,m[w+1]=_,m[w+2]=S,m[w+3]=C}}};return di.Pixelate=s,t.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),di}var ui={},zl;function lf(){if(zl)return ui;zl=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Posterize=void 0;const t=bt(),e=Ot(),n=St(),i=function(s){const r=Math.round(this.levels()*254)+1,o=s.data,a=o.length,l=255/r;for(let c=0;c<a;c+=1)o[c]=Math.floor(o[c]/l)*l};return ui.Posterize=i,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ui}var fi={},Wl;function cf(){if(Wl)return fi;Wl=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.RGB=void 0;const t=bt(),e=Ot(),n=St(),i=function(s){const r=s.data,o=r.length,a=this.red(),l=this.green(),c=this.blue();for(let h=0;h<o;h+=4){const m=(.34*r[h]+.5*r[h+1]+.16*r[h+2])/255;r[h]=m*a,r[h+1]=m*l,r[h+2]=m*c,r[h+3]=r[h+3]}};return fi.RGB=i,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),fi}var gi={},$l;function hf(){if($l)return gi;$l=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.RGBA=void 0;const t=bt(),e=Ot(),n=St(),i=function(s){const r=s.data,o=r.length,a=this.red(),l=this.green(),c=this.blue(),h=this.alpha();for(let m=0;m<o;m+=4){const g=1-h;r[m]=a*h+r[m]*g,r[m+1]=l*h+r[m+1]*g,r[m+2]=c*h+r[m+2]*g}};return gi.RGBA=i,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),gi}var pi={},jl;function df(){if(jl)return pi;jl=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Sepia=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4){const r=n[s+0],o=n[s+1],a=n[s+2];n[s+0]=Math.min(255,r*.393+o*.769+a*.189),n[s+1]=Math.min(255,r*.349+o*.686+a*.168),n[s+2]=Math.min(255,r*.272+o*.534+a*.131)}};return pi.Sepia=t,pi}var mi={},ql;function uf(){if(ql)return mi;ql=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.Solarize=void 0;const t=function(e){const n=e.data,i=e.width,s=e.height,r=i*4;let o=s;do{const a=(o-1)*r;let l=i;do{const c=a+(l-1)*4;let h=n[c],m=n[c+1],g=n[c+2];h>127&&(h=255-h),m>127&&(m=255-m),g>127&&(g=255-g),n[c]=h,n[c+1]=m,n[c+2]=g}while(--l)}while(--o)};return mi.Solarize=t,mi}var yi={},Kl;function ff(){if(Kl)return yi;Kl=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.Threshold=void 0;const t=bt(),e=Ot(),n=St(),i=function(s){const r=this.threshold()*255,o=s.data,a=o.length;for(let l=0;l<a;l+=1)o[l]=o[l]<r?0:255};return yi.Threshold=i,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),yi}var Yl;function gf(){if(Yl)return Mn;Yl=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.Konva=void 0;const t=Du(),e=Nu(),n=Gu(),i=Lu(),s=Iu(),r=Uu(),o=Bu(),a=dl(),l=ys(),c=bl(),h=Hu(),m=Vu(),g=zu(),u=Wu(),f=Tl(),_=$u(),S=ju(),C=qu(),p=Ku(),d=Yu(),y=Xu(),b=Ju(),k=Qu(),D=Zu(),x=tf(),w=ef(),T=nf(),M=rf(),G=sf(),I=of(),B=af(),L=lf(),X=cf(),v=hf(),P=df(),E=uf(),A=ff();return Mn.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:s.Ellipse,Image:r.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:l.Path,Rect:c.Rect,RegularPolygon:h.RegularPolygon,Ring:m.Ring,Sprite:g.Sprite,Star:u.Star,Text:f.Text,TextPath:_.TextPath,Transformer:S.Transformer,Wedge:C.Wedge,Filters:{Blur:p.Blur,Brighten:d.Brighten,Contrast:y.Contrast,Emboss:b.Emboss,Enhance:k.Enhance,Grayscale:D.Grayscale,HSL:x.HSL,HSV:w.HSV,Invert:T.Invert,Kaleidoscope:M.Kaleidoscope,Mask:G.Mask,Noise:I.Noise,Pixelate:B.Pixelate,Posterize:L.Posterize,RGB:X.RGB,RGBA:v.RGBA,Sepia:P.Sepia,Solarize:E.Solarize,Threshold:A.Threshold}}),Mn}var pf=or.exports,Xl;function mf(){if(Xl)return or.exports;Xl=1,Object.defineProperty(pf,"__esModule",{value:!0});const t=gf();return or.exports=t.Konva,or.exports}var yf=mf();const Q=Ru(yf);class _f{constructor(e,n,i){this.captureState=e,this.restoreState=n,this.onStateChange=i}history=[];historyIndex=-1;inUndoRedo=!1;maxHistorySize=50;executeCommand(e,n){if(this.inUndoRedo){n();return}const i=this.captureState();if(!i)return;n();const s=this.captureState();if(!s||i===s)return;const r={name:e,beforeState:i,afterState:s};this.history.splice(this.historyIndex+1),this.history.push(r),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${e}" added to history. Index: ${this.historyIndex}`)}pushCommand(e,n,i){if(!n||!i||n===i)return;const s={name:e,beforeState:n,afterState:i};this.history.splice(this.historyIndex+1),this.history.push(s),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${e}" pushed. Index: ${this.historyIndex}`)}undo(){if(this.historyIndex<0)return;this.inUndoRedo=!0;const e=this.history[this.historyIndex];console.log(`Undoing command: ${e.name}`),this.restoreState(e.beforeState),this.historyIndex--,this.onStateChange?.(),this.inUndoRedo=!1}redo(){if(this.historyIndex>=this.history.length-1)return;this.inUndoRedo=!0,this.historyIndex++;const e=this.history[this.historyIndex];console.log(`Redoing command: ${e.name}`),this.restoreState(e.afterState),this.onStateChange?.(),this.inUndoRedo=!1}canUndo(){return this.historyIndex>=0}canRedo(){return this.historyIndex<this.history.length-1}}const vf=()=>{const t=Co(new Set),e=new Map,n=Gt(()=>Array.from(t,i=>i.konvaNode));return{stage:void 0,konvaContainer:void 0,activeTool:Rt("select"),layers:{grid:void 0,drawing:void 0,overlay:void 0,transformer:void 0},groups:{freehandShape:void 0,freehandDrawing:void 0,polygonShapes:void 0,polygonPreview:void 0,polygonControls:void 0,polygonSelection:void 0,ancillaryViz:void 0,metadataHighlight:void 0,selectionOverlay:void 0},grid:{visible:Rt(!1),size:20},canvasItems:new Map,callbacks:{},keyboardDisposables:[],freehand:{strokes:new Map,strokeGroups:new Map,dragSelectionState:Rt({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,isDrawing:!1,currentPoints:[],currentTimestamps:[],drawingStartTime:0,selectedStrokesForTimeline:Rt(new Set),timelineDuration:Rt(0),currentPlaybackTime:Rt(0),freehandDrawMode:Rt(!0),useRealTiming:Rt(!1),maxInterStrokeDelay:300,isAnimating:Rt(!1),freehandDragStartState:null,serializedState:"",bakedRenderData:[],bakedGroupMap:{}},polygon:{shapes:new Map,groups:new Map,isDrawing:Rt(!1),currentPoints:Rt([]),mode:Rt("draw"),dragStartState:null,proximityThreshold:10,serializedState:"",bakedRenderData:[]},selection:{items:t,originalStyles:e,selectedKonvaNodes:n,dragSelectionState:Rt({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,selectionDragState:{isDragging:!1,startPos:{x:0,y:0},startNodePositions:new Map,beforeState:""},transformStartState:""},command:{},metadata:{activeNode:Rt(null),metadataText:Rt(""),showEditor:Rt(!1),highlight:{}},ancillary:{activeVisualizations:Rt(new Set),nodeVisualizations:new Map,listenersAttached:!1,rafToken:null,activeWatchStop:void 0}}},Jt=t=>t.freehand.strokes,_s=t=>t.freehand.strokeGroups,ae=t=>t.polygon.shapes,Ye=(t,e,n)=>{if(!t.command.executeCommand){console.warn("executeCommand called before setup - falling back to direct execution"),n();return}t.command.executeCommand(e,n)},cr=(t,e,n,i)=>{if(!t.command.pushCommand){console.warn("pushCommandWithStates called before setup - ignoring");return}t.command.pushCommand(e,n,i)};function bf(t,e,n=!1){n||vs(t),t.selection.items.add(e),Ss(t),hr(t)}function Sf(t,e,n=!1){t.selection.items.has(e)?t.selection.items.delete(e):(n||vs(t),t.selection.items.add(e)),Ss(t),hr(t)}function vs(t){bs(t),t.selection.items.clear(),hr(t)}function xf(t,e){return t.selection.items.has(e)}function wf(t){return t.selection.items.size===0}function Cf(t){return t.selection.items.size}function Pf(t){return t.selection.items.size===1?[...t.selection.items][0].konvaNode:null}function bs(t){t.selection.originalStyles.forEach(e=>{const n=e.node;n&&(n instanceof Q.Path||n instanceof Q.Line)&&(n.stroke(e.stroke),n.strokeWidth(e.strokeWidth))}),t.selection.originalStyles.clear(),xs(t)}function Ss(t){bs(t);for(const e of t.selection.items){const n=e.konvaNode;(n instanceof Q.Path||n instanceof Q.Line)&&(t.selection.originalStyles.set(e.id,{node:n,stroke:n.stroke(),strokeWidth:n.strokeWidth()}),n.stroke("#ff6b35"),n.strokeWidth(4))}xs(t)}function xs(t){const e=new Set;for(const n of t.selection.items){let i=n.konvaNode.getParent();for(;i&&!(i instanceof Q.Layer);)i=i.getParent();i instanceof Q.Layer&&e.add(i)}t.selection.originalStyles.forEach(n=>{let i=n.node.getParent();for(;i&&!(i instanceof Q.Layer);)i=i.getParent();i instanceof Q.Layer&&e.add(i)}),e.forEach(n=>n.batchDraw())}const ws=(t,e)=>{const n=t.selection.originalStyles.size>0;n&&bs(t);try{return e()}finally{t.selection.items.size>0?Ss(t):n&&xs(t)}};function hr(t){t.callbacks.syncAppState?.(t),t.callbacks.refreshAncillaryViz?.()}function Tf(t,e,n){Ye(t,"Edit Metadata",()=>{e.setMetadata(n),hr(t)})}function dr(t,e,n=!1){bf(t,e,n)}function kf(t,e,n=!1){Sf(t,e,n)}function le(t){vs(t)}function Jl(t,e){return xf(t,e)}function Ql(t){return wf(t)}function ur(t){return Cf(t)}const Af=t=>Pf(t);function Rf(t,e,n){Tf(t,e,n)}const _i=(t="id_")=>`${t}${crypto.randomUUID()}`,fr=t=>{let e=1/0,n=-1/0,i=1/0,s=-1/0;for(let r=0;r<t.length;r+=2)e=Math.min(e,t[r]),n=Math.max(n,t[r]),i=Math.min(i,t[r+1]),s=Math.max(s,t[r+1]);return{minX:e,maxX:n,minY:i,maxY:s}},Ef=t=>{for(let e=0;e<t.length;e++)for(let n=e+1;n<t.length;n++)if(t[e].isAncestorOf(t[n])||t[n].isAncestorOf(t[e]))return!0;return!1},Zl=(t,e,n)=>{e.id()||e.id(_i("stroke_"));const i={id:e.id(),type:"stroke",konvaNode:e,getBounds(){const s=e.getClientRect();return{minX:s.x,maxX:s.x+s.width,minY:s.y,maxY:s.y+s.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(s){s===void 0||Object.keys(s).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",s)}};return t.canvasItems.set(i.id,i),i},Cs=(t,e)=>{e.id()||e.id(_i("group_"));const n={id:e.id(),type:"strokeGroup",konvaNode:e,getBounds(){const i=e.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",i)}};return t.canvasItems.set(n.id,n),n},Ps=(t,e)=>{e.id()||e.id(_i("poly_"));const n={id:e.id(),type:"polygon",konvaNode:e,getBounds(){const i=e.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",i)}};return t.canvasItems.set(n.id,n),n},Mf=(t,e)=>t.canvasItems.get(e.id()),Ff=(t,e)=>{t.canvasItems.delete(e)},vi=(t,e)=>Mf(t,e),tc=(t,e)=>{Ff(t,e)};function Df(t,e,n,i=document.body){const s=o=>{o.key===e&&n(o)};i.addEventListener("keydown",s);const r=()=>{i.removeEventListener("keydown",s);const o=t.keyboardDisposables.indexOf(r);o!==-1&&t.keyboardDisposables.splice(o,1)};return t.keyboardDisposables.push(r),r}const Nf=()=>({canceled:!1}),ec=t=>{t.token.canceled||(t.token.canceled=!0,t.frameId!==null&&(cancelAnimationFrame(t.frameId),t.frameId=null))},Of=t=>{const e={frameId:null,token:Nf()},n=i=>{if(e.token.canceled)return;e.frameId=null;const s=t(i,e.token);if(e.token.canceled||s===!1){ec(e);return}e.frameId=requestAnimationFrame(n)};return e.frameId=requestAnimationFrame(n),{token:e.token,cancel:()=>ec(e)}},Gf={class:"timeline-container"},Lf={class:"timeline-controls"},If=["disabled"],Uf=["disabled"],Bf={class:"time-display"},Hf=sn({__name:"Timeline",props:{strokes:{type:Map},selectedStrokes:{type:Set},useRealTiming:{type:Boolean},maxInterStrokeDelay:{type:Number},overrideDuration:{type:Number},lockWhileAnimating:{type:Function}},emits:["timeUpdate"],setup(t,{emit:e}){const n=t,i=e,s=Rt(0),r=Rt(0),o=Rt(!1),a=Rt(null);let l,c=0,h=null;const m=()=>{if(n.overrideDuration!==void 0)r.value=n.overrideDuration;else{let D=0;const x=[];if(n.selectedStrokes.size>0)n.selectedStrokes.forEach(w=>{const T=n.strokes.get(w);T&&x.push(T)}),x.sort((w,T)=>{const M=parseInt(w.id.split("-")[1]||"0"),G=parseInt(T.id.split("-")[1]||"0");return M-G}),x.forEach((w,T)=>{if(w.timestamps&&w.timestamps.length>0){const M=w.timestamps[w.timestamps.length-1]||0;D+=M,T<x.length-1&&(D+=100)}});else{const w=Array.from(n.strokes.values());w.sort((M,G)=>{const I=parseInt(M.id.split("-")[1]||"0"),B=parseInt(G.id.split("-")[1]||"0");return I-B});let T=0;w.forEach((M,G)=>{if(M.timestamps&&M.timestamps.length>0){const I=M.creationTime||parseInt(M.id.split("-")[1]||"0"),B=M.timestamps[M.timestamps.length-1]||0;if(G===0)D=B,T=I+B;else{let L=Math.max(0,I-T);!n.useRealTiming&&L>n.maxInterStrokeDelay&&(L=n.maxInterStrokeDelay),D+=L+B,T=I+B}}})}r.value=D}r.value>0&&s.value>r.value&&(s.value=0,i("timeUpdate",0))};It([()=>n.strokes,()=>n.selectedStrokes,()=>n.useRealTiming,()=>n.maxInterStrokeDelay,()=>n.overrideDuration],()=>{m()},{immediate:!0,deep:!0});const g=Gt(()=>r.value===0?0:s.value/r.value*100),u=D=>{const x=Math.floor(D/1e3),w=Math.floor(D%1e3/10);return`${x}.${w.toString().padStart(2,"0")}s`},f=()=>{o.value||r.value===0||(o.value=!0,n.lockWhileAnimating?.(!0),c=performance.now()-s.value,l=Of(()=>o.value?(s.value=performance.now()-c,s.value>=r.value?(s.value=0,o.value=!1,n.lockWhileAnimating?.(!1),i("timeUpdate",0),l=void 0,!1):(i("timeUpdate",s.value),!0)):(l=void 0,!1)))},_=()=>{o.value=!1;const D=s.value===0;n.lockWhileAnimating?.(!D),l?.cancel(),l=void 0},S=()=>{o.value=!1,C.value=!1,n.lockWhileAnimating?.(!1),s.value=0,l?.cancel(),l=void 0,i("timeUpdate",0)},C=Rt(!1),p=D=>{if(!h)return;const x=Math.max(0,Math.min(D.clientX-h.left,h.width)),w=h.width>0?x/h.width:0;s.value=w*r.value,i("timeUpdate",s.value)},d=D=>{C.value&&p(D)},y=()=>{if(!C.value)return;C.value=!1;const D=s.value===0;n.lockWhileAnimating?.(!D),h=null,window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",y)},b=D=>{D.preventDefault();const x=a.value;x&&(C.value=!0,n.lockWhileAnimating?.(!0),h=x.getBoundingClientRect(),window.addEventListener("mousemove",d),window.addEventListener("mouseup",y),p(D))},k=D=>{if(!C.value){const w=D.currentTarget.getBoundingClientRect(),M=Math.max(0,Math.min(D.clientX-w.left,w.width))/w.width;s.value=M*r.value;const G=s.value===0;n.lockWhileAnimating?.(!G),o.value&&(c=performance.now()-s.value),i("timeUpdate",s.value)}};return Cn(()=>{l?.cancel(),l=void 0,C.value&&(C.value=!1,n.lockWhileAnimating?.(!1)),h=null,window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",y)}),(D,x)=>(Pt(),kt("div",Gf,[at("div",Lf,[at("button",{onClick:f,disabled:o.value},"▶️",8,If),at("button",{onClick:_,disabled:!o.value},"⏸️",8,Uf),at("button",{onClick:S},"⏹️"),at("span",Bf,ie(u(s.value))+" / "+ie(u(r.value)),1)]),at("div",{ref_key:"timelineTrackRef",ref:a,class:"timeline-track",onClick:k,onMousedown:b},[at("div",{class:"timeline-progress",style:Be({width:g.value+"%"})},null,4),at("div",{class:"timeline-playhead",style:Be({left:g.value+"%"}),onMousedown:Cu(b,["stop"])},null,36)],544)]))}}),Vf=".timeline-container[data-v-bbee97de]{width:600px;background:#fff;border:1px solid #ccc;border-radius:8px;padding:15px;box-shadow:0 2px 10px #0000001a;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.timeline-controls[data-v-bbee97de]{display:flex;align-items:center;gap:10px;margin-bottom:10px}.timeline-controls button[data-v-bbee97de]{background:none;border:1px solid #ccc;border-radius:4px;padding:5px 10px;cursor:pointer;font-size:16px}.timeline-controls button[data-v-bbee97de]:hover:not(:disabled){background:#f0f0f0}.timeline-controls button[data-v-bbee97de]:disabled{opacity:.5;cursor:not-allowed}.time-display[data-v-bbee97de]{margin-left:auto;font-family:monospace;font-size:14px;color:#666}.timeline-track[data-v-bbee97de]{position:relative;height:40px;background:#f0f0f0;border-radius:4px;cursor:pointer}.timeline-progress[data-v-bbee97de]{position:absolute;top:0;left:0;height:100%;background:#06f;border-radius:4px}.timeline-playhead[data-v-bbee97de]{position:absolute;top:-5px;width:10px;height:50px;background:#06f;border-radius:2px;transform:translate(-50%);cursor:grab;z-index:10}.timeline-playhead[data-v-bbee97de]:hover{background:#0052cc}.timeline-playhead[data-v-bbee97de]:active{cursor:grabbing}",bi=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n},zf=bi(Hf,[["styles",[Vf]],["__scopeId","data-v-bbee97de"]]),Wf={key:0,class:"metadata-editor"},$f={class:"header"},jf={key:0,class:"unsaved-indicator"},qf={key:0},Kf={class:"buttons"},Yf=["disabled"],Xf=["disabled"],Jf={key:1,class:"warning"},nc=bi(sn({__name:"MetadataEditor",props:{metadata:{type:null},visible:{type:Boolean},canEdit:{type:Boolean}},emits:["apply","cancel"],setup(t,{emit:e}){const n=t,i=e,s=Rt(""),r=Rt(""),o=Gt(()=>s.value!==r.value);It(()=>[n.metadata,n.canEdit],([c,h])=>{if(h){const m=JSON.stringify(c??{},null,2);s.value=m,r.value=m}else s.value="",r.value=""},{immediate:!0,deep:!0});const a=()=>{try{const c=JSON.parse(s.value||"{}");i("apply",c),r.value=s.value}catch{alert("Invalid JSON format")}},l=()=>{s.value=r.value};return(c,h)=>c.visible?(Pt(),kt("div",Wf,[at("div",$f,[o.value?(Pt(),kt("div",jf,h[1]||(h[1]=[at("span",{class:"dot"},null,-1),ya(" Unsaved changes ")]))):Kt("",!0)]),c.canEdit?(Pt(),kt("div",qf,[h[2]||(h[2]=at("p",{class:"help"},"Edit the metadata as JSON:",-1)),Oo(at("textarea",{"onUpdate:modelValue":h[0]||(h[0]=m=>s.value=m),class:"textarea",placeholder:"{}"},null,512),[[bu,s.value]]),at("div",Kf,[at("button",{onClick:a,class:"btn save",disabled:!o.value}," Save ",8,Yf),at("button",{onClick:l,class:"btn cancel",disabled:!o.value}," Cancel ",8,Xf)])])):(Pt(),kt("div",Jf,h[3]||(h[3]=[at("p",null,"Select multiple items to edit metadata (single selection only)",-1)])))])):Kt("",!0)}}),[["styles",[".metadata-editor[data-v-894edfb8]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:6px 16px;margin-top:8px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-894edfb8]{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}.header h3[data-v-894edfb8]{margin:0;font-size:17px;color:#333}.unsaved-indicator[data-v-894edfb8]{display:flex;align-items:center;gap:6px;font-size:13px;color:#f39c12;font-weight:500}.dot[data-v-894edfb8]{width:6px;height:6px;background:#f39c12;border-radius:50%;animation:pulse-894edfb8 1.5s infinite}@keyframes pulse-894edfb8{0%,to{opacity:1}50%{opacity:.5}}.help[data-v-894edfb8]{margin:0 0 4px;color:#666;font-size:14px}.textarea[data-v-894edfb8]{width:100%;min-height:120px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:14px;line-height:1.3;resize:vertical;margin-bottom:4px}.textarea[data-v-894edfb8]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 2px #0066ff26}.buttons[data-v-894edfb8]{display:flex;gap:8px}.btn[data-v-894edfb8]{padding:4px 12px;border:1px solid;border-radius:4px;cursor:pointer;font-size:14px;transition:all .2s}.btn[data-v-894edfb8]:disabled{opacity:.5;cursor:not-allowed}.save[data-v-894edfb8]{background:#28a745;color:#fff;border-color:#28a745}.save[data-v-894edfb8]:hover:not(:disabled){background:#218838}.cancel[data-v-894edfb8]{background:#6c757d;color:#fff;border-color:#6c757d}.cancel[data-v-894edfb8]:hover:not(:disabled){background:#5a6268}.warning[data-v-894edfb8]{text-align:center;color:#e67e22;padding:8px}.warning p[data-v-894edfb8]{margin:0;font-size:15px}"]],["__scopeId","data-v-894edfb8"]]),Qf={class:"smart-metadata-editor"},Zf={key:1,class:"hierarchical-editor"},t0={class:"header"},e0={key:0},n0={key:1,class:"multi-selection-header"},i0={class:"help"},r0={key:0,class:"tree-view"},s0=["onClick","onMouseenter"],o0={class:"label"},a0={key:0,class:"metadata-indicator"},l0={key:1,class:"empty-state"},c0={key:3,class:"selection-hint"},h0={key:2,class:"empty-state"},d0=bi(sn({__name:"HierarchicalMetadataEditor",props:{selectedNodes:{type:Array},singleNode:{type:[Object,null]},multiSelected:{type:Boolean},groupSelected:{type:Boolean},collectHierarchyFromRoot:{type:Function},updateMetadataHighlight:{type:Function},updateHoverHighlight:{type:Function},onApplyMetadata:{type:Function}},setup(t){const e=t,n=Gt(()=>e.selectedNodes),i=Gt(()=>e.singleNode),s=Gt(()=>e.multiSelected),r=Gt(()=>e.groupSelected),o=Gt(()=>s.value||r.value?"hierarchical":i.value?"simple":"none"),a=Gt(()=>{if(s.value)return e.collectHierarchyFromRoot(n.value);if(r.value){const p=n.value[0];return p?e.collectHierarchyFromRoot([p]):[]}return[]}),l=Fh(null),c=Gt(()=>{const p=i.value;return p?p.getAttr("metadata")??{}:null}),h=Gt(()=>{const p=l.value;return p?p.getAttr("metadata")??{}:null});It([o,r,n],([p,d])=>{if(p==="hierarchical"&&d){const y=n.value[0];y&&(l.value=y,e.updateMetadataHighlight(y))}else p==="simple"&&i.value?(l.value=i.value,e.updateMetadataHighlight(i.value)):(p==="hierarchical"&&s.value||p==="none")&&(l.value=null,e.updateMetadataHighlight(void 0))},{immediate:!0}),It(i,p=>{o.value==="simple"&&(l.value=p,e.updateMetadataHighlight(p))}),It(l,p=>{e.updateMetadataHighlight(p)}),It(o,p=>{p==="none"&&(l.value=null,e.updateMetadataHighlight(void 0))}),Cn(()=>{e.updateMetadataHighlight(void 0),e.updateHoverHighlight(void 0)});const m=p=>{l.value=p},g=p=>{i.value&&e.onApplyMetadata(i.value,p)},u=p=>{l.value&&e.onApplyMetadata(l.value,p)},f=p=>{const d=p,y=d.id()||`#${d._id}`;if(d instanceof Q.Group){const b=d.getChildren().length;return`Group ${y} (${b} ${b===1?"child":"children"})`}else return d instanceof Q.Path?`Stroke ${y}`:d instanceof Q.Line?`Polygon ${y}`:`${d.constructor.name} ${y}`},_=p=>{const y=p.getAttr("metadata");return y&&Object.keys(y).length>0},S=p=>{e.updateHoverHighlight(p)},C=()=>{e.updateHoverHighlight(void 0)};return(p,d)=>(Pt(),kt("div",Qf,[o.value==="simple"?(Pt(),Qi(nc,{key:0,metadata:c.value,visible:!0,"can-edit":!!i.value,onApply:g},null,8,["metadata","can-edit"])):o.value==="hierarchical"?(Pt(),kt("div",Zf,[at("div",t0,[r.value?(Pt(),kt("h3",e0,"Group: "+ie(f(n.value[0])),1)):s.value?(Pt(),kt("h3",n0,ie(n.value.length)+" items selected – single-item editing only ",1)):Kt("",!0),at("p",i0,ie(s.value?"Pick one below to edit its metadata:":"Select a node to edit its metadata:"),1)]),a.value.length>0?(Pt(),kt("div",r0,[(Pt(!0),kt(qt,null,Bo(a.value,y=>(Pt(),kt("div",{key:y.indexPath,class:we(["tree-row",{active:y.node===l.value}]),style:Be({paddingLeft:y.depth*50+"px"}),onClick:b=>m(y.node),onMouseenter:b=>S(y.node),onMouseleave:C},[at("span",o0,ie(f(y.node)),1),_(y.node)?(Pt(),kt("span",a0,"●")):Kt("",!0)],46,s0))),128))])):(Pt(),kt("div",l0,d[0]||(d[0]=[at("p",null,"No shapes or groups available",-1)]))),l.value?(Pt(),Qi(nc,{key:2,metadata:h.value,visible:!0,"can-edit":!0,onApply:u},null,8,["metadata"])):s.value?(Pt(),kt("div",c0,d[1]||(d[1]=[at("p",null,"← Click a row above to edit its metadata",-1)]))):Kt("",!0)])):(Pt(),kt("div",h0,d[2]||(d[2]=[at("p",null,"Select something to edit its metadata",-1)])))]))}}),[["styles",[".smart-metadata-editor[data-v-cb312d1a]{margin-top:8px}.hierarchical-editor[data-v-cb312d1a]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:8px 16px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-cb312d1a]{margin-bottom:8px}.header h3[data-v-cb312d1a]{margin:0 0 4px;font-size:17px;color:#333}.multi-selection-header[data-v-cb312d1a]{color:#e67e22!important;font-weight:700}.help[data-v-cb312d1a]{margin:0;color:#666;font-size:14px}.tree-view[data-v-cb312d1a]{max-height:300px;overflow-y:auto;border:1px solid #eee;border-radius:4px;margin-bottom:8px}.tree-row[data-v-cb312d1a]{display:flex;align-items:center;justify-content:space-between;padding:4px 8px;cursor:pointer;user-select:none;border-bottom:1px solid #f5f5f5;transition:background-color .15s}.tree-row[data-v-cb312d1a]:last-child{border-bottom:none}.tree-row[data-v-cb312d1a]:hover{background-color:#f8f9fa}.tree-row.active[data-v-cb312d1a]{background-color:#fff2f2;border-left:3px solid #dc3545}.label[data-v-cb312d1a]{font-family:Monaco,Consolas,monospace;font-size:13px;color:#333}.metadata-indicator[data-v-cb312d1a]{color:#28a745;font-size:12px;font-weight:700}.empty-state[data-v-cb312d1a]{text-align:center;color:#666;padding:20px;font-style:italic}.empty-state p[data-v-cb312d1a]{margin:0}.selection-hint[data-v-cb312d1a]{text-align:center;color:#666;padding:15px;font-style:italic;border:2px dashed #ddd;border-radius:6px;margin-top:10px}.selection-hint p[data-v-cb312d1a]{margin:0}"]],["__scopeId","data-v-cb312d1a"]]),ic=t=>{const e=[],n=(i,s=0,r="")=>{e.push({node:i,depth:s,indexPath:r}),i instanceof Q.Group&&i.getChildren().forEach((o,a)=>n(o,s+1,r?`${r}/${a}`:`${a}`))};return t.forEach((i,s)=>n(i,0,`${s}`)),e},u0=t=>t?ic(t.getChildren()):[],gr=new Map,rc=t=>gr.set(t.key,t),sc=()=>Array.from(gr.values()),f0=t=>t.ancillary.nodeVisualizations,oc=t=>{const e=t.layers.overlay;if(e){if(!t.groups.ancillaryViz){const n=new Q.Group({listening:!1,name:"ancillary-vis"});t.groups.ancillaryViz=n,e.add(n)}return t.groups.ancillaryViz}},g0=t=>{t.stage&&t.ancillary.rafToken===null&&(t.ancillary.rafToken=requestAnimationFrame(()=>{t.ancillary.rafToken=null,Xe(t)}))},p0=t=>{const e=t.stage;if(!e||t.ancillary.listenersAttached)return;const n=()=>g0(t);e.on("dragmove.av transform.av",n),e.on("destroy.av",n),e.on("dragend.av transformend.av",()=>Xe(t)),t.ancillary.listenersAttached=!0},m0=t=>{t.ancillary.activeWatchStop||(t.ancillary.activeWatchStop=It(()=>t.ancillary.activeVisualizations.value,()=>Xe(t),{deep:!0}))},ac=t=>{t.stage&&(oc(t),p0(t),m0(t),Xe(t))},Xe=t=>{const e=t.stage,n=oc(t);if(!e||!n)return;const s=u0(t.groups.freehandShape).filter(l=>l.depth===0).map(l=>l.node),r=new Map,o=t.ancillary.activeVisualizations.value;s.forEach(l=>{const c=l.getAttr("metadata")??{},h=l.getClientRect({relativeTo:e}),m={node:l,metadata:c,bbox:h};o.forEach(g=>{const u=gr.get(g);u&&u.validate(m)&&r.set(`${g}|${l.id()}`,{ctx:m,def:u})})});const a=f0(t);a.forEach((l,c)=>{r.has(c)||(gr.get(l.key)?.destroy?.(l.nodes),(Array.isArray(l.nodes)?l.nodes:[l.nodes]).forEach(g=>g.destroy()),a.delete(c))}),r.forEach((l,c)=>{const h=a.get(c);if(h)l.def.update?.(l.ctx,h.nodes);else{const m=l.def.create(l.ctx);(Array.isArray(m)?m:[m]).forEach(u=>{u instanceof Q.Group||u instanceof Q.Shape?n.add(u):console.warn("Ancillary visualization produced unsupported node type",u)}),a.set(c,{key:l.def.key,nodes:m})}}),n.getLayer()?.batchDraw()},y0=Object.freeze(Object.defineProperty({__proto__:null,getRegisteredAVs:sc,initAVLayer:ac,refreshAnciliaryViz:Xe,registerAV:rc},Symbol.toStringTag,{value:"Module"}));rc({key:"typo-guides",displayName:"Typography Guidelines",validate:({metadata:t})=>["lowLine","midLine","capHeight","ascender","descender","baseline"].some(e=>e in t&&typeof t[e]=="number"),create:t=>lc(t),update:(t,e)=>lc(t,e)});function lc({bbox:t,metadata:e},n){const i=[4,4],r=[{key:"baseline",fraction:e.baseline,color:"#333"},{key:"lowLine",fraction:e.lowLine,color:"#888"},{key:"midLine",fraction:e.midLine,color:"#f80"},{key:"capHeight",fraction:e.capHeight,color:"#0a0"},{key:"ascender",fraction:e.ascender,color:"#00f"},{key:"descender",fraction:e.descender,color:"#f00"}].filter(o=>o.fraction!==void 0&&typeof o.fraction=="number"&&o.fraction>=0&&o.fraction<=1).map(o=>{const a=t.y+t.height*o.fraction;return new Q.Line({points:[t.x,a,t.x+t.width,a],stroke:o.color,strokeWidth:1,dash:i,listening:!1,name:`typo-guide-${o.key}`})});return n?(n.forEach((o,a)=>{if(a<r.length){const l=r[a];o.points(l.points()),o.stroke(l.stroke())}}),n.length>r.length&&(n.slice(r.length).forEach(o=>o.destroy()),n.splice(r.length)),r.length>n.length&&n.push(...r.slice(n.length)),n):r}const _0={key:0,class:"av-toggle-pane"},v0={class:"toggles-grid"},b0=["checked","onChange"],S0=bi(sn({__name:"VisualizationToggles",props:{canvasState:{type:Object}},setup(t){const e=t,n=Gt(()=>sc()),i=Gt(()=>e.canvasState.ancillary.activeVisualizations.value),s=(o,a)=>{const l=new Set(i.value);a?l.add(o):l.delete(o),e.canvasState.ancillary.activeVisualizations.value=l},r=(o,a)=>{const l=a.target.checked;s(o,l)};return(o,a)=>n.value.length>0?(Pt(),kt("div",_0,[a[0]||(a[0]=at("h4",null,"Visualizations",-1)),at("div",v0,[(Pt(!0),kt(qt,null,Bo(n.value,l=>(Pt(),kt("label",{key:l.key,class:"toggle-item"},[at("input",{type:"checkbox",checked:i.value.has(l.key),onChange:c=>r(l.key,c)},null,40,b0),at("span",null,ie(l.displayName),1)]))),128))])])):Kt("",!0)}}),[["styles",[".av-toggle-pane[data-v-641f8251]{background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px;font-size:13px}.av-toggle-pane h4[data-v-641f8251]{margin:0 0 8px;font-size:14px;color:#333;font-weight:600}.toggles-grid[data-v-641f8251]{display:flex;flex-direction:column;gap:6px}.toggle-item[data-v-641f8251]{display:flex;align-items:center;gap:8px;cursor:pointer;transition:background-color .2s;padding:4px 6px;border-radius:4px}.toggle-item[data-v-641f8251]:hover{background-color:#f0f0f0}.toggle-item input[type=checkbox][data-v-641f8251]{margin:0;cursor:pointer}.toggle-item span[data-v-641f8251]{color:#555;font-size:13px;user-select:none}.toggle-item input[type=checkbox]:checked+span[data-v-641f8251]{color:#333;font-weight:500}"]],["__scopeId","data-v-641f8251"]]);function cc(t,e,n,i=s=>s){return t*i(.5-e*(.5-n))}function x0(t){return[-t[0],-t[1]]}function ue(t,e){return[t[0]+e[0],t[1]+e[1]]}function ce(t,e){return[t[0]-e[0],t[1]-e[1]]}function fe(t,e){return[t[0]*e,t[1]*e]}function w0(t,e){return[t[0]/e,t[1]/e]}function Si(t){return[t[1],-t[0]]}function hc(t,e){return t[0]*e[0]+t[1]*e[1]}function C0(t,e){return t[0]===e[0]&&t[1]===e[1]}function P0(t){return Math.hypot(t[0],t[1])}function T0(t){return t[0]*t[0]+t[1]*t[1]}function dc(t,e){return T0(ce(t,e))}function uc(t){return w0(t,P0(t))}function k0(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function xi(t,e,n){let i=Math.sin(n),s=Math.cos(n),r=t[0]-e[0],o=t[1]-e[1],a=r*s-o*i,l=r*i+o*s;return[a+e[0],l+e[1]]}function Ts(t,e,n){return ue(t,fe(ce(e,t),n))}function fc(t,e,n){return ue(t,fe(e,n))}var{min:hn,PI:A0}=Math,gc=.275,wi=A0+1e-4;function R0(t,e={}){let{size:n=16,smoothing:i=.5,thinning:s=.5,simulatePressure:r=!0,easing:o=v=>v,start:a={},end:l={},last:c=!1}=e,{cap:h=!0,easing:m=v=>v*(2-v)}=a,{cap:g=!0,easing:u=v=>--v*v*v+1}=l;if(t.length===0||n<=0)return[];let f=t[t.length-1].runningLength,_=a.taper===!1?0:a.taper===!0?Math.max(n,f):a.taper,S=l.taper===!1?0:l.taper===!0?Math.max(n,f):l.taper,C=Math.pow(n*i,2),p=[],d=[],y=t.slice(0,10).reduce((v,P)=>{let E=P.pressure;if(r){let A=hn(1,P.distance/n),O=hn(1,1-A);E=hn(1,v+(O-v)*(A*gc))}return(v+E)/2},t[0].pressure),b=cc(n,s,t[t.length-1].pressure,o),k,D=t[0].vector,x=t[0].point,w=x,T=x,M=w,G=!1;for(let v=0;v<t.length;v++){let{pressure:P}=t[v],{point:E,vector:A,distance:O,runningLength:j}=t[v];if(v<t.length-1&&f-j<3)continue;if(s){if(r){let it=hn(1,O/n),ct=hn(1,1-it);P=hn(1,y+(ct-y)*(it*gc))}b=cc(n,s,P,o)}else b=n/2;k===void 0&&(k=b);let U=j<_?m(j/_):1,J=f-j<S?u((f-j)/S):1;b=Math.max(.01,b*Math.min(U,J));let st=(v<t.length-1?t[v+1]:t[v]).vector,$=v<t.length-1?hc(A,st):1,F=hc(A,D)<0&&!G,W=$!==null&&$<0;if(F||W){let it=fe(Si(D),b);for(let ct=.07692307692307693,R=0;R<=1;R+=ct)T=xi(ce(E,it),E,wi*R),p.push(T),M=xi(ue(E,it),E,wi*-R),d.push(M);x=T,w=M,W&&(G=!0);continue}if(G=!1,v===t.length-1){let it=fe(Si(A),b);p.push(ce(E,it)),d.push(ue(E,it));continue}let nt=fe(Si(Ts(st,A,$)),b);T=ce(E,nt),(v<=1||dc(x,T)>C)&&(p.push(T),x=T),M=ue(E,nt),(v<=1||dc(w,M)>C)&&(d.push(M),w=M),y=P,D=A}let I=t[0].point.slice(0,2),B=t.length>1?t[t.length-1].point.slice(0,2):ue(t[0].point,[1,1]),L=[],X=[];if(t.length===1){if(!(_||S)||c){let v=fc(I,uc(Si(ce(I,B))),-(k||b)),P=[];for(let E=.07692307692307693,A=E;A<=1;A+=E)P.push(xi(v,I,wi*2*A));return P}}else{if(!(_||S&&t.length===1))if(h)for(let P=.07692307692307693,E=P;E<=1;E+=P){let A=xi(d[0],I,wi*E);L.push(A)}else{let P=ce(p[0],d[0]),E=fe(P,.5),A=fe(P,.51);L.push(ce(I,E),ce(I,A),ue(I,A),ue(I,E))}let v=Si(x0(t[t.length-1].vector));if(S||_&&t.length===1)X.push(B);else if(g){let P=fc(B,v,b);for(let E=.034482758620689655,A=E;A<1;A+=E)X.push(xi(P,B,wi*3*A))}else X.push(ue(B,fe(v,b)),ue(B,fe(v,b*.99)),ce(B,fe(v,b*.99)),ce(B,fe(v,b)))}return p.concat(X,d.reverse(),L)}function E0(t,e={}){var n;let{streamline:i=.5,size:s=16,last:r=!1}=e;if(t.length===0)return[];let o=.15+(1-i)*.85,a=Array.isArray(t[0])?t:t.map(({x:u,y:f,pressure:_=.5})=>[u,f,_]);if(a.length===2){let u=a[1];a=a.slice(0,-1);for(let f=1;f<5;f++)a.push(Ts(a[0],u,f/4))}a.length===1&&(a=[...a,[...ue(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,h=0,m=l[0],g=a.length-1;for(let u=1;u<a.length;u++){let f=r&&u===g?a[u].slice(0,2):Ts(m.point,a[u],o);if(C0(m.point,f))continue;let _=k0(f,m.point);if(h+=_,u<g&&!c){if(h<s)continue;c=!0}m={point:f,pressure:a[u][2]>=0?a[u][2]:.5,vector:uc(ce(m.point,f)),distance:_,runningLength:h},l.push(m)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function M0(t,e={}){return R0(E0(t,e),e)}var F0=M0;const ks=t=>t.metadata.highlight.layer,D0=t=>t.metadata.highlight.metadataRect,N0=t=>t.metadata.highlight.hoverRect,pc=(t,e)=>{const n=ks(t);if(n)return n;const i=new Q.Group({listening:!1,name:"metadata-highlight"}),s=new Q.Rect({stroke:"red",strokeWidth:2,dash:[4,4],listening:!1,visible:!1}),r=new Q.Rect({stroke:"green",strokeWidth:2,dash:[4,4],listening:!1,visible:!1});i.add(s),i.add(r);const o=t.layers.overlay;if(o)o.add(i);else{const a=new Q.Layer({listening:!1,name:"metadata-highlight-layer"});a.add(i),e.add(a),a.moveToTop()}return t.metadata.highlight.layer=i,t.metadata.highlight.metadataRect=s,t.metadata.highlight.hoverRect=r,t.groups.metadataHighlight=i,i},O0=(t,e)=>{const n=D0(t),i=ks(t);if(!n||!i)return;if(!e){n.visible(!1),i.getLayer()?.batchDraw();return}const s=e.getClientRect({relativeTo:e.getStage()});n.setAttrs({x:s.x,y:s.y,width:s.width,height:s.height,visible:!0}),i.getLayer()?.batchDraw()},G0=(t,e)=>{const n=N0(t),i=ks(t);if(!n||!i)return;if(!e){n.visible(!1),i.getLayer()?.batchDraw();return}const s=e.getClientRect({relativeTo:e.getStage()});n.setAttrs({x:s.x,y:s.y,width:s.width,height:s.height,visible:!0}),i.getLayer()?.batchDraw()},L0=t=>({setNodeMetadata:(e,n)=>{n===void 0||Object.keys(n).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",n)},collectHierarchyFromRoot:ic,updateMetadataHighlight:e=>O0(t,e),updateHoverHighlight:e=>G0(t,e)}),As=(t,e)=>{e instanceof Q.Path?Zl(t,e):e instanceof Q.Group&&(Cs(t,e),e.getChildren().forEach(n=>As(t,n)))},pr=(t,e)=>{(e instanceof Q.Path||e instanceof Q.Group)&&(e instanceof Q.Path,e.draggable(!0),e.off("click.freehand"),e.off("dragstart.freehand"),e.off("dragend.freehand"),e.on("dragstart.freehand",()=>{Es(t)}),e.on("dragend.freehand",()=>{Ms(t,e.constructor.name),t.groups.freehandShape?.getLayer()?.batchDraw()}),e instanceof Q.Group&&e.getChildren().forEach(n=>{pr(t,n)}))},mc=(t,e,n=0,i=0)=>{const s=e.clone({x:e.x()+n,y:e.y()+i}),r=(o,a)=>{const l=_i();if(o.id(l),o instanceof Q.Path){const c=Array.from(Jt(t).values()).find(h=>h.shape===a);if(c){const h={...c,id:l,shape:o};Jt(t).set(l,h),console.log("Created stroke data for cloned Path:",l)}}else if(o instanceof Q.Group){const c=a,h=o;h.getChildren().forEach((g,u)=>{const f=c.getChildren()[u];r(g,f)});const m=h.find("Path").map(g=>g.id());m.length>0&&(_s(t).set(l,{id:l,strokeIds:m,group:h}),console.log("Created group data for cloned Group:",l,"with strokes:",m))}};return r(s,e),pr(t,s),As(t,s),console.log("Successfully cloned",e.className,"with new ID:",s.id()),s},yc=(t,e)=>{const n=t.layers.drawing;if(!n){console.warn("Cannot initialize freehand groups without drawing layer");return}if(!t.groups.freehandShape){const i=new Q.Group({name:"freehand-shapes"});t.groups.freehandShape=i,n.add(i)}if(!t.groups.freehandDrawing){const i=new Q.Group({name:"freehand-drawing"});t.groups.freehandDrawing=i,n.add(i)}},_c=t=>{const e=[],n=new Set;return t.selection.selectedKonvaNodes.value.forEach(i=>{if(i instanceof Q.Group){const s=r=>{r.getChildren().forEach(o=>{o instanceof Q.Group?s(o):o instanceof Q.Path&&Array.from(Jt(t).values()).forEach(a=>{a.shape===o&&!n.has(a.id)&&(e.push(a),n.add(a.id))})})};s(i)}else i instanceof Q.Path&&Array.from(Jt(t).values()).forEach(s=>{s.shape===i&&!n.has(s.id)&&(e.push(s),n.add(s.id))})}),e},Rs=t=>{t.freehand.timelineDuration.value;let e=0;if(Ql(t))t.freehand.selectedStrokesForTimeline.value=new Set,t.freehand.timelineDuration.value=0;else{const n=_c(t).filter(s=>s.isFreehand),i=new Set(n.map(s=>s.id));if(t.freehand.selectedStrokesForTimeline.value=i,n.length>0){const s=n.sort((o,a)=>o.creationTime-a.creationTime);let r=0;s.forEach((o,a)=>{const l=o.timestamps[o.timestamps.length-1]||0;r+=l,a<s.length-1&&(r+=100)}),e=r,t.freehand.timelineDuration.value=r}else t.freehand.timelineDuration.value=0}e>0&&t.freehand.currentPlaybackTime.value>e&&(t.freehand.currentPlaybackTime.value=0,Os(t,0))},vc=t=>{t.freehand.strokes.clear(),t.freehand.strokeGroups.clear()},bc=(t,e,n)=>{const i={id:n.id,points:n.points,timestamps:n.timestamps,shape:n.shape,selected:n.selected,originalPath:n.originalPath,creationTime:n.creationTime,isFreehand:n.isFreehand};t.freehand.strokes.set(e,i)},Sc=(t,e,n)=>{const i={id:n.id,strokeIds:n.strokeIds,group:n.group};t.freehand.strokeGroups.set(e,i)},mr=300,xc=t=>ws(t,()=>{const e=t.groups.freehandShape;if(!t.stage||!e)return null;try{const i=e.toObject(),s=Array.from(t.freehand.strokes.entries()),r=Array.from(t.freehand.strokeGroups.entries());return{layer:i,strokes:s,strokeGroups:r}}catch(i){return console.warn("Failed to get current state:",i),null}}),Ie=t=>{const e=xc(t);return JSON.stringify(e)},wc=(t,e,n={})=>{if(e)try{const i=t.freehand.currentPlaybackTime.value>0;t.freehand.currentPlaybackTime.value=0,t.freehand.isAnimating.value=!1,Ds(t,e),i&&n.handleTimeUpdate?.(0)}catch(i){console.warn("Failed to restore state:",i)}},Es=t=>{t.freehand.freehandDragStartState=Ie(t)},Ms=(t,e)=>{if(!t.freehand.freehandDragStartState)return;const n=Ie(t);t.freehand.freehandDragStartState!==n&&(cr(t,`Transform ${e}`,t.freehand.freehandDragStartState,n),console.log("Transform command added to global history"),ge(t)),t.freehand.freehandDragStartState=null},Fs=t=>{const e=t.stage;e&&Jt(t).forEach((n,i)=>{const s=e.findOne(`#${i}`);s&&s!==n.shape&&(console.log("Updating stroke connection for:",i),n.shape=s)})},Cc=t=>{const e=t.groups.freehandShape;if(!(!t.stage||!e))try{const i=xc(t);if(!i)return;t.freehand.serializedState=JSON.stringify(i),t.callbacks.syncAppState?.(t),console.log("Serialized canvas state:",{layerChildren:i.layer?.children?.length||0,strokes:i.strokes.length,strokeGroups:i.strokeGroups.length})}catch(i){console.warn("Failed to serialize Konva state:",i)}},Ds=(t,e)=>{const n=t.groups.freehandShape,i=t.stage;if(!(!e||!i||!n))try{const s=JSON.parse(e);console.log("Deserializing canvas state:",{layerChildren:s.layer?.children?.length||0,strokes:s.strokes?.length||0,strokeGroups:s.strokeGroups?.length||0}),n.destroyChildren(),vc(t),le(t);const r=s.layer;r&&r.children&&(console.log("Restoring",r.children.length,"children"),r.children.forEach((o,a)=>{console.log("Creating node",a,"of type",o.className);const l=Q.Node.create(JSON.stringify(o));n.add(l),console.log("Added node to layer:",l.id(),l.isVisible()),pr(t,l),As(t,l)})),s.strokes&&s.strokes.forEach(([o,a])=>{const l=i.findOne(`#${o}`);console.log("Restoring stroke:",o,"found shape:",!!l);const c={id:a.id,points:a.points,timestamps:a.timestamps,originalPath:a.originalPath,creationTime:a.creationTime,isFreehand:a.isFreehand,shape:l};bc(t,o,c)}),s.strokeGroups&&s.strokeGroups.forEach(([o,a])=>{const l={id:a.id,strokeIds:a.strokeIds,group:i.findOne(`#${o}`)};Sc(t,o,l)}),Fs(t),Ns(t),n.getLayer()?.batchDraw(),console.log("Konva canvas state restored from hotreload"),t.freehand.serializedState=e,setTimeout(()=>{n.getLayer()?.batchDraw(),ge(t)},30)}catch(s){console.warn("Failed to deserialize Konva state:",s)}},Ns=t=>{const e=t.groups.freehandShape;Jt(t).forEach(n=>{n.shape&&n.shape.draggable(!1)}),e&&e.getChildren().forEach(n=>{n instanceof Q.Group&&n.draggable(!1)})},Ci=(t,e=!1)=>{if(t.length<4)return"";const n=[];for(let o=0;o<t.length;o+=2)n.push([t[o],t[o+1]]);const i=F0(n,{size:8,thinning:.5,smoothing:.5,streamline:.5,simulatePressure:!0});if(i.length===0)return"";let s=i;if(e){let o=1/0,a=1/0;i.forEach(([l,c])=>{o=Math.min(o,l),a=Math.min(a,c)}),s=i.map(([l,c])=>[l-o,c-a])}return`${s.reduce((o,[a,l],c,h)=>{const[m,g]=h[(c+1)%h.length];return`${o} ${a},${l} ${m},${g}`},`M ${s[0][0]},${s[0][1]} L`)} Z`},Pc=(t,e,n)=>{const i=t.groups.freehandShape,s=fr(e),r=[];for(let a=0;a<e.length;a+=2)r.push(e[a]-s.minX),r.push(e[a+1]-s.minY);const o=new Q.Path({data:Ci(r),fill:"black",strokeWidth:0,id:n,x:s.minX,y:s.minY,draggable:!0});return o.on("dragstart",()=>{Es(t)}),o.on("dragend",()=>{Ms(t,"Stroke"),i?.getLayer()?.batchDraw()}),Zl(t,o),o},Os=(t,e)=>{const n=t.groups.freehandShape;t.freehand.currentPlaybackTime.value=e;let i=[];const s=!Ql(t);if(s?i=_c(t).filter(c=>c.isFreehand):i=Array.from(Jt(t).values()).filter(l=>l.isFreehand),i.sort((l,c)=>l.creationTime-c.creationTime),e===0){if(s){const l=new Set;i.forEach(c=>{if(c.shape&&c.originalPath){c.shape.show(),c.shape.data(c.originalPath);let h=c.shape.getParent();for(;h&&h!==n;)h instanceof Q.Group&&l.add(h),h=h.getParent()}}),l.forEach(c=>c.show())}else Jt(t).forEach(l=>{l.shape&&l.originalPath&&l.isFreehand&&(l.shape.show(),l.shape.data(l.originalPath))}),n&&n.getChildren().forEach(l=>{l instanceof Q.Group&&l.show()});n?.getLayer()?.batchDraw();return}s?i.forEach(l=>{l.shape&&l.shape.hide()}):(Jt(t).forEach(l=>{l.shape&&l.isFreehand&&l.shape.hide()}),n&&n.getChildren().forEach(l=>{l instanceof Q.Group&&l.hide()}));let r=0;const o=[];if(s)i.forEach((l,c)=>{const h=l.timestamps[l.timestamps.length-1]||0;o.push({stroke:l,startTime:r,endTime:r+h}),r+=h+(c<i.length-1?100:0)});else{let l=0;i.forEach((c,h)=>{const m=c.timestamps[c.timestamps.length-1]||0;if(h===0)o.push({stroke:c,startTime:0,endTime:m}),l=c.creationTime+m,r=m;else{let g=Math.max(0,c.creationTime-l);!t.freehand.useRealTiming.value&&g>mr&&(g=mr);const u=r+g;o.push({stroke:c,startTime:u,endTime:u+m}),r=u+m,l=c.creationTime+m}})}const a=new Set;o.forEach(({stroke:l,startTime:c,endTime:h})=>{if(!(!l.shape||!l.timestamps)){if(e>=c&&e<=h){const m=e-c;let g=-1;for(let u=0;u<l.timestamps.length&&l.timestamps[u]<=m;u++)g=u;if(g>=0){const u=l.points.slice(0,(g+1)*2);if(u.length>=4){const f=fr(l.points),_=[];for(let C=0;C<u.length;C+=2)_.push(u[C]-f.minX),_.push(u[C+1]-f.minY);l.shape.show(),l.shape.data(Ci(_));let S=l.shape.getParent();for(;S&&S!==n;)S instanceof Q.Group&&a.add(S),S=S.getParent()}}}else if(e>h){l.shape.show(),l.shape.data(l.originalPath);let m=l.shape.getParent();for(;m&&m!==n;)m instanceof Q.Group&&a.add(m),m=m.getParent()}}}),a.forEach(l=>l.show()),n?.getLayer()?.batchDraw()},I0=t=>{const e=t.groups.freehandShape;if(!e)return{data:[],groupMap:{}};const n=(a,l)=>{const c=fr(a),h=[];for(let u=0;u<a.length;u+=2)h.push(a[u]-c.minX),h.push(a[u+1]-c.minY);const m=l.getAbsoluteTransform(),g=[];for(let u=0;u<h.length;u+=2){const f=m.point({x:h[u],y:h[u+1]});g.push({x:f.x,y:f.y})}return g};let i=0;const s={},r=a=>{if(a instanceof Q.Path){const l=Array.from(t.freehand.strokes.values()).find(g=>g.shape===a);if(!l)return null;const h=n(l.points,a).map((g,u)=>({x:g.x,y:g.y,ts:l.timestamps[Math.floor(u/2)]||0})),m=a.getAttr("metadata");return m&&m.name&&typeof m.name=="string"&&(s[m.name]||(s[m.name]=[]),s[m.name].push(i)),i++,{type:"stroke",points:h,...m&&{metadata:m}}}else if(a instanceof Q.Group){const l=i,c=[];if(a.getChildren().forEach(m=>{const g=r(m);g&&c.push(g)}),c.length===0)return null;const h=a.getAttr("metadata");if(h&&h.name&&typeof h.name=="string"){const m=[];for(let g=l;g<i;g++)m.push(g);s[h.name]=m}return{type:"strokeGroup",children:c,...h&&{metadata:h}}}return null},o=[];return e.getChildren().forEach(a=>{const l=r(a);l&&(l.type==="stroke"?o.push({type:"strokeGroup",children:[l]}):o.push(l))}),{data:o,groupMap:s}},ge=t=>{const e=I0(t);t.freehand.bakedRenderData=e.data,t.freehand.bakedGroupMap=e.groupMap,t.callbacks.syncAppState?.(t)},Tc=Object.freeze(Object.defineProperty({__proto__:null,attachHandlersRecursively:pr,clearStrokesInState:vc,createStrokeShape:Pc,deepCloneWithNewIds:mc,deserializeFreehandState:Ds,finishFreehandDragTracking:Ms,getCurrentFreehandStateString:Ie,getStrokePath:Ci,handleTimeUpdate:Os,initFreehandLayers:yc,maxInterStrokeDelay:mr,refreshStrokeConnections:Fs,restoreFreehandState:wc,serializeFreehandState:Cc,setStrokeGroupInState:Sc,setStrokeInState:bc,startFreehandDragTracking:Es,updateBakedFreehandData:ge,updateFreehandDraggableStates:Ns,updateTimelineState:Rs},Symbol.toStringTag,{value:"Module"})),U0=(t,e,n)=>{const i=e.x-t.x,s=e.y-t.y,r=n.x-t.x,o=n.y-t.y,a=i*r+s*o;if(a<=0)return Math.hypot(r,o);const l=i*i+s*s;if(l<=a)return Math.hypot(n.x-e.x,n.y-e.y);const c=a/l,h=t.x+c*i,m=t.y+c*s;return Math.hypot(n.x-h,n.y-m)};function kc(t,e){let n=-1,i=-1,s=1/0;for(let r=0;r<t.length;r++){const o=t[r];for(let a=0;a<o.points.length;a++){const l=o.points[a],c=o.points[(a+1)%o.points.length],h=U0(l,c,e);h<s&&(s=h,n=r,i=a)}}return{polygonIndex:n,lineIndex:i,distance:s}}const Ac=(t,e)=>{const n=t.layers.drawing,i=t.layers.overlay;if(!n||!i){console.warn("Cannot initialize polygon groups without required layers");return}if(!t.groups.polygonShapes){const s=new Q.Group({name:"polygon-shapes"});t.groups.polygonShapes=s,n.add(s)}if(!t.groups.polygonPreview){const s=new Q.Group({name:"polygon-preview"});t.groups.polygonPreview=s,i.add(s)}if(!t.groups.polygonControls){const s=new Q.Group({name:"polygon-controls"});t.groups.polygonControls=s,i.add(s)}if(!t.groups.polygonSelection){const s=new Q.Group({name:"polygon-selection"});t.groups.polygonSelection=s,i.add(s)}},Gs=t=>{le(t)},Rc=t=>{const e=t.groups.polygonShapes;if(!e)return[];const n=[],i=(s,r)=>{const o=[],a=r.getAbsoluteTransform();for(let l=0;l<s.length;l+=2){const c=a.point({x:s[l],y:s[l+1]});o.push({x:c.x,y:c.y})}return o};return e.getChildren().forEach(s=>{if(s instanceof Q.Line){const r=s.points(),o=i(r,s),a=s.getAttr("metadata");n.push({type:"polygon",points:o,...a&&{metadata:a}})}}),n},xe=t=>{t.polygon.bakedRenderData=Rc(t),t.callbacks.syncAppState?.(t)},Ls=t=>ws(t,()=>{const e=t.groups.polygonShapes;if(!t.stage||!e)return null;try{const i=e.toObject(),s=Array.from(t.polygon.shapes.entries()),r=Array.from(t.polygon.groups.entries());return{layer:i,polygons:s,polygonGroups:r}}catch(i){return console.warn("Failed to get current polygon state:",i),null}}),dn=t=>{const e=Ls(t);return JSON.stringify(e)},Ec=(t,e)=>{if(e)try{Bs(t,e)}catch(n){console.warn("Failed to restore polygon state:",n)}},Is=t=>{const e=JSON.stringify({freehand:Ie(t),polygon:dn(t)});t.polygon.dragStartState=e},Us=(t,e)=>{if(!t.polygon.dragStartState)return;const n=JSON.stringify({freehand:Ie(t),polygon:dn(t)});t.polygon.dragStartState!==n&&(cr(t,`Transform ${e}`,t.polygon.dragStartState,n),xe(t)),t.polygon.dragStartState=null},Ue=t=>{const e=t.groups.polygonShapes;if(!(!t.stage||!e))try{const i=Ls(t);if(!i)return;t.polygon.serializedState=JSON.stringify(i),t.callbacks.syncAppState?.(t),console.log("Serialized polygon state:",{layerChildren:i.layer?.children?.length||0,polygons:i.polygons.length,polygonGroups:i.polygonGroups.length})}catch(i){console.warn("Failed to serialize polygon state:",i)}},yr=(t,e)=>{console.log("Attaching polygon handlers to:",e.id()),e.draggable(!1),e.on("dragstart",()=>Is(t)),e.on("dragend",()=>{Us(t,"Polygon Drag"),Ue(t)})},Bs=(t,e)=>{const n=t.groups.polygonShapes,i=t.groups.polygonControls,s=t.stage;if(!(!e||!s||!n))try{const r=JSON.parse(e);console.log("Deserializing polygon state:",{layerChildren:r.layer?.children?.length||0,polygons:r.polygons?.length||0,polygonGroups:r.polygonGroups?.length||0}),n.destroyChildren(),t.polygon.shapes.clear(),t.polygon.groups.clear(),le(t);const o=r.layer;o&&o.children&&(console.log("Restoring",o.children.length,"polygon shapes"),o.children.forEach((a,l)=>{console.log("Creating polygon node",l,"of type",a.className);const c=Q.Node.create(JSON.stringify(a));n.add(c),console.log("Added polygon node to layer:",c.id(),c.isVisible()),c instanceof Q.Line?(yr(t,c),Ps(t,c)):c instanceof Q.Group&&Cs(t,c)})),r.polygons&&r.polygons.forEach(([a,l])=>{const c=s.findOne(`#${a}`);console.log("Restoring polygon:",a,"found shape:",!!c);const h={id:l.id,points:l.points,closed:l.closed,creationTime:l.creationTime,konvaShape:c,controlPoints:[]};t.polygon.shapes.set(a,h)}),r.polygonGroups&&r.polygonGroups.forEach(([a,l])=>{const c={id:l.id,polygonIds:l.polygonIds,group:s.findOne(`#${a}`)};t.polygon.groups.set(a,c)}),i?.destroyChildren(),t.activeTool.value==="polygon"&&t.polygon.mode.value==="edit"&&un(t),n.getLayer()?.batchDraw(),t.polygon.serializedState=e,xe(t),console.log("Polygon state restored from hotreload")}catch(r){console.warn("Failed to deserialize polygon state:",r)}},Mc=(t,e)=>{const n=t.groups.polygonShapes;if(n){if(t.polygon.mode.value==="draw"){if(!t.polygon.isDrawing.value)t.polygon.isDrawing.value=!0,t.polygon.currentPoints.value=[e.x,e.y];else{const i=t.polygon.currentPoints.value[0],s=t.polygon.currentPoints.value[1];Math.sqrt((e.x-i)**2+(e.y-s)**2)<t.polygon.proximityThreshold&&t.polygon.currentPoints.value.length>=6?Hs(t):(t.polygon.currentPoints.value.push(e.x,e.y),_r(t))}_r(t)}else if(t.polygon.mode.value==="edit"){const i=Array.from(ae(t).values()).map(s=>{const r=s.konvaShape,o=r?r.getAbsoluteTransform():null,a=[];for(let l=0;l<s.points.length;l+=2)if(o){const c=o.point({x:s.points[l],y:s.points[l+1]});a.push({x:c.x,y:c.y})}else a.push({x:s.points[l],y:s.points[l+1]});return{points:a}});if(i.length>0){const s=kc(i,e);if(s.polygonIndex>=0&&s.distance<t.polygon.proximityThreshold*2){const r=Array.from(ae(t).keys())[s.polygonIndex],o=ae(t).get(r);o&&o.konvaShape&&Ye(t,"Add Polygon Point",()=>{const a=o.points,l=(s.lineIndex+1)*2,c=a[s.lineIndex*2],h=a[s.lineIndex*2+1],m=a[(s.lineIndex+1)*2%a.length],g=a[((s.lineIndex+1)*2+1)%a.length],u=(c+m)/2,f=(h+g)/2;o.points.splice(l,0,u,f),o.konvaShape.points(o.points),un(t),Ue(t),n?.getLayer()?.batchDraw(),xe(t)})}}}}},Fc=t=>{!t.polygon.isDrawing.value||t.polygon.mode.value!=="draw"||_r(t)},Dc=t=>{const e=t.groups.polygonPreview,n=t.groups.polygonControls,i=t.stage;if(!e||!i||ae(t).size===0)return;const s=i.getPointerPosition();if(!s)return;const r=i.getIntersection(s);if(r&&r.getParent()===n){e.destroyChildren(),e.getLayer()?.batchDraw();return}const o=Array.from(ae(t).values()).map(a=>{const l=a.konvaShape,c=l?l.getAbsoluteTransform():null,h=[];for(let m=0;m<a.points.length;m+=2)if(c){const g=c.point({x:a.points[m],y:a.points[m+1]});h.push({x:g.x,y:g.y})}else h.push({x:a.points[m],y:a.points[m+1]});return{points:h}});if(o.length>0){const a=kc(o,s);if(e.destroyChildren(),a.polygonIndex>=0&&a.distance<20){const l=Array.from(ae(t).values())[a.polygonIndex],c=l.points,h=l.konvaShape,m=h?h.getAbsoluteTransform():null,g=c[a.lineIndex*2],u=c[a.lineIndex*2+1],f=c[(a.lineIndex+1)*2%c.length],_=c[((a.lineIndex+1)*2+1)%c.length],S=m?m.point({x:g,y:u}):{x:g,y:u},C=m?m.point({x:f,y:_}):{x:f,y:_},p=(S.x+C.x)/2,d=(S.y+C.y)/2,y=new Q.Line({points:[S.x,S.y,C.x,C.y],stroke:"#00ff00",strokeWidth:4,opacity:.8});e.add(y);const b=new Q.Circle({x:p,y:d,radius:5,fill:"#00ff00",stroke:"#00aa00",strokeWidth:2,opacity:.9});e.add(b)}e.getLayer()?.batchDraw()}},_r=t=>{const e=t.groups.polygonPreview,n=t.stage;if(!e||!n)return;if(e.destroyChildren(),t.polygon.currentPoints.value.length<4){if(t.polygon.currentPoints.value.length===2){const o=new Q.Circle({x:t.polygon.currentPoints.value[0],y:t.polygon.currentPoints.value[1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});e.add(o)}e.getLayer()?.batchDraw();return}const i=n.getPointerPosition();if(!i)return;for(let o=0;o<t.polygon.currentPoints.value.length;o+=2){const a=new Q.Circle({x:t.polygon.currentPoints.value[o],y:t.polygon.currentPoints.value[o+1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});e.add(a)}const s=[...t.polygon.currentPoints.value,i.x,i.y],r=new Q.Line({points:s,stroke:"#999",strokeWidth:2,fill:"rgba(153, 153, 153, 0.1)",closed:!1,dash:[5,5],listening:!1});if(e.add(r),t.polygon.currentPoints.value.length>=6){const o=t.polygon.currentPoints.value[0],a=t.polygon.currentPoints.value[1],l=Math.sqrt((i.x-o)**2+(i.y-a)**2),c=new Q.Circle({x:o,y:a,radius:t.polygon.proximityThreshold,stroke:l<t.polygon.proximityThreshold?"#00ff00":"#ff0000",strokeWidth:2,fill:"transparent",listening:!1});e.add(c)}e.getLayer()?.batchDraw()},Hs=t=>{const e=t.groups.polygonShapes,n=t.groups.polygonPreview;t.polygon.currentPoints.value.length<6||Ye(t,"Create Polygon",()=>{const i=`polygon-${Date.now()}`,s={id:i,points:[...t.polygon.currentPoints.value],closed:!0,creationTime:Date.now()},r=new Q.Line({points:s.points,stroke:"#000",strokeWidth:2,fill:"rgba(0, 100, 255, 0.1)",closed:!0,draggable:!1,id:i});yr(t,r),s.konvaShape=r,ae(t).set(i,s),e?.add(r),Ps(t,r),t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],n?.destroyChildren(),un(t),Ue(t),e?.getLayer()?.batchDraw(),n?.getLayer()?.batchDraw(),xe(t)})},Nc=t=>{const e=t.groups.polygonPreview;t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],e?.destroyChildren(),e?.getLayer()?.batchDraw()},un=t=>{const e=t.groups.polygonControls,n=t.groups.polygonShapes;e&&(e.destroyChildren(),t.polygon.mode.value==="edit"&&ae(t).forEach(i=>{i.controlPoints=[];for(let s=0;s<i.points.length;s+=2){const r=s,o=i.points[r],a=i.points[r+1];let l=o,c=a;if(i.konvaShape){const g=i.konvaShape.getAbsoluteTransform().point({x:o,y:a});l=g.x,c=g.y}const h=new Q.Circle({x:l,y:c,radius:6,fill:"#ff6600",stroke:"#ff4400",strokeWidth:2,draggable:!0,id:`${i.id}-control-${r/2}`});h.on("mouseenter",()=>{h.fill("#ffaa00"),h.radius(8),e?.getLayer()?.batchDraw()}),h.on("mouseleave",()=>{h.fill("#ff6600"),h.radius(6),e?.getLayer()?.batchDraw()}),h.on("dragstart",()=>{Is(t)}),h.on("dragmove",()=>{const m={x:h.x(),y:h.y()};if(i.konvaShape){const g=i.konvaShape.getAbsoluteTransform().copy();g.invert();const u=g.point(m);i.points[r]=u.x,i.points[r+1]=u.y}else i.points[r]=m.x,i.points[r+1]=m.y;i.konvaShape&&(i.konvaShape.points(i.points),n?.getLayer()?.batchDraw())}),h.on("dragend",()=>{Us(t,"Polygon Control Point"),Ue(t)}),i.controlPoints.push(h),e.add(h)}}),e.getLayer()?.batchDraw())},Oc=t=>It(()=>t.polygon.mode.value,e=>{const n=t.groups.polygonControls,i=t.groups.polygonPreview;if(t.activeTool.value!=="polygon"){n?.destroyChildren(),n?.getLayer()?.batchDraw();return}Gs(t),e==="draw"?(t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],i?.destroyChildren(),i?.getLayer()?.batchDraw(),ae(t).forEach(s=>{s.konvaShape?.draggable(!1)})):e==="edit"&&(i?.destroyChildren(),i?.getLayer()?.batchDraw(),ae(t).forEach(s=>{s.konvaShape?.draggable(!1)})),un(t),Gs(t)}),Gc=Object.freeze(Object.defineProperty({__proto__:null,attachPolygonHandlers:yr,clearCurrentPolygon:Nc,clearPolygonSelection:Gs,deserializePolygonState:Bs,finishPolygon:Hs,finishPolygonDragTracking:Us,generateBakedPolygonData:Rc,getCurrentPolygonState:Ls,getCurrentPolygonStateString:dn,handlePolygonClick:Mc,handlePolygonEditMouseMove:Dc,handlePolygonMouseMove:Fc,initPolygonLayers:Ac,restorePolygonState:Ec,serializePolygonState:Ue,setupPolygonModeWatcher:Oc,startPolygonDragTracking:Is,updateBakedPolygonData:xe,updatePolygonControlPoints:un,updatePolygonPreview:_r},Symbol.toStringTag,{value:"Module"})),B0=(t,e)=>{const n=new Q.Transformer({rotateEnabled:!0,keepRatio:!1,padding:6});return t.layers.transformer=n,n.on("transformstart",()=>{z0(t)}),n.on("transformend",()=>{W0(t,"Transform")}),e.add(n),It(t.selection.selectedKonvaNodes,i=>{V0(t,i)},{immediate:!0}),n};function H0(t,e){B0(t,e)}function V0(t,e){const n=t.layers.transformer;if(!n)return;const i=e.filter(s=>!(s instanceof Q.Line&&t.polygon.mode.value==="edit"&&t.activeTool.value==="polygon"));n.nodes(i),t.layers.overlay?.batchDraw()}function z0(t){Promise.resolve().then(()=>Tc).then(({getCurrentFreehandStateString:e})=>{Promise.resolve().then(()=>Gc).then(({getCurrentPolygonStateString:n})=>{const i=JSON.stringify({freehand:e(t),polygon:n(t)});t.selection.transformStartState=i})})}function W0(t,e){const n=t.selection.transformStartState;n&&Promise.resolve().then(()=>Tc).then(({getCurrentFreehandStateString:i})=>{Promise.resolve().then(()=>Gc).then(({getCurrentPolygonStateString:s})=>{const r=JSON.stringify({freehand:i(t),polygon:s(t)});n!==r&&cr(t,e,n,r),t.selection.transformStartState=""})})}function $0(t,e){t.groups.selectionOverlay=e;const n=t.stage??e.getStage();if(!t.layers.grid&&n){const i=new Q.Layer({listening:!1,name:"grid-layer"});n.add(i),i.moveToBottom(),t.layers.grid=i}t.selection.selectionRect=new Q.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),e.add(t.selection.selectionRect)}function j0(t,e,n){const i=e.getPointerPosition();if(!i)return;const s=r=>{let o=r;for(;o&&!(o instanceof Q.Stage);){if(o instanceof Q.Transformer)return!0;o=o.getParent()}return!1};if(!(n.target&&s(n.target))){if(n.target!==e){let r=n.target,o=vi(t,r);for(;r&&!(r instanceof Q.Stage)&&(r=r.getParent(),!(!r||r instanceof Q.Stage));){const a=vi(t,r);a&&(o=a)}if(o){const a=Jl(t,o);n.evt.shiftKey?kf(t,o,!0):a||(le(t),dr(t,o,!0)),Jl(t,o)&&Q0(t,e);return}}(n.target===e||n.target instanceof Q.Layer)&&(t.selection.dragSelectionState.value={isSelecting:!0,startPos:{x:i.x,y:i.y},currentPos:{x:i.x,y:i.y},isShiftHeld:n.evt.shiftKey},Y0(t,i.x,i.y))}}function q0(t,e,n){if(t.selection.selectionDragState.isDragging){Z0(t,e);return}if(!t.selection.dragSelectionState.value.isSelecting)return;const i=e.getPointerPosition();i&&(t.selection.dragSelectionState.value.currentPos={x:i.x,y:i.y},X0(t))}function K0(t,e,n){if(t.selection.selectionDragState.isDragging){tg(t);return}t.selection.dragSelectionState.value.isSelecting&&(J0(t,t.selection.dragSelectionState.value.isShiftHeld),t.selection.dragSelectionState.value.isSelecting=!1)}function Y0(t,e,n){t.selection.selectionRect&&t.selection.selectionRect.setAttrs({x:e,y:n,width:0,height:0,visible:!1})}function X0(t){if(!t.selection.selectionRect||!t.selection.dragSelectionState.value.isSelecting)return;const{startPos:e,currentPos:n}=t.selection.dragSelectionState.value,i=Math.min(e.x,n.x),s=Math.min(e.y,n.y),r=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y);t.selection.selectionRect.setAttrs({x:i,y:s,width:r,height:o,visible:r>5||o>5}),t.groups.selectionOverlay?.getLayer()?.batchDraw()}function J0(t,e=!1){if(!t.selection.selectionRect)return;const{startPos:n,currentPos:i}=t.selection.dragSelectionState.value,s=Math.abs(i.x-n.x),r=Math.abs(i.y-n.y);if(!(s>=5||r>=5)){e||le(t),t.selection.selectionRect.visible(!1),t.groups.selectionOverlay?.getLayer()?.batchDraw();return}const a=[],l=t.selection.selectionRect.getClientRect(),c=f=>f instanceof Q.Transformer?!1:f instanceof Q.Path||f instanceof Q.Line||f instanceof Q.Group,h=[],m=t.groups.selectionOverlay?.getStage();m&&(t.groups.freehandShape&&h.push(t.groups.freehandShape),t.groups.polygonShapes&&h.push(t.groups.polygonShapes),h.length===0&&m.getLayers().forEach(f=>{f.getChildren().some(S=>c(S))&&h.push(f)}));const g=f=>{const _=f.getClientRect();return!(l.x+l.width<_.x||_.x+_.width<l.x||l.y+l.height<_.y||_.y+_.height<l.y)},u=f=>{if(!c(f)){f instanceof Q.Container&&f.getChildren().forEach(S=>u(S));return}const _=vi(t,f);if(_){g(f)&&a.push(_);return}f instanceof Q.Container&&f.getChildren().forEach(S=>u(S))};h.forEach(f=>{f.getChildren().forEach(_=>{u(_)})}),e||(le(t),Rs(t)),a.forEach(f=>dr(t,f,!0)),t.selection.selectionRect.setAttrs({x:0,y:0,width:0,height:0,visible:!1}),t.groups.selectionOverlay?.getLayer()?.batchDraw()}function Q0(t,e){const n=e.getPointerPosition();if(!n)return;t.selection.selectionDragState.isDragging=!0,t.selection.selectionDragState.startPos={x:n.x,y:n.y},t.selection.selectionDragState.startNodePositions.clear(),t.selection.selectionDragState.beforeState=JSON.stringify({freehand:Ie(t),polygon:dn(t)}),t.selection.selectedKonvaNodes.value.forEach(s=>{const r=s.getAbsolutePosition();t.selection.selectionDragState.startNodePositions.set(s,{x:r.x,y:r.y})})}function Z0(t,e){const n=e.getPointerPosition();if(!n)return;const i=n.x-t.selection.selectionDragState.startPos.x,s=n.y-t.selection.selectionDragState.startPos.y;t.selection.selectionDragState.startNodePositions.forEach((o,a)=>{a.absolutePosition({x:o.x+i,y:o.y+s})});const r=new Set;t.selection.selectionDragState.startNodePositions.forEach((o,a)=>{let l=a.getParent();for(;l&&!(l instanceof Q.Layer);)l=l.getParent();l instanceof Q.Layer&&r.add(l)}),r.forEach(o=>o.batchDraw())}function tg(t){const e=JSON.stringify({freehand:Ie(t),polygon:dn(t)});t.selection.selectionDragState.beforeState!==e&&cr(t,"Move Selection",t.selection.selectionDragState.beforeState,e),t.selection.selectionDragState.isDragging=!1,t.selection.selectionDragState.startNodePositions.clear()}function Lc(t){return t.selection.selectedKonvaNodes.value}function Ic(t){let e=t;for(;e&&!(e instanceof Q.Layer);)e=e.getParent();return e instanceof Q.Layer?e:null}function Uc(t,e){const n=t.getAbsoluteTransform().copy();t.moveTo(e);const i=e.getAbsoluteTransform().copy();i.invert();const r=i.multiply(n).decompose();t.setAttrs({x:r.x,y:r.y,scaleX:r.scaleX,scaleY:r.scaleY,rotation:r.rotation,skewX:r.skewX,skewY:r.skewY})}function Bc(t){const e=Lc(t);if(e.length<1||e.some(s=>s instanceof Q.Line)||new Set(e.map(s=>Ic(s))).size!==1)return!1;const i=e.filter(s=>s instanceof Q.Path||s instanceof Q.Group);return!(i.length<1||Ef(i))}function eg(t){if(!Bc(t))return;const e=t.selection.selectedKonvaNodes.value.filter(n=>n instanceof Q.Path||n instanceof Q.Group);e.length<1||Ye(t,"Group Selection",()=>{const n=e.filter(a=>!e.some(l=>l!==a&&l.isAncestorOf(a))),i=Ic(n[0]);if(!i)return;let s=n[0].getParent();n.every(a=>a.getParent()===s)||(s=i);const r=new Q.Group({draggable:!1});s.add(r),n.forEach(a=>{Uc(a,r)});const o=Cs(t,r);le(t),dr(t,o),r.getLayer()?.batchDraw(),ge(t)})}function Hc(t){const e=Lc(t);return e.length!==1||e[0]instanceof Q.Line?!1:e[0]instanceof Q.Group}function ng(t){if(!Hc(t))return;const e=t.selection.selectedKonvaNodes.value[0],n=e.getParent();n&&Ye(t,"Ungroup Selection",()=>{[...e.getChildren()].forEach(r=>{Uc(r,n),r.draggable(!1)});const s=e.id();e.destroy(),tc(t,s),le(t),n.getLayer()?.batchDraw();try{Fs(t)}catch{console.error("refreshStrokeConnections failed")}ge(t)})}function Vc(t){const e=t.selection.selectedKonvaNodes.value;return e.filter(n=>!e.some(i=>i!==n&&i.isAncestorOf(n)))}function ig(t){const e=t.groups.freehandShape;t.selection.selectedKonvaNodes.value.length!==0&&Ye(t,"Duplicate",()=>{ws(t,()=>{const i=Vc(t),s=[];i.forEach(r=>{if(r instanceof Q.Path||r instanceof Q.Group){const o=mc(t,r,50,50),a=r.getParent();a&&a.add(o),s.push(o)}else if(r instanceof Q.Line){const o=r.clone({x:r.x()+50,y:r.y()+50}),a=_i("poly_");o.id(a);const l=r.getParent();l&&l.add(o),Ps(t,o),yr(t,o),ae(t).set(a,{id:a,points:[...o.points()],closed:!!o.closed(),creationTime:Date.now(),konvaShape:o}),s.push(o)}}),le(t),s.forEach(r=>{const o=vi(t,r);o&&dr(t,o,!0)}),e?.getLayer()?.batchDraw(),t.groups.polygonShapes?.getLayer()?.batchDraw(),ge(t),xe(t),Ue(t)})})}function rg(t){const e=t.groups.freehandShape;t.selection.selectedKonvaNodes.value.length!==0&&Ye(t,"Delete Selected",()=>{Vc(t).forEach(s=>{const r=[],o=a=>{r.push(a),a instanceof Q.Container&&a.getChildren().forEach(l=>o(l))};o(s),r.forEach(a=>{a instanceof Q.Path&&(Jt(t).delete(a.id()),Array.from(Jt(t).entries()).forEach(([l,c])=>{c.shape===a&&Jt(t).delete(l)}),Array.from(_s(t).values()).forEach(l=>{l.strokeIds=l.strokeIds.filter(c=>c!==a.id())})),a instanceof Q.Group&&_s(t).delete(a.id()),a instanceof Q.Line&&ae(t).delete(a.id()),tc(t,a.id())}),s.destroy()}),le(t),e?.getLayer()?.batchDraw(),t.groups.polygonShapes?.getLayer()?.batchDraw(),ge(t),xe(t),Ue(t),Promise.resolve().then(()=>y0).then(({refreshAnciliaryViz:s})=>s(t)).catch(()=>{})})}const zc=t=>{if(!t)return null;try{return JSON.parse(t)}catch(e){return console.warn("Failed to parse state string:",e),null}},sg=t=>{if(!t||typeof t!="object")return{};if("freehand"in t||"polygon"in t){const e={};return t.freehand!==void 0&&(e.freehand=typeof t.freehand=="string"?t.freehand:JSON.stringify(t.freehand)),t.polygon!==void 0&&(e.polygon=typeof t.polygon=="string"?t.polygon:JSON.stringify(t.polygon)),e}return"layer"in t&&(t.strokes||t.strokeGroups)?{freehand:JSON.stringify(t)}:"layer"in t&&(t.polygons||t.polygonGroups)?{polygon:JSON.stringify(t)}:{}},Wc=t=>{const e=Ie(t),n=dn(t),i=zc(e),s=zc(n);return JSON.stringify({version:1,freehand:i,polygon:s})},$c=(t,e,n={})=>{if(!e)return!1;let i;try{i=JSON.parse(e)}catch(o){return console.warn("Failed to parse canvas state JSON:",o),!1}const{freehand:s,polygon:r}=sg(i);return!s&&!r?(console.warn("Canvas state payload missing freehand and polygon data"),!1):(s&&wc(t,s,{handleTimeUpdate:n.handleTimeUpdate}),r&&Ec(t,r),!0)},og=(t,e)=>{const n=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)},ag=t=>{const e=Wc(t);if(!e){console.warn("No canvas state available to download");return}let n=e;try{n=JSON.stringify(JSON.parse(e),null,2)}catch(s){console.warn("Failed to pretty-print canvas state JSON:",s)}const i=new Date().toISOString().slice(0,16).replace(/:/g,"-");og(n,`canvas_state_${i}.json`)},lg=(t,e={})=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=async i=>{const s=i.target.files?.[0];if(s)try{const r=await s.text();if(!$c(t,r,e)){alert("Invalid canvas state file. Please upload a valid JSON export.");return}console.log("Canvas state restored from file:",s.name)}catch(r){console.error("Failed to restore canvas state from file:",r),alert("Failed to load canvas state. Please check the console for details.")}},n.click()},cg={class:"canvas-root"},hg={class:"control-panel"},dg=["disabled"],ug={class:"button-group vertical"},fg=["disabled"],gg=["disabled"],pg=["disabled"],mg={class:"button-group vertical"},yg=["disabled"],_g=["disabled"],vg={class:"button-group vertical"},bg=["disabled"],Sg=["disabled"],xg={class:"button-group vertical"},wg=["disabled"],Cg=["disabled"],Pg=["disabled"],Tg={class:"button-group vertical"},kg=["disabled"],Ag=["disabled"],Rg={class:"button-group vertical"},Eg=["disabled"],Mg=["disabled"],Fg={key:0,class:"info"},Dg={class:"info"},Ng={class:"canvas-wrapper"},Og={key:0,class:"metadata-suite"},Gg={key:0,class:"animation-lock-warning"},Lg=20,Ig=bi(sn({__name:"CanvasRoot",props:{syncState:{type:Function},initialFreehandState:{default:"",type:String},initialPolygonState:{default:"",type:String},width:{default:1e3,type:[Number,String]},height:{default:500,type:[Number,String]},showTimeline:{type:Boolean,default:!1},showVisualizations:{type:Boolean,default:!1}},emits:["state-update"],setup(t,{emit:e}){const n=t,i=e,s=Gt(()=>{const H=Number(n.width),V=Number(n.height);return{width:Number.isFinite(H)?H:1e3,height:Number.isFinite(V)?V:500}}),r=vf(),o=L0(r);let a;const l=r.activeTool,c=r.metadata.showEditor,h=H=>H==null?H:typeof structuredClone=="function"?structuredClone(H):JSON.parse(JSON.stringify(H)),m=H=>H?h(wt(H))??[]:[],g=H=>H?h(wt(H))??[]:[],u=H=>H?h(wt(H))??{}:{},f=H=>{const V=m(H.freehand.bakedRenderData),Z=u(H.freehand.bakedGroupMap),ot=g(H.polygon.bakedRenderData);return{freehand:{serializedState:H.freehand.serializedState??"",bakedRenderData:V??[],bakedGroupMap:Z??{}},polygon:{serializedState:H.polygon.serializedState??"",bakedRenderData:ot??[]}}},_=H=>{const V=f(H);n.syncState?.(V),i("state-update",V)};r.callbacks.syncAppState=_,It(()=>n.syncState,()=>{_(r)},{immediate:!0});const S=H=>$0(r,H),C=(H,V)=>j0(r,H,V),p=(H,V)=>q0(r,H),d=(H,V)=>K0(r),y=()=>eg(r),b=()=>ng(r),k=()=>ig(r),D=()=>rg(r),x=Gt(()=>Bc(r)),w=Gt(()=>Hc(r)),T=(H,V)=>Pc(r,H,V),M=()=>Ns(r),G=()=>Rs(r),I=H=>Os(r,H),B=()=>ag(r),L=()=>lg(r,{handleTimeUpdate:I}),X=()=>un(r),v=H=>Mc(r,H),P=()=>Fc(r),E=()=>Dc(r),A=()=>Hs(r),O=()=>Nc(r),j=()=>Oc(r),U=r.selection.selectedKonvaNodes,J=Gt(()=>Af(r)),st=Gt(()=>ur(r)>1),$=Gt(()=>{const H=U.value;return H.length===1&&H[0]instanceof Q.Group});r.callbacks.refreshAncillaryViz=()=>Xe(r);const F=()=>Wc(r),W=H=>{if(!H)return;$c(r,H,{handleTimeUpdate:I})||console.warn("Failed to restore canvas state: invalid payload")},nt=Rt(!1),it=Rt(!1),ct=()=>{ge(r),xe(r),Xe(r),nt.value=R.canUndo(),it.value=R.canRedo()},R=new _f(F,W,ct);r.command.stack=R,nt.value=R.canUndo(),it.value=R.canRedo();const N=(H,V)=>R.executeCommand(H,V),z=()=>R.undo(),q=()=>R.redo();r.command.executeCommand=N,r.command.pushCommand=(H,V,Z)=>{R.pushCommand(H,V,Z)};const Y=H=>{r.freehand.isAnimating.value=H;const V=r.stage;V&&(H?V.listening(!1):V.listening(!0))},K=()=>{const H=r.stage,V=r.layers.grid;if(!H||!V)return;const Z=!!r.grid.visible.value;if(V.visible(Z),V.destroyChildren(),!Z){V.batchDraw();return}const ot=r.grid.size,lt=Number.isFinite(ot)&&ot>0?ot:Lg,ht=5,pt=H.width(),ut=H.height(),Ct=Math.ceil(pt/lt),vt=Math.ceil(ut/lt),ft=(yt,xt)=>{V.add(new Q.Line({points:yt,stroke:xt?"rgba(0, 0, 0, 0.2)":"rgba(0, 0, 0, 0.08)",strokeWidth:xt?1:.5,listening:!1}))};for(let yt=0;yt<=Ct;yt++){const xt=Math.min(yt*lt,pt),Lt=yt%ht===0;ft([xt,0,xt,ut],Lt)}for(let yt=0;yt<=vt;yt++){const xt=Math.min(yt*lt,ut),Lt=yt%ht===0;ft([0,xt,pt,xt],Lt)}V.batchDraw()},tt=Rt(),rt=(H,V)=>{const Z=H.groups.freehandShape,ot=H.groups.freehandDrawing,lt=H.groups.selectionOverlay,ht=H.groups.polygonShapes,pt=H.groups.polygonPreview,ut=H.groups.polygonControls,Ct=H.groups.polygonSelection,vt=H.stage;le(H),V==="select"?(Z?.listening(!0),ht?.listening(!0),ot?.listening(!1),pt?.listening(!1),ut?.listening(!1),lt?.listening(!0),Ct?.listening(!0),H.layers.overlay?.moveToTop(),vt&&pc(r,vt).moveToTop()):V==="freehand"?(Z?.listening(!0),ot?.listening(!0),lt?.listening(!0),ht?.listening(!1),pt?.listening(!1),ut?.listening(!1),Ct?.listening(!1)):V==="polygon"&&(ht?.listening(!0),pt?.listening(!0),ut?.listening(!0),Ct?.listening(!0),Z?.listening(!1),ot?.listening(!1),lt?.listening(!1)),V==="polygon"&&H.polygon.mode.value==="edit"?X():(ut?.destroyChildren(),ut?.getLayer()?.batchDraw()),(yt=>{Z?.getChildren().forEach(xt=>{(xt instanceof Q.Path||xt instanceof Q.Group)&&xt.draggable(yt)}),ht?.getChildren().forEach(xt=>{(xt instanceof Q.Line||xt instanceof Q.Group)&&xt.draggable(yt)})})(!1),vt?.batchDraw()};It(l,H=>{rt(r,H)},{immediate:!0});const et=(H,V)=>{try{const Z=vi(r,H);Z?Rf(r,Z,V):(H.setAttr("metadata",V===void 0||Object.keys(V).length===0?void 0:V),ge(r),xe(r))}catch{H.setAttr("metadata",V===void 0||Object.keys(V).length===0?void 0:V),ge(r),xe(r)}};return Uo(async()=>{try{if(!tt.value){console.error("Konva container ref not found");return}const H=s.value,V=new Q.Stage({container:tt.value,width:H.width,height:H.height});r.stage=V,r.konvaContainer=tt.value;const Z=()=>{tt.value&&(tt.value.style.cursor=l.value==="freehand"?"crosshair":"default")};r.callbacks.updateCursor=Z,r.callbacks.updateCursor?.();const ot=new Q.Layer({listening:!1,name:"grid-layer"}),lt=new Q.Layer({name:"drawing-layer"}),ht=new Q.Layer({name:"overlay-layer"});V.add(ot),V.add(lt),V.add(ht),ot.moveToBottom(),r.layers.grid=ot,r.layers.drawing=lt,r.layers.overlay=ht,yc(r,V),Ac(r,V);const pt=new Q.Group({name:"selection-overlay"});ht.add(pt),S(pt),H0(r,pt),K(),pc(r,V).moveToTop(),ac(r),rt(r,l.value),l.value==="polygon"&&r.polygon.mode.value==="edit"&&X(),r.callbacks.updateCursor?.();const Ct=ft=>{!ft||ft===r.freehand.serializedState||Ds(r,ft)},vt=ft=>{!ft||ft===r.polygon.serializedState||Bs(r,ft)};Ct(n.initialFreehandState),vt(n.initialPolygonState),It(()=>n.initialFreehandState,ft=>{Ct(ft)}),It(()=>n.initialPolygonState,ft=>{vt(ft)}),It(()=>r.grid.visible.value,()=>{K()},{immediate:!0}),It(()=>r.layers.grid,()=>{K()},{immediate:!0}),It(()=>[n.width,n.height],([ft,yt])=>{const xt=Number(ft),Lt=Number(yt),Nt=Number.isFinite(xt)?xt:s.value.width,Vt=Number.isFinite(Lt)?Lt:s.value.height,pe=r.stage;pe&&(pe.width(Nt),pe.height(Vt),pe.batchDraw()),r.konvaContainer&&(r.konvaContainer.style.width=`${Nt}px`,r.konvaContainer.style.height=`${Vt}px`),K()},{immediate:!0}),rt(r,l.value),_(r),V.on("mousedown touchstart",ft=>{const yt=V.getPointerPosition();yt&&(l.value==="select"?C(V,ft):l.value==="freehand"?(r.freehand.isDrawing=!0,r.freehand.currentPoints=[yt.x,yt.y],r.freehand.drawingStartTime=performance.now(),r.freehand.currentTimestamps=[0],le(r)):l.value==="polygon"&&(ft.target.getParent?.()===r.groups.polygonControls||v(yt)))}),V.on("mousemove touchmove",ft=>{const yt=r.groups.freehandDrawing;if(l.value==="select")p(V,ft);else if(l.value==="freehand"){if(r.freehand.isDrawing){const xt=V.getPointerPosition();if(!xt)return;r.freehand.currentPoints.push(xt.x,xt.y),r.freehand.currentTimestamps.push(performance.now()-r.freehand.drawingStartTime),yt?.destroyChildren();const Lt=new Q.Path({data:Ci(r.freehand.currentPoints),fill:"#666",strokeWidth:0});yt?.add(Lt),yt?.getLayer()?.batchDraw()}}else l.value==="polygon"&&(r.polygon.mode.value==="draw"&&r.polygon.isDrawing.value?P():r.polygon.mode.value==="edit"&&E())}),V.on("mouseup touchend",ft=>{const yt=r.groups.freehandDrawing;l.value==="freehand"&&r.freehand.isDrawing?(r.freehand.isDrawing=!1,yt?.destroyChildren(),r.freehand.currentPoints.length>2&&N("Draw Stroke",()=>{const xt=r.groups.freehandShape,Lt=Date.now(),Nt=`stroke-${Lt}`,Vt=fr(r.freehand.currentPoints),pe=[];for(let vr=0;vr<r.freehand.currentPoints.length;vr+=2)pe.push(r.freehand.currentPoints[vr]-Vt.minX),pe.push(r.freehand.currentPoints[vr+1]-Vt.minY);const Ug=Ci(pe),qc={id:Nt,points:r.freehand.currentPoints,timestamps:r.freehand.currentTimestamps,originalPath:Ug,creationTime:Lt,isFreehand:!0},Kc=T(r.freehand.currentPoints,Nt);qc.shape=Kc,Jt(r).set(Nt,qc),xt?.add(Kc),M(),G(),xt?.getLayer()?.batchDraw(),ge(r)}),r.freehand.currentPoints=[],r.freehand.currentTimestamps=[]):d(V,ft)}),j(),a=Df(r,"Escape",ft=>{l.value==="polygon"&&r.polygon.isDrawing.value&&(r.polygon.currentPoints.value.length>=6?A():O())})}catch(H){console.warn(H)}}),Cn(()=>{console.log("disposing livecoded resources"),Cc(r),Ue(r),a?.(),a=void 0,r.keyboardDisposables.splice(0).forEach(H=>H()),r.stage?.destroy()}),(H,V)=>(Pt(),kt("div",cg,[at("div",hg,[Oo(at("select",{"onUpdate:modelValue":V[0]||(V[0]=Z=>Bt(l)?l.value=Z:null),disabled:dt(r).freehand.isAnimating.value,class:"tool-dropdown"},V[6]||(V[6]=[at("option",{value:"select"},"👆 Select",-1),at("option",{value:"freehand"},"✏️ Freehand",-1),at("option",{value:"polygon"},"⬟ Polygon",-1)]),8,dg),[[Su,dt(l)]]),V[12]||(V[12]=at("span",{class:"separator"},"|",-1)),at("div",ug,[at("button",{onClick:z,disabled:!nt.value||dt(r).freehand.isAnimating.value,title:"Undo (Ctrl/Cmd+Z)"}," ↶ Undo ",8,fg),at("button",{onClick:q,disabled:!it.value||dt(r).freehand.isAnimating.value,title:"Redo (Ctrl/Cmd+Shift+Z)"}," ↷ Redo ",8,gg)]),V[13]||(V[13]=at("span",{class:"separator"},"|",-1)),at("button",{onClick:V[1]||(V[1]=Z=>dt(r).grid.visible.value=!dt(r).grid.visible.value),class:we({active:dt(r).grid.visible.value}),disabled:dt(r).freehand.isAnimating.value},ie(dt(r).grid.visible.value?"⊞ Grid On":"⊡ Grid Off"),11,pg),V[14]||(V[14]=at("span",{class:"separator"},"|",-1)),at("div",mg,[at("button",{onClick:B,disabled:dt(r).freehand.isAnimating.value}," 💾 Download ",8,yg),at("button",{onClick:L,disabled:dt(r).freehand.isAnimating.value}," 📁 Upload ",8,_g)]),V[15]||(V[15]=at("span",{class:"separator"},"|",-1)),V[16]||(V[16]=at("span",{class:"flex-break","aria-hidden":"true"},null,-1)),dt(l)==="select"?(Pt(),kt(qt,{key:0},[at("div",vg,[at("button",{onClick:y,disabled:!x.value||dt(r).freehand.isAnimating.value}," Group ",8,bg),at("button",{onClick:b,disabled:!w.value||dt(r).freehand.isAnimating.value}," Ungroup ",8,Sg)]),V[7]||(V[7]=at("span",{class:"separator"},"|",-1)),at("div",xg,[at("button",{onClick:k,disabled:ur(dt(r))===0||dt(r).freehand.isAnimating.value}," 📄 Duplicate ",8,wg),at("button",{onClick:D,disabled:ur(dt(r))===0||dt(r).freehand.isAnimating.value}," 🗑️ Delete ",8,Cg)]),V[8]||(V[8]=at("span",{class:"separator"},"|",-1)),at("button",{onClick:V[2]||(V[2]=Z=>c.value=!dt(c)),class:we({active:dt(c)}),disabled:dt(r).freehand.isAnimating.value}," 📝 Metadata ",10,Pg),V[9]||(V[9]=at("span",{class:"separator"},"|",-1))],64)):Kt("",!0),dt(l)==="freehand"?(Pt(),kt(qt,{key:1},[n.showTimeline?(Pt(),kt("button",{key:0,onClick:V[3]||(V[3]=Z=>dt(r).freehand.useRealTiming.value=!dt(r).freehand.useRealTiming.value),class:we({active:dt(r).freehand.useRealTiming.value})},ie(dt(r).freehand.useRealTiming.value?"⏱️ Real Time":"⏱️ Max 0.3s"),3)):Kt("",!0)],64)):Kt("",!0),dt(l)==="polygon"?(Pt(),kt(qt,{key:2},[at("div",Tg,[at("button",{onClick:V[4]||(V[4]=Z=>dt(r).polygon.mode.value="draw"),class:we({active:dt(r).polygon.mode.value==="draw"}),disabled:dt(r).freehand.isAnimating.value}," ✏️ New Shape ",10,kg),at("button",{onClick:V[5]||(V[5]=Z=>dt(r).polygon.mode.value="edit"),class:we({active:dt(r).polygon.mode.value==="edit"}),disabled:dt(r).freehand.isAnimating.value}," ✏️ Edit Shape ",10,Ag)]),V[10]||(V[10]=at("span",{class:"separator"},"|",-1)),at("div",Rg,[at("button",{onClick:A,disabled:!dt(r).polygon.isDrawing.value||dt(r).freehand.isAnimating.value}," ✅ End Shape (esc) ",8,Eg),at("button",{onClick:O,disabled:!dt(r).polygon.isDrawing.value||dt(r).freehand.isAnimating.value}," 🗑️ Cancel Shape ",8,Mg)]),V[11]||(V[11]=at("span",{class:"separator"},"|",-1)),dt(r).polygon.isDrawing.value?(Pt(),kt("span",Fg,"Drawing: "+ie(dt(r).polygon.currentPoints.value.length/2)+" points",1)):Kt("",!0)],64)):Kt("",!0),V[17]||(V[17]=at("span",{class:"separator"},"|",-1)),at("span",Dg,ie(ur(dt(r)))+" selected",1)]),at("div",Ng,[at("div",{ref_key:"konvaContainer",ref:tt,class:"konva-container",style:Be({width:s.value.width+"px",height:s.value.height+"px"})},null,4),dt(c)?(Pt(),kt("div",Og,[n.showVisualizations?(Pt(),Qi(S0,{key:0,"canvas-state":dt(r)},null,8,["canvas-state"])):Kt("",!0),oe(d0,{"selected-nodes":dt(U),"single-node":J.value,"multi-selected":st.value,"group-selected":$.value,"collect-hierarchy-from-root":dt(o).collectHierarchyFromRoot,"update-metadata-highlight":dt(o).updateMetadataHighlight,"update-hover-highlight":dt(o).updateHoverHighlight,"on-apply-metadata":et},null,8,["selected-nodes","single-node","multi-selected","group-selected","collect-hierarchy-from-root","update-metadata-highlight","update-hover-highlight"])])):Kt("",!0),n.showTimeline?(Pt(),kt(qt,{key:1},[oe(zf,{strokes:dt(Jt)(dt(r)),selectedStrokes:dt(r).freehand.selectedStrokesForTimeline.value,useRealTiming:dt(r).freehand.useRealTiming.value,maxInterStrokeDelay:dt(mr),overrideDuration:dt(r).freehand.timelineDuration.value>0?dt(r).freehand.timelineDuration.value:void 0,lockWhileAnimating:Y,onTimeUpdate:I},null,8,["strokes","selectedStrokes","useRealTiming","maxInterStrokeDelay","overrideDuration"]),dt(r).freehand.isAnimating.value?(Pt(),kt("div",Gg," ⚠️ Timeline has modified elements - press Stop to unlock ")):Kt("",!0)],64)):Kt("",!0)])]))}}),[["styles",[".canvas-root[data-v-28d738e6]{display:flex;flex-direction:column;align-items:center;gap:20px;padding:20px}.control-panel[data-v-28d738e6]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:10px 15px;display:flex;flex-wrap:wrap;align-items:center;gap:10px;box-shadow:0 2px 10px #0000001a}.canvas-wrapper[data-v-28d738e6]{display:flex;flex-direction:column;align-items:center;gap:20px}.control-panel button[data-v-28d738e6]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 15px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-28d738e6]:hover:not(:disabled){background:#e0e0e0}.control-panel button.active[data-v-28d738e6]{background:#06f;color:#fff;border-color:#06f}.control-panel button[data-v-28d738e6]:disabled{opacity:.5;cursor:not-allowed}.button-group.vertical[data-v-28d738e6]{display:flex;flex-direction:column;gap:2px}.button-group.vertical button[data-v-28d738e6]{margin:0;padding:3px 10px;font-size:12px}.tool-dropdown[data-v-28d738e6]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 10px;font-size:14px;cursor:pointer;transition:all .2s}.tool-dropdown[data-v-28d738e6]:hover{background:#e0e0e0}.tool-dropdown[data-v-28d738e6]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-28d738e6]{color:#ccc}.flex-break[data-v-28d738e6]{display:none;flex-basis:100%;height:0}@media (max-width: 1100px){.control-panel .flex-break[data-v-28d738e6]{display:block}}.info[data-v-28d738e6]{color:#666;font-size:14px}.animation-lock-warning[data-v-28d738e6]{color:#e67e22;font-size:14px;font-weight:700;text-align:center;background:#fef5e7;border:1px solid #f39c12;border-radius:4px;padding:8px 15px;animation:pulse-28d738e6 2s infinite}@keyframes pulse-28d738e6{0%,to{opacity:1}50%{opacity:.6}}.konva-container[data-v-28d738e6]{background-color:#fff;border:1px solid black}.metadata-suite[data-v-28d738e6]{display:flex;flex-direction:column;gap:8px;max-width:600px}"]],["__scopeId","data-v-28d738e6"]]),jc="handwriting-canvas",Vs=yu(Ig);return customElements.get(jc)||customElements.define(jc,Vs),Pi.CanvasElement=Vs,Pi.default=Vs,Object.defineProperties(Pi,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),Pi}({});
