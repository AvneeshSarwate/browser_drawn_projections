var HandwritingCanvas=function(wi){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function br(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const kt={},Xe=[],pe=()=>{},Yc=()=>!1,Pi=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Sr=t=>t.startsWith("onUpdate:"),It=Object.assign,xr=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Xc=Object.prototype.hasOwnProperty,Pt=(t,e)=>Xc.call(t,e),gt=Array.isArray,Je=t=>fn(t)==="[object Map]",Ti=t=>fn(t)==="[object Set]",$s=t=>fn(t)==="[object Date]",pt=t=>typeof t=="function",Dt=t=>typeof t=="string",me=t=>typeof t=="symbol",Et=t=>t!==null&&typeof t=="object",js=t=>(Et(t)||pt(t))&&pt(t.then)&&pt(t.catch),qs=Object.prototype.toString,fn=t=>qs.call(t),Jc=t=>fn(t).slice(8,-1),ki=t=>fn(t)==="[object Object]",Cr=t=>Dt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,gn=br(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ai=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Qc=/-(\w)/g,he=Ai(t=>t.replace(Qc,(e,n)=>n?n.toUpperCase():"")),Zc=/\B([A-Z])/g,ne=Ai(t=>t.replace(Zc,"-$1").toLowerCase()),Ks=Ai(t=>t.charAt(0).toUpperCase()+t.slice(1)),wr=Ai(t=>t?`on${Ks(t)}`:""),Fe=(t,e)=>!Object.is(t,e),Ri=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Ys=(t,e,n,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:n})},Ei=t=>{const e=parseFloat(t);return isNaN(e)?t:e},Xs=t=>{const e=Dt(t)?Number(t):NaN;return isNaN(e)?t:e};let Js;const Qs=()=>Js||(Js=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ue(t){if(gt(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],s=Dt(i)?ih(i):Ue(i);if(s)for(const r in s)e[r]=s[r]}return e}else if(Dt(t)||Et(t))return t}const th=/;(?![^(]*\))/g,eh=/:([^]+)/,nh=/\/\*[^]*?\*\//g;function ih(t){const e={};return t.replace(nh,"").split(th).forEach(n=>{if(n){const i=n.split(eh);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function xe(t){let e="";if(Dt(t))e=t;else if(gt(t))for(let n=0;n<t.length;n++){const i=xe(t[n]);i&&(e+=i+" ")}else if(Et(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const rh=br("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Zs(t){return!!t||t===""}function sh(t,e){if(t.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<t.length;i++)n=Mi(t[i],e[i]);return n}function Mi(t,e){if(t===e)return!0;let n=$s(t),i=$s(e);if(n||i)return n&&i?t.getTime()===e.getTime():!1;if(n=me(t),i=me(e),n||i)return t===e;if(n=gt(t),i=gt(e),n||i)return n&&i?sh(t,e):!1;if(n=Et(t),i=Et(e),n||i){if(!n||!i)return!1;const s=Object.keys(t).length,r=Object.keys(e).length;if(s!==r)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Mi(t[o],e[o]))return!1}}return String(t)===String(e)}function oh(t,e){return t.findIndex(n=>Mi(n,e))}const to=t=>!!(t&&t.__v_isRef===!0),ie=t=>Dt(t)?t:t==null?"":gt(t)||Et(t)&&(t.toString===qs||!pt(t.toString))?to(t)?ie(t.value):JSON.stringify(t,eo,2):String(t),eo=(t,e)=>to(e)?eo(t,e.value):Je(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,s],r)=>(n[Pr(i,r)+" =>"]=s,n),{})}:Ti(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Pr(n))}:me(e)?Pr(e):Et(e)&&!gt(e)&&!ki(e)?String(e):e,Pr=(t,e="")=>{var n;return me(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Zt;class ah{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Zt,!e&&Zt&&(this.index=(Zt.scopes||(Zt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Zt;try{return Zt=this,e()}finally{Zt=n}}}on(){Zt=this}off(){Zt=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function lh(){return Zt}let Rt;const Tr=new WeakSet;class no{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Zt&&Zt.active&&Zt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Tr.has(this)&&(Tr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ro(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,co(this),so(this);const e=Rt,n=de;Rt=this,de=!0;try{return this.fn()}finally{oo(this),Rt=e,de=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Er(e);this.deps=this.depsTail=void 0,co(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Tr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Rr(this)&&this.run()}get dirty(){return Rr(this)}}let io=0,pn,mn;function ro(t,e=!1){if(t.flags|=8,e){t.next=mn,mn=t;return}t.next=pn,pn=t}function kr(){io++}function Ar(){if(--io>0)return;if(mn){let e=mn;for(mn=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;pn;){let e=pn;for(pn=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){t||(t=i)}e=n}}if(t)throw t}function so(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function oo(t){let e,n=t.depsTail,i=n;for(;i;){const s=i.prevDep;i.version===-1?(i===n&&(n=s),Er(i),ch(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}t.deps=e,t.depsTail=n}function Rr(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(ao(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function ao(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===yn))return;t.globalVersion=yn;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!Rr(t)){t.flags&=-3;return}const n=Rt,i=de;Rt=t,de=!0;try{so(t);const s=t.fn(t._value);(e.version===0||Fe(s,t._value))&&(t._value=s,e.version++)}catch(s){throw e.version++,s}finally{Rt=n,de=i,oo(t),t.flags&=-3}}function Er(t,e=!1){const{dep:n,prevSub:i,nextSub:s}=t;if(i&&(i.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=i,t.nextSub=void 0),n.subs===t&&(n.subs=i),!n.subs&&n.computed){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)Er(r,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function ch(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let de=!0;const lo=[];function Ce(){lo.push(de),de=!1}function we(){const t=lo.pop();de=t===void 0?!0:t}function co(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Rt;Rt=void 0;try{e()}finally{Rt=n}}}let yn=0;class hh{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Mr{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Rt||!de||Rt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Rt)n=this.activeLink=new hh(Rt,this),Rt.deps?(n.prevDep=Rt.depsTail,Rt.depsTail.nextDep=n,Rt.depsTail=n):Rt.deps=Rt.depsTail=n,ho(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=Rt.depsTail,n.nextDep=void 0,Rt.depsTail.nextDep=n,Rt.depsTail=n,Rt.deps===n&&(Rt.deps=i)}return n}trigger(e){this.version++,yn++,this.notify(e)}notify(e){kr();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Ar()}}}function ho(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)ho(i)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Fr=new WeakMap,Be=Symbol(""),Dr=Symbol(""),_n=Symbol("");function Vt(t,e,n){if(de&&Rt){let i=Fr.get(t);i||Fr.set(t,i=new Map);let s=i.get(n);s||(i.set(n,s=new Mr),s.map=i,s.key=n),s.track()}}function Pe(t,e,n,i,s,r){const o=Fr.get(t);if(!o){yn++;return}const a=l=>{l&&l.trigger()};if(kr(),e==="clear")o.forEach(a);else{const l=gt(t),c=l&&Cr(n);if(l&&n==="length"){const h=Number(i);o.forEach((p,f)=>{(f==="length"||f===_n||!me(f)&&f>=h)&&a(p)})}else switch(n!==void 0&&a(o.get(n)),c&&a(o.get(_n)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Be)),Je(t)&&a(o.get(Dr)));break;case"delete":l||(a(o.get(Be)),Je(t)&&a(o.get(Dr)));break;case"set":Je(t)&&a(o.get(Be));break}}Ar()}function Qe(t){const e=Ct(t);return e===t?e:(Vt(e,"iterate",_n),re(t)?e:e.map(zt))}function Fi(t){return Vt(t=Ct(t),"iterate",_n),t}const dh={__proto__:null,[Symbol.iterator](){return Nr(this,Symbol.iterator,zt)},concat(...t){return Qe(this).concat(...t.map(e=>gt(e)?Qe(e):e))},entries(){return Nr(this,"entries",t=>(t[1]=zt(t[1]),t))},every(t,e){return Te(this,"every",t,e,void 0,arguments)},filter(t,e){return Te(this,"filter",t,e,n=>n.map(zt),arguments)},find(t,e){return Te(this,"find",t,e,zt,arguments)},findIndex(t,e){return Te(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Te(this,"findLast",t,e,zt,arguments)},findLastIndex(t,e){return Te(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Te(this,"forEach",t,e,void 0,arguments)},includes(...t){return Or(this,"includes",t)},indexOf(...t){return Or(this,"indexOf",t)},join(t){return Qe(this).join(t)},lastIndexOf(...t){return Or(this,"lastIndexOf",t)},map(t,e){return Te(this,"map",t,e,void 0,arguments)},pop(){return vn(this,"pop")},push(...t){return vn(this,"push",t)},reduce(t,...e){return uo(this,"reduce",t,e)},reduceRight(t,...e){return uo(this,"reduceRight",t,e)},shift(){return vn(this,"shift")},some(t,e){return Te(this,"some",t,e,void 0,arguments)},splice(...t){return vn(this,"splice",t)},toReversed(){return Qe(this).toReversed()},toSorted(t){return Qe(this).toSorted(t)},toSpliced(...t){return Qe(this).toSpliced(...t)},unshift(...t){return vn(this,"unshift",t)},values(){return Nr(this,"values",zt)}};function Nr(t,e,n){const i=Fi(t),s=i[e]();return i!==t&&!re(t)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.value&&(r.value=n(r.value)),r}),s}const uh=Array.prototype;function Te(t,e,n,i,s,r){const o=Fi(t),a=o!==t&&!re(t),l=o[e];if(l!==uh[e]){const p=l.apply(t,r);return a?zt(p):p}let c=n;o!==t&&(a?c=function(p,f){return n.call(this,zt(p),f,t)}:n.length>2&&(c=function(p,f){return n.call(this,p,f,t)}));const h=l.call(o,c,i);return a&&s?s(h):h}function uo(t,e,n,i){const s=Fi(t);let r=n;return s!==t&&(re(t)?n.length>3&&(r=function(o,a,l){return n.call(this,o,a,l,t)}):r=function(o,a,l){return n.call(this,o,zt(a),l,t)}),s[e](r,...i)}function Or(t,e,n){const i=Ct(t);Vt(i,"iterate",_n);const s=i[e](...n);return(s===-1||s===!1)&&Ir(n[0])?(n[0]=Ct(n[0]),i[e](...n)):s}function vn(t,e,n=[]){Ce(),kr();const i=Ct(t)[e].apply(t,n);return Ar(),we(),i}const fh=br("__proto__,__v_isRef,__isVue"),fo=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(me));function gh(t){me(t)||(t=String(t));const e=Ct(this);return Vt(e,"has",t),e.hasOwnProperty(t)}class go{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,i){const s=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return r;if(n==="__v_raw")return i===(s?r?wo:Co:r?xo:So).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=gt(e);if(!s){let l;if(o&&(l=dh[n]))return l;if(n==="hasOwnProperty")return gh}const a=Reflect.get(e,n,Ut(e)?e:i);return(me(n)?fo.has(n):fh(n))||(s||Vt(e,"get",n),r)?a:Ut(a)?o&&Cr(n)?a:a.value:Et(a)?s?To(a):Gr(a):a}}class po extends go{constructor(e=!1){super(!1,e)}set(e,n,i,s){let r=e[n];if(!this._isShallow){const l=He(r);if(!re(i)&&!He(i)&&(r=Ct(r),i=Ct(i)),!gt(e)&&Ut(r)&&!Ut(i))return l?!1:(r.value=i,!0)}const o=gt(e)&&Cr(n)?Number(n)<e.length:Pt(e,n),a=Reflect.set(e,n,i,Ut(e)?e:s);return e===Ct(s)&&(o?Fe(i,r)&&Pe(e,"set",n,i):Pe(e,"add",n,i)),a}deleteProperty(e,n){const i=Pt(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&i&&Pe(e,"delete",n,void 0),s}has(e,n){const i=Reflect.has(e,n);return(!me(n)||!fo.has(n))&&Vt(e,"has",n),i}ownKeys(e){return Vt(e,"iterate",gt(e)?"length":Be),Reflect.ownKeys(e)}}class mo extends go{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const ph=new po,mh=new mo,yh=new po(!0),_h=new mo(!0),Lr=t=>t,Di=t=>Reflect.getPrototypeOf(t);function Ni(t,e,n=!1,i=!1){t=t.__v_raw;const s=Ct(t),r=Ct(e);n||(Fe(e,r)&&Vt(s,"get",e),Vt(s,"get",r));const{has:o}=Di(s),a=i?Lr:n?Ur:zt;if(o.call(s,e))return a(t.get(e));if(o.call(s,r))return a(t.get(r));t!==s&&t.get(e)}function Oi(t,e=!1){const n=this.__v_raw,i=Ct(n),s=Ct(t);return e||(Fe(t,s)&&Vt(i,"has",t),Vt(i,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function Li(t,e=!1){return t=t.__v_raw,!e&&Vt(Ct(t),"iterate",Be),Reflect.get(t,"size",t)}function yo(t,e=!1){!e&&!re(t)&&!He(t)&&(t=Ct(t));const n=Ct(this);return Di(n).has.call(n,t)||(n.add(t),Pe(n,"add",t,t)),this}function _o(t,e,n=!1){!n&&!re(e)&&!He(e)&&(e=Ct(e));const i=Ct(this),{has:s,get:r}=Di(i);let o=s.call(i,t);o||(t=Ct(t),o=s.call(i,t));const a=r.call(i,t);return i.set(t,e),o?Fe(e,a)&&Pe(i,"set",t,e):Pe(i,"add",t,e),this}function vo(t){const e=Ct(this),{has:n,get:i}=Di(e);let s=n.call(e,t);s||(t=Ct(t),s=n.call(e,t)),i&&i.call(e,t);const r=e.delete(t);return s&&Pe(e,"delete",t,void 0),r}function bo(){const t=Ct(this),e=t.size!==0,n=t.clear();return e&&Pe(t,"clear",void 0,void 0),n}function Gi(t,e){return function(i,s){const r=this,o=r.__v_raw,a=Ct(o),l=e?Lr:t?Ur:zt;return!t&&Vt(a,"iterate",Be),o.forEach((c,h)=>i.call(s,l(c),l(h),r))}}function Ii(t,e,n){return function(...i){const s=this.__v_raw,r=Ct(s),o=Je(r),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=s[t](...i),h=n?Lr:e?Ur:zt;return!e&&Vt(r,"iterate",l?Dr:Be),{next(){const{value:p,done:f}=c.next();return f?{value:p,done:f}:{value:a?[h(p[0]),h(p[1])]:h(p),done:f}},[Symbol.iterator](){return this}}}}function De(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function vh(){const t={get(r){return Ni(this,r)},get size(){return Li(this)},has:Oi,add:yo,set:_o,delete:vo,clear:bo,forEach:Gi(!1,!1)},e={get(r){return Ni(this,r,!1,!0)},get size(){return Li(this)},has:Oi,add(r){return yo.call(this,r,!0)},set(r,o){return _o.call(this,r,o,!0)},delete:vo,clear:bo,forEach:Gi(!1,!0)},n={get(r){return Ni(this,r,!0)},get size(){return Li(this,!0)},has(r){return Oi.call(this,r,!0)},add:De("add"),set:De("set"),delete:De("delete"),clear:De("clear"),forEach:Gi(!0,!1)},i={get(r){return Ni(this,r,!0,!0)},get size(){return Li(this,!0)},has(r){return Oi.call(this,r,!0)},add:De("add"),set:De("set"),delete:De("delete"),clear:De("clear"),forEach:Gi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=Ii(r,!1,!1),n[r]=Ii(r,!0,!1),e[r]=Ii(r,!1,!0),i[r]=Ii(r,!0,!0)}),[t,n,e,i]}const[bh,Sh,xh,Ch]=vh();function Ui(t,e){const n=e?t?Ch:xh:t?Sh:bh;return(i,s,r)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?i:Reflect.get(Pt(n,s)&&s in i?n:i,s,r)}const wh={get:Ui(!1,!1)},Ph={get:Ui(!1,!0)},Th={get:Ui(!0,!1)},kh={get:Ui(!0,!0)},So=new WeakMap,xo=new WeakMap,Co=new WeakMap,wo=new WeakMap;function Ah(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Rh(t){return t.__v_skip||!Object.isExtensible(t)?0:Ah(Jc(t))}function Gr(t){return He(t)?t:Bi(t,!1,ph,wh,So)}function Po(t){return Bi(t,!1,yh,Ph,xo)}function To(t){return Bi(t,!0,mh,Th,Co)}function Bg(t){return Bi(t,!0,_h,kh,wo)}function Bi(t,e,n,i,s){if(!Et(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=s.get(t);if(r)return r;const o=Rh(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return s.set(t,a),a}function Ze(t){return He(t)?Ze(t.__v_raw):!!(t&&t.__v_isReactive)}function He(t){return!!(t&&t.__v_isReadonly)}function re(t){return!!(t&&t.__v_isShallow)}function Ir(t){return t?!!t.__v_raw:!1}function Ct(t){const e=t&&t.__v_raw;return e?Ct(e):t}function Eh(t){return!Pt(t,"__v_skip")&&Object.isExtensible(t)&&Ys(t,"__v_skip",!0),t}const zt=t=>Et(t)?Gr(t):t,Ur=t=>Et(t)?To(t):t;function Ut(t){return t?t.__v_isRef===!0:!1}function At(t){return ko(t,!1)}function Mh(t){return ko(t,!0)}function ko(t,e){return Ut(t)?t:new Fh(t,e)}class Fh{constructor(e,n){this.dep=new Mr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:Ct(e),this._value=n?e:zt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,i=this.__v_isShallow||re(e)||He(e);e=i?e:Ct(e),Fe(e,n)&&(this._rawValue=e,this._value=i?e:zt(e),this.dep.trigger())}}function ht(t){return Ut(t)?t.value:t}const Dh={get:(t,e,n)=>e==="__v_raw"?t:ht(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const s=t[e];return Ut(s)&&!Ut(n)?(s.value=n,!0):Reflect.set(t,e,n,i)}};function Ao(t){return Ze(t)?t:new Proxy(t,Dh)}class Nh{constructor(e,n,i){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Mr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=yn-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Rt!==this)return ro(this,!0),!0}get value(){const e=this.dep.track();return ao(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Oh(t,e,n=!1){let i,s;return pt(t)?i=t:(i=t.get,s=t.set),new Nh(i,s,n)}const Hi={},Vi=new WeakMap;let Ve;function Lh(t,e=!1,n=Ve){if(n){let i=Vi.get(n);i||Vi.set(n,i=[]),i.push(t)}}function Gh(t,e,n=kt){const{immediate:i,deep:s,once:r,scheduler:o,augmentJob:a,call:l}=n,c=y=>s?y:re(y)||s===!1||s===0?ke(y,1):ke(y);let h,p,f,u,m=!1,_=!1;if(Ut(t)?(p=()=>t.value,m=re(t)):Ze(t)?(p=()=>c(t),m=!0):gt(t)?(_=!0,m=t.some(y=>Ze(y)||re(y)),p=()=>t.map(y=>{if(Ut(y))return y.value;if(Ze(y))return c(y);if(pt(y))return l?l(y,2):y()})):pt(t)?e?p=l?()=>l(t,2):t:p=()=>{if(f){Ce();try{f()}finally{we()}}const y=Ve;Ve=h;try{return l?l(t,3,[u]):t(u)}finally{Ve=y}}:p=pe,e&&s){const y=p,b=s===!0?1/0:s;p=()=>ke(y(),b)}const S=lh(),w=()=>{h.stop(),S&&xr(S.effects,h)};if(r&&e){const y=e;e=(...b)=>{y(...b),w()}}let g=_?new Array(t.length).fill(Hi):Hi;const d=y=>{if(!(!(h.flags&1)||!h.dirty&&!y))if(e){const b=h.run();if(s||m||(_?b.some((k,D)=>Fe(k,g[D])):Fe(b,g))){f&&f();const k=Ve;Ve=h;try{const D=[b,g===Hi?void 0:_&&g[0]===Hi?[]:g,u];l?l(e,3,D):e(...D),g=b}finally{Ve=k}}}else h.run()};return a&&a(d),h=new no(p),h.scheduler=o?()=>o(d,!1):d,u=y=>Lh(y,!1,h),f=h.onStop=()=>{const y=Vi.get(h);if(y){if(l)l(y,4);else for(const b of y)b();Vi.delete(h)}},e?i?d(!0):g=h.run():o?o(d.bind(null,!0),!0):h.run(),w.pause=h.pause.bind(h),w.resume=h.resume.bind(h),w.stop=w,w}function ke(t,e=1/0,n){if(e<=0||!Et(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,Ut(t))ke(t.value,e,n);else if(gt(t))for(let i=0;i<t.length;i++)ke(t[i],e,n);else if(Ti(t)||Je(t))t.forEach(i=>{ke(i,e,n)});else if(ki(t)){for(const i in t)ke(t[i],e,n);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&ke(t[i],e,n)}return t}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const bn=[];let Br=!1;function Hg(t,...e){if(Br)return;Br=!0,Ce();const n=bn.length?bn[bn.length-1].component:null,i=n&&n.appContext.config.warnHandler,s=Ih();if(i)tn(i,n,11,[t+e.map(r=>{var o,a;return(a=(o=r.toString)==null?void 0:o.call(r))!=null?a:JSON.stringify(r)}).join(""),n&&n.proxy,s.map(({vnode:r})=>`at <${Ca(n,r.type)}>`).join(`
`),s]);else{const r=[`[Vue warn]: ${t}`,...e];s.length&&r.push(`
`,...Uh(s)),console.warn(...r)}we(),Br=!1}function Ih(){let t=bn[bn.length-1];if(!t)return[];const e=[];for(;t;){const n=e[0];n&&n.vnode===t?n.recurseCount++:e.push({vnode:t,recurseCount:0});const i=t.component&&t.component.parent;t=i&&i.vnode}return e}function Uh(t){const e=[];return t.forEach((n,i)=>{e.push(...i===0?[]:[`
`],...Bh(n))}),e}function Bh({vnode:t,recurseCount:e}){const n=e>0?`... (${e} recursive calls)`:"",i=t.component?t.component.parent==null:!1,s=` at <${Ca(t.component,t.type,i)}`,r=">"+n;return t.props?[s,...Hh(t.props),r]:[s+r]}function Hh(t){const e=[],n=Object.keys(t);return n.slice(0,3).forEach(i=>{e.push(...Ro(i,t[i]))}),n.length>3&&e.push(" ..."),e}function Ro(t,e,n){return Dt(e)?(e=JSON.stringify(e),n?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?n?e:[`${t}=${e}`]:Ut(e)?(e=Ro(t,Ct(e.value),!0),n?e:[`${t}=Ref<`,e,">"]):pt(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=Ct(e),n?e:[`${t}=`,e])}function tn(t,e,n,i){try{return i?t(...i):t()}catch(s){zi(s,e,n)}}function ye(t,e,n,i){if(pt(t)){const s=tn(t,e,n,i);return s&&js(s)&&s.catch(r=>{zi(r,e,n)}),s}if(gt(t)){const s=[];for(let r=0;r<t.length;r++)s.push(ye(t[r],e,n,i));return s}}function zi(t,e,n,i=!0){const s=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||kt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let p=0;p<h.length;p++)if(h[p](t,l,c)===!1)return}a=a.parent}if(r){Ce(),tn(r,null,10,[t,l,c]),we();return}}Vh(t,n,s,i,o)}function Vh(t,e,n,i=!0,s=!1){if(s)throw t;console.error(t)}const Wt=[];let _e=-1;const en=[];let Ne=null,nn=0;const Eo=Promise.resolve();let Wi=null;function Hr(t){const e=Wi||Eo;return t?e.then(this?t.bind(this):t):e}function zh(t){let e=_e+1,n=Wt.length;for(;e<n;){const i=e+n>>>1,s=Wt[i],r=Sn(s);r<t||r===t&&s.flags&2?e=i+1:n=i}return e}function Vr(t){if(!(t.flags&1)){const e=Sn(t),n=Wt[Wt.length-1];!n||!(t.flags&2)&&e>=Sn(n)?Wt.push(t):Wt.splice(zh(e),0,t),t.flags|=1,Mo()}}function Mo(){Wi||(Wi=Eo.then(No))}function Wh(t){gt(t)?en.push(...t):Ne&&t.id===-1?Ne.splice(nn+1,0,t):t.flags&1||(en.push(t),t.flags|=1),Mo()}function Fo(t,e,n=_e+1){for(;n<Wt.length;n++){const i=Wt[n];if(i&&i.flags&2){if(t&&i.id!==t.uid)continue;Wt.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Do(t){if(en.length){const e=[...new Set(en)].sort((n,i)=>Sn(n)-Sn(i));if(en.length=0,Ne){Ne.push(...e);return}for(Ne=e,nn=0;nn<Ne.length;nn++){const n=Ne[nn];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Ne=null,nn=0}}const Sn=t=>t.id==null?t.flags&2?-1:1/0:t.id;function No(t){try{for(_e=0;_e<Wt.length;_e++){const e=Wt[_e];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),tn(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;_e<Wt.length;_e++){const e=Wt[_e];e&&(e.flags&=-2)}_e=-1,Wt.length=0,Do(),Wi=null,(Wt.length||en.length)&&No()}}let se=null,Oo=null;function $i(t){const e=se;return se=t,Oo=t&&t.type.__scopeId||null,e}function $h(t,e=se,n){if(!e||t._n)return t;const i=(...s)=>{i._d&&ga(-1);const r=$i(e);let o;try{o=t(...s)}finally{$i(r),i._d&&ga(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Lo(t,e){if(se===null)return t;const n=er(se),i=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[r,o,a,l=kt]=e[s];r&&(pt(r)&&(r={mounted:r,updated:r}),r.deep&&ke(o),i.push({dir:r,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function ze(t,e,n,i){const s=t.dirs,r=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];r&&(a.oldValue=r[o].value);let l=a.dir[i];l&&(Ce(),ye(l,n,8,[t.el,a,t,e]),we())}}const jh=Symbol("_vte"),qh=t=>t.__isTeleport;function zr(t,e){t.shapeFlag&6&&t.component?(t.transition=e,zr(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function rn(t,e){return pt(t)?It({name:t.name},e,{setup:t}):t}function Go(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Wr(t,e,n,i,s=!1){if(gt(t)){t.forEach((m,_)=>Wr(m,e&&(gt(e)?e[_]:e),n,i,s));return}if(xn(i)&&!s)return;const r=i.shapeFlag&4?er(i.component):i.el,o=s?null:r,{i:a,r:l}=t,c=e&&e.r,h=a.refs===kt?a.refs={}:a.refs,p=a.setupState,f=Ct(p),u=p===kt?()=>!1:m=>Pt(f,m);if(c!=null&&c!==l&&(Dt(c)?(h[c]=null,u(c)&&(p[c]=null)):Ut(c)&&(c.value=null)),pt(l))tn(l,a,12,[o,h]);else{const m=Dt(l),_=Ut(l);if(m||_){const S=()=>{if(t.f){const w=m?u(l)?p[l]:h[l]:l.value;s?gt(w)&&xr(w,r):gt(w)?w.includes(r)||w.push(r):m?(h[l]=[r],u(l)&&(p[l]=h[l])):(l.value=[r],t.k&&(h[t.k]=l.value))}else m?(h[l]=o,u(l)&&(p[l]=o)):_&&(l.value=o,t.k&&(h[t.k]=o))};o?(S.id=-1,te(S,n)):S()}}}const xn=t=>!!t.type.__asyncLoader,Io=t=>t.type.__isKeepAlive;function Kh(t,e){Uo(t,"a",e)}function Yh(t,e){Uo(t,"da",e)}function Uo(t,e,n=Kt){const i=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(ji(e,i,n),n){let s=n.parent;for(;s&&s.parent;)Io(s.parent.vnode)&&Xh(i,e,n,s),s=s.parent}}function Xh(t,e,n,i){const s=ji(e,t,i,!0);Cn(()=>{xr(i[e],s)},n)}function ji(t,e,n=Kt,i=!1){if(n){const s=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{Ce();const a=Rn(n),l=ye(e,n,t,o);return a(),we(),l});return i?s.unshift(r):s.push(r),r}}const Ae=t=>(e,n=Kt)=>{(!tr||t==="sp")&&ji(t,(...i)=>e(...i),n)},Jh=Ae("bm"),Bo=Ae("m"),Qh=Ae("bu"),Zh=Ae("u"),td=Ae("bum"),Cn=Ae("um"),ed=Ae("sp"),nd=Ae("rtg"),id=Ae("rtc");function rd(t,e=Kt){ji("ec",t,e)}const sd=Symbol.for("v-ndc");function Ho(t,e,n,i){let s;const r=n,o=gt(t);if(o||Dt(t)){const a=o&&Ze(t);let l=!1;a&&(l=!re(t),t=Fi(t)),s=new Array(t.length);for(let c=0,h=t.length;c<h;c++)s[c]=e(l?zt(t[c]):t[c],c,void 0,r)}else if(typeof t=="number"){s=new Array(t);for(let a=0;a<t;a++)s[a]=e(a+1,a,void 0,r)}else if(Et(t))if(t[Symbol.iterator])s=Array.from(t,(a,l)=>e(a,l,void 0,r));else{const a=Object.keys(t);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];s[l]=e(t[h],h,l,r)}}else s=[];return s}const $r=t=>t?ba(t)?er(t):$r(t.parent):null,wn=It(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>$r(t.parent),$root:t=>$r(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>$o(t),$forceUpdate:t=>t.f||(t.f=()=>{Vr(t.update)}),$nextTick:t=>t.n||(t.n=Hr.bind(t.proxy)),$watch:t=>kd.bind(t)}),jr=(t,e)=>t!==kt&&!t.__isScriptSetup&&Pt(t,e),od={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:i,data:s,props:r,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const u=o[e];if(u!==void 0)switch(u){case 1:return i[e];case 2:return s[e];case 4:return n[e];case 3:return r[e]}else{if(jr(i,e))return o[e]=1,i[e];if(s!==kt&&Pt(s,e))return o[e]=2,s[e];if((c=t.propsOptions[0])&&Pt(c,e))return o[e]=3,r[e];if(n!==kt&&Pt(n,e))return o[e]=4,n[e];qr&&(o[e]=0)}}const h=wn[e];let p,f;if(h)return e==="$attrs"&&Vt(t.attrs,"get",""),h(t);if((p=a.__cssModules)&&(p=p[e]))return p;if(n!==kt&&Pt(n,e))return o[e]=4,n[e];if(f=l.config.globalProperties,Pt(f,e))return f[e]},set({_:t},e,n){const{data:i,setupState:s,ctx:r}=t;return jr(s,e)?(s[e]=n,!0):i!==kt&&Pt(i,e)?(i[e]=n,!0):Pt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:s,propsOptions:r}},o){let a;return!!n[o]||t!==kt&&Pt(t,o)||jr(e,o)||(a=r[0])&&Pt(a,o)||Pt(i,o)||Pt(wn,o)||Pt(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Pt(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Vo(t){return gt(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let qr=!0;function ad(t){const e=$o(t),n=t.proxy,i=t.ctx;qr=!1,e.beforeCreate&&zo(e.beforeCreate,t,"bc");const{data:s,computed:r,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:p,mounted:f,beforeUpdate:u,updated:m,activated:_,deactivated:S,beforeDestroy:w,beforeUnmount:g,destroyed:d,unmounted:y,render:b,renderTracked:k,renderTriggered:D,errorCaptured:x,serverPrefetch:C,expose:T,inheritAttrs:M,components:L,directives:I,filters:H}=e;if(c&&ld(c,i,null),o)for(const v in o){const P=o[v];pt(P)&&(i[v]=P.bind(n))}if(s){const v=s.call(n,n);Et(v)&&(t.data=Gr(v))}if(qr=!0,r)for(const v in r){const P=r[v],E=pt(P)?P.bind(n,n):pt(P.get)?P.get.bind(n,n):pe,A=!pt(P)&&pt(P.set)?P.set.bind(n):pe,O=Lt({get:E,set:A});Object.defineProperty(i,v,{enumerable:!0,configurable:!0,get:()=>O.value,set:j=>O.value=j})}if(a)for(const v in a)Wo(a[v],i,n,v);if(l){const v=pt(l)?l.call(n):l;Reflect.ownKeys(v).forEach(P=>{gd(P,v[P])})}h&&zo(h,t,"c");function X(v,P){gt(P)?P.forEach(E=>v(E.bind(n))):P&&v(P.bind(n))}if(X(Jh,p),X(Bo,f),X(Qh,u),X(Zh,m),X(Kh,_),X(Yh,S),X(rd,x),X(id,k),X(nd,D),X(td,g),X(Cn,y),X(ed,C),gt(T))if(T.length){const v=t.exposed||(t.exposed={});T.forEach(P=>{Object.defineProperty(v,P,{get:()=>n[P],set:E=>n[P]=E})})}else t.exposed||(t.exposed={});b&&t.render===pe&&(t.render=b),M!=null&&(t.inheritAttrs=M),L&&(t.components=L),I&&(t.directives=I),C&&Go(t)}function ld(t,e,n=pe){gt(t)&&(t=Kr(t));for(const i in t){const s=t[i];let r;Et(s)?"default"in s?r=Ki(s.from||i,s.default,!0):r=Ki(s.from||i):r=Ki(s),Ut(r)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[i]=r}}function zo(t,e,n){ye(gt(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function Wo(t,e,n,i){let s=i.includes(".")?ca(n,i):()=>n[i];if(Dt(t)){const r=e[t];pt(r)&&Gt(s,r)}else if(pt(t))Gt(s,t.bind(n));else if(Et(t))if(gt(t))t.forEach(r=>Wo(r,e,n,i));else{const r=pt(t.handler)?t.handler.bind(n):e[t.handler];pt(r)&&Gt(s,r,t)}}function $o(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,a=r.get(e);let l;return a?l=a:!s.length&&!n&&!i?l=e:(l={},s.length&&s.forEach(c=>qi(l,c,o,!0)),qi(l,e,o)),Et(e)&&r.set(e,l),l}function qi(t,e,n,i=!1){const{mixins:s,extends:r}=e;r&&qi(t,r,n,!0),s&&s.forEach(o=>qi(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=cd[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const cd={data:jo,props:qo,emits:qo,methods:Pn,computed:Pn,beforeCreate:$t,created:$t,beforeMount:$t,mounted:$t,beforeUpdate:$t,updated:$t,beforeDestroy:$t,beforeUnmount:$t,destroyed:$t,unmounted:$t,activated:$t,deactivated:$t,errorCaptured:$t,serverPrefetch:$t,components:Pn,directives:Pn,watch:dd,provide:jo,inject:hd};function jo(t,e){return e?t?function(){return It(pt(t)?t.call(this,this):t,pt(e)?e.call(this,this):e)}:e:t}function hd(t,e){return Pn(Kr(t),Kr(e))}function Kr(t){if(gt(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function $t(t,e){return t?[...new Set([].concat(t,e))]:e}function Pn(t,e){return t?It(Object.create(null),t,e):e}function qo(t,e){return t?gt(t)&&gt(e)?[...new Set([...t,...e])]:It(Object.create(null),Vo(t),Vo(e??{})):e}function dd(t,e){if(!t)return e;if(!e)return t;const n=It(Object.create(null),t);for(const i in e)n[i]=$t(t[i],e[i]);return n}function Ko(){return{app:null,config:{isNativeTag:Yc,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ud=0;function fd(t,e){return function(i,s=null){pt(i)||(i=It({},i)),s!=null&&!Et(s)&&(s=null);const r=Ko(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:ud++,_component:i,_props:s,_container:null,_context:r,_instance:null,version:Xd,get config(){return r.config},set config(h){},use(h,...p){return o.has(h)||(h&&pt(h.install)?(o.add(h),h.install(c,...p)):pt(h)&&(o.add(h),h(c,...p))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,p){return p?(r.components[h]=p,c):r.components[h]},directive(h,p){return p?(r.directives[h]=p,c):r.directives[h]},mount(h,p,f){if(!l){const u=c._ceVNode||oe(i,s);return u.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),t(u,h,f),l=!0,c._container=h,h.__vue_app__=c,er(u.component)}},onUnmount(h){a.push(h)},unmount(){l&&(ye(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(h,p){return r.provides[h]=p,c},runWithContext(h){const p=sn;sn=c;try{return h()}finally{sn=p}}};return c}}let sn=null;function gd(t,e){if(Kt){let n=Kt.provides;const i=Kt.parent&&Kt.parent.provides;i===n&&(n=Kt.provides=Object.create(i)),n[t]=e}}function Ki(t,e,n=!1){const i=Kt||se;if(i||sn){const s=sn?sn._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return n&&pt(e)?e.call(i&&i.proxy):e}}const Yo={},Xo=()=>Object.create(Yo),Jo=t=>Object.getPrototypeOf(t)===Yo;function pd(t,e,n,i=!1){const s={},r=Xo();t.propsDefaults=Object.create(null),Qo(t,e,s,r);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=i?s:Po(s):t.type.props?t.props=s:t.props=r,t.attrs=r}function md(t,e,n,i){const{props:s,attrs:r,vnode:{patchFlag:o}}=t,a=Ct(s),[l]=t.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let p=0;p<h.length;p++){let f=h[p];if(Yi(t.emitsOptions,f))continue;const u=e[f];if(l)if(Pt(r,f))u!==r[f]&&(r[f]=u,c=!0);else{const m=he(f);s[m]=Yr(l,a,m,u,t,!1)}else u!==r[f]&&(r[f]=u,c=!0)}}}else{Qo(t,e,s,r)&&(c=!0);let h;for(const p in a)(!e||!Pt(e,p)&&((h=ne(p))===p||!Pt(e,h)))&&(l?n&&(n[p]!==void 0||n[h]!==void 0)&&(s[p]=Yr(l,a,p,void 0,t,!0)):delete s[p]);if(r!==a)for(const p in r)(!e||!Pt(e,p))&&(delete r[p],c=!0)}c&&Pe(t.attrs,"set","")}function Qo(t,e,n,i){const[s,r]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(gn(l))continue;const c=e[l];let h;s&&Pt(s,h=he(l))?!r||!r.includes(h)?n[h]=c:(a||(a={}))[h]=c:Yi(t.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(r){const l=Ct(n),c=a||kt;for(let h=0;h<r.length;h++){const p=r[h];n[p]=Yr(s,l,p,c[p],t,!Pt(c,p))}}return o}function Yr(t,e,n,i,s,r){const o=t[n];if(o!=null){const a=Pt(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&pt(l)){const{propsDefaults:c}=s;if(n in c)i=c[n];else{const h=Rn(s);i=c[n]=l.call(null,e),h()}}else i=l;s.ce&&s.ce._setProp(n,i)}o[0]&&(r&&!a?i=!1:o[1]&&(i===""||i===ne(n))&&(i=!0))}return i}const yd=new WeakMap;function Zo(t,e,n=!1){const i=n?yd:e.propsCache,s=i.get(t);if(s)return s;const r=t.props,o={},a=[];let l=!1;if(!pt(t)){const h=p=>{l=!0;const[f,u]=Zo(p,e,!0);It(o,f),u&&a.push(...u)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!r&&!l)return Et(t)&&i.set(t,Xe),Xe;if(gt(r))for(let h=0;h<r.length;h++){const p=he(r[h]);ta(p)&&(o[p]=kt)}else if(r)for(const h in r){const p=he(h);if(ta(p)){const f=r[h],u=o[p]=gt(f)||pt(f)?{type:f}:It({},f),m=u.type;let _=!1,S=!0;if(gt(m))for(let w=0;w<m.length;++w){const g=m[w],d=pt(g)&&g.name;if(d==="Boolean"){_=!0;break}else d==="String"&&(S=!1)}else _=pt(m)&&m.name==="Boolean";u[0]=_,u[1]=S,(_||Pt(u,"default"))&&a.push(p)}}const c=[o,a];return Et(t)&&i.set(t,c),c}function ta(t){return t[0]!=="$"&&!gn(t)}const ea=t=>t[0]==="_"||t==="$stable",Xr=t=>gt(t)?t.map(ve):[ve(t)],_d=(t,e,n)=>{if(e._n)return e;const i=$h((...s)=>Xr(e(...s)),n);return i._c=!1,i},na=(t,e,n)=>{const i=t._ctx;for(const s in t){if(ea(s))continue;const r=t[s];if(pt(r))e[s]=_d(s,r,i);else if(r!=null){const o=Xr(r);e[s]=()=>o}}},ia=(t,e)=>{const n=Xr(e);t.slots.default=()=>n},ra=(t,e,n)=>{for(const i in e)(n||i!=="_")&&(t[i]=e[i])},vd=(t,e,n)=>{const i=t.slots=Xo();if(t.vnode.shapeFlag&32){const s=e._;s?(ra(i,e,n),n&&Ys(i,"_",s,!0)):na(e,i)}else e&&ia(t,e)},bd=(t,e,n)=>{const{vnode:i,slots:s}=t;let r=!0,o=kt;if(i.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:ra(s,e,n):(r=!e.$stable,na(e,s)),o=e}else e&&(ia(t,e),o={default:1});if(r)for(const a in s)!ea(a)&&o[a]==null&&delete s[a]},te=Nd;function Sd(t){return xd(t)}function xd(t,e){const n=Qs();n.__VUE__=!0;const{insert:i,remove:s,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:p,nextSibling:f,setScopeId:u=pe,insertStaticContent:m}=t,_=(R,N,z,q=null,Y=null,K=null,Z=void 0,rt=null,et=!!N.dynamicChildren)=>{if(R===N)return;R&&!An(R,N)&&(q=F(R),j(R,Y,K,!0),R=null),N.patchFlag===-2&&(et=!1,N.dynamicChildren=null);const{type:U,ref:V,shapeFlag:Q}=N;switch(U){case Xi:S(R,N,z,q);break;case $e:w(R,N,z,q);break;case Qr:R==null&&g(N,z,q,Z);break;case jt:L(R,N,z,q,Y,K,Z,rt,et);break;default:Q&1?b(R,N,z,q,Y,K,Z,rt,et):Q&6?I(R,N,z,q,Y,K,Z,rt,et):(Q&64||Q&128)&&U.process(R,N,z,q,Y,K,Z,rt,et,it)}V!=null&&Y&&Wr(V,R&&R.ref,K,N||R,!N)},S=(R,N,z,q)=>{if(R==null)i(N.el=a(N.children),z,q);else{const Y=N.el=R.el;N.children!==R.children&&c(Y,N.children)}},w=(R,N,z,q)=>{R==null?i(N.el=l(N.children||""),z,q):N.el=R.el},g=(R,N,z,q)=>{[R.el,R.anchor]=m(R.children,N,z,q,R.el,R.anchor)},d=({el:R,anchor:N},z,q)=>{let Y;for(;R&&R!==N;)Y=f(R),i(R,z,q),R=Y;i(N,z,q)},y=({el:R,anchor:N})=>{let z;for(;R&&R!==N;)z=f(R),s(R),R=z;s(N)},b=(R,N,z,q,Y,K,Z,rt,et)=>{N.type==="svg"?Z="svg":N.type==="math"&&(Z="mathml"),R==null?k(N,z,q,Y,K,Z,rt,et):C(R,N,Y,K,Z,rt,et)},k=(R,N,z,q,Y,K,Z,rt)=>{let et,U;const{props:V,shapeFlag:Q,transition:ot,dirs:lt}=R;if(et=R.el=o(R.type,K,V&&V.is,V),Q&8?h(et,R.children):Q&16&&x(R.children,et,null,q,Y,Jr(R,K),Z,rt),lt&&ze(R,null,q,"created"),D(et,R,R.scopeId,Z,q),V){for(const yt in V)yt!=="value"&&!gn(yt)&&r(et,yt,null,V[yt],K,q);"value"in V&&r(et,"value",null,V.value,K),(U=V.onVnodeBeforeMount)&&be(U,q,R)}lt&&ze(R,null,q,"beforeMount");const dt=Cd(Y,ot);dt&&ot.beforeEnter(et),i(et,N,z),((U=V&&V.onVnodeMounted)||dt||lt)&&te(()=>{U&&be(U,q,R),dt&&ot.enter(et),lt&&ze(R,null,q,"mounted")},Y)},D=(R,N,z,q,Y)=>{if(z&&u(R,z),q)for(let K=0;K<q.length;K++)u(R,q[K]);if(Y){let K=Y.subTree;if(N===K||fa(K.type)&&(K.ssContent===N||K.ssFallback===N)){const Z=Y.vnode;D(R,Z,Z.scopeId,Z.slotScopeIds,Y.parent)}}},x=(R,N,z,q,Y,K,Z,rt,et=0)=>{for(let U=et;U<R.length;U++){const V=R[U]=rt?Oe(R[U]):ve(R[U]);_(null,V,N,z,q,Y,K,Z,rt)}},C=(R,N,z,q,Y,K,Z)=>{const rt=N.el=R.el;let{patchFlag:et,dynamicChildren:U,dirs:V}=N;et|=R.patchFlag&16;const Q=R.props||kt,ot=N.props||kt;let lt;if(z&&We(z,!1),(lt=ot.onVnodeBeforeUpdate)&&be(lt,z,N,R),V&&ze(N,R,z,"beforeUpdate"),z&&We(z,!0),(Q.innerHTML&&ot.innerHTML==null||Q.textContent&&ot.textContent==null)&&h(rt,""),U?T(R.dynamicChildren,U,rt,z,q,Jr(N,Y),K):Z||P(R,N,rt,null,z,q,Jr(N,Y),K,!1),et>0){if(et&16)M(rt,Q,ot,z,Y);else if(et&2&&Q.class!==ot.class&&r(rt,"class",null,ot.class,Y),et&4&&r(rt,"style",Q.style,ot.style,Y),et&8){const dt=N.dynamicProps;for(let yt=0;yt<dt.length;yt++){const ft=dt[yt],ut=Q[ft],mt=ot[ft];(mt!==ut||ft==="value")&&r(rt,ft,ut,mt,Y,z)}}et&1&&R.children!==N.children&&h(rt,N.children)}else!Z&&U==null&&M(rt,Q,ot,z,Y);((lt=ot.onVnodeUpdated)||V)&&te(()=>{lt&&be(lt,z,N,R),V&&ze(N,R,z,"updated")},q)},T=(R,N,z,q,Y,K,Z)=>{for(let rt=0;rt<N.length;rt++){const et=R[rt],U=N[rt],V=et.el&&(et.type===jt||!An(et,U)||et.shapeFlag&70)?p(et.el):z;_(et,U,V,null,q,Y,K,Z,!0)}},M=(R,N,z,q,Y)=>{if(N!==z){if(N!==kt)for(const K in N)!gn(K)&&!(K in z)&&r(R,K,N[K],null,Y,q);for(const K in z){if(gn(K))continue;const Z=z[K],rt=N[K];Z!==rt&&K!=="value"&&r(R,K,rt,Z,Y,q)}"value"in z&&r(R,"value",N.value,z.value,Y)}},L=(R,N,z,q,Y,K,Z,rt,et)=>{const U=N.el=R?R.el:a(""),V=N.anchor=R?R.anchor:a("");let{patchFlag:Q,dynamicChildren:ot,slotScopeIds:lt}=N;lt&&(rt=rt?rt.concat(lt):lt),R==null?(i(U,z,q),i(V,z,q),x(N.children||[],z,V,Y,K,Z,rt,et)):Q>0&&Q&64&&ot&&R.dynamicChildren?(T(R.dynamicChildren,ot,z,Y,K,Z,rt),(N.key!=null||Y&&N===Y.subTree)&&sa(R,N,!0)):P(R,N,z,V,Y,K,Z,rt,et)},I=(R,N,z,q,Y,K,Z,rt,et)=>{N.slotScopeIds=rt,R==null?N.shapeFlag&512?Y.ctx.activate(N,z,q,Z,et):H(N,z,q,Y,K,Z,et):G(R,N,et)},H=(R,N,z,q,Y,K,Z)=>{const rt=R.component=Hd(R,q,Y);if(Io(R)&&(rt.ctx.renderer=it),Vd(rt,!1,Z),rt.asyncDep){if(Y&&Y.registerDep(rt,X,Z),!R.el){const et=rt.subTree=oe($e);w(null,et,N,z)}}else X(rt,R,N,z,Y,K,Z)},G=(R,N,z)=>{const q=N.component=R.component;if(Fd(R,N,z))if(q.asyncDep&&!q.asyncResolved){v(q,N,z);return}else q.next=N,q.update();else N.el=R.el,q.vnode=N},X=(R,N,z,q,Y,K,Z)=>{const rt=()=>{if(R.isMounted){let{next:Q,bu:ot,u:lt,parent:dt,vnode:yt}=R;{const St=oa(R);if(St){Q&&(Q.el=yt.el,v(R,Q,Z)),St.asyncDep.then(()=>{R.isUnmounted||rt()});return}}let ft=Q,ut;We(R,!1),Q?(Q.el=yt.el,v(R,Q,Z)):Q=yt,ot&&Ri(ot),(ut=Q.props&&Q.props.onVnodeBeforeUpdate)&&be(ut,dt,Q,yt),We(R,!0);const mt=da(R),_t=R.subTree;R.subTree=mt,_(_t,mt,p(_t.el),F(_t),R,Y,K),Q.el=mt.el,ft===null&&Dd(R,mt.el),lt&&te(lt,Y),(ut=Q.props&&Q.props.onVnodeUpdated)&&te(()=>be(ut,dt,Q,yt),Y)}else{let Q;const{el:ot,props:lt}=N,{bm:dt,m:yt,parent:ft,root:ut,type:mt}=R,_t=xn(N);We(R,!1),dt&&Ri(dt),!_t&&(Q=lt&&lt.onVnodeBeforeMount)&&be(Q,ft,N),We(R,!0);{ut.ce&&ut.ce._injectChildStyle(mt);const St=R.subTree=da(R);_(null,St,z,q,R,Y,K),N.el=St.el}if(yt&&te(yt,Y),!_t&&(Q=lt&&lt.onVnodeMounted)){const St=N;te(()=>be(Q,ft,St),Y)}(N.shapeFlag&256||ft&&xn(ft.vnode)&&ft.vnode.shapeFlag&256)&&R.a&&te(R.a,Y),R.isMounted=!0,N=z=q=null}};R.scope.on();const et=R.effect=new no(rt);R.scope.off();const U=R.update=et.run.bind(et),V=R.job=et.runIfDirty.bind(et);V.i=R,V.id=R.uid,et.scheduler=()=>Vr(V),We(R,!0),U()},v=(R,N,z)=>{N.component=R;const q=R.vnode.props;R.vnode=N,R.next=null,md(R,N.props,q,z),bd(R,N.children,z),Ce(),Fo(R),we()},P=(R,N,z,q,Y,K,Z,rt,et=!1)=>{const U=R&&R.children,V=R?R.shapeFlag:0,Q=N.children,{patchFlag:ot,shapeFlag:lt}=N;if(ot>0){if(ot&128){A(U,Q,z,q,Y,K,Z,rt,et);return}else if(ot&256){E(U,Q,z,q,Y,K,Z,rt,et);return}}lt&8?(V&16&&$(U,Y,K),Q!==U&&h(z,Q)):V&16?lt&16?A(U,Q,z,q,Y,K,Z,rt,et):$(U,Y,K,!0):(V&8&&h(z,""),lt&16&&x(Q,z,q,Y,K,Z,rt,et))},E=(R,N,z,q,Y,K,Z,rt,et)=>{R=R||Xe,N=N||Xe;const U=R.length,V=N.length,Q=Math.min(U,V);let ot;for(ot=0;ot<Q;ot++){const lt=N[ot]=et?Oe(N[ot]):ve(N[ot]);_(R[ot],lt,z,null,Y,K,Z,rt,et)}U>V?$(R,Y,K,!0,!1,Q):x(N,z,q,Y,K,Z,rt,et,Q)},A=(R,N,z,q,Y,K,Z,rt,et)=>{let U=0;const V=N.length;let Q=R.length-1,ot=V-1;for(;U<=Q&&U<=ot;){const lt=R[U],dt=N[U]=et?Oe(N[U]):ve(N[U]);if(An(lt,dt))_(lt,dt,z,null,Y,K,Z,rt,et);else break;U++}for(;U<=Q&&U<=ot;){const lt=R[Q],dt=N[ot]=et?Oe(N[ot]):ve(N[ot]);if(An(lt,dt))_(lt,dt,z,null,Y,K,Z,rt,et);else break;Q--,ot--}if(U>Q){if(U<=ot){const lt=ot+1,dt=lt<V?N[lt].el:q;for(;U<=ot;)_(null,N[U]=et?Oe(N[U]):ve(N[U]),z,dt,Y,K,Z,rt,et),U++}}else if(U>ot)for(;U<=Q;)j(R[U],Y,K,!0),U++;else{const lt=U,dt=U,yt=new Map;for(U=dt;U<=ot;U++){const Ft=N[U]=et?Oe(N[U]):ve(N[U]);Ft.key!=null&&yt.set(Ft.key,U)}let ft,ut=0;const mt=ot-dt+1;let _t=!1,St=0;const Mt=new Array(mt);for(U=0;U<mt;U++)Mt[U]=0;for(U=lt;U<=Q;U++){const Ft=R[U];if(ut>=mt){j(Ft,Y,K,!0);continue}let Jt;if(Ft.key!=null)Jt=yt.get(Ft.key);else for(ft=dt;ft<=ot;ft++)if(Mt[ft-dt]===0&&An(Ft,N[ft])){Jt=ft;break}Jt===void 0?j(Ft,Y,K,!0):(Mt[Jt-dt]=U+1,Jt>=St?St=Jt:_t=!0,_(Ft,N[Jt],z,null,Y,K,Z,rt,et),ut++)}const Ht=_t?wd(Mt):Xe;for(ft=Ht.length-1,U=mt-1;U>=0;U--){const Ft=dt+U,Jt=N[Ft],Ci=Ft+1<V?N[Ft+1].el:q;Mt[U]===0?_(null,Jt,z,Ci,Y,K,Z,rt,et):_t&&(ft<0||U!==Ht[ft]?O(Jt,z,Ci,2):ft--)}}},O=(R,N,z,q,Y=null)=>{const{el:K,type:Z,transition:rt,children:et,shapeFlag:U}=R;if(U&6){O(R.component.subTree,N,z,q);return}if(U&128){R.suspense.move(N,z,q);return}if(U&64){Z.move(R,N,z,it);return}if(Z===jt){i(K,N,z);for(let Q=0;Q<et.length;Q++)O(et[Q],N,z,q);i(R.anchor,N,z);return}if(Z===Qr){d(R,N,z);return}if(q!==2&&U&1&&rt)if(q===0)rt.beforeEnter(K),i(K,N,z),te(()=>rt.enter(K),Y);else{const{leave:Q,delayLeave:ot,afterLeave:lt}=rt,dt=()=>i(K,N,z),yt=()=>{Q(K,()=>{dt(),lt&&lt()})};ot?ot(K,dt,yt):yt()}else i(K,N,z)},j=(R,N,z,q=!1,Y=!1)=>{const{type:K,props:Z,ref:rt,children:et,dynamicChildren:U,shapeFlag:V,patchFlag:Q,dirs:ot,cacheIndex:lt}=R;if(Q===-2&&(Y=!1),rt!=null&&Wr(rt,null,z,R,!0),lt!=null&&(N.renderCache[lt]=void 0),V&256){N.ctx.deactivate(R);return}const dt=V&1&&ot,yt=!xn(R);let ft;if(yt&&(ft=Z&&Z.onVnodeBeforeUnmount)&&be(ft,N,R),V&6)st(R.component,z,q);else{if(V&128){R.suspense.unmount(z,q);return}dt&&ze(R,null,N,"beforeUnmount"),V&64?R.type.remove(R,N,z,it,q):U&&!U.hasOnce&&(K!==jt||Q>0&&Q&64)?$(U,N,z,!1,!0):(K===jt&&Q&384||!Y&&V&16)&&$(et,N,z),q&&B(R)}(yt&&(ft=Z&&Z.onVnodeUnmounted)||dt)&&te(()=>{ft&&be(ft,N,R),dt&&ze(R,null,N,"unmounted")},z)},B=R=>{const{type:N,el:z,anchor:q,transition:Y}=R;if(N===jt){J(z,q);return}if(N===Qr){y(R);return}const K=()=>{s(z),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(R.shapeFlag&1&&Y&&!Y.persisted){const{leave:Z,delayLeave:rt}=Y,et=()=>Z(z,K);rt?rt(R.el,K,et):et()}else K()},J=(R,N)=>{let z;for(;R!==N;)z=f(R),s(R),R=z;s(N)},st=(R,N,z)=>{const{bum:q,scope:Y,job:K,subTree:Z,um:rt,m:et,a:U}=R;aa(et),aa(U),q&&Ri(q),Y.stop(),K&&(K.flags|=8,j(Z,R,N,z)),rt&&te(rt,N),te(()=>{R.isUnmounted=!0},N),N&&N.pendingBranch&&!N.isUnmounted&&R.asyncDep&&!R.asyncResolved&&R.suspenseId===N.pendingId&&(N.deps--,N.deps===0&&N.resolve())},$=(R,N,z,q=!1,Y=!1,K=0)=>{for(let Z=K;Z<R.length;Z++)j(R[Z],N,z,q,Y)},F=R=>{if(R.shapeFlag&6)return F(R.component.subTree);if(R.shapeFlag&128)return R.suspense.next();const N=f(R.anchor||R.el),z=N&&N[jh];return z?f(z):N};let W=!1;const nt=(R,N,z)=>{R==null?N._vnode&&j(N._vnode,null,null,!0):_(N._vnode||null,R,N,null,null,null,z),N._vnode=R,W||(W=!0,Fo(),Do(),W=!1)},it={p:_,um:j,m:O,r:B,mt:H,mc:x,pc:P,pbc:T,n:F,o:t};return{render:nt,hydrate:void 0,createApp:fd(nt)}}function Jr({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function We({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Cd(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function sa(t,e,n=!1){const i=t.children,s=e.children;if(gt(i)&&gt(s))for(let r=0;r<i.length;r++){const o=i[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=Oe(s[r]),a.el=o.el),!n&&a.patchFlag!==-2&&sa(o,a)),a.type===Xi&&(a.el=o.el)}}function wd(t){const e=t.slice(),n=[0];let i,s,r,o,a;const l=t.length;for(i=0;i<l;i++){const c=t[i];if(c!==0){if(s=n[n.length-1],t[s]<c){e[i]=s,n.push(i);continue}for(r=0,o=n.length-1;r<o;)a=r+o>>1,t[n[a]]<c?r=a+1:o=a;c<t[n[r]]&&(r>0&&(e[i]=n[r-1]),n[r]=i)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}function oa(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:oa(e)}function aa(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Pd=Symbol.for("v-scx"),Td=()=>Ki(Pd);function Gt(t,e,n){return la(t,e,n)}function la(t,e,n=kt){const{immediate:i,deep:s,flush:r,once:o}=n,a=It({},n);let l;if(tr)if(r==="sync"){const f=Td();l=f.__watcherHandles||(f.__watcherHandles=[])}else if(!e||i)a.once=!0;else{const f=()=>{};return f.stop=pe,f.resume=pe,f.pause=pe,f}const c=Kt;a.call=(f,u,m)=>ye(f,c,u,m);let h=!1;r==="post"?a.scheduler=f=>{te(f,c&&c.suspense)}:r!=="sync"&&(h=!0,a.scheduler=(f,u)=>{u?f():Vr(f)}),a.augmentJob=f=>{e&&(f.flags|=4),h&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const p=Gh(t,e,a);return l&&l.push(p),p}function kd(t,e,n){const i=this.proxy,s=Dt(t)?t.includes(".")?ca(i,t):()=>i[t]:t.bind(i,i);let r;pt(e)?r=e:(r=e.handler,n=e);const o=Rn(this),a=la(s,r.bind(i),n);return o(),a}function ca(t,e){const n=e.split(".");return()=>{let i=t;for(let s=0;s<n.length&&i;s++)i=i[n[s]];return i}}const Ad=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${he(e)}Modifiers`]||t[`${ne(e)}Modifiers`];function Rd(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||kt;let s=n;const r=e.startsWith("update:"),o=r&&Ad(i,e.slice(7));o&&(o.trim&&(s=n.map(h=>Dt(h)?h.trim():h)),o.number&&(s=n.map(Ei)));let a,l=i[a=wr(e)]||i[a=wr(he(e))];!l&&r&&(l=i[a=wr(ne(e))]),l&&ye(l,t,6,s);const c=i[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,ye(c,t,6,s)}}function ha(t,e,n=!1){const i=e.emitsCache,s=i.get(t);if(s!==void 0)return s;const r=t.emits;let o={},a=!1;if(!pt(t)){const l=c=>{const h=ha(c,e,!0);h&&(a=!0,It(o,h))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(Et(t)&&i.set(t,null),null):(gt(r)?r.forEach(l=>o[l]=null):It(o,r),Et(t)&&i.set(t,o),o)}function Yi(t,e){return!t||!Pi(e)?!1:(e=e.slice(2).replace(/Once$/,""),Pt(t,e[0].toLowerCase()+e.slice(1))||Pt(t,ne(e))||Pt(t,e))}function Vg(){}function da(t){const{type:e,vnode:n,proxy:i,withProxy:s,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:p,data:f,setupState:u,ctx:m,inheritAttrs:_}=t,S=$i(t);let w,g;try{if(n.shapeFlag&4){const y=s||i,b=y;w=ve(c.call(b,y,h,p,u,f,m)),g=a}else{const y=e;w=ve(y.length>1?y(p,{attrs:a,slots:o,emit:l}):y(p,null)),g=e.props?a:Ed(a)}}catch(y){Tn.length=0,zi(y,t,1),w=oe($e)}let d=w;if(g&&_!==!1){const y=Object.keys(g),{shapeFlag:b}=d;y.length&&b&7&&(r&&y.some(Sr)&&(g=Md(g,r)),d=on(d,g,!1,!0))}return n.dirs&&(d=on(d,null,!1,!0),d.dirs=d.dirs?d.dirs.concat(n.dirs):n.dirs),n.transition&&zr(d,n.transition),w=d,$i(S),w}const Ed=t=>{let e;for(const n in t)(n==="class"||n==="style"||Pi(n))&&((e||(e={}))[n]=t[n]);return e},Md=(t,e)=>{const n={};for(const i in t)(!Sr(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function Fd(t,e,n){const{props:i,children:s,component:r}=t,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?ua(i,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let p=0;p<h.length;p++){const f=h[p];if(o[f]!==i[f]&&!Yi(c,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?ua(i,o,c):!0:!!o;return!1}function ua(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let s=0;s<i.length;s++){const r=i[s];if(e[r]!==t[r]&&!Yi(n,r))return!0}return!1}function Dd({vnode:t,parent:e},n){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=n,e=e.parent;else break}}const fa=t=>t.__isSuspense;function Nd(t,e){e&&e.pendingBranch?gt(t)?e.effects.push(...t):e.effects.push(t):Wh(t)}const jt=Symbol.for("v-fgt"),Xi=Symbol.for("v-txt"),$e=Symbol.for("v-cmt"),Qr=Symbol.for("v-stc"),Tn=[];let ee=null;function wt(t=!1){Tn.push(ee=t?null:[])}function Od(){Tn.pop(),ee=Tn[Tn.length-1]||null}let kn=1;function ga(t){kn+=t,t<0&&ee&&(ee.hasOnce=!0)}function pa(t){return t.dynamicChildren=kn>0?ee||Xe:null,Od(),kn>0&&ee&&ee.push(t),t}function Tt(t,e,n,i,s,r){return pa(at(t,e,n,i,s,r,!0))}function Ji(t,e,n,i,s){return pa(oe(t,e,n,i,s,!0))}function ma(t){return t?t.__v_isVNode===!0:!1}function An(t,e){return t.type===e.type&&t.key===e.key}const ya=({key:t})=>t??null,Qi=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Dt(t)||Ut(t)||pt(t)?{i:se,r:t,k:e,f:!!n}:t:null);function at(t,e=null,n=null,i=0,s=null,r=t===jt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&ya(e),ref:e&&Qi(e),scopeId:Oo,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:se};return a?(Zr(l,n),r&128&&t.normalize(l)):n&&(l.shapeFlag|=Dt(n)?8:16),kn>0&&!o&&ee&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&ee.push(l),l}const oe=Ld;function Ld(t,e=null,n=null,i=0,s=null,r=!1){if((!t||t===sd)&&(t=$e),ma(t)){const a=on(t,e,!0);return n&&Zr(a,n),kn>0&&!r&&ee&&(a.shapeFlag&6?ee[ee.indexOf(t)]=a:ee.push(a)),a.patchFlag=-2,a}if(Yd(t)&&(t=t.__vccOpts),e){e=Gd(e);let{class:a,style:l}=e;a&&!Dt(a)&&(e.class=xe(a)),Et(l)&&(Ir(l)&&!gt(l)&&(l=It({},l)),e.style=Ue(l))}const o=Dt(t)?1:fa(t)?128:qh(t)?64:Et(t)?4:pt(t)?2:0;return at(t,e,n,i,s,o,r,!0)}function Gd(t){return t?Ir(t)||Jo(t)?It({},t):t:null}function on(t,e,n=!1,i=!1){const{props:s,ref:r,patchFlag:o,children:a,transition:l}=t,c=e?Id(s||{},e):s,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&ya(c),ref:e&&e.ref?n&&r?gt(r)?r.concat(Qi(e)):[r,Qi(e)]:Qi(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==jt?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&on(t.ssContent),ssFallback:t.ssFallback&&on(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&i&&zr(h,l.clone(h)),h}function _a(t=" ",e=0){return oe(Xi,null,t,e)}function qt(t="",e=!1){return e?(wt(),Ji($e,null,t)):oe($e,null,t)}function ve(t){return t==null||typeof t=="boolean"?oe($e):gt(t)?oe(jt,null,t.slice()):ma(t)?Oe(t):oe(Xi,null,String(t))}function Oe(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:on(t)}function Zr(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(gt(e))n=16;else if(typeof e=="object")if(i&65){const s=e.default;s&&(s._c&&(s._d=!1),Zr(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!Jo(e)?e._ctx=se:s===3&&se&&(se.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else pt(e)?(e={default:e,_ctx:se},n=32):(e=String(e),i&64?(n=16,e=[_a(e)]):n=8);t.children=e,t.shapeFlag|=n}function Id(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const s in i)if(s==="class")e.class!==i.class&&(e.class=xe([e.class,i.class]));else if(s==="style")e.style=Ue([e.style,i.style]);else if(Pi(s)){const r=e[s],o=i[s];o&&r!==o&&!(gt(r)&&r.includes(o))&&(e[s]=r?[].concat(r,o):o)}else s!==""&&(e[s]=i[s])}return e}function be(t,e,n,i=null){ye(t,e,7,[n,i])}const Ud=Ko();let Bd=0;function Hd(t,e,n){const i=t.type,s=(e?e.appContext:t.appContext)||Ud,r={uid:Bd++,vnode:t,type:i,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ah(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Zo(i,s),emitsOptions:ha(i,s),emit:null,emitted:null,propsDefaults:kt,inheritAttrs:i.inheritAttrs,ctx:kt,data:kt,props:kt,attrs:kt,slots:kt,refs:kt,setupState:kt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=Rd.bind(null,r),t.ce&&t.ce(r),r}let Kt=null,Zi,ts;{const t=Qs(),e=(n,i)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(i),r=>{s.length>1?s.forEach(o=>o(r)):s[0](r)}};Zi=e("__VUE_INSTANCE_SETTERS__",n=>Kt=n),ts=e("__VUE_SSR_SETTERS__",n=>tr=n)}const Rn=t=>{const e=Kt;return Zi(t),t.scope.on(),()=>{t.scope.off(),Zi(e)}},va=()=>{Kt&&Kt.scope.off(),Zi(null)};function ba(t){return t.vnode.shapeFlag&4}let tr=!1;function Vd(t,e=!1,n=!1){e&&ts(e);const{props:i,children:s}=t.vnode,r=ba(t);pd(t,i,r,e),vd(t,s,n);const o=r?zd(t,e):void 0;return e&&ts(!1),o}function zd(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,od);const{setup:i}=n;if(i){const s=t.setupContext=i.length>1?$d(t):null,r=Rn(t);Ce();const o=tn(i,t,0,[t.props,s]);if(we(),r(),js(o)){if(xn(t)||Go(t),o.then(va,va),e)return o.then(a=>{Sa(t,a)}).catch(a=>{zi(a,t,0)});t.asyncDep=o}else Sa(t,o)}else xa(t)}function Sa(t,e,n){pt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Et(e)&&(t.setupState=Ao(e)),xa(t)}function xa(t,e,n){const i=t.type;t.render||(t.render=i.render||pe);{const s=Rn(t);Ce();try{ad(t)}finally{we(),s()}}}const Wd={get(t,e){return Vt(t,"get",""),t[e]}};function $d(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Wd),slots:t.slots,emit:t.emit,expose:e}}function er(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Ao(Eh(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in wn)return wn[n](t)},has(e,n){return n in e||n in wn}})):t.proxy}const jd=/(?:^|[-_])(\w)/g,qd=t=>t.replace(jd,e=>e.toUpperCase()).replace(/[-_]/g,"");function Kd(t,e=!0){return pt(t)?t.displayName||t.name:t.name||e&&t.__name}function Ca(t,e,n=!1){let i=Kd(e);if(!i&&e.__file){const s=e.__file.match(/([^/\\]+)\.\w+$/);s&&(i=s[1])}if(!i&&t&&t.parent){const s=r=>{for(const o in r)if(r[o]===e)return o};i=s(t.components||t.parent.type.components)||s(t.appContext.components)}return i?qd(i):n?"App":"Anonymous"}function Yd(t){return pt(t)&&"__vccOpts"in t}const Lt=(t,e)=>Oh(t,e,tr),Xd="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let es;const wa=typeof window<"u"&&window.trustedTypes;if(wa)try{es=wa.createPolicy("vue",{createHTML:t=>t})}catch{}const Pa=es?t=>es.createHTML(t):t=>t,Jd="http://www.w3.org/2000/svg",Qd="http://www.w3.org/1998/Math/MathML",Re=typeof document<"u"?document:null,Ta=Re&&Re.createElement("template"),Zd={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const s=e==="svg"?Re.createElementNS(Jd,t):e==="mathml"?Re.createElementNS(Qd,t):n?Re.createElement(t,{is:n}):Re.createElement(t);return t==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:t=>Re.createTextNode(t),createComment:t=>Re.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Re.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,s,r){const o=n?n.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===r||!(s=s.nextSibling)););else{Ta.innerHTML=Pa(i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t);const a=Ta.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},tu=Symbol("_vtc");function eu(t,e,n){const i=t[tu];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const ka=Symbol("_vod"),nu=Symbol("_vsh"),iu=Symbol(""),ru=/(^|;)\s*display\s*:/;function su(t,e,n){const i=t.style,s=Dt(n);let r=!1;if(n&&!s){if(e)if(Dt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&nr(i,a,"")}else for(const o in e)n[o]==null&&nr(i,o,"");for(const o in n)o==="display"&&(r=!0),nr(i,o,n[o])}else if(s){if(e!==n){const o=i[iu];o&&(n+=";"+o),i.cssText=n,r=ru.test(n)}}else e&&t.removeAttribute("style");ka in t&&(t[ka]=r?i.display:"",t[nu]&&(i.display="none"))}const Aa=/\s*!important$/;function nr(t,e,n){if(gt(n))n.forEach(i=>nr(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=ou(t,e);Aa.test(n)?t.setProperty(ne(i),n.replace(Aa,""),"important"):t[i]=n}}const Ra=["Webkit","Moz","ms"],ns={};function ou(t,e){const n=ns[e];if(n)return n;let i=he(e);if(i!=="filter"&&i in t)return ns[e]=i;i=Ks(i);for(let s=0;s<Ra.length;s++){const r=Ra[s]+i;if(r in t)return ns[e]=r}return e}const Ea="http://www.w3.org/1999/xlink";function Ma(t,e,n,i,s,r=rh(e)){i&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Ea,e.slice(6,e.length)):t.setAttributeNS(Ea,e,n):n==null||r&&!Zs(n)?t.removeAttribute(e):t.setAttribute(e,r?"":me(n)?String(n):n)}function Fa(t,e,n,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Pa(n):n);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,a=n==null?t.type==="checkbox"?"on":"":String(n);(o!==a||!("_value"in t))&&(t.value=a),n==null&&t.removeAttribute(e),t._value=n;return}let r=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=Zs(n):n==null&&o==="string"?(n="",r=!0):o==="number"&&(n=0,r=!0)}try{t[e]=n}catch{}r&&t.removeAttribute(e)}function je(t,e,n,i){t.addEventListener(e,n,i)}function au(t,e,n,i){t.removeEventListener(e,n,i)}const Da=Symbol("_vei");function lu(t,e,n,i,s=null){const r=t[Da]||(t[Da]={}),o=r[e];if(i&&o)o.value=i;else{const[a,l]=cu(e);if(i){const c=r[e]=uu(i,s);je(t,a,c,l)}else o&&(au(t,a,o,l),r[e]=void 0)}}const Na=/(?:Once|Passive|Capture)$/;function cu(t){let e;if(Na.test(t)){e={};let i;for(;i=t.match(Na);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ne(t.slice(2)),e]}let is=0;const hu=Promise.resolve(),du=()=>is||(hu.then(()=>is=0),is=Date.now());function uu(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;ye(fu(i,n.value),e,5,[i])};return n.value=t,n.attached=du(),n}function fu(t,e){if(gt(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>s=>!s._stopped&&i&&i(s))}else return e}const Oa=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,gu=(t,e,n,i,s,r)=>{const o=s==="svg";e==="class"?eu(t,i,o):e==="style"?su(t,n,i):Pi(e)?Sr(e)||lu(t,e,n,i,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):pu(t,e,i,o))?(Fa(t,e,i),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ma(t,e,i,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Dt(i))?Fa(t,he(e),i):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),Ma(t,e,i,o))};function pu(t,e,n,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&Oa(e)&&pt(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Oa(e)&&Dt(n)?!1:e in t}const La={};/*! #__NO_SIDE_EFFECTS__ */function mu(t,e,n){const i=rn(t,e);ki(i)&&It(i,e);class s extends rs{constructor(o){super(i,o,n)}}return s.def=i,s}const yu=typeof HTMLElement<"u"?HTMLElement:class{};class rs extends yu{constructor(e,n={},i=Ha){super(),this._def=e,this._props=n,this._createApp=i,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&i!==Ha?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof rs){this._parent=e;break}this._instance||(this._resolved?(this._setParent(),this._update()):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._instance.provides=e._instance.provides)}disconnectedCallback(){this._connected=!1,Hr(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const s of i)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(i,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:r,styles:o}=i;let a;if(r&&!gt(r))for(const l in r){const c=r[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=Xs(this._props[l])),(a||(a=Object.create(null)))[he(l)]=!0)}this._numberProps=a,s&&this._resolveProps(i),this.shadowRoot&&this._applyStyles(o),this._mount(i)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(i=>e(this._def=i,!0)):e(this._def)}_mount(e){this._app=this._createApp(e),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const i in n)Pt(this,i)||Object.defineProperty(this,i,{get:()=>ht(n[i])})}_resolveProps(e){const{props:n}=e,i=gt(n)?n:Object.keys(n||{});for(const s of Object.keys(this))s[0]!=="_"&&i.includes(s)&&this._setProp(s,this[s]);for(const s of i.map(he))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(r){this._setProp(s,r,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const n=this.hasAttribute(e);let i=n?this.getAttribute(e):La;const s=he(e);n&&this._numberProps&&this._numberProps[s]&&(i=Xs(i)),this._setProp(s,i,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,n,i=!0,s=!1){n!==this._props[e]&&(n===La?delete this._props[e]:(this._props[e]=n,e==="key"&&this._app&&(this._app._ceVNode.key=n)),s&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(ne(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(ne(e),n+""):n||this.removeAttribute(ne(e))))}_update(){Pu(this._createVNode(),this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const n=oe(this._def,It(e,this._props));return this._instance||(n.ce=i=>{this._instance=i,i.ce=this,i.isCE=!0;const s=(r,o)=>{this.dispatchEvent(new CustomEvent(r,ki(o[0])?It({detail:o},o[0]):{detail:o}))};i.emit=(r,...o)=>{s(r,o),ne(r)!==r&&s(ne(r),o)},this._setParent()}),n}_applyStyles(e,n){if(!e)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const i=this._nonce;for(let s=e.length-1;s>=0;s--){const r=document.createElement("style");i&&r.setAttribute("nonce",i),r.textContent=e[s],this.shadowRoot.prepend(r)}}_parseSlots(){const e=this._slots={};let n;for(;n=this.firstChild;){const i=n.nodeType===1&&n.getAttribute("slot")||"default";(e[i]||(e[i]=[])).push(n),this.removeChild(n)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let i=0;i<e.length;i++){const s=e[i],r=s.getAttribute("name")||"default",o=this._slots[r],a=s.parentNode;if(o)for(const l of o){if(n&&l.nodeType===1){const c=n+"-s",h=document.createTreeWalker(l,1);l.setAttribute(c,"");let p;for(;p=h.nextNode();)p.setAttribute(c,"")}a.insertBefore(l,s)}else for(;s.firstChild;)a.insertBefore(s.firstChild,s);a.removeChild(s)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}const ir=t=>{const e=t.props["onUpdate:modelValue"]||!1;return gt(e)?n=>Ri(e,n):e};function _u(t){t.target.composing=!0}function Ga(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const an=Symbol("_assign"),vu={created(t,{modifiers:{lazy:e,trim:n,number:i}},s){t[an]=ir(s);const r=i||s.props&&s.props.type==="number";je(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),r&&(a=Ei(a)),t[an](a)}),n&&je(t,"change",()=>{t.value=t.value.trim()}),e||(je(t,"compositionstart",_u),je(t,"compositionend",Ga),je(t,"change",Ga))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:i,trim:s,number:r}},o){if(t[an]=ir(o),t.composing)return;const a=(r||t.type==="number")&&!/^0\d/.test(t.value)?Ei(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(i&&e===n||s&&t.value.trim()===l)||(t.value=l))}},bu={deep:!0,created(t,{value:e,modifiers:{number:n}},i){const s=Ti(e);je(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Ei(rr(o)):rr(o));t[an](t.multiple?s?new Set(r):r:r[0]),t._assigning=!0,Hr(()=>{t._assigning=!1})}),t[an]=ir(i)},mounted(t,{value:e}){Ia(t,e)},beforeUpdate(t,e,n){t[an]=ir(n)},updated(t,{value:e}){t._assigning||Ia(t,e)}};function Ia(t,e){const n=t.multiple,i=gt(e);if(!(n&&!i&&!Ti(e))){for(let s=0,r=t.options.length;s<r;s++){const o=t.options[s],a=rr(o);if(n)if(i){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=oh(e,a)>-1}else o.selected=e.has(a);else if(Mi(rr(o),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function rr(t){return"_value"in t?t._value:t.value}const Su=["ctrl","shift","alt","meta"],xu={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Su.some(n=>t[`${n}Key`]&&!e.includes(n))},Cu=(t,e)=>{const n=t._withMods||(t._withMods={}),i=e.join(".");return n[i]||(n[i]=(s,...r)=>{for(let o=0;o<e.length;o++){const a=xu[e[o]];if(a&&a(s,e))return}return t(s,...r)})},wu=It({patchProp:gu},Zd);let Ua;function Ba(){return Ua||(Ua=Sd(wu))}const Pu=(...t)=>{Ba().render(...t)},Ha=(...t)=>{const e=Ba().createApp(...t),{mount:n}=e;return e.mount=i=>{const s=ku(i);if(!s)return;const r=e._component;!pt(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=n(s,!1,Tu(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function Tu(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function ku(t){return Dt(t)?document.querySelector(t):t}var Va=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Au(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var sr={exports:{}},En={},ss={},os={},za;function vt(){return za||(za=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Va<"u"?Va:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.21",isBrowser:n(),isUnminified:/param/.test(function(s){}.toString()),dblClickWindow:400,getAngle(s){return t.Konva.angleDeg?s*e:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var s;return(s=t.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(s){t.glob.Konva=s}};const i=s=>{t.Konva[s.prototype.getClassName()]=s};t._registerNode=i,t.Konva._injectGlobal(t.Konva)}(os)),os}var as={},Wa;function Nt(){return Wa||(Wa=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=vt();class n{constructor(y=[1,0,0,1,0,0]){this.dirty=!1,this.m=y&&y.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(y){y.m[0]=this.m[0],y.m[1]=this.m[1],y.m[2]=this.m[2],y.m[3]=this.m[3],y.m[4]=this.m[4],y.m[5]=this.m[5]}point(y){const b=this.m;return{x:b[0]*y.x+b[2]*y.y+b[4],y:b[1]*y.x+b[3]*y.y+b[5]}}translate(y,b){return this.m[4]+=this.m[0]*y+this.m[2]*b,this.m[5]+=this.m[1]*y+this.m[3]*b,this}scale(y,b){return this.m[0]*=y,this.m[1]*=y,this.m[2]*=b,this.m[3]*=b,this}rotate(y){const b=Math.cos(y),k=Math.sin(y),D=this.m[0]*b+this.m[2]*k,x=this.m[1]*b+this.m[3]*k,C=this.m[0]*-k+this.m[2]*b,T=this.m[1]*-k+this.m[3]*b;return this.m[0]=D,this.m[1]=x,this.m[2]=C,this.m[3]=T,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(y,b){const k=this.m[0]+this.m[2]*b,D=this.m[1]+this.m[3]*b,x=this.m[2]+this.m[0]*y,C=this.m[3]+this.m[1]*y;return this.m[0]=k,this.m[1]=D,this.m[2]=x,this.m[3]=C,this}multiply(y){const b=this.m[0]*y.m[0]+this.m[2]*y.m[1],k=this.m[1]*y.m[0]+this.m[3]*y.m[1],D=this.m[0]*y.m[2]+this.m[2]*y.m[3],x=this.m[1]*y.m[2]+this.m[3]*y.m[3],C=this.m[0]*y.m[4]+this.m[2]*y.m[5]+this.m[4],T=this.m[1]*y.m[4]+this.m[3]*y.m[5]+this.m[5];return this.m[0]=b,this.m[1]=k,this.m[2]=D,this.m[3]=x,this.m[4]=C,this.m[5]=T,this}invert(){const y=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),b=this.m[3]*y,k=-this.m[1]*y,D=-this.m[2]*y,x=this.m[0]*y,C=y*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),T=y*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=b,this.m[1]=k,this.m[2]=D,this.m[3]=x,this.m[4]=C,this.m[5]=T,this}getMatrix(){return this.m}decompose(){const y=this.m[0],b=this.m[1],k=this.m[2],D=this.m[3],x=this.m[4],C=this.m[5],T=y*D-b*k,M={x,y:C,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(y!=0||b!=0){const L=Math.sqrt(y*y+b*b);M.rotation=b>0?Math.acos(y/L):-Math.acos(y/L),M.scaleX=L,M.scaleY=T/L,M.skewX=(y*k+b*D)/T,M.skewY=0}else if(k!=0||D!=0){const L=Math.sqrt(k*k+D*D);M.rotation=Math.PI/2-(D>0?Math.acos(-k/L):-Math.acos(k/L)),M.scaleX=T/L,M.scaleY=L,M.skewX=0,M.skewY=(y*k+b*D)/T}return M.rotation=t.Util._getRotation(M.rotation),M}}t.Transform=n;const i="[object Array]",s="[object Number]",r="[object String]",o="[object Boolean]",a=Math.PI/180,l=180/Math.PI,c="#",h="",p="0",f="Konva warning: ",u="Konva error: ",m="rgb(",_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let w=[];const g=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(d){setTimeout(d,60)};t.Util={_isElement(d){return!!(d&&d.nodeType==1)},_isFunction(d){return!!(d&&d.constructor&&d.call&&d.apply)},_isPlainObject(d){return!!d&&d.constructor===Object},_isArray(d){return Object.prototype.toString.call(d)===i},_isNumber(d){return Object.prototype.toString.call(d)===s&&!isNaN(d)&&isFinite(d)},_isString(d){return Object.prototype.toString.call(d)===r},_isBoolean(d){return Object.prototype.toString.call(d)===o},isObject(d){return d instanceof Object},isValidSelector(d){if(typeof d!="string")return!1;const y=d[0];return y==="#"||y==="."||y===y.toUpperCase()},_sign(d){return d===0||d>0?1:-1},requestAnimFrame(d){w.push(d),w.length===1&&g(function(){const y=w;w=[],y.forEach(function(b){b()})})},createCanvasElement(){const d=document.createElement("canvas");try{d.style=d.style||{}}catch{}return d},createImageElement(){return document.createElement("img")},_isInDocument(d){for(;d=d.parentNode;)if(d==document)return!0;return!1},_urlToImage(d,y){const b=t.Util.createImageElement();b.onload=function(){y(b)},b.src=d},_rgbToHex(d,y,b){return(16777216+(d<<16)+(y<<8)+b).toString(16).slice(1)},_hexToRgb(d){d=d.replace(c,h);const y=parseInt(d,16);return{r:y>>16&255,g:y>>8&255,b:y&255}},getRandomColor(){let d=(Math.random()*16777215<<0).toString(16);for(;d.length<6;)d=p+d;return c+d},getRGB(d){let y;return d in _?(y=_[d],{r:y[0],g:y[1],b:y[2]}):d[0]===c?this._hexToRgb(d.substring(1)):d.substr(0,4)===m?(y=S.exec(d.replace(/ /g,"")),{r:parseInt(y[1],10),g:parseInt(y[2],10),b:parseInt(y[3],10)}):{r:0,g:0,b:0}},colorToRGBA(d){return d=d||"black",t.Util._namedColorToRBA(d)||t.Util._hex3ColorToRGBA(d)||t.Util._hex4ColorToRGBA(d)||t.Util._hex6ColorToRGBA(d)||t.Util._hex8ColorToRGBA(d)||t.Util._rgbColorToRGBA(d)||t.Util._rgbaColorToRGBA(d)||t.Util._hslColorToRGBA(d)},_namedColorToRBA(d){const y=_[d.toLowerCase()];return y?{r:y[0],g:y[1],b:y[2],a:1}:null},_rgbColorToRGBA(d){if(d.indexOf("rgb(")===0){d=d.match(/rgb\(([^)]+)\)/)[1];const y=d.split(/ *, */).map(Number);return{r:y[0],g:y[1],b:y[2],a:1}}},_rgbaColorToRGBA(d){if(d.indexOf("rgba(")===0){d=d.match(/rgba\(([^)]+)\)/)[1];const y=d.split(/ *, */).map((b,k)=>b.slice(-1)==="%"?k===3?parseInt(b)/100:parseInt(b)/100*255:Number(b));return{r:y[0],g:y[1],b:y[2],a:y[3]}}},_hex8ColorToRGBA(d){if(d[0]==="#"&&d.length===9)return{r:parseInt(d.slice(1,3),16),g:parseInt(d.slice(3,5),16),b:parseInt(d.slice(5,7),16),a:parseInt(d.slice(7,9),16)/255}},_hex6ColorToRGBA(d){if(d[0]==="#"&&d.length===7)return{r:parseInt(d.slice(1,3),16),g:parseInt(d.slice(3,5),16),b:parseInt(d.slice(5,7),16),a:1}},_hex4ColorToRGBA(d){if(d[0]==="#"&&d.length===5)return{r:parseInt(d[1]+d[1],16),g:parseInt(d[2]+d[2],16),b:parseInt(d[3]+d[3],16),a:parseInt(d[4]+d[4],16)/255}},_hex3ColorToRGBA(d){if(d[0]==="#"&&d.length===4)return{r:parseInt(d[1]+d[1],16),g:parseInt(d[2]+d[2],16),b:parseInt(d[3]+d[3],16),a:1}},_hslColorToRGBA(d){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(d)){const[y,...b]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(d),k=Number(b[0])/360,D=Number(b[1])/100,x=Number(b[2])/100;let C,T,M;if(D===0)return M=x*255,{r:Math.round(M),g:Math.round(M),b:Math.round(M),a:1};x<.5?C=x*(1+D):C=x+D-x*D;const L=2*x-C,I=[0,0,0];for(let H=0;H<3;H++)T=k+.3333333333333333*-(H-1),T<0&&T++,T>1&&T--,6*T<1?M=L+(C-L)*6*T:2*T<1?M=C:3*T<2?M=L+(C-L)*(.6666666666666666-T)*6:M=L,I[H]=M*255;return{r:Math.round(I[0]),g:Math.round(I[1]),b:Math.round(I[2]),a:1}}},haveIntersection(d,y){return!(y.x>d.x+d.width||y.x+y.width<d.x||y.y>d.y+d.height||y.y+y.height<d.y)},cloneObject(d){const y={};for(const b in d)this._isPlainObject(d[b])?y[b]=this.cloneObject(d[b]):this._isArray(d[b])?y[b]=this.cloneArray(d[b]):y[b]=d[b];return y},cloneArray(d){return d.slice(0)},degToRad(d){return d*a},radToDeg(d){return d*l},_degToRad(d){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(d)},_radToDeg(d){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(d)},_getRotation(d){return e.Konva.angleDeg?t.Util.radToDeg(d):d},_capitalize(d){return d.charAt(0).toUpperCase()+d.slice(1)},throw(d){throw new Error(u+d)},error(d){console.error(u+d)},warn(d){e.Konva.showWarnings&&console.warn(f+d)},each(d,y){for(const b in d)y(b,d[b])},_inRange(d,y,b){return y<=d&&d<b},_getProjectionToSegment(d,y,b,k,D,x){let C,T,M;const L=(d-b)*(d-b)+(y-k)*(y-k);if(L==0)C=d,T=y,M=(D-b)*(D-b)+(x-k)*(x-k);else{const I=((D-d)*(b-d)+(x-y)*(k-y))/L;I<0?(C=d,T=y,M=(d-D)*(d-D)+(y-x)*(y-x)):I>1?(C=b,T=k,M=(b-D)*(b-D)+(k-x)*(k-x)):(C=d+I*(b-d),T=y+I*(k-y),M=(C-D)*(C-D)+(T-x)*(T-x))}return[C,T,M]},_getProjectionToLine(d,y,b){const k=t.Util.cloneObject(d);let D=Number.MAX_VALUE;return y.forEach(function(x,C){if(!b&&C===y.length-1)return;const T=y[(C+1)%y.length],M=t.Util._getProjectionToSegment(x.x,x.y,T.x,T.y,d.x,d.y),L=M[0],I=M[1],H=M[2];H<D&&(k.x=L,k.y=I,D=H)}),k},_prepareArrayForTween(d,y,b){const k=[],D=[];if(d.length>y.length){const C=y;y=d,d=C}for(let C=0;C<d.length;C+=2)k.push({x:d[C],y:d[C+1]});for(let C=0;C<y.length;C+=2)D.push({x:y[C],y:y[C+1]});const x=[];return D.forEach(function(C){const T=t.Util._getProjectionToLine(C,k,b);x.push(T.x),x.push(T.y)}),x},_prepareToStringify(d){let y;d.visitedByCircularReferenceRemoval=!0;for(const b in d)if(d.hasOwnProperty(b)&&d[b]&&typeof d[b]=="object"){if(y=Object.getOwnPropertyDescriptor(d,b),d[b].visitedByCircularReferenceRemoval||t.Util._isElement(d[b]))if(y.configurable)delete d[b];else return null;else if(t.Util._prepareToStringify(d[b])===null)if(y.configurable)delete d[b];else return null}return delete d.visitedByCircularReferenceRemoval,d},_assign(d,y){for(const b in y)d[b]=y[b];return d},_getFirstPointerId(d){return d.touches?d.changedTouches[0].identifier:d.pointerId||999},releaseCanvas(...d){e.Konva.releaseCanvasOnDestroy&&d.forEach(y=>{y.width=0,y.height=0})},drawRoundedRectPath(d,y,b,k){let D=0,x=0,C=0,T=0;typeof k=="number"?D=x=C=T=Math.min(k,y/2,b/2):(D=Math.min(k[0]||0,y/2,b/2),x=Math.min(k[1]||0,y/2,b/2),T=Math.min(k[2]||0,y/2,b/2),C=Math.min(k[3]||0,y/2,b/2)),d.moveTo(D,0),d.lineTo(y-x,0),d.arc(y-x,x,x,Math.PI*3/2,0,!1),d.lineTo(y,b-T),d.arc(y-T,b-T,T,0,Math.PI/2,!1),d.lineTo(C,b),d.arc(C,b-C,C,Math.PI/2,Math.PI,!1),d.lineTo(0,D),d.arc(D,D,D,Math.PI,Math.PI*3/2,!1)}}}(as)),as}var Mn={},Ee={},Me={},$a;function ja(){if($a)return Me;$a=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.HitContext=Me.SceneContext=Me.Context=void 0;const t=Nt(),e=vt();function n(w){const g=[],d=w.length,y=t.Util;for(let b=0;b<d;b++){let k=w[b];y._isNumber(k)?k=Math.round(k*1e3)/1e3:y._isString(k)||(k=k+""),g.push(k)}return g}const i=",",s="(",r=")",o="([",a="])",l=";",c="()",h="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],f=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],u=100;let m=class{constructor(g){this.canvas=g,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(g){g.fillEnabled()&&this._fill(g)}_fill(g){}strokeShape(g){g.hasStroke()&&this._stroke(g)}_stroke(g){}fillStrokeShape(g){g.attrs.fillAfterStrokeEnabled?(this.strokeShape(g),this.fillShape(g)):(this.fillShape(g),this.strokeShape(g))}getTrace(g,d){let y=this.traceArr,b=y.length,k="",D,x,C,T;for(D=0;D<b;D++)x=y[D],C=x.method,C?(T=x.args,k+=C,g?k+=c:t.Util._isArray(T[0])?k+=o+T.join(i)+a:(d&&(T=T.map(M=>typeof M=="number"?Math.floor(M):M)),k+=s+T.join(i)+r)):(k+=x.property,g||(k+=h+x.val)),k+=l;return k}clearTrace(){this.traceArr=[]}_trace(g){let d=this.traceArr,y;d.push(g),y=d.length,y>=u&&d.shift()}reset(){const g=this.getCanvas().getPixelRatio();this.setTransform(1*g,0,0,1*g,0,0)}getCanvas(){return this.canvas}clear(g){const d=this.getCanvas();g?this.clearRect(g.x||0,g.y||0,g.width||0,g.height||0):this.clearRect(0,0,d.getWidth()/d.pixelRatio,d.getHeight()/d.pixelRatio)}_applyLineCap(g){const d=g.attrs.lineCap;d&&this.setAttr("lineCap",d)}_applyOpacity(g){const d=g.getAbsoluteOpacity();d!==1&&this.setAttr("globalAlpha",d)}_applyLineJoin(g){const d=g.attrs.lineJoin;d&&this.setAttr("lineJoin",d)}setAttr(g,d){this._context[g]=d}arc(g,d,y,b,k,D){this._context.arc(g,d,y,b,k,D)}arcTo(g,d,y,b,k){this._context.arcTo(g,d,y,b,k)}beginPath(){this._context.beginPath()}bezierCurveTo(g,d,y,b,k,D){this._context.bezierCurveTo(g,d,y,b,k,D)}clearRect(g,d,y,b){this._context.clearRect(g,d,y,b)}clip(...g){this._context.clip.apply(this._context,g)}closePath(){this._context.closePath()}createImageData(g,d){const y=arguments;if(y.length===2)return this._context.createImageData(g,d);if(y.length===1)return this._context.createImageData(g)}createLinearGradient(g,d,y,b){return this._context.createLinearGradient(g,d,y,b)}createPattern(g,d){return this._context.createPattern(g,d)}createRadialGradient(g,d,y,b,k,D){return this._context.createRadialGradient(g,d,y,b,k,D)}drawImage(g,d,y,b,k,D,x,C,T){const M=arguments,L=this._context;M.length===3?L.drawImage(g,d,y):M.length===5?L.drawImage(g,d,y,b,k):M.length===9&&L.drawImage(g,d,y,b,k,D,x,C,T)}ellipse(g,d,y,b,k,D,x,C){this._context.ellipse(g,d,y,b,k,D,x,C)}isPointInPath(g,d,y,b){return y?this._context.isPointInPath(y,g,d,b):this._context.isPointInPath(g,d,b)}fill(...g){this._context.fill.apply(this._context,g)}fillRect(g,d,y,b){this._context.fillRect(g,d,y,b)}strokeRect(g,d,y,b){this._context.strokeRect(g,d,y,b)}fillText(g,d,y,b){b?this._context.fillText(g,d,y,b):this._context.fillText(g,d,y)}measureText(g){return this._context.measureText(g)}getImageData(g,d,y,b){return this._context.getImageData(g,d,y,b)}lineTo(g,d){this._context.lineTo(g,d)}moveTo(g,d){this._context.moveTo(g,d)}rect(g,d,y,b){this._context.rect(g,d,y,b)}roundRect(g,d,y,b,k){this._context.roundRect(g,d,y,b,k)}putImageData(g,d,y){this._context.putImageData(g,d,y)}quadraticCurveTo(g,d,y,b){this._context.quadraticCurveTo(g,d,y,b)}restore(){this._context.restore()}rotate(g){this._context.rotate(g)}save(){this._context.save()}scale(g,d){this._context.scale(g,d)}setLineDash(g){this._context.setLineDash?this._context.setLineDash(g):"mozDash"in this._context?this._context.mozDash=g:"webkitLineDash"in this._context&&(this._context.webkitLineDash=g)}getLineDash(){return this._context.getLineDash()}setTransform(g,d,y,b,k,D){this._context.setTransform(g,d,y,b,k,D)}stroke(g){g?this._context.stroke(g):this._context.stroke()}strokeText(g,d,y,b){this._context.strokeText(g,d,y,b)}transform(g,d,y,b,k,D){this._context.transform(g,d,y,b,k,D)}translate(g,d){this._context.translate(g,d)}_enableTrace(){let g=this,d=p.length,y=this.setAttr,b,k;const D=function(x){let C=g[x],T;g[x]=function(){return k=n(Array.prototype.slice.call(arguments,0)),T=C.apply(g,arguments),g._trace({method:x,args:k}),T}};for(b=0;b<d;b++)D(p[b]);g.setAttr=function(){y.apply(g,arguments);const x=arguments[0];let C=arguments[1];(x==="shadowOffsetX"||x==="shadowOffsetY"||x==="shadowBlur")&&(C=C/this.canvas.getPixelRatio()),g._trace({property:x,val:C})}}_applyGlobalCompositeOperation(g){const d=g.attrs.globalCompositeOperation;!d||d==="source-over"||this.setAttr("globalCompositeOperation",d)}};Me.Context=m,f.forEach(function(w){Object.defineProperty(m.prototype,w,{get(){return this._context[w]},set(g){this._context[w]=g}})});class _ extends m{constructor(g,{willReadFrequently:d=!1}={}){super(g),this._context=g._canvas.getContext("2d",{willReadFrequently:d})}_fillColor(g){const d=g.fill();this.setAttr("fillStyle",d),g._fillFunc(this)}_fillPattern(g){this.setAttr("fillStyle",g._getFillPattern()),g._fillFunc(this)}_fillLinearGradient(g){const d=g._getLinearGradient();d&&(this.setAttr("fillStyle",d),g._fillFunc(this))}_fillRadialGradient(g){const d=g._getRadialGradient();d&&(this.setAttr("fillStyle",d),g._fillFunc(this))}_fill(g){const d=g.fill(),y=g.getFillPriority();if(d&&y==="color"){this._fillColor(g);return}const b=g.getFillPatternImage();if(b&&y==="pattern"){this._fillPattern(g);return}const k=g.getFillLinearGradientColorStops();if(k&&y==="linear-gradient"){this._fillLinearGradient(g);return}const D=g.getFillRadialGradientColorStops();if(D&&y==="radial-gradient"){this._fillRadialGradient(g);return}d?this._fillColor(g):b?this._fillPattern(g):k?this._fillLinearGradient(g):D&&this._fillRadialGradient(g)}_strokeLinearGradient(g){const d=g.getStrokeLinearGradientStartPoint(),y=g.getStrokeLinearGradientEndPoint(),b=g.getStrokeLinearGradientColorStops(),k=this.createLinearGradient(d.x,d.y,y.x,y.y);if(b){for(let D=0;D<b.length;D+=2)k.addColorStop(b[D],b[D+1]);this.setAttr("strokeStyle",k)}}_stroke(g){const d=g.dash(),y=g.getStrokeScaleEnabled();if(g.hasStroke()){if(!y){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(g),d&&g.dashEnabled()&&(this.setLineDash(d),this.setAttr("lineDashOffset",g.dashOffset())),this.setAttr("lineWidth",g.strokeWidth()),g.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),g.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(g):this.setAttr("strokeStyle",g.stroke()),g._strokeFunc(this),y||this.restore()}}_applyShadow(g){var d,y,b;const k=(d=g.getShadowRGBA())!==null&&d!==void 0?d:"black",D=(y=g.getShadowBlur())!==null&&y!==void 0?y:5,x=(b=g.getShadowOffset())!==null&&b!==void 0?b:{x:0,y:0},C=g.getAbsoluteScale(),T=this.canvas.getPixelRatio(),M=C.x*T,L=C.y*T;this.setAttr("shadowColor",k),this.setAttr("shadowBlur",D*Math.min(Math.abs(M),Math.abs(L))),this.setAttr("shadowOffsetX",x.x*M),this.setAttr("shadowOffsetY",x.y*L)}}Me.SceneContext=_;class S extends m{constructor(g){super(g),this._context=g._canvas.getContext("2d",{willReadFrequently:!0})}_fill(g){this.save(),this.setAttr("fillStyle",g.colorKey),g._fillFuncHit(this),this.restore()}strokeShape(g){g.hasHitStroke()&&this._stroke(g)}_stroke(g){if(g.hasHitStroke()){const d=g.getStrokeScaleEnabled();if(!d){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(g);const y=g.hitStrokeWidth(),b=y==="auto"?g.strokeWidth():y;this.setAttr("lineWidth",b),this.setAttr("strokeStyle",g.colorKey),g._strokeFuncHit(this),d||this.restore()}}}return Me.HitContext=S,Me}var qa;function or(){if(qa)return Ee;qa=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.HitCanvas=Ee.SceneCanvas=Ee.Canvas=void 0;const t=Nt(),e=ja(),n=vt();let i;function s(){if(i)return i;const l=t.Util.createCanvasElement(),c=l.getContext("2d");return i=function(){const h=n.Konva._global.devicePixelRatio||1,p=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;return h/p}(),t.Util.releaseCanvas(l),i}let r=class{constructor(c){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const p=(c||{}).pixelRatio||n.Konva.pixelRatio||s();this.pixelRatio=p,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(c){const h=this.pixelRatio;this.pixelRatio=c,this.setSize(this.getWidth()/h,this.getHeight()/h)}setWidth(c){this.width=this._canvas.width=c*this.pixelRatio,this._canvas.style.width=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}setHeight(c){this.height=this._canvas.height=c*this.pixelRatio,this._canvas.style.height=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}getWidth(){return this.width}getHeight(){return this.height}setSize(c,h){this.setWidth(c||0),this.setHeight(h||0)}toDataURL(c,h){try{return this._canvas.toDataURL(c,h)}catch{try{return this._canvas.toDataURL()}catch(f){return t.Util.error("Unable to get data URL. "+f.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Ee.Canvas=r;class o extends r{constructor(c={width:0,height:0,willReadFrequently:!1}){super(c),this.context=new e.SceneContext(this,{willReadFrequently:c.willReadFrequently}),this.setSize(c.width,c.height)}}Ee.SceneCanvas=o;class a extends r{constructor(c={width:0,height:0}){super(c),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(c.width,c.height)}}return Ee.HitCanvas=a,Ee}var ls={},Ka;function cs(){return Ka||(Ka=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=vt(),n=Nt();t.DD={get isDragging(){let i=!1;return t.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return t.DD._dragElements.forEach(s=>{i=s.node}),i},_dragElements:new Map,_drag(i){const s=[];t.DD._dragElements.forEach((r,o)=>{const{node:a}=r,l=a.getStage();l.setPointersPositions(i),r.pointerId===void 0&&(r.pointerId=n.Util._getFirstPointerId(i));const c=l._changedPointerPositions.find(h=>h.id===r.pointerId);if(c){if(r.dragStatus!=="dragging"){const h=a.dragDistance();if(Math.max(Math.abs(c.x-r.startPointerPos.x),Math.abs(c.y-r.startPointerPos.y))<h||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,r),s.push(a)}}),s.forEach(r=>{r.fire("dragmove",{type:"dragmove",target:r,evt:i},!0)})},_endDragBefore(i){const s=[];t.DD._dragElements.forEach(r=>{const{node:o}=r,a=o.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(h=>h.id===r.pointerId))return;(r.dragStatus==="dragging"||r.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,r.dragStatus="stopped");const c=r.node.getLayer()||r.node instanceof e.Konva.Stage&&r.node;c&&s.indexOf(c)===-1&&s.push(c)}),s.forEach(r=>{r.draw()})},_endDragAfter(i){t.DD._dragElements.forEach((s,r)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:i},!0),s.dragStatus!=="dragging"&&t.DD._dragElements.delete(r)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))}(ls)),ls}var hs={},Yt={},Ya;function xt(){if(Ya)return Yt;Ya=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.RGBComponent=i,Yt.alphaComponent=s,Yt.getNumberValidator=r,Yt.getNumberOrArrayOfNumbersValidator=o,Yt.getNumberOrAutoValidator=a,Yt.getStringValidator=l,Yt.getStringOrGradientValidator=c,Yt.getFunctionValidator=h,Yt.getNumberArrayValidator=p,Yt.getBooleanValidator=f,Yt.getComponentValidator=u;const t=vt(),e=Nt();function n(m){return e.Util._isString(m)?'"'+m+'"':Object.prototype.toString.call(m)==="[object Number]"||e.Util._isBoolean(m)?m:Object.prototype.toString.call(m)}function i(m){return m>255?255:m<0?0:Math.round(m)}function s(m){return m>1?1:m<1e-4?1e-4:m}function r(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isNumber(m)||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a number.'),m}}function o(m){if(t.Konva.isUnminified)return function(_,S){let w=e.Util._isNumber(_),g=e.Util._isArray(_)&&_.length==m;return!w&&!g&&e.Util.warn(n(_)+' is a not valid value for "'+S+'" attribute. The value should be a number or Array<number>('+m+")"),_}}function a(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isNumber(m)||m==="auto"||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a number or "auto".'),m}}function l(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isString(m)||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a string.'),m}}function c(){if(t.Konva.isUnminified)return function(m,_){const S=e.Util._isString(m),w=Object.prototype.toString.call(m)==="[object CanvasGradient]"||m&&m.addColorStop;return S||w||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a string or a native gradient.'),m}}function h(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isFunction(m)||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a function.'),m}}function p(){if(t.Konva.isUnminified)return function(m,_){const S=Int8Array?Object.getPrototypeOf(Int8Array):null;return S&&m instanceof S||(e.Util._isArray(m)?m.forEach(function(w){e.Util._isNumber(w)||e.Util.warn('"'+_+'" attribute has non numeric element '+w+". Make sure that all elements are numbers.")}):e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a array of numbers.')),m}}function f(){if(t.Konva.isUnminified)return function(m,_){return m===!0||m===!1||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a boolean.'),m}}function u(m){if(t.Konva.isUnminified)return function(_,S){return _==null||e.Util.isObject(_)||e.Util.warn(n(_)+' is a not valid value for "'+S+'" attribute. The value should be an object with properties '+m),_}}return Yt}var Xa;function bt(){return Xa||(Xa=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Nt(),n=xt(),i="get",s="set";t.Factory={addGetterSetter(r,o,a,l,c){t.Factory.addGetter(r,o,a),t.Factory.addSetter(r,o,l,c),t.Factory.addOverloadedGetterSetter(r,o)},addGetter(r,o,a){const l=i+e.Util._capitalize(o);r.prototype[l]=r.prototype[l]||function(){const c=this.attrs[o];return c===void 0?a:c}},addSetter(r,o,a,l){const c=s+e.Util._capitalize(o);r.prototype[c]||t.Factory.overWriteSetter(r,o,a,l)},overWriteSetter(r,o,a,l){const c=s+e.Util._capitalize(o);r.prototype[c]=function(h){return a&&h!==void 0&&h!==null&&(h=a.call(this,h,o)),this._setAttr(o,h),l&&l.call(this),this}},addComponentsGetterSetter(r,o,a,l,c){const h=a.length,p=e.Util._capitalize,f=i+p(o),u=s+p(o);r.prototype[f]=function(){const _={};for(let S=0;S<h;S++){const w=a[S];_[w]=this.getAttr(o+p(w))}return _};const m=(0,n.getComponentValidator)(a);r.prototype[u]=function(_){const S=this.attrs[o];l&&(_=l.call(this,_,o)),m&&m.call(this,_,o);for(const w in _)_.hasOwnProperty(w)&&this._setAttr(o+p(w),_[w]);return _||a.forEach(w=>{this._setAttr(o+p(w),void 0)}),this._fireChangeEvent(o,S,_),c&&c.call(this),this},t.Factory.addOverloadedGetterSetter(r,o)},addOverloadedGetterSetter(r,o){const a=e.Util._capitalize(o),l=s+a,c=i+a;r.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(r,o,a,l){e.Util.error("Adding deprecated "+o);const c=i+e.Util._capitalize(o),h=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";r.prototype[c]=function(){e.Util.error(h);const p=this.attrs[o];return p===void 0?a:p},t.Factory.addSetter(r,o,l,function(){e.Util.error(h)}),t.Factory.addOverloadedGetterSetter(r,o)},backCompat(r,o){e.Util.each(o,function(a,l){const c=r.prototype[l],h=i+e.Util._capitalize(a),p=s+e.Util._capitalize(a);function f(){c.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}r.prototype[a]=f,r.prototype[h]=f,r.prototype[p]=f})},afterSetFilter(){this._filterUpToDate=!1}}}(hs)),hs}var Ja;function Ot(){if(Ja)return Mn;Ja=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.Node=void 0;const t=or(),e=cs(),n=bt(),i=vt(),s=Nt(),r=xt(),o="absoluteOpacity",a="allEventListeners",l="absoluteTransform",c="absoluteScale",h="canvas",p="Change",f="children",u="konva",m="listening",_="mouseenter",S="mouseleave",w="pointerenter",g="pointerleave",d="touchenter",y="touchleave",b="set",k="Shape",D=" ",x="stage",C="transform",T="Stage",M="visible",L=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(D);let I=1,H=class Ws{constructor(v){this._id=I++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(v),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(v){(v===C||v===l)&&this._cache.get(v)?this._cache.get(v).dirty=!0:v?this._cache.delete(v):this._cache.clear()}_getCache(v,P){let E=this._cache.get(v);return(E===void 0||(v===C||v===l)&&E.dirty===!0)&&(E=P.call(this),this._cache.set(v,E)),E}_calculate(v,P,E){if(!this._attachedDepsListeners.get(v)){const A=P.map(O=>O+"Change.konva").join(D);this.on(A,()=>{this._clearCache(v)}),this._attachedDepsListeners.set(v,!0)}return this._getCache(v,E)}_getCanvasCache(){return this._cache.get(h)}_clearSelfAndDescendantCache(v){this._clearCache(v),v===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(h)){const{scene:v,filter:P,hit:E,buffer:A}=this._cache.get(h);s.Util.releaseCanvas(v,P,E,A),this._cache.delete(h)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(v){const P=v||{};let E={};(P.x===void 0||P.y===void 0||P.width===void 0||P.height===void 0)&&(E=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let A=Math.ceil(P.width||E.width),O=Math.ceil(P.height||E.height),j=P.pixelRatio,B=P.x===void 0?Math.floor(E.x):P.x,J=P.y===void 0?Math.floor(E.y):P.y,st=P.offset||0,$=P.drawBorder||!1,F=P.hitCanvasPixelRatio||1;if(!A||!O){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const W=Math.abs(Math.round(E.x)-B)>.5?1:0,nt=Math.abs(Math.round(E.y)-J)>.5?1:0;A+=st*2+W,O+=st*2+nt,B-=st,J-=st;const it=new t.SceneCanvas({pixelRatio:j,width:A,height:O}),ct=new t.SceneCanvas({pixelRatio:j,width:0,height:0,willReadFrequently:!0}),R=new t.HitCanvas({pixelRatio:F,width:A,height:O}),N=it.getContext(),z=R.getContext(),q=new t.SceneCanvas({width:it.width/it.pixelRatio+Math.abs(B),height:it.height/it.pixelRatio+Math.abs(J),pixelRatio:it.pixelRatio}),Y=q.getContext();return R.isCache=!0,it.isCache=!0,this._cache.delete(h),this._filterUpToDate=!1,P.imageSmoothingEnabled===!1&&(it.getContext()._context.imageSmoothingEnabled=!1,ct.getContext()._context.imageSmoothingEnabled=!1),N.save(),z.save(),Y.save(),N.translate(-B,-J),z.translate(-B,-J),Y.translate(-B,-J),q.x=B,q.y=J,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this.drawScene(it,this,q),this.drawHit(R,this),this._isUnderCache=!1,N.restore(),z.restore(),$&&(N.save(),N.beginPath(),N.rect(0,0,A,O),N.closePath(),N.setAttr("strokeStyle","red"),N.setAttr("lineWidth",5),N.stroke(),N.restore()),this._cache.set(h,{scene:it,filter:ct,hit:R,buffer:q,x:B,y:J}),this._requestDraw(),this}isCached(){return this._cache.has(h)}getClientRect(v){throw new Error('abstract "getClientRect" method call')}_transformedRect(v,P){const E=[{x:v.x,y:v.y},{x:v.x+v.width,y:v.y},{x:v.x+v.width,y:v.y+v.height},{x:v.x,y:v.y+v.height}];let A=1/0,O=1/0,j=-1/0,B=-1/0;const J=this.getAbsoluteTransform(P);return E.forEach(function(st){const $=J.point(st);A===void 0&&(A=j=$.x,O=B=$.y),A=Math.min(A,$.x),O=Math.min(O,$.y),j=Math.max(j,$.x),B=Math.max(B,$.y)}),{x:A,y:O,width:j-A,height:B-O}}_drawCachedSceneCanvas(v){v.save(),v._applyOpacity(this),v._applyGlobalCompositeOperation(this);const P=this._getCanvasCache();v.translate(P.x,P.y);const E=this._getCachedSceneCanvas(),A=E.pixelRatio;v.drawImage(E._canvas,0,0,E.width/A,E.height/A),v.restore()}_drawCachedHitCanvas(v){const P=this._getCanvasCache(),E=P.hit;v.save(),v.translate(P.x,P.y),v.drawImage(E._canvas,0,0,E.width/E.pixelRatio,E.height/E.pixelRatio),v.restore()}_getCachedSceneCanvas(){let v=this.filters(),P=this._getCanvasCache(),E=P.scene,A=P.filter,O=A.getContext(),j,B,J,st;if(v){if(!this._filterUpToDate){const $=E.pixelRatio;A.setSize(E.width/E.pixelRatio,E.height/E.pixelRatio);try{for(j=v.length,O.clear(),O.drawImage(E._canvas,0,0,E.getWidth()/$,E.getHeight()/$),B=O.getImageData(0,0,A.getWidth(),A.getHeight()),J=0;J<j;J++){if(st=v[J],typeof st!="function"){s.Util.error("Filter should be type of function, but got "+typeof st+" instead. Please check correct filters");continue}st.call(this,B),O.putImageData(B,0,0)}}catch(F){s.Util.error("Unable to apply filter. "+F.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return A}return E}on(v,P){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const E=v.split(D);for(let A=0;A<E.length;A++){const j=E[A].split("."),B=j[0],J=j[1]||"";this.eventListeners[B]||(this.eventListeners[B]=[]),this.eventListeners[B].push({name:J,handler:P})}return this}off(v,P){let E=(v||"").split(D),A=E.length,O,j,B,J,st,$;if(this._cache&&this._cache.delete(a),!v)for(j in this.eventListeners)this._off(j);for(O=0;O<A;O++)if(B=E[O],J=B.split("."),st=J[0],$=J[1],st)this.eventListeners[st]&&this._off(st,$,P);else for(j in this.eventListeners)this._off(j,$,P);return this}dispatchEvent(v){const P={target:this,type:v.type,evt:v};return this.fire(v.type,P),this}addEventListener(v,P){return this.on(v,function(E){P.call(this,E.evt)}),this}removeEventListener(v){return this.off(v),this}_delegate(v,P,E){const A=this;this.on(v,function(O){const j=O.target.findAncestors(P,!0,A);for(let B=0;B<j.length;B++)O=s.Util.cloneObject(O),O.currentTarget=j[B],E.call(j[B],O)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(x),this._clearSelfAndDescendantCache(M),this._clearSelfAndDescendantCache(m)}_remove(){this._clearCaches();const v=this.getParent();v&&v.children&&(v.children.splice(this.index,1),v._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(v){const P="get"+s.Util._capitalize(v);return s.Util._isFunction(this[P])?this[P]():this.attrs[v]}getAncestors(){let v=this.getParent(),P=[];for(;v;)P.push(v),v=v.getParent();return P}getAttrs(){return this.attrs||{}}setAttrs(v){return this._batchTransformChanges(()=>{let P,E;if(!v)return this;for(P in v)P!==f&&(E=b+s.Util._capitalize(P),s.Util._isFunction(this[E])?this[E](v[P]):this._setAttr(P,v[P]))}),this}isListening(){return this._getCache(m,this._isListening)}_isListening(v){if(!this.listening())return!1;const E=this.getParent();return E&&E!==v&&this!==v?E._isListening(v):!0}isVisible(){return this._getCache(M,this._isVisible)}_isVisible(v){if(!this.visible())return!1;const E=this.getParent();return E&&E!==v&&this!==v?E._isVisible(v):!0}shouldDrawHit(v,P=!1){if(v)return this._isVisible(v)&&this._isListening(v);const E=this.getLayer();let A=!1;e.DD._dragElements.forEach(j=>{j.dragStatus==="dragging"&&(j.node.nodeType==="Stage"||j.node.getLayer()===E)&&(A=!0)});const O=!P&&!i.Konva.hitOnDragEnabled&&(A||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!O}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let v=this.getDepth(),P=this,E=0,A,O,j,B;function J($){for(A=[],O=$.length,j=0;j<O;j++)B=$[j],E++,B.nodeType!==k&&(A=A.concat(B.getChildren().slice())),B._id===P._id&&(j=O);A.length>0&&A[0].getDepth()<=v&&J(A)}const st=this.getStage();return P.nodeType!==T&&st&&J(st.getChildren()),E}getDepth(){let v=0,P=this.parent;for(;P;)v++,P=P.parent;return v}_batchTransformChanges(v){this._batchingTransformChange=!0,v(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(C),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(v){return this._batchTransformChanges(()=>{this.x(v.x),this.y(v.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const v=this.getStage();if(!v)return null;const P=v.getPointerPosition();if(!P)return null;const E=this.getAbsoluteTransform().copy();return E.invert(),E.point(P)}getAbsolutePosition(v){let P=!1,E=this.parent;for(;E;){if(E.isCached()){P=!0;break}E=E.parent}P&&!v&&(v=!0);const A=this.getAbsoluteTransform(v).getMatrix(),O=new s.Transform,j=this.offset();return O.m=A.slice(),O.translate(j.x,j.y),O.getTranslation()}setAbsolutePosition(v){const{x:P,y:E,...A}=this._clearTransform();this.attrs.x=P,this.attrs.y=E,this._clearCache(C);const O=this._getAbsoluteTransform().copy();return O.invert(),O.translate(v.x,v.y),v={x:this.attrs.x+O.getTranslation().x,y:this.attrs.y+O.getTranslation().y},this._setTransform(A),this.setPosition({x:v.x,y:v.y}),this._clearCache(C),this._clearSelfAndDescendantCache(l),this}_setTransform(v){let P;for(P in v)this.attrs[P]=v[P]}_clearTransform(){const v={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,v}move(v){let P=v.x,E=v.y,A=this.x(),O=this.y();return P!==void 0&&(A+=P),E!==void 0&&(O+=E),this.setPosition({x:A,y:O}),this}_eachAncestorReverse(v,P){let E=[],A=this.getParent(),O,j;if(!(P&&P._id===this._id)){for(E.unshift(this);A&&(!P||A._id!==P._id);)E.unshift(A),A=A.parent;for(O=E.length,j=0;j<O;j++)v(E[j])}}rotate(v){return this.rotation(this.rotation()+v),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const v=this.index,P=this.parent.getChildren().length;return v<P-1?(this.parent.children.splice(v,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const v=this.index,P=this.parent.getChildren().length;return v<P-1?(this.parent.children.splice(v,1),this.parent.children.splice(v+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const v=this.index;return v>0?(this.parent.children.splice(v,1),this.parent.children.splice(v-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const v=this.index;return v>0?(this.parent.children.splice(v,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(v){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(v<0||v>=this.parent.children.length)&&s.Util.warn("Unexpected value "+v+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const P=this.index;return this.parent.children.splice(P,1),this.parent.children.splice(v,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let v=this.opacity();const P=this.getParent();return P&&!P._isUnderCache&&(v*=P.getAbsoluteOpacity()),v}moveTo(v){return this.getParent()!==v&&(this._remove(),v.add(this)),this}toObject(){let v=this.getAttrs(),P,E,A,O,j;const B={attrs:{},className:this.getClassName()};for(P in v)E=v[P],j=s.Util.isObject(E)&&!s.Util._isPlainObject(E)&&!s.Util._isArray(E),!j&&(A=typeof this[P]=="function"&&this[P],delete v[P],O=A?A.call(this):null,v[P]=E,O!==E&&(B.attrs[P]=E));return s.Util._prepareToStringify(B)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(v,P,E){const A=[];P&&this._isMatch(v)&&A.push(this);let O=this.parent;for(;O;){if(O===E)return A;O._isMatch(v)&&A.push(O),O=O.parent}return A}isAncestorOf(v){return!1}findAncestor(v,P,E){return this.findAncestors(v,P,E)[0]}_isMatch(v){if(!v)return!1;if(typeof v=="function")return v(this);let P=v.replace(/ /g,"").split(","),E=P.length,A,O;for(A=0;A<E;A++)if(O=P[A],s.Util.isValidSelector(O)||(s.Util.warn('Selector "'+O+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),O.charAt(0)==="#"){if(this.id()===O.slice(1))return!0}else if(O.charAt(0)==="."){if(this.hasName(O.slice(1)))return!0}else if(this.className===O||this.nodeType===O)return!0;return!1}getLayer(){const v=this.getParent();return v?v.getLayer():null}getStage(){return this._getCache(x,this._getStage)}_getStage(){const v=this.getParent();return v?v.getStage():null}fire(v,P={},E){return P.target=P.target||this,E?this._fireAndBubble(v,P):this._fire(v,P),this}getAbsoluteTransform(v){return v?this._getAbsoluteTransform(v):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(v){let P;if(v)return P=new s.Transform,this._eachAncestorReverse(function(E){const A=E.transformsEnabled();A==="all"?P.multiply(E.getTransform()):A==="position"&&P.translate(E.x()-E.offsetX(),E.y()-E.offsetY())},v),P;{P=this._cache.get(l)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(P):P.reset();const E=this.transformsEnabled();if(E==="all")P.multiply(this.getTransform());else if(E==="position"){const A=this.attrs.x||0,O=this.attrs.y||0,j=this.attrs.offsetX||0,B=this.attrs.offsetY||0;P.translate(A-j,O-B)}return P.dirty=!1,P}}getAbsoluteScale(v){let P=this;for(;P;)P._isUnderCache&&(v=P),P=P.getParent();const A=this.getAbsoluteTransform(v).decompose();return{x:A.scaleX,y:A.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(C,this._getTransform)}_getTransform(){var v,P;const E=this._cache.get(C)||new s.Transform;E.reset();const A=this.x(),O=this.y(),j=i.Konva.getAngle(this.rotation()),B=(v=this.attrs.scaleX)!==null&&v!==void 0?v:1,J=(P=this.attrs.scaleY)!==null&&P!==void 0?P:1,st=this.attrs.skewX||0,$=this.attrs.skewY||0,F=this.attrs.offsetX||0,W=this.attrs.offsetY||0;return(A!==0||O!==0)&&E.translate(A,O),j!==0&&E.rotate(j),(st!==0||$!==0)&&E.skew(st,$),(B!==1||J!==1)&&E.scale(B,J),(F!==0||W!==0)&&E.translate(-1*F,-1*W),E.dirty=!1,E}clone(v){let P=s.Util.cloneObject(this.attrs),E,A,O,j,B;for(E in v)P[E]=v[E];const J=new this.constructor(P);for(E in this.eventListeners)for(A=this.eventListeners[E],O=A.length,j=0;j<O;j++)B=A[j],B.name.indexOf(u)<0&&(J.eventListeners[E]||(J.eventListeners[E]=[]),J.eventListeners[E].push(B));return J}_toKonvaCanvas(v){v=v||{};const P=this.getClientRect(),E=this.getStage(),A=v.x!==void 0?v.x:Math.floor(P.x),O=v.y!==void 0?v.y:Math.floor(P.y),j=v.pixelRatio||1,B=new t.SceneCanvas({width:v.width||Math.ceil(P.width)||(E?E.width():0),height:v.height||Math.ceil(P.height)||(E?E.height():0),pixelRatio:j}),J=B.getContext(),st=new t.SceneCanvas({width:B.width/B.pixelRatio+Math.abs(A),height:B.height/B.pixelRatio+Math.abs(O),pixelRatio:B.pixelRatio});return v.imageSmoothingEnabled===!1&&(J._context.imageSmoothingEnabled=!1),J.save(),(A||O)&&J.translate(-1*A,-1*O),this.drawScene(B,void 0,st),J.restore(),B}toCanvas(v){return this._toKonvaCanvas(v)._canvas}toDataURL(v){v=v||{};const P=v.mimeType||null,E=v.quality||null,A=this._toKonvaCanvas(v).toDataURL(P,E);return v.callback&&v.callback(A),A}toImage(v){return new Promise((P,E)=>{try{const A=v?.callback;A&&delete v.callback,s.Util._urlToImage(this.toDataURL(v),function(O){P(O),A?.(O)})}catch(A){E(A)}})}toBlob(v){return new Promise((P,E)=>{try{const A=v?.callback;A&&delete v.callback,this.toCanvas(v).toBlob(O=>{P(O),A?.(O)},v?.mimeType,v?.quality)}catch(A){E(A)}})}setSize(v){return this.width(v.width),this.height(v.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(v,P,E){let A=this.eventListeners[v],O,j,B;for(O=0;O<A.length;O++)if(j=A[O].name,B=A[O].handler,(j!=="konva"||P==="konva")&&(!P||j===P)&&(!E||E===B)){if(A.splice(O,1),A.length===0){delete this.eventListeners[v];break}O--}}_fireChangeEvent(v,P,E){this._fire(v+p,{oldVal:P,newVal:E})}addName(v){if(!this.hasName(v)){const P=this.name(),E=P?P+" "+v:v;this.name(E)}return this}hasName(v){if(!v)return!1;const P=this.name();return P?(P||"").split(/\s/g).indexOf(v)!==-1:!1}removeName(v){const P=(this.name()||"").split(/\s/g),E=P.indexOf(v);return E!==-1&&(P.splice(E,1),this.name(P.join(" "))),this}setAttr(v,P){const E=this[b+s.Util._capitalize(v)];return s.Util._isFunction(E)?E.call(this,P):this._setAttr(v,P),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const v=this.getLayer()||this.getStage();v?.batchDraw()}}_setAttr(v,P){const E=this.attrs[v];E===P&&!s.Util.isObject(P)||(P==null?delete this.attrs[v]:this.attrs[v]=P,this._shouldFireChangeEvents&&this._fireChangeEvent(v,E,P),this._requestDraw())}_setComponentAttr(v,P,E){let A;E!==void 0&&(A=this.attrs[v],A||(this.attrs[v]=this.getAttr(v)),this.attrs[v][P]=E,this._fireChangeEvent(v,A,E))}_fireAndBubble(v,P,E){P&&this.nodeType===k&&(P.target=this);const A=[_,S,w,g,d,y];if(!(A.indexOf(v)!==-1&&(E&&(this===E||this.isAncestorOf&&this.isAncestorOf(E))||this.nodeType==="Stage"&&!E))){this._fire(v,P);const j=A.indexOf(v)!==-1&&E&&E.isAncestorOf&&E.isAncestorOf(this)&&!E.isAncestorOf(this.parent);(P&&!P.cancelBubble||!P)&&this.parent&&this.parent.isListening()&&!j&&(E&&E.parent?this._fireAndBubble.call(this.parent,v,P,E):this._fireAndBubble.call(this.parent,v,P))}}_getProtoListeners(v){var P,E,A;const O=(P=this._cache.get(a))!==null&&P!==void 0?P:{};let j=O?.[v];if(j===void 0){j=[];let B=Object.getPrototypeOf(this);for(;B;){const J=(A=(E=B.eventListeners)===null||E===void 0?void 0:E[v])!==null&&A!==void 0?A:[];j.push(...J),B=Object.getPrototypeOf(B)}O[v]=j,this._cache.set(a,O)}return j}_fire(v,P){P=P||{},P.currentTarget=this,P.type=v;const E=this._getProtoListeners(v);if(E)for(let O=0;O<E.length;O++)E[O].handler.call(this,P);const A=this.eventListeners[v];if(A)for(let O=0;O<A.length;O++)A[O].handler.call(this,P)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(v){const P=v?v.pointerId:void 0,E=this.getStage(),A=this.getAbsolutePosition();if(!E)return;const O=E._getPointerById(P)||E._changedPointerPositions[0]||A;e.DD._dragElements.set(this._id,{node:this,startPointerPos:O,offset:{x:O.x-A.x,y:O.y-A.y},dragStatus:"ready",pointerId:P})}startDrag(v,P=!0){e.DD._dragElements.has(this._id)||this._createDragElement(v);const E=e.DD._dragElements.get(this._id);E.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:v&&v.evt},P)}_setDragPosition(v,P){const E=this.getStage()._getPointerById(P.pointerId);if(!E)return;let A={x:E.x-P.offset.x,y:E.y-P.offset.y};const O=this.dragBoundFunc();if(O!==void 0){const j=O.call(this,A,v);j?A=j:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==A.x||this._lastPos.y!==A.y)&&(this.setAbsolutePosition(A),this._requestDraw()),this._lastPos=A}stopDrag(v){const P=e.DD._dragElements.get(this._id);P&&(P.dragStatus="stopped"),e.DD._endDragBefore(v),e.DD._endDragAfter(v)}setDraggable(v){this._setAttr("draggable",v),this._dragChange()}isDragging(){const v=e.DD._dragElements.get(this._id);return v?v.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(v){if(!(!(v.evt.button!==void 0)||i.Konva.dragButtons.indexOf(v.evt.button)>=0)||this.isDragging())return;let A=!1;e.DD._dragElements.forEach(O=>{this.isAncestorOf(O.node)&&(A=!0)}),A||this._createDragElement(v)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const P=e.DD._dragElements.get(this._id),E=P&&P.dragStatus==="dragging",A=P&&P.dragStatus==="ready";E?this.stopDrag():A&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(v={x:0,y:0}){const P=this.getStage();if(!P)return!1;const E={x:-v.x,y:-v.y,width:P.width()+2*v.x,height:P.height()+2*v.y};return s.Util.haveIntersection(E,this.getClientRect())}static create(v,P){return s.Util._isString(v)&&(v=JSON.parse(v)),this._createNode(v,P)}static _createNode(v,P){let E=Ws.prototype.getClassName.call(v),A=v.children,O,j,B;P&&(v.attrs.container=P),i.Konva[E]||(s.Util.warn('Can not find a node with class name "'+E+'". Fallback to "Shape".'),E="Shape");const J=i.Konva[E];if(O=new J(v.attrs),A)for(j=A.length,B=0;B<j;B++)O.add(Ws._createNode(A[B]));return O}};Mn.Node=H,H.prototype.nodeType="Node",H.prototype._attrsAffectingSize=[],H.prototype.eventListeners={},H.prototype.on.call(H.prototype,L,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(C),this._clearSelfAndDescendantCache(l)}),H.prototype.on.call(H.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(M)}),H.prototype.on.call(H.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(m)}),H.prototype.on.call(H.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const G=n.Factory.addGetterSetter;return G(H,"zIndex"),G(H,"absolutePosition"),G(H,"position"),G(H,"x",0,(0,r.getNumberValidator)()),G(H,"y",0,(0,r.getNumberValidator)()),G(H,"globalCompositeOperation","source-over",(0,r.getStringValidator)()),G(H,"opacity",1,(0,r.getNumberValidator)()),G(H,"name","",(0,r.getStringValidator)()),G(H,"id","",(0,r.getStringValidator)()),G(H,"rotation",0,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(H,"scale",["x","y"]),G(H,"scaleX",1,(0,r.getNumberValidator)()),G(H,"scaleY",1,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(H,"skew",["x","y"]),G(H,"skewX",0,(0,r.getNumberValidator)()),G(H,"skewY",0,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(H,"offset",["x","y"]),G(H,"offsetX",0,(0,r.getNumberValidator)()),G(H,"offsetY",0,(0,r.getNumberValidator)()),G(H,"dragDistance",void 0,(0,r.getNumberValidator)()),G(H,"width",0,(0,r.getNumberValidator)()),G(H,"height",0,(0,r.getNumberValidator)()),G(H,"listening",!0,(0,r.getBooleanValidator)()),G(H,"preventDefault",!0,(0,r.getBooleanValidator)()),G(H,"filters",void 0,function(X){return this._filterUpToDate=!1,X}),G(H,"visible",!0,(0,r.getBooleanValidator)()),G(H,"transformsEnabled","all",(0,r.getStringValidator)()),G(H,"size"),G(H,"dragBoundFunc"),G(H,"draggable",!1,(0,r.getBooleanValidator)()),n.Factory.backCompat(H,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Mn}var Fn={},Qa;function ar(){if(Qa)return Fn;Qa=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.Container=void 0;const t=bt(),e=Ot(),n=xt();let i=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(r){const o=this.children||[];return r?o.filter(r):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(r=>{r.parent=null,r.index=0,r.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(r=>{r.parent=null,r.index=0,r.destroy()}),this.children=[],this._requestDraw(),this}add(...r){if(r.length===0)return this;if(r.length>1){for(let a=0;a<r.length;a++)this.add(r[a]);return this}const o=r[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(r){return this._generalFind(r,!1)}findOne(r){const o=this._generalFind(r,!0);return o.length>0?o[0]:void 0}_generalFind(r,o){const a=[];return this._descendants(l=>{const c=l._isMatch(r);return c&&a.push(l),!!(c&&o)}),a}_descendants(r){let o=!1;const a=this.getChildren();for(const l of a){if(o=r(l),o)return!0;if(l.hasChildren()&&(o=l._descendants(r),o))return!0}return!1}toObject(){const r=e.Node.prototype.toObject.call(this);return r.children=[],this.getChildren().forEach(o=>{r.children.push(o.toObject())}),r}isAncestorOf(r){let o=r.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(r){const o=e.Node.prototype.clone.call(this,r);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(r){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(r)&&o.push(a)}),o}_clearSelfAndDescendantCache(r){var o;super._clearSelfAndDescendantCache(r),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(r)}))}_setChildrenIndices(){var r;(r=this.children)===null||r===void 0||r.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(r,o,a){const l=this.getLayer(),c=r||l&&l.getCanvas(),h=c&&c.getContext(),p=this._getCanvasCache(),f=p&&p.scene,u=c&&c.isCache;if(!this.isVisible()&&!u)return this;if(f){h.save();const m=this.getAbsoluteTransform(o).getMatrix();h.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedSceneCanvas(h),h.restore()}else this._drawChildren("drawScene",c,o,a);return this}drawHit(r,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),l=r||a&&a.hitCanvas,c=l&&l.getContext(),h=this._getCanvasCache();if(h&&h.hit){c.save();const f=this.getAbsoluteTransform(o).getMatrix();c.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",l,o);return this}_drawChildren(r,o,a,l){var c;const h=o&&o.getContext(),p=this.clipWidth(),f=this.clipHeight(),u=this.clipFunc(),m=typeof p=="number"&&typeof f=="number"||u,_=a===this;if(m){h.save();const w=this.getAbsoluteTransform(a);let g=w.getMatrix();h.transform(g[0],g[1],g[2],g[3],g[4],g[5]),h.beginPath();let d;if(u)d=u.call(this,h,this);else{const y=this.clipX(),b=this.clipY();h.rect(y||0,b||0,p,f)}h.clip.apply(h,d),g=w.copy().invert().getMatrix(),h.transform(g[0],g[1],g[2],g[3],g[4],g[5])}const S=!_&&this.globalCompositeOperation()!=="source-over"&&r==="drawScene";S&&(h.save(),h._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(w){w[r](o,a,l)}),S&&h.restore(),m&&h.restore()}getClientRect(r={}){var o;const a=r.skipTransform,l=r.relativeTo;let c,h,p,f,u={x:1/0,y:1/0,width:0,height:0};const m=this;(o=this.children)===null||o===void 0||o.forEach(function(w){if(!w.visible())return;const g=w.getClientRect({relativeTo:m,skipShadow:r.skipShadow,skipStroke:r.skipStroke});g.width===0&&g.height===0||(c===void 0?(c=g.x,h=g.y,p=g.x+g.width,f=g.y+g.height):(c=Math.min(c,g.x),h=Math.min(h,g.y),p=Math.max(p,g.x+g.width),f=Math.max(f,g.y+g.height)))});const _=this.find("Shape");let S=!1;for(let w=0;w<_.length;w++)if(_[w]._isVisible(this)){S=!0;break}return S&&c!==void 0?u={x:c,y:h,width:p-c,height:f-h}:u={x:0,y:0,width:0,height:0},a?u:this._transformedRect(u,l)}};return Fn.Container=i,t.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipFunc"),Fn}var ds={},Le={},Za;function tl(){if(Za)return Le;Za=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.getCapturedShape=i,Le.createEvent=s,Le.hasPointerCapture=r,Le.setPointerCapture=o,Le.releaseCapture=a;const t=vt(),e=new Map,n=t.Konva._global.PointerEvent!==void 0;function i(l){return e.get(l)}function s(l){return{evt:l,pointerId:l.pointerId}}function r(l,c){return e.get(l)===c}function o(l,c){a(l),c.getStage()&&(e.set(l,c),n&&c._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function a(l,c){const h=e.get(l);if(!h)return;const p=h.getStage();p&&p.content,e.delete(l),n&&h._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return Le}var el;function Ru(){return el||(el=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Nt(),n=bt(),i=ar(),s=vt(),r=or(),o=cs(),a=vt(),l=tl(),c="Stage",h="string",p="px",f="mouseout",u="mouseleave",m="mouseover",_="mouseenter",S="mousemove",w="mousedown",g="mouseup",d="pointermove",y="pointerdown",b="pointerup",k="pointercancel",D="lostpointercapture",x="pointerout",C="pointerleave",T="pointerover",M="pointerenter",L="contextmenu",I="touchstart",H="touchend",G="touchmove",X="touchcancel",v="wheel",P=5,E=[[_,"_pointerenter"],[w,"_pointerdown"],[S,"_pointermove"],[g,"_pointerup"],[u,"_pointerleave"],[I,"_pointerdown"],[G,"_pointermove"],[H,"_pointerup"],[X,"_pointercancel"],[m,"_pointerover"],[v,"_wheel"],[L,"_contextmenu"],[y,"_pointerdown"],[d,"_pointermove"],[b,"_pointerup"],[k,"_pointercancel"],[C,"_pointerleave"],[D,"_lostpointercapture"]],A={mouse:{[x]:f,[C]:u,[T]:m,[M]:_,[d]:S,[y]:w,[b]:g,[k]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[x]:"touchout",[C]:"touchleave",[T]:"touchover",[M]:"touchenter",[d]:G,[y]:I,[b]:H,[k]:X,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[x]:x,[C]:C,[T]:T,[M]:M,[d]:d,[y]:y,[b]:b,[k]:k,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},O=$=>$.indexOf("pointer")>=0?"pointer":$.indexOf("touch")>=0?"touch":"mouse",j=$=>{const F=O($);if(F==="pointer")return s.Konva.pointerEventsEnabled&&A.pointer;if(F==="touch")return A.touch;if(F==="mouse")return A.mouse};function B($={}){return($.clipFunc||$.clipWidth||$.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),$}const J="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class st extends i.Container{constructor(F){super(B(F)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{B(this.attrs)}),this._checkVisibility()}_validateAdd(F){const W=F.getType()==="Layer",nt=F.getType()==="FastLayer";W||nt||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const F=this.visible()?"":"none";this.content.style.display=F}setContainer(F){if(typeof F===h){let W;if(F.charAt(0)==="."){const nt=F.slice(1);F=document.getElementsByClassName(nt)[0]}else F.charAt(0)!=="#"?W=F:W=F.slice(1),F=document.getElementById(W);if(!F)throw"Can not find container in document with id "+W}return this._setAttr("container",F),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),F.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const F=this.children,W=F.length;for(let nt=0;nt<W;nt++)F[nt].clear();return this}clone(F){return F||(F={}),F.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,F)}destroy(){super.destroy();const F=this.content;F&&e.Util._isInDocument(F)&&this.container().removeChild(F);const W=t.stages.indexOf(this);return W>-1&&t.stages.splice(W,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const F=this._pointerPositions[0]||this._changedPointerPositions[0];return F?{x:F.x,y:F.y}:(e.Util.warn(J),null)}_getPointerById(F){return this._pointerPositions.find(W=>W.id===F)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(F){F=F||{},F.x=F.x||0,F.y=F.y||0,F.width=F.width||this.width(),F.height=F.height||this.height();const W=new r.SceneCanvas({width:F.width,height:F.height,pixelRatio:F.pixelRatio||1}),nt=W.getContext()._context,it=this.children;return(F.x||F.y)&&nt.translate(-1*F.x,-1*F.y),it.forEach(function(ct){if(!ct.isVisible())return;const R=ct._toKonvaCanvas(F);nt.drawImage(R._canvas,F.x,F.y,R.getWidth()/R.getPixelRatio(),R.getHeight()/R.getPixelRatio())}),W}getIntersection(F){if(!F)return null;const W=this.children,nt=W.length,it=nt-1;for(let ct=it;ct>=0;ct--){const R=W[ct].getIntersection(F);if(R)return R}return null}_resizeDOM(){const F=this.width(),W=this.height();this.content&&(this.content.style.width=F+p,this.content.style.height=W+p),this.bufferCanvas.setSize(F,W),this.bufferHitCanvas.setSize(F,W),this.children.forEach(nt=>{nt.setSize({width:F,height:W}),nt.draw()})}add(F,...W){if(arguments.length>1){for(let it=0;it<arguments.length;it++)this.add(arguments[it]);return this}super.add(F);const nt=this.children.length;return nt>P&&e.Util.warn("The stage has "+nt+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),F.setSize({width:this.width(),height:this.height()}),F.draw(),s.Konva.isBrowser&&this.content.appendChild(F.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(F){return l.hasPointerCapture(F,this)}setPointerCapture(F){l.setPointerCapture(F,this)}releaseCapture(F){l.releaseCapture(F,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&E.forEach(([F,W])=>{this.content.addEventListener(F,nt=>{this[W](nt)},{passive:!1})})}_pointerenter(F){this.setPointersPositions(F);const W=j(F.type);W&&this._fire(W.pointerenter,{evt:F,target:this,currentTarget:this})}_pointerover(F){this.setPointersPositions(F);const W=j(F.type);W&&this._fire(W.pointerover,{evt:F,target:this,currentTarget:this})}_getTargetShape(F){let W=this[F+"targetShape"];return W&&!W.getStage()&&(W=null),W}_pointerleave(F){const W=j(F.type),nt=O(F.type);if(!W)return;this.setPointersPositions(F);const it=this._getTargetShape(nt),ct=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;it&&ct?(it._fireAndBubble(W.pointerout,{evt:F}),it._fireAndBubble(W.pointerleave,{evt:F}),this._fire(W.pointerleave,{evt:F,target:this,currentTarget:this}),this[nt+"targetShape"]=null):ct&&(this._fire(W.pointerleave,{evt:F,target:this,currentTarget:this}),this._fire(W.pointerout,{evt:F,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(F){const W=j(F.type),nt=O(F.type);if(!W)return;this.setPointersPositions(F);let it=!1;this._changedPointerPositions.forEach(ct=>{const R=this.getIntersection(ct);if(o.DD.justDragged=!1,s.Konva["_"+nt+"ListenClick"]=!0,!R||!R.isListening()){this[nt+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&R.setPointerCapture(ct.id),this[nt+"ClickStartShape"]=R,R._fireAndBubble(W.pointerdown,{evt:F,pointerId:ct.id}),it=!0;const N=F.type.indexOf("touch")>=0;R.preventDefault()&&F.cancelable&&N&&F.preventDefault()}),it||this._fire(W.pointerdown,{evt:F,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(F){const W=j(F.type),nt=O(F.type);if(!W||(s.Konva.isDragging()&&o.DD.node.preventDefault()&&F.cancelable&&F.preventDefault(),this.setPointersPositions(F),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const ct={};let R=!1;const N=this._getTargetShape(nt);this._changedPointerPositions.forEach(z=>{const q=l.getCapturedShape(z.id)||this.getIntersection(z),Y=z.id,K={evt:F,pointerId:Y},Z=N!==q;if(Z&&N&&(N._fireAndBubble(W.pointerout,{...K},q),N._fireAndBubble(W.pointerleave,{...K},q)),q){if(ct[q._id])return;ct[q._id]=!0}q&&q.isListening()?(R=!0,Z&&(q._fireAndBubble(W.pointerover,{...K},N),q._fireAndBubble(W.pointerenter,{...K},N),this[nt+"targetShape"]=q),q._fireAndBubble(W.pointermove,{...K})):N&&(this._fire(W.pointerover,{evt:F,target:this,currentTarget:this,pointerId:Y}),this[nt+"targetShape"]=null)}),R||this._fire(W.pointermove,{evt:F,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(F){const W=j(F.type),nt=O(F.type);if(!W)return;this.setPointersPositions(F);const it=this[nt+"ClickStartShape"],ct=this[nt+"ClickEndShape"],R={};let N=!1;this._changedPointerPositions.forEach(z=>{const q=l.getCapturedShape(z.id)||this.getIntersection(z);if(q){if(q.releaseCapture(z.id),R[q._id])return;R[q._id]=!0}const Y=z.id,K={evt:F,pointerId:Y};let Z=!1;s.Konva["_"+nt+"InDblClickWindow"]?(Z=!0,clearTimeout(this[nt+"DblTimeout"])):o.DD.justDragged||(s.Konva["_"+nt+"InDblClickWindow"]=!0,clearTimeout(this[nt+"DblTimeout"])),this[nt+"DblTimeout"]=setTimeout(function(){s.Konva["_"+nt+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),q&&q.isListening()?(N=!0,this[nt+"ClickEndShape"]=q,q._fireAndBubble(W.pointerup,{...K}),s.Konva["_"+nt+"ListenClick"]&&it&&it===q&&(q._fireAndBubble(W.pointerclick,{...K}),Z&&ct&&ct===q&&q._fireAndBubble(W.pointerdblclick,{...K}))):(this[nt+"ClickEndShape"]=null,s.Konva["_"+nt+"ListenClick"]&&this._fire(W.pointerclick,{evt:F,target:this,currentTarget:this,pointerId:Y}),Z&&this._fire(W.pointerdblclick,{evt:F,target:this,currentTarget:this,pointerId:Y}))}),N||this._fire(W.pointerup,{evt:F,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+nt+"ListenClick"]=!1,F.cancelable&&nt!=="touch"&&nt!=="pointer"&&F.preventDefault()}_contextmenu(F){this.setPointersPositions(F);const W=this.getIntersection(this.getPointerPosition());W&&W.isListening()?W._fireAndBubble(L,{evt:F}):this._fire(L,{evt:F,target:this,currentTarget:this})}_wheel(F){this.setPointersPositions(F);const W=this.getIntersection(this.getPointerPosition());W&&W.isListening()?W._fireAndBubble(v,{evt:F}):this._fire(v,{evt:F,target:this,currentTarget:this})}_pointercancel(F){this.setPointersPositions(F);const W=l.getCapturedShape(F.pointerId)||this.getIntersection(this.getPointerPosition());W&&W._fireAndBubble(b,l.createEvent(F)),l.releaseCapture(F.pointerId)}_lostpointercapture(F){l.releaseCapture(F.pointerId)}setPointersPositions(F){const W=this._getContentPosition();let nt=null,it=null;F=F||window.event,F.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(F.touches,ct=>{this._pointerPositions.push({id:ct.identifier,x:(ct.clientX-W.left)/W.scaleX,y:(ct.clientY-W.top)/W.scaleY})}),Array.prototype.forEach.call(F.changedTouches||F.touches,ct=>{this._changedPointerPositions.push({id:ct.identifier,x:(ct.clientX-W.left)/W.scaleX,y:(ct.clientY-W.top)/W.scaleY})})):(nt=(F.clientX-W.left)/W.scaleX,it=(F.clientY-W.top)/W.scaleY,this.pointerPos={x:nt,y:it},this._pointerPositions=[{x:nt,y:it,id:e.Util._getFirstPointerId(F)}],this._changedPointerPositions=[{x:nt,y:it,id:e.Util._getFirstPointerId(F)}])}_setPointerPosition(F){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(F)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const F=this.content.getBoundingClientRect();return{top:F.top,left:F.left,scaleX:F.width/this.content.clientWidth||1,scaleY:F.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new r.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new r.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const F=this.container();if(!F)throw"Stage has no container. A container is required.";F.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),F.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(F){F.batchDraw()}),this}}t.Stage=st,st.prototype.nodeType=c,(0,a._registerNode)(st),n.Factory.addGetterSetter(st,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach($=>{$.batchDraw()})})}(ds)),ds}var Dn={},us={},nl;function Bt(){return nl||(nl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=vt(),n=Nt(),i=bt(),s=Ot(),r=xt(),o=vt(),a=tl(),l="hasShadow",c="shadowRGBA",h="patternImage",p="linearGradient",f="radialGradient";let u;function m(){return u||(u=n.Util.createCanvasElement().getContext("2d"),u)}t.shapes={};function _(C){const T=this.attrs.fillRule;T?C.fill(T):C.fill()}function S(C){C.stroke()}function w(C){const T=this.attrs.fillRule;T?C.fill(T):C.fill()}function g(C){C.stroke()}function d(){this._clearCache(l)}function y(){this._clearCache(c)}function b(){this._clearCache(h)}function k(){this._clearCache(p)}function D(){this._clearCache(f)}class x extends s.Node{constructor(T){super(T);let M;for(;M=n.Util.getRandomColor(),!(M&&!(M in t.shapes)););this.colorKey=M,t.shapes[M]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const M=m().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(M&&M.setTransform){const L=new n.Transform;L.translate(this.fillPatternX(),this.fillPatternY()),L.rotate(e.Konva.getAngle(this.fillPatternRotation())),L.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),L.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const I=L.getMatrix(),H=typeof DOMMatrix>"u"?{a:I[0],b:I[1],c:I[2],d:I[3],e:I[4],f:I[5]}:new DOMMatrix(I);M.setTransform(H)}return M}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const T=this.fillLinearGradientColorStops();if(T){const M=m(),L=this.fillLinearGradientStartPoint(),I=this.fillLinearGradientEndPoint(),H=M.createLinearGradient(L.x,L.y,I.x,I.y);for(let G=0;G<T.length;G+=2)H.addColorStop(T[G],T[G+1]);return H}}_getRadialGradient(){return this._getCache(f,this.__getRadialGradient)}__getRadialGradient(){const T=this.fillRadialGradientColorStops();if(T){const M=m(),L=this.fillRadialGradientStartPoint(),I=this.fillRadialGradientEndPoint(),H=M.createRadialGradient(L.x,L.y,this.fillRadialGradientStartRadius(),I.x,I.y,this.fillRadialGradientEndRadius());for(let G=0;G<T.length;G+=2)H.addColorStop(T[G],T[G+1]);return H}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const T=n.Util.colorToRGBA(this.shadowColor());if(T)return"rgba("+T.r+","+T.g+","+T.b+","+T.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const T=this.hitStrokeWidth();return T==="auto"?this.hasStroke():this.strokeEnabled()&&!!T}intersects(T){const M=this.getStage();if(!M)return!1;const L=M.bufferHitCanvas;return L.getContext().clear(),this.drawHit(L,void 0,!0),L.context.getImageData(Math.round(T.x),Math.round(T.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(T){var M;if(!((M=this.attrs.perfectDrawEnabled)!==null&&M!==void 0?M:!0))return!1;const I=T||this.hasFill(),H=this.hasStroke(),G=this.getAbsoluteOpacity()!==1;if(I&&H&&G)return!0;const X=this.hasShadow(),v=this.shadowForStrokeEnabled();return!!(I&&H&&X&&v)}setStrokeHitEnabled(T){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),T?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const T=this.size();return{x:this._centroid?-T.width/2:0,y:this._centroid?-T.height/2:0,width:T.width,height:T.height}}getClientRect(T={}){let M=!1,L=this.getParent();for(;L;){if(L.isCached()){M=!0;break}L=L.getParent()}const I=T.skipTransform,H=T.relativeTo||M&&this.getStage()||void 0,G=this.getSelfRect(),v=!T.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,P=G.width+v,E=G.height+v,A=!T.skipShadow&&this.hasShadow(),O=A?this.shadowOffsetX():0,j=A?this.shadowOffsetY():0,B=P+Math.abs(O),J=E+Math.abs(j),st=A&&this.shadowBlur()||0,$=B+st*2,F=J+st*2,W={width:$,height:F,x:-(v/2+st)+Math.min(O,0)+G.x,y:-(v/2+st)+Math.min(j,0)+G.y};return I?W:this._transformedRect(W,H)}drawScene(T,M,L){const I=this.getLayer(),H=T||I.getCanvas(),G=H.getContext(),X=this._getCanvasCache(),v=this.getSceneFunc(),P=this.hasShadow();let E;const A=M===this;if(!this.isVisible()&&!A)return this;if(X){G.save();const O=this.getAbsoluteTransform(M).getMatrix();return G.transform(O[0],O[1],O[2],O[3],O[4],O[5]),this._drawCachedSceneCanvas(G),G.restore(),this}if(!v)return this;if(G.save(),this._useBufferCanvas()){E=this.getStage();const O=L||E.bufferCanvas,j=O.getContext();j.clear(),j.save(),j._applyLineJoin(this);const B=this.getAbsoluteTransform(M).getMatrix();j.transform(B[0],B[1],B[2],B[3],B[4],B[5]),v.call(this,j,this),j.restore();const J=O.pixelRatio;P&&G._applyShadow(this),G._applyOpacity(this),G._applyGlobalCompositeOperation(this),G.drawImage(O._canvas,O.x||0,O.y||0,O.width/J,O.height/J)}else{if(G._applyLineJoin(this),!A){const O=this.getAbsoluteTransform(M).getMatrix();G.transform(O[0],O[1],O[2],O[3],O[4],O[5]),G._applyOpacity(this),G._applyGlobalCompositeOperation(this)}P&&G._applyShadow(this),v.call(this,G,this)}return G.restore(),this}drawHit(T,M,L=!1){if(!this.shouldDrawHit(M,L))return this;const I=this.getLayer(),H=T||I.hitCanvas,G=H&&H.getContext(),X=this.hitFunc()||this.sceneFunc(),v=this._getCanvasCache(),P=v&&v.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),P){G.save();const A=this.getAbsoluteTransform(M).getMatrix();return G.transform(A[0],A[1],A[2],A[3],A[4],A[5]),this._drawCachedHitCanvas(G),G.restore(),this}if(!X)return this;if(G.save(),G._applyLineJoin(this),!(this===M)){const A=this.getAbsoluteTransform(M).getMatrix();G.transform(A[0],A[1],A[2],A[3],A[4],A[5])}return X.call(this,G,this),G.restore(),this}drawHitFromCache(T=0){const M=this._getCanvasCache(),L=this._getCachedSceneCanvas(),I=M.hit,H=I.getContext(),G=I.getWidth(),X=I.getHeight();H.clear(),H.drawImage(L._canvas,0,0,G,X);try{const v=H.getImageData(0,0,G,X),P=v.data,E=P.length,A=n.Util._hexToRgb(this.colorKey);for(let O=0;O<E;O+=4)P[O+3]>T?(P[O]=A.r,P[O+1]=A.g,P[O+2]=A.b,P[O+3]=255):P[O+3]=0;H.putImageData(v,0,0)}catch(v){n.Util.error("Unable to draw hit graph from cached scene canvas. "+v.message)}return this}hasPointerCapture(T){return a.hasPointerCapture(T,this)}setPointerCapture(T){a.setPointerCapture(T,this)}releaseCapture(T){a.releaseCapture(T,this)}}t.Shape=x,x.prototype._fillFunc=_,x.prototype._strokeFunc=S,x.prototype._fillFuncHit=w,x.prototype._strokeFuncHit=g,x.prototype._centroid=!1,x.prototype.nodeType="Shape",(0,o._registerNode)(x),x.prototype.eventListeners={},x.prototype.on.call(x.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",d),x.prototype.on.call(x.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",b),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",k),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",D),i.Factory.addGetterSetter(x,"stroke",void 0,(0,r.getStringOrGradientValidator)()),i.Factory.addGetterSetter(x,"strokeWidth",2,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(x,"hitStrokeWidth","auto",(0,r.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(x,"strokeHitEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"perfectDrawEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"shadowForStrokeEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"lineJoin"),i.Factory.addGetterSetter(x,"lineCap"),i.Factory.addGetterSetter(x,"sceneFunc"),i.Factory.addGetterSetter(x,"hitFunc"),i.Factory.addGetterSetter(x,"dash"),i.Factory.addGetterSetter(x,"dashOffset",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowColor",void 0,(0,r.getStringValidator)()),i.Factory.addGetterSetter(x,"shadowBlur",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowOpacity",1,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(x,"shadowOffsetX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowOffsetY",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternImage"),i.Factory.addGetterSetter(x,"fill",void 0,(0,r.getStringOrGradientValidator)()),i.Factory.addGetterSetter(x,"fillPatternX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternY",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(x,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(x,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(x,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(x,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(x,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(x,"fillEnabled",!0),i.Factory.addGetterSetter(x,"strokeEnabled",!0),i.Factory.addGetterSetter(x,"shadowEnabled",!0),i.Factory.addGetterSetter(x,"dashEnabled",!0),i.Factory.addGetterSetter(x,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(x,"fillPriority","color"),i.Factory.addComponentsGetterSetter(x,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(x,"fillPatternOffsetX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternOffsetY",0,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(x,"fillPatternScaleX",1,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternScaleY",1,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(x,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(x,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(x,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(x,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(x,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(x,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(x,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(x,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(x,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(x,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(x,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(x,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(x,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(x,"fillPatternRotation",0),i.Factory.addGetterSetter(x,"fillRule",void 0,(0,r.getStringValidator)()),i.Factory.backCompat(x,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(us)),us}var il;function rl(){if(il)return Dn;il=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.Layer=void 0;const t=Nt(),e=ar(),n=Ot(),i=bt(),s=or(),r=xt(),o=Bt(),a=vt(),l="#",c="beforeDraw",h="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],f=p.length;let u=class extends e.Container{constructor(_){super(_),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(_){return this.getContext().clear(_),this.getHitCanvas().getContext().clear(_),this}setZIndex(_){super.setZIndex(_);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),_<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[_+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);const _=this.getStage();return _&&_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!n.Node.prototype.moveUp.call(this))return!1;const S=this.getStage();return!S||!S.content?!1:(S.content.removeChild(this.getNativeCanvasElement()),this.index<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[this.index+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){const _=this.getStage();if(_){const S=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),S[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){const _=this.getStage();if(_){const S=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),S[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const _=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),_&&_.parentNode&&t.Util._isInDocument(_)&&_.parentNode.removeChild(_),this}getStage(){return this.parent}setSize({width:_,height:S}){return this.canvas.setSize(_,S),this.hitCanvas.setSize(_,S),this._setSmoothEnabled(),this}_validateAdd(_){const S=_.getType();S!=="Group"&&S!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(_){return _=_||{},_.width=_.width||this.getWidth(),_.height=_.height||this.getHeight(),_.x=_.x!==void 0?_.x:this.x(),_.y=_.y!==void 0?_.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,_)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(_){if(!this.isListening()||!this.isVisible())return null;let S=1,w=!1;for(;;){for(let g=0;g<f;g++){const d=p[g],y=this._getIntersection({x:_.x+d.x*S,y:_.y+d.y*S}),b=y.shape;if(b)return b;if(w=!!y.antialiased,!y.antialiased)break}if(w)S+=1;else return null}}_getIntersection(_){const S=this.hitCanvas.pixelRatio,w=this.hitCanvas.context.getImageData(Math.round(_.x*S),Math.round(_.y*S),1,1).data,g=w[3];if(g===255){const d=t.Util._rgbToHex(w[0],w[1],w[2]),y=o.shapes[l+d];return y?{shape:y}:{antialiased:!0}}else if(g>0)return{antialiased:!0};return{}}drawScene(_,S,w){const g=this.getLayer(),d=_||g&&g.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&d.getContext().clear(),e.Container.prototype.drawScene.call(this,d,S,w),this._fire(h,{node:this}),this}drawHit(_,S){const w=this.getLayer(),g=_||w&&w.hitCanvas;return w&&w.clearBeforeDraw()&&w.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,g,S),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(_){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(_)}getHitGraphEnabled(_){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const _=this.parent;!!this.hitCanvas._canvas.parentNode?_.content.removeChild(this.hitCanvas._canvas):_.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return Dn.Layer=u,u.prototype.nodeType="Layer",(0,a._registerNode)(u),i.Factory.addGetterSetter(u,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(u,"clearBeforeDraw",!0),i.Factory.addGetterSetter(u,"hitGraphEnabled",!0,(0,r.getBooleanValidator)()),Dn}var Nn={},sl;function Eu(){if(sl)return Nn;sl=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.FastLayer=void 0;const t=Nt(),e=rl(),n=vt();let i=class extends e.Layer{constructor(r){super(r),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return Nn.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),Nn}var On={},ol;function fs(){if(ol)return On;ol=1,Object.defineProperty(On,"__esModule",{value:!0}),On.Group=void 0;const t=Nt(),e=ar(),n=vt();let i=class extends e.Container{_validateAdd(r){const o=r.getType();o!=="Group"&&o!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return On.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),On}var Ln={},al;function gs(){if(al)return Ln;al=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.Animation=void 0;const t=vt(),e=Nt(),n=function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}}();let i=class un{constructor(r,o){this.id=un.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=r,this.setLayers(o)}setLayers(r){let o=[];return r&&(o=Array.isArray(r)?r:[r]),this.layers=o,this}getLayers(){return this.layers}addLayer(r){const o=this.layers,a=o.length;for(let l=0;l<a;l++)if(o[l]._id===r._id)return!1;return this.layers.push(r),!0}isRunning(){const o=un.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),un._addAnimation(this),this}stop(){return un._removeAnimation(this),this}_updateFrameObject(r){this.frame.timeDiff=r-this.frame.lastTime,this.frame.lastTime=r,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(r){this.animations.push(r),this._handleAnimation()}static _removeAnimation(r){const o=r.id,a=this.animations,l=a.length;for(let c=0;c<l;c++)if(a[c].id===o){this.animations.splice(c,1);break}}static _runFrames(){const r={},o=this.animations;for(let a=0;a<o.length;a++){const l=o[a],c=l.layers,h=l.func;l._updateFrameObject(n());const p=c.length;let f;if(h?f=h.call(l,l.frame)!==!1:f=!0,!!f)for(let u=0;u<p;u++){const m=c[u];m._id!==void 0&&(r[m._id]=m)}}for(const a in r)r.hasOwnProperty(a)&&r[a].batchDraw()}static _animationLoop(){const r=un;r.animations.length?(r._runFrames(),e.Util.requestAnimFrame(r._animationLoop)):r.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return Ln.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,Ln}var ps={},ll;function Mu(){return ll||(ll=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Nt(),n=gs(),i=Ot(),s=vt(),r={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,l=3,c=["fill","stroke","shadowColor"];let h=0;class p{constructor(m,_,S,w,g,d,y){this.prop=m,this.propFunc=_,this.begin=w,this._pos=w,this.duration=d,this._change=0,this.prevPos=0,this.yoyo=y,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=S,this._change=g-this.begin,this.pause()}fire(m){const _=this[m];_&&_()}setTime(m){m>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():m<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=m,this.update())}getTime(){return this._time}setPosition(m){this.prevPos=this._pos,this.propFunc(m),this._pos=m}getPosition(m){return m===void 0&&(m=this._time),this.func(m,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(m){this.pause(),this._time=m,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const m=this.getTimer()-this._startTime;this.state===a?this.setTime(m):this.state===l&&this.setTime(this.duration-m)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class f{constructor(m){const _=this,S=m.node,w=S._id,g=m.easing||t.Easings.Linear,d=!!m.yoyo;let y,b;typeof m.duration>"u"?y=.3:m.duration===0?y=.001:y=m.duration,this.node=S,this._id=h++;const k=S.getLayer()||(S instanceof s.Konva.Stage?S.getLayers():null);k||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){_.tween.onEnterFrame()},k),this.tween=new p(b,function(D){_._tweenFunc(D)},g,0,1,y*1e3,d),this._addListeners(),f.attrs[w]||(f.attrs[w]={}),f.attrs[w][this._id]||(f.attrs[w][this._id]={}),f.tweens[w]||(f.tweens[w]={});for(b in m)r[b]===void 0&&this._addAttr(b,m[b]);this.reset(),this.onFinish=m.onFinish,this.onReset=m.onReset,this.onUpdate=m.onUpdate}_addAttr(m,_){const S=this.node,w=S._id;let g,d,y,b,k;const D=f.tweens[w][m];D&&delete f.attrs[w][D][m];let x=S.getAttr(m);if(e.Util._isArray(_))if(g=[],d=Math.max(_.length,x.length),m==="points"&&_.length!==x.length&&(_.length>x.length?(b=x,x=e.Util._prepareArrayForTween(x,_,S.closed())):(y=_,_=e.Util._prepareArrayForTween(_,x,S.closed()))),m.indexOf("fill")===0)for(let C=0;C<d;C++)if(C%2===0)g.push(_[C]-x[C]);else{const T=e.Util.colorToRGBA(x[C]);k=e.Util.colorToRGBA(_[C]),x[C]=T,g.push({r:k.r-T.r,g:k.g-T.g,b:k.b-T.b,a:k.a-T.a})}else for(let C=0;C<d;C++)g.push(_[C]-x[C]);else c.indexOf(m)!==-1?(x=e.Util.colorToRGBA(x),k=e.Util.colorToRGBA(_),g={r:k.r-x.r,g:k.g-x.g,b:k.b-x.b,a:k.a-x.a}):g=_-x;f.attrs[w][this._id][m]={start:x,diff:g,end:_,trueEnd:y,trueStart:b},f.tweens[w][m]=this._id}_tweenFunc(m){const _=this.node,S=f.attrs[_._id][this._id];let w,g,d,y,b,k,D,x;for(w in S){if(g=S[w],d=g.start,y=g.diff,x=g.end,e.Util._isArray(d))if(b=[],D=Math.max(d.length,x.length),w.indexOf("fill")===0)for(k=0;k<D;k++)k%2===0?b.push((d[k]||0)+y[k]*m):b.push("rgba("+Math.round(d[k].r+y[k].r*m)+","+Math.round(d[k].g+y[k].g*m)+","+Math.round(d[k].b+y[k].b*m)+","+(d[k].a+y[k].a*m)+")");else for(k=0;k<D;k++)b.push((d[k]||0)+y[k]*m);else c.indexOf(w)!==-1?b="rgba("+Math.round(d.r+y.r*m)+","+Math.round(d.g+y.g*m)+","+Math.round(d.b+y.b*m)+","+(d.a+y.a*m)+")":b=d+y*m;_.setAttr(w,b)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const m=this.node,_=f.attrs[m._id][this._id];_.points&&_.points.trueEnd&&m.setAttr("points",_.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const m=this.node,_=f.attrs[m._id][this._id];_.points&&_.points.trueStart&&m.points(_.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(m){return this.tween.seek(m*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const m=this.node._id,_=this._id,S=f.tweens[m];this.pause(),this.anim&&this.anim.stop();for(const w in S)delete f.tweens[m][w];delete f.attrs[m][_],Object.keys(f.tweens[m]).length===0&&delete f.tweens[m],Object.keys(f.attrs[m]).length===0&&delete f.attrs[m]}}t.Tween=f,f.attrs={},f.tweens={},i.Node.prototype.to=function(u){const m=u.onFinish;u.node=this,u.onFinish=function(){this.destroy(),m&&m()},new f(u).play()},t.Easings={BackEaseIn(u,m,_,S){return _*(u/=S)*u*(2.70158*u-1.70158)+m},BackEaseOut(u,m,_,S){return _*((u=u/S-1)*u*(2.70158*u+1.70158)+1)+m},BackEaseInOut(u,m,_,S){let w=1.70158;return(u/=S/2)<1?_/2*(u*u*(((w*=1.525)+1)*u-w))+m:_/2*((u-=2)*u*(((w*=1.525)+1)*u+w)+2)+m},ElasticEaseIn(u,m,_,S,w,g){let d=0;return u===0?m:(u/=S)===1?m+_:(g||(g=S*.3),!w||w<Math.abs(_)?(w=_,d=g/4):d=g/(2*Math.PI)*Math.asin(_/w),-(w*Math.pow(2,10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/g))+m)},ElasticEaseOut(u,m,_,S,w,g){let d=0;return u===0?m:(u/=S)===1?m+_:(g||(g=S*.3),!w||w<Math.abs(_)?(w=_,d=g/4):d=g/(2*Math.PI)*Math.asin(_/w),w*Math.pow(2,-10*u)*Math.sin((u*S-d)*(2*Math.PI)/g)+_+m)},ElasticEaseInOut(u,m,_,S,w,g){let d=0;return u===0?m:(u/=S/2)===2?m+_:(g||(g=S*.44999999999999996),!w||w<Math.abs(_)?(w=_,d=g/4):d=g/(2*Math.PI)*Math.asin(_/w),u<1?-.5*(w*Math.pow(2,10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/g))+m:w*Math.pow(2,-10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/g)*.5+_+m)},BounceEaseOut(u,m,_,S){return(u/=S)<.36363636363636365?_*(7.5625*u*u)+m:u<.7272727272727273?_*(7.5625*(u-=.5454545454545454)*u+.75)+m:u<.9090909090909091?_*(7.5625*(u-=.8181818181818182)*u+.9375)+m:_*(7.5625*(u-=.9545454545454546)*u+.984375)+m},BounceEaseIn(u,m,_,S){return _-t.Easings.BounceEaseOut(S-u,0,_,S)+m},BounceEaseInOut(u,m,_,S){return u<S/2?t.Easings.BounceEaseIn(u*2,0,_,S)*.5+m:t.Easings.BounceEaseOut(u*2-S,0,_,S)*.5+_*.5+m},EaseIn(u,m,_,S){return _*(u/=S)*u+m},EaseOut(u,m,_,S){return-_*(u/=S)*(u-2)+m},EaseInOut(u,m,_,S){return(u/=S/2)<1?_/2*u*u+m:-_/2*(--u*(u-2)-1)+m},StrongEaseIn(u,m,_,S){return _*(u/=S)*u*u*u*u+m},StrongEaseOut(u,m,_,S){return _*((u=u/S-1)*u*u*u*u+1)+m},StrongEaseInOut(u,m,_,S){return(u/=S/2)<1?_/2*u*u*u*u*u+m:_/2*((u-=2)*u*u*u*u+2)+m},Linear(u,m,_,S){return _*u/S+m}}}(ps)),ps}var cl;function Fu(){return cl||(cl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=vt(),n=Nt(),i=Ot(),s=ar(),r=Ru(),o=rl(),a=Eu(),l=fs(),c=cs(),h=Bt(),p=gs(),f=Mu(),u=ja(),m=or();t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:s.Container,Stage:r.Stage,stages:r.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:c.DD,Shape:h.Shape,shapes:h.shapes,Animation:p.Animation,Tween:f.Tween,Easings:f.Easings,Context:u.Context,Canvas:m.Canvas}),t.default=t.Konva}(ss)),ss}var Gn={},hl;function Du(){if(hl)return Gn;hl=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.Arc=void 0;const t=bt(),e=Bt(),n=vt(),i=xt(),s=vt();let r=class extends e.Shape{_sceneFunc(a){const l=n.Konva.getAngle(this.angle()),c=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,c),a.arc(0,0,this.innerRadius(),l,0,!c),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),c=this.clockwise(),h=n.Konva.getAngle(c?360-this.angle():this.angle()),p=Math.cos(Math.min(h,Math.PI)),f=1,u=Math.sin(Math.min(Math.max(Math.PI,h),3*Math.PI/2)),m=Math.sin(Math.min(h,Math.PI/2)),_=p*(p>0?a:l),S=f*l,w=u*(u>0?a:l),g=m*(m>0?l:a);return{x:_,y:c?-1*g:w,width:S-_,height:g-w}}};return Gn.Arc=r,r.prototype._centroid=!0,r.prototype.className="Arc",r.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clockwise",!1,(0,i.getBooleanValidator)()),Gn}var In={},Un={},dl;function ul(){if(dl)return Un;dl=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.Line=void 0;const t=bt(),e=vt(),n=Bt(),i=xt();function s(a,l,c,h,p,f,u){const m=Math.sqrt(Math.pow(c-a,2)+Math.pow(h-l,2)),_=Math.sqrt(Math.pow(p-c,2)+Math.pow(f-h,2)),S=u*m/(m+_),w=u*_/(m+_),g=c-S*(p-a),d=h-S*(f-l),y=c+w*(p-a),b=h+w*(f-l);return[g,d,y,b]}function r(a,l){const c=a.length,h=[];for(let p=2;p<c-2;p+=2){const f=s(a[p-2],a[p-1],a[p],a[p+1],a[p+2],a[p+3],l);isNaN(f[0])||(h.push(f[0]),h.push(f[1]),h.push(a[p]),h.push(a[p+1]),h.push(f[2]),h.push(f[3]))}return h}let o=class extends n.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const c=this.points(),h=c.length,p=this.tension(),f=this.closed(),u=this.bezier();if(!h)return;let m=0;if(l.beginPath(),l.moveTo(c[0],c[1]),p!==0&&h>4){const _=this.getTensionPoints(),S=_.length;for(m=f?0:4,f||l.quadraticCurveTo(_[0],_[1],_[2],_[3]);m<S-2;)l.bezierCurveTo(_[m++],_[m++],_[m++],_[m++],_[m++],_[m++]);f||l.quadraticCurveTo(_[S-2],_[S-1],c[h-2],c[h-1])}else if(u)for(m=2;m<h;)l.bezierCurveTo(c[m++],c[m++],c[m++],c[m++],c[m++],c[m++]);else for(m=2;m<h;m+=2)l.lineTo(c[m],c[m+1]);f?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():r(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),c=l.length,h=this.tension(),p=s(l[c-2],l[c-1],l[0],l[1],l[2],l[3],h),f=s(l[c-4],l[c-3],l[c-2],l[c-1],l[0],l[1],h),u=r(l,h);return[p[2],p[3]].concat(u).concat([f[0],f[1],l[c-2],l[c-1],f[2],f[3],p[0],p[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let c=l[0],h=l[0],p=l[1],f=l[1],u,m;for(let _=0;_<l.length/2;_++)u=l[_*2],m=l[_*2+1],c=Math.min(c,u),h=Math.max(h,u),p=Math.min(p,m),f=Math.max(f,m);return{x:c,y:p,width:h-c,height:f-p}}};return Un.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),t.Factory.addGetterSetter(o,"closed",!1),t.Factory.addGetterSetter(o,"bezier",!1),t.Factory.addGetterSetter(o,"tension",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,"points",[],(0,i.getNumberArrayValidator)()),Un}var Bn={},ms={},fl;function Nu(){return fl||(fl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,l)=>{let c,h;const f=l/2;c=0;for(let u=0;u<20;u++)h=f*t.tValues[20][u]+f,c+=t.cValues[20][u]*i(o,a,h);return f*c};t.getCubicArcLength=e;const n=(o,a,l)=>{l===void 0&&(l=1);const c=o[0]-2*o[1]+o[2],h=a[0]-2*a[1]+a[2],p=2*o[1]-2*o[0],f=2*a[1]-2*a[0],u=4*(c*c+h*h),m=4*(c*p+h*f),_=p*p+f*f;if(u===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const S=m/(2*u),w=_/u,g=l+S,d=w-S*S,y=g*g+d>0?Math.sqrt(g*g+d):0,b=S*S+d>0?Math.sqrt(S*S+d):0,k=S+Math.sqrt(S*S+d)!==0?d*Math.log(Math.abs((g+y)/(S+b))):0;return Math.sqrt(u)/2*(g*y-S*b+k)};t.getQuadraticArcLength=n;function i(o,a,l){const c=s(1,l,o),h=s(1,l,a),p=c*c+h*h;return Math.sqrt(p)}const s=(o,a,l)=>{const c=l.length-1;let h,p;if(c===0)return 0;if(o===0){p=0;for(let f=0;f<=c;f++)p+=t.binomialCoefficients[c][f]*Math.pow(1-a,c-f)*Math.pow(a,f)*l[f];return p}else{h=new Array(c);for(let f=0;f<c;f++)h[f]=c*(l[f+1]-l[f]);return s(o-1,a,h)}},r=(o,a,l)=>{let c=1,h=o/a,p=(o-l(h))/a,f=0;for(;c>.001;){const u=l(h+p),m=Math.abs(o-u)/a;if(m<c)c=m,h+=p;else{const _=l(h-p),S=Math.abs(o-_)/a;S<c?(c=S,h-=p):p/=2}if(f++,f>500)break}return h};t.t2length=r}(ms)),ms}var gl;function ys(){if(gl)return Bn;gl=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.Path=void 0;const t=bt(),e=vt(),n=Bt(),i=Nu();let s=class Qt extends n.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Qt.parsePathData(this.data()),this.pathLength=Qt.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let l=!1;for(let c=0;c<a.length;c++){const h=a[c].command,p=a[c].points;switch(h){case"L":o.lineTo(p[0],p[1]);break;case"M":o.moveTo(p[0],p[1]);break;case"C":o.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":o.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":const f=p[0],u=p[1],m=p[2],_=p[3],S=p[4],w=p[5],g=p[6],d=p[7],y=m>_?m:_,b=m>_?1:m/_,k=m>_?_/m:1;o.translate(f,u),o.rotate(g),o.scale(b,k),o.arc(0,0,y,S,S+w,1-d),o.scale(1/b,1/k),o.rotate(-g),o.translate(-f,-u);break;case"z":l=!0,o.closePath();break}}!l&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(u){if(u.command==="A"){const m=u.points[4],_=u.points[5],S=u.points[4]+_;let w=Math.PI/180;if(Math.abs(m-S)<w&&(w=Math.abs(m-S)),_<0)for(let g=m-w;g>S;g-=w){const d=Qt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);o.push(d.x,d.y)}else for(let g=m+w;g<S;g+=w){const d=Qt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);o.push(d.x,d.y)}}else if(u.command==="C")for(let m=0;m<=1;m+=.01){const _=Qt.getPointOnCubicBezier(m,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);o.push(_.x,_.y)}else o=o.concat(u.points)});let a=o[0],l=o[0],c=o[1],h=o[1],p,f;for(let u=0;u<o.length/2;u++)p=o[u*2],f=o[u*2+1],isNaN(p)||(a=Math.min(a,p),l=Math.max(l,p)),isNaN(f)||(c=Math.min(c,f),h=Math.max(h,f));return{x:a,y:c,width:l-a,height:h-c}}getLength(){return this.pathLength}getPointAtLength(o){return Qt.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,l,c){return Math.sqrt((l-o)*(l-o)+(c-a)*(c-a))}static getPathLength(o){let a=0;for(let l=0;l<o.length;++l)a+=o[l].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let l,c=0,h=a.length;if(!h)return null;for(;c<h&&o>a[c].pathLength;)o-=a[c].pathLength,++c;if(c===h)return l=a[c-1].points.slice(-2),{x:l[0],y:l[1]};if(o<.01)return a[c].command==="M"?(l=a[c].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[c].start.x,y:a[c].start.y};const p=a[c],f=p.points;switch(p.command){case"L":return Qt.getPointOnLine(o,p.start.x,p.start.y,f[0],f[1]);case"C":return Qt.getPointOnCubicBezier((0,i.t2length)(o,Qt.getPathLength(a),y=>(0,i.getCubicArcLength)([p.start.x,f[0],f[2],f[4]],[p.start.y,f[1],f[3],f[5]],y)),p.start.x,p.start.y,f[0],f[1],f[2],f[3],f[4],f[5]);case"Q":return Qt.getPointOnQuadraticBezier((0,i.t2length)(o,Qt.getPathLength(a),y=>(0,i.getQuadraticArcLength)([p.start.x,f[0],f[2]],[p.start.y,f[1],f[3]],y)),p.start.x,p.start.y,f[0],f[1],f[2],f[3]);case"A":const u=f[0],m=f[1],_=f[2],S=f[3],w=f[5],g=f[6];let d=f[4];return d+=w*o/p.pathLength,Qt.getPointOnEllipticalArc(u,m,_,S,d,g)}return null}static getPointOnLine(o,a,l,c,h,p,f){p=p??a,f=f??l;const u=this.getLineLength(a,l,c,h);if(u<1e-10)return{x:a,y:l};if(c===a)return{x:p,y:f+(h>l?o:-o)};const m=(h-l)/(c-a),_=Math.sqrt(o*o/(1+m*m))*(c<a?-1:1),S=m*_;if(Math.abs(f-l-m*(p-a))<1e-10)return{x:p+_,y:f+S};const w=((p-a)*(c-a)+(f-l)*(h-l))/(u*u),g=a+w*(c-a),d=l+w*(h-l),y=this.getLineLength(p,f,g,d),b=Math.sqrt(o*o-y*y),k=Math.sqrt(b*b/(1+m*m))*(c<a?-1:1),D=m*k;return{x:g+k,y:d+D}}static getPointOnCubicBezier(o,a,l,c,h,p,f,u,m){function _(b){return b*b*b}function S(b){return 3*b*b*(1-b)}function w(b){return 3*b*(1-b)*(1-b)}function g(b){return(1-b)*(1-b)*(1-b)}const d=u*_(o)+p*S(o)+c*w(o)+a*g(o),y=m*_(o)+f*S(o)+h*w(o)+l*g(o);return{x:d,y}}static getPointOnQuadraticBezier(o,a,l,c,h,p,f){function u(g){return g*g}function m(g){return 2*g*(1-g)}function _(g){return(1-g)*(1-g)}const S=p*u(o)+c*m(o)+a*_(o),w=f*u(o)+h*m(o)+l*_(o);return{x:S,y:w}}static getPointOnEllipticalArc(o,a,l,c,h,p){const f=Math.cos(p),u=Math.sin(p),m={x:l*Math.cos(h),y:c*Math.sin(h)};return{x:o+(m.x*f-m.y*u),y:a+(m.x*u+m.y*f)}}static parsePathData(o){if(!o)return[];let a=o;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let S=0;S<l.length;S++)a=a.replace(new RegExp(l[S],"g"),"|"+l[S]);const c=a.split("|"),h=[],p=[];let f=0,u=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let S=1;S<c.length;S++){let w=c[S],g=w.charAt(0);for(w=w.slice(1),p.length=0;_=m.exec(w);)p.push(_[0]);const d=[];for(let y=0,b=p.length;y<b;y++){if(p[y]==="00"){d.push(0,0);continue}const k=parseFloat(p[y]);isNaN(k)?d.push(0):d.push(k)}for(;d.length>0&&!isNaN(d[0]);){let y="",b=[];const k=f,D=u;let x,C,T,M,L,I,H,G,X,v;switch(g){case"l":f+=d.shift(),u+=d.shift(),y="L",b.push(f,u);break;case"L":f=d.shift(),u=d.shift(),b.push(f,u);break;case"m":const P=d.shift(),E=d.shift();if(f+=P,u+=E,y="M",h.length>2&&h[h.length-1].command==="z"){for(let A=h.length-2;A>=0;A--)if(h[A].command==="M"){f=h[A].points[0]+P,u=h[A].points[1]+E;break}}b.push(f,u),g="l";break;case"M":f=d.shift(),u=d.shift(),y="M",b.push(f,u),g="L";break;case"h":f+=d.shift(),y="L",b.push(f,u);break;case"H":f=d.shift(),y="L",b.push(f,u);break;case"v":u+=d.shift(),y="L",b.push(f,u);break;case"V":u=d.shift(),y="L",b.push(f,u);break;case"C":b.push(d.shift(),d.shift(),d.shift(),d.shift()),f=d.shift(),u=d.shift(),b.push(f,u);break;case"c":b.push(f+d.shift(),u+d.shift(),f+d.shift(),u+d.shift()),f+=d.shift(),u+=d.shift(),y="C",b.push(f,u);break;case"S":C=f,T=u,x=h[h.length-1],x.command==="C"&&(C=f+(f-x.points[2]),T=u+(u-x.points[3])),b.push(C,T,d.shift(),d.shift()),f=d.shift(),u=d.shift(),y="C",b.push(f,u);break;case"s":C=f,T=u,x=h[h.length-1],x.command==="C"&&(C=f+(f-x.points[2]),T=u+(u-x.points[3])),b.push(C,T,f+d.shift(),u+d.shift()),f+=d.shift(),u+=d.shift(),y="C",b.push(f,u);break;case"Q":b.push(d.shift(),d.shift()),f=d.shift(),u=d.shift(),b.push(f,u);break;case"q":b.push(f+d.shift(),u+d.shift()),f+=d.shift(),u+=d.shift(),y="Q",b.push(f,u);break;case"T":C=f,T=u,x=h[h.length-1],x.command==="Q"&&(C=f+(f-x.points[0]),T=u+(u-x.points[1])),f=d.shift(),u=d.shift(),y="Q",b.push(C,T,f,u);break;case"t":C=f,T=u,x=h[h.length-1],x.command==="Q"&&(C=f+(f-x.points[0]),T=u+(u-x.points[1])),f+=d.shift(),u+=d.shift(),y="Q",b.push(C,T,f,u);break;case"A":M=d.shift(),L=d.shift(),I=d.shift(),H=d.shift(),G=d.shift(),X=f,v=u,f=d.shift(),u=d.shift(),y="A",b=this.convertEndpointToCenterParameterization(X,v,f,u,H,G,M,L,I);break;case"a":M=d.shift(),L=d.shift(),I=d.shift(),H=d.shift(),G=d.shift(),X=f,v=u,f+=d.shift(),u+=d.shift(),y="A",b=this.convertEndpointToCenterParameterization(X,v,f,u,H,G,M,L,I);break}h.push({command:y||g,points:b,start:{x:k,y:D},pathLength:this.calcLength(k,D,y||g,b)})}(g==="z"||g==="Z")&&h.push({command:"z",points:[],start:void 0,pathLength:0})}return h}static calcLength(o,a,l,c){let h,p,f,u;const m=Qt;switch(l){case"L":return m.getLineLength(o,a,c[0],c[1]);case"C":return(0,i.getCubicArcLength)([o,c[0],c[2],c[4]],[a,c[1],c[3],c[5]],1);case"Q":return(0,i.getQuadraticArcLength)([o,c[0],c[2]],[a,c[1],c[3]],1);case"A":h=0;const _=c[4],S=c[5],w=c[4]+S;let g=Math.PI/180;if(Math.abs(_-w)<g&&(g=Math.abs(_-w)),p=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],_,0),S<0)for(u=_-g;u>w;u-=g)f=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],u,0),h+=m.getLineLength(p.x,p.y,f.x,f.y),p=f;else for(u=_+g;u<w;u+=g)f=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],u,0),h+=m.getLineLength(p.x,p.y,f.x,f.y),p=f;return f=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],w,0),h+=m.getLineLength(p.x,p.y,f.x,f.y),h}return 0}static convertEndpointToCenterParameterization(o,a,l,c,h,p,f,u,m){const _=m*(Math.PI/180),S=Math.cos(_)*(o-l)/2+Math.sin(_)*(a-c)/2,w=-1*Math.sin(_)*(o-l)/2+Math.cos(_)*(a-c)/2,g=S*S/(f*f)+w*w/(u*u);g>1&&(f*=Math.sqrt(g),u*=Math.sqrt(g));let d=Math.sqrt((f*f*(u*u)-f*f*(w*w)-u*u*(S*S))/(f*f*(w*w)+u*u*(S*S)));h===p&&(d*=-1),isNaN(d)&&(d=0);const y=d*f*w/u,b=d*-u*S/f,k=(o+l)/2+Math.cos(_)*y-Math.sin(_)*b,D=(a+c)/2+Math.sin(_)*y+Math.cos(_)*b,x=function(G){return Math.sqrt(G[0]*G[0]+G[1]*G[1])},C=function(G,X){return(G[0]*X[0]+G[1]*X[1])/(x(G)*x(X))},T=function(G,X){return(G[0]*X[1]<G[1]*X[0]?-1:1)*Math.acos(C(G,X))},M=T([1,0],[(S-y)/f,(w-b)/u]),L=[(S-y)/f,(w-b)/u],I=[(-1*S-y)/f,(-1*w-b)/u];let H=T(L,I);return C(L,I)<=-1&&(H=Math.PI),C(L,I)>=1&&(H=0),p===0&&H>0&&(H=H-2*Math.PI),p===1&&H<0&&(H=H+2*Math.PI),[k,D,f,u,M,H,_,p]}};return Bn.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(s),t.Factory.addGetterSetter(s,"data"),Bn}var pl;function Ou(){if(pl)return In;pl=1,Object.defineProperty(In,"__esModule",{value:!0}),In.Arrow=void 0;const t=bt(),e=ul(),n=xt(),i=vt(),s=ys();let r=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,c=this.points();let h=c;const p=this.tension()!==0&&c.length>4;p&&(h=this.getTensionPoints());const f=this.pointerLength(),u=c.length;let m,_;if(p){const g=[h[h.length-4],h[h.length-3],h[h.length-2],h[h.length-1],c[u-2],c[u-1]],d=s.Path.calcLength(h[h.length-4],h[h.length-3],"C",g),y=s.Path.getPointOnQuadraticBezier(Math.min(1,1-f/d),g[0],g[1],g[2],g[3],g[4],g[5]);m=c[u-2]-y.x,_=c[u-1]-y.y}else m=c[u-2]-c[u-4],_=c[u-1]-c[u-3];const S=(Math.atan2(_,m)+l)%l,w=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(c[u-2],c[u-1]),a.rotate(S),a.moveTo(0,0),a.lineTo(-f,w/2),a.lineTo(-f,-w/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(c[0],c[1]),p?(m=(h[0]+h[2])/2-c[0],_=(h[1]+h[3])/2-c[1]):(m=c[2]-c[0],_=c[3]-c[1]),a.rotate((Math.atan2(-_,-m)+l)%l),a.moveTo(0,0),a.lineTo(-f,w/2),a.lineTo(-f,-w/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return In.Arrow=r,r.prototype.className="Arrow",(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"pointerLength",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"pointerWidth",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"pointerAtBeginning",!1),t.Factory.addGetterSetter(r,"pointerAtEnding",!0),In}var Hn={},ml;function Lu(){if(ml)return Hn;ml=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.Circle=void 0;const t=bt(),e=Bt(),n=xt(),i=vt();let s=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}};return Hn.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),Hn}var Vn={},yl;function Gu(){if(yl)return Vn;yl=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.Ellipse=void 0;const t=bt(),e=Bt(),n=xt(),i=vt();let s=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),l=this.radiusY();o.beginPath(),o.save(),a!==l&&o.scale(1,l/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return Vn.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(s),t.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),t.Factory.addGetterSetter(s,"radiusX",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"radiusY",0,(0,n.getNumberValidator)()),Vn}var zn={},_l;function Iu(){if(_l)return zn;_l=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.Image=void 0;const t=Nt(),e=bt(),n=Bt(),i=vt(),s=xt();let r=class Kc extends n.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),c=this.getHeight(),h=this.cornerRadius(),p=this.attrs.image;let f;if(p){const u=this.attrs.cropWidth,m=this.attrs.cropHeight;u&&m?f=[p,this.cropX(),this.cropY(),u,m,0,0,l,c]:f=[p,0,0,l,c]}(this.hasFill()||this.hasStroke()||h)&&(a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)),p&&(h&&a.clip(),a.drawImage.apply(a,f))}_hitFunc(a){const l=this.width(),c=this.height(),h=this.cornerRadius();a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,c=null){const h=t.Util.createImageElement();h.onload=function(){const p=new Kc({image:h});l(p)},h.onerror=c,h.crossOrigin="Anonymous",h.src=a}};return zn.Image=r,r.prototype.className="Image",(0,i._registerNode)(r),e.Factory.addGetterSetter(r,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(r,"image"),e.Factory.addComponentsGetterSetter(r,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(r,"cropX",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropY",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropWidth",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropHeight",0,(0,s.getNumberValidator)()),zn}var qe={},vl;function Uu(){if(vl)return qe;vl=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.Tag=qe.Label=void 0;const t=bt(),e=Bt(),n=fs(),i=xt(),s=vt(),r=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",l="up",c="right",h="down",p="left",f=r.length;let u=class extends n.Group{constructor(S){super(S),this.on("add.konva",function(w){this._addListeners(w.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(S){let w=this,g;const d=function(){w._sync()};for(g=0;g<f;g++)S.on(r[g]+o,d)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let S=this.getText(),w=this.getTag(),g,d,y,b,k,D,x;if(S&&w){switch(g=S.width(),d=S.height(),y=w.pointerDirection(),b=w.pointerWidth(),x=w.pointerHeight(),k=0,D=0,y){case l:k=g/2,D=-1*x;break;case c:k=g+b,D=d/2;break;case h:k=g/2,D=d+x;break;case p:k=-1*b,D=d/2;break}w.setAttrs({x:-1*k,y:-1*D,width:g,height:d}),S.setAttrs({x:-1*k,y:-1*D})}}};qe.Label=u,u.prototype.className="Label",(0,s._registerNode)(u);class m extends e.Shape{_sceneFunc(S){const w=this.width(),g=this.height(),d=this.pointerDirection(),y=this.pointerWidth(),b=this.pointerHeight(),k=this.cornerRadius();let D=0,x=0,C=0,T=0;typeof k=="number"?D=x=C=T=Math.min(k,w/2,g/2):(D=Math.min(k[0]||0,w/2,g/2),x=Math.min(k[1]||0,w/2,g/2),T=Math.min(k[2]||0,w/2,g/2),C=Math.min(k[3]||0,w/2,g/2)),S.beginPath(),S.moveTo(D,0),d===l&&(S.lineTo((w-y)/2,0),S.lineTo(w/2,-1*b),S.lineTo((w+y)/2,0)),S.lineTo(w-x,0),S.arc(w-x,x,x,Math.PI*3/2,0,!1),d===c&&(S.lineTo(w,(g-b)/2),S.lineTo(w+y,g/2),S.lineTo(w,(g+b)/2)),S.lineTo(w,g-T),S.arc(w-T,g-T,T,0,Math.PI/2,!1),d===h&&(S.lineTo((w+y)/2,g),S.lineTo(w/2,g+b),S.lineTo((w-y)/2,g)),S.lineTo(C,g),S.arc(C,g-C,C,Math.PI/2,Math.PI,!1),d===p&&(S.lineTo(0,(g+b)/2),S.lineTo(-1*y,g/2),S.lineTo(0,(g-b)/2)),S.lineTo(0,D),S.arc(D,D,D,Math.PI,Math.PI*3/2,!1),S.closePath(),S.fillStrokeShape(this)}getSelfRect(){let S=0,w=0,g=this.pointerWidth(),d=this.pointerHeight(),y=this.pointerDirection(),b=this.width(),k=this.height();return y===l?(w-=d,k+=d):y===h?k+=d:y===p?(S-=g*1.5,b+=g):y===c&&(b+=g*1.5),{x:S,y:w,width:b,height:k}}}return qe.Tag=m,m.prototype.className="Tag",(0,s._registerNode)(m),t.Factory.addGetterSetter(m,"pointerDirection",a),t.Factory.addGetterSetter(m,"pointerWidth",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(m,"pointerHeight",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(m,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),qe}var Wn={},bl;function Sl(){if(bl)return Wn;bl=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.Rect=void 0;const t=bt(),e=Bt(),n=vt(),i=Nt(),s=xt();let r=class extends e.Shape{_sceneFunc(a){const l=this.cornerRadius(),c=this.width(),h=this.height();a.beginPath(),l?i.Util.drawRoundedRectPath(a,c,h,l):a.rect(0,0,c,h),a.closePath(),a.fillStrokeShape(this)}};return Wn.Rect=r,r.prototype.className="Rect",(0,n._registerNode)(r),t.Factory.addGetterSetter(r,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),Wn}var $n={},xl;function Bu(){if(xl)return $n;xl=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.RegularPolygon=void 0;const t=bt(),e=Bt(),n=xt(),i=vt();let s=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)o.lineTo(a[l].x,a[l].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let c=0;c<o;c++)l.push({x:a*Math.sin(c*2*Math.PI/o),y:-1*a*Math.cos(c*2*Math.PI/o)});return l}getSelfRect(){const o=this._getPoints();let a=o[0].x,l=o[0].y,c=o[0].x,h=o[0].y;return o.forEach(p=>{a=Math.min(a,p.x),l=Math.max(l,p.x),c=Math.min(c,p.y),h=Math.max(h,p.y)}),{x:a,y:c,width:l-a,height:h-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return $n.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"sides",0,(0,n.getNumberValidator)()),$n}var jn={},Cl;function Hu(){if(Cl)return jn;Cl=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.Ring=void 0;const t=bt(),e=Bt(),n=xt(),i=vt(),s=Math.PI*2;let r=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,s,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),s,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return jn.Ring=r,r.prototype.className="Ring",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,n.getNumberValidator)()),jn}var qn={},wl;function Vu(){if(wl)return qn;wl=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.Sprite=void 0;const t=bt(),e=Bt(),n=gs(),i=xt(),s=vt();let r=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new n.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,p=this.animations()[l],f=this.frameOffsets(),u=p[h+0],m=p[h+1],_=p[h+2],S=p[h+3],w=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,_,S),a.closePath(),a.fillStrokeShape(this)),w)if(f){const g=f[l],d=c*2;a.drawImage(w,u,m,_,S,g[d+0],g[d+1],_,S)}else a.drawImage(w,u,m,_,S,0,0,_,S)}_hitFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,p=this.animations()[l],f=this.frameOffsets(),u=p[h+2],m=p[h+3];if(a.beginPath(),f){const _=f[l],S=c*2;a.rect(_[S+0],_[S+1],u,m)}else a.rect(0,0,u,m);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),c=this.animations(),h=c[l],p=h.length/4;a<p-1?this.frameIndex(a+1):this.frameIndex(0)}};return qn.Sprite=r,r.prototype.className="Sprite",(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"animation"),t.Factory.addGetterSetter(r,"animations"),t.Factory.addGetterSetter(r,"frameOffsets"),t.Factory.addGetterSetter(r,"image"),t.Factory.addGetterSetter(r,"frameIndex",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"frameRate",17,(0,i.getNumberValidator)()),t.Factory.backCompat(r,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),qn}var Kn={},Pl;function zu(){if(Pl)return Kn;Pl=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.Star=void 0;const t=bt(),e=Bt(),n=xt(),i=vt();let s=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),l=this.outerRadius(),c=this.numPoints();o.beginPath(),o.moveTo(0,0-l);for(let h=1;h<c*2;h++){const p=h%2===0?l:a,f=p*Math.sin(h*Math.PI/c),u=-1*p*Math.cos(h*Math.PI/c);o.lineTo(f,u)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return Kn.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"numPoints",5,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,n.getNumberValidator)()),Kn}var ln={},Tl;function kl(){if(Tl)return ln;Tl=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.Text=void 0,ln.stringToArray=o;const t=Nt(),e=bt(),n=Bt(),i=vt(),s=xt(),r=vt();function o(j){return[...j].reduce((B,J,st,$)=>{if(/\p{Emoji}/u.test(J)){const F=$[st+1];F&&/\p{Emoji_Modifier}|\u200D/u.test(F)?(B.push(J+F),$[st+1]=""):B.push(J)}else/\p{Regional_Indicator}{2}/u.test(J+($[st+1]||""))?B.push(J+$[st+1]):st>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(J)?B[B.length-1]+=J:J&&B.push(J);return B},[])}const a="auto",l="center",c="inherit",h="justify",p="Change.konva",f="2d",u="-",m="left",_="text",S="Text",w="top",g="bottom",d="middle",y="normal",b="px ",k=" ",D="right",x="rtl",C="word",T="char",M="none",L="…",I=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],H=I.length;function G(j){return j.split(",").map(B=>{B=B.trim();const J=B.indexOf(" ")>=0,st=B.indexOf('"')>=0||B.indexOf("'")>=0;return J&&!st&&(B=`"${B}"`),B}).join(", ")}let X;function v(){return X||(X=t.Util.createCanvasElement().getContext(f),X)}function P(j){j.fillText(this._partialText,this._partialTextX,this._partialTextY)}function E(j){j.setAttr("miterLimit",2),j.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function A(j){return j=j||{},!j.fillLinearGradientColorStops&&!j.fillRadialGradientColorStops&&!j.fillPatternImage&&(j.fill=j.fill||"black"),j}let O=class extends n.Shape{constructor(B){super(A(B)),this._partialTextX=0,this._partialTextY=0;for(let J=0;J<H;J++)this.on(I[J]+p,this._setTextData);this._setTextData()}_sceneFunc(B){const J=this.textArr,st=J.length;if(!this.text())return;let $=this.padding(),F=this.fontSize(),W=this.lineHeight()*F,nt=this.verticalAlign(),it=this.direction(),ct=0,R=this.align(),N=this.getWidth(),z=this.letterSpacing(),q=this.fill(),Y=this.textDecoration(),K=Y.indexOf("underline")!==-1,Z=Y.indexOf("line-through")!==-1,rt;it=it===c?B.direction:it;let et=W/2,U=d;if(i.Konva._fixTextRendering){const V=this.measureSize("M");U="alphabetic",et=(V.fontBoundingBoxAscent-V.fontBoundingBoxDescent)/2+W/2}for(it===x&&B.setAttr("direction",it),B.setAttr("font",this._getContextFont()),B.setAttr("textBaseline",U),B.setAttr("textAlign",m),nt===d?ct=(this.getHeight()-st*W-$*2)/2:nt===g&&(ct=this.getHeight()-st*W-$*2),B.translate($,ct+$),rt=0;rt<st;rt++){let V=0,Q=0;const ot=J[rt],lt=ot.text,dt=ot.width,yt=ot.lastInParagraph;if(B.save(),R===D?V+=N-dt-$*2:R===l&&(V+=(N-dt-$*2)/2),K){B.save(),B.beginPath();const ft=i.Konva._fixTextRendering?Math.round(F/4):Math.round(F/2),ut=V,mt=et+Q+ft;B.moveTo(ut,mt);const _t=R===h&&!yt?N-$*2:dt;B.lineTo(ut+Math.round(_t),mt),B.lineWidth=F/15;const St=this._getLinearGradient();B.strokeStyle=St||q,B.stroke(),B.restore()}if(Z){B.save(),B.beginPath();const ft=i.Konva._fixTextRendering?-Math.round(F/4):0;B.moveTo(V,et+Q+ft);const ut=R===h&&!yt?N-$*2:dt;B.lineTo(V+Math.round(ut),et+Q+ft),B.lineWidth=F/15;const mt=this._getLinearGradient();B.strokeStyle=mt||q,B.stroke(),B.restore()}if(it!==x&&(z!==0||R===h)){const ft=lt.split(" ").length-1,ut=o(lt);for(let mt=0;mt<ut.length;mt++){const _t=ut[mt];_t===" "&&!yt&&R===h&&(V+=(N-$*2-dt)/ft),this._partialTextX=V,this._partialTextY=et+Q,this._partialText=_t,B.fillStrokeShape(this),V+=this.measureSize(_t).width+z}}else z!==0&&B.setAttr("letterSpacing",`${z}px`),this._partialTextX=V,this._partialTextY=et+Q,this._partialText=lt,B.fillStrokeShape(this);B.restore(),st>1&&(et+=W)}}_hitFunc(B){const J=this.getWidth(),st=this.getHeight();B.beginPath(),B.rect(0,0,J,st),B.closePath(),B.fillStrokeShape(this)}setText(B){const J=t.Util._isString(B)?B:B==null?"":B+"";return this._setAttr(_,J),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(B){var J,st,$,F,W,nt,it,ct,R,N,z;let q=v(),Y=this.fontSize(),K;q.save(),q.font=this._getContextFont(),K=q.measureText(B),q.restore();const Z=Y/100;return{actualBoundingBoxAscent:(J=K.actualBoundingBoxAscent)!==null&&J!==void 0?J:71.58203125*Z,actualBoundingBoxDescent:(st=K.actualBoundingBoxDescent)!==null&&st!==void 0?st:0,actualBoundingBoxLeft:($=K.actualBoundingBoxLeft)!==null&&$!==void 0?$:-7.421875*Z,actualBoundingBoxRight:(F=K.actualBoundingBoxRight)!==null&&F!==void 0?F:75.732421875*Z,alphabeticBaseline:(W=K.alphabeticBaseline)!==null&&W!==void 0?W:0,emHeightAscent:(nt=K.emHeightAscent)!==null&&nt!==void 0?nt:100*Z,emHeightDescent:(it=K.emHeightDescent)!==null&&it!==void 0?it:-20*Z,fontBoundingBoxAscent:(ct=K.fontBoundingBoxAscent)!==null&&ct!==void 0?ct:91*Z,fontBoundingBoxDescent:(R=K.fontBoundingBoxDescent)!==null&&R!==void 0?R:21*Z,hangingBaseline:(N=K.hangingBaseline)!==null&&N!==void 0?N:72.80000305175781*Z,ideographicBaseline:(z=K.ideographicBaseline)!==null&&z!==void 0?z:-21*Z,width:K.width,height:Y}}_getContextFont(){return this.fontStyle()+k+this.fontVariant()+k+(this.fontSize()+b)+G(this.fontFamily())}_addTextLine(B){this.align()===h&&(B=B.trim());const st=this._getTextWidth(B);return this.textArr.push({text:B,width:st,lastInParagraph:!1})}_getTextWidth(B){const J=this.letterSpacing(),st=B.length;return v().measureText(B).width+J*st}_setTextData(){let B=this.text().split(`
`),J=+this.fontSize(),st=0,$=this.lineHeight()*J,F=this.attrs.width,W=this.attrs.height,nt=F!==a&&F!==void 0,it=W!==a&&W!==void 0,ct=this.padding(),R=F-ct*2,N=W-ct*2,z=0,q=this.wrap(),Y=q!==M,K=q!==T&&Y,Z=this.ellipsis();this.textArr=[],v().font=this._getContextFont();const rt=Z?this._getTextWidth(L):0;for(let et=0,U=B.length;et<U;++et){let V=B[et],Q=this._getTextWidth(V);if(nt&&Q>R)for(;V.length>0;){let ot=0,lt=o(V).length,dt="",yt=0;for(;ot<lt;){const ft=ot+lt>>>1,ut=o(V),mt=ut.slice(0,ft+1).join(""),_t=this._getTextWidth(mt);(Z&&it&&z+$>N?_t+rt:_t)<=R?(ot=ft+1,dt=mt,yt=_t):lt=ft}if(dt){if(K){const mt=o(V),_t=o(dt),St=mt[_t.length],Mt=St===k||St===u;let Ht;if(Mt&&yt<=R)Ht=_t.length;else{const Ft=_t.lastIndexOf(k),Jt=_t.lastIndexOf(u);Ht=Math.max(Ft,Jt)+1}Ht>0&&(ot=Ht,dt=mt.slice(0,ot).join(""),yt=this._getTextWidth(dt))}if(dt=dt.trimRight(),this._addTextLine(dt),st=Math.max(st,yt),z+=$,this._shouldHandleEllipsis(z)){this._tryToAddEllipsisToLastLine();break}if(V=o(V).slice(ot).join("").trimLeft(),V.length>0&&(Q=this._getTextWidth(V),Q<=R)){this._addTextLine(V),z+=$,st=Math.max(st,Q);break}}else break}else this._addTextLine(V),z+=$,st=Math.max(st,Q),this._shouldHandleEllipsis(z)&&et<U-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),it&&z+$>N)break}this.textHeight=J,this.textWidth=st}_shouldHandleEllipsis(B){const J=+this.fontSize(),st=this.lineHeight()*J,$=this.attrs.height,F=$!==a&&$!==void 0,W=this.padding(),nt=$-W*2;return!(this.wrap()!==M)||F&&B+st>nt}_tryToAddEllipsisToLastLine(){const B=this.attrs.width,J=B!==a&&B!==void 0,st=this.padding(),$=B-st*2,F=this.ellipsis(),W=this.textArr[this.textArr.length-1];!W||!F||(J&&(this._getTextWidth(W.text+L)<$||(W.text=W.text.slice(0,W.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(W.text+L))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const B=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,J=this.hasShadow();return B&&J?!0:super._useBufferCanvas()}};return ln.Text=O,O.prototype._fillFunc=P,O.prototype._strokeFunc=E,O.prototype.className=S,O.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,r._registerNode)(O),e.Factory.overWriteSetter(O,"width",(0,s.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(O,"height",(0,s.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(O,"direction",c),e.Factory.addGetterSetter(O,"fontFamily","Arial"),e.Factory.addGetterSetter(O,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"fontStyle",y),e.Factory.addGetterSetter(O,"fontVariant",y),e.Factory.addGetterSetter(O,"padding",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"align",m),e.Factory.addGetterSetter(O,"verticalAlign",w),e.Factory.addGetterSetter(O,"lineHeight",1,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"wrap",C),e.Factory.addGetterSetter(O,"ellipsis",!1,(0,s.getBooleanValidator)()),e.Factory.addGetterSetter(O,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"text","",(0,s.getStringValidator)()),e.Factory.addGetterSetter(O,"textDecoration",""),ln}var Yn={},Al;function Wu(){if(Al)return Yn;Al=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.TextPath=void 0;const t=Nt(),e=bt(),n=Bt(),i=ys(),s=kl(),r=xt(),o=vt(),a="",l="normal";function c(f){f.fillText(this.partialText,0,0)}function h(f){f.strokeText(this.partialText,0,0)}let p=class extends n.Shape{constructor(u){super(u),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(u){if(!this.attrs.data)return null;const m=this.pathLength;return u-1>m?null:i.Path.getPointAtLengthOfDataArray(u,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(u){u.setAttr("font",this._getContextFont()),u.setAttr("textBaseline",this.textBaseline()),u.setAttr("textAlign","left"),u.save();const m=this.textDecoration(),_=this.fill(),S=this.fontSize(),w=this.glyphInfo;m==="underline"&&u.beginPath();for(let g=0;g<w.length;g++){u.save();const d=w[g].p0;u.translate(d.x,d.y),u.rotate(w[g].rotation),this.partialText=w[g].text,u.fillStrokeShape(this),m==="underline"&&(g===0&&u.moveTo(0,S/2+1),u.lineTo(S,S/2+1)),u.restore()}m==="underline"&&(u.strokeStyle=_,u.lineWidth=S/20,u.stroke()),u.restore()}_hitFunc(u){u.beginPath();const m=this.glyphInfo;if(m.length>=1){const _=m[0].p0;u.moveTo(_.x,_.y)}for(let _=0;_<m.length;_++){const S=m[_].p1;u.lineTo(S.x,S.y)}u.setAttr("lineWidth",this.fontSize()),u.setAttr("strokeStyle",this.colorKey),u.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(u){return s.Text.prototype.setText.call(this,u)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(u){const _=this.dummyCanvas.getContext("2d");_.save(),_.font=this._getContextFont();const S=_.measureText(u);return _.restore(),{width:S.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:u,height:m}=this._getTextSize(this.attrs.text);if(this.textWidth=u,this.textHeight=m,this.glyphInfo=[],!this.attrs.data)return null;const _=this.letterSpacing(),S=this.align(),w=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*_,0);let d=0;S==="center"&&(d=Math.max(0,this.pathLength/2-g/2)),S==="right"&&(d=Math.max(0,this.pathLength-g));const y=(0,s.stringToArray)(this.text());let b=d;for(let k=0;k<y.length;k++){const D=this._getPointAtLength(b);if(!D)return;let x=this._getTextSize(y[k]).width+_;if(y[k]===" "&&S==="justify"){const H=this.text().split(" ").length-1;x+=(this.pathLength-g)/H}const C=this._getPointAtLength(b+x);if(!C)return;const T=i.Path.getLineLength(D.x,D.y,C.x,C.y);let M=0;if(w)try{M=w(y[k-1],y[k])*this.fontSize()}catch{M=0}D.x+=M,C.x+=M,this.textWidth+=M;const L=i.Path.getPointOnLine(M+T/2,D.x,D.y,C.x,C.y),I=Math.atan2(C.y-D.y,C.x-D.x);this.glyphInfo.push({transposeX:L.x,transposeY:L.y,text:y[k],rotation:I,p0:D,p1:C}),b+=x}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const u=[];this.glyphInfo.forEach(function(b){u.push(b.p0.x),u.push(b.p0.y),u.push(b.p1.x),u.push(b.p1.y)});let m=u[0]||0,_=u[0]||0,S=u[1]||0,w=u[1]||0,g,d;for(let b=0;b<u.length/2;b++)g=u[b*2],d=u[b*2+1],m=Math.min(m,g),_=Math.max(_,g),S=Math.min(S,d),w=Math.max(w,d);const y=this.fontSize();return{x:m-y/2,y:S-y/2,width:_-m+y,height:w-S+y}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Yn.TextPath=p,p.prototype._fillFunc=c,p.prototype._strokeFunc=h,p.prototype._fillFuncHit=c,p.prototype._strokeFuncHit=h,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(p),e.Factory.addGetterSetter(p,"data"),e.Factory.addGetterSetter(p,"fontFamily","Arial"),e.Factory.addGetterSetter(p,"fontSize",12,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(p,"fontStyle",l),e.Factory.addGetterSetter(p,"align","left"),e.Factory.addGetterSetter(p,"letterSpacing",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(p,"textBaseline","middle"),e.Factory.addGetterSetter(p,"fontVariant",l),e.Factory.addGetterSetter(p,"text",a),e.Factory.addGetterSetter(p,"textDecoration",""),e.Factory.addGetterSetter(p,"kerningFunc",void 0),Yn}var Xn={},Rl;function $u(){if(Rl)return Xn;Rl=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.Transformer=void 0;const t=Nt(),e=bt(),n=Ot(),i=Bt(),s=Sl(),r=fs(),o=vt(),a=xt(),l=vt(),c="tr-konva",h=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(x=>x+`.${c}`).join(" "),p="nodesRect",f=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],u={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},m="ontouchstart"in o.Konva._global;function _(x,C,T){if(x==="rotater")return T;C+=t.Util.degToRad(u[x]||0);const M=(t.Util.radToDeg(C)%360+360)%360;return t.Util._inRange(M,337.5,360)||t.Util._inRange(M,0,22.5)?"ns-resize":t.Util._inRange(M,22.5,67.5)?"nesw-resize":t.Util._inRange(M,67.5,112.5)?"ew-resize":t.Util._inRange(M,112.5,157.5)?"nwse-resize":t.Util._inRange(M,157.5,202.5)?"ns-resize":t.Util._inRange(M,202.5,247.5)?"nesw-resize":t.Util._inRange(M,247.5,292.5)?"ew-resize":t.Util._inRange(M,292.5,337.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+M),"pointer")}const S=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function w(x){return{x:x.x+x.width/2*Math.cos(x.rotation)+x.height/2*Math.sin(-x.rotation),y:x.y+x.height/2*Math.cos(x.rotation)+x.width/2*Math.sin(x.rotation)}}function g(x,C,T){const M=T.x+(x.x-T.x)*Math.cos(C)-(x.y-T.y)*Math.sin(C),L=T.y+(x.x-T.x)*Math.sin(C)+(x.y-T.y)*Math.cos(C);return{...x,rotation:x.rotation+C,x:M,y:L}}function d(x,C){const T=w(x);return g(x,C,T)}function y(x,C,T){let M=C;for(let L=0;L<x.length;L++){const I=o.Konva.getAngle(x[L]),H=Math.abs(I-C)%(Math.PI*2);Math.min(H,Math.PI*2-H)<T&&(M=I)}return M}let b=0,k=class extends r.Group{constructor(C){super(C),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(h,this.update),this.getNode()&&this.update()}attachTo(C){return this.setNode(C),this}setNode(C){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([C])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(C=[]){this._nodes&&this._nodes.length&&this.detach();const T=C.filter(L=>L.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=C=T,C.length===1&&this.useSingleNodeRotation()?this.rotation(C[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(L=>{const I=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(L._attrsAffectingSize.length){const H=L._attrsAffectingSize.map(G=>G+"Change."+this._getEventNamespace()).join(" ");L.on(H,I)}L.on(f.map(H=>H+`.${this._getEventNamespace()}`).join(" "),I),L.on(`absoluteTransformChange.${this._getEventNamespace()}`,I),this._proxyDrag(L)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(C){let T;C.on(`dragstart.${this._getEventNamespace()}`,M=>{T=C.getAbsolutePosition(),!this.isDragging()&&C!==this.findOne(".back")&&this.startDrag(M,!1)}),C.on(`dragmove.${this._getEventNamespace()}`,M=>{if(!T)return;const L=C.getAbsolutePosition(),I=L.x-T.x,H=L.y-T.y;this.nodes().forEach(G=>{if(G===C||G.isDragging())return;const X=G.getAbsolutePosition();G.setAbsolutePosition({x:X.x+I,y:X.y+H}),G.startDrag(M)}),T=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(C=>{C.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(C,T=this.rotation(),M){const L=C.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),I=C.getAbsoluteScale(M),H=C.getAbsolutePosition(M),G=L.x*I.x-C.offsetX()*I.x,X=L.y*I.y-C.offsetY()*I.y,v=(o.Konva.getAngle(C.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),P={x:H.x+G*Math.cos(v)+X*Math.sin(-v),y:H.y+X*Math.cos(v)+G*Math.sin(v),width:L.width*I.x,height:L.height*I.y,rotation:v};return g(P,-o.Konva.getAngle(T),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const T=[];this.nodes().map(v=>{const P=v.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),E=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}],A=v.getAbsoluteTransform();E.forEach(function(O){const j=A.point(O);T.push(j)})});const M=new t.Transform;M.rotate(-o.Konva.getAngle(this.rotation()));let L=1/0,I=1/0,H=-1/0,G=-1/0;T.forEach(function(v){const P=M.point(v);L===void 0&&(L=H=P.x,I=G=P.y),L=Math.min(L,P.x),I=Math.min(I,P.y),H=Math.max(H,P.x),G=Math.max(G,P.y)}),M.invert();const X=M.point({x:L,y:I});return{x:X.x,y:X.y,width:H-L,height:G-I,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S.forEach(C=>{this._createAnchor(C)}),this._createAnchor("rotater")}_createAnchor(C){const T=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:C+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:m?10:"auto"}),M=this;T.on("mousedown touchstart",function(L){M._handleMouseDown(L)}),T.on("dragstart",L=>{T.stopDrag(),L.cancelBubble=!0}),T.on("dragend",L=>{L.cancelBubble=!0}),T.on("mouseenter",()=>{const L=o.Konva.getAngle(this.rotation()),I=this.rotateAnchorCursor(),H=_(C,L,I);T.getStage().content&&(T.getStage().content.style.cursor=H),this._cursorChange=!0}),T.on("mouseout",()=>{T.getStage().content&&(T.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(T)}_createBack(){const C=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(T,M){const L=M.getParent(),I=L.padding();T.beginPath(),T.rect(-I,-I,M.width()+I*2,M.height()+I*2),T.moveTo(M.width()/2,-I),L.rotateEnabled()&&L.rotateLineVisible()&&T.lineTo(M.width()/2,-L.rotateAnchorOffset()*t.Util._sign(M.height())-I),T.fillStrokeShape(M)},hitFunc:(T,M)=>{if(!this.shouldOverdrawWholeArea())return;const L=this.padding();T.beginPath(),T.rect(-L,-L,M.width()+L*2,M.height()+L*2),T.fillStrokeShape(M)}});this.add(C),this._proxyDrag(C),C.on("dragstart",T=>{T.cancelBubble=!0}),C.on("dragmove",T=>{T.cancelBubble=!0}),C.on("dragend",T=>{T.cancelBubble=!0}),this.on("dragmove",T=>{this.update()})}_handleMouseDown(C){if(this._transforming)return;this._movingAnchorName=C.target.name().split(" ")[0];const T=this._getNodeRect(),M=T.width,L=T.height,I=Math.sqrt(Math.pow(M,2)+Math.pow(L,2));this.sin=Math.abs(L/I),this.cos=Math.abs(M/I),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const H=C.target.getAbsolutePosition(),G=C.target.getStage().getPointerPosition();this._anchorDragOffset={x:G.x-H.x,y:G.y-H.y},b++,this._fire("transformstart",{evt:C.evt,target:this.getNode()}),this._nodes.forEach(X=>{X._fire("transformstart",{evt:C.evt,target:X})})}_handleMouseMove(C){let T,M,L;const I=this.findOne("."+this._movingAnchorName),H=I.getStage();H.setPointersPositions(C);const G=H.getPointerPosition();let X={x:G.x-this._anchorDragOffset.x,y:G.y-this._anchorDragOffset.y};const v=I.getAbsolutePosition();this.anchorDragBoundFunc()&&(X=this.anchorDragBoundFunc()(v,X,C)),I.setAbsolutePosition(X);const P=I.getAbsolutePosition();if(v.x===P.x&&v.y===P.y)return;if(this._movingAnchorName==="rotater"){const $=this._getNodeRect();T=I.x()-$.width/2,M=-I.y()+$.height/2;let F=Math.atan2(-M,T)+Math.PI/2;$.height<0&&(F-=Math.PI);const nt=o.Konva.getAngle(this.rotation())+F,it=o.Konva.getAngle(this.rotationSnapTolerance()),R=y(this.rotationSnaps(),nt,it)-$.rotation,N=d($,R);this._fitNodesInto(N,C);return}const E=this.shiftBehavior();let A;E==="inverted"?A=this.keepRatio()&&!C.shiftKey:E==="none"?A=this.keepRatio():A=this.keepRatio()||C.shiftKey;let O=this.centeredScaling()||C.altKey;if(this._movingAnchorName==="top-left"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};L=Math.sqrt(Math.pow($.x-I.x(),2)+Math.pow($.y-I.y(),2));const F=this.findOne(".top-left").x()>$.x?-1:1,W=this.findOne(".top-left").y()>$.y?-1:1;T=L*this.cos*F,M=L*this.sin*W,this.findOne(".top-left").x($.x-T),this.findOne(".top-left").y($.y-M)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(I.y());else if(this._movingAnchorName==="top-right"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};L=Math.sqrt(Math.pow(I.x()-$.x,2)+Math.pow($.y-I.y(),2));const F=this.findOne(".top-right").x()<$.x?-1:1,W=this.findOne(".top-right").y()>$.y?-1:1;T=L*this.cos*F,M=L*this.sin*W,this.findOne(".top-right").x($.x+T),this.findOne(".top-right").y($.y-M)}var j=I.position();this.findOne(".top-left").y(j.y),this.findOne(".bottom-right").x(j.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(I.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(I.x());else if(this._movingAnchorName==="bottom-left"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};L=Math.sqrt(Math.pow($.x-I.x(),2)+Math.pow(I.y()-$.y,2));const F=$.x<I.x()?-1:1,W=I.y()<$.y?-1:1;T=L*this.cos*F,M=L*this.sin*W,I.x($.x-T),I.y($.y+M)}j=I.position(),this.findOne(".top-left").x(j.x),this.findOne(".bottom-right").y(j.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(I.y());else if(this._movingAnchorName==="bottom-right"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};L=Math.sqrt(Math.pow(I.x()-$.x,2)+Math.pow(I.y()-$.y,2));const F=this.findOne(".bottom-right").x()<$.x?-1:1,W=this.findOne(".bottom-right").y()<$.y?-1:1;T=L*this.cos*F,M=L*this.sin*W,this.findOne(".bottom-right").x($.x+T),this.findOne(".bottom-right").y($.y+M)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(O=this.centeredScaling()||C.altKey,O){const $=this.findOne(".top-left"),F=this.findOne(".bottom-right"),W=$.x(),nt=$.y(),it=this.getWidth()-F.x(),ct=this.getHeight()-F.y();F.move({x:-W,y:-nt}),$.move({x:it,y:ct})}const B=this.findOne(".top-left").getAbsolutePosition();T=B.x,M=B.y;const J=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),st=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:T,y:M,width:J,height:st,rotation:o.Konva.getAngle(this.rotation())},C)}_handleMouseUp(C){this._removeEvents(C)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(C){var T;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const M=this.getNode();b--,this._fire("transformend",{evt:C,target:M}),(T=this.getLayer())===null||T===void 0||T.batchDraw(),M&&this._nodes.forEach(L=>{var I;L._fire("transformend",{evt:C,target:L}),(I=L.getLayer())===null||I===void 0||I.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(C,T){const M=this._getNodeRect(),L=1;if(t.Util._inRange(C.width,-this.padding()*2-L,L)){this.update();return}if(t.Util._inRange(C.height,-this.padding()*2-L,L)){this.update();return}const I=new t.Transform;if(I.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&C.width<0&&this._movingAnchorName.indexOf("left")>=0){const A=I.point({x:-this.padding()*2,y:0});C.x+=A.x,C.y+=A.y,C.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y}else if(this._movingAnchorName&&C.width<0&&this._movingAnchorName.indexOf("right")>=0){const A=I.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,C.width+=this.padding()*2}if(this._movingAnchorName&&C.height<0&&this._movingAnchorName.indexOf("top")>=0){const A=I.point({x:0,y:-this.padding()*2});C.x+=A.x,C.y+=A.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,C.height+=this.padding()*2}else if(this._movingAnchorName&&C.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const A=I.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,C.height+=this.padding()*2}if(this.boundBoxFunc()){const A=this.boundBoxFunc()(M,C);A?C=A:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const H=1e7,G=new t.Transform;G.translate(M.x,M.y),G.rotate(M.rotation),G.scale(M.width/H,M.height/H);const X=new t.Transform,v=C.width/H,P=C.height/H;this.flipEnabled()===!1?(X.translate(C.x,C.y),X.rotate(C.rotation),X.translate(C.width<0?C.width:0,C.height<0?C.height:0),X.scale(Math.abs(v),Math.abs(P))):(X.translate(C.x,C.y),X.rotate(C.rotation),X.scale(v,P));const E=X.multiply(G.invert());this._nodes.forEach(A=>{var O;const j=A.getParent().getAbsoluteTransform(),B=A.getTransform().copy();B.translate(A.offsetX(),A.offsetY());const J=new t.Transform;J.multiply(j.copy().invert()).multiply(E).multiply(j).multiply(B);const st=J.decompose();A.setAttrs(st),(O=A.getLayer())===null||O===void 0||O.batchDraw()}),this.rotation(t.Util._getRotation(C.rotation)),this._nodes.forEach(A=>{this._fire("transform",{evt:T,target:A}),A._fire("transform",{evt:T,target:A})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(C,T){this.findOne(C).setAttrs(T)}update(){var C;const T=this._getNodeRect();this.rotation(t.Util._getRotation(T.rotation));const M=T.width,L=T.height,I=this.enabledAnchors(),H=this.resizeEnabled(),G=this.padding(),X=this.anchorSize(),v=this.find("._anchor");v.forEach(E=>{E.setAttrs({width:X,height:X,offsetX:X/2,offsetY:X/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:X/2+G,offsetY:X/2+G,visible:H&&I.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:M/2,y:0,offsetY:X/2+G,visible:H&&I.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:M,y:0,offsetX:X/2-G,offsetY:X/2+G,visible:H&&I.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:L/2,offsetX:X/2+G,visible:H&&I.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:M,y:L/2,offsetX:X/2-G,visible:H&&I.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:L,offsetX:X/2+G,offsetY:X/2-G,visible:H&&I.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:M/2,y:L,offsetY:X/2-G,visible:H&&I.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:M,y:L,offsetX:X/2-G,offsetY:X/2-G,visible:H&&I.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:M/2,y:-this.rotateAnchorOffset()*t.Util._sign(L)-G,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:M,height:L,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const P=this.anchorStyleFunc();P&&v.forEach(E=>{P(E)}),(C=this.getLayer())===null||C===void 0||C.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const C=this.findOne("."+this._movingAnchorName);C&&C.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),r.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(C){return n.Node.prototype.clone.call(this,C)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Xn.Transformer=k,k.isTransforming=()=>b>0;function D(x){return x instanceof Array||t.Util.warn("enabledAnchors value should be an array"),x instanceof Array&&x.forEach(function(C){S.indexOf(C)===-1&&t.Util.warn("Unknown anchor name: "+C+". Available names are: "+S.join(", "))}),x||[]}return k.prototype.className="Transformer",(0,l._registerNode)(k),e.Factory.addGetterSetter(k,"enabledAnchors",S,D),e.Factory.addGetterSetter(k,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(k,"resizeEnabled",!0),e.Factory.addGetterSetter(k,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateEnabled",!0),e.Factory.addGetterSetter(k,"rotateLineVisible",!0),e.Factory.addGetterSetter(k,"rotationSnaps",[]),e.Factory.addGetterSetter(k,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(k,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderEnabled",!0),e.Factory.addGetterSetter(k,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"anchorFill","white"),e.Factory.addGetterSetter(k,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderDash"),e.Factory.addGetterSetter(k,"keepRatio",!0),e.Factory.addGetterSetter(k,"shiftBehavior","default"),e.Factory.addGetterSetter(k,"centeredScaling",!1),e.Factory.addGetterSetter(k,"ignoreStroke",!1),e.Factory.addGetterSetter(k,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"nodes"),e.Factory.addGetterSetter(k,"node"),e.Factory.addGetterSetter(k,"boundBoxFunc"),e.Factory.addGetterSetter(k,"anchorDragBoundFunc"),e.Factory.addGetterSetter(k,"anchorStyleFunc"),e.Factory.addGetterSetter(k,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(k,"useSingleNodeRotation",!0),e.Factory.backCompat(k,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Xn}var Jn={},El;function ju(){if(El)return Jn;El=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.Wedge=void 0;const t=bt(),e=Bt(),n=vt(),i=xt(),s=vt();let r=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return Jn.Wedge=r,r.prototype.className="Wedge",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clockwise",!1),t.Factory.backCompat(r,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Jn}var Qn={},Ml;function qu(){if(Ml)return Qn;Ml=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.Blur=void 0;const t=bt(),e=Ot(),n=xt();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],r=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(l,c){const h=l.data,p=l.width,f=l.height;let u,m,_,S,w,g,d,y,b,k,D,x,C,T,M,L,I,H,G,X;const v=c+c+1,P=p-1,E=f-1,A=c+1,O=A*(A+1)/2,j=new i,B=s[c],J=r[c];let st=null,$=j,F=null,W=null;for(let nt=1;nt<v;nt++)$=$.next=new i,nt===A&&(st=$);$.next=j,_=m=0;for(let nt=0;nt<f;nt++){x=C=T=M=S=w=g=d=0,y=A*(L=h[m]),b=A*(I=h[m+1]),k=A*(H=h[m+2]),D=A*(G=h[m+3]),S+=O*L,w+=O*I,g+=O*H,d+=O*G,$=j;for(let it=0;it<A;it++)$.r=L,$.g=I,$.b=H,$.a=G,$=$.next;for(let it=1;it<A;it++)u=m+((P<it?P:it)<<2),S+=($.r=L=h[u])*(X=A-it),w+=($.g=I=h[u+1])*X,g+=($.b=H=h[u+2])*X,d+=($.a=G=h[u+3])*X,x+=L,C+=I,T+=H,M+=G,$=$.next;F=j,W=st;for(let it=0;it<p;it++)h[m+3]=G=d*B>>J,G!==0?(G=255/G,h[m]=(S*B>>J)*G,h[m+1]=(w*B>>J)*G,h[m+2]=(g*B>>J)*G):h[m]=h[m+1]=h[m+2]=0,S-=y,w-=b,g-=k,d-=D,y-=F.r,b-=F.g,k-=F.b,D-=F.a,u=_+((u=it+c+1)<P?u:P)<<2,x+=F.r=h[u],C+=F.g=h[u+1],T+=F.b=h[u+2],M+=F.a=h[u+3],S+=x,w+=C,g+=T,d+=M,F=F.next,y+=L=W.r,b+=I=W.g,k+=H=W.b,D+=G=W.a,x-=L,C-=I,T-=H,M-=G,W=W.next,m+=4;_+=p}for(let nt=0;nt<p;nt++){C=T=M=x=w=g=d=S=0,m=nt<<2,y=A*(L=h[m]),b=A*(I=h[m+1]),k=A*(H=h[m+2]),D=A*(G=h[m+3]),S+=O*L,w+=O*I,g+=O*H,d+=O*G,$=j;for(let ct=0;ct<A;ct++)$.r=L,$.g=I,$.b=H,$.a=G,$=$.next;let it=p;for(let ct=1;ct<=c;ct++)m=it+nt<<2,S+=($.r=L=h[m])*(X=A-ct),w+=($.g=I=h[m+1])*X,g+=($.b=H=h[m+2])*X,d+=($.a=G=h[m+3])*X,x+=L,C+=I,T+=H,M+=G,$=$.next,ct<E&&(it+=p);m=nt,F=j,W=st;for(let ct=0;ct<f;ct++)u=m<<2,h[u+3]=G=d*B>>J,G>0?(G=255/G,h[u]=(S*B>>J)*G,h[u+1]=(w*B>>J)*G,h[u+2]=(g*B>>J)*G):h[u]=h[u+1]=h[u+2]=0,S-=y,w-=b,g-=k,d-=D,y-=F.r,b-=F.g,k-=F.b,D-=F.a,u=nt+((u=ct+A)<E?u:E)*p<<2,S+=x+=F.r=h[u],w+=C+=F.g=h[u+1],g+=T+=F.b=h[u+2],d+=M+=F.a=h[u+3],F=F.next,y+=L=W.r,b+=I=W.g,k+=H=W.b,D+=G=W.a,x-=L,C-=I,T-=H,M-=G,W=W.next,m+=p}}const a=function(c){const h=Math.round(this.blurRadius());h>0&&o(c,h)};return Qn.Blur=a,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Qn}var Zn={},Fl;function Ku(){if(Fl)return Zn;Fl=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.Brighten=void 0;const t=bt(),e=Ot(),n=xt(),i=function(s){const r=this.brightness()*255,o=s.data,a=o.length;for(let l=0;l<a;l+=4)o[l]+=r,o[l+1]+=r,o[l+2]+=r};return Zn.Brighten=i,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Zn}var ti={},Dl;function Yu(){if(Dl)return ti;Dl=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.Contrast=void 0;const t=bt(),e=Ot(),n=xt(),i=function(s){const r=Math.pow((this.contrast()+100)/100,2),o=s.data,a=o.length;let l=150,c=150,h=150;for(let p=0;p<a;p+=4)l=o[p],c=o[p+1],h=o[p+2],l/=255,l-=.5,l*=r,l+=.5,l*=255,c/=255,c-=.5,c*=r,c+=.5,c*=255,h/=255,h-=.5,h*=r,h+=.5,h*=255,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,h=h<0?0:h>255?255:h,o[p]=l,o[p+1]=c,o[p+2]=h};return ti.Contrast=i,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ti}var ei={},Nl;function Xu(){if(Nl)return ei;Nl=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.Emboss=void 0;const t=bt(),e=Ot(),n=Nt(),i=xt(),s=function(r){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),c=this.embossBlend(),h=r.data,p=r.width,f=r.height,u=p*4;let m=0,_=0,S=f;switch(l){case"top-left":m=-1,_=-1;break;case"top":m=-1,_=0;break;case"top-right":m=-1,_=1;break;case"right":m=0,_=1;break;case"bottom-right":m=1,_=1;break;case"bottom":m=1,_=0;break;case"bottom-left":m=1,_=-1;break;case"left":m=0,_=-1;break;default:n.Util.error("Unknown emboss direction: "+l)}do{const w=(S-1)*u;let g=m;S+g<1&&(g=0),S+g>f&&(g=0);const d=(S-1+g)*p*4;let y=p;do{const b=w+(y-1)*4;let k=_;y+k<1&&(k=0),y+k>p&&(k=0);const D=d+(y-1+k)*4,x=h[b]-h[D],C=h[b+1]-h[D+1],T=h[b+2]-h[D+2];let M=x;const L=M>0?M:-M,I=C>0?C:-C,H=T>0?T:-T;if(I>L&&(M=C),H>L&&(M=T),M*=o,c){const G=h[b]+M,X=h[b+1]+M,v=h[b+2]+M;h[b]=G>255?255:G<0?0:G,h[b+1]=X>255?255:X<0?0:X,h[b+2]=v>255?255:v<0?0:v}else{let G=a-M;G<0?G=0:G>255&&(G=255),h[b]=h[b+1]=h[b+2]=G}}while(--y)}while(--S)};return ei.Emboss=s,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),ei}var ni={},Ol;function Ju(){if(Ol)return ni;Ol=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.Enhance=void 0;const t=bt(),e=Ot(),n=xt();function i(r,o,a,l,c){const h=a-o,p=c-l;if(h===0)return l+p/2;if(p===0)return l;let f=(r-o)/h;return f=p*f+l,f}const s=function(r){const o=r.data,a=o.length;let l=o[0],c=l,h,p=o[1],f=p,u,m=o[2],_=m,S;const w=this.enhance();if(w===0)return;for(let x=0;x<a;x+=4)h=o[x+0],h<l?l=h:h>c&&(c=h),u=o[x+1],u<p?p=u:u>f&&(f=u),S=o[x+2],S<m?m=S:S>_&&(_=S);c===l&&(c=255,l=0),f===p&&(f=255,p=0),_===m&&(_=255,m=0);let g,d,y,b,k,D;if(w>0)g=c+w*(255-c),d=l-w*(l-0),y=f+w*(255-f),b=p-w*(p-0),k=_+w*(255-_),D=m-w*(m-0);else{const x=(c+l)*.5;g=c+w*(c-x),d=l+w*(l-x);const C=(f+p)*.5;y=f+w*(f-C),b=p+w*(p-C);const T=(_+m)*.5;k=_+w*(_-T),D=m+w*(m-T)}for(let x=0;x<a;x+=4)o[x+0]=i(o[x+0],l,c,d,g),o[x+1]=i(o[x+1],p,f,b,y),o[x+2]=i(o[x+2],m,_,D,k)};return ni.Enhance=s,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ni}var ii={},Ll;function Qu(){if(Ll)return ii;Ll=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.Grayscale=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4){const r=.34*n[s]+.5*n[s+1]+.16*n[s+2];n[s]=r,n[s+1]=r,n[s+2]=r}};return ii.Grayscale=t,ii}var ri={},Gl;function Zu(){if(Gl)return ri;Gl=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.HSL=void 0;const t=bt(),e=Ot(),n=xt();t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter);const i=function(s){const r=s.data,o=r.length,a=1,l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=this.luminance()*127,p=a*l*Math.cos(c*Math.PI/180),f=a*l*Math.sin(c*Math.PI/180),u=.299*a+.701*p+.167*f,m=.587*a-.587*p+.33*f,_=.114*a-.114*p-.497*f,S=.299*a-.299*p-.328*f,w=.587*a+.413*p+.035*f,g=.114*a-.114*p+.293*f,d=.299*a-.3*p+1.25*f,y=.587*a-.586*p-1.05*f,b=.114*a+.886*p-.2*f;let k,D,x,C;for(let T=0;T<o;T+=4)k=r[T+0],D=r[T+1],x=r[T+2],C=r[T+3],r[T+0]=u*k+m*D+_*x+h,r[T+1]=S*k+w*D+g*x+h,r[T+2]=d*k+y*D+b*x+h,r[T+3]=C};return ri.HSL=i,ri}var si={},Il;function tf(){if(Il)return si;Il=1,Object.defineProperty(si,"__esModule",{value:!0}),si.HSV=void 0;const t=bt(),e=Ot(),n=xt(),i=function(s){const r=s.data,o=r.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=a*l*Math.cos(c*Math.PI/180),p=a*l*Math.sin(c*Math.PI/180),f=.299*a+.701*h+.167*p,u=.587*a-.587*h+.33*p,m=.114*a-.114*h-.497*p,_=.299*a-.299*h-.328*p,S=.587*a+.413*h+.035*p,w=.114*a-.114*h+.293*p,g=.299*a-.3*h+1.25*p,d=.587*a-.586*h-1.05*p,y=.114*a+.886*h-.2*p;for(let b=0;b<o;b+=4){const k=r[b+0],D=r[b+1],x=r[b+2],C=r[b+3];r[b+0]=f*k+u*D+m*x,r[b+1]=_*k+S*D+w*x,r[b+2]=g*k+d*D+y*x,r[b+3]=C}};return si.HSV=i,t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),si}var oi={},Ul;function ef(){if(Ul)return oi;Ul=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.Invert=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4)n[s]=255-n[s],n[s+1]=255-n[s+1],n[s+2]=255-n[s+2]};return oi.Invert=t,oi}var ai={},Bl;function nf(){if(Bl)return ai;Bl=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.Kaleidoscope=void 0;const t=bt(),e=Ot(),n=Nt(),i=xt(),s=function(a,l,c){const h=a.data,p=l.data,f=a.width,u=a.height,m=c.polarCenterX||f/2,_=c.polarCenterY||u/2;let S=Math.sqrt(m*m+_*_),w=f-m,g=u-_;const d=Math.sqrt(w*w+g*g);S=d>S?d:S;const y=u,b=f,k=360/b*Math.PI/180;for(let D=0;D<b;D+=1){const x=Math.sin(D*k),C=Math.cos(D*k);for(let T=0;T<y;T+=1){w=Math.floor(m+S*T/y*C),g=Math.floor(_+S*T/y*x);let M=(g*f+w)*4;const L=h[M+0],I=h[M+1],H=h[M+2],G=h[M+3];M=(D+T*f)*4,p[M+0]=L,p[M+1]=I,p[M+2]=H,p[M+3]=G}}},r=function(a,l,c){const h=a.data,p=l.data,f=a.width,u=a.height,m=c.polarCenterX||f/2,_=c.polarCenterY||u/2;let S=Math.sqrt(m*m+_*_),w=f-m,g=u-_;const d=Math.sqrt(w*w+g*g);S=d>S?d:S;const y=u,b=f,k=0;let D,x;for(w=0;w<f;w+=1)for(g=0;g<u;g+=1){const C=w-m,T=g-_,M=Math.sqrt(C*C+T*T)*y/S;let L=(Math.atan2(T,C)*180/Math.PI+360+k)%360;L=L*b/360,D=Math.floor(L),x=Math.floor(M);let I=(x*f+D)*4;const H=h[I+0],G=h[I+1],X=h[I+2],v=h[I+3];I=(g*f+w)*4,p[I+0]=H,p[I+1]=G,p[I+2]=X,p[I+3]=v}},o=function(a){const l=a.width,c=a.height;let h,p,f,u,m,_,S,w,g,d,y=Math.round(this.kaleidoscopePower());const b=Math.round(this.kaleidoscopeAngle()),k=Math.floor(l*(b%360)/360);if(y<1)return;const D=n.Util.createCanvasElement();D.width=l,D.height=c;const x=D.getContext("2d").getImageData(0,0,l,c);n.Util.releaseCanvas(D),s(a,x,{polarCenterX:l/2,polarCenterY:c/2});let C=l/Math.pow(2,y);for(;C<=8;)C=C*2,y-=1;C=Math.ceil(C);let T=C,M=0,L=T,I=1;for(k+C>l&&(M=T,L=0,I=-1),p=0;p<c;p+=1)for(h=M;h!==L;h+=I)f=Math.round(h+k)%l,g=(l*p+f)*4,m=x.data[g+0],_=x.data[g+1],S=x.data[g+2],w=x.data[g+3],d=(l*p+h)*4,x.data[d+0]=m,x.data[d+1]=_,x.data[d+2]=S,x.data[d+3]=w;for(p=0;p<c;p+=1)for(T=Math.floor(C),u=0;u<y;u+=1){for(h=0;h<T+1;h+=1)g=(l*p+h)*4,m=x.data[g+0],_=x.data[g+1],S=x.data[g+2],w=x.data[g+3],d=(l*p+T*2-h-1)*4,x.data[d+0]=m,x.data[d+1]=_,x.data[d+2]=S,x.data[d+3]=w;T*=2}r(x,a,{})};return ai.Kaleidoscope=o,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),ai}var li={},Hl;function rf(){if(Hl)return li;Hl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Mask=void 0;const t=bt(),e=Ot(),n=xt();function i(f,u,m){let _=(m*f.width+u)*4;const S=[];return S.push(f.data[_++],f.data[_++],f.data[_++],f.data[_++]),S}function s(f,u){return Math.sqrt(Math.pow(f[0]-u[0],2)+Math.pow(f[1]-u[1],2)+Math.pow(f[2]-u[2],2))}function r(f){const u=[0,0,0];for(let m=0;m<f.length;m++)u[0]+=f[m][0],u[1]+=f[m][1],u[2]+=f[m][2];return u[0]/=f.length,u[1]/=f.length,u[2]/=f.length,u}function o(f,u){const m=i(f,0,0),_=i(f,f.width-1,0),S=i(f,0,f.height-1),w=i(f,f.width-1,f.height-1),g=u||10;if(s(m,_)<g&&s(_,w)<g&&s(w,S)<g&&s(S,m)<g){const d=r([_,m,w,S]),y=[];for(let b=0;b<f.width*f.height;b++){const k=s(d,[f.data[b*4],f.data[b*4+1],f.data[b*4+2]]);y[b]=k<g?0:255}return y}}function a(f,u){for(let m=0;m<f.width*f.height;m++)f.data[4*m+3]=u[m]}function l(f,u,m){const _=[1,1,1,1,0,1,1,1,1],S=Math.round(Math.sqrt(_.length)),w=Math.floor(S/2),g=[];for(let d=0;d<m;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const C=d+D-w,T=y+x-w;if(C>=0&&C<m&&T>=0&&T<u){const M=C*u+T,L=_[D*S+x];k+=f[M]*L}}g[b]=k===2040?255:0}return g}function c(f,u,m){const _=[1,1,1,1,1,1,1,1,1],S=Math.round(Math.sqrt(_.length)),w=Math.floor(S/2),g=[];for(let d=0;d<m;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const C=d+D-w,T=y+x-w;if(C>=0&&C<m&&T>=0&&T<u){const M=C*u+T,L=_[D*S+x];k+=f[M]*L}}g[b]=k>=1020?255:0}return g}function h(f,u,m){const _=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],S=Math.round(Math.sqrt(_.length)),w=Math.floor(S/2),g=[];for(let d=0;d<m;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const C=d+D-w,T=y+x-w;if(C>=0&&C<m&&T>=0&&T<u){const M=C*u+T,L=_[D*S+x];k+=f[M]*L}}g[b]=k}return g}const p=function(f){const u=this.threshold();let m=o(f,u);return m&&(m=l(m,f.width,f.height),m=c(m,f.width,f.height),m=h(m,f.width,f.height),a(f,m)),f};return li.Mask=p,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),li}var ci={},Vl;function sf(){if(Vl)return ci;Vl=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.Noise=void 0;const t=bt(),e=Ot(),n=xt(),i=function(s){const r=this.noise()*255,o=s.data,a=o.length,l=r/2;for(let c=0;c<a;c+=4)o[c+0]+=l-2*l*Math.random(),o[c+1]+=l-2*l*Math.random(),o[c+2]+=l-2*l*Math.random()};return ci.Noise=i,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ci}var hi={},zl;function of(){if(zl)return hi;zl=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Pixelate=void 0;const t=bt(),e=Nt(),n=Ot(),i=xt(),s=function(r){let o=Math.ceil(this.pixelSize()),a=r.width,l=r.height,c=Math.ceil(a/o),h=Math.ceil(l/o),p=r.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let f=0;f<c;f+=1)for(let u=0;u<h;u+=1){let m=0,_=0,S=0,w=0;const g=f*o,d=g+o,y=u*o,b=y+o;let k=0;for(let D=g;D<d;D+=1)if(!(D>=a))for(let x=y;x<b;x+=1){if(x>=l)continue;const C=(a*x+D)*4;m+=p[C+0],_+=p[C+1],S+=p[C+2],w+=p[C+3],k+=1}m=m/k,_=_/k,S=S/k,w=w/k;for(let D=g;D<d;D+=1)if(!(D>=a))for(let x=y;x<b;x+=1){if(x>=l)continue;const C=(a*x+D)*4;p[C+0]=m,p[C+1]=_,p[C+2]=S,p[C+3]=w}}};return hi.Pixelate=s,t.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),hi}var di={},Wl;function af(){if(Wl)return di;Wl=1,Object.defineProperty(di,"__esModule",{value:!0}),di.Posterize=void 0;const t=bt(),e=Ot(),n=xt(),i=function(s){const r=Math.round(this.levels()*254)+1,o=s.data,a=o.length,l=255/r;for(let c=0;c<a;c+=1)o[c]=Math.floor(o[c]/l)*l};return di.Posterize=i,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),di}var ui={},$l;function lf(){if($l)return ui;$l=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.RGB=void 0;const t=bt(),e=Ot(),n=xt(),i=function(s){const r=s.data,o=r.length,a=this.red(),l=this.green(),c=this.blue();for(let h=0;h<o;h+=4){const p=(.34*r[h]+.5*r[h+1]+.16*r[h+2])/255;r[h]=p*a,r[h+1]=p*l,r[h+2]=p*c,r[h+3]=r[h+3]}};return ui.RGB=i,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),ui}var fi={},jl;function cf(){if(jl)return fi;jl=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.RGBA=void 0;const t=bt(),e=Ot(),n=xt(),i=function(s){const r=s.data,o=r.length,a=this.red(),l=this.green(),c=this.blue(),h=this.alpha();for(let p=0;p<o;p+=4){const f=1-h;r[p]=a*h+r[p]*f,r[p+1]=l*h+r[p+1]*f,r[p+2]=c*h+r[p+2]*f}};return fi.RGBA=i,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),fi}var gi={},ql;function hf(){if(ql)return gi;ql=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.Sepia=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4){const r=n[s+0],o=n[s+1],a=n[s+2];n[s+0]=Math.min(255,r*.393+o*.769+a*.189),n[s+1]=Math.min(255,r*.349+o*.686+a*.168),n[s+2]=Math.min(255,r*.272+o*.534+a*.131)}};return gi.Sepia=t,gi}var pi={},Kl;function df(){if(Kl)return pi;Kl=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Solarize=void 0;const t=function(e){const n=e.data,i=e.width,s=e.height,r=i*4;let o=s;do{const a=(o-1)*r;let l=i;do{const c=a+(l-1)*4;let h=n[c],p=n[c+1],f=n[c+2];h>127&&(h=255-h),p>127&&(p=255-p),f>127&&(f=255-f),n[c]=h,n[c+1]=p,n[c+2]=f}while(--l)}while(--o)};return pi.Solarize=t,pi}var mi={},Yl;function uf(){if(Yl)return mi;Yl=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.Threshold=void 0;const t=bt(),e=Ot(),n=xt(),i=function(s){const r=this.threshold()*255,o=s.data,a=o.length;for(let l=0;l<a;l+=1)o[l]=o[l]<r?0:255};return mi.Threshold=i,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),mi}var Xl;function ff(){if(Xl)return En;Xl=1,Object.defineProperty(En,"__esModule",{value:!0}),En.Konva=void 0;const t=Fu(),e=Du(),n=Ou(),i=Lu(),s=Gu(),r=Iu(),o=Uu(),a=ul(),l=ys(),c=Sl(),h=Bu(),p=Hu(),f=Vu(),u=zu(),m=kl(),_=Wu(),S=$u(),w=ju(),g=qu(),d=Ku(),y=Yu(),b=Xu(),k=Ju(),D=Qu(),x=Zu(),C=tf(),T=ef(),M=nf(),L=rf(),I=sf(),H=of(),G=af(),X=lf(),v=cf(),P=hf(),E=df(),A=uf();return En.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:s.Ellipse,Image:r.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:l.Path,Rect:c.Rect,RegularPolygon:h.RegularPolygon,Ring:p.Ring,Sprite:f.Sprite,Star:u.Star,Text:m.Text,TextPath:_.TextPath,Transformer:S.Transformer,Wedge:w.Wedge,Filters:{Blur:g.Blur,Brighten:d.Brighten,Contrast:y.Contrast,Emboss:b.Emboss,Enhance:k.Enhance,Grayscale:D.Grayscale,HSL:x.HSL,HSV:C.HSV,Invert:T.Invert,Kaleidoscope:M.Kaleidoscope,Mask:L.Mask,Noise:I.Noise,Pixelate:H.Pixelate,Posterize:G.Posterize,RGB:X.RGB,RGBA:v.RGBA,Sepia:P.Sepia,Solarize:E.Solarize,Threshold:A.Threshold}}),En}var gf=sr.exports,Jl;function pf(){if(Jl)return sr.exports;Jl=1,Object.defineProperty(gf,"__esModule",{value:!0});const t=ff();return sr.exports=t.Konva,sr.exports}var mf=pf();const tt=Au(mf);class yf{constructor(e,n,i){this.captureState=e,this.restoreState=n,this.onStateChange=i}history=[];historyIndex=-1;inUndoRedo=!1;maxHistorySize=50;executeCommand(e,n){if(this.inUndoRedo){n();return}const i=this.captureState();if(!i)return;n();const s=this.captureState();if(!s||i===s)return;const r={name:e,beforeState:i,afterState:s};this.history.splice(this.historyIndex+1),this.history.push(r),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${e}" added to history. Index: ${this.historyIndex}`)}pushCommand(e,n,i){if(!n||!i||n===i)return;const s={name:e,beforeState:n,afterState:i};this.history.splice(this.historyIndex+1),this.history.push(s),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${e}" pushed. Index: ${this.historyIndex}`)}undo(){if(this.historyIndex<0)return;this.inUndoRedo=!0;const e=this.history[this.historyIndex];console.log(`Undoing command: ${e.name}`),this.restoreState(e.beforeState),this.historyIndex--,this.onStateChange?.(),this.inUndoRedo=!1}redo(){if(this.historyIndex>=this.history.length-1)return;this.inUndoRedo=!0,this.historyIndex++;const e=this.history[this.historyIndex];console.log(`Redoing command: ${e.name}`),this.restoreState(e.afterState),this.onStateChange?.(),this.inUndoRedo=!1}canUndo(){return this.historyIndex>=0}canRedo(){return this.historyIndex<this.history.length-1}}const _f=()=>{const t=Po(new Set),e=new Map,n=Lt(()=>[...t].map(i=>i.konvaNode));return{stage:void 0,konvaContainer:void 0,activeTool:At("select"),layers:{grid:void 0,selectionOverlay:void 0,transformer:void 0,transformerLayer:void 0},grid:{visible:At(!1),size:20},canvasItems:new Map,callbacks:{},keyboardDisposables:[],freehand:{strokes:new Map,strokeGroups:new Map,dragSelectionState:At({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,isDrawing:!1,currentPoints:[],currentTimestamps:[],drawingStartTime:0,selectedStrokesForTimeline:At(new Set),timelineDuration:At(0),currentPlaybackTime:At(0),freehandDrawMode:At(!0),useRealTiming:At(!1),maxInterStrokeDelay:300,isAnimating:At(!1),freehandDragStartState:null,serializedState:"",bakedRenderData:[],bakedGroupMap:{}},polygon:{shapes:new Map,groups:new Map,isDrawing:At(!1),currentPoints:At([]),mode:At("draw"),dragStartState:null,proximityThreshold:10,serializedState:"",bakedRenderData:[]},selection:{items:t,originalStyles:e,selectedKonvaNodes:n,dragSelectionState:At({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,selectionDragState:{isDragging:!1,startPos:{x:0,y:0},startNodePositions:new Map,beforeState:""},transformStartState:""},command:{},metadata:{activeNode:At(null),metadataText:At(""),showEditor:At(!1),highlight:{}},ancillary:{activeVisualizations:At(new Set),nodeVisualizations:new Map,listenersAttached:!1,rafToken:null,activeWatchStop:void 0}}},Xt=t=>t.freehand.strokes,_s=t=>t.freehand.strokeGroups,ae=t=>t.polygon.shapes,Ke=(t,e,n)=>{if(!t.command.executeCommand){console.warn("executeCommand called before setup - falling back to direct execution"),n();return}t.command.executeCommand(e,n)},lr=(t,e,n,i)=>{if(!t.command.pushCommand){console.warn("pushCommandWithStates called before setup - ignoring");return}t.command.pushCommand(e,n,i)};function vf(t,e,n=!1){n||vs(t),t.selection.items.add(e),Ss(t),cr(t)}function bf(t,e,n=!1){t.selection.items.has(e)?t.selection.items.delete(e):(n||vs(t),t.selection.items.add(e)),Ss(t),cr(t)}function vs(t){bs(t),t.selection.items.clear(),cr(t)}function Sf(t,e){return t.selection.items.has(e)}function xf(t){return t.selection.items.size===0}function Cf(t){return t.selection.items.size}function wf(t){return t.selection.items.size===1?[...t.selection.items][0].konvaNode:null}function bs(t){t.selection.originalStyles.forEach(e=>{const n=e.node;n&&(n instanceof tt.Path||n instanceof tt.Line)&&(n.stroke(e.stroke),n.strokeWidth(e.strokeWidth))}),t.selection.originalStyles.clear(),xs(t)}function Ss(t){bs(t);for(const e of t.selection.items){const n=e.konvaNode;(n instanceof tt.Path||n instanceof tt.Line)&&(t.selection.originalStyles.set(e.id,{node:n,stroke:n.stroke(),strokeWidth:n.strokeWidth()}),n.stroke("#ff6b35"),n.strokeWidth(4))}xs(t)}function xs(t){const e=new Set;for(const n of t.selection.items){let i=n.konvaNode.getParent();for(;i&&!(i instanceof tt.Layer);)i=i.getParent();i instanceof tt.Layer&&e.add(i)}t.selection.originalStyles.forEach(n=>{let i=n.node.getParent();for(;i&&!(i instanceof tt.Layer);)i=i.getParent();i instanceof tt.Layer&&e.add(i)}),e.forEach(n=>n.batchDraw())}const Cs=(t,e)=>{const n=t.selection.originalStyles.size>0;n&&bs(t);try{return e()}finally{t.selection.items.size>0?Ss(t):n&&xs(t)}};function cr(t){t.callbacks.syncAppState?.(t),t.callbacks.refreshAncillaryViz?.()}function Pf(t,e,n){Ke(t,"Edit Metadata",()=>{e.setMetadata(n),cr(t)})}function hr(t,e,n=!1){vf(t,e,n)}function Tf(t,e,n=!1){bf(t,e,n)}function le(t){vs(t)}function Ql(t,e){return Sf(t,e)}function ws(t){return xf(t)}function dr(t){return Cf(t)}const kf=t=>wf(t);function Af(t,e,n){Pf(t,e,n)}const yi=(t="id_")=>`${t}${crypto.randomUUID()}`,ur=t=>{let e=1/0,n=-1/0,i=1/0,s=-1/0;for(let r=0;r<t.length;r+=2)e=Math.min(e,t[r]),n=Math.max(n,t[r]),i=Math.min(i,t[r+1]),s=Math.max(s,t[r+1]);return{minX:e,maxX:n,minY:i,maxY:s}},Rf=t=>{for(let e=0;e<t.length;e++)for(let n=e+1;n<t.length;n++)if(t[e].isAncestorOf(t[n])||t[n].isAncestorOf(t[e]))return!0;return!1},Zl=(t,e,n)=>{e.id()||e.id(yi("stroke_"));const i={id:e.id(),type:"stroke",konvaNode:e,getBounds(){const s=e.getClientRect();return{minX:s.x,maxX:s.x+s.width,minY:s.y,maxY:s.y+s.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(s){s===void 0||Object.keys(s).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",s)}};return t.canvasItems.set(i.id,i),i},Ps=(t,e)=>{e.id()||e.id(yi("group_"));const n={id:e.id(),type:"strokeGroup",konvaNode:e,getBounds(){const i=e.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",i)}};return t.canvasItems.set(n.id,n),n},Ts=(t,e)=>{e.id()||e.id(yi("poly_"));const n={id:e.id(),type:"polygon",konvaNode:e,getBounds(){const i=e.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",i)}};return t.canvasItems.set(n.id,n),n},Ef=(t,e)=>t.canvasItems.get(e.id()),Mf=(t,e)=>{t.canvasItems.delete(e)},fr=(t,e)=>Ef(t,e),tc=(t,e)=>{Mf(t,e)};function Ff(t,e,n,i=document.body){const s=o=>{o.key===e&&n(o)};i.addEventListener("keydown",s);const r=()=>{i.removeEventListener("keydown",s);const o=t.keyboardDisposables.indexOf(r);o!==-1&&t.keyboardDisposables.splice(o,1)};return t.keyboardDisposables.push(r),r}const Df=()=>({canceled:!1}),ec=t=>{t.token.canceled||(t.token.canceled=!0,t.frameId!==null&&(cancelAnimationFrame(t.frameId),t.frameId=null))},Nf=t=>{const e={frameId:null,token:Df()},n=i=>{if(e.token.canceled)return;e.frameId=null;const s=t(i,e.token);if(e.token.canceled||s===!1){ec(e);return}e.frameId=requestAnimationFrame(n)};return e.frameId=requestAnimationFrame(n),{token:e.token,cancel:()=>ec(e)}},Of={class:"timeline-container"},Lf={class:"timeline-controls"},Gf=["disabled"],If=["disabled"],Uf={class:"time-display"},Bf=rn({__name:"Timeline",props:{strokes:{type:Map},selectedStrokes:{type:Set},useRealTiming:{type:Boolean},maxInterStrokeDelay:{type:Number},overrideDuration:{type:Number},lockWhileAnimating:{type:Function}},emits:["timeUpdate"],setup(t,{emit:e}){const n=t,i=e,s=At(0),r=At(0),o=At(!1),a=At(null);let l,c=0,h=null;const p=()=>{if(n.overrideDuration!==void 0)r.value=n.overrideDuration;else{let D=0;const x=[];if(n.selectedStrokes.size>0)n.selectedStrokes.forEach(C=>{const T=n.strokes.get(C);T&&x.push(T)}),x.sort((C,T)=>{const M=parseInt(C.id.split("-")[1]||"0"),L=parseInt(T.id.split("-")[1]||"0");return M-L}),x.forEach((C,T)=>{if(C.timestamps&&C.timestamps.length>0){const M=C.timestamps[C.timestamps.length-1]||0;D+=M,T<x.length-1&&(D+=100)}});else{const C=Array.from(n.strokes.values());C.sort((M,L)=>{const I=parseInt(M.id.split("-")[1]||"0"),H=parseInt(L.id.split("-")[1]||"0");return I-H});let T=0;C.forEach((M,L)=>{if(M.timestamps&&M.timestamps.length>0){const I=M.creationTime||parseInt(M.id.split("-")[1]||"0"),H=M.timestamps[M.timestamps.length-1]||0;if(L===0)D=H,T=I+H;else{let G=Math.max(0,I-T);!n.useRealTiming&&G>n.maxInterStrokeDelay&&(G=n.maxInterStrokeDelay),D+=G+H,T=I+H}}})}r.value=D}r.value>0&&s.value>r.value&&(s.value=0,i("timeUpdate",0))};Gt([()=>n.strokes,()=>n.selectedStrokes,()=>n.useRealTiming,()=>n.maxInterStrokeDelay,()=>n.overrideDuration],()=>{p()},{immediate:!0,deep:!0});const f=Lt(()=>r.value===0?0:s.value/r.value*100),u=D=>{const x=Math.floor(D/1e3),C=Math.floor(D%1e3/10);return`${x}.${C.toString().padStart(2,"0")}s`},m=()=>{o.value||r.value===0||(o.value=!0,n.lockWhileAnimating?.(!0),c=performance.now()-s.value,l=Nf(()=>o.value?(s.value=performance.now()-c,s.value>=r.value?(s.value=0,o.value=!1,n.lockWhileAnimating?.(!1),i("timeUpdate",0),l=void 0,!1):(i("timeUpdate",s.value),!0)):(l=void 0,!1)))},_=()=>{o.value=!1;const D=s.value===0;n.lockWhileAnimating?.(!D),l?.cancel(),l=void 0},S=()=>{o.value=!1,w.value=!1,n.lockWhileAnimating?.(!1),s.value=0,l?.cancel(),l=void 0,i("timeUpdate",0)},w=At(!1),g=D=>{if(!h)return;const x=Math.max(0,Math.min(D.clientX-h.left,h.width)),C=h.width>0?x/h.width:0;s.value=C*r.value,i("timeUpdate",s.value)},d=D=>{w.value&&g(D)},y=()=>{if(!w.value)return;w.value=!1;const D=s.value===0;n.lockWhileAnimating?.(!D),h=null,window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",y)},b=D=>{D.preventDefault();const x=a.value;x&&(w.value=!0,n.lockWhileAnimating?.(!0),h=x.getBoundingClientRect(),window.addEventListener("mousemove",d),window.addEventListener("mouseup",y),g(D))},k=D=>{if(!w.value){const C=D.currentTarget.getBoundingClientRect(),M=Math.max(0,Math.min(D.clientX-C.left,C.width))/C.width;s.value=M*r.value;const L=s.value===0;n.lockWhileAnimating?.(!L),o.value&&(c=performance.now()-s.value),i("timeUpdate",s.value)}};return Cn(()=>{l?.cancel(),l=void 0,w.value&&(w.value=!1,n.lockWhileAnimating?.(!1)),h=null,window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",y)}),(D,x)=>(wt(),Tt("div",Of,[at("div",Lf,[at("button",{onClick:m,disabled:o.value},"▶️",8,Gf),at("button",{onClick:_,disabled:!o.value},"⏸️",8,If),at("button",{onClick:S},"⏹️"),at("span",Uf,ie(u(s.value))+" / "+ie(u(r.value)),1)]),at("div",{ref_key:"timelineTrackRef",ref:a,class:"timeline-track",onClick:k,onMousedown:b},[at("div",{class:"timeline-progress",style:Ue({width:f.value+"%"})},null,4),at("div",{class:"timeline-playhead",style:Ue({left:f.value+"%"}),onMousedown:Cu(b,["stop"])},null,36)],544)]))}}),Hf=".timeline-container[data-v-bbee97de]{width:600px;background:#fff;border:1px solid #ccc;border-radius:8px;padding:15px;box-shadow:0 2px 10px #0000001a;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.timeline-controls[data-v-bbee97de]{display:flex;align-items:center;gap:10px;margin-bottom:10px}.timeline-controls button[data-v-bbee97de]{background:none;border:1px solid #ccc;border-radius:4px;padding:5px 10px;cursor:pointer;font-size:16px}.timeline-controls button[data-v-bbee97de]:hover:not(:disabled){background:#f0f0f0}.timeline-controls button[data-v-bbee97de]:disabled{opacity:.5;cursor:not-allowed}.time-display[data-v-bbee97de]{margin-left:auto;font-family:monospace;font-size:14px;color:#666}.timeline-track[data-v-bbee97de]{position:relative;height:40px;background:#f0f0f0;border-radius:4px;cursor:pointer}.timeline-progress[data-v-bbee97de]{position:absolute;top:0;left:0;height:100%;background:#06f;border-radius:4px}.timeline-playhead[data-v-bbee97de]{position:absolute;top:-5px;width:10px;height:50px;background:#06f;border-radius:2px;transform:translate(-50%);cursor:grab;z-index:10}.timeline-playhead[data-v-bbee97de]:hover{background:#0052cc}.timeline-playhead[data-v-bbee97de]:active{cursor:grabbing}",_i=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n},Vf=_i(Bf,[["styles",[Hf]],["__scopeId","data-v-bbee97de"]]),zf={key:0,class:"metadata-editor"},Wf={class:"header"},$f={key:0,class:"unsaved-indicator"},jf={key:0},qf={class:"buttons"},Kf=["disabled"],Yf=["disabled"],Xf={key:1,class:"warning"},nc=_i(rn({__name:"MetadataEditor",props:{metadata:{type:null},visible:{type:Boolean},canEdit:{type:Boolean}},emits:["apply","cancel"],setup(t,{emit:e}){const n=t,i=e,s=At(""),r=At(""),o=Lt(()=>s.value!==r.value);Gt(()=>[n.metadata,n.canEdit],([c,h])=>{if(h){const p=JSON.stringify(c??{},null,2);s.value=p,r.value=p}else s.value="",r.value=""},{immediate:!0,deep:!0});const a=()=>{try{const c=JSON.parse(s.value||"{}");i("apply",c),r.value=s.value}catch{alert("Invalid JSON format")}},l=()=>{s.value=r.value};return(c,h)=>c.visible?(wt(),Tt("div",zf,[at("div",Wf,[o.value?(wt(),Tt("div",$f,h[1]||(h[1]=[at("span",{class:"dot"},null,-1),_a(" Unsaved changes ")]))):qt("",!0)]),c.canEdit?(wt(),Tt("div",jf,[h[2]||(h[2]=at("p",{class:"help"},"Edit the metadata as JSON:",-1)),Lo(at("textarea",{"onUpdate:modelValue":h[0]||(h[0]=p=>s.value=p),class:"textarea",placeholder:"{}"},null,512),[[vu,s.value]]),at("div",qf,[at("button",{onClick:a,class:"btn save",disabled:!o.value}," Save ",8,Kf),at("button",{onClick:l,class:"btn cancel",disabled:!o.value}," Cancel ",8,Yf)])])):(wt(),Tt("div",Xf,h[3]||(h[3]=[at("p",null,"Select multiple items to edit metadata (single selection only)",-1)])))])):qt("",!0)}}),[["styles",[".metadata-editor[data-v-894edfb8]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:6px 16px;margin-top:8px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-894edfb8]{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}.header h3[data-v-894edfb8]{margin:0;font-size:17px;color:#333}.unsaved-indicator[data-v-894edfb8]{display:flex;align-items:center;gap:6px;font-size:13px;color:#f39c12;font-weight:500}.dot[data-v-894edfb8]{width:6px;height:6px;background:#f39c12;border-radius:50%;animation:pulse-894edfb8 1.5s infinite}@keyframes pulse-894edfb8{0%,to{opacity:1}50%{opacity:.5}}.help[data-v-894edfb8]{margin:0 0 4px;color:#666;font-size:14px}.textarea[data-v-894edfb8]{width:100%;min-height:120px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:14px;line-height:1.3;resize:vertical;margin-bottom:4px}.textarea[data-v-894edfb8]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 2px #0066ff26}.buttons[data-v-894edfb8]{display:flex;gap:8px}.btn[data-v-894edfb8]{padding:4px 12px;border:1px solid;border-radius:4px;cursor:pointer;font-size:14px;transition:all .2s}.btn[data-v-894edfb8]:disabled{opacity:.5;cursor:not-allowed}.save[data-v-894edfb8]{background:#28a745;color:#fff;border-color:#28a745}.save[data-v-894edfb8]:hover:not(:disabled){background:#218838}.cancel[data-v-894edfb8]{background:#6c757d;color:#fff;border-color:#6c757d}.cancel[data-v-894edfb8]:hover:not(:disabled){background:#5a6268}.warning[data-v-894edfb8]{text-align:center;color:#e67e22;padding:8px}.warning p[data-v-894edfb8]{margin:0;font-size:15px}"]],["__scopeId","data-v-894edfb8"]]),Jf={class:"smart-metadata-editor"},Qf={key:1,class:"hierarchical-editor"},Zf={class:"header"},t0={key:0},e0={key:1,class:"multi-selection-header"},n0={class:"help"},i0={key:0,class:"tree-view"},r0=["onClick","onMouseenter"],s0={class:"label"},o0={key:0,class:"metadata-indicator"},a0={key:1,class:"empty-state"},l0={key:3,class:"selection-hint"},c0={key:2,class:"empty-state"},h0=_i(rn({__name:"HierarchicalMetadataEditor",props:{selectedNodes:{type:Array},singleNode:{type:[Object,null]},multiSelected:{type:Boolean},groupSelected:{type:Boolean},collectHierarchyFromRoot:{type:Function},updateMetadataHighlight:{type:Function},updateHoverHighlight:{type:Function},onApplyMetadata:{type:Function}},setup(t){const e=t,n=Lt(()=>e.selectedNodes),i=Lt(()=>e.singleNode),s=Lt(()=>e.multiSelected),r=Lt(()=>e.groupSelected),o=Lt(()=>s.value||r.value?"hierarchical":i.value?"simple":"none"),a=Lt(()=>{if(s.value)return e.collectHierarchyFromRoot(n.value);if(r.value){const g=n.value[0];return g?e.collectHierarchyFromRoot([g]):[]}return[]}),l=Mh(null),c=Lt(()=>{const g=i.value;return g?g.getAttr("metadata")??{}:null}),h=Lt(()=>{const g=l.value;return g?g.getAttr("metadata")??{}:null});Gt([o,r,n],([g,d])=>{if(g==="hierarchical"&&d){const y=n.value[0];y&&(l.value=y,e.updateMetadataHighlight(y))}else g==="simple"&&i.value?(l.value=i.value,e.updateMetadataHighlight(i.value)):(g==="hierarchical"&&s.value||g==="none")&&(l.value=null,e.updateMetadataHighlight(void 0))},{immediate:!0}),Gt(i,g=>{o.value==="simple"&&(l.value=g,e.updateMetadataHighlight(g))}),Gt(l,g=>{e.updateMetadataHighlight(g)}),Gt(o,g=>{g==="none"&&(l.value=null,e.updateMetadataHighlight(void 0))}),Cn(()=>{e.updateMetadataHighlight(void 0),e.updateHoverHighlight(void 0)});const p=g=>{l.value=g},f=g=>{i.value&&e.onApplyMetadata(i.value,g)},u=g=>{l.value&&e.onApplyMetadata(l.value,g)},m=g=>{const d=g,y=d.id()||`#${d._id}`;if(d instanceof tt.Group){const b=d.getChildren().length;return`Group ${y} (${b} ${b===1?"child":"children"})`}else return d instanceof tt.Path?`Stroke ${y}`:d instanceof tt.Line?`Polygon ${y}`:`${d.constructor.name} ${y}`},_=g=>{const y=g.getAttr("metadata");return y&&Object.keys(y).length>0},S=g=>{e.updateHoverHighlight(g)},w=()=>{e.updateHoverHighlight(void 0)};return(g,d)=>(wt(),Tt("div",Jf,[o.value==="simple"?(wt(),Ji(nc,{key:0,metadata:c.value,visible:!0,"can-edit":!!i.value,onApply:f},null,8,["metadata","can-edit"])):o.value==="hierarchical"?(wt(),Tt("div",Qf,[at("div",Zf,[r.value?(wt(),Tt("h3",t0,"Group: "+ie(m(n.value[0])),1)):s.value?(wt(),Tt("h3",e0,ie(n.value.length)+" items selected – single-item editing only ",1)):qt("",!0),at("p",n0,ie(s.value?"Pick one below to edit its metadata:":"Select a node to edit its metadata:"),1)]),a.value.length>0?(wt(),Tt("div",i0,[(wt(!0),Tt(jt,null,Ho(a.value,y=>(wt(),Tt("div",{key:y.indexPath,class:xe(["tree-row",{active:y.node===l.value}]),style:Ue({paddingLeft:y.depth*50+"px"}),onClick:b=>p(y.node),onMouseenter:b=>S(y.node),onMouseleave:w},[at("span",s0,ie(m(y.node)),1),_(y.node)?(wt(),Tt("span",o0,"●")):qt("",!0)],46,r0))),128))])):(wt(),Tt("div",a0,d[0]||(d[0]=[at("p",null,"No shapes or groups available",-1)]))),l.value?(wt(),Ji(nc,{key:2,metadata:h.value,visible:!0,"can-edit":!0,onApply:u},null,8,["metadata"])):s.value?(wt(),Tt("div",l0,d[1]||(d[1]=[at("p",null,"← Click a row above to edit its metadata",-1)]))):qt("",!0)])):(wt(),Tt("div",c0,d[2]||(d[2]=[at("p",null,"Select something to edit its metadata",-1)])))]))}}),[["styles",[".smart-metadata-editor[data-v-cb312d1a]{margin-top:8px}.hierarchical-editor[data-v-cb312d1a]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:8px 16px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-cb312d1a]{margin-bottom:8px}.header h3[data-v-cb312d1a]{margin:0 0 4px;font-size:17px;color:#333}.multi-selection-header[data-v-cb312d1a]{color:#e67e22!important;font-weight:700}.help[data-v-cb312d1a]{margin:0;color:#666;font-size:14px}.tree-view[data-v-cb312d1a]{max-height:300px;overflow-y:auto;border:1px solid #eee;border-radius:4px;margin-bottom:8px}.tree-row[data-v-cb312d1a]{display:flex;align-items:center;justify-content:space-between;padding:4px 8px;cursor:pointer;user-select:none;border-bottom:1px solid #f5f5f5;transition:background-color .15s}.tree-row[data-v-cb312d1a]:last-child{border-bottom:none}.tree-row[data-v-cb312d1a]:hover{background-color:#f8f9fa}.tree-row.active[data-v-cb312d1a]{background-color:#fff2f2;border-left:3px solid #dc3545}.label[data-v-cb312d1a]{font-family:Monaco,Consolas,monospace;font-size:13px;color:#333}.metadata-indicator[data-v-cb312d1a]{color:#28a745;font-size:12px;font-weight:700}.empty-state[data-v-cb312d1a]{text-align:center;color:#666;padding:20px;font-style:italic}.empty-state p[data-v-cb312d1a]{margin:0}.selection-hint[data-v-cb312d1a]{text-align:center;color:#666;padding:15px;font-style:italic;border:2px dashed #ddd;border-radius:6px;margin-top:10px}.selection-hint p[data-v-cb312d1a]{margin:0}"]],["__scopeId","data-v-cb312d1a"]]),ic=t=>{const e=[],n=(i,s=0,r="")=>{e.push({node:i,depth:s,indexPath:r}),i instanceof tt.Group&&i.getChildren().forEach((o,a)=>n(o,s+1,r?`${r}/${a}`:`${a}`))};return t.forEach((i,s)=>n(i,0,`${s}`)),e},d0=t=>t?ic(t.getChildren()):[],gr=new Map,rc=t=>gr.set(t.key,t),sc=()=>Array.from(gr.values()),u0=t=>t.ancillary.nodeVisualizations,oc=t=>{const e=t.stage;if(e){if(!t.layers.ancillaryViz){const n=new tt.Layer({listening:!1,name:"ancillary-vis"});t.layers.ancillaryViz=n,e.add(n)}return t.layers.ancillaryViz}},f0=t=>{t.stage&&t.ancillary.rafToken===null&&(t.ancillary.rafToken=requestAnimationFrame(()=>{t.ancillary.rafToken=null,Ye(t)}))},g0=t=>{const e=t.stage;if(!e||t.ancillary.listenersAttached)return;const n=()=>f0(t);e.on("dragmove.av transform.av",n),e.on("destroy.av",n),e.on("dragend.av transformend.av",()=>Ye(t)),t.ancillary.listenersAttached=!0},p0=t=>{t.ancillary.activeWatchStop||(t.ancillary.activeWatchStop=Gt(()=>t.ancillary.activeVisualizations.value,()=>Ye(t),{deep:!0}))},ac=t=>{t.stage&&(oc(t),g0(t),p0(t),Ye(t))},Ye=t=>{const e=t.stage,n=oc(t);if(!e||!n)return;const s=d0(t.layers.freehandShape).filter(l=>l.depth===0).map(l=>l.node),r=new Map,o=t.ancillary.activeVisualizations.value;s.forEach(l=>{const c=l.getAttr("metadata")??{},h=l.getClientRect({relativeTo:e}),p={node:l,metadata:c,bbox:h};o.forEach(f=>{const u=gr.get(f);u&&u.validate(p)&&r.set(`${f}|${l.id()}`,{ctx:p,def:u})})});const a=u0(t);a.forEach((l,c)=>{r.has(c)||(gr.get(l.key)?.destroy?.(l.nodes),(Array.isArray(l.nodes)?l.nodes:[l.nodes]).forEach(f=>f.destroy()),a.delete(c))}),r.forEach((l,c)=>{const h=a.get(c);if(h)l.def.update?.(l.ctx,h.nodes);else{const p=l.def.create(l.ctx);(Array.isArray(p)?p:[p]).forEach(u=>n.add(u)),a.set(c,{key:l.def.key,nodes:p})}}),n.batchDraw()},m0=Object.freeze(Object.defineProperty({__proto__:null,getRegisteredAVs:sc,initAVLayer:ac,refreshAnciliaryViz:Ye,registerAV:rc},Symbol.toStringTag,{value:"Module"}));rc({key:"typo-guides",displayName:"Typography Guidelines",validate:({metadata:t})=>["lowLine","midLine","capHeight","ascender","descender","baseline"].some(e=>e in t&&typeof t[e]=="number"),create:t=>lc(t),update:(t,e)=>lc(t,e)});function lc({bbox:t,metadata:e},n){const i=[4,4],r=[{key:"baseline",fraction:e.baseline,color:"#333"},{key:"lowLine",fraction:e.lowLine,color:"#888"},{key:"midLine",fraction:e.midLine,color:"#f80"},{key:"capHeight",fraction:e.capHeight,color:"#0a0"},{key:"ascender",fraction:e.ascender,color:"#00f"},{key:"descender",fraction:e.descender,color:"#f00"}].filter(o=>o.fraction!==void 0&&typeof o.fraction=="number"&&o.fraction>=0&&o.fraction<=1).map(o=>{const a=t.y+t.height*o.fraction;return new tt.Line({points:[t.x,a,t.x+t.width,a],stroke:o.color,strokeWidth:1,dash:i,listening:!1,name:`typo-guide-${o.key}`})});return n?(n.forEach((o,a)=>{if(a<r.length){const l=r[a];o.points(l.points()),o.stroke(l.stroke())}}),n.length>r.length&&(n.slice(r.length).forEach(o=>o.destroy()),n.splice(r.length)),r.length>n.length&&n.push(...r.slice(n.length)),n):r}const y0={key:0,class:"av-toggle-pane"},_0={class:"toggles-grid"},v0=["checked","onChange"],b0=_i(rn({__name:"VisualizationToggles",props:{canvasState:{type:Object}},setup(t){const e=t,n=Lt(()=>sc()),i=Lt(()=>e.canvasState.ancillary.activeVisualizations.value),s=(o,a)=>{const l=new Set(i.value);a?l.add(o):l.delete(o),e.canvasState.ancillary.activeVisualizations.value=l},r=(o,a)=>{const l=a.target.checked;s(o,l)};return(o,a)=>n.value.length>0?(wt(),Tt("div",y0,[a[0]||(a[0]=at("h4",null,"Visualizations",-1)),at("div",_0,[(wt(!0),Tt(jt,null,Ho(n.value,l=>(wt(),Tt("label",{key:l.key,class:"toggle-item"},[at("input",{type:"checkbox",checked:i.value.has(l.key),onChange:c=>r(l.key,c)},null,40,v0),at("span",null,ie(l.displayName),1)]))),128))])])):qt("",!0)}}),[["styles",[".av-toggle-pane[data-v-641f8251]{background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px;font-size:13px}.av-toggle-pane h4[data-v-641f8251]{margin:0 0 8px;font-size:14px;color:#333;font-weight:600}.toggles-grid[data-v-641f8251]{display:flex;flex-direction:column;gap:6px}.toggle-item[data-v-641f8251]{display:flex;align-items:center;gap:8px;cursor:pointer;transition:background-color .2s;padding:4px 6px;border-radius:4px}.toggle-item[data-v-641f8251]:hover{background-color:#f0f0f0}.toggle-item input[type=checkbox][data-v-641f8251]{margin:0;cursor:pointer}.toggle-item span[data-v-641f8251]{color:#555;font-size:13px;user-select:none}.toggle-item input[type=checkbox]:checked+span[data-v-641f8251]{color:#333;font-weight:500}"]],["__scopeId","data-v-641f8251"]]);function cc(t,e,n,i=s=>s){return t*i(.5-e*(.5-n))}function S0(t){return[-t[0],-t[1]]}function ue(t,e){return[t[0]+e[0],t[1]+e[1]]}function ce(t,e){return[t[0]-e[0],t[1]-e[1]]}function fe(t,e){return[t[0]*e,t[1]*e]}function x0(t,e){return[t[0]/e,t[1]/e]}function vi(t){return[t[1],-t[0]]}function hc(t,e){return t[0]*e[0]+t[1]*e[1]}function C0(t,e){return t[0]===e[0]&&t[1]===e[1]}function w0(t){return Math.hypot(t[0],t[1])}function P0(t){return t[0]*t[0]+t[1]*t[1]}function dc(t,e){return P0(ce(t,e))}function uc(t){return x0(t,w0(t))}function T0(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function bi(t,e,n){let i=Math.sin(n),s=Math.cos(n),r=t[0]-e[0],o=t[1]-e[1],a=r*s-o*i,l=r*i+o*s;return[a+e[0],l+e[1]]}function ks(t,e,n){return ue(t,fe(ce(e,t),n))}function fc(t,e,n){return ue(t,fe(e,n))}var{min:cn,PI:k0}=Math,gc=.275,Si=k0+1e-4;function A0(t,e={}){let{size:n=16,smoothing:i=.5,thinning:s=.5,simulatePressure:r=!0,easing:o=v=>v,start:a={},end:l={},last:c=!1}=e,{cap:h=!0,easing:p=v=>v*(2-v)}=a,{cap:f=!0,easing:u=v=>--v*v*v+1}=l;if(t.length===0||n<=0)return[];let m=t[t.length-1].runningLength,_=a.taper===!1?0:a.taper===!0?Math.max(n,m):a.taper,S=l.taper===!1?0:l.taper===!0?Math.max(n,m):l.taper,w=Math.pow(n*i,2),g=[],d=[],y=t.slice(0,10).reduce((v,P)=>{let E=P.pressure;if(r){let A=cn(1,P.distance/n),O=cn(1,1-A);E=cn(1,v+(O-v)*(A*gc))}return(v+E)/2},t[0].pressure),b=cc(n,s,t[t.length-1].pressure,o),k,D=t[0].vector,x=t[0].point,C=x,T=x,M=C,L=!1;for(let v=0;v<t.length;v++){let{pressure:P}=t[v],{point:E,vector:A,distance:O,runningLength:j}=t[v];if(v<t.length-1&&m-j<3)continue;if(s){if(r){let it=cn(1,O/n),ct=cn(1,1-it);P=cn(1,y+(ct-y)*(it*gc))}b=cc(n,s,P,o)}else b=n/2;k===void 0&&(k=b);let B=j<_?p(j/_):1,J=m-j<S?u((m-j)/S):1;b=Math.max(.01,b*Math.min(B,J));let st=(v<t.length-1?t[v+1]:t[v]).vector,$=v<t.length-1?hc(A,st):1,F=hc(A,D)<0&&!L,W=$!==null&&$<0;if(F||W){let it=fe(vi(D),b);for(let ct=.07692307692307693,R=0;R<=1;R+=ct)T=bi(ce(E,it),E,Si*R),g.push(T),M=bi(ue(E,it),E,Si*-R),d.push(M);x=T,C=M,W&&(L=!0);continue}if(L=!1,v===t.length-1){let it=fe(vi(A),b);g.push(ce(E,it)),d.push(ue(E,it));continue}let nt=fe(vi(ks(st,A,$)),b);T=ce(E,nt),(v<=1||dc(x,T)>w)&&(g.push(T),x=T),M=ue(E,nt),(v<=1||dc(C,M)>w)&&(d.push(M),C=M),y=P,D=A}let I=t[0].point.slice(0,2),H=t.length>1?t[t.length-1].point.slice(0,2):ue(t[0].point,[1,1]),G=[],X=[];if(t.length===1){if(!(_||S)||c){let v=fc(I,uc(vi(ce(I,H))),-(k||b)),P=[];for(let E=.07692307692307693,A=E;A<=1;A+=E)P.push(bi(v,I,Si*2*A));return P}}else{if(!(_||S&&t.length===1))if(h)for(let P=.07692307692307693,E=P;E<=1;E+=P){let A=bi(d[0],I,Si*E);G.push(A)}else{let P=ce(g[0],d[0]),E=fe(P,.5),A=fe(P,.51);G.push(ce(I,E),ce(I,A),ue(I,A),ue(I,E))}let v=vi(S0(t[t.length-1].vector));if(S||_&&t.length===1)X.push(H);else if(f){let P=fc(H,v,b);for(let E=.034482758620689655,A=E;A<1;A+=E)X.push(bi(P,H,Si*3*A))}else X.push(ue(H,fe(v,b)),ue(H,fe(v,b*.99)),ce(H,fe(v,b*.99)),ce(H,fe(v,b)))}return g.concat(X,d.reverse(),G)}function R0(t,e={}){var n;let{streamline:i=.5,size:s=16,last:r=!1}=e;if(t.length===0)return[];let o=.15+(1-i)*.85,a=Array.isArray(t[0])?t:t.map(({x:u,y:m,pressure:_=.5})=>[u,m,_]);if(a.length===2){let u=a[1];a=a.slice(0,-1);for(let m=1;m<5;m++)a.push(ks(a[0],u,m/4))}a.length===1&&(a=[...a,[...ue(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,h=0,p=l[0],f=a.length-1;for(let u=1;u<a.length;u++){let m=r&&u===f?a[u].slice(0,2):ks(p.point,a[u],o);if(C0(p.point,m))continue;let _=T0(m,p.point);if(h+=_,u<f&&!c){if(h<s)continue;c=!0}p={point:m,pressure:a[u][2]>=0?a[u][2]:.5,vector:uc(ce(p.point,m)),distance:_,runningLength:h},l.push(p)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function E0(t,e={}){return A0(R0(t,e),e)}var M0=E0;const As=t=>t.metadata.highlight.layer,F0=t=>t.metadata.highlight.metadataRect,D0=t=>t.metadata.highlight.hoverRect,pc=(t,e)=>{const n=As(t);if(n)return n;const i=new tt.Layer({listening:!1}),s=new tt.Rect({stroke:"red",strokeWidth:2,dash:[4,4],listening:!1,visible:!1}),r=new tt.Rect({stroke:"green",strokeWidth:2,dash:[4,4],listening:!1,visible:!1});return i.add(s),i.add(r),e.add(i),t.metadata.highlight.layer=i,t.metadata.highlight.metadataRect=s,t.metadata.highlight.hoverRect=r,t.layers.metadataHighlight=i,i},N0=(t,e)=>{const n=F0(t),i=As(t);if(!n||!i)return;if(!e){n.visible(!1),i.batchDraw();return}const s=e.getClientRect({relativeTo:e.getStage()});n.setAttrs({x:s.x,y:s.y,width:s.width,height:s.height,visible:!0}),i.batchDraw()},O0=(t,e)=>{const n=D0(t),i=As(t);if(!n||!i)return;if(!e){n.visible(!1),i.batchDraw();return}const s=e.getClientRect({relativeTo:e.getStage()});n.setAttrs({x:s.x,y:s.y,width:s.width,height:s.height,visible:!0}),i.batchDraw()},L0=t=>({setNodeMetadata:(e,n)=>{n===void 0||Object.keys(n).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",n)},collectHierarchyFromRoot:ic,updateMetadataHighlight:e=>N0(t,e),updateHoverHighlight:e=>O0(t,e)}),Rs=(t,e)=>{e instanceof tt.Path?Zl(t,e):e instanceof tt.Group&&(Ps(t,e),e.getChildren().forEach(n=>Rs(t,n)))},pr=(t,e)=>{(e instanceof tt.Path||e instanceof tt.Group)&&(e instanceof tt.Path,e.draggable(!0),e.off("click.freehand"),e.off("dragstart.freehand"),e.off("dragend.freehand"),e.on("dragstart.freehand",()=>{Ms(t)}),e.on("dragend.freehand",()=>{Fs(t,e.constructor.name),t.layers.freehandShape?.batchDraw()}),e instanceof tt.Group&&e.getChildren().forEach(n=>{pr(t,n)}))},mc=(t,e,n=0,i=0)=>{const s=e.clone({x:e.x()+n,y:e.y()+i}),r=(o,a)=>{const l=yi();if(o.id(l),o instanceof tt.Path){const c=Array.from(Xt(t).values()).find(h=>h.shape===a);if(c){const h={...c,id:l,shape:o};Xt(t).set(l,h),console.log("Created stroke data for cloned Path:",l)}}else if(o instanceof tt.Group){const c=a,h=o;h.getChildren().forEach((f,u)=>{const m=c.getChildren()[u];r(f,m)});const p=h.find("Path").map(f=>f.id());p.length>0&&(_s(t).set(l,{id:l,strokeIds:p,group:h}),console.log("Created group data for cloned Group:",l,"with strokes:",p))}};return r(s,e),pr(t,s),Rs(t,s),console.log("Successfully cloned",e.className,"with new ID:",s.id()),s},yc=(t,e)=>{t.layers.freehandShape=new tt.Layer,t.layers.freehandDrawing=new tt.Layer,t.layers.freehandSelection=new tt.Layer,e.add(t.layers.freehandShape),e.add(t.layers.freehandDrawing),e.add(t.layers.freehandSelection)},_c=t=>{const e=[],n=new Set;return t.selection.selectedKonvaNodes.value.forEach(i=>{if(i instanceof tt.Group){const s=r=>{r.getChildren().forEach(o=>{o instanceof tt.Group?s(o):o instanceof tt.Path&&Array.from(Xt(t).values()).forEach(a=>{a.shape===o&&!n.has(a.id)&&(e.push(a),n.add(a.id))})})};s(i)}else i instanceof tt.Path&&Array.from(Xt(t).values()).forEach(s=>{s.shape===i&&!n.has(s.id)&&(e.push(s),n.add(s.id))})}),e},Es=t=>{t.freehand.timelineDuration.value;let e=0;if(ws(t))t.freehand.selectedStrokesForTimeline.value=new Set,t.freehand.timelineDuration.value=0;else{const n=_c(t).filter(s=>s.isFreehand),i=new Set(n.map(s=>s.id));if(t.freehand.selectedStrokesForTimeline.value=i,n.length>0){const s=n.sort((o,a)=>o.creationTime-a.creationTime);let r=0;s.forEach((o,a)=>{const l=o.timestamps[o.timestamps.length-1]||0;r+=l,a<s.length-1&&(r+=100)}),e=r,t.freehand.timelineDuration.value=r}else t.freehand.timelineDuration.value=0}e>0&&t.freehand.currentPlaybackTime.value>e&&(t.freehand.currentPlaybackTime.value=0,Ls(t,0))},vc=t=>{t.freehand.strokes.clear(),t.freehand.strokeGroups.clear()},bc=(t,e,n)=>{const i={id:n.id,points:n.points,timestamps:n.timestamps,shape:n.shape,selected:n.selected,originalPath:n.originalPath,creationTime:n.creationTime,isFreehand:n.isFreehand};t.freehand.strokes.set(e,i)},Sc=(t,e,n)=>{const i={id:n.id,strokeIds:n.strokeIds,group:n.group};t.freehand.strokeGroups.set(e,i)},mr=300,xc=t=>Cs(t,()=>{const e=t.layers.freehandShape;if(!t.stage||!e)return null;try{const i=e.toObject(),s=Array.from(t.freehand.strokes.entries()),r=Array.from(t.freehand.strokeGroups.entries());return{layer:i,strokes:s,strokeGroups:r}}catch(i){return console.warn("Failed to get current state:",i),null}}),Ge=t=>{const e=xc(t);return JSON.stringify(e)},Cc=(t,e,n={})=>{if(e)try{const i=t.freehand.currentPlaybackTime.value>0;t.freehand.currentPlaybackTime.value=0,t.freehand.isAnimating.value=!1,Ns(t,e),i&&n.handleTimeUpdate?.(0)}catch(i){console.warn("Failed to restore state:",i)}},Ms=t=>{t.freehand.freehandDragStartState=Ge(t)},Fs=(t,e)=>{if(!t.freehand.freehandDragStartState)return;const n=Ge(t);t.freehand.freehandDragStartState!==n&&(lr(t,`Transform ${e}`,t.freehand.freehandDragStartState,n),console.log("Transform command added to global history"),ge(t)),t.freehand.freehandDragStartState=null},Ds=t=>{const e=t.stage;e&&Xt(t).forEach((n,i)=>{const s=e.findOne(`#${i}`);s&&s!==n.shape&&(console.log("Updating stroke connection for:",i),n.shape=s)})},wc=t=>{const e=t.layers.freehandShape;if(!(!t.stage||!e))try{const i=xc(t);if(!i)return;t.freehand.serializedState=JSON.stringify(i),t.callbacks.syncAppState?.(t),console.log("Serialized canvas state:",{layerChildren:i.layer?.children?.length||0,strokes:i.strokes.length,strokeGroups:i.strokeGroups.length})}catch(i){console.warn("Failed to serialize Konva state:",i)}},Ns=(t,e)=>{const n=t.layers.freehandShape,i=t.stage;if(!(!e||!i||!n))try{const s=JSON.parse(e);console.log("Deserializing canvas state:",{layerChildren:s.layer?.children?.length||0,strokes:s.strokes?.length||0,strokeGroups:s.strokeGroups?.length||0}),n.destroyChildren(),vc(t),le(t);const r=s.layer;r&&r.children&&(console.log("Restoring",r.children.length,"children"),r.children.forEach((o,a)=>{console.log("Creating node",a,"of type",o.className);const l=tt.Node.create(JSON.stringify(o));n.add(l),console.log("Added node to layer:",l.id(),l.isVisible()),pr(t,l),Rs(t,l)})),s.strokes&&s.strokes.forEach(([o,a])=>{const l=i.findOne(`#${o}`);console.log("Restoring stroke:",o,"found shape:",!!l);const c={id:a.id,points:a.points,timestamps:a.timestamps,originalPath:a.originalPath,creationTime:a.creationTime,isFreehand:a.isFreehand,shape:l};bc(t,o,c)}),s.strokeGroups&&s.strokeGroups.forEach(([o,a])=>{const l={id:a.id,strokeIds:a.strokeIds,group:i.findOne(`#${o}`)};Sc(t,o,l)}),Ds(t),Os(t),n.batchDraw(),console.log("Konva canvas state restored from hotreload"),t.freehand.serializedState=e,setTimeout(()=>{n.batchDraw(),ge(t)},30)}catch(s){console.warn("Failed to deserialize Konva state:",s)}},Os=t=>{const e=t.layers.freehandShape;Xt(t).forEach(n=>{n.shape&&n.shape.draggable(!1)}),e&&e.getChildren().forEach(n=>{n instanceof tt.Group&&n.draggable(!1)})},xi=(t,e=!1)=>{if(t.length<4)return"";const n=[];for(let o=0;o<t.length;o+=2)n.push([t[o],t[o+1]]);const i=M0(n,{size:8,thinning:.5,smoothing:.5,streamline:.5,simulatePressure:!0});if(i.length===0)return"";let s=i;if(e){let o=1/0,a=1/0;i.forEach(([l,c])=>{o=Math.min(o,l),a=Math.min(a,c)}),s=i.map(([l,c])=>[l-o,c-a])}return`${s.reduce((o,[a,l],c,h)=>{const[p,f]=h[(c+1)%h.length];return`${o} ${a},${l} ${p},${f}`},`M ${s[0][0]},${s[0][1]} L`)} Z`},Pc=(t,e,n)=>{const i=t.layers.freehandShape,s=ur(e),r=[];for(let a=0;a<e.length;a+=2)r.push(e[a]-s.minX),r.push(e[a+1]-s.minY);const o=new tt.Path({data:xi(r),fill:"black",strokeWidth:0,id:n,x:s.minX,y:s.minY,draggable:!0});return o.on("dragstart",()=>{Ms(t)}),o.on("dragend",()=>{Fs(t,"Stroke"),i?.batchDraw()}),Zl(t,o),o},Ls=(t,e)=>{const n=t.layers.freehandShape;t.freehand.currentPlaybackTime.value=e;let i=[];const s=!ws(t);if(s?i=_c(t).filter(c=>c.isFreehand):i=Array.from(Xt(t).values()).filter(l=>l.isFreehand),i.sort((l,c)=>l.creationTime-c.creationTime),e===0){if(s){const l=new Set;i.forEach(c=>{if(c.shape&&c.originalPath){c.shape.show(),c.shape.data(c.originalPath);let h=c.shape.getParent();for(;h&&h!==n;)h instanceof tt.Group&&l.add(h),h=h.getParent()}}),l.forEach(c=>c.show())}else Xt(t).forEach(l=>{l.shape&&l.originalPath&&l.isFreehand&&(l.shape.show(),l.shape.data(l.originalPath))}),n&&n.getChildren().forEach(l=>{l instanceof tt.Group&&l.show()});n?.batchDraw();return}s?i.forEach(l=>{l.shape&&l.shape.hide()}):(Xt(t).forEach(l=>{l.shape&&l.isFreehand&&l.shape.hide()}),n&&n.getChildren().forEach(l=>{l instanceof tt.Group&&l.hide()}));let r=0;const o=[];if(s)i.forEach((l,c)=>{const h=l.timestamps[l.timestamps.length-1]||0;o.push({stroke:l,startTime:r,endTime:r+h}),r+=h+(c<i.length-1?100:0)});else{let l=0;i.forEach((c,h)=>{const p=c.timestamps[c.timestamps.length-1]||0;if(h===0)o.push({stroke:c,startTime:0,endTime:p}),l=c.creationTime+p,r=p;else{let f=Math.max(0,c.creationTime-l);!t.freehand.useRealTiming.value&&f>mr&&(f=mr);const u=r+f;o.push({stroke:c,startTime:u,endTime:u+p}),r=u+p,l=c.creationTime+p}})}const a=new Set;o.forEach(({stroke:l,startTime:c,endTime:h})=>{if(!(!l.shape||!l.timestamps)){if(e>=c&&e<=h){const p=e-c;let f=-1;for(let u=0;u<l.timestamps.length&&l.timestamps[u]<=p;u++)f=u;if(f>=0){const u=l.points.slice(0,(f+1)*2);if(u.length>=4){const m=ur(l.points),_=[];for(let w=0;w<u.length;w+=2)_.push(u[w]-m.minX),_.push(u[w+1]-m.minY);l.shape.show(),l.shape.data(xi(_));let S=l.shape.getParent();for(;S&&S!==n;)S instanceof tt.Group&&a.add(S),S=S.getParent()}}}else if(e>h){l.shape.show(),l.shape.data(l.originalPath);let p=l.shape.getParent();for(;p&&p!==n;)p instanceof tt.Group&&a.add(p),p=p.getParent()}}}),a.forEach(l=>l.show()),n?.batchDraw()},G0=t=>{const e=t.layers.freehandShape;if(!e)return{data:[],groupMap:{}};const n=(a,l)=>{const c=ur(a),h=[];for(let u=0;u<a.length;u+=2)h.push(a[u]-c.minX),h.push(a[u+1]-c.minY);const p=l.getAbsoluteTransform(),f=[];for(let u=0;u<h.length;u+=2){const m=p.point({x:h[u],y:h[u+1]});f.push({x:m.x,y:m.y})}return f};let i=0;const s={},r=a=>{if(a instanceof tt.Path){const l=Array.from(t.freehand.strokes.values()).find(f=>f.shape===a);if(!l)return null;const h=n(l.points,a).map((f,u)=>({x:f.x,y:f.y,ts:l.timestamps[Math.floor(u/2)]||0})),p=a.getAttr("metadata");return p&&p.name&&typeof p.name=="string"&&(s[p.name]||(s[p.name]=[]),s[p.name].push(i)),i++,{type:"stroke",points:h,...p&&{metadata:p}}}else if(a instanceof tt.Group){const l=i,c=[];if(a.getChildren().forEach(p=>{const f=r(p);f&&c.push(f)}),c.length===0)return null;const h=a.getAttr("metadata");if(h&&h.name&&typeof h.name=="string"){const p=[];for(let f=l;f<i;f++)p.push(f);s[h.name]=p}return{type:"strokeGroup",children:c,...h&&{metadata:h}}}return null},o=[];return e.getChildren().forEach(a=>{const l=r(a);l&&(l.type==="stroke"?o.push({type:"strokeGroup",children:[l]}):o.push(l))}),{data:o,groupMap:s}},ge=t=>{const e=G0(t);t.freehand.bakedRenderData=e.data,t.freehand.bakedGroupMap=e.groupMap,t.callbacks.syncAppState?.(t)},Tc=Object.freeze(Object.defineProperty({__proto__:null,attachHandlersRecursively:pr,clearStrokesInState:vc,createStrokeShape:Pc,deepCloneWithNewIds:mc,deserializeFreehandState:Ns,finishFreehandDragTracking:Fs,getCurrentFreehandStateString:Ge,getStrokePath:xi,handleTimeUpdate:Ls,initFreehandLayers:yc,maxInterStrokeDelay:mr,refreshStrokeConnections:Ds,restoreFreehandState:Cc,serializeFreehandState:wc,setStrokeGroupInState:Sc,setStrokeInState:bc,startFreehandDragTracking:Ms,updateBakedFreehandData:ge,updateFreehandDraggableStates:Os,updateTimelineState:Es},Symbol.toStringTag,{value:"Module"})),I0=(t,e,n)=>{const i=e.x-t.x,s=e.y-t.y,r=n.x-t.x,o=n.y-t.y,a=i*r+s*o;if(a<=0)return Math.hypot(r,o);const l=i*i+s*s;if(l<=a)return Math.hypot(n.x-e.x,n.y-e.y);const c=a/l,h=t.x+c*i,p=t.y+c*s;return Math.hypot(n.x-h,n.y-p)};function kc(t,e){let n=-1,i=-1,s=1/0;for(let r=0;r<t.length;r++){const o=t[r];for(let a=0;a<o.points.length;a++){const l=o.points[a],c=o.points[(a+1)%o.points.length],h=I0(l,c,e);h<s&&(s=h,n=r,i=a)}}return{polygonIndex:n,lineIndex:i,distance:s}}const Ac=(t,e)=>{t.layers.polygonShapes=new tt.Layer,t.layers.polygonPreview=new tt.Layer,t.layers.polygonControls=new tt.Layer,t.layers.polygonSelection=new tt.Layer,e.add(t.layers.polygonShapes),e.add(t.layers.polygonPreview),e.add(t.layers.polygonControls),e.add(t.layers.polygonSelection)},Gs=t=>{le(t)},Rc=t=>{const e=t.layers.polygonShapes;if(!e)return[];const n=[],i=(s,r)=>{const o=[],a=r.getAbsoluteTransform();for(let l=0;l<s.length;l+=2){const c=a.point({x:s[l],y:s[l+1]});o.push({x:c.x,y:c.y})}return o};return e.getChildren().forEach(s=>{if(s instanceof tt.Line){const r=s.points(),o=i(r,s),a=s.getAttr("metadata");n.push({type:"polygon",points:o,...a&&{metadata:a}})}}),n},Se=t=>{t.polygon.bakedRenderData=Rc(t),t.callbacks.syncAppState?.(t)},Is=t=>Cs(t,()=>{const e=t.layers.polygonShapes;if(!t.stage||!e)return null;try{const i=e.toObject(),s=Array.from(t.polygon.shapes.entries()),r=Array.from(t.polygon.groups.entries());return{layer:i,polygons:s,polygonGroups:r}}catch(i){return console.warn("Failed to get current polygon state:",i),null}}),hn=t=>{const e=Is(t);return JSON.stringify(e)},Ec=(t,e)=>{if(e)try{Hs(t,e)}catch(n){console.warn("Failed to restore polygon state:",n)}},Us=t=>{const e=JSON.stringify({freehand:Ge(t),polygon:hn(t)});t.polygon.dragStartState=e},Bs=(t,e)=>{if(!t.polygon.dragStartState)return;const n=JSON.stringify({freehand:Ge(t),polygon:hn(t)});t.polygon.dragStartState!==n&&(lr(t,`Transform ${e}`,t.polygon.dragStartState,n),Se(t)),t.polygon.dragStartState=null},Ie=t=>{const e=t.layers.polygonShapes;if(!(!t.stage||!e))try{const i=Is(t);if(!i)return;t.polygon.serializedState=JSON.stringify(i),t.callbacks.syncAppState?.(t),console.log("Serialized polygon state:",{layerChildren:i.layer?.children?.length||0,polygons:i.polygons.length,polygonGroups:i.polygonGroups.length})}catch(i){console.warn("Failed to serialize polygon state:",i)}},yr=(t,e)=>{console.log("Attaching polygon handlers to:",e.id()),e.draggable(!1),e.on("dragstart",()=>Us(t)),e.on("dragend",()=>{Bs(t,"Polygon Drag"),Ie(t)})},Hs=(t,e)=>{const n=t.layers.polygonShapes,i=t.layers.polygonControls,s=t.stage;if(!(!e||!s||!n))try{const r=JSON.parse(e);console.log("Deserializing polygon state:",{layerChildren:r.layer?.children?.length||0,polygons:r.polygons?.length||0,polygonGroups:r.polygonGroups?.length||0}),n.destroyChildren(),t.polygon.shapes.clear(),t.polygon.groups.clear(),le(t);const o=r.layer;o&&o.children&&(console.log("Restoring",o.children.length,"polygon shapes"),o.children.forEach((a,l)=>{console.log("Creating polygon node",l,"of type",a.className);const c=tt.Node.create(JSON.stringify(a));n.add(c),console.log("Added polygon node to layer:",c.id(),c.isVisible()),c instanceof tt.Line?(yr(t,c),Ts(t,c)):c instanceof tt.Group&&Ps(t,c)})),r.polygons&&r.polygons.forEach(([a,l])=>{const c=s.findOne(`#${a}`);console.log("Restoring polygon:",a,"found shape:",!!c);const h={id:l.id,points:l.points,closed:l.closed,creationTime:l.creationTime,konvaShape:c,controlPoints:[]};t.polygon.shapes.set(a,h)}),r.polygonGroups&&r.polygonGroups.forEach(([a,l])=>{const c={id:l.id,polygonIds:l.polygonIds,group:s.findOne(`#${a}`)};t.polygon.groups.set(a,c)}),i?.destroyChildren(),t.activeTool.value==="polygon"&&t.polygon.mode.value==="edit"&&dn(t),n.batchDraw(),t.polygon.serializedState=e,Se(t),console.log("Polygon state restored from hotreload")}catch(r){console.warn("Failed to deserialize polygon state:",r)}},Mc=(t,e)=>{const n=t.layers.polygonShapes;if(n){if(t.polygon.mode.value==="draw"){if(!t.polygon.isDrawing.value)t.polygon.isDrawing.value=!0,t.polygon.currentPoints.value=[e.x,e.y];else{const i=t.polygon.currentPoints.value[0],s=t.polygon.currentPoints.value[1];Math.sqrt((e.x-i)**2+(e.y-s)**2)<t.polygon.proximityThreshold&&t.polygon.currentPoints.value.length>=6?Vs(t):(t.polygon.currentPoints.value.push(e.x,e.y),_r(t))}_r(t)}else if(t.polygon.mode.value==="edit"){const i=Array.from(ae(t).values()).map(s=>{const r=s.konvaShape,o=r?r.getAbsoluteTransform():null,a=[];for(let l=0;l<s.points.length;l+=2)if(o){const c=o.point({x:s.points[l],y:s.points[l+1]});a.push({x:c.x,y:c.y})}else a.push({x:s.points[l],y:s.points[l+1]});return{points:a}});if(i.length>0){const s=kc(i,e);if(s.polygonIndex>=0&&s.distance<t.polygon.proximityThreshold*2){const r=Array.from(ae(t).keys())[s.polygonIndex],o=ae(t).get(r);o&&o.konvaShape&&Ke(t,"Add Polygon Point",()=>{const a=o.points,l=(s.lineIndex+1)*2,c=a[s.lineIndex*2],h=a[s.lineIndex*2+1],p=a[(s.lineIndex+1)*2%a.length],f=a[((s.lineIndex+1)*2+1)%a.length],u=(c+p)/2,m=(h+f)/2;o.points.splice(l,0,u,m),o.konvaShape.points(o.points),dn(t),Ie(t),n?.batchDraw(),Se(t)})}}}}},Fc=t=>{!t.polygon.isDrawing.value||t.polygon.mode.value!=="draw"||_r(t)},Dc=t=>{const e=t.layers.polygonPreview,n=t.layers.polygonControls,i=t.stage;if(!e||!i||ae(t).size===0)return;const s=i.getPointerPosition();if(!s)return;const r=i.getIntersection(s);if(r&&r.getParent()===n){e.destroyChildren(),e.batchDraw();return}const o=Array.from(ae(t).values()).map(a=>{const l=a.konvaShape,c=l?l.getAbsoluteTransform():null,h=[];for(let p=0;p<a.points.length;p+=2)if(c){const f=c.point({x:a.points[p],y:a.points[p+1]});h.push({x:f.x,y:f.y})}else h.push({x:a.points[p],y:a.points[p+1]});return{points:h}});if(o.length>0){const a=kc(o,s);if(e.destroyChildren(),a.polygonIndex>=0&&a.distance<20){const l=Array.from(ae(t).values())[a.polygonIndex],c=l.points,h=l.konvaShape,p=h?h.getAbsoluteTransform():null,f=c[a.lineIndex*2],u=c[a.lineIndex*2+1],m=c[(a.lineIndex+1)*2%c.length],_=c[((a.lineIndex+1)*2+1)%c.length],S=p?p.point({x:f,y:u}):{x:f,y:u},w=p?p.point({x:m,y:_}):{x:m,y:_},g=(S.x+w.x)/2,d=(S.y+w.y)/2,y=new tt.Line({points:[S.x,S.y,w.x,w.y],stroke:"#00ff00",strokeWidth:4,opacity:.8});e.add(y);const b=new tt.Circle({x:g,y:d,radius:5,fill:"#00ff00",stroke:"#00aa00",strokeWidth:2,opacity:.9});e.add(b)}e.batchDraw()}},_r=t=>{const e=t.layers.polygonPreview,n=t.stage;if(!e||!n)return;if(e.destroyChildren(),t.polygon.currentPoints.value.length<4){if(t.polygon.currentPoints.value.length===2){const o=new tt.Circle({x:t.polygon.currentPoints.value[0],y:t.polygon.currentPoints.value[1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});e.add(o)}e.batchDraw();return}const i=n.getPointerPosition();if(!i)return;for(let o=0;o<t.polygon.currentPoints.value.length;o+=2){const a=new tt.Circle({x:t.polygon.currentPoints.value[o],y:t.polygon.currentPoints.value[o+1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});e.add(a)}const s=[...t.polygon.currentPoints.value,i.x,i.y],r=new tt.Line({points:s,stroke:"#999",strokeWidth:2,fill:"rgba(153, 153, 153, 0.1)",closed:!1,dash:[5,5],listening:!1});if(e.add(r),t.polygon.currentPoints.value.length>=6){const o=t.polygon.currentPoints.value[0],a=t.polygon.currentPoints.value[1],l=Math.sqrt((i.x-o)**2+(i.y-a)**2),c=new tt.Circle({x:o,y:a,radius:t.polygon.proximityThreshold,stroke:l<t.polygon.proximityThreshold?"#00ff00":"#ff0000",strokeWidth:2,fill:"transparent",listening:!1});e.add(c)}e.batchDraw()},Vs=t=>{const e=t.layers.polygonShapes,n=t.layers.polygonPreview;t.polygon.currentPoints.value.length<6||Ke(t,"Create Polygon",()=>{const i=`polygon-${Date.now()}`,s={id:i,points:[...t.polygon.currentPoints.value],closed:!0,creationTime:Date.now()},r=new tt.Line({points:s.points,stroke:"#000",strokeWidth:2,fill:"rgba(0, 100, 255, 0.1)",closed:!0,draggable:!1,id:i});yr(t,r),s.konvaShape=r,ae(t).set(i,s),e?.add(r),Ts(t,r),t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],n?.destroyChildren(),dn(t),Ie(t),e?.batchDraw(),n?.batchDraw(),Se(t)})},Nc=t=>{const e=t.layers.polygonPreview;t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],e?.destroyChildren(),e?.batchDraw()},dn=t=>{const e=t.layers.polygonControls,n=t.layers.polygonShapes;e&&(e.destroyChildren(),t.polygon.mode.value==="edit"&&ae(t).forEach(i=>{i.controlPoints=[];for(let s=0;s<i.points.length;s+=2){const r=s,o=i.points[r],a=i.points[r+1];let l=o,c=a;if(i.konvaShape){const f=i.konvaShape.getAbsoluteTransform().point({x:o,y:a});l=f.x,c=f.y}const h=new tt.Circle({x:l,y:c,radius:6,fill:"#ff6600",stroke:"#ff4400",strokeWidth:2,draggable:!0,id:`${i.id}-control-${r/2}`});h.on("mouseenter",()=>{h.fill("#ffaa00"),h.radius(8),e?.batchDraw()}),h.on("mouseleave",()=>{h.fill("#ff6600"),h.radius(6),e?.batchDraw()}),h.on("dragstart",()=>{Us(t)}),h.on("dragmove",()=>{const p={x:h.x(),y:h.y()};if(i.konvaShape){const f=i.konvaShape.getAbsoluteTransform().copy();f.invert();const u=f.point(p);i.points[r]=u.x,i.points[r+1]=u.y}else i.points[r]=p.x,i.points[r+1]=p.y;i.konvaShape&&(i.konvaShape.points(i.points),n?.batchDraw())}),h.on("dragend",()=>{Bs(t,"Polygon Control Point"),Ie(t)}),i.controlPoints.push(h),e.add(h)}}),e.batchDraw())},Oc=t=>Gt(()=>t.polygon.mode.value,e=>{const n=t.layers.polygonControls,i=t.layers.polygonPreview;if(t.activeTool.value!=="polygon"){n?.destroyChildren(),n?.batchDraw();return}Gs(t),e==="draw"?(t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],i?.destroyChildren(),i?.batchDraw(),ae(t).forEach(s=>{s.konvaShape?.draggable(!1)})):e==="edit"&&(i?.destroyChildren(),i?.batchDraw(),ae(t).forEach(s=>{s.konvaShape?.draggable(!1)})),dn(t),Gs(t)}),Lc=Object.freeze(Object.defineProperty({__proto__:null,attachPolygonHandlers:yr,clearCurrentPolygon:Nc,clearPolygonSelection:Gs,deserializePolygonState:Hs,finishPolygon:Vs,finishPolygonDragTracking:Bs,generateBakedPolygonData:Rc,getCurrentPolygonState:Is,getCurrentPolygonStateString:hn,handlePolygonClick:Mc,handlePolygonEditMouseMove:Dc,handlePolygonMouseMove:Fc,initPolygonLayers:Ac,restorePolygonState:Ec,serializePolygonState:Ie,setupPolygonModeWatcher:Oc,startPolygonDragTracking:Us,updateBakedPolygonData:Se,updatePolygonControlPoints:dn,updatePolygonPreview:_r},Symbol.toStringTag,{value:"Module"})),U0=(t,e)=>{t.layers.transformerLayer=e;const n=new tt.Transformer({rotateEnabled:!0,keepRatio:!1,padding:6});return t.layers.transformer=n,n.on("transformstart",()=>{V0(t)}),n.on("transformend",()=>{z0(t,"Transform")}),e.add(n),Gt(t.selection.selectedKonvaNodes,i=>{H0(t,i)},{immediate:!0}),n};function B0(t,e){U0(t,e)}function H0(t,e){const n=t.layers.transformer,i=t.layers.transformerLayer;if(!n||!i)return;const s=e.filter(r=>!(r instanceof tt.Line&&t.polygon.mode.value==="edit"&&t.activeTool.value==="polygon"));n.nodes(s),i.batchDraw()}function V0(t){Promise.resolve().then(()=>Tc).then(({getCurrentFreehandStateString:e})=>{Promise.resolve().then(()=>Lc).then(({getCurrentPolygonStateString:n})=>{const i=JSON.stringify({freehand:e(t),polygon:n(t)});t.selection.transformStartState=i})})}function z0(t,e){const n=t.selection.transformStartState;n&&Promise.resolve().then(()=>Tc).then(({getCurrentFreehandStateString:i})=>{Promise.resolve().then(()=>Lc).then(({getCurrentPolygonStateString:s})=>{const r=JSON.stringify({freehand:i(t),polygon:s(t)});n!==r&&lr(t,e,n,r),t.selection.transformStartState=""})})}function W0(t,e){t.layers.selectionOverlay=e;const n=t.stage??e.getStage();if(!t.layers.grid&&n){const i=new tt.Layer({listening:!1,hitGraphEnabled:!1,name:"grid-layer"});n.add(i),i.moveToBottom(),t.layers.grid=i}t.selection.selectionRect=new tt.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),e.add(t.selection.selectionRect)}function $0(t,e,n){const i=e.getPointerPosition();if(!i)return;const s=r=>{let o=r;for(;o&&!(o instanceof tt.Stage);){if(o instanceof tt.Transformer)return!0;o=o.getParent()}return!1};if(!(n.target&&s(n.target))){if(n.target!==e){let r=n.target,o=r.getParent();for(;o&&!(o instanceof tt.Layer);)r=o,o=r.getParent();const a=fr(t,r);if(a){const l=Ql(t,a);n.evt.shiftKey?Tf(t,a,!0):l||(le(t),hr(t,a,!0)),Ql(t,a)&&J0(t,e);return}}(n.target===e||n.target instanceof tt.Layer)&&(t.selection.dragSelectionState.value={isSelecting:!0,startPos:{x:i.x,y:i.y},currentPos:{x:i.x,y:i.y},isShiftHeld:n.evt.shiftKey},K0(t,i.x,i.y))}}function j0(t,e,n){if(t.selection.selectionDragState.isDragging){Q0(t,e);return}if(!t.selection.dragSelectionState.value.isSelecting)return;const i=e.getPointerPosition();i&&(t.selection.dragSelectionState.value.currentPos={x:i.x,y:i.y},Y0(t))}function q0(t,e,n){if(t.selection.selectionDragState.isDragging){Z0(t);return}t.selection.dragSelectionState.value.isSelecting&&(X0(t,t.selection.dragSelectionState.value.isShiftHeld),t.selection.dragSelectionState.value.isSelecting=!1)}function K0(t,e,n){t.selection.selectionRect&&t.selection.selectionRect.setAttrs({x:e,y:n,width:0,height:0,visible:!1})}function Y0(t){if(!t.selection.selectionRect||!t.selection.dragSelectionState.value.isSelecting)return;const{startPos:e,currentPos:n}=t.selection.dragSelectionState.value,i=Math.min(e.x,n.x),s=Math.min(e.y,n.y),r=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y);t.selection.selectionRect.setAttrs({x:i,y:s,width:r,height:o,visible:r>5||o>5}),t.layers.selectionOverlay?.batchDraw()}function X0(t,e=!1){if(!t.selection.selectionRect)return;const{startPos:n,currentPos:i}=t.selection.dragSelectionState.value,s=Math.abs(i.x-n.x),r=Math.abs(i.y-n.y);if(!(s>=5||r>=5)){e||le(t),t.selection.selectionRect.visible(!1),t.layers.selectionOverlay?.batchDraw();return}const a=[],l=t.selection.selectionRect.getClientRect(),c=f=>f instanceof tt.Transformer?!1:f instanceof tt.Path||f instanceof tt.Line||f instanceof tt.Group,h=[],p=t.layers.selectionOverlay?.getStage();if(p){const f=t.layers.freehandShape;f&&h.push(f);const u=t.layers.polygonShapes;u&&h.push(u),h.length===0&&p.getLayers().forEach(m=>{m.getChildren().some(S=>c(S))&&h.push(m)})}h.forEach(f=>{f.getChildren().forEach(u=>{if(!c(u))return;const m=u.getClientRect();if(!(l.x+l.width<m.x||m.x+m.width<l.x||l.y+l.height<m.y||m.y+m.height<l.y)){const _=fr(t,u);_&&a.push(_)}})}),e||(le(t),Es(t)),a.forEach(f=>hr(t,f,!0)),t.selection.selectionRect.setAttrs({x:0,y:0,width:0,height:0,visible:!1}),t.layers.selectionOverlay?.batchDraw()}function J0(t,e){const n=e.getPointerPosition();if(!n)return;t.selection.selectionDragState.isDragging=!0,t.selection.selectionDragState.startPos={x:n.x,y:n.y},t.selection.selectionDragState.startNodePositions.clear(),t.selection.selectionDragState.beforeState=JSON.stringify({freehand:Ge(t),polygon:hn(t)}),t.selection.selectedKonvaNodes.value.forEach(s=>{const r=s.getAbsolutePosition();t.selection.selectionDragState.startNodePositions.set(s,{x:r.x,y:r.y})})}function Q0(t,e){const n=e.getPointerPosition();if(!n)return;const i=n.x-t.selection.selectionDragState.startPos.x,s=n.y-t.selection.selectionDragState.startPos.y;t.selection.selectionDragState.startNodePositions.forEach((o,a)=>{a.absolutePosition({x:o.x+i,y:o.y+s})});const r=new Set;t.selection.selectionDragState.startNodePositions.forEach((o,a)=>{let l=a.getParent();for(;l&&!(l instanceof tt.Layer);)l=l.getParent();l instanceof tt.Layer&&r.add(l)}),r.forEach(o=>o.batchDraw())}function Z0(t){const e=JSON.stringify({freehand:Ge(t),polygon:hn(t)});t.selection.selectionDragState.beforeState!==e&&lr(t,"Move Selection",t.selection.selectionDragState.beforeState,e),t.selection.selectionDragState.isDragging=!1,t.selection.selectionDragState.startNodePositions.clear()}function Gc(t){return t.selection.selectedKonvaNodes.value}function Ic(t){let e=t;for(;e&&!(e instanceof tt.Layer);)e=e.getParent();return e instanceof tt.Layer?e:null}function Uc(t,e){const n=t.getAbsoluteTransform().copy();t.moveTo(e);const i=e.getAbsoluteTransform().copy();i.invert();const r=i.multiply(n).decompose();t.setAttrs({x:r.x,y:r.y,scaleX:r.scaleX,scaleY:r.scaleY,rotation:r.rotation,skewX:r.skewX,skewY:r.skewY})}function Bc(t){const e=Gc(t);if(e.length<1||e.some(s=>s instanceof tt.Line)||new Set(e.map(s=>Ic(s))).size!==1)return!1;const i=e.filter(s=>s instanceof tt.Path||s instanceof tt.Group);return!(i.length<1||Rf(i))}function tg(t){if(!Bc(t))return;const e=t.selection.selectedKonvaNodes.value.filter(n=>n instanceof tt.Path||n instanceof tt.Group);e.length<1||Ke(t,"Group Selection",()=>{const n=e.filter(a=>!e.some(l=>l!==a&&l.isAncestorOf(a))),i=Ic(n[0]);if(!i)return;let s=n[0].getParent();n.every(a=>a.getParent()===s)||(s=i);const r=new tt.Group({draggable:!1});s.add(r),n.forEach(a=>{Uc(a,r)});const o=Ps(t,r);le(t),hr(t,o),r.getLayer()?.batchDraw(),ge(t)})}function Hc(t){const e=Gc(t);return e.length!==1||e[0]instanceof tt.Line?!1:e[0]instanceof tt.Group}function eg(t){if(!Hc(t))return;const e=t.selection.selectedKonvaNodes.value[0],n=e.getParent();n&&Ke(t,"Ungroup Selection",()=>{[...e.getChildren()].forEach(r=>{Uc(r,n),r.draggable(!1)});const s=e.id();e.destroy(),tc(t,s),le(t),n.getLayer()?.batchDraw();try{Ds(t)}catch{console.error("refreshStrokeConnections failed")}ge(t)})}function Vc(t){const e=t.selection.selectedKonvaNodes.value;return e.filter(n=>!e.some(i=>i!==n&&i.isAncestorOf(n)))}function ng(t){const e=t.layers.freehandShape;t.selection.selectedKonvaNodes.value.length!==0&&Ke(t,"Duplicate",()=>{Cs(t,()=>{const i=Vc(t),s=[];i.forEach(r=>{if(r instanceof tt.Path||r instanceof tt.Group){const o=mc(t,r,50,50),a=r.getParent();a&&a.add(o),s.push(o)}else if(r instanceof tt.Line){const o=r.clone({x:r.x()+50,y:r.y()+50}),a=yi("poly_");o.id(a);const l=r.getParent();l&&l.add(o),Ts(t,o),yr(t,o),ae(t).set(a,{id:a,points:[...o.points()],closed:!!o.closed(),creationTime:Date.now(),konvaShape:o}),s.push(o)}}),le(t),s.forEach(r=>{const o=fr(t,r);o&&hr(t,o,!0)}),e?.batchDraw(),t.layers.polygonShapes?.batchDraw(),ge(t),Se(t),Ie(t)})})}function ig(t){const e=t.layers.freehandShape;t.selection.selectedKonvaNodes.value.length!==0&&Ke(t,"Delete Selected",()=>{Vc(t).forEach(s=>{const r=[],o=a=>{r.push(a),a instanceof tt.Container&&a.getChildren().forEach(l=>o(l))};o(s),r.forEach(a=>{a instanceof tt.Path&&(Xt(t).delete(a.id()),Array.from(Xt(t).entries()).forEach(([l,c])=>{c.shape===a&&Xt(t).delete(l)}),Array.from(_s(t).values()).forEach(l=>{l.strokeIds=l.strokeIds.filter(c=>c!==a.id())})),a instanceof tt.Group&&_s(t).delete(a.id()),a instanceof tt.Line&&ae(t).delete(a.id()),tc(t,a.id())}),s.destroy()}),le(t),e?.batchDraw(),t.layers.polygonShapes?.batchDraw(),ge(t),Se(t),Ie(t),Promise.resolve().then(()=>m0).then(({refreshAnciliaryViz:s})=>s(t)).catch(()=>{})})}const zc=t=>{if(!t)return null;try{return JSON.parse(t)}catch(e){return console.warn("Failed to parse state string:",e),null}},rg=t=>{if(!t||typeof t!="object")return{};if("freehand"in t||"polygon"in t){const e={};return t.freehand!==void 0&&(e.freehand=typeof t.freehand=="string"?t.freehand:JSON.stringify(t.freehand)),t.polygon!==void 0&&(e.polygon=typeof t.polygon=="string"?t.polygon:JSON.stringify(t.polygon)),e}return"layer"in t&&(t.strokes||t.strokeGroups)?{freehand:JSON.stringify(t)}:"layer"in t&&(t.polygons||t.polygonGroups)?{polygon:JSON.stringify(t)}:{}},Wc=t=>{const e=Ge(t),n=hn(t),i=zc(e),s=zc(n);return JSON.stringify({version:1,freehand:i,polygon:s})},$c=(t,e,n={})=>{if(!e)return!1;let i;try{i=JSON.parse(e)}catch(o){return console.warn("Failed to parse canvas state JSON:",o),!1}const{freehand:s,polygon:r}=rg(i);return!s&&!r?(console.warn("Canvas state payload missing freehand and polygon data"),!1):(s&&Cc(t,s,{handleTimeUpdate:n.handleTimeUpdate}),r&&Ec(t,r),!0)},sg=(t,e)=>{const n=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)},og=t=>{const e=Wc(t);if(!e){console.warn("No canvas state available to download");return}let n=e;try{n=JSON.stringify(JSON.parse(e),null,2)}catch(s){console.warn("Failed to pretty-print canvas state JSON:",s)}const i=new Date().toISOString().slice(0,16).replace(/:/g,"-");sg(n,`canvas_state_${i}.json`)},ag=(t,e={})=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=async i=>{const s=i.target.files?.[0];if(s)try{const r=await s.text();if(!$c(t,r,e)){alert("Invalid canvas state file. Please upload a valid JSON export.");return}console.log("Canvas state restored from file:",s.name)}catch(r){console.error("Failed to restore canvas state from file:",r),alert("Failed to load canvas state. Please check the console for details.")}},n.click()},lg={class:"canvas-root"},cg={class:"control-panel"},hg=["disabled"],dg={class:"button-group vertical"},ug=["disabled"],fg=["disabled"],gg={class:"button-group vertical"},pg=["disabled"],mg=["disabled"],yg={class:"button-group vertical"},_g=["disabled"],vg=["disabled"],bg=["disabled"],Sg=["disabled"],xg={class:"button-group vertical"},Cg=["disabled"],wg=["disabled"],Pg={class:"button-group vertical"},Tg=["disabled"],kg=["disabled"],Ag={class:"button-group vertical"},Rg=["disabled"],Eg=["disabled"],Mg=["disabled"],Fg={key:0,class:"info"},Dg={class:"info"},Ng={class:"canvas-wrapper"},Og={key:0,class:"metadata-suite"},Lg={key:0,class:"animation-lock-warning"},Gg=20,Ig=_i(rn({__name:"CanvasRoot",props:{syncState:{type:Function},initialFreehandState:{default:"",type:String},initialPolygonState:{default:"",type:String},width:{default:1e3,type:[Number,String]},height:{default:500,type:[Number,String]},showTimeline:{type:Boolean,default:!1},showVisualizations:{type:Boolean,default:!1}},emits:["state-update"],setup(t,{emit:e}){const n=t,i=e,s=Lt(()=>{const U=Number(n.width),V=Number(n.height);return{width:Number.isFinite(U)?U:1e3,height:Number.isFinite(V)?V:500}}),r=_f(),o=L0(r);let a;const l=r.activeTool,c=r.metadata.showEditor,h=U=>U==null?U:typeof structuredClone=="function"?structuredClone(U):JSON.parse(JSON.stringify(U)),p=U=>U?h(Ct(U))??[]:[],f=U=>U?h(Ct(U))??[]:[],u=U=>U?h(Ct(U))??{}:{},m=U=>{const V=p(U.freehand.bakedRenderData),Q=u(U.freehand.bakedGroupMap),ot=f(U.polygon.bakedRenderData);return{freehand:{serializedState:U.freehand.serializedState??"",bakedRenderData:V??[],bakedGroupMap:Q??{}},polygon:{serializedState:U.polygon.serializedState??"",bakedRenderData:ot??[]}}},_=U=>{const V=m(U);n.syncState?.(V),i("state-update",V)};r.callbacks.syncAppState=_,Gt(()=>n.syncState,()=>{_(r)},{immediate:!0});const S=U=>W0(r,U),w=(U,V)=>$0(r,U,V),g=(U,V)=>j0(r,U),d=(U,V)=>q0(r),y=()=>tg(r),b=()=>eg(r),k=()=>ng(r),D=()=>ig(r),x=Lt(()=>Bc(r)),C=Lt(()=>Hc(r)),T=(U,V)=>Pc(r,U,V),M=()=>Os(r),L=()=>Es(r),I=U=>Ls(r,U),H=()=>og(r),G=()=>ag(r,{handleTimeUpdate:I}),X=()=>dn(r),v=U=>Mc(r,U),P=()=>Fc(r),E=()=>Dc(r),A=()=>Vs(r),O=()=>Nc(r),j=()=>Oc(r),B=r.selection.selectedKonvaNodes,J=Lt(()=>kf(r)),st=Lt(()=>dr(r)>1),$=Lt(()=>{const U=B.value;return U.length===1&&U[0]instanceof tt.Group});r.callbacks.refreshAncillaryViz=()=>Ye(r);const F=()=>Wc(r),W=U=>{if(!U)return;$c(r,U,{handleTimeUpdate:I})||console.warn("Failed to restore canvas state: invalid payload")},nt=At(!1),it=At(!1),ct=()=>{ge(r),Se(r),Ye(r),nt.value=R.canUndo(),it.value=R.canRedo()},R=new yf(F,W,ct);r.command.stack=R,nt.value=R.canUndo(),it.value=R.canRedo();const N=(U,V)=>R.executeCommand(U,V),z=()=>R.undo(),q=()=>R.redo();r.command.executeCommand=N,r.command.pushCommand=(U,V,Q)=>{R.pushCommand(U,V,Q)};const Y=U=>{r.freehand.isAnimating.value=U;const V=r.stage;V&&(U?V.listening(!1):V.listening(!0))},K=()=>{const U=r.stage,V=r.layers.grid;if(!U||!V)return;const Q=!!r.grid.visible.value;if(V.visible(Q),V.destroyChildren(),!Q){V.batchDraw();return}const ot=r.grid.size,lt=Number.isFinite(ot)&&ot>0?ot:Gg,dt=5,yt=U.width(),ft=U.height(),ut=Math.ceil(yt/lt),mt=Math.ceil(ft/lt),_t=(St,Mt)=>{V.add(new tt.Line({points:St,stroke:Mt?"rgba(0, 0, 0, 0.2)":"rgba(0, 0, 0, 0.08)",strokeWidth:Mt?1:.5,listening:!1}))};for(let St=0;St<=ut;St++){const Mt=Math.min(St*lt,yt),Ht=St%dt===0;_t([Mt,0,Mt,ft],Ht)}for(let St=0;St<=mt;St++){const Mt=Math.min(St*lt,ft),Ht=St%dt===0;_t([0,Mt,yt,Mt],Ht)}V.batchDraw()},Z=At(),rt=(U,V)=>{const Q=U.layers.freehandShape,ot=U.layers.freehandDrawing,lt=U.layers.transformerLayer??U.layers.freehandSelection,dt=U.stage;le(U),V==="select"?(Q?.listening(!0),U.layers.polygonShapes?.listening(!0),ot?.listening(!1),U.layers.polygonPreview?.listening(!1),U.layers.polygonControls?.listening(!1),lt?.listening(!0),U.layers.polygonSelection?.listening(!0),lt?.moveToTop(),dt&&pc(r,dt).moveToTop()):V==="freehand"?(Q?.listening(!0),ot?.listening(!0),lt?.listening(!0),U.layers.polygonShapes?.listening(!1),U.layers.polygonPreview?.listening(!1),U.layers.polygonControls?.listening(!1),U.layers.polygonSelection?.listening(!1)):V==="polygon"&&(U.layers.polygonShapes?.listening(!0),U.layers.polygonPreview?.listening(!0),U.layers.polygonControls?.listening(!0),U.layers.polygonSelection?.listening(!0),Q?.listening(!1),ot?.listening(!1),lt?.listening(!1)),V==="polygon"&&U.polygon.mode.value==="edit"?X():(U.layers.polygonControls?.destroyChildren(),U.layers.polygonControls?.batchDraw()),(ft=>{Q?.getChildren().forEach(ut=>{(ut instanceof tt.Path||ut instanceof tt.Group)&&ut.draggable(ft)}),U.layers.polygonShapes?.getChildren().forEach(ut=>{(ut instanceof tt.Line||ut instanceof tt.Group)&&ut.draggable(ft)})})(!1),dt?.batchDraw()};Gt(l,U=>{rt(r,U)},{immediate:!0});const et=(U,V)=>{try{const Q=fr(r,U);Q?Af(r,Q,V):(U.setAttr("metadata",V===void 0||Object.keys(V).length===0?void 0:V),ge(r),Se(r))}catch{U.setAttr("metadata",V===void 0||Object.keys(V).length===0?void 0:V),ge(r),Se(r)}};return Bo(async()=>{try{if(!Z.value){console.error("Konva container ref not found");return}const U=s.value,V=new tt.Stage({container:Z.value,width:U.width,height:U.height});r.stage=V,r.konvaContainer=Z.value;const Q=()=>{Z.value&&(Z.value.style.cursor=l.value==="freehand"?"crosshair":"default")};r.callbacks.updateCursor=Q,r.callbacks.updateCursor?.(),yc(r,V),Ac(r,V),K();const ot=r.layers.freehandSelection;if(!ot){console.error("Freehand selection layer not initialized");return}B0(r,ot);const lt=r.layers.transformerLayer??ot;S(lt);const dt=pc(r,V);r.layers.transformerLayer?.moveToTop(),dt.moveToTop(),ac(r),rt(r,l.value),l.value==="polygon"&&r.polygon.mode.value==="edit"&&X(),r.callbacks.updateCursor?.();const yt=ut=>{!ut||ut===r.freehand.serializedState||Ns(r,ut)},ft=ut=>{!ut||ut===r.polygon.serializedState||Hs(r,ut)};yt(n.initialFreehandState),ft(n.initialPolygonState),Gt(()=>n.initialFreehandState,ut=>{yt(ut)}),Gt(()=>n.initialPolygonState,ut=>{ft(ut)}),Gt(()=>r.grid.visible.value,()=>{K()},{immediate:!0}),Gt(()=>r.layers.grid,()=>{K()},{immediate:!0}),Gt(()=>[n.width,n.height],([ut,mt])=>{const _t=Number(ut),St=Number(mt),Mt=Number.isFinite(_t)?_t:s.value.width,Ht=Number.isFinite(St)?St:s.value.height,Ft=r.stage;Ft&&(Ft.width(Mt),Ft.height(Ht),Ft.batchDraw()),r.konvaContainer&&(r.konvaContainer.style.width=`${Mt}px`,r.konvaContainer.style.height=`${Ht}px`),K()},{immediate:!0}),rt(r,l.value),_(r),V.on("mousedown touchstart",ut=>{const mt=V.getPointerPosition();mt&&(l.value==="select"?w(V,ut):l.value==="freehand"?(r.freehand.isDrawing=!0,r.freehand.currentPoints=[mt.x,mt.y],r.freehand.drawingStartTime=performance.now(),r.freehand.currentTimestamps=[0],le(r)):l.value==="polygon"&&(ut.target.getParent?.()===r.layers.polygonControls||v(mt)))}),V.on("mousemove touchmove",ut=>{const mt=r.layers.freehandDrawing;if(l.value==="select")g(V,ut);else if(l.value==="freehand"){if(r.freehand.isDrawing){const _t=V.getPointerPosition();if(!_t)return;r.freehand.currentPoints.push(_t.x,_t.y),r.freehand.currentTimestamps.push(performance.now()-r.freehand.drawingStartTime),mt?.destroyChildren();const St=new tt.Path({data:xi(r.freehand.currentPoints),fill:"#666",strokeWidth:0});mt?.add(St),mt?.batchDraw()}}else l.value==="polygon"&&(r.polygon.mode.value==="draw"&&r.polygon.isDrawing.value?P():r.polygon.mode.value==="edit"&&E())}),V.on("mouseup touchend",ut=>{const mt=r.layers.freehandDrawing;l.value==="freehand"&&r.freehand.isDrawing?(r.freehand.isDrawing=!1,mt?.destroyChildren(),r.freehand.currentPoints.length>2&&N("Draw Stroke",()=>{const _t=r.layers.freehandShape,St=Date.now(),Mt=`stroke-${St}`,Ht=ur(r.freehand.currentPoints),Ft=[];for(let vr=0;vr<r.freehand.currentPoints.length;vr+=2)Ft.push(r.freehand.currentPoints[vr]-Ht.minX),Ft.push(r.freehand.currentPoints[vr+1]-Ht.minY);const Jt=xi(Ft),Ci={id:Mt,points:r.freehand.currentPoints,timestamps:r.freehand.currentTimestamps,originalPath:Jt,creationTime:St,isFreehand:!0},qc=T(r.freehand.currentPoints,Mt);Ci.shape=qc,Xt(r).set(Mt,Ci),_t?.add(qc),M(),L(),_t?.batchDraw(),ge(r)}),r.freehand.currentPoints=[],r.freehand.currentTimestamps=[]):d(V,ut)}),j(),a=Ff(r,"Escape",ut=>{l.value==="polygon"&&r.polygon.isDrawing.value&&(r.polygon.currentPoints.value.length>=6?A():O())})}catch(U){console.warn(U)}}),Cn(()=>{console.log("disposing livecoded resources"),wc(r),Ie(r),a?.(),a=void 0,r.keyboardDisposables.splice(0).forEach(U=>U()),r.stage?.destroy()}),(U,V)=>(wt(),Tt("div",lg,[at("div",cg,[Lo(at("select",{"onUpdate:modelValue":V[0]||(V[0]=Q=>Ut(l)?l.value=Q:null),disabled:ht(r).freehand.isAnimating.value,class:"tool-dropdown"},V[6]||(V[6]=[at("option",{value:"select"},"👆 Select",-1),at("option",{value:"freehand"},"✏️ Freehand",-1),at("option",{value:"polygon"},"⬟ Polygon",-1)]),8,hg),[[bu,ht(l)]]),V[15]||(V[15]=at("span",{class:"separator"},"|",-1)),at("div",dg,[at("button",{onClick:z,disabled:!nt.value||ht(r).freehand.isAnimating.value,title:"Undo (Ctrl/Cmd+Z)"}," ↶ Undo ",8,ug),at("button",{onClick:q,disabled:!it.value||ht(r).freehand.isAnimating.value,title:"Redo (Ctrl/Cmd+Shift+Z)"}," ↷ Redo ",8,fg)]),V[16]||(V[16]=at("span",{class:"separator"},"|",-1)),ht(l)==="select"?(wt(),Tt(jt,{key:0},[at("div",gg,[at("button",{onClick:y,disabled:!x.value||ht(r).freehand.isAnimating.value}," Group ",8,pg),at("button",{onClick:b,disabled:!C.value||ht(r).freehand.isAnimating.value}," Ungroup ",8,mg)]),V[7]||(V[7]=at("span",{class:"separator"},"|",-1)),at("div",yg,[at("button",{onClick:k,disabled:dr(ht(r))===0||ht(r).freehand.isAnimating.value}," 📄 Duplicate ",8,_g),at("button",{onClick:D,disabled:dr(ht(r))===0||ht(r).freehand.isAnimating.value}," 🗑️ Delete ",8,vg)]),V[8]||(V[8]=at("span",{class:"separator"},"|",-1)),at("button",{onClick:V[1]||(V[1]=Q=>c.value=!ht(c)),class:xe({active:ht(c)}),disabled:ht(r).freehand.isAnimating.value}," 📝 Metadata ",10,bg),V[9]||(V[9]=at("span",{class:"separator"},"|",-1)),at("button",{onClick:V[2]||(V[2]=Q=>ht(r).grid.visible.value=!ht(r).grid.visible.value),class:xe({active:ht(r).grid.visible.value}),disabled:ht(r).freehand.isAnimating.value},ie(ht(r).grid.visible.value?"⊞ Grid On":"⊡ Grid Off"),11,Sg),V[10]||(V[10]=at("span",{class:"separator"},"|",-1)),V[11]||(V[11]=at("span",{class:"flex-break","aria-hidden":"true"},null,-1)),at("div",xg,[at("button",{onClick:H,disabled:ht(r).freehand.isAnimating.value}," 💾 Download ",8,Cg),at("button",{onClick:G,disabled:ht(r).freehand.isAnimating.value}," 📁 Upload ",8,wg)]),V[12]||(V[12]=at("span",{class:"separator"},"|",-1))],64)):qt("",!0),ht(l)==="freehand"?(wt(),Tt(jt,{key:1},[n.showTimeline?(wt(),Tt("button",{key:0,onClick:V[3]||(V[3]=Q=>ht(r).freehand.useRealTiming.value=!ht(r).freehand.useRealTiming.value),class:xe({active:ht(r).freehand.useRealTiming.value})},ie(ht(r).freehand.useRealTiming.value?"⏱️ Real Time":"⏱️ Max 0.3s"),3)):qt("",!0)],64)):qt("",!0),ht(l)==="polygon"?(wt(),Tt(jt,{key:2},[at("div",Pg,[at("button",{onClick:V[4]||(V[4]=Q=>ht(r).polygon.mode.value="draw"),class:xe({active:ht(r).polygon.mode.value==="draw"}),disabled:ht(r).freehand.isAnimating.value}," ✏️ New Shape ",10,Tg),at("button",{onClick:V[5]||(V[5]=Q=>ht(r).polygon.mode.value="edit"),class:xe({active:ht(r).polygon.mode.value==="edit"}),disabled:ht(r).freehand.isAnimating.value}," ✏️ Edit Shape ",10,kg)]),V[13]||(V[13]=at("span",{class:"separator"},"|",-1)),at("div",Ag,[at("button",{onClick:A,disabled:!ht(r).polygon.isDrawing.value||ht(r).freehand.isAnimating.value}," ✅ End Shape (esc) ",8,Rg),at("button",{onClick:O,disabled:!ht(r).polygon.isDrawing.value||ht(r).freehand.isAnimating.value}," 🗑️ Cancel Shape ",8,Eg)]),at("button",{onClick:D,disabled:ws(ht(r))||ht(r).freehand.isAnimating.value}," 🗑️ Delete ",8,Mg),V[14]||(V[14]=at("span",{class:"separator"},"|",-1)),ht(r).polygon.isDrawing.value?(wt(),Tt("span",Fg,"Drawing: "+ie(ht(r).polygon.currentPoints.value.length/2)+" points",1)):qt("",!0)],64)):qt("",!0),V[17]||(V[17]=at("span",{class:"separator"},"|",-1)),at("span",Dg,ie(dr(ht(r)))+" selected",1)]),at("div",Ng,[at("div",{ref_key:"konvaContainer",ref:Z,class:"konva-container",style:Ue({width:s.value.width+"px",height:s.value.height+"px"})},null,4),ht(c)?(wt(),Tt("div",Og,[n.showVisualizations?(wt(),Ji(b0,{key:0,"canvas-state":ht(r)},null,8,["canvas-state"])):qt("",!0),oe(h0,{"selected-nodes":ht(B),"single-node":J.value,"multi-selected":st.value,"group-selected":$.value,"collect-hierarchy-from-root":ht(o).collectHierarchyFromRoot,"update-metadata-highlight":ht(o).updateMetadataHighlight,"update-hover-highlight":ht(o).updateHoverHighlight,"on-apply-metadata":et},null,8,["selected-nodes","single-node","multi-selected","group-selected","collect-hierarchy-from-root","update-metadata-highlight","update-hover-highlight"])])):qt("",!0),n.showTimeline?(wt(),Tt(jt,{key:1},[oe(Vf,{strokes:ht(Xt)(ht(r)),selectedStrokes:ht(r).freehand.selectedStrokesForTimeline.value,useRealTiming:ht(r).freehand.useRealTiming.value,maxInterStrokeDelay:ht(mr),overrideDuration:ht(r).freehand.timelineDuration.value>0?ht(r).freehand.timelineDuration.value:void 0,lockWhileAnimating:Y,onTimeUpdate:I},null,8,["strokes","selectedStrokes","useRealTiming","maxInterStrokeDelay","overrideDuration"]),ht(r).freehand.isAnimating.value?(wt(),Tt("div",Lg," ⚠️ Timeline has modified elements - press Stop to unlock ")):qt("",!0)],64)):qt("",!0)])]))}}),[["styles",[".canvas-root[data-v-3bc8b78e]{display:flex;flex-direction:column;align-items:center;gap:20px;padding:20px}.control-panel[data-v-3bc8b78e]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:10px 15px;display:flex;flex-wrap:wrap;align-items:center;gap:10px;box-shadow:0 2px 10px #0000001a}.canvas-wrapper[data-v-3bc8b78e]{display:flex;flex-direction:column;align-items:center;gap:20px}.control-panel button[data-v-3bc8b78e]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 15px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-3bc8b78e]:hover:not(:disabled){background:#e0e0e0}.control-panel button.active[data-v-3bc8b78e]{background:#06f;color:#fff;border-color:#06f}.control-panel button[data-v-3bc8b78e]:disabled{opacity:.5;cursor:not-allowed}.button-group.vertical[data-v-3bc8b78e]{display:flex;flex-direction:column;gap:2px}.button-group.vertical button[data-v-3bc8b78e]{margin:0;padding:3px 10px;font-size:12px}.tool-dropdown[data-v-3bc8b78e]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 10px;font-size:14px;cursor:pointer;transition:all .2s}.tool-dropdown[data-v-3bc8b78e]:hover{background:#e0e0e0}.tool-dropdown[data-v-3bc8b78e]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-3bc8b78e]{color:#ccc}.flex-break[data-v-3bc8b78e]{display:none;flex-basis:100%;height:0}@media (max-width: 1100px){.control-panel .flex-break[data-v-3bc8b78e]{display:block}}.info[data-v-3bc8b78e]{color:#666;font-size:14px}.animation-lock-warning[data-v-3bc8b78e]{color:#e67e22;font-size:14px;font-weight:700;text-align:center;background:#fef5e7;border:1px solid #f39c12;border-radius:4px;padding:8px 15px;animation:pulse-3bc8b78e 2s infinite}@keyframes pulse-3bc8b78e{0%,to{opacity:1}50%{opacity:.6}}.konva-container[data-v-3bc8b78e]{background-color:#fff;border:1px solid black}.metadata-suite[data-v-3bc8b78e]{display:flex;flex-direction:column;gap:8px;max-width:600px}"]],["__scopeId","data-v-3bc8b78e"]]),jc="handwriting-canvas",zs=mu(Ig);return customElements.get(jc)||customElements.define(jc,zs),wi.CanvasElement=zs,wi.default=zs,Object.defineProperties(wi,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),wi}({});
