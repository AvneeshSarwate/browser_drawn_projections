var HandwritingCanvas=function(Pi){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Sr(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Pt={},Xe=[],pe=()=>{},qc=()=>!1,Ti=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),xr=t=>t.startsWith("onUpdate:"),Ot=Object.assign,wr=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Kc=Object.prototype.hasOwnProperty,wt=(t,e)=>Kc.call(t,e),ft=Array.isArray,Je=t=>gn(t)==="[object Map]",ki=t=>gn(t)==="[object Set]",$s=t=>gn(t)==="[object Date]",gt=t=>typeof t=="function",Mt=t=>typeof t=="string",me=t=>typeof t=="symbol",Rt=t=>t!==null&&typeof t=="object",js=t=>(Rt(t)||gt(t))&&gt(t.then)&&gt(t.catch),qs=Object.prototype.toString,gn=t=>qs.call(t),Yc=t=>gn(t).slice(8,-1),Ai=t=>gn(t)==="[object Object]",Cr=t=>Mt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,pn=Sr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ri=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Xc=/-(\w)/g,he=Ri(t=>t.replace(Xc,(e,n)=>n?n.toUpperCase():"")),Jc=/\B([A-Z])/g,ie=Ri(t=>t.replace(Jc,"-$1").toLowerCase()),Ks=Ri(t=>t.charAt(0).toUpperCase()+t.slice(1)),Pr=Ri(t=>t?`on${Ks(t)}`:""),De=(t,e)=>!Object.is(t,e),Ei=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Ys=(t,e,n,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:n})},Mi=t=>{const e=parseFloat(t);return isNaN(e)?t:e},Xs=t=>{const e=Mt(t)?Number(t):NaN;return isNaN(e)?t:e};let Js;const Qs=()=>Js||(Js=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ue(t){if(ft(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],s=Mt(i)?eh(i):Ue(i);if(s)for(const r in s)e[r]=s[r]}return e}else if(Mt(t)||Rt(t))return t}const Qc=/;(?![^(]*\))/g,Zc=/:([^]+)/,th=/\/\*[^]*?\*\//g;function eh(t){const e={};return t.replace(th,"").split(Qc).forEach(n=>{if(n){const i=n.split(Zc);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function ye(t){let e="";if(Mt(t))e=t;else if(ft(t))for(let n=0;n<t.length;n++){const i=ye(t[n]);i&&(e+=i+" ")}else if(Rt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const nh=Sr("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Zs(t){return!!t||t===""}function ih(t,e){if(t.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<t.length;i++)n=Fi(t[i],e[i]);return n}function Fi(t,e){if(t===e)return!0;let n=$s(t),i=$s(e);if(n||i)return n&&i?t.getTime()===e.getTime():!1;if(n=me(t),i=me(e),n||i)return t===e;if(n=ft(t),i=ft(e),n||i)return n&&i?ih(t,e):!1;if(n=Rt(t),i=Rt(e),n||i){if(!n||!i)return!1;const s=Object.keys(t).length,r=Object.keys(e).length;if(s!==r)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Fi(t[o],e[o]))return!1}}return String(t)===String(e)}function rh(t,e){return t.findIndex(n=>Fi(n,e))}const to=t=>!!(t&&t.__v_isRef===!0),Zt=t=>Mt(t)?t:t==null?"":ft(t)||Rt(t)&&(t.toString===qs||!gt(t.toString))?to(t)?Zt(t.value):JSON.stringify(t,eo,2):String(t),eo=(t,e)=>to(e)?eo(t,e.value):Je(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,s],r)=>(n[Tr(i,r)+" =>"]=s,n),{})}:ki(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Tr(n))}:me(e)?Tr(e):Rt(e)&&!ft(e)&&!Ai(e)?String(e):e,Tr=(t,e="")=>{var n;return me(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let te;class sh{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=te,!e&&te&&(this.index=(te.scopes||(te.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=te;try{return te=this,e()}finally{te=n}}}on(){te=this}off(){te=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function oh(){return te}let At;const kr=new WeakSet;class no{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,te&&te.active&&te.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,kr.has(this)&&(kr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ro(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,co(this),so(this);const e=At,n=de;At=this,de=!0;try{return this.fn()}finally{oo(this),At=e,de=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Mr(e);this.deps=this.depsTail=void 0,co(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?kr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Er(this)&&this.run()}get dirty(){return Er(this)}}let io=0,mn,yn;function ro(t,e=!1){if(t.flags|=8,e){t.next=yn,yn=t;return}t.next=mn,mn=t}function Ar(){io++}function Rr(){if(--io>0)return;if(yn){let e=yn;for(yn=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;mn;){let e=mn;for(mn=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){t||(t=i)}e=n}}if(t)throw t}function so(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function oo(t){let e,n=t.depsTail,i=n;for(;i;){const s=i.prevDep;i.version===-1?(i===n&&(n=s),Mr(i),ah(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}t.deps=e,t.depsTail=n}function Er(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(ao(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function ao(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===_n))return;t.globalVersion=_n;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!Er(t)){t.flags&=-3;return}const n=At,i=de;At=t,de=!0;try{so(t);const s=t.fn(t._value);(e.version===0||De(s,t._value))&&(t._value=s,e.version++)}catch(s){throw e.version++,s}finally{At=n,de=i,oo(t),t.flags&=-3}}function Mr(t,e=!1){const{dep:n,prevSub:i,nextSub:s}=t;if(i&&(i.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=i,t.nextSub=void 0),n.subs===t&&(n.subs=i),!n.subs&&n.computed){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)Mr(r,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function ah(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let de=!0;const lo=[];function we(){lo.push(de),de=!1}function Ce(){const t=lo.pop();de=t===void 0?!0:t}function co(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=At;At=void 0;try{e()}finally{At=n}}}let _n=0;class lh{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Fr{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!At||!de||At===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==At)n=this.activeLink=new lh(At,this),At.deps?(n.prevDep=At.depsTail,At.depsTail.nextDep=n,At.depsTail=n):At.deps=At.depsTail=n,ho(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=At.depsTail,n.nextDep=void 0,At.depsTail.nextDep=n,At.depsTail=n,At.deps===n&&(At.deps=i)}return n}trigger(e){this.version++,_n++,this.notify(e)}notify(e){Ar();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Rr()}}}function ho(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)ho(i)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Dr=new WeakMap,Be=Symbol(""),Nr=Symbol(""),vn=Symbol("");function Bt(t,e,n){if(de&&At){let i=Dr.get(t);i||Dr.set(t,i=new Map);let s=i.get(n);s||(i.set(n,s=new Fr),s.map=i,s.key=n),s.track()}}function Pe(t,e,n,i,s,r){const o=Dr.get(t);if(!o){_n++;return}const a=l=>{l&&l.trigger()};if(Ar(),e==="clear")o.forEach(a);else{const l=ft(t),c=l&&Cr(n);if(l&&n==="length"){const h=Number(i);o.forEach((p,f)=>{(f==="length"||f===vn||!me(f)&&f>=h)&&a(p)})}else switch(n!==void 0&&a(o.get(n)),c&&a(o.get(vn)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Be)),Je(t)&&a(o.get(Nr)));break;case"delete":l||(a(o.get(Be)),Je(t)&&a(o.get(Nr)));break;case"set":Je(t)&&a(o.get(Be));break}}Rr()}function Qe(t){const e=St(t);return e===t?e:(Bt(e,"iterate",vn),re(t)?e:e.map(Ht))}function Di(t){return Bt(t=St(t),"iterate",vn),t}const ch={__proto__:null,[Symbol.iterator](){return Or(this,Symbol.iterator,Ht)},concat(...t){return Qe(this).concat(...t.map(e=>ft(e)?Qe(e):e))},entries(){return Or(this,"entries",t=>(t[1]=Ht(t[1]),t))},every(t,e){return Te(this,"every",t,e,void 0,arguments)},filter(t,e){return Te(this,"filter",t,e,n=>n.map(Ht),arguments)},find(t,e){return Te(this,"find",t,e,Ht,arguments)},findIndex(t,e){return Te(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Te(this,"findLast",t,e,Ht,arguments)},findLastIndex(t,e){return Te(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Te(this,"forEach",t,e,void 0,arguments)},includes(...t){return Lr(this,"includes",t)},indexOf(...t){return Lr(this,"indexOf",t)},join(t){return Qe(this).join(t)},lastIndexOf(...t){return Lr(this,"lastIndexOf",t)},map(t,e){return Te(this,"map",t,e,void 0,arguments)},pop(){return bn(this,"pop")},push(...t){return bn(this,"push",t)},reduce(t,...e){return uo(this,"reduce",t,e)},reduceRight(t,...e){return uo(this,"reduceRight",t,e)},shift(){return bn(this,"shift")},some(t,e){return Te(this,"some",t,e,void 0,arguments)},splice(...t){return bn(this,"splice",t)},toReversed(){return Qe(this).toReversed()},toSorted(t){return Qe(this).toSorted(t)},toSpliced(...t){return Qe(this).toSpliced(...t)},unshift(...t){return bn(this,"unshift",t)},values(){return Or(this,"values",Ht)}};function Or(t,e,n){const i=Di(t),s=i[e]();return i!==t&&!re(t)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.value&&(r.value=n(r.value)),r}),s}const hh=Array.prototype;function Te(t,e,n,i,s,r){const o=Di(t),a=o!==t&&!re(t),l=o[e];if(l!==hh[e]){const p=l.apply(t,r);return a?Ht(p):p}let c=n;o!==t&&(a?c=function(p,f){return n.call(this,Ht(p),f,t)}:n.length>2&&(c=function(p,f){return n.call(this,p,f,t)}));const h=l.call(o,c,i);return a&&s?s(h):h}function uo(t,e,n,i){const s=Di(t);let r=n;return s!==t&&(re(t)?n.length>3&&(r=function(o,a,l){return n.call(this,o,a,l,t)}):r=function(o,a,l){return n.call(this,o,Ht(a),l,t)}),s[e](r,...i)}function Lr(t,e,n){const i=St(t);Bt(i,"iterate",vn);const s=i[e](...n);return(s===-1||s===!1)&&Ur(n[0])?(n[0]=St(n[0]),i[e](...n)):s}function bn(t,e,n=[]){we(),Ar();const i=St(t)[e].apply(t,n);return Rr(),Ce(),i}const dh=Sr("__proto__,__v_isRef,__isVue"),fo=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(me));function uh(t){me(t)||(t=String(t));const e=St(this);return Bt(e,"has",t),e.hasOwnProperty(t)}class go{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,i){const s=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return r;if(n==="__v_raw")return i===(s?r?Co:wo:r?xo:So).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=ft(e);if(!s){let l;if(o&&(l=ch[n]))return l;if(n==="hasOwnProperty")return uh}const a=Reflect.get(e,n,Lt(e)?e:i);return(me(n)?fo.has(n):dh(n))||(s||Bt(e,"get",n),r)?a:Lt(a)?o&&Cr(n)?a:a.value:Rt(a)?s?To(a):Ir(a):a}}class po extends go{constructor(e=!1){super(!1,e)}set(e,n,i,s){let r=e[n];if(!this._isShallow){const l=He(r);if(!re(i)&&!He(i)&&(r=St(r),i=St(i)),!ft(e)&&Lt(r)&&!Lt(i))return l?!1:(r.value=i,!0)}const o=ft(e)&&Cr(n)?Number(n)<e.length:wt(e,n),a=Reflect.set(e,n,i,Lt(e)?e:s);return e===St(s)&&(o?De(i,r)&&Pe(e,"set",n,i):Pe(e,"add",n,i)),a}deleteProperty(e,n){const i=wt(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&i&&Pe(e,"delete",n,void 0),s}has(e,n){const i=Reflect.has(e,n);return(!me(n)||!fo.has(n))&&Bt(e,"has",n),i}ownKeys(e){return Bt(e,"iterate",ft(e)?"length":Be),Reflect.ownKeys(e)}}class mo extends go{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const fh=new po,gh=new mo,ph=new po(!0),mh=new mo(!0),Gr=t=>t,Ni=t=>Reflect.getPrototypeOf(t);function Oi(t,e,n=!1,i=!1){t=t.__v_raw;const s=St(t),r=St(e);n||(De(e,r)&&Bt(s,"get",e),Bt(s,"get",r));const{has:o}=Ni(s),a=i?Gr:n?Br:Ht;if(o.call(s,e))return a(t.get(e));if(o.call(s,r))return a(t.get(r));t!==s&&t.get(e)}function Li(t,e=!1){const n=this.__v_raw,i=St(n),s=St(t);return e||(De(t,s)&&Bt(i,"has",t),Bt(i,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function Gi(t,e=!1){return t=t.__v_raw,!e&&Bt(St(t),"iterate",Be),Reflect.get(t,"size",t)}function yo(t,e=!1){!e&&!re(t)&&!He(t)&&(t=St(t));const n=St(this);return Ni(n).has.call(n,t)||(n.add(t),Pe(n,"add",t,t)),this}function _o(t,e,n=!1){!n&&!re(e)&&!He(e)&&(e=St(e));const i=St(this),{has:s,get:r}=Ni(i);let o=s.call(i,t);o||(t=St(t),o=s.call(i,t));const a=r.call(i,t);return i.set(t,e),o?De(e,a)&&Pe(i,"set",t,e):Pe(i,"add",t,e),this}function vo(t){const e=St(this),{has:n,get:i}=Ni(e);let s=n.call(e,t);s||(t=St(t),s=n.call(e,t)),i&&i.call(e,t);const r=e.delete(t);return s&&Pe(e,"delete",t,void 0),r}function bo(){const t=St(this),e=t.size!==0,n=t.clear();return e&&Pe(t,"clear",void 0,void 0),n}function Ii(t,e){return function(i,s){const r=this,o=r.__v_raw,a=St(o),l=e?Gr:t?Br:Ht;return!t&&Bt(a,"iterate",Be),o.forEach((c,h)=>i.call(s,l(c),l(h),r))}}function Ui(t,e,n){return function(...i){const s=this.__v_raw,r=St(s),o=Je(r),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=s[t](...i),h=n?Gr:e?Br:Ht;return!e&&Bt(r,"iterate",l?Nr:Be),{next(){const{value:p,done:f}=c.next();return f?{value:p,done:f}:{value:a?[h(p[0]),h(p[1])]:h(p),done:f}},[Symbol.iterator](){return this}}}}function Ne(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function yh(){const t={get(r){return Oi(this,r)},get size(){return Gi(this)},has:Li,add:yo,set:_o,delete:vo,clear:bo,forEach:Ii(!1,!1)},e={get(r){return Oi(this,r,!1,!0)},get size(){return Gi(this)},has:Li,add(r){return yo.call(this,r,!0)},set(r,o){return _o.call(this,r,o,!0)},delete:vo,clear:bo,forEach:Ii(!1,!0)},n={get(r){return Oi(this,r,!0)},get size(){return Gi(this,!0)},has(r){return Li.call(this,r,!0)},add:Ne("add"),set:Ne("set"),delete:Ne("delete"),clear:Ne("clear"),forEach:Ii(!0,!1)},i={get(r){return Oi(this,r,!0,!0)},get size(){return Gi(this,!0)},has(r){return Li.call(this,r,!0)},add:Ne("add"),set:Ne("set"),delete:Ne("delete"),clear:Ne("clear"),forEach:Ii(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=Ui(r,!1,!1),n[r]=Ui(r,!0,!1),e[r]=Ui(r,!1,!0),i[r]=Ui(r,!0,!0)}),[t,n,e,i]}const[_h,vh,bh,Sh]=yh();function Bi(t,e){const n=e?t?Sh:bh:t?vh:_h;return(i,s,r)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?i:Reflect.get(wt(n,s)&&s in i?n:i,s,r)}const xh={get:Bi(!1,!1)},wh={get:Bi(!1,!0)},Ch={get:Bi(!0,!1)},Ph={get:Bi(!0,!0)},So=new WeakMap,xo=new WeakMap,wo=new WeakMap,Co=new WeakMap;function Th(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function kh(t){return t.__v_skip||!Object.isExtensible(t)?0:Th(Yc(t))}function Ir(t){return He(t)?t:Hi(t,!1,fh,xh,So)}function Po(t){return Hi(t,!1,ph,wh,xo)}function To(t){return Hi(t,!0,gh,Ch,wo)}function Ng(t){return Hi(t,!0,mh,Ph,Co)}function Hi(t,e,n,i,s){if(!Rt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=s.get(t);if(r)return r;const o=kh(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return s.set(t,a),a}function Ze(t){return He(t)?Ze(t.__v_raw):!!(t&&t.__v_isReactive)}function He(t){return!!(t&&t.__v_isReadonly)}function re(t){return!!(t&&t.__v_isShallow)}function Ur(t){return t?!!t.__v_raw:!1}function St(t){const e=t&&t.__v_raw;return e?St(e):t}function Ah(t){return!wt(t,"__v_skip")&&Object.isExtensible(t)&&Ys(t,"__v_skip",!0),t}const Ht=t=>Rt(t)?Ir(t):t,Br=t=>Rt(t)?To(t):t;function Lt(t){return t?t.__v_isRef===!0:!1}function Tt(t){return ko(t,!1)}function Rh(t){return ko(t,!0)}function ko(t,e){return Lt(t)?t:new Eh(t,e)}class Eh{constructor(e,n){this.dep=new Fr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:St(e),this._value=n?e:Ht(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,i=this.__v_isShallow||re(e)||He(e);e=i?e:St(e),De(e,n)&&(this._rawValue=e,this._value=i?e:Ht(e),this.dep.trigger())}}function ct(t){return Lt(t)?t.value:t}const Mh={get:(t,e,n)=>e==="__v_raw"?t:ct(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const s=t[e];return Lt(s)&&!Lt(n)?(s.value=n,!0):Reflect.set(t,e,n,i)}};function Ao(t){return Ze(t)?t:new Proxy(t,Mh)}class Fh{constructor(e,n,i){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Fr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=_n-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&At!==this)return ro(this,!0),!0}get value(){const e=this.dep.track();return ao(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Dh(t,e,n=!1){let i,s;return gt(t)?i=t:(i=t.get,s=t.set),new Fh(i,s,n)}const Vi={},zi=new WeakMap;let Ve;function Nh(t,e=!1,n=Ve){if(n){let i=zi.get(n);i||zi.set(n,i=[]),i.push(t)}}function Oh(t,e,n=Pt){const{immediate:i,deep:s,once:r,scheduler:o,augmentJob:a,call:l}=n,c=y=>s?y:re(y)||s===!1||s===0?ke(y,1):ke(y);let h,p,f,u,m=!1,_=!1;if(Lt(t)?(p=()=>t.value,m=re(t)):Ze(t)?(p=()=>c(t),m=!0):ft(t)?(_=!0,m=t.some(y=>Ze(y)||re(y)),p=()=>t.map(y=>{if(Lt(y))return y.value;if(Ze(y))return c(y);if(gt(y))return l?l(y,2):y()})):gt(t)?e?p=l?()=>l(t,2):t:p=()=>{if(f){we();try{f()}finally{Ce()}}const y=Ve;Ve=h;try{return l?l(t,3,[u]):t(u)}finally{Ve=y}}:p=pe,e&&s){const y=p,b=s===!0?1/0:s;p=()=>ke(y(),b)}const S=oh(),C=()=>{h.stop(),S&&wr(S.effects,h)};if(r&&e){const y=e;e=(...b)=>{y(...b),C()}}let g=_?new Array(t.length).fill(Vi):Vi;const d=y=>{if(!(!(h.flags&1)||!h.dirty&&!y))if(e){const b=h.run();if(s||m||(_?b.some((k,D)=>De(k,g[D])):De(b,g))){f&&f();const k=Ve;Ve=h;try{const D=[b,g===Vi?void 0:_&&g[0]===Vi?[]:g,u];l?l(e,3,D):e(...D),g=b}finally{Ve=k}}}else h.run()};return a&&a(d),h=new no(p),h.scheduler=o?()=>o(d,!1):d,u=y=>Nh(y,!1,h),f=h.onStop=()=>{const y=zi.get(h);if(y){if(l)l(y,4);else for(const b of y)b();zi.delete(h)}},e?i?d(!0):g=h.run():o?o(d.bind(null,!0),!0):h.run(),C.pause=h.pause.bind(h),C.resume=h.resume.bind(h),C.stop=C,C}function ke(t,e=1/0,n){if(e<=0||!Rt(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,Lt(t))ke(t.value,e,n);else if(ft(t))for(let i=0;i<t.length;i++)ke(t[i],e,n);else if(ki(t)||Je(t))t.forEach(i=>{ke(i,e,n)});else if(Ai(t)){for(const i in t)ke(t[i],e,n);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&ke(t[i],e,n)}return t}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Sn=[];let Hr=!1;function Og(t,...e){if(Hr)return;Hr=!0,we();const n=Sn.length?Sn[Sn.length-1].component:null,i=n&&n.appContext.config.warnHandler,s=Lh();if(i)tn(i,n,11,[t+e.map(r=>{var o,a;return(a=(o=r.toString)==null?void 0:o.call(r))!=null?a:JSON.stringify(r)}).join(""),n&&n.proxy,s.map(({vnode:r})=>`at <${wa(n,r.type)}>`).join(`
`),s]);else{const r=[`[Vue warn]: ${t}`,...e];s.length&&r.push(`
`,...Gh(s)),console.warn(...r)}Ce(),Hr=!1}function Lh(){let t=Sn[Sn.length-1];if(!t)return[];const e=[];for(;t;){const n=e[0];n&&n.vnode===t?n.recurseCount++:e.push({vnode:t,recurseCount:0});const i=t.component&&t.component.parent;t=i&&i.vnode}return e}function Gh(t){const e=[];return t.forEach((n,i)=>{e.push(...i===0?[]:[`
`],...Ih(n))}),e}function Ih({vnode:t,recurseCount:e}){const n=e>0?`... (${e} recursive calls)`:"",i=t.component?t.component.parent==null:!1,s=` at <${wa(t.component,t.type,i)}`,r=">"+n;return t.props?[s,...Uh(t.props),r]:[s+r]}function Uh(t){const e=[],n=Object.keys(t);return n.slice(0,3).forEach(i=>{e.push(...Ro(i,t[i]))}),n.length>3&&e.push(" ..."),e}function Ro(t,e,n){return Mt(e)?(e=JSON.stringify(e),n?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?n?e:[`${t}=${e}`]:Lt(e)?(e=Ro(t,St(e.value),!0),n?e:[`${t}=Ref<`,e,">"]):gt(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=St(e),n?e:[`${t}=`,e])}function tn(t,e,n,i){try{return i?t(...i):t()}catch(s){Wi(s,e,n)}}function _e(t,e,n,i){if(gt(t)){const s=tn(t,e,n,i);return s&&js(s)&&s.catch(r=>{Wi(r,e,n)}),s}if(ft(t)){const s=[];for(let r=0;r<t.length;r++)s.push(_e(t[r],e,n,i));return s}}function Wi(t,e,n,i=!0){const s=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Pt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let p=0;p<h.length;p++)if(h[p](t,l,c)===!1)return}a=a.parent}if(r){we(),tn(r,null,10,[t,l,c]),Ce();return}}Bh(t,n,s,i,o)}function Bh(t,e,n,i=!0,s=!1){if(s)throw t;console.error(t)}const zt=[];let ve=-1;const en=[];let Oe=null,nn=0;const Eo=Promise.resolve();let $i=null;function Vr(t){const e=$i||Eo;return t?e.then(this?t.bind(this):t):e}function Hh(t){let e=ve+1,n=zt.length;for(;e<n;){const i=e+n>>>1,s=zt[i],r=xn(s);r<t||r===t&&s.flags&2?e=i+1:n=i}return e}function zr(t){if(!(t.flags&1)){const e=xn(t),n=zt[zt.length-1];!n||!(t.flags&2)&&e>=xn(n)?zt.push(t):zt.splice(Hh(e),0,t),t.flags|=1,Mo()}}function Mo(){$i||($i=Eo.then(No))}function Vh(t){ft(t)?en.push(...t):Oe&&t.id===-1?Oe.splice(nn+1,0,t):t.flags&1||(en.push(t),t.flags|=1),Mo()}function Fo(t,e,n=ve+1){for(;n<zt.length;n++){const i=zt[n];if(i&&i.flags&2){if(t&&i.id!==t.uid)continue;zt.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Do(t){if(en.length){const e=[...new Set(en)].sort((n,i)=>xn(n)-xn(i));if(en.length=0,Oe){Oe.push(...e);return}for(Oe=e,nn=0;nn<Oe.length;nn++){const n=Oe[nn];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Oe=null,nn=0}}const xn=t=>t.id==null?t.flags&2?-1:1/0:t.id;function No(t){try{for(ve=0;ve<zt.length;ve++){const e=zt[ve];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),tn(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ve<zt.length;ve++){const e=zt[ve];e&&(e.flags&=-2)}ve=-1,zt.length=0,Do(),$i=null,(zt.length||en.length)&&No()}}let se=null,Oo=null;function ji(t){const e=se;return se=t,Oo=t&&t.type.__scopeId||null,e}function zh(t,e=se,n){if(!e||t._n)return t;const i=(...s)=>{i._d&&ga(-1);const r=ji(e);let o;try{o=t(...s)}finally{ji(r),i._d&&ga(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Lo(t,e){if(se===null)return t;const n=nr(se),i=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[r,o,a,l=Pt]=e[s];r&&(gt(r)&&(r={mounted:r,updated:r}),r.deep&&ke(o),i.push({dir:r,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function ze(t,e,n,i){const s=t.dirs,r=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];r&&(a.oldValue=r[o].value);let l=a.dir[i];l&&(we(),_e(l,n,8,[t.el,a,t,e]),Ce())}}const Wh=Symbol("_vte"),$h=t=>t.__isTeleport;function Wr(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Wr(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function rn(t,e){return gt(t)?Ot({name:t.name},e,{setup:t}):t}function Go(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function $r(t,e,n,i,s=!1){if(ft(t)){t.forEach((m,_)=>$r(m,e&&(ft(e)?e[_]:e),n,i,s));return}if(wn(i)&&!s)return;const r=i.shapeFlag&4?nr(i.component):i.el,o=s?null:r,{i:a,r:l}=t,c=e&&e.r,h=a.refs===Pt?a.refs={}:a.refs,p=a.setupState,f=St(p),u=p===Pt?()=>!1:m=>wt(f,m);if(c!=null&&c!==l&&(Mt(c)?(h[c]=null,u(c)&&(p[c]=null)):Lt(c)&&(c.value=null)),gt(l))tn(l,a,12,[o,h]);else{const m=Mt(l),_=Lt(l);if(m||_){const S=()=>{if(t.f){const C=m?u(l)?p[l]:h[l]:l.value;s?ft(C)&&wr(C,r):ft(C)?C.includes(r)||C.push(r):m?(h[l]=[r],u(l)&&(p[l]=h[l])):(l.value=[r],t.k&&(h[t.k]=l.value))}else m?(h[l]=o,u(l)&&(p[l]=o)):_&&(l.value=o,t.k&&(h[t.k]=o))};o?(S.id=-1,ee(S,n)):S()}}}const wn=t=>!!t.type.__asyncLoader,Io=t=>t.type.__isKeepAlive;function jh(t,e){Uo(t,"a",e)}function qh(t,e){Uo(t,"da",e)}function Uo(t,e,n=jt){const i=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(qi(e,i,n),n){let s=n.parent;for(;s&&s.parent;)Io(s.parent.vnode)&&Kh(i,e,n,s),s=s.parent}}function Kh(t,e,n,i){const s=qi(e,t,i,!0);Cn(()=>{wr(i[e],s)},n)}function qi(t,e,n=jt,i=!1){if(n){const s=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{we();const a=En(n),l=_e(e,n,t,o);return a(),Ce(),l});return i?s.unshift(r):s.push(r),r}}const Ae=t=>(e,n=jt)=>{(!er||t==="sp")&&qi(t,(...i)=>e(...i),n)},Yh=Ae("bm"),Bo=Ae("m"),Xh=Ae("bu"),Jh=Ae("u"),Qh=Ae("bum"),Cn=Ae("um"),Zh=Ae("sp"),td=Ae("rtg"),ed=Ae("rtc");function nd(t,e=jt){qi("ec",t,e)}const id=Symbol.for("v-ndc");function Ho(t,e,n,i){let s;const r=n,o=ft(t);if(o||Mt(t)){const a=o&&Ze(t);let l=!1;a&&(l=!re(t),t=Di(t)),s=new Array(t.length);for(let c=0,h=t.length;c<h;c++)s[c]=e(l?Ht(t[c]):t[c],c,void 0,r)}else if(typeof t=="number"){s=new Array(t);for(let a=0;a<t;a++)s[a]=e(a+1,a,void 0,r)}else if(Rt(t))if(t[Symbol.iterator])s=Array.from(t,(a,l)=>e(a,l,void 0,r));else{const a=Object.keys(t);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];s[l]=e(t[h],h,l,r)}}else s=[];return s}const jr=t=>t?ba(t)?nr(t):jr(t.parent):null,Pn=Ot(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>jr(t.parent),$root:t=>jr(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>$o(t),$forceUpdate:t=>t.f||(t.f=()=>{zr(t.update)}),$nextTick:t=>t.n||(t.n=Vr.bind(t.proxy)),$watch:t=>Pd.bind(t)}),qr=(t,e)=>t!==Pt&&!t.__isScriptSetup&&wt(t,e),rd={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:i,data:s,props:r,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const u=o[e];if(u!==void 0)switch(u){case 1:return i[e];case 2:return s[e];case 4:return n[e];case 3:return r[e]}else{if(qr(i,e))return o[e]=1,i[e];if(s!==Pt&&wt(s,e))return o[e]=2,s[e];if((c=t.propsOptions[0])&&wt(c,e))return o[e]=3,r[e];if(n!==Pt&&wt(n,e))return o[e]=4,n[e];Kr&&(o[e]=0)}}const h=Pn[e];let p,f;if(h)return e==="$attrs"&&Bt(t.attrs,"get",""),h(t);if((p=a.__cssModules)&&(p=p[e]))return p;if(n!==Pt&&wt(n,e))return o[e]=4,n[e];if(f=l.config.globalProperties,wt(f,e))return f[e]},set({_:t},e,n){const{data:i,setupState:s,ctx:r}=t;return qr(s,e)?(s[e]=n,!0):i!==Pt&&wt(i,e)?(i[e]=n,!0):wt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:s,propsOptions:r}},o){let a;return!!n[o]||t!==Pt&&wt(t,o)||qr(e,o)||(a=r[0])&&wt(a,o)||wt(i,o)||wt(Pn,o)||wt(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:wt(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Vo(t){return ft(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let Kr=!0;function sd(t){const e=$o(t),n=t.proxy,i=t.ctx;Kr=!1,e.beforeCreate&&zo(e.beforeCreate,t,"bc");const{data:s,computed:r,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:p,mounted:f,beforeUpdate:u,updated:m,activated:_,deactivated:S,beforeDestroy:C,beforeUnmount:g,destroyed:d,unmounted:y,render:b,renderTracked:k,renderTriggered:D,errorCaptured:x,serverPrefetch:w,expose:T,inheritAttrs:M,components:L,directives:I,filters:V}=e;if(c&&od(c,i,null),o)for(const v in o){const P=o[v];gt(P)&&(i[v]=P.bind(n))}if(s){const v=s.call(n,n);Rt(v)&&(t.data=Ir(v))}if(Kr=!0,r)for(const v in r){const P=r[v],E=gt(P)?P.bind(n,n):gt(P.get)?P.get.bind(n,n):pe,R=!gt(P)&&gt(P.set)?P.set.bind(n):pe,O=Nt({get:E,set:R});Object.defineProperty(i,v,{enumerable:!0,configurable:!0,get:()=>O.value,set:j=>O.value=j})}if(a)for(const v in a)Wo(a[v],i,n,v);if(l){const v=gt(l)?l.call(n):l;Reflect.ownKeys(v).forEach(P=>{ud(P,v[P])})}h&&zo(h,t,"c");function X(v,P){ft(P)?P.forEach(E=>v(E.bind(n))):P&&v(P.bind(n))}if(X(Yh,p),X(Bo,f),X(Xh,u),X(Jh,m),X(jh,_),X(qh,S),X(nd,x),X(ed,k),X(td,D),X(Qh,g),X(Cn,y),X(Zh,w),ft(T))if(T.length){const v=t.exposed||(t.exposed={});T.forEach(P=>{Object.defineProperty(v,P,{get:()=>n[P],set:E=>n[P]=E})})}else t.exposed||(t.exposed={});b&&t.render===pe&&(t.render=b),M!=null&&(t.inheritAttrs=M),L&&(t.components=L),I&&(t.directives=I),w&&Go(t)}function od(t,e,n=pe){ft(t)&&(t=Yr(t));for(const i in t){const s=t[i];let r;Rt(s)?"default"in s?r=Yi(s.from||i,s.default,!0):r=Yi(s.from||i):r=Yi(s),Lt(r)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[i]=r}}function zo(t,e,n){_e(ft(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function Wo(t,e,n,i){let s=i.includes(".")?ca(n,i):()=>n[i];if(Mt(t)){const r=e[t];gt(r)&&It(s,r)}else if(gt(t))It(s,t.bind(n));else if(Rt(t))if(ft(t))t.forEach(r=>Wo(r,e,n,i));else{const r=gt(t.handler)?t.handler.bind(n):e[t.handler];gt(r)&&It(s,r,t)}}function $o(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,a=r.get(e);let l;return a?l=a:!s.length&&!n&&!i?l=e:(l={},s.length&&s.forEach(c=>Ki(l,c,o,!0)),Ki(l,e,o)),Rt(e)&&r.set(e,l),l}function Ki(t,e,n,i=!1){const{mixins:s,extends:r}=e;r&&Ki(t,r,n,!0),s&&s.forEach(o=>Ki(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=ad[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const ad={data:jo,props:qo,emits:qo,methods:Tn,computed:Tn,beforeCreate:Wt,created:Wt,beforeMount:Wt,mounted:Wt,beforeUpdate:Wt,updated:Wt,beforeDestroy:Wt,beforeUnmount:Wt,destroyed:Wt,unmounted:Wt,activated:Wt,deactivated:Wt,errorCaptured:Wt,serverPrefetch:Wt,components:Tn,directives:Tn,watch:cd,provide:jo,inject:ld};function jo(t,e){return e?t?function(){return Ot(gt(t)?t.call(this,this):t,gt(e)?e.call(this,this):e)}:e:t}function ld(t,e){return Tn(Yr(t),Yr(e))}function Yr(t){if(ft(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Wt(t,e){return t?[...new Set([].concat(t,e))]:e}function Tn(t,e){return t?Ot(Object.create(null),t,e):e}function qo(t,e){return t?ft(t)&&ft(e)?[...new Set([...t,...e])]:Ot(Object.create(null),Vo(t),Vo(e??{})):e}function cd(t,e){if(!t)return e;if(!e)return t;const n=Ot(Object.create(null),t);for(const i in e)n[i]=Wt(t[i],e[i]);return n}function Ko(){return{app:null,config:{isNativeTag:qc,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let hd=0;function dd(t,e){return function(i,s=null){gt(i)||(i=Ot({},i)),s!=null&&!Rt(s)&&(s=null);const r=Ko(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:hd++,_component:i,_props:s,_container:null,_context:r,_instance:null,version:Kd,get config(){return r.config},set config(h){},use(h,...p){return o.has(h)||(h&&gt(h.install)?(o.add(h),h.install(c,...p)):gt(h)&&(o.add(h),h(c,...p))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,p){return p?(r.components[h]=p,c):r.components[h]},directive(h,p){return p?(r.directives[h]=p,c):r.directives[h]},mount(h,p,f){if(!l){const u=c._ceVNode||oe(i,s);return u.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),t(u,h,f),l=!0,c._container=h,h.__vue_app__=c,nr(u.component)}},onUnmount(h){a.push(h)},unmount(){l&&(_e(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(h,p){return r.provides[h]=p,c},runWithContext(h){const p=sn;sn=c;try{return h()}finally{sn=p}}};return c}}let sn=null;function ud(t,e){if(jt){let n=jt.provides;const i=jt.parent&&jt.parent.provides;i===n&&(n=jt.provides=Object.create(i)),n[t]=e}}function Yi(t,e,n=!1){const i=jt||se;if(i||sn){const s=sn?sn._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return n&&gt(e)?e.call(i&&i.proxy):e}}const Yo={},Xo=()=>Object.create(Yo),Jo=t=>Object.getPrototypeOf(t)===Yo;function fd(t,e,n,i=!1){const s={},r=Xo();t.propsDefaults=Object.create(null),Qo(t,e,s,r);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=i?s:Po(s):t.type.props?t.props=s:t.props=r,t.attrs=r}function gd(t,e,n,i){const{props:s,attrs:r,vnode:{patchFlag:o}}=t,a=St(s),[l]=t.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let p=0;p<h.length;p++){let f=h[p];if(Xi(t.emitsOptions,f))continue;const u=e[f];if(l)if(wt(r,f))u!==r[f]&&(r[f]=u,c=!0);else{const m=he(f);s[m]=Xr(l,a,m,u,t,!1)}else u!==r[f]&&(r[f]=u,c=!0)}}}else{Qo(t,e,s,r)&&(c=!0);let h;for(const p in a)(!e||!wt(e,p)&&((h=ie(p))===p||!wt(e,h)))&&(l?n&&(n[p]!==void 0||n[h]!==void 0)&&(s[p]=Xr(l,a,p,void 0,t,!0)):delete s[p]);if(r!==a)for(const p in r)(!e||!wt(e,p))&&(delete r[p],c=!0)}c&&Pe(t.attrs,"set","")}function Qo(t,e,n,i){const[s,r]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(pn(l))continue;const c=e[l];let h;s&&wt(s,h=he(l))?!r||!r.includes(h)?n[h]=c:(a||(a={}))[h]=c:Xi(t.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(r){const l=St(n),c=a||Pt;for(let h=0;h<r.length;h++){const p=r[h];n[p]=Xr(s,l,p,c[p],t,!wt(c,p))}}return o}function Xr(t,e,n,i,s,r){const o=t[n];if(o!=null){const a=wt(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&gt(l)){const{propsDefaults:c}=s;if(n in c)i=c[n];else{const h=En(s);i=c[n]=l.call(null,e),h()}}else i=l;s.ce&&s.ce._setProp(n,i)}o[0]&&(r&&!a?i=!1:o[1]&&(i===""||i===ie(n))&&(i=!0))}return i}const pd=new WeakMap;function Zo(t,e,n=!1){const i=n?pd:e.propsCache,s=i.get(t);if(s)return s;const r=t.props,o={},a=[];let l=!1;if(!gt(t)){const h=p=>{l=!0;const[f,u]=Zo(p,e,!0);Ot(o,f),u&&a.push(...u)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!r&&!l)return Rt(t)&&i.set(t,Xe),Xe;if(ft(r))for(let h=0;h<r.length;h++){const p=he(r[h]);ta(p)&&(o[p]=Pt)}else if(r)for(const h in r){const p=he(h);if(ta(p)){const f=r[h],u=o[p]=ft(f)||gt(f)?{type:f}:Ot({},f),m=u.type;let _=!1,S=!0;if(ft(m))for(let C=0;C<m.length;++C){const g=m[C],d=gt(g)&&g.name;if(d==="Boolean"){_=!0;break}else d==="String"&&(S=!1)}else _=gt(m)&&m.name==="Boolean";u[0]=_,u[1]=S,(_||wt(u,"default"))&&a.push(p)}}const c=[o,a];return Rt(t)&&i.set(t,c),c}function ta(t){return t[0]!=="$"&&!pn(t)}const ea=t=>t[0]==="_"||t==="$stable",Jr=t=>ft(t)?t.map(be):[be(t)],md=(t,e,n)=>{if(e._n)return e;const i=zh((...s)=>Jr(e(...s)),n);return i._c=!1,i},na=(t,e,n)=>{const i=t._ctx;for(const s in t){if(ea(s))continue;const r=t[s];if(gt(r))e[s]=md(s,r,i);else if(r!=null){const o=Jr(r);e[s]=()=>o}}},ia=(t,e)=>{const n=Jr(e);t.slots.default=()=>n},ra=(t,e,n)=>{for(const i in e)(n||i!=="_")&&(t[i]=e[i])},yd=(t,e,n)=>{const i=t.slots=Xo();if(t.vnode.shapeFlag&32){const s=e._;s?(ra(i,e,n),n&&Ys(i,"_",s,!0)):na(e,i)}else e&&ia(t,e)},_d=(t,e,n)=>{const{vnode:i,slots:s}=t;let r=!0,o=Pt;if(i.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:ra(s,e,n):(r=!e.$stable,na(e,s)),o=e}else e&&(ia(t,e),o={default:1});if(r)for(const a in s)!ea(a)&&o[a]==null&&delete s[a]},ee=Fd;function vd(t){return bd(t)}function bd(t,e){const n=Qs();n.__VUE__=!0;const{insert:i,remove:s,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:p,nextSibling:f,setScopeId:u=pe,insertStaticContent:m}=t,_=(A,N,z,q=null,Y=null,K=null,Q=void 0,rt=null,B=!!N.dynamicChildren)=>{if(A===N)return;A&&!Rn(A,N)&&(q=F(A),j(A,Y,K,!0),A=null),N.patchFlag===-2&&(B=!1,N.dynamicChildren=null);const{type:U,ref:Z,shapeFlag:nt}=N;switch(U){case Ji:S(A,N,z,q);break;case $e:C(A,N,z,q);break;case Zr:A==null&&g(N,z,q,Q);break;case $t:L(A,N,z,q,Y,K,Q,rt,B);break;default:nt&1?b(A,N,z,q,Y,K,Q,rt,B):nt&6?I(A,N,z,q,Y,K,Q,rt,B):(nt&64||nt&128)&&U.process(A,N,z,q,Y,K,Q,rt,B,it)}Z!=null&&Y&&$r(Z,A&&A.ref,K,N||A,!N)},S=(A,N,z,q)=>{if(A==null)i(N.el=a(N.children),z,q);else{const Y=N.el=A.el;N.children!==A.children&&c(Y,N.children)}},C=(A,N,z,q)=>{A==null?i(N.el=l(N.children||""),z,q):N.el=A.el},g=(A,N,z,q)=>{[A.el,A.anchor]=m(A.children,N,z,q,A.el,A.anchor)},d=({el:A,anchor:N},z,q)=>{let Y;for(;A&&A!==N;)Y=f(A),i(A,z,q),A=Y;i(N,z,q)},y=({el:A,anchor:N})=>{let z;for(;A&&A!==N;)z=f(A),s(A),A=z;s(N)},b=(A,N,z,q,Y,K,Q,rt,B)=>{N.type==="svg"?Q="svg":N.type==="math"&&(Q="mathml"),A==null?k(N,z,q,Y,K,Q,rt,B):w(A,N,Y,K,Q,rt,B)},k=(A,N,z,q,Y,K,Q,rt)=>{let B,U;const{props:Z,shapeFlag:nt,transition:at,dirs:dt}=A;if(B=A.el=o(A.type,K,Z&&Z.is,Z),nt&8?h(B,A.children):nt&16&&x(A.children,B,null,q,Y,Qr(A,K),Q,rt),dt&&ze(A,null,q,"created"),D(B,A,A.scopeId,Q,q),Z){for(const pt in Z)pt!=="value"&&!pn(pt)&&r(B,pt,null,Z[pt],K,q);"value"in Z&&r(B,"value",null,Z.value,K),(U=Z.onVnodeBeforeMount)&&Se(U,q,A)}dt&&ze(A,null,q,"beforeMount");const ut=Sd(Y,at);ut&&at.beforeEnter(B),i(B,N,z),((U=Z&&Z.onVnodeMounted)||ut||dt)&&ee(()=>{U&&Se(U,q,A),ut&&at.enter(B),dt&&ze(A,null,q,"mounted")},Y)},D=(A,N,z,q,Y)=>{if(z&&u(A,z),q)for(let K=0;K<q.length;K++)u(A,q[K]);if(Y){let K=Y.subTree;if(N===K||fa(K.type)&&(K.ssContent===N||K.ssFallback===N)){const Q=Y.vnode;D(A,Q,Q.scopeId,Q.slotScopeIds,Y.parent)}}},x=(A,N,z,q,Y,K,Q,rt,B=0)=>{for(let U=B;U<A.length;U++){const Z=A[U]=rt?Le(A[U]):be(A[U]);_(null,Z,N,z,q,Y,K,Q,rt)}},w=(A,N,z,q,Y,K,Q)=>{const rt=N.el=A.el;let{patchFlag:B,dynamicChildren:U,dirs:Z}=N;B|=A.patchFlag&16;const nt=A.props||Pt,at=N.props||Pt;let dt;if(z&&We(z,!1),(dt=at.onVnodeBeforeUpdate)&&Se(dt,z,N,A),Z&&ze(N,A,z,"beforeUpdate"),z&&We(z,!0),(nt.innerHTML&&at.innerHTML==null||nt.textContent&&at.textContent==null)&&h(rt,""),U?T(A.dynamicChildren,U,rt,z,q,Qr(N,Y),K):Q||P(A,N,rt,null,z,q,Qr(N,Y),K,!1),B>0){if(B&16)M(rt,nt,at,z,Y);else if(B&2&&nt.class!==at.class&&r(rt,"class",null,at.class,Y),B&4&&r(rt,"style",nt.style,at.style,Y),B&8){const ut=N.dynamicProps;for(let pt=0;pt<ut.length;pt++){const ot=ut[pt],vt=nt[ot],mt=at[ot];(mt!==vt||ot==="value")&&r(rt,ot,vt,mt,Y,z)}}B&1&&A.children!==N.children&&h(rt,N.children)}else!Q&&U==null&&M(rt,nt,at,z,Y);((dt=at.onVnodeUpdated)||Z)&&ee(()=>{dt&&Se(dt,z,N,A),Z&&ze(N,A,z,"updated")},q)},T=(A,N,z,q,Y,K,Q)=>{for(let rt=0;rt<N.length;rt++){const B=A[rt],U=N[rt],Z=B.el&&(B.type===$t||!Rn(B,U)||B.shapeFlag&70)?p(B.el):z;_(B,U,Z,null,q,Y,K,Q,!0)}},M=(A,N,z,q,Y)=>{if(N!==z){if(N!==Pt)for(const K in N)!pn(K)&&!(K in z)&&r(A,K,N[K],null,Y,q);for(const K in z){if(pn(K))continue;const Q=z[K],rt=N[K];Q!==rt&&K!=="value"&&r(A,K,rt,Q,Y,q)}"value"in z&&r(A,"value",N.value,z.value,Y)}},L=(A,N,z,q,Y,K,Q,rt,B)=>{const U=N.el=A?A.el:a(""),Z=N.anchor=A?A.anchor:a("");let{patchFlag:nt,dynamicChildren:at,slotScopeIds:dt}=N;dt&&(rt=rt?rt.concat(dt):dt),A==null?(i(U,z,q),i(Z,z,q),x(N.children||[],z,Z,Y,K,Q,rt,B)):nt>0&&nt&64&&at&&A.dynamicChildren?(T(A.dynamicChildren,at,z,Y,K,Q,rt),(N.key!=null||Y&&N===Y.subTree)&&sa(A,N,!0)):P(A,N,z,Z,Y,K,Q,rt,B)},I=(A,N,z,q,Y,K,Q,rt,B)=>{N.slotScopeIds=rt,A==null?N.shapeFlag&512?Y.ctx.activate(N,z,q,Q,B):V(N,z,q,Y,K,Q,B):G(A,N,B)},V=(A,N,z,q,Y,K,Q)=>{const rt=A.component=Ud(A,q,Y);if(Io(A)&&(rt.ctx.renderer=it),Bd(rt,!1,Q),rt.asyncDep){if(Y&&Y.registerDep(rt,X,Q),!A.el){const B=rt.subTree=oe($e);C(null,B,N,z)}}else X(rt,A,N,z,Y,K,Q)},G=(A,N,z)=>{const q=N.component=A.component;if(Ed(A,N,z))if(q.asyncDep&&!q.asyncResolved){v(q,N,z);return}else q.next=N,q.update();else N.el=A.el,q.vnode=N},X=(A,N,z,q,Y,K,Q)=>{const rt=()=>{if(A.isMounted){let{next:nt,bu:at,u:dt,parent:ut,vnode:pt}=A;{const Et=oa(A);if(Et){nt&&(nt.el=pt.el,v(A,nt,Q)),Et.asyncDep.then(()=>{A.isUnmounted||rt()});return}}let ot=nt,vt;We(A,!1),nt?(nt.el=pt.el,v(A,nt,Q)):nt=pt,at&&Ei(at),(vt=nt.props&&nt.props.onVnodeBeforeUpdate)&&Se(vt,ut,nt,pt),We(A,!0);const mt=da(A),xt=A.subTree;A.subTree=mt,_(xt,mt,p(xt.el),F(xt),A,Y,K),nt.el=mt.el,ot===null&&Md(A,mt.el),dt&&ee(dt,Y),(vt=nt.props&&nt.props.onVnodeUpdated)&&ee(()=>Se(vt,ut,nt,pt),Y)}else{let nt;const{el:at,props:dt}=N,{bm:ut,m:pt,parent:ot,root:vt,type:mt}=A,xt=wn(N);We(A,!1),ut&&Ei(ut),!xt&&(nt=dt&&dt.onVnodeBeforeMount)&&Se(nt,ot,N),We(A,!0);{vt.ce&&vt.ce._injectChildStyle(mt);const Et=A.subTree=da(A);_(null,Et,z,q,A,Y,K),N.el=Et.el}if(pt&&ee(pt,Y),!xt&&(nt=dt&&dt.onVnodeMounted)){const Et=N;ee(()=>Se(nt,ot,Et),Y)}(N.shapeFlag&256||ot&&wn(ot.vnode)&&ot.vnode.shapeFlag&256)&&A.a&&ee(A.a,Y),A.isMounted=!0,N=z=q=null}};A.scope.on();const B=A.effect=new no(rt);A.scope.off();const U=A.update=B.run.bind(B),Z=A.job=B.runIfDirty.bind(B);Z.i=A,Z.id=A.uid,B.scheduler=()=>zr(Z),We(A,!0),U()},v=(A,N,z)=>{N.component=A;const q=A.vnode.props;A.vnode=N,A.next=null,gd(A,N.props,q,z),_d(A,N.children,z),we(),Fo(A),Ce()},P=(A,N,z,q,Y,K,Q,rt,B=!1)=>{const U=A&&A.children,Z=A?A.shapeFlag:0,nt=N.children,{patchFlag:at,shapeFlag:dt}=N;if(at>0){if(at&128){R(U,nt,z,q,Y,K,Q,rt,B);return}else if(at&256){E(U,nt,z,q,Y,K,Q,rt,B);return}}dt&8?(Z&16&&$(U,Y,K),nt!==U&&h(z,nt)):Z&16?dt&16?R(U,nt,z,q,Y,K,Q,rt,B):$(U,Y,K,!0):(Z&8&&h(z,""),dt&16&&x(nt,z,q,Y,K,Q,rt,B))},E=(A,N,z,q,Y,K,Q,rt,B)=>{A=A||Xe,N=N||Xe;const U=A.length,Z=N.length,nt=Math.min(U,Z);let at;for(at=0;at<nt;at++){const dt=N[at]=B?Le(N[at]):be(N[at]);_(A[at],dt,z,null,Y,K,Q,rt,B)}U>Z?$(A,Y,K,!0,!1,nt):x(N,z,q,Y,K,Q,rt,B,nt)},R=(A,N,z,q,Y,K,Q,rt,B)=>{let U=0;const Z=N.length;let nt=A.length-1,at=Z-1;for(;U<=nt&&U<=at;){const dt=A[U],ut=N[U]=B?Le(N[U]):be(N[U]);if(Rn(dt,ut))_(dt,ut,z,null,Y,K,Q,rt,B);else break;U++}for(;U<=nt&&U<=at;){const dt=A[nt],ut=N[at]=B?Le(N[at]):be(N[at]);if(Rn(dt,ut))_(dt,ut,z,null,Y,K,Q,rt,B);else break;nt--,at--}if(U>nt){if(U<=at){const dt=at+1,ut=dt<Z?N[dt].el:q;for(;U<=at;)_(null,N[U]=B?Le(N[U]):be(N[U]),z,ut,Y,K,Q,rt,B),U++}}else if(U>at)for(;U<=nt;)j(A[U],Y,K,!0),U++;else{const dt=U,ut=U,pt=new Map;for(U=ut;U<=at;U++){const Ut=N[U]=B?Le(N[U]):be(N[U]);Ut.key!=null&&pt.set(Ut.key,U)}let ot,vt=0;const mt=at-ut+1;let xt=!1,Et=0;const Jt=new Array(mt);for(U=0;U<mt;U++)Jt[U]=0;for(U=dt;U<=nt;U++){const Ut=A[U];if(vt>=mt){j(Ut,Y,K,!0);continue}let qt;if(Ut.key!=null)qt=pt.get(Ut.key);else for(ot=ut;ot<=at;ot++)if(Jt[ot-ut]===0&&Rn(Ut,N[ot])){qt=ot;break}qt===void 0?j(Ut,Y,K,!0):(Jt[qt-ut]=U+1,qt>=Et?Et=qt:xt=!0,_(Ut,N[qt],z,null,Y,K,Q,rt,B),vt++)}const Vt=xt?xd(Jt):Xe;for(ot=Vt.length-1,U=mt-1;U>=0;U--){const Ut=ut+U,qt=N[Ut],Ci=Ut+1<Z?N[Ut+1].el:q;Jt[U]===0?_(null,qt,z,Ci,Y,K,Q,rt,B):xt&&(ot<0||U!==Vt[ot]?O(qt,z,Ci,2):ot--)}}},O=(A,N,z,q,Y=null)=>{const{el:K,type:Q,transition:rt,children:B,shapeFlag:U}=A;if(U&6){O(A.component.subTree,N,z,q);return}if(U&128){A.suspense.move(N,z,q);return}if(U&64){Q.move(A,N,z,it);return}if(Q===$t){i(K,N,z);for(let nt=0;nt<B.length;nt++)O(B[nt],N,z,q);i(A.anchor,N,z);return}if(Q===Zr){d(A,N,z);return}if(q!==2&&U&1&&rt)if(q===0)rt.beforeEnter(K),i(K,N,z),ee(()=>rt.enter(K),Y);else{const{leave:nt,delayLeave:at,afterLeave:dt}=rt,ut=()=>i(K,N,z),pt=()=>{nt(K,()=>{ut(),dt&&dt()})};at?at(K,ut,pt):pt()}else i(K,N,z)},j=(A,N,z,q=!1,Y=!1)=>{const{type:K,props:Q,ref:rt,children:B,dynamicChildren:U,shapeFlag:Z,patchFlag:nt,dirs:at,cacheIndex:dt}=A;if(nt===-2&&(Y=!1),rt!=null&&$r(rt,null,z,A,!0),dt!=null&&(N.renderCache[dt]=void 0),Z&256){N.ctx.deactivate(A);return}const ut=Z&1&&at,pt=!wn(A);let ot;if(pt&&(ot=Q&&Q.onVnodeBeforeUnmount)&&Se(ot,N,A),Z&6)st(A.component,z,q);else{if(Z&128){A.suspense.unmount(z,q);return}ut&&ze(A,null,N,"beforeUnmount"),Z&64?A.type.remove(A,N,z,it,q):U&&!U.hasOnce&&(K!==$t||nt>0&&nt&64)?$(U,N,z,!1,!0):(K===$t&&nt&384||!Y&&Z&16)&&$(B,N,z),q&&H(A)}(pt&&(ot=Q&&Q.onVnodeUnmounted)||ut)&&ee(()=>{ot&&Se(ot,N,A),ut&&ze(A,null,N,"unmounted")},z)},H=A=>{const{type:N,el:z,anchor:q,transition:Y}=A;if(N===$t){J(z,q);return}if(N===Zr){y(A);return}const K=()=>{s(z),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(A.shapeFlag&1&&Y&&!Y.persisted){const{leave:Q,delayLeave:rt}=Y,B=()=>Q(z,K);rt?rt(A.el,K,B):B()}else K()},J=(A,N)=>{let z;for(;A!==N;)z=f(A),s(A),A=z;s(N)},st=(A,N,z)=>{const{bum:q,scope:Y,job:K,subTree:Q,um:rt,m:B,a:U}=A;aa(B),aa(U),q&&Ei(q),Y.stop(),K&&(K.flags|=8,j(Q,A,N,z)),rt&&ee(rt,N),ee(()=>{A.isUnmounted=!0},N),N&&N.pendingBranch&&!N.isUnmounted&&A.asyncDep&&!A.asyncResolved&&A.suspenseId===N.pendingId&&(N.deps--,N.deps===0&&N.resolve())},$=(A,N,z,q=!1,Y=!1,K=0)=>{for(let Q=K;Q<A.length;Q++)j(A[Q],N,z,q,Y)},F=A=>{if(A.shapeFlag&6)return F(A.component.subTree);if(A.shapeFlag&128)return A.suspense.next();const N=f(A.anchor||A.el),z=N&&N[Wh];return z?f(z):N};let W=!1;const et=(A,N,z)=>{A==null?N._vnode&&j(N._vnode,null,null,!0):_(N._vnode||null,A,N,null,null,null,z),N._vnode=A,W||(W=!0,Fo(),Do(),W=!1)},it={p:_,um:j,m:O,r:H,mt:V,mc:x,pc:P,pbc:T,n:F,o:t};return{render:et,hydrate:void 0,createApp:dd(et)}}function Qr({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function We({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Sd(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function sa(t,e,n=!1){const i=t.children,s=e.children;if(ft(i)&&ft(s))for(let r=0;r<i.length;r++){const o=i[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=Le(s[r]),a.el=o.el),!n&&a.patchFlag!==-2&&sa(o,a)),a.type===Ji&&(a.el=o.el)}}function xd(t){const e=t.slice(),n=[0];let i,s,r,o,a;const l=t.length;for(i=0;i<l;i++){const c=t[i];if(c!==0){if(s=n[n.length-1],t[s]<c){e[i]=s,n.push(i);continue}for(r=0,o=n.length-1;r<o;)a=r+o>>1,t[n[a]]<c?r=a+1:o=a;c<t[n[r]]&&(r>0&&(e[i]=n[r-1]),n[r]=i)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}function oa(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:oa(e)}function aa(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const wd=Symbol.for("v-scx"),Cd=()=>Yi(wd);function It(t,e,n){return la(t,e,n)}function la(t,e,n=Pt){const{immediate:i,deep:s,flush:r,once:o}=n,a=Ot({},n);let l;if(er)if(r==="sync"){const f=Cd();l=f.__watcherHandles||(f.__watcherHandles=[])}else if(!e||i)a.once=!0;else{const f=()=>{};return f.stop=pe,f.resume=pe,f.pause=pe,f}const c=jt;a.call=(f,u,m)=>_e(f,c,u,m);let h=!1;r==="post"?a.scheduler=f=>{ee(f,c&&c.suspense)}:r!=="sync"&&(h=!0,a.scheduler=(f,u)=>{u?f():zr(f)}),a.augmentJob=f=>{e&&(f.flags|=4),h&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const p=Oh(t,e,a);return l&&l.push(p),p}function Pd(t,e,n){const i=this.proxy,s=Mt(t)?t.includes(".")?ca(i,t):()=>i[t]:t.bind(i,i);let r;gt(e)?r=e:(r=e.handler,n=e);const o=En(this),a=la(s,r.bind(i),n);return o(),a}function ca(t,e){const n=e.split(".");return()=>{let i=t;for(let s=0;s<n.length&&i;s++)i=i[n[s]];return i}}const Td=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${he(e)}Modifiers`]||t[`${ie(e)}Modifiers`];function kd(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||Pt;let s=n;const r=e.startsWith("update:"),o=r&&Td(i,e.slice(7));o&&(o.trim&&(s=n.map(h=>Mt(h)?h.trim():h)),o.number&&(s=n.map(Mi)));let a,l=i[a=Pr(e)]||i[a=Pr(he(e))];!l&&r&&(l=i[a=Pr(ie(e))]),l&&_e(l,t,6,s);const c=i[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,_e(c,t,6,s)}}function ha(t,e,n=!1){const i=e.emitsCache,s=i.get(t);if(s!==void 0)return s;const r=t.emits;let o={},a=!1;if(!gt(t)){const l=c=>{const h=ha(c,e,!0);h&&(a=!0,Ot(o,h))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(Rt(t)&&i.set(t,null),null):(ft(r)?r.forEach(l=>o[l]=null):Ot(o,r),Rt(t)&&i.set(t,o),o)}function Xi(t,e){return!t||!Ti(e)?!1:(e=e.slice(2).replace(/Once$/,""),wt(t,e[0].toLowerCase()+e.slice(1))||wt(t,ie(e))||wt(t,e))}function Lg(){}function da(t){const{type:e,vnode:n,proxy:i,withProxy:s,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:p,data:f,setupState:u,ctx:m,inheritAttrs:_}=t,S=ji(t);let C,g;try{if(n.shapeFlag&4){const y=s||i,b=y;C=be(c.call(b,y,h,p,u,f,m)),g=a}else{const y=e;C=be(y.length>1?y(p,{attrs:a,slots:o,emit:l}):y(p,null)),g=e.props?a:Ad(a)}}catch(y){kn.length=0,Wi(y,t,1),C=oe($e)}let d=C;if(g&&_!==!1){const y=Object.keys(g),{shapeFlag:b}=d;y.length&&b&7&&(r&&y.some(xr)&&(g=Rd(g,r)),d=on(d,g,!1,!0))}return n.dirs&&(d=on(d,null,!1,!0),d.dirs=d.dirs?d.dirs.concat(n.dirs):n.dirs),n.transition&&Wr(d,n.transition),C=d,ji(S),C}const Ad=t=>{let e;for(const n in t)(n==="class"||n==="style"||Ti(n))&&((e||(e={}))[n]=t[n]);return e},Rd=(t,e)=>{const n={};for(const i in t)(!xr(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function Ed(t,e,n){const{props:i,children:s,component:r}=t,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?ua(i,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let p=0;p<h.length;p++){const f=h[p];if(o[f]!==i[f]&&!Xi(c,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?ua(i,o,c):!0:!!o;return!1}function ua(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let s=0;s<i.length;s++){const r=i[s];if(e[r]!==t[r]&&!Xi(n,r))return!0}return!1}function Md({vnode:t,parent:e},n){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=n,e=e.parent;else break}}const fa=t=>t.__isSuspense;function Fd(t,e){e&&e.pendingBranch?ft(t)?e.effects.push(...t):e.effects.push(t):Vh(t)}const $t=Symbol.for("v-fgt"),Ji=Symbol.for("v-txt"),$e=Symbol.for("v-cmt"),Zr=Symbol.for("v-stc"),kn=[];let ne=null;function Ct(t=!1){kn.push(ne=t?null:[])}function Dd(){kn.pop(),ne=kn[kn.length-1]||null}let An=1;function ga(t){An+=t,t<0&&ne&&(ne.hasOnce=!0)}function pa(t){return t.dynamicChildren=An>0?ne||Xe:null,Dd(),An>0&&ne&&ne.push(t),t}function kt(t,e,n,i,s,r){return pa(lt(t,e,n,i,s,r,!0))}function Qi(t,e,n,i,s){return pa(oe(t,e,n,i,s,!0))}function ma(t){return t?t.__v_isVNode===!0:!1}function Rn(t,e){return t.type===e.type&&t.key===e.key}const ya=({key:t})=>t??null,Zi=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Mt(t)||Lt(t)||gt(t)?{i:se,r:t,k:e,f:!!n}:t:null);function lt(t,e=null,n=null,i=0,s=null,r=t===$t?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&ya(e),ref:e&&Zi(e),scopeId:Oo,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:se};return a?(ts(l,n),r&128&&t.normalize(l)):n&&(l.shapeFlag|=Mt(n)?8:16),An>0&&!o&&ne&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&ne.push(l),l}const oe=Nd;function Nd(t,e=null,n=null,i=0,s=null,r=!1){if((!t||t===id)&&(t=$e),ma(t)){const a=on(t,e,!0);return n&&ts(a,n),An>0&&!r&&ne&&(a.shapeFlag&6?ne[ne.indexOf(t)]=a:ne.push(a)),a.patchFlag=-2,a}if(qd(t)&&(t=t.__vccOpts),e){e=Od(e);let{class:a,style:l}=e;a&&!Mt(a)&&(e.class=ye(a)),Rt(l)&&(Ur(l)&&!ft(l)&&(l=Ot({},l)),e.style=Ue(l))}const o=Mt(t)?1:fa(t)?128:$h(t)?64:Rt(t)?4:gt(t)?2:0;return lt(t,e,n,i,s,o,r,!0)}function Od(t){return t?Ur(t)||Jo(t)?Ot({},t):t:null}function on(t,e,n=!1,i=!1){const{props:s,ref:r,patchFlag:o,children:a,transition:l}=t,c=e?Ld(s||{},e):s,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&ya(c),ref:e&&e.ref?n&&r?ft(r)?r.concat(Zi(e)):[r,Zi(e)]:Zi(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==$t?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&on(t.ssContent),ssFallback:t.ssFallback&&on(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&i&&Wr(h,l.clone(h)),h}function _a(t=" ",e=0){return oe(Ji,null,t,e)}function Kt(t="",e=!1){return e?(Ct(),Qi($e,null,t)):oe($e,null,t)}function be(t){return t==null||typeof t=="boolean"?oe($e):ft(t)?oe($t,null,t.slice()):ma(t)?Le(t):oe(Ji,null,String(t))}function Le(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:on(t)}function ts(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(ft(e))n=16;else if(typeof e=="object")if(i&65){const s=e.default;s&&(s._c&&(s._d=!1),ts(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!Jo(e)?e._ctx=se:s===3&&se&&(se.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else gt(e)?(e={default:e,_ctx:se},n=32):(e=String(e),i&64?(n=16,e=[_a(e)]):n=8);t.children=e,t.shapeFlag|=n}function Ld(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const s in i)if(s==="class")e.class!==i.class&&(e.class=ye([e.class,i.class]));else if(s==="style")e.style=Ue([e.style,i.style]);else if(Ti(s)){const r=e[s],o=i[s];o&&r!==o&&!(ft(r)&&r.includes(o))&&(e[s]=r?[].concat(r,o):o)}else s!==""&&(e[s]=i[s])}return e}function Se(t,e,n,i=null){_e(t,e,7,[n,i])}const Gd=Ko();let Id=0;function Ud(t,e,n){const i=t.type,s=(e?e.appContext:t.appContext)||Gd,r={uid:Id++,vnode:t,type:i,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new sh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Zo(i,s),emitsOptions:ha(i,s),emit:null,emitted:null,propsDefaults:Pt,inheritAttrs:i.inheritAttrs,ctx:Pt,data:Pt,props:Pt,attrs:Pt,slots:Pt,refs:Pt,setupState:Pt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=kd.bind(null,r),t.ce&&t.ce(r),r}let jt=null,tr,es;{const t=Qs(),e=(n,i)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(i),r=>{s.length>1?s.forEach(o=>o(r)):s[0](r)}};tr=e("__VUE_INSTANCE_SETTERS__",n=>jt=n),es=e("__VUE_SSR_SETTERS__",n=>er=n)}const En=t=>{const e=jt;return tr(t),t.scope.on(),()=>{t.scope.off(),tr(e)}},va=()=>{jt&&jt.scope.off(),tr(null)};function ba(t){return t.vnode.shapeFlag&4}let er=!1;function Bd(t,e=!1,n=!1){e&&es(e);const{props:i,children:s}=t.vnode,r=ba(t);fd(t,i,r,e),yd(t,s,n);const o=r?Hd(t,e):void 0;return e&&es(!1),o}function Hd(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,rd);const{setup:i}=n;if(i){const s=t.setupContext=i.length>1?zd(t):null,r=En(t);we();const o=tn(i,t,0,[t.props,s]);if(Ce(),r(),js(o)){if(wn(t)||Go(t),o.then(va,va),e)return o.then(a=>{Sa(t,a)}).catch(a=>{Wi(a,t,0)});t.asyncDep=o}else Sa(t,o)}else xa(t)}function Sa(t,e,n){gt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Rt(e)&&(t.setupState=Ao(e)),xa(t)}function xa(t,e,n){const i=t.type;t.render||(t.render=i.render||pe);{const s=En(t);we();try{sd(t)}finally{Ce(),s()}}}const Vd={get(t,e){return Bt(t,"get",""),t[e]}};function zd(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Vd),slots:t.slots,emit:t.emit,expose:e}}function nr(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Ao(Ah(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Pn)return Pn[n](t)},has(e,n){return n in e||n in Pn}})):t.proxy}const Wd=/(?:^|[-_])(\w)/g,$d=t=>t.replace(Wd,e=>e.toUpperCase()).replace(/[-_]/g,"");function jd(t,e=!0){return gt(t)?t.displayName||t.name:t.name||e&&t.__name}function wa(t,e,n=!1){let i=jd(e);if(!i&&e.__file){const s=e.__file.match(/([^/\\]+)\.\w+$/);s&&(i=s[1])}if(!i&&t&&t.parent){const s=r=>{for(const o in r)if(r[o]===e)return o};i=s(t.components||t.parent.type.components)||s(t.appContext.components)}return i?$d(i):n?"App":"Anonymous"}function qd(t){return gt(t)&&"__vccOpts"in t}const Nt=(t,e)=>Dh(t,e,er),Kd="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ns;const Ca=typeof window<"u"&&window.trustedTypes;if(Ca)try{ns=Ca.createPolicy("vue",{createHTML:t=>t})}catch{}const Pa=ns?t=>ns.createHTML(t):t=>t,Yd="http://www.w3.org/2000/svg",Xd="http://www.w3.org/1998/Math/MathML",Re=typeof document<"u"?document:null,Ta=Re&&Re.createElement("template"),Jd={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const s=e==="svg"?Re.createElementNS(Yd,t):e==="mathml"?Re.createElementNS(Xd,t):n?Re.createElement(t,{is:n}):Re.createElement(t);return t==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:t=>Re.createTextNode(t),createComment:t=>Re.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Re.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,s,r){const o=n?n.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===r||!(s=s.nextSibling)););else{Ta.innerHTML=Pa(i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t);const a=Ta.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},Qd=Symbol("_vtc");function Zd(t,e,n){const i=t[Qd];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const ka=Symbol("_vod"),tu=Symbol("_vsh"),eu=Symbol(""),nu=/(^|;)\s*display\s*:/;function iu(t,e,n){const i=t.style,s=Mt(n);let r=!1;if(n&&!s){if(e)if(Mt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&ir(i,a,"")}else for(const o in e)n[o]==null&&ir(i,o,"");for(const o in n)o==="display"&&(r=!0),ir(i,o,n[o])}else if(s){if(e!==n){const o=i[eu];o&&(n+=";"+o),i.cssText=n,r=nu.test(n)}}else e&&t.removeAttribute("style");ka in t&&(t[ka]=r?i.display:"",t[tu]&&(i.display="none"))}const Aa=/\s*!important$/;function ir(t,e,n){if(ft(n))n.forEach(i=>ir(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=ru(t,e);Aa.test(n)?t.setProperty(ie(i),n.replace(Aa,""),"important"):t[i]=n}}const Ra=["Webkit","Moz","ms"],is={};function ru(t,e){const n=is[e];if(n)return n;let i=he(e);if(i!=="filter"&&i in t)return is[e]=i;i=Ks(i);for(let s=0;s<Ra.length;s++){const r=Ra[s]+i;if(r in t)return is[e]=r}return e}const Ea="http://www.w3.org/1999/xlink";function Ma(t,e,n,i,s,r=nh(e)){i&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Ea,e.slice(6,e.length)):t.setAttributeNS(Ea,e,n):n==null||r&&!Zs(n)?t.removeAttribute(e):t.setAttribute(e,r?"":me(n)?String(n):n)}function Fa(t,e,n,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Pa(n):n);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,a=n==null?t.type==="checkbox"?"on":"":String(n);(o!==a||!("_value"in t))&&(t.value=a),n==null&&t.removeAttribute(e),t._value=n;return}let r=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=Zs(n):n==null&&o==="string"?(n="",r=!0):o==="number"&&(n=0,r=!0)}try{t[e]=n}catch{}r&&t.removeAttribute(e)}function je(t,e,n,i){t.addEventListener(e,n,i)}function su(t,e,n,i){t.removeEventListener(e,n,i)}const Da=Symbol("_vei");function ou(t,e,n,i,s=null){const r=t[Da]||(t[Da]={}),o=r[e];if(i&&o)o.value=i;else{const[a,l]=au(e);if(i){const c=r[e]=hu(i,s);je(t,a,c,l)}else o&&(su(t,a,o,l),r[e]=void 0)}}const Na=/(?:Once|Passive|Capture)$/;function au(t){let e;if(Na.test(t)){e={};let i;for(;i=t.match(Na);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ie(t.slice(2)),e]}let rs=0;const lu=Promise.resolve(),cu=()=>rs||(lu.then(()=>rs=0),rs=Date.now());function hu(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;_e(du(i,n.value),e,5,[i])};return n.value=t,n.attached=cu(),n}function du(t,e){if(ft(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>s=>!s._stopped&&i&&i(s))}else return e}const Oa=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,uu=(t,e,n,i,s,r)=>{const o=s==="svg";e==="class"?Zd(t,i,o):e==="style"?iu(t,n,i):Ti(e)?xr(e)||ou(t,e,n,i,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):fu(t,e,i,o))?(Fa(t,e,i),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ma(t,e,i,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Mt(i))?Fa(t,he(e),i):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),Ma(t,e,i,o))};function fu(t,e,n,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&Oa(e)&&gt(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Oa(e)&&Mt(n)?!1:e in t}const La={};/*! #__NO_SIDE_EFFECTS__ */function gu(t,e,n){const i=rn(t,e);Ai(i)&&Ot(i,e);class s extends ss{constructor(o){super(i,o,n)}}return s.def=i,s}const pu=typeof HTMLElement<"u"?HTMLElement:class{};class ss extends pu{constructor(e,n={},i=Ha){super(),this._def=e,this._props=n,this._createApp=i,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&i!==Ha?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof ss){this._parent=e;break}this._instance||(this._resolved?(this._setParent(),this._update()):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._instance.provides=e._instance.provides)}disconnectedCallback(){this._connected=!1,Vr(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const s of i)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(i,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:r,styles:o}=i;let a;if(r&&!ft(r))for(const l in r){const c=r[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=Xs(this._props[l])),(a||(a=Object.create(null)))[he(l)]=!0)}this._numberProps=a,s&&this._resolveProps(i),this.shadowRoot&&this._applyStyles(o),this._mount(i)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(i=>e(this._def=i,!0)):e(this._def)}_mount(e){this._app=this._createApp(e),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const i in n)wt(this,i)||Object.defineProperty(this,i,{get:()=>ct(n[i])})}_resolveProps(e){const{props:n}=e,i=ft(n)?n:Object.keys(n||{});for(const s of Object.keys(this))s[0]!=="_"&&i.includes(s)&&this._setProp(s,this[s]);for(const s of i.map(he))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(r){this._setProp(s,r,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const n=this.hasAttribute(e);let i=n?this.getAttribute(e):La;const s=he(e);n&&this._numberProps&&this._numberProps[s]&&(i=Xs(i)),this._setProp(s,i,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,n,i=!0,s=!1){n!==this._props[e]&&(n===La?delete this._props[e]:(this._props[e]=n,e==="key"&&this._app&&(this._app._ceVNode.key=n)),s&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(ie(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(ie(e),n+""):n||this.removeAttribute(ie(e))))}_update(){wu(this._createVNode(),this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const n=oe(this._def,Ot(e,this._props));return this._instance||(n.ce=i=>{this._instance=i,i.ce=this,i.isCE=!0;const s=(r,o)=>{this.dispatchEvent(new CustomEvent(r,Ai(o[0])?Ot({detail:o},o[0]):{detail:o}))};i.emit=(r,...o)=>{s(r,o),ie(r)!==r&&s(ie(r),o)},this._setParent()}),n}_applyStyles(e,n){if(!e)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const i=this._nonce;for(let s=e.length-1;s>=0;s--){const r=document.createElement("style");i&&r.setAttribute("nonce",i),r.textContent=e[s],this.shadowRoot.prepend(r)}}_parseSlots(){const e=this._slots={};let n;for(;n=this.firstChild;){const i=n.nodeType===1&&n.getAttribute("slot")||"default";(e[i]||(e[i]=[])).push(n),this.removeChild(n)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let i=0;i<e.length;i++){const s=e[i],r=s.getAttribute("name")||"default",o=this._slots[r],a=s.parentNode;if(o)for(const l of o){if(n&&l.nodeType===1){const c=n+"-s",h=document.createTreeWalker(l,1);l.setAttribute(c,"");let p;for(;p=h.nextNode();)p.setAttribute(c,"")}a.insertBefore(l,s)}else for(;s.firstChild;)a.insertBefore(s.firstChild,s);a.removeChild(s)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}const rr=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ft(e)?n=>Ei(e,n):e};function mu(t){t.target.composing=!0}function Ga(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const an=Symbol("_assign"),yu={created(t,{modifiers:{lazy:e,trim:n,number:i}},s){t[an]=rr(s);const r=i||s.props&&s.props.type==="number";je(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),r&&(a=Mi(a)),t[an](a)}),n&&je(t,"change",()=>{t.value=t.value.trim()}),e||(je(t,"compositionstart",mu),je(t,"compositionend",Ga),je(t,"change",Ga))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:i,trim:s,number:r}},o){if(t[an]=rr(o),t.composing)return;const a=(r||t.type==="number")&&!/^0\d/.test(t.value)?Mi(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(i&&e===n||s&&t.value.trim()===l)||(t.value=l))}},_u={deep:!0,created(t,{value:e,modifiers:{number:n}},i){const s=ki(e);je(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Mi(sr(o)):sr(o));t[an](t.multiple?s?new Set(r):r:r[0]),t._assigning=!0,Vr(()=>{t._assigning=!1})}),t[an]=rr(i)},mounted(t,{value:e}){Ia(t,e)},beforeUpdate(t,e,n){t[an]=rr(n)},updated(t,{value:e}){t._assigning||Ia(t,e)}};function Ia(t,e){const n=t.multiple,i=ft(e);if(!(n&&!i&&!ki(e))){for(let s=0,r=t.options.length;s<r;s++){const o=t.options[s],a=sr(o);if(n)if(i){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=rh(e,a)>-1}else o.selected=e.has(a);else if(Fi(sr(o),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function sr(t){return"_value"in t?t._value:t.value}const vu=["ctrl","shift","alt","meta"],bu={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>vu.some(n=>t[`${n}Key`]&&!e.includes(n))},Su=(t,e)=>{const n=t._withMods||(t._withMods={}),i=e.join(".");return n[i]||(n[i]=(s,...r)=>{for(let o=0;o<e.length;o++){const a=bu[e[o]];if(a&&a(s,e))return}return t(s,...r)})},xu=Ot({patchProp:uu},Jd);let Ua;function Ba(){return Ua||(Ua=vd(xu))}const wu=(...t)=>{Ba().render(...t)},Ha=(...t)=>{const e=Ba().createApp(...t),{mount:n}=e;return e.mount=i=>{const s=Pu(i);if(!s)return;const r=e._component;!gt(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=n(s,!1,Cu(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function Cu(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Pu(t){return Mt(t)?document.querySelector(t):t}var Va=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var or={exports:{}},Mn={},os={},as={},za;function yt(){return za||(za=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Va<"u"?Va:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.21",isBrowser:n(),isUnminified:/param/.test(function(s){}.toString()),dblClickWindow:400,getAngle(s){return t.Konva.angleDeg?s*e:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var s;return(s=t.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(s){t.glob.Konva=s}};const i=s=>{t.Konva[s.prototype.getClassName()]=s};t._registerNode=i,t.Konva._injectGlobal(t.Konva)}(as)),as}var ls={},Wa;function Ft(){return Wa||(Wa=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=yt();class n{constructor(y=[1,0,0,1,0,0]){this.dirty=!1,this.m=y&&y.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(y){y.m[0]=this.m[0],y.m[1]=this.m[1],y.m[2]=this.m[2],y.m[3]=this.m[3],y.m[4]=this.m[4],y.m[5]=this.m[5]}point(y){const b=this.m;return{x:b[0]*y.x+b[2]*y.y+b[4],y:b[1]*y.x+b[3]*y.y+b[5]}}translate(y,b){return this.m[4]+=this.m[0]*y+this.m[2]*b,this.m[5]+=this.m[1]*y+this.m[3]*b,this}scale(y,b){return this.m[0]*=y,this.m[1]*=y,this.m[2]*=b,this.m[3]*=b,this}rotate(y){const b=Math.cos(y),k=Math.sin(y),D=this.m[0]*b+this.m[2]*k,x=this.m[1]*b+this.m[3]*k,w=this.m[0]*-k+this.m[2]*b,T=this.m[1]*-k+this.m[3]*b;return this.m[0]=D,this.m[1]=x,this.m[2]=w,this.m[3]=T,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(y,b){const k=this.m[0]+this.m[2]*b,D=this.m[1]+this.m[3]*b,x=this.m[2]+this.m[0]*y,w=this.m[3]+this.m[1]*y;return this.m[0]=k,this.m[1]=D,this.m[2]=x,this.m[3]=w,this}multiply(y){const b=this.m[0]*y.m[0]+this.m[2]*y.m[1],k=this.m[1]*y.m[0]+this.m[3]*y.m[1],D=this.m[0]*y.m[2]+this.m[2]*y.m[3],x=this.m[1]*y.m[2]+this.m[3]*y.m[3],w=this.m[0]*y.m[4]+this.m[2]*y.m[5]+this.m[4],T=this.m[1]*y.m[4]+this.m[3]*y.m[5]+this.m[5];return this.m[0]=b,this.m[1]=k,this.m[2]=D,this.m[3]=x,this.m[4]=w,this.m[5]=T,this}invert(){const y=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),b=this.m[3]*y,k=-this.m[1]*y,D=-this.m[2]*y,x=this.m[0]*y,w=y*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),T=y*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=b,this.m[1]=k,this.m[2]=D,this.m[3]=x,this.m[4]=w,this.m[5]=T,this}getMatrix(){return this.m}decompose(){const y=this.m[0],b=this.m[1],k=this.m[2],D=this.m[3],x=this.m[4],w=this.m[5],T=y*D-b*k,M={x,y:w,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(y!=0||b!=0){const L=Math.sqrt(y*y+b*b);M.rotation=b>0?Math.acos(y/L):-Math.acos(y/L),M.scaleX=L,M.scaleY=T/L,M.skewX=(y*k+b*D)/T,M.skewY=0}else if(k!=0||D!=0){const L=Math.sqrt(k*k+D*D);M.rotation=Math.PI/2-(D>0?Math.acos(-k/L):-Math.acos(k/L)),M.scaleX=T/L,M.scaleY=L,M.skewX=0,M.skewY=(y*k+b*D)/T}return M.rotation=t.Util._getRotation(M.rotation),M}}t.Transform=n;const i="[object Array]",s="[object Number]",r="[object String]",o="[object Boolean]",a=Math.PI/180,l=180/Math.PI,c="#",h="",p="0",f="Konva warning: ",u="Konva error: ",m="rgb(",_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const g=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(d){setTimeout(d,60)};t.Util={_isElement(d){return!!(d&&d.nodeType==1)},_isFunction(d){return!!(d&&d.constructor&&d.call&&d.apply)},_isPlainObject(d){return!!d&&d.constructor===Object},_isArray(d){return Object.prototype.toString.call(d)===i},_isNumber(d){return Object.prototype.toString.call(d)===s&&!isNaN(d)&&isFinite(d)},_isString(d){return Object.prototype.toString.call(d)===r},_isBoolean(d){return Object.prototype.toString.call(d)===o},isObject(d){return d instanceof Object},isValidSelector(d){if(typeof d!="string")return!1;const y=d[0];return y==="#"||y==="."||y===y.toUpperCase()},_sign(d){return d===0||d>0?1:-1},requestAnimFrame(d){C.push(d),C.length===1&&g(function(){const y=C;C=[],y.forEach(function(b){b()})})},createCanvasElement(){const d=document.createElement("canvas");try{d.style=d.style||{}}catch{}return d},createImageElement(){return document.createElement("img")},_isInDocument(d){for(;d=d.parentNode;)if(d==document)return!0;return!1},_urlToImage(d,y){const b=t.Util.createImageElement();b.onload=function(){y(b)},b.src=d},_rgbToHex(d,y,b){return(16777216+(d<<16)+(y<<8)+b).toString(16).slice(1)},_hexToRgb(d){d=d.replace(c,h);const y=parseInt(d,16);return{r:y>>16&255,g:y>>8&255,b:y&255}},getRandomColor(){let d=(Math.random()*16777215<<0).toString(16);for(;d.length<6;)d=p+d;return c+d},getRGB(d){let y;return d in _?(y=_[d],{r:y[0],g:y[1],b:y[2]}):d[0]===c?this._hexToRgb(d.substring(1)):d.substr(0,4)===m?(y=S.exec(d.replace(/ /g,"")),{r:parseInt(y[1],10),g:parseInt(y[2],10),b:parseInt(y[3],10)}):{r:0,g:0,b:0}},colorToRGBA(d){return d=d||"black",t.Util._namedColorToRBA(d)||t.Util._hex3ColorToRGBA(d)||t.Util._hex4ColorToRGBA(d)||t.Util._hex6ColorToRGBA(d)||t.Util._hex8ColorToRGBA(d)||t.Util._rgbColorToRGBA(d)||t.Util._rgbaColorToRGBA(d)||t.Util._hslColorToRGBA(d)},_namedColorToRBA(d){const y=_[d.toLowerCase()];return y?{r:y[0],g:y[1],b:y[2],a:1}:null},_rgbColorToRGBA(d){if(d.indexOf("rgb(")===0){d=d.match(/rgb\(([^)]+)\)/)[1];const y=d.split(/ *, */).map(Number);return{r:y[0],g:y[1],b:y[2],a:1}}},_rgbaColorToRGBA(d){if(d.indexOf("rgba(")===0){d=d.match(/rgba\(([^)]+)\)/)[1];const y=d.split(/ *, */).map((b,k)=>b.slice(-1)==="%"?k===3?parseInt(b)/100:parseInt(b)/100*255:Number(b));return{r:y[0],g:y[1],b:y[2],a:y[3]}}},_hex8ColorToRGBA(d){if(d[0]==="#"&&d.length===9)return{r:parseInt(d.slice(1,3),16),g:parseInt(d.slice(3,5),16),b:parseInt(d.slice(5,7),16),a:parseInt(d.slice(7,9),16)/255}},_hex6ColorToRGBA(d){if(d[0]==="#"&&d.length===7)return{r:parseInt(d.slice(1,3),16),g:parseInt(d.slice(3,5),16),b:parseInt(d.slice(5,7),16),a:1}},_hex4ColorToRGBA(d){if(d[0]==="#"&&d.length===5)return{r:parseInt(d[1]+d[1],16),g:parseInt(d[2]+d[2],16),b:parseInt(d[3]+d[3],16),a:parseInt(d[4]+d[4],16)/255}},_hex3ColorToRGBA(d){if(d[0]==="#"&&d.length===4)return{r:parseInt(d[1]+d[1],16),g:parseInt(d[2]+d[2],16),b:parseInt(d[3]+d[3],16),a:1}},_hslColorToRGBA(d){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(d)){const[y,...b]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(d),k=Number(b[0])/360,D=Number(b[1])/100,x=Number(b[2])/100;let w,T,M;if(D===0)return M=x*255,{r:Math.round(M),g:Math.round(M),b:Math.round(M),a:1};x<.5?w=x*(1+D):w=x+D-x*D;const L=2*x-w,I=[0,0,0];for(let V=0;V<3;V++)T=k+.3333333333333333*-(V-1),T<0&&T++,T>1&&T--,6*T<1?M=L+(w-L)*6*T:2*T<1?M=w:3*T<2?M=L+(w-L)*(.6666666666666666-T)*6:M=L,I[V]=M*255;return{r:Math.round(I[0]),g:Math.round(I[1]),b:Math.round(I[2]),a:1}}},haveIntersection(d,y){return!(y.x>d.x+d.width||y.x+y.width<d.x||y.y>d.y+d.height||y.y+y.height<d.y)},cloneObject(d){const y={};for(const b in d)this._isPlainObject(d[b])?y[b]=this.cloneObject(d[b]):this._isArray(d[b])?y[b]=this.cloneArray(d[b]):y[b]=d[b];return y},cloneArray(d){return d.slice(0)},degToRad(d){return d*a},radToDeg(d){return d*l},_degToRad(d){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(d)},_radToDeg(d){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(d)},_getRotation(d){return e.Konva.angleDeg?t.Util.radToDeg(d):d},_capitalize(d){return d.charAt(0).toUpperCase()+d.slice(1)},throw(d){throw new Error(u+d)},error(d){console.error(u+d)},warn(d){e.Konva.showWarnings&&console.warn(f+d)},each(d,y){for(const b in d)y(b,d[b])},_inRange(d,y,b){return y<=d&&d<b},_getProjectionToSegment(d,y,b,k,D,x){let w,T,M;const L=(d-b)*(d-b)+(y-k)*(y-k);if(L==0)w=d,T=y,M=(D-b)*(D-b)+(x-k)*(x-k);else{const I=((D-d)*(b-d)+(x-y)*(k-y))/L;I<0?(w=d,T=y,M=(d-D)*(d-D)+(y-x)*(y-x)):I>1?(w=b,T=k,M=(b-D)*(b-D)+(k-x)*(k-x)):(w=d+I*(b-d),T=y+I*(k-y),M=(w-D)*(w-D)+(T-x)*(T-x))}return[w,T,M]},_getProjectionToLine(d,y,b){const k=t.Util.cloneObject(d);let D=Number.MAX_VALUE;return y.forEach(function(x,w){if(!b&&w===y.length-1)return;const T=y[(w+1)%y.length],M=t.Util._getProjectionToSegment(x.x,x.y,T.x,T.y,d.x,d.y),L=M[0],I=M[1],V=M[2];V<D&&(k.x=L,k.y=I,D=V)}),k},_prepareArrayForTween(d,y,b){const k=[],D=[];if(d.length>y.length){const w=y;y=d,d=w}for(let w=0;w<d.length;w+=2)k.push({x:d[w],y:d[w+1]});for(let w=0;w<y.length;w+=2)D.push({x:y[w],y:y[w+1]});const x=[];return D.forEach(function(w){const T=t.Util._getProjectionToLine(w,k,b);x.push(T.x),x.push(T.y)}),x},_prepareToStringify(d){let y;d.visitedByCircularReferenceRemoval=!0;for(const b in d)if(d.hasOwnProperty(b)&&d[b]&&typeof d[b]=="object"){if(y=Object.getOwnPropertyDescriptor(d,b),d[b].visitedByCircularReferenceRemoval||t.Util._isElement(d[b]))if(y.configurable)delete d[b];else return null;else if(t.Util._prepareToStringify(d[b])===null)if(y.configurable)delete d[b];else return null}return delete d.visitedByCircularReferenceRemoval,d},_assign(d,y){for(const b in y)d[b]=y[b];return d},_getFirstPointerId(d){return d.touches?d.changedTouches[0].identifier:d.pointerId||999},releaseCanvas(...d){e.Konva.releaseCanvasOnDestroy&&d.forEach(y=>{y.width=0,y.height=0})},drawRoundedRectPath(d,y,b,k){let D=0,x=0,w=0,T=0;typeof k=="number"?D=x=w=T=Math.min(k,y/2,b/2):(D=Math.min(k[0]||0,y/2,b/2),x=Math.min(k[1]||0,y/2,b/2),T=Math.min(k[2]||0,y/2,b/2),w=Math.min(k[3]||0,y/2,b/2)),d.moveTo(D,0),d.lineTo(y-x,0),d.arc(y-x,x,x,Math.PI*3/2,0,!1),d.lineTo(y,b-T),d.arc(y-T,b-T,T,0,Math.PI/2,!1),d.lineTo(w,b),d.arc(w,b-w,w,Math.PI/2,Math.PI,!1),d.lineTo(0,D),d.arc(D,D,D,Math.PI,Math.PI*3/2,!1)}}}(ls)),ls}var Fn={},Ee={},Me={},$a;function ja(){if($a)return Me;$a=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.HitContext=Me.SceneContext=Me.Context=void 0;const t=Ft(),e=yt();function n(C){const g=[],d=C.length,y=t.Util;for(let b=0;b<d;b++){let k=C[b];y._isNumber(k)?k=Math.round(k*1e3)/1e3:y._isString(k)||(k=k+""),g.push(k)}return g}const i=",",s="(",r=")",o="([",a="])",l=";",c="()",h="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],f=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],u=100;let m=class{constructor(g){this.canvas=g,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(g){g.fillEnabled()&&this._fill(g)}_fill(g){}strokeShape(g){g.hasStroke()&&this._stroke(g)}_stroke(g){}fillStrokeShape(g){g.attrs.fillAfterStrokeEnabled?(this.strokeShape(g),this.fillShape(g)):(this.fillShape(g),this.strokeShape(g))}getTrace(g,d){let y=this.traceArr,b=y.length,k="",D,x,w,T;for(D=0;D<b;D++)x=y[D],w=x.method,w?(T=x.args,k+=w,g?k+=c:t.Util._isArray(T[0])?k+=o+T.join(i)+a:(d&&(T=T.map(M=>typeof M=="number"?Math.floor(M):M)),k+=s+T.join(i)+r)):(k+=x.property,g||(k+=h+x.val)),k+=l;return k}clearTrace(){this.traceArr=[]}_trace(g){let d=this.traceArr,y;d.push(g),y=d.length,y>=u&&d.shift()}reset(){const g=this.getCanvas().getPixelRatio();this.setTransform(1*g,0,0,1*g,0,0)}getCanvas(){return this.canvas}clear(g){const d=this.getCanvas();g?this.clearRect(g.x||0,g.y||0,g.width||0,g.height||0):this.clearRect(0,0,d.getWidth()/d.pixelRatio,d.getHeight()/d.pixelRatio)}_applyLineCap(g){const d=g.attrs.lineCap;d&&this.setAttr("lineCap",d)}_applyOpacity(g){const d=g.getAbsoluteOpacity();d!==1&&this.setAttr("globalAlpha",d)}_applyLineJoin(g){const d=g.attrs.lineJoin;d&&this.setAttr("lineJoin",d)}setAttr(g,d){this._context[g]=d}arc(g,d,y,b,k,D){this._context.arc(g,d,y,b,k,D)}arcTo(g,d,y,b,k){this._context.arcTo(g,d,y,b,k)}beginPath(){this._context.beginPath()}bezierCurveTo(g,d,y,b,k,D){this._context.bezierCurveTo(g,d,y,b,k,D)}clearRect(g,d,y,b){this._context.clearRect(g,d,y,b)}clip(...g){this._context.clip.apply(this._context,g)}closePath(){this._context.closePath()}createImageData(g,d){const y=arguments;if(y.length===2)return this._context.createImageData(g,d);if(y.length===1)return this._context.createImageData(g)}createLinearGradient(g,d,y,b){return this._context.createLinearGradient(g,d,y,b)}createPattern(g,d){return this._context.createPattern(g,d)}createRadialGradient(g,d,y,b,k,D){return this._context.createRadialGradient(g,d,y,b,k,D)}drawImage(g,d,y,b,k,D,x,w,T){const M=arguments,L=this._context;M.length===3?L.drawImage(g,d,y):M.length===5?L.drawImage(g,d,y,b,k):M.length===9&&L.drawImage(g,d,y,b,k,D,x,w,T)}ellipse(g,d,y,b,k,D,x,w){this._context.ellipse(g,d,y,b,k,D,x,w)}isPointInPath(g,d,y,b){return y?this._context.isPointInPath(y,g,d,b):this._context.isPointInPath(g,d,b)}fill(...g){this._context.fill.apply(this._context,g)}fillRect(g,d,y,b){this._context.fillRect(g,d,y,b)}strokeRect(g,d,y,b){this._context.strokeRect(g,d,y,b)}fillText(g,d,y,b){b?this._context.fillText(g,d,y,b):this._context.fillText(g,d,y)}measureText(g){return this._context.measureText(g)}getImageData(g,d,y,b){return this._context.getImageData(g,d,y,b)}lineTo(g,d){this._context.lineTo(g,d)}moveTo(g,d){this._context.moveTo(g,d)}rect(g,d,y,b){this._context.rect(g,d,y,b)}roundRect(g,d,y,b,k){this._context.roundRect(g,d,y,b,k)}putImageData(g,d,y){this._context.putImageData(g,d,y)}quadraticCurveTo(g,d,y,b){this._context.quadraticCurveTo(g,d,y,b)}restore(){this._context.restore()}rotate(g){this._context.rotate(g)}save(){this._context.save()}scale(g,d){this._context.scale(g,d)}setLineDash(g){this._context.setLineDash?this._context.setLineDash(g):"mozDash"in this._context?this._context.mozDash=g:"webkitLineDash"in this._context&&(this._context.webkitLineDash=g)}getLineDash(){return this._context.getLineDash()}setTransform(g,d,y,b,k,D){this._context.setTransform(g,d,y,b,k,D)}stroke(g){g?this._context.stroke(g):this._context.stroke()}strokeText(g,d,y,b){this._context.strokeText(g,d,y,b)}transform(g,d,y,b,k,D){this._context.transform(g,d,y,b,k,D)}translate(g,d){this._context.translate(g,d)}_enableTrace(){let g=this,d=p.length,y=this.setAttr,b,k;const D=function(x){let w=g[x],T;g[x]=function(){return k=n(Array.prototype.slice.call(arguments,0)),T=w.apply(g,arguments),g._trace({method:x,args:k}),T}};for(b=0;b<d;b++)D(p[b]);g.setAttr=function(){y.apply(g,arguments);const x=arguments[0];let w=arguments[1];(x==="shadowOffsetX"||x==="shadowOffsetY"||x==="shadowBlur")&&(w=w/this.canvas.getPixelRatio()),g._trace({property:x,val:w})}}_applyGlobalCompositeOperation(g){const d=g.attrs.globalCompositeOperation;!d||d==="source-over"||this.setAttr("globalCompositeOperation",d)}};Me.Context=m,f.forEach(function(C){Object.defineProperty(m.prototype,C,{get(){return this._context[C]},set(g){this._context[C]=g}})});class _ extends m{constructor(g,{willReadFrequently:d=!1}={}){super(g),this._context=g._canvas.getContext("2d",{willReadFrequently:d})}_fillColor(g){const d=g.fill();this.setAttr("fillStyle",d),g._fillFunc(this)}_fillPattern(g){this.setAttr("fillStyle",g._getFillPattern()),g._fillFunc(this)}_fillLinearGradient(g){const d=g._getLinearGradient();d&&(this.setAttr("fillStyle",d),g._fillFunc(this))}_fillRadialGradient(g){const d=g._getRadialGradient();d&&(this.setAttr("fillStyle",d),g._fillFunc(this))}_fill(g){const d=g.fill(),y=g.getFillPriority();if(d&&y==="color"){this._fillColor(g);return}const b=g.getFillPatternImage();if(b&&y==="pattern"){this._fillPattern(g);return}const k=g.getFillLinearGradientColorStops();if(k&&y==="linear-gradient"){this._fillLinearGradient(g);return}const D=g.getFillRadialGradientColorStops();if(D&&y==="radial-gradient"){this._fillRadialGradient(g);return}d?this._fillColor(g):b?this._fillPattern(g):k?this._fillLinearGradient(g):D&&this._fillRadialGradient(g)}_strokeLinearGradient(g){const d=g.getStrokeLinearGradientStartPoint(),y=g.getStrokeLinearGradientEndPoint(),b=g.getStrokeLinearGradientColorStops(),k=this.createLinearGradient(d.x,d.y,y.x,y.y);if(b){for(let D=0;D<b.length;D+=2)k.addColorStop(b[D],b[D+1]);this.setAttr("strokeStyle",k)}}_stroke(g){const d=g.dash(),y=g.getStrokeScaleEnabled();if(g.hasStroke()){if(!y){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(g),d&&g.dashEnabled()&&(this.setLineDash(d),this.setAttr("lineDashOffset",g.dashOffset())),this.setAttr("lineWidth",g.strokeWidth()),g.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),g.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(g):this.setAttr("strokeStyle",g.stroke()),g._strokeFunc(this),y||this.restore()}}_applyShadow(g){var d,y,b;const k=(d=g.getShadowRGBA())!==null&&d!==void 0?d:"black",D=(y=g.getShadowBlur())!==null&&y!==void 0?y:5,x=(b=g.getShadowOffset())!==null&&b!==void 0?b:{x:0,y:0},w=g.getAbsoluteScale(),T=this.canvas.getPixelRatio(),M=w.x*T,L=w.y*T;this.setAttr("shadowColor",k),this.setAttr("shadowBlur",D*Math.min(Math.abs(M),Math.abs(L))),this.setAttr("shadowOffsetX",x.x*M),this.setAttr("shadowOffsetY",x.y*L)}}Me.SceneContext=_;class S extends m{constructor(g){super(g),this._context=g._canvas.getContext("2d",{willReadFrequently:!0})}_fill(g){this.save(),this.setAttr("fillStyle",g.colorKey),g._fillFuncHit(this),this.restore()}strokeShape(g){g.hasHitStroke()&&this._stroke(g)}_stroke(g){if(g.hasHitStroke()){const d=g.getStrokeScaleEnabled();if(!d){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(g);const y=g.hitStrokeWidth(),b=y==="auto"?g.strokeWidth():y;this.setAttr("lineWidth",b),this.setAttr("strokeStyle",g.colorKey),g._strokeFuncHit(this),d||this.restore()}}}return Me.HitContext=S,Me}var qa;function ar(){if(qa)return Ee;qa=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.HitCanvas=Ee.SceneCanvas=Ee.Canvas=void 0;const t=Ft(),e=ja(),n=yt();let i;function s(){if(i)return i;const l=t.Util.createCanvasElement(),c=l.getContext("2d");return i=function(){const h=n.Konva._global.devicePixelRatio||1,p=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;return h/p}(),t.Util.releaseCanvas(l),i}let r=class{constructor(c){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const p=(c||{}).pixelRatio||n.Konva.pixelRatio||s();this.pixelRatio=p,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(c){const h=this.pixelRatio;this.pixelRatio=c,this.setSize(this.getWidth()/h,this.getHeight()/h)}setWidth(c){this.width=this._canvas.width=c*this.pixelRatio,this._canvas.style.width=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}setHeight(c){this.height=this._canvas.height=c*this.pixelRatio,this._canvas.style.height=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}getWidth(){return this.width}getHeight(){return this.height}setSize(c,h){this.setWidth(c||0),this.setHeight(h||0)}toDataURL(c,h){try{return this._canvas.toDataURL(c,h)}catch{try{return this._canvas.toDataURL()}catch(f){return t.Util.error("Unable to get data URL. "+f.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Ee.Canvas=r;class o extends r{constructor(c={width:0,height:0,willReadFrequently:!1}){super(c),this.context=new e.SceneContext(this,{willReadFrequently:c.willReadFrequently}),this.setSize(c.width,c.height)}}Ee.SceneCanvas=o;class a extends r{constructor(c={width:0,height:0}){super(c),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(c.width,c.height)}}return Ee.HitCanvas=a,Ee}var cs={},Ka;function hs(){return Ka||(Ka=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=yt(),n=Ft();t.DD={get isDragging(){let i=!1;return t.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return t.DD._dragElements.forEach(s=>{i=s.node}),i},_dragElements:new Map,_drag(i){const s=[];t.DD._dragElements.forEach((r,o)=>{const{node:a}=r,l=a.getStage();l.setPointersPositions(i),r.pointerId===void 0&&(r.pointerId=n.Util._getFirstPointerId(i));const c=l._changedPointerPositions.find(h=>h.id===r.pointerId);if(c){if(r.dragStatus!=="dragging"){const h=a.dragDistance();if(Math.max(Math.abs(c.x-r.startPointerPos.x),Math.abs(c.y-r.startPointerPos.y))<h||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,r),s.push(a)}}),s.forEach(r=>{r.fire("dragmove",{type:"dragmove",target:r,evt:i},!0)})},_endDragBefore(i){const s=[];t.DD._dragElements.forEach(r=>{const{node:o}=r,a=o.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(h=>h.id===r.pointerId))return;(r.dragStatus==="dragging"||r.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,r.dragStatus="stopped");const c=r.node.getLayer()||r.node instanceof e.Konva.Stage&&r.node;c&&s.indexOf(c)===-1&&s.push(c)}),s.forEach(r=>{r.draw()})},_endDragAfter(i){t.DD._dragElements.forEach((s,r)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:i},!0),s.dragStatus!=="dragging"&&t.DD._dragElements.delete(r)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))}(cs)),cs}var ds={},Yt={},Ya;function bt(){if(Ya)return Yt;Ya=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.RGBComponent=i,Yt.alphaComponent=s,Yt.getNumberValidator=r,Yt.getNumberOrArrayOfNumbersValidator=o,Yt.getNumberOrAutoValidator=a,Yt.getStringValidator=l,Yt.getStringOrGradientValidator=c,Yt.getFunctionValidator=h,Yt.getNumberArrayValidator=p,Yt.getBooleanValidator=f,Yt.getComponentValidator=u;const t=yt(),e=Ft();function n(m){return e.Util._isString(m)?'"'+m+'"':Object.prototype.toString.call(m)==="[object Number]"||e.Util._isBoolean(m)?m:Object.prototype.toString.call(m)}function i(m){return m>255?255:m<0?0:Math.round(m)}function s(m){return m>1?1:m<1e-4?1e-4:m}function r(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isNumber(m)||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a number.'),m}}function o(m){if(t.Konva.isUnminified)return function(_,S){let C=e.Util._isNumber(_),g=e.Util._isArray(_)&&_.length==m;return!C&&!g&&e.Util.warn(n(_)+' is a not valid value for "'+S+'" attribute. The value should be a number or Array<number>('+m+")"),_}}function a(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isNumber(m)||m==="auto"||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a number or "auto".'),m}}function l(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isString(m)||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a string.'),m}}function c(){if(t.Konva.isUnminified)return function(m,_){const S=e.Util._isString(m),C=Object.prototype.toString.call(m)==="[object CanvasGradient]"||m&&m.addColorStop;return S||C||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a string or a native gradient.'),m}}function h(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isFunction(m)||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a function.'),m}}function p(){if(t.Konva.isUnminified)return function(m,_){const S=Int8Array?Object.getPrototypeOf(Int8Array):null;return S&&m instanceof S||(e.Util._isArray(m)?m.forEach(function(C){e.Util._isNumber(C)||e.Util.warn('"'+_+'" attribute has non numeric element '+C+". Make sure that all elements are numbers.")}):e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a array of numbers.')),m}}function f(){if(t.Konva.isUnminified)return function(m,_){return m===!0||m===!1||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a boolean.'),m}}function u(m){if(t.Konva.isUnminified)return function(_,S){return _==null||e.Util.isObject(_)||e.Util.warn(n(_)+' is a not valid value for "'+S+'" attribute. The value should be an object with properties '+m),_}}return Yt}var Xa;function _t(){return Xa||(Xa=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Ft(),n=bt(),i="get",s="set";t.Factory={addGetterSetter(r,o,a,l,c){t.Factory.addGetter(r,o,a),t.Factory.addSetter(r,o,l,c),t.Factory.addOverloadedGetterSetter(r,o)},addGetter(r,o,a){const l=i+e.Util._capitalize(o);r.prototype[l]=r.prototype[l]||function(){const c=this.attrs[o];return c===void 0?a:c}},addSetter(r,o,a,l){const c=s+e.Util._capitalize(o);r.prototype[c]||t.Factory.overWriteSetter(r,o,a,l)},overWriteSetter(r,o,a,l){const c=s+e.Util._capitalize(o);r.prototype[c]=function(h){return a&&h!==void 0&&h!==null&&(h=a.call(this,h,o)),this._setAttr(o,h),l&&l.call(this),this}},addComponentsGetterSetter(r,o,a,l,c){const h=a.length,p=e.Util._capitalize,f=i+p(o),u=s+p(o);r.prototype[f]=function(){const _={};for(let S=0;S<h;S++){const C=a[S];_[C]=this.getAttr(o+p(C))}return _};const m=(0,n.getComponentValidator)(a);r.prototype[u]=function(_){const S=this.attrs[o];l&&(_=l.call(this,_,o)),m&&m.call(this,_,o);for(const C in _)_.hasOwnProperty(C)&&this._setAttr(o+p(C),_[C]);return _||a.forEach(C=>{this._setAttr(o+p(C),void 0)}),this._fireChangeEvent(o,S,_),c&&c.call(this),this},t.Factory.addOverloadedGetterSetter(r,o)},addOverloadedGetterSetter(r,o){const a=e.Util._capitalize(o),l=s+a,c=i+a;r.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(r,o,a,l){e.Util.error("Adding deprecated "+o);const c=i+e.Util._capitalize(o),h=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";r.prototype[c]=function(){e.Util.error(h);const p=this.attrs[o];return p===void 0?a:p},t.Factory.addSetter(r,o,l,function(){e.Util.error(h)}),t.Factory.addOverloadedGetterSetter(r,o)},backCompat(r,o){e.Util.each(o,function(a,l){const c=r.prototype[l],h=i+e.Util._capitalize(a),p=s+e.Util._capitalize(a);function f(){c.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}r.prototype[a]=f,r.prototype[h]=f,r.prototype[p]=f})},afterSetFilter(){this._filterUpToDate=!1}}}(ds)),ds}var Ja;function Dt(){if(Ja)return Fn;Ja=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.Node=void 0;const t=ar(),e=hs(),n=_t(),i=yt(),s=Ft(),r=bt(),o="absoluteOpacity",a="allEventListeners",l="absoluteTransform",c="absoluteScale",h="canvas",p="Change",f="children",u="konva",m="listening",_="mouseenter",S="mouseleave",C="pointerenter",g="pointerleave",d="touchenter",y="touchleave",b="set",k="Shape",D=" ",x="stage",w="transform",T="Stage",M="visible",L=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(D);let I=1,V=class Ws{constructor(v){this._id=I++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(v),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(v){(v===w||v===l)&&this._cache.get(v)?this._cache.get(v).dirty=!0:v?this._cache.delete(v):this._cache.clear()}_getCache(v,P){let E=this._cache.get(v);return(E===void 0||(v===w||v===l)&&E.dirty===!0)&&(E=P.call(this),this._cache.set(v,E)),E}_calculate(v,P,E){if(!this._attachedDepsListeners.get(v)){const R=P.map(O=>O+"Change.konva").join(D);this.on(R,()=>{this._clearCache(v)}),this._attachedDepsListeners.set(v,!0)}return this._getCache(v,E)}_getCanvasCache(){return this._cache.get(h)}_clearSelfAndDescendantCache(v){this._clearCache(v),v===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(h)){const{scene:v,filter:P,hit:E,buffer:R}=this._cache.get(h);s.Util.releaseCanvas(v,P,E,R),this._cache.delete(h)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(v){const P=v||{};let E={};(P.x===void 0||P.y===void 0||P.width===void 0||P.height===void 0)&&(E=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let R=Math.ceil(P.width||E.width),O=Math.ceil(P.height||E.height),j=P.pixelRatio,H=P.x===void 0?Math.floor(E.x):P.x,J=P.y===void 0?Math.floor(E.y):P.y,st=P.offset||0,$=P.drawBorder||!1,F=P.hitCanvasPixelRatio||1;if(!R||!O){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const W=Math.abs(Math.round(E.x)-H)>.5?1:0,et=Math.abs(Math.round(E.y)-J)>.5?1:0;R+=st*2+W,O+=st*2+et,H-=st,J-=st;const it=new t.SceneCanvas({pixelRatio:j,width:R,height:O}),ht=new t.SceneCanvas({pixelRatio:j,width:0,height:0,willReadFrequently:!0}),A=new t.HitCanvas({pixelRatio:F,width:R,height:O}),N=it.getContext(),z=A.getContext(),q=new t.SceneCanvas({width:it.width/it.pixelRatio+Math.abs(H),height:it.height/it.pixelRatio+Math.abs(J),pixelRatio:it.pixelRatio}),Y=q.getContext();return A.isCache=!0,it.isCache=!0,this._cache.delete(h),this._filterUpToDate=!1,P.imageSmoothingEnabled===!1&&(it.getContext()._context.imageSmoothingEnabled=!1,ht.getContext()._context.imageSmoothingEnabled=!1),N.save(),z.save(),Y.save(),N.translate(-H,-J),z.translate(-H,-J),Y.translate(-H,-J),q.x=H,q.y=J,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this.drawScene(it,this,q),this.drawHit(A,this),this._isUnderCache=!1,N.restore(),z.restore(),$&&(N.save(),N.beginPath(),N.rect(0,0,R,O),N.closePath(),N.setAttr("strokeStyle","red"),N.setAttr("lineWidth",5),N.stroke(),N.restore()),this._cache.set(h,{scene:it,filter:ht,hit:A,buffer:q,x:H,y:J}),this._requestDraw(),this}isCached(){return this._cache.has(h)}getClientRect(v){throw new Error('abstract "getClientRect" method call')}_transformedRect(v,P){const E=[{x:v.x,y:v.y},{x:v.x+v.width,y:v.y},{x:v.x+v.width,y:v.y+v.height},{x:v.x,y:v.y+v.height}];let R=1/0,O=1/0,j=-1/0,H=-1/0;const J=this.getAbsoluteTransform(P);return E.forEach(function(st){const $=J.point(st);R===void 0&&(R=j=$.x,O=H=$.y),R=Math.min(R,$.x),O=Math.min(O,$.y),j=Math.max(j,$.x),H=Math.max(H,$.y)}),{x:R,y:O,width:j-R,height:H-O}}_drawCachedSceneCanvas(v){v.save(),v._applyOpacity(this),v._applyGlobalCompositeOperation(this);const P=this._getCanvasCache();v.translate(P.x,P.y);const E=this._getCachedSceneCanvas(),R=E.pixelRatio;v.drawImage(E._canvas,0,0,E.width/R,E.height/R),v.restore()}_drawCachedHitCanvas(v){const P=this._getCanvasCache(),E=P.hit;v.save(),v.translate(P.x,P.y),v.drawImage(E._canvas,0,0,E.width/E.pixelRatio,E.height/E.pixelRatio),v.restore()}_getCachedSceneCanvas(){let v=this.filters(),P=this._getCanvasCache(),E=P.scene,R=P.filter,O=R.getContext(),j,H,J,st;if(v){if(!this._filterUpToDate){const $=E.pixelRatio;R.setSize(E.width/E.pixelRatio,E.height/E.pixelRatio);try{for(j=v.length,O.clear(),O.drawImage(E._canvas,0,0,E.getWidth()/$,E.getHeight()/$),H=O.getImageData(0,0,R.getWidth(),R.getHeight()),J=0;J<j;J++){if(st=v[J],typeof st!="function"){s.Util.error("Filter should be type of function, but got "+typeof st+" instead. Please check correct filters");continue}st.call(this,H),O.putImageData(H,0,0)}}catch(F){s.Util.error("Unable to apply filter. "+F.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return R}return E}on(v,P){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const E=v.split(D);for(let R=0;R<E.length;R++){const j=E[R].split("."),H=j[0],J=j[1]||"";this.eventListeners[H]||(this.eventListeners[H]=[]),this.eventListeners[H].push({name:J,handler:P})}return this}off(v,P){let E=(v||"").split(D),R=E.length,O,j,H,J,st,$;if(this._cache&&this._cache.delete(a),!v)for(j in this.eventListeners)this._off(j);for(O=0;O<R;O++)if(H=E[O],J=H.split("."),st=J[0],$=J[1],st)this.eventListeners[st]&&this._off(st,$,P);else for(j in this.eventListeners)this._off(j,$,P);return this}dispatchEvent(v){const P={target:this,type:v.type,evt:v};return this.fire(v.type,P),this}addEventListener(v,P){return this.on(v,function(E){P.call(this,E.evt)}),this}removeEventListener(v){return this.off(v),this}_delegate(v,P,E){const R=this;this.on(v,function(O){const j=O.target.findAncestors(P,!0,R);for(let H=0;H<j.length;H++)O=s.Util.cloneObject(O),O.currentTarget=j[H],E.call(j[H],O)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(x),this._clearSelfAndDescendantCache(M),this._clearSelfAndDescendantCache(m)}_remove(){this._clearCaches();const v=this.getParent();v&&v.children&&(v.children.splice(this.index,1),v._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(v){const P="get"+s.Util._capitalize(v);return s.Util._isFunction(this[P])?this[P]():this.attrs[v]}getAncestors(){let v=this.getParent(),P=[];for(;v;)P.push(v),v=v.getParent();return P}getAttrs(){return this.attrs||{}}setAttrs(v){return this._batchTransformChanges(()=>{let P,E;if(!v)return this;for(P in v)P!==f&&(E=b+s.Util._capitalize(P),s.Util._isFunction(this[E])?this[E](v[P]):this._setAttr(P,v[P]))}),this}isListening(){return this._getCache(m,this._isListening)}_isListening(v){if(!this.listening())return!1;const E=this.getParent();return E&&E!==v&&this!==v?E._isListening(v):!0}isVisible(){return this._getCache(M,this._isVisible)}_isVisible(v){if(!this.visible())return!1;const E=this.getParent();return E&&E!==v&&this!==v?E._isVisible(v):!0}shouldDrawHit(v,P=!1){if(v)return this._isVisible(v)&&this._isListening(v);const E=this.getLayer();let R=!1;e.DD._dragElements.forEach(j=>{j.dragStatus==="dragging"&&(j.node.nodeType==="Stage"||j.node.getLayer()===E)&&(R=!0)});const O=!P&&!i.Konva.hitOnDragEnabled&&(R||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!O}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let v=this.getDepth(),P=this,E=0,R,O,j,H;function J($){for(R=[],O=$.length,j=0;j<O;j++)H=$[j],E++,H.nodeType!==k&&(R=R.concat(H.getChildren().slice())),H._id===P._id&&(j=O);R.length>0&&R[0].getDepth()<=v&&J(R)}const st=this.getStage();return P.nodeType!==T&&st&&J(st.getChildren()),E}getDepth(){let v=0,P=this.parent;for(;P;)v++,P=P.parent;return v}_batchTransformChanges(v){this._batchingTransformChange=!0,v(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(w),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(v){return this._batchTransformChanges(()=>{this.x(v.x),this.y(v.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const v=this.getStage();if(!v)return null;const P=v.getPointerPosition();if(!P)return null;const E=this.getAbsoluteTransform().copy();return E.invert(),E.point(P)}getAbsolutePosition(v){let P=!1,E=this.parent;for(;E;){if(E.isCached()){P=!0;break}E=E.parent}P&&!v&&(v=!0);const R=this.getAbsoluteTransform(v).getMatrix(),O=new s.Transform,j=this.offset();return O.m=R.slice(),O.translate(j.x,j.y),O.getTranslation()}setAbsolutePosition(v){const{x:P,y:E,...R}=this._clearTransform();this.attrs.x=P,this.attrs.y=E,this._clearCache(w);const O=this._getAbsoluteTransform().copy();return O.invert(),O.translate(v.x,v.y),v={x:this.attrs.x+O.getTranslation().x,y:this.attrs.y+O.getTranslation().y},this._setTransform(R),this.setPosition({x:v.x,y:v.y}),this._clearCache(w),this._clearSelfAndDescendantCache(l),this}_setTransform(v){let P;for(P in v)this.attrs[P]=v[P]}_clearTransform(){const v={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,v}move(v){let P=v.x,E=v.y,R=this.x(),O=this.y();return P!==void 0&&(R+=P),E!==void 0&&(O+=E),this.setPosition({x:R,y:O}),this}_eachAncestorReverse(v,P){let E=[],R=this.getParent(),O,j;if(!(P&&P._id===this._id)){for(E.unshift(this);R&&(!P||R._id!==P._id);)E.unshift(R),R=R.parent;for(O=E.length,j=0;j<O;j++)v(E[j])}}rotate(v){return this.rotation(this.rotation()+v),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const v=this.index,P=this.parent.getChildren().length;return v<P-1?(this.parent.children.splice(v,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const v=this.index,P=this.parent.getChildren().length;return v<P-1?(this.parent.children.splice(v,1),this.parent.children.splice(v+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const v=this.index;return v>0?(this.parent.children.splice(v,1),this.parent.children.splice(v-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const v=this.index;return v>0?(this.parent.children.splice(v,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(v){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(v<0||v>=this.parent.children.length)&&s.Util.warn("Unexpected value "+v+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const P=this.index;return this.parent.children.splice(P,1),this.parent.children.splice(v,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let v=this.opacity();const P=this.getParent();return P&&!P._isUnderCache&&(v*=P.getAbsoluteOpacity()),v}moveTo(v){return this.getParent()!==v&&(this._remove(),v.add(this)),this}toObject(){let v=this.getAttrs(),P,E,R,O,j;const H={attrs:{},className:this.getClassName()};for(P in v)E=v[P],j=s.Util.isObject(E)&&!s.Util._isPlainObject(E)&&!s.Util._isArray(E),!j&&(R=typeof this[P]=="function"&&this[P],delete v[P],O=R?R.call(this):null,v[P]=E,O!==E&&(H.attrs[P]=E));return s.Util._prepareToStringify(H)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(v,P,E){const R=[];P&&this._isMatch(v)&&R.push(this);let O=this.parent;for(;O;){if(O===E)return R;O._isMatch(v)&&R.push(O),O=O.parent}return R}isAncestorOf(v){return!1}findAncestor(v,P,E){return this.findAncestors(v,P,E)[0]}_isMatch(v){if(!v)return!1;if(typeof v=="function")return v(this);let P=v.replace(/ /g,"").split(","),E=P.length,R,O;for(R=0;R<E;R++)if(O=P[R],s.Util.isValidSelector(O)||(s.Util.warn('Selector "'+O+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),O.charAt(0)==="#"){if(this.id()===O.slice(1))return!0}else if(O.charAt(0)==="."){if(this.hasName(O.slice(1)))return!0}else if(this.className===O||this.nodeType===O)return!0;return!1}getLayer(){const v=this.getParent();return v?v.getLayer():null}getStage(){return this._getCache(x,this._getStage)}_getStage(){const v=this.getParent();return v?v.getStage():null}fire(v,P={},E){return P.target=P.target||this,E?this._fireAndBubble(v,P):this._fire(v,P),this}getAbsoluteTransform(v){return v?this._getAbsoluteTransform(v):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(v){let P;if(v)return P=new s.Transform,this._eachAncestorReverse(function(E){const R=E.transformsEnabled();R==="all"?P.multiply(E.getTransform()):R==="position"&&P.translate(E.x()-E.offsetX(),E.y()-E.offsetY())},v),P;{P=this._cache.get(l)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(P):P.reset();const E=this.transformsEnabled();if(E==="all")P.multiply(this.getTransform());else if(E==="position"){const R=this.attrs.x||0,O=this.attrs.y||0,j=this.attrs.offsetX||0,H=this.attrs.offsetY||0;P.translate(R-j,O-H)}return P.dirty=!1,P}}getAbsoluteScale(v){let P=this;for(;P;)P._isUnderCache&&(v=P),P=P.getParent();const R=this.getAbsoluteTransform(v).decompose();return{x:R.scaleX,y:R.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(w,this._getTransform)}_getTransform(){var v,P;const E=this._cache.get(w)||new s.Transform;E.reset();const R=this.x(),O=this.y(),j=i.Konva.getAngle(this.rotation()),H=(v=this.attrs.scaleX)!==null&&v!==void 0?v:1,J=(P=this.attrs.scaleY)!==null&&P!==void 0?P:1,st=this.attrs.skewX||0,$=this.attrs.skewY||0,F=this.attrs.offsetX||0,W=this.attrs.offsetY||0;return(R!==0||O!==0)&&E.translate(R,O),j!==0&&E.rotate(j),(st!==0||$!==0)&&E.skew(st,$),(H!==1||J!==1)&&E.scale(H,J),(F!==0||W!==0)&&E.translate(-1*F,-1*W),E.dirty=!1,E}clone(v){let P=s.Util.cloneObject(this.attrs),E,R,O,j,H;for(E in v)P[E]=v[E];const J=new this.constructor(P);for(E in this.eventListeners)for(R=this.eventListeners[E],O=R.length,j=0;j<O;j++)H=R[j],H.name.indexOf(u)<0&&(J.eventListeners[E]||(J.eventListeners[E]=[]),J.eventListeners[E].push(H));return J}_toKonvaCanvas(v){v=v||{};const P=this.getClientRect(),E=this.getStage(),R=v.x!==void 0?v.x:Math.floor(P.x),O=v.y!==void 0?v.y:Math.floor(P.y),j=v.pixelRatio||1,H=new t.SceneCanvas({width:v.width||Math.ceil(P.width)||(E?E.width():0),height:v.height||Math.ceil(P.height)||(E?E.height():0),pixelRatio:j}),J=H.getContext(),st=new t.SceneCanvas({width:H.width/H.pixelRatio+Math.abs(R),height:H.height/H.pixelRatio+Math.abs(O),pixelRatio:H.pixelRatio});return v.imageSmoothingEnabled===!1&&(J._context.imageSmoothingEnabled=!1),J.save(),(R||O)&&J.translate(-1*R,-1*O),this.drawScene(H,void 0,st),J.restore(),H}toCanvas(v){return this._toKonvaCanvas(v)._canvas}toDataURL(v){v=v||{};const P=v.mimeType||null,E=v.quality||null,R=this._toKonvaCanvas(v).toDataURL(P,E);return v.callback&&v.callback(R),R}toImage(v){return new Promise((P,E)=>{try{const R=v?.callback;R&&delete v.callback,s.Util._urlToImage(this.toDataURL(v),function(O){P(O),R?.(O)})}catch(R){E(R)}})}toBlob(v){return new Promise((P,E)=>{try{const R=v?.callback;R&&delete v.callback,this.toCanvas(v).toBlob(O=>{P(O),R?.(O)},v?.mimeType,v?.quality)}catch(R){E(R)}})}setSize(v){return this.width(v.width),this.height(v.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(v,P,E){let R=this.eventListeners[v],O,j,H;for(O=0;O<R.length;O++)if(j=R[O].name,H=R[O].handler,(j!=="konva"||P==="konva")&&(!P||j===P)&&(!E||E===H)){if(R.splice(O,1),R.length===0){delete this.eventListeners[v];break}O--}}_fireChangeEvent(v,P,E){this._fire(v+p,{oldVal:P,newVal:E})}addName(v){if(!this.hasName(v)){const P=this.name(),E=P?P+" "+v:v;this.name(E)}return this}hasName(v){if(!v)return!1;const P=this.name();return P?(P||"").split(/\s/g).indexOf(v)!==-1:!1}removeName(v){const P=(this.name()||"").split(/\s/g),E=P.indexOf(v);return E!==-1&&(P.splice(E,1),this.name(P.join(" "))),this}setAttr(v,P){const E=this[b+s.Util._capitalize(v)];return s.Util._isFunction(E)?E.call(this,P):this._setAttr(v,P),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const v=this.getLayer()||this.getStage();v?.batchDraw()}}_setAttr(v,P){const E=this.attrs[v];E===P&&!s.Util.isObject(P)||(P==null?delete this.attrs[v]:this.attrs[v]=P,this._shouldFireChangeEvents&&this._fireChangeEvent(v,E,P),this._requestDraw())}_setComponentAttr(v,P,E){let R;E!==void 0&&(R=this.attrs[v],R||(this.attrs[v]=this.getAttr(v)),this.attrs[v][P]=E,this._fireChangeEvent(v,R,E))}_fireAndBubble(v,P,E){P&&this.nodeType===k&&(P.target=this);const R=[_,S,C,g,d,y];if(!(R.indexOf(v)!==-1&&(E&&(this===E||this.isAncestorOf&&this.isAncestorOf(E))||this.nodeType==="Stage"&&!E))){this._fire(v,P);const j=R.indexOf(v)!==-1&&E&&E.isAncestorOf&&E.isAncestorOf(this)&&!E.isAncestorOf(this.parent);(P&&!P.cancelBubble||!P)&&this.parent&&this.parent.isListening()&&!j&&(E&&E.parent?this._fireAndBubble.call(this.parent,v,P,E):this._fireAndBubble.call(this.parent,v,P))}}_getProtoListeners(v){var P,E,R;const O=(P=this._cache.get(a))!==null&&P!==void 0?P:{};let j=O?.[v];if(j===void 0){j=[];let H=Object.getPrototypeOf(this);for(;H;){const J=(R=(E=H.eventListeners)===null||E===void 0?void 0:E[v])!==null&&R!==void 0?R:[];j.push(...J),H=Object.getPrototypeOf(H)}O[v]=j,this._cache.set(a,O)}return j}_fire(v,P){P=P||{},P.currentTarget=this,P.type=v;const E=this._getProtoListeners(v);if(E)for(let O=0;O<E.length;O++)E[O].handler.call(this,P);const R=this.eventListeners[v];if(R)for(let O=0;O<R.length;O++)R[O].handler.call(this,P)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(v){const P=v?v.pointerId:void 0,E=this.getStage(),R=this.getAbsolutePosition();if(!E)return;const O=E._getPointerById(P)||E._changedPointerPositions[0]||R;e.DD._dragElements.set(this._id,{node:this,startPointerPos:O,offset:{x:O.x-R.x,y:O.y-R.y},dragStatus:"ready",pointerId:P})}startDrag(v,P=!0){e.DD._dragElements.has(this._id)||this._createDragElement(v);const E=e.DD._dragElements.get(this._id);E.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:v&&v.evt},P)}_setDragPosition(v,P){const E=this.getStage()._getPointerById(P.pointerId);if(!E)return;let R={x:E.x-P.offset.x,y:E.y-P.offset.y};const O=this.dragBoundFunc();if(O!==void 0){const j=O.call(this,R,v);j?R=j:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==R.x||this._lastPos.y!==R.y)&&(this.setAbsolutePosition(R),this._requestDraw()),this._lastPos=R}stopDrag(v){const P=e.DD._dragElements.get(this._id);P&&(P.dragStatus="stopped"),e.DD._endDragBefore(v),e.DD._endDragAfter(v)}setDraggable(v){this._setAttr("draggable",v),this._dragChange()}isDragging(){const v=e.DD._dragElements.get(this._id);return v?v.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(v){if(!(!(v.evt.button!==void 0)||i.Konva.dragButtons.indexOf(v.evt.button)>=0)||this.isDragging())return;let R=!1;e.DD._dragElements.forEach(O=>{this.isAncestorOf(O.node)&&(R=!0)}),R||this._createDragElement(v)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const P=e.DD._dragElements.get(this._id),E=P&&P.dragStatus==="dragging",R=P&&P.dragStatus==="ready";E?this.stopDrag():R&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(v={x:0,y:0}){const P=this.getStage();if(!P)return!1;const E={x:-v.x,y:-v.y,width:P.width()+2*v.x,height:P.height()+2*v.y};return s.Util.haveIntersection(E,this.getClientRect())}static create(v,P){return s.Util._isString(v)&&(v=JSON.parse(v)),this._createNode(v,P)}static _createNode(v,P){let E=Ws.prototype.getClassName.call(v),R=v.children,O,j,H;P&&(v.attrs.container=P),i.Konva[E]||(s.Util.warn('Can not find a node with class name "'+E+'". Fallback to "Shape".'),E="Shape");const J=i.Konva[E];if(O=new J(v.attrs),R)for(j=R.length,H=0;H<j;H++)O.add(Ws._createNode(R[H]));return O}};Fn.Node=V,V.prototype.nodeType="Node",V.prototype._attrsAffectingSize=[],V.prototype.eventListeners={},V.prototype.on.call(V.prototype,L,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(w),this._clearSelfAndDescendantCache(l)}),V.prototype.on.call(V.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(M)}),V.prototype.on.call(V.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(m)}),V.prototype.on.call(V.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const G=n.Factory.addGetterSetter;return G(V,"zIndex"),G(V,"absolutePosition"),G(V,"position"),G(V,"x",0,(0,r.getNumberValidator)()),G(V,"y",0,(0,r.getNumberValidator)()),G(V,"globalCompositeOperation","source-over",(0,r.getStringValidator)()),G(V,"opacity",1,(0,r.getNumberValidator)()),G(V,"name","",(0,r.getStringValidator)()),G(V,"id","",(0,r.getStringValidator)()),G(V,"rotation",0,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(V,"scale",["x","y"]),G(V,"scaleX",1,(0,r.getNumberValidator)()),G(V,"scaleY",1,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(V,"skew",["x","y"]),G(V,"skewX",0,(0,r.getNumberValidator)()),G(V,"skewY",0,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(V,"offset",["x","y"]),G(V,"offsetX",0,(0,r.getNumberValidator)()),G(V,"offsetY",0,(0,r.getNumberValidator)()),G(V,"dragDistance",void 0,(0,r.getNumberValidator)()),G(V,"width",0,(0,r.getNumberValidator)()),G(V,"height",0,(0,r.getNumberValidator)()),G(V,"listening",!0,(0,r.getBooleanValidator)()),G(V,"preventDefault",!0,(0,r.getBooleanValidator)()),G(V,"filters",void 0,function(X){return this._filterUpToDate=!1,X}),G(V,"visible",!0,(0,r.getBooleanValidator)()),G(V,"transformsEnabled","all",(0,r.getStringValidator)()),G(V,"size"),G(V,"dragBoundFunc"),G(V,"draggable",!1,(0,r.getBooleanValidator)()),n.Factory.backCompat(V,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Fn}var Dn={},Qa;function lr(){if(Qa)return Dn;Qa=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.Container=void 0;const t=_t(),e=Dt(),n=bt();let i=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(r){const o=this.children||[];return r?o.filter(r):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(r=>{r.parent=null,r.index=0,r.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(r=>{r.parent=null,r.index=0,r.destroy()}),this.children=[],this._requestDraw(),this}add(...r){if(r.length===0)return this;if(r.length>1){for(let a=0;a<r.length;a++)this.add(r[a]);return this}const o=r[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(r){return this._generalFind(r,!1)}findOne(r){const o=this._generalFind(r,!0);return o.length>0?o[0]:void 0}_generalFind(r,o){const a=[];return this._descendants(l=>{const c=l._isMatch(r);return c&&a.push(l),!!(c&&o)}),a}_descendants(r){let o=!1;const a=this.getChildren();for(const l of a){if(o=r(l),o)return!0;if(l.hasChildren()&&(o=l._descendants(r),o))return!0}return!1}toObject(){const r=e.Node.prototype.toObject.call(this);return r.children=[],this.getChildren().forEach(o=>{r.children.push(o.toObject())}),r}isAncestorOf(r){let o=r.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(r){const o=e.Node.prototype.clone.call(this,r);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(r){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(r)&&o.push(a)}),o}_clearSelfAndDescendantCache(r){var o;super._clearSelfAndDescendantCache(r),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(r)}))}_setChildrenIndices(){var r;(r=this.children)===null||r===void 0||r.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(r,o,a){const l=this.getLayer(),c=r||l&&l.getCanvas(),h=c&&c.getContext(),p=this._getCanvasCache(),f=p&&p.scene,u=c&&c.isCache;if(!this.isVisible()&&!u)return this;if(f){h.save();const m=this.getAbsoluteTransform(o).getMatrix();h.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedSceneCanvas(h),h.restore()}else this._drawChildren("drawScene",c,o,a);return this}drawHit(r,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),l=r||a&&a.hitCanvas,c=l&&l.getContext(),h=this._getCanvasCache();if(h&&h.hit){c.save();const f=this.getAbsoluteTransform(o).getMatrix();c.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",l,o);return this}_drawChildren(r,o,a,l){var c;const h=o&&o.getContext(),p=this.clipWidth(),f=this.clipHeight(),u=this.clipFunc(),m=typeof p=="number"&&typeof f=="number"||u,_=a===this;if(m){h.save();const C=this.getAbsoluteTransform(a);let g=C.getMatrix();h.transform(g[0],g[1],g[2],g[3],g[4],g[5]),h.beginPath();let d;if(u)d=u.call(this,h,this);else{const y=this.clipX(),b=this.clipY();h.rect(y||0,b||0,p,f)}h.clip.apply(h,d),g=C.copy().invert().getMatrix(),h.transform(g[0],g[1],g[2],g[3],g[4],g[5])}const S=!_&&this.globalCompositeOperation()!=="source-over"&&r==="drawScene";S&&(h.save(),h._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(C){C[r](o,a,l)}),S&&h.restore(),m&&h.restore()}getClientRect(r={}){var o;const a=r.skipTransform,l=r.relativeTo;let c,h,p,f,u={x:1/0,y:1/0,width:0,height:0};const m=this;(o=this.children)===null||o===void 0||o.forEach(function(C){if(!C.visible())return;const g=C.getClientRect({relativeTo:m,skipShadow:r.skipShadow,skipStroke:r.skipStroke});g.width===0&&g.height===0||(c===void 0?(c=g.x,h=g.y,p=g.x+g.width,f=g.y+g.height):(c=Math.min(c,g.x),h=Math.min(h,g.y),p=Math.max(p,g.x+g.width),f=Math.max(f,g.y+g.height)))});const _=this.find("Shape");let S=!1;for(let C=0;C<_.length;C++)if(_[C]._isVisible(this)){S=!0;break}return S&&c!==void 0?u={x:c,y:h,width:p-c,height:f-h}:u={x:0,y:0,width:0,height:0},a?u:this._transformedRect(u,l)}};return Dn.Container=i,t.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipFunc"),Dn}var us={},Ge={},Za;function tl(){if(Za)return Ge;Za=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.getCapturedShape=i,Ge.createEvent=s,Ge.hasPointerCapture=r,Ge.setPointerCapture=o,Ge.releaseCapture=a;const t=yt(),e=new Map,n=t.Konva._global.PointerEvent!==void 0;function i(l){return e.get(l)}function s(l){return{evt:l,pointerId:l.pointerId}}function r(l,c){return e.get(l)===c}function o(l,c){a(l),c.getStage()&&(e.set(l,c),n&&c._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function a(l,c){const h=e.get(l);if(!h)return;const p=h.getStage();p&&p.content,e.delete(l),n&&h._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return Ge}var el;function ku(){return el||(el=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Ft(),n=_t(),i=lr(),s=yt(),r=ar(),o=hs(),a=yt(),l=tl(),c="Stage",h="string",p="px",f="mouseout",u="mouseleave",m="mouseover",_="mouseenter",S="mousemove",C="mousedown",g="mouseup",d="pointermove",y="pointerdown",b="pointerup",k="pointercancel",D="lostpointercapture",x="pointerout",w="pointerleave",T="pointerover",M="pointerenter",L="contextmenu",I="touchstart",V="touchend",G="touchmove",X="touchcancel",v="wheel",P=5,E=[[_,"_pointerenter"],[C,"_pointerdown"],[S,"_pointermove"],[g,"_pointerup"],[u,"_pointerleave"],[I,"_pointerdown"],[G,"_pointermove"],[V,"_pointerup"],[X,"_pointercancel"],[m,"_pointerover"],[v,"_wheel"],[L,"_contextmenu"],[y,"_pointerdown"],[d,"_pointermove"],[b,"_pointerup"],[k,"_pointercancel"],[w,"_pointerleave"],[D,"_lostpointercapture"]],R={mouse:{[x]:f,[w]:u,[T]:m,[M]:_,[d]:S,[y]:C,[b]:g,[k]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[x]:"touchout",[w]:"touchleave",[T]:"touchover",[M]:"touchenter",[d]:G,[y]:I,[b]:V,[k]:X,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[x]:x,[w]:w,[T]:T,[M]:M,[d]:d,[y]:y,[b]:b,[k]:k,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},O=$=>$.indexOf("pointer")>=0?"pointer":$.indexOf("touch")>=0?"touch":"mouse",j=$=>{const F=O($);if(F==="pointer")return s.Konva.pointerEventsEnabled&&R.pointer;if(F==="touch")return R.touch;if(F==="mouse")return R.mouse};function H($={}){return($.clipFunc||$.clipWidth||$.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),$}const J="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class st extends i.Container{constructor(F){super(H(F)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{H(this.attrs)}),this._checkVisibility()}_validateAdd(F){const W=F.getType()==="Layer",et=F.getType()==="FastLayer";W||et||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const F=this.visible()?"":"none";this.content.style.display=F}setContainer(F){if(typeof F===h){let W;if(F.charAt(0)==="."){const et=F.slice(1);F=document.getElementsByClassName(et)[0]}else F.charAt(0)!=="#"?W=F:W=F.slice(1),F=document.getElementById(W);if(!F)throw"Can not find container in document with id "+W}return this._setAttr("container",F),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),F.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const F=this.children,W=F.length;for(let et=0;et<W;et++)F[et].clear();return this}clone(F){return F||(F={}),F.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,F)}destroy(){super.destroy();const F=this.content;F&&e.Util._isInDocument(F)&&this.container().removeChild(F);const W=t.stages.indexOf(this);return W>-1&&t.stages.splice(W,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const F=this._pointerPositions[0]||this._changedPointerPositions[0];return F?{x:F.x,y:F.y}:(e.Util.warn(J),null)}_getPointerById(F){return this._pointerPositions.find(W=>W.id===F)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(F){F=F||{},F.x=F.x||0,F.y=F.y||0,F.width=F.width||this.width(),F.height=F.height||this.height();const W=new r.SceneCanvas({width:F.width,height:F.height,pixelRatio:F.pixelRatio||1}),et=W.getContext()._context,it=this.children;return(F.x||F.y)&&et.translate(-1*F.x,-1*F.y),it.forEach(function(ht){if(!ht.isVisible())return;const A=ht._toKonvaCanvas(F);et.drawImage(A._canvas,F.x,F.y,A.getWidth()/A.getPixelRatio(),A.getHeight()/A.getPixelRatio())}),W}getIntersection(F){if(!F)return null;const W=this.children,et=W.length,it=et-1;for(let ht=it;ht>=0;ht--){const A=W[ht].getIntersection(F);if(A)return A}return null}_resizeDOM(){const F=this.width(),W=this.height();this.content&&(this.content.style.width=F+p,this.content.style.height=W+p),this.bufferCanvas.setSize(F,W),this.bufferHitCanvas.setSize(F,W),this.children.forEach(et=>{et.setSize({width:F,height:W}),et.draw()})}add(F,...W){if(arguments.length>1){for(let it=0;it<arguments.length;it++)this.add(arguments[it]);return this}super.add(F);const et=this.children.length;return et>P&&e.Util.warn("The stage has "+et+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),F.setSize({width:this.width(),height:this.height()}),F.draw(),s.Konva.isBrowser&&this.content.appendChild(F.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(F){return l.hasPointerCapture(F,this)}setPointerCapture(F){l.setPointerCapture(F,this)}releaseCapture(F){l.releaseCapture(F,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&E.forEach(([F,W])=>{this.content.addEventListener(F,et=>{this[W](et)},{passive:!1})})}_pointerenter(F){this.setPointersPositions(F);const W=j(F.type);W&&this._fire(W.pointerenter,{evt:F,target:this,currentTarget:this})}_pointerover(F){this.setPointersPositions(F);const W=j(F.type);W&&this._fire(W.pointerover,{evt:F,target:this,currentTarget:this})}_getTargetShape(F){let W=this[F+"targetShape"];return W&&!W.getStage()&&(W=null),W}_pointerleave(F){const W=j(F.type),et=O(F.type);if(!W)return;this.setPointersPositions(F);const it=this._getTargetShape(et),ht=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;it&&ht?(it._fireAndBubble(W.pointerout,{evt:F}),it._fireAndBubble(W.pointerleave,{evt:F}),this._fire(W.pointerleave,{evt:F,target:this,currentTarget:this}),this[et+"targetShape"]=null):ht&&(this._fire(W.pointerleave,{evt:F,target:this,currentTarget:this}),this._fire(W.pointerout,{evt:F,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(F){const W=j(F.type),et=O(F.type);if(!W)return;this.setPointersPositions(F);let it=!1;this._changedPointerPositions.forEach(ht=>{const A=this.getIntersection(ht);if(o.DD.justDragged=!1,s.Konva["_"+et+"ListenClick"]=!0,!A||!A.isListening()){this[et+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&A.setPointerCapture(ht.id),this[et+"ClickStartShape"]=A,A._fireAndBubble(W.pointerdown,{evt:F,pointerId:ht.id}),it=!0;const N=F.type.indexOf("touch")>=0;A.preventDefault()&&F.cancelable&&N&&F.preventDefault()}),it||this._fire(W.pointerdown,{evt:F,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(F){const W=j(F.type),et=O(F.type);if(!W||(s.Konva.isDragging()&&o.DD.node.preventDefault()&&F.cancelable&&F.preventDefault(),this.setPointersPositions(F),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const ht={};let A=!1;const N=this._getTargetShape(et);this._changedPointerPositions.forEach(z=>{const q=l.getCapturedShape(z.id)||this.getIntersection(z),Y=z.id,K={evt:F,pointerId:Y},Q=N!==q;if(Q&&N&&(N._fireAndBubble(W.pointerout,{...K},q),N._fireAndBubble(W.pointerleave,{...K},q)),q){if(ht[q._id])return;ht[q._id]=!0}q&&q.isListening()?(A=!0,Q&&(q._fireAndBubble(W.pointerover,{...K},N),q._fireAndBubble(W.pointerenter,{...K},N),this[et+"targetShape"]=q),q._fireAndBubble(W.pointermove,{...K})):N&&(this._fire(W.pointerover,{evt:F,target:this,currentTarget:this,pointerId:Y}),this[et+"targetShape"]=null)}),A||this._fire(W.pointermove,{evt:F,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(F){const W=j(F.type),et=O(F.type);if(!W)return;this.setPointersPositions(F);const it=this[et+"ClickStartShape"],ht=this[et+"ClickEndShape"],A={};let N=!1;this._changedPointerPositions.forEach(z=>{const q=l.getCapturedShape(z.id)||this.getIntersection(z);if(q){if(q.releaseCapture(z.id),A[q._id])return;A[q._id]=!0}const Y=z.id,K={evt:F,pointerId:Y};let Q=!1;s.Konva["_"+et+"InDblClickWindow"]?(Q=!0,clearTimeout(this[et+"DblTimeout"])):o.DD.justDragged||(s.Konva["_"+et+"InDblClickWindow"]=!0,clearTimeout(this[et+"DblTimeout"])),this[et+"DblTimeout"]=setTimeout(function(){s.Konva["_"+et+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),q&&q.isListening()?(N=!0,this[et+"ClickEndShape"]=q,q._fireAndBubble(W.pointerup,{...K}),s.Konva["_"+et+"ListenClick"]&&it&&it===q&&(q._fireAndBubble(W.pointerclick,{...K}),Q&&ht&&ht===q&&q._fireAndBubble(W.pointerdblclick,{...K}))):(this[et+"ClickEndShape"]=null,s.Konva["_"+et+"ListenClick"]&&this._fire(W.pointerclick,{evt:F,target:this,currentTarget:this,pointerId:Y}),Q&&this._fire(W.pointerdblclick,{evt:F,target:this,currentTarget:this,pointerId:Y}))}),N||this._fire(W.pointerup,{evt:F,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+et+"ListenClick"]=!1,F.cancelable&&et!=="touch"&&et!=="pointer"&&F.preventDefault()}_contextmenu(F){this.setPointersPositions(F);const W=this.getIntersection(this.getPointerPosition());W&&W.isListening()?W._fireAndBubble(L,{evt:F}):this._fire(L,{evt:F,target:this,currentTarget:this})}_wheel(F){this.setPointersPositions(F);const W=this.getIntersection(this.getPointerPosition());W&&W.isListening()?W._fireAndBubble(v,{evt:F}):this._fire(v,{evt:F,target:this,currentTarget:this})}_pointercancel(F){this.setPointersPositions(F);const W=l.getCapturedShape(F.pointerId)||this.getIntersection(this.getPointerPosition());W&&W._fireAndBubble(b,l.createEvent(F)),l.releaseCapture(F.pointerId)}_lostpointercapture(F){l.releaseCapture(F.pointerId)}setPointersPositions(F){const W=this._getContentPosition();let et=null,it=null;F=F||window.event,F.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(F.touches,ht=>{this._pointerPositions.push({id:ht.identifier,x:(ht.clientX-W.left)/W.scaleX,y:(ht.clientY-W.top)/W.scaleY})}),Array.prototype.forEach.call(F.changedTouches||F.touches,ht=>{this._changedPointerPositions.push({id:ht.identifier,x:(ht.clientX-W.left)/W.scaleX,y:(ht.clientY-W.top)/W.scaleY})})):(et=(F.clientX-W.left)/W.scaleX,it=(F.clientY-W.top)/W.scaleY,this.pointerPos={x:et,y:it},this._pointerPositions=[{x:et,y:it,id:e.Util._getFirstPointerId(F)}],this._changedPointerPositions=[{x:et,y:it,id:e.Util._getFirstPointerId(F)}])}_setPointerPosition(F){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(F)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const F=this.content.getBoundingClientRect();return{top:F.top,left:F.left,scaleX:F.width/this.content.clientWidth||1,scaleY:F.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new r.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new r.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const F=this.container();if(!F)throw"Stage has no container. A container is required.";F.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),F.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(F){F.batchDraw()}),this}}t.Stage=st,st.prototype.nodeType=c,(0,a._registerNode)(st),n.Factory.addGetterSetter(st,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach($=>{$.batchDraw()})})}(us)),us}var Nn={},fs={},nl;function Gt(){return nl||(nl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=yt(),n=Ft(),i=_t(),s=Dt(),r=bt(),o=yt(),a=tl(),l="hasShadow",c="shadowRGBA",h="patternImage",p="linearGradient",f="radialGradient";let u;function m(){return u||(u=n.Util.createCanvasElement().getContext("2d"),u)}t.shapes={};function _(w){const T=this.attrs.fillRule;T?w.fill(T):w.fill()}function S(w){w.stroke()}function C(w){const T=this.attrs.fillRule;T?w.fill(T):w.fill()}function g(w){w.stroke()}function d(){this._clearCache(l)}function y(){this._clearCache(c)}function b(){this._clearCache(h)}function k(){this._clearCache(p)}function D(){this._clearCache(f)}class x extends s.Node{constructor(T){super(T);let M;for(;M=n.Util.getRandomColor(),!(M&&!(M in t.shapes)););this.colorKey=M,t.shapes[M]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const M=m().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(M&&M.setTransform){const L=new n.Transform;L.translate(this.fillPatternX(),this.fillPatternY()),L.rotate(e.Konva.getAngle(this.fillPatternRotation())),L.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),L.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const I=L.getMatrix(),V=typeof DOMMatrix>"u"?{a:I[0],b:I[1],c:I[2],d:I[3],e:I[4],f:I[5]}:new DOMMatrix(I);M.setTransform(V)}return M}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const T=this.fillLinearGradientColorStops();if(T){const M=m(),L=this.fillLinearGradientStartPoint(),I=this.fillLinearGradientEndPoint(),V=M.createLinearGradient(L.x,L.y,I.x,I.y);for(let G=0;G<T.length;G+=2)V.addColorStop(T[G],T[G+1]);return V}}_getRadialGradient(){return this._getCache(f,this.__getRadialGradient)}__getRadialGradient(){const T=this.fillRadialGradientColorStops();if(T){const M=m(),L=this.fillRadialGradientStartPoint(),I=this.fillRadialGradientEndPoint(),V=M.createRadialGradient(L.x,L.y,this.fillRadialGradientStartRadius(),I.x,I.y,this.fillRadialGradientEndRadius());for(let G=0;G<T.length;G+=2)V.addColorStop(T[G],T[G+1]);return V}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const T=n.Util.colorToRGBA(this.shadowColor());if(T)return"rgba("+T.r+","+T.g+","+T.b+","+T.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const T=this.hitStrokeWidth();return T==="auto"?this.hasStroke():this.strokeEnabled()&&!!T}intersects(T){const M=this.getStage();if(!M)return!1;const L=M.bufferHitCanvas;return L.getContext().clear(),this.drawHit(L,void 0,!0),L.context.getImageData(Math.round(T.x),Math.round(T.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(T){var M;if(!((M=this.attrs.perfectDrawEnabled)!==null&&M!==void 0?M:!0))return!1;const I=T||this.hasFill(),V=this.hasStroke(),G=this.getAbsoluteOpacity()!==1;if(I&&V&&G)return!0;const X=this.hasShadow(),v=this.shadowForStrokeEnabled();return!!(I&&V&&X&&v)}setStrokeHitEnabled(T){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),T?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const T=this.size();return{x:this._centroid?-T.width/2:0,y:this._centroid?-T.height/2:0,width:T.width,height:T.height}}getClientRect(T={}){let M=!1,L=this.getParent();for(;L;){if(L.isCached()){M=!0;break}L=L.getParent()}const I=T.skipTransform,V=T.relativeTo||M&&this.getStage()||void 0,G=this.getSelfRect(),v=!T.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,P=G.width+v,E=G.height+v,R=!T.skipShadow&&this.hasShadow(),O=R?this.shadowOffsetX():0,j=R?this.shadowOffsetY():0,H=P+Math.abs(O),J=E+Math.abs(j),st=R&&this.shadowBlur()||0,$=H+st*2,F=J+st*2,W={width:$,height:F,x:-(v/2+st)+Math.min(O,0)+G.x,y:-(v/2+st)+Math.min(j,0)+G.y};return I?W:this._transformedRect(W,V)}drawScene(T,M,L){const I=this.getLayer(),V=T||I.getCanvas(),G=V.getContext(),X=this._getCanvasCache(),v=this.getSceneFunc(),P=this.hasShadow();let E;const R=M===this;if(!this.isVisible()&&!R)return this;if(X){G.save();const O=this.getAbsoluteTransform(M).getMatrix();return G.transform(O[0],O[1],O[2],O[3],O[4],O[5]),this._drawCachedSceneCanvas(G),G.restore(),this}if(!v)return this;if(G.save(),this._useBufferCanvas()){E=this.getStage();const O=L||E.bufferCanvas,j=O.getContext();j.clear(),j.save(),j._applyLineJoin(this);const H=this.getAbsoluteTransform(M).getMatrix();j.transform(H[0],H[1],H[2],H[3],H[4],H[5]),v.call(this,j,this),j.restore();const J=O.pixelRatio;P&&G._applyShadow(this),G._applyOpacity(this),G._applyGlobalCompositeOperation(this),G.drawImage(O._canvas,O.x||0,O.y||0,O.width/J,O.height/J)}else{if(G._applyLineJoin(this),!R){const O=this.getAbsoluteTransform(M).getMatrix();G.transform(O[0],O[1],O[2],O[3],O[4],O[5]),G._applyOpacity(this),G._applyGlobalCompositeOperation(this)}P&&G._applyShadow(this),v.call(this,G,this)}return G.restore(),this}drawHit(T,M,L=!1){if(!this.shouldDrawHit(M,L))return this;const I=this.getLayer(),V=T||I.hitCanvas,G=V&&V.getContext(),X=this.hitFunc()||this.sceneFunc(),v=this._getCanvasCache(),P=v&&v.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),P){G.save();const R=this.getAbsoluteTransform(M).getMatrix();return G.transform(R[0],R[1],R[2],R[3],R[4],R[5]),this._drawCachedHitCanvas(G),G.restore(),this}if(!X)return this;if(G.save(),G._applyLineJoin(this),!(this===M)){const R=this.getAbsoluteTransform(M).getMatrix();G.transform(R[0],R[1],R[2],R[3],R[4],R[5])}return X.call(this,G,this),G.restore(),this}drawHitFromCache(T=0){const M=this._getCanvasCache(),L=this._getCachedSceneCanvas(),I=M.hit,V=I.getContext(),G=I.getWidth(),X=I.getHeight();V.clear(),V.drawImage(L._canvas,0,0,G,X);try{const v=V.getImageData(0,0,G,X),P=v.data,E=P.length,R=n.Util._hexToRgb(this.colorKey);for(let O=0;O<E;O+=4)P[O+3]>T?(P[O]=R.r,P[O+1]=R.g,P[O+2]=R.b,P[O+3]=255):P[O+3]=0;V.putImageData(v,0,0)}catch(v){n.Util.error("Unable to draw hit graph from cached scene canvas. "+v.message)}return this}hasPointerCapture(T){return a.hasPointerCapture(T,this)}setPointerCapture(T){a.setPointerCapture(T,this)}releaseCapture(T){a.releaseCapture(T,this)}}t.Shape=x,x.prototype._fillFunc=_,x.prototype._strokeFunc=S,x.prototype._fillFuncHit=C,x.prototype._strokeFuncHit=g,x.prototype._centroid=!1,x.prototype.nodeType="Shape",(0,o._registerNode)(x),x.prototype.eventListeners={},x.prototype.on.call(x.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",d),x.prototype.on.call(x.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",b),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",k),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",D),i.Factory.addGetterSetter(x,"stroke",void 0,(0,r.getStringOrGradientValidator)()),i.Factory.addGetterSetter(x,"strokeWidth",2,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(x,"hitStrokeWidth","auto",(0,r.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(x,"strokeHitEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"perfectDrawEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"shadowForStrokeEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"lineJoin"),i.Factory.addGetterSetter(x,"lineCap"),i.Factory.addGetterSetter(x,"sceneFunc"),i.Factory.addGetterSetter(x,"hitFunc"),i.Factory.addGetterSetter(x,"dash"),i.Factory.addGetterSetter(x,"dashOffset",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowColor",void 0,(0,r.getStringValidator)()),i.Factory.addGetterSetter(x,"shadowBlur",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowOpacity",1,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(x,"shadowOffsetX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowOffsetY",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternImage"),i.Factory.addGetterSetter(x,"fill",void 0,(0,r.getStringOrGradientValidator)()),i.Factory.addGetterSetter(x,"fillPatternX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternY",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(x,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(x,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(x,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(x,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(x,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(x,"fillEnabled",!0),i.Factory.addGetterSetter(x,"strokeEnabled",!0),i.Factory.addGetterSetter(x,"shadowEnabled",!0),i.Factory.addGetterSetter(x,"dashEnabled",!0),i.Factory.addGetterSetter(x,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(x,"fillPriority","color"),i.Factory.addComponentsGetterSetter(x,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(x,"fillPatternOffsetX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternOffsetY",0,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(x,"fillPatternScaleX",1,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternScaleY",1,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(x,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(x,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(x,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(x,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(x,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(x,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(x,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(x,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(x,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(x,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(x,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(x,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(x,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(x,"fillPatternRotation",0),i.Factory.addGetterSetter(x,"fillRule",void 0,(0,r.getStringValidator)()),i.Factory.backCompat(x,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(fs)),fs}var il;function rl(){if(il)return Nn;il=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.Layer=void 0;const t=Ft(),e=lr(),n=Dt(),i=_t(),s=ar(),r=bt(),o=Gt(),a=yt(),l="#",c="beforeDraw",h="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],f=p.length;let u=class extends e.Container{constructor(_){super(_),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(_){return this.getContext().clear(_),this.getHitCanvas().getContext().clear(_),this}setZIndex(_){super.setZIndex(_);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),_<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[_+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);const _=this.getStage();return _&&_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!n.Node.prototype.moveUp.call(this))return!1;const S=this.getStage();return!S||!S.content?!1:(S.content.removeChild(this.getNativeCanvasElement()),this.index<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[this.index+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){const _=this.getStage();if(_){const S=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),S[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){const _=this.getStage();if(_){const S=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),S[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const _=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),_&&_.parentNode&&t.Util._isInDocument(_)&&_.parentNode.removeChild(_),this}getStage(){return this.parent}setSize({width:_,height:S}){return this.canvas.setSize(_,S),this.hitCanvas.setSize(_,S),this._setSmoothEnabled(),this}_validateAdd(_){const S=_.getType();S!=="Group"&&S!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(_){return _=_||{},_.width=_.width||this.getWidth(),_.height=_.height||this.getHeight(),_.x=_.x!==void 0?_.x:this.x(),_.y=_.y!==void 0?_.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,_)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(_){if(!this.isListening()||!this.isVisible())return null;let S=1,C=!1;for(;;){for(let g=0;g<f;g++){const d=p[g],y=this._getIntersection({x:_.x+d.x*S,y:_.y+d.y*S}),b=y.shape;if(b)return b;if(C=!!y.antialiased,!y.antialiased)break}if(C)S+=1;else return null}}_getIntersection(_){const S=this.hitCanvas.pixelRatio,C=this.hitCanvas.context.getImageData(Math.round(_.x*S),Math.round(_.y*S),1,1).data,g=C[3];if(g===255){const d=t.Util._rgbToHex(C[0],C[1],C[2]),y=o.shapes[l+d];return y?{shape:y}:{antialiased:!0}}else if(g>0)return{antialiased:!0};return{}}drawScene(_,S,C){const g=this.getLayer(),d=_||g&&g.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&d.getContext().clear(),e.Container.prototype.drawScene.call(this,d,S,C),this._fire(h,{node:this}),this}drawHit(_,S){const C=this.getLayer(),g=_||C&&C.hitCanvas;return C&&C.clearBeforeDraw()&&C.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,g,S),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(_){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(_)}getHitGraphEnabled(_){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const _=this.parent;!!this.hitCanvas._canvas.parentNode?_.content.removeChild(this.hitCanvas._canvas):_.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return Nn.Layer=u,u.prototype.nodeType="Layer",(0,a._registerNode)(u),i.Factory.addGetterSetter(u,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(u,"clearBeforeDraw",!0),i.Factory.addGetterSetter(u,"hitGraphEnabled",!0,(0,r.getBooleanValidator)()),Nn}var On={},sl;function Au(){if(sl)return On;sl=1,Object.defineProperty(On,"__esModule",{value:!0}),On.FastLayer=void 0;const t=Ft(),e=rl(),n=yt();let i=class extends e.Layer{constructor(r){super(r),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return On.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),On}var Ln={},ol;function gs(){if(ol)return Ln;ol=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.Group=void 0;const t=Ft(),e=lr(),n=yt();let i=class extends e.Container{_validateAdd(r){const o=r.getType();o!=="Group"&&o!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return Ln.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),Ln}var Gn={},al;function ps(){if(al)return Gn;al=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.Animation=void 0;const t=yt(),e=Ft(),n=function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}}();let i=class fn{constructor(r,o){this.id=fn.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=r,this.setLayers(o)}setLayers(r){let o=[];return r&&(o=Array.isArray(r)?r:[r]),this.layers=o,this}getLayers(){return this.layers}addLayer(r){const o=this.layers,a=o.length;for(let l=0;l<a;l++)if(o[l]._id===r._id)return!1;return this.layers.push(r),!0}isRunning(){const o=fn.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),fn._addAnimation(this),this}stop(){return fn._removeAnimation(this),this}_updateFrameObject(r){this.frame.timeDiff=r-this.frame.lastTime,this.frame.lastTime=r,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(r){this.animations.push(r),this._handleAnimation()}static _removeAnimation(r){const o=r.id,a=this.animations,l=a.length;for(let c=0;c<l;c++)if(a[c].id===o){this.animations.splice(c,1);break}}static _runFrames(){const r={},o=this.animations;for(let a=0;a<o.length;a++){const l=o[a],c=l.layers,h=l.func;l._updateFrameObject(n());const p=c.length;let f;if(h?f=h.call(l,l.frame)!==!1:f=!0,!!f)for(let u=0;u<p;u++){const m=c[u];m._id!==void 0&&(r[m._id]=m)}}for(const a in r)r.hasOwnProperty(a)&&r[a].batchDraw()}static _animationLoop(){const r=fn;r.animations.length?(r._runFrames(),e.Util.requestAnimFrame(r._animationLoop)):r.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return Gn.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,Gn}var ms={},ll;function Ru(){return ll||(ll=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Ft(),n=ps(),i=Dt(),s=yt(),r={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,l=3,c=["fill","stroke","shadowColor"];let h=0;class p{constructor(m,_,S,C,g,d,y){this.prop=m,this.propFunc=_,this.begin=C,this._pos=C,this.duration=d,this._change=0,this.prevPos=0,this.yoyo=y,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=S,this._change=g-this.begin,this.pause()}fire(m){const _=this[m];_&&_()}setTime(m){m>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():m<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=m,this.update())}getTime(){return this._time}setPosition(m){this.prevPos=this._pos,this.propFunc(m),this._pos=m}getPosition(m){return m===void 0&&(m=this._time),this.func(m,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(m){this.pause(),this._time=m,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const m=this.getTimer()-this._startTime;this.state===a?this.setTime(m):this.state===l&&this.setTime(this.duration-m)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class f{constructor(m){const _=this,S=m.node,C=S._id,g=m.easing||t.Easings.Linear,d=!!m.yoyo;let y,b;typeof m.duration>"u"?y=.3:m.duration===0?y=.001:y=m.duration,this.node=S,this._id=h++;const k=S.getLayer()||(S instanceof s.Konva.Stage?S.getLayers():null);k||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){_.tween.onEnterFrame()},k),this.tween=new p(b,function(D){_._tweenFunc(D)},g,0,1,y*1e3,d),this._addListeners(),f.attrs[C]||(f.attrs[C]={}),f.attrs[C][this._id]||(f.attrs[C][this._id]={}),f.tweens[C]||(f.tweens[C]={});for(b in m)r[b]===void 0&&this._addAttr(b,m[b]);this.reset(),this.onFinish=m.onFinish,this.onReset=m.onReset,this.onUpdate=m.onUpdate}_addAttr(m,_){const S=this.node,C=S._id;let g,d,y,b,k;const D=f.tweens[C][m];D&&delete f.attrs[C][D][m];let x=S.getAttr(m);if(e.Util._isArray(_))if(g=[],d=Math.max(_.length,x.length),m==="points"&&_.length!==x.length&&(_.length>x.length?(b=x,x=e.Util._prepareArrayForTween(x,_,S.closed())):(y=_,_=e.Util._prepareArrayForTween(_,x,S.closed()))),m.indexOf("fill")===0)for(let w=0;w<d;w++)if(w%2===0)g.push(_[w]-x[w]);else{const T=e.Util.colorToRGBA(x[w]);k=e.Util.colorToRGBA(_[w]),x[w]=T,g.push({r:k.r-T.r,g:k.g-T.g,b:k.b-T.b,a:k.a-T.a})}else for(let w=0;w<d;w++)g.push(_[w]-x[w]);else c.indexOf(m)!==-1?(x=e.Util.colorToRGBA(x),k=e.Util.colorToRGBA(_),g={r:k.r-x.r,g:k.g-x.g,b:k.b-x.b,a:k.a-x.a}):g=_-x;f.attrs[C][this._id][m]={start:x,diff:g,end:_,trueEnd:y,trueStart:b},f.tweens[C][m]=this._id}_tweenFunc(m){const _=this.node,S=f.attrs[_._id][this._id];let C,g,d,y,b,k,D,x;for(C in S){if(g=S[C],d=g.start,y=g.diff,x=g.end,e.Util._isArray(d))if(b=[],D=Math.max(d.length,x.length),C.indexOf("fill")===0)for(k=0;k<D;k++)k%2===0?b.push((d[k]||0)+y[k]*m):b.push("rgba("+Math.round(d[k].r+y[k].r*m)+","+Math.round(d[k].g+y[k].g*m)+","+Math.round(d[k].b+y[k].b*m)+","+(d[k].a+y[k].a*m)+")");else for(k=0;k<D;k++)b.push((d[k]||0)+y[k]*m);else c.indexOf(C)!==-1?b="rgba("+Math.round(d.r+y.r*m)+","+Math.round(d.g+y.g*m)+","+Math.round(d.b+y.b*m)+","+(d.a+y.a*m)+")":b=d+y*m;_.setAttr(C,b)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const m=this.node,_=f.attrs[m._id][this._id];_.points&&_.points.trueEnd&&m.setAttr("points",_.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const m=this.node,_=f.attrs[m._id][this._id];_.points&&_.points.trueStart&&m.points(_.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(m){return this.tween.seek(m*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const m=this.node._id,_=this._id,S=f.tweens[m];this.pause(),this.anim&&this.anim.stop();for(const C in S)delete f.tweens[m][C];delete f.attrs[m][_],Object.keys(f.tweens[m]).length===0&&delete f.tweens[m],Object.keys(f.attrs[m]).length===0&&delete f.attrs[m]}}t.Tween=f,f.attrs={},f.tweens={},i.Node.prototype.to=function(u){const m=u.onFinish;u.node=this,u.onFinish=function(){this.destroy(),m&&m()},new f(u).play()},t.Easings={BackEaseIn(u,m,_,S){return _*(u/=S)*u*(2.70158*u-1.70158)+m},BackEaseOut(u,m,_,S){return _*((u=u/S-1)*u*(2.70158*u+1.70158)+1)+m},BackEaseInOut(u,m,_,S){let C=1.70158;return(u/=S/2)<1?_/2*(u*u*(((C*=1.525)+1)*u-C))+m:_/2*((u-=2)*u*(((C*=1.525)+1)*u+C)+2)+m},ElasticEaseIn(u,m,_,S,C,g){let d=0;return u===0?m:(u/=S)===1?m+_:(g||(g=S*.3),!C||C<Math.abs(_)?(C=_,d=g/4):d=g/(2*Math.PI)*Math.asin(_/C),-(C*Math.pow(2,10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/g))+m)},ElasticEaseOut(u,m,_,S,C,g){let d=0;return u===0?m:(u/=S)===1?m+_:(g||(g=S*.3),!C||C<Math.abs(_)?(C=_,d=g/4):d=g/(2*Math.PI)*Math.asin(_/C),C*Math.pow(2,-10*u)*Math.sin((u*S-d)*(2*Math.PI)/g)+_+m)},ElasticEaseInOut(u,m,_,S,C,g){let d=0;return u===0?m:(u/=S/2)===2?m+_:(g||(g=S*.44999999999999996),!C||C<Math.abs(_)?(C=_,d=g/4):d=g/(2*Math.PI)*Math.asin(_/C),u<1?-.5*(C*Math.pow(2,10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/g))+m:C*Math.pow(2,-10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/g)*.5+_+m)},BounceEaseOut(u,m,_,S){return(u/=S)<.36363636363636365?_*(7.5625*u*u)+m:u<.7272727272727273?_*(7.5625*(u-=.5454545454545454)*u+.75)+m:u<.9090909090909091?_*(7.5625*(u-=.8181818181818182)*u+.9375)+m:_*(7.5625*(u-=.9545454545454546)*u+.984375)+m},BounceEaseIn(u,m,_,S){return _-t.Easings.BounceEaseOut(S-u,0,_,S)+m},BounceEaseInOut(u,m,_,S){return u<S/2?t.Easings.BounceEaseIn(u*2,0,_,S)*.5+m:t.Easings.BounceEaseOut(u*2-S,0,_,S)*.5+_*.5+m},EaseIn(u,m,_,S){return _*(u/=S)*u+m},EaseOut(u,m,_,S){return-_*(u/=S)*(u-2)+m},EaseInOut(u,m,_,S){return(u/=S/2)<1?_/2*u*u+m:-_/2*(--u*(u-2)-1)+m},StrongEaseIn(u,m,_,S){return _*(u/=S)*u*u*u*u+m},StrongEaseOut(u,m,_,S){return _*((u=u/S-1)*u*u*u*u+1)+m},StrongEaseInOut(u,m,_,S){return(u/=S/2)<1?_/2*u*u*u*u*u+m:_/2*((u-=2)*u*u*u*u+2)+m},Linear(u,m,_,S){return _*u/S+m}}}(ms)),ms}var cl;function Eu(){return cl||(cl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=yt(),n=Ft(),i=Dt(),s=lr(),r=ku(),o=rl(),a=Au(),l=gs(),c=hs(),h=Gt(),p=ps(),f=Ru(),u=ja(),m=ar();t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:s.Container,Stage:r.Stage,stages:r.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:c.DD,Shape:h.Shape,shapes:h.shapes,Animation:p.Animation,Tween:f.Tween,Easings:f.Easings,Context:u.Context,Canvas:m.Canvas}),t.default=t.Konva}(os)),os}var In={},hl;function Mu(){if(hl)return In;hl=1,Object.defineProperty(In,"__esModule",{value:!0}),In.Arc=void 0;const t=_t(),e=Gt(),n=yt(),i=bt(),s=yt();let r=class extends e.Shape{_sceneFunc(a){const l=n.Konva.getAngle(this.angle()),c=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,c),a.arc(0,0,this.innerRadius(),l,0,!c),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),c=this.clockwise(),h=n.Konva.getAngle(c?360-this.angle():this.angle()),p=Math.cos(Math.min(h,Math.PI)),f=1,u=Math.sin(Math.min(Math.max(Math.PI,h),3*Math.PI/2)),m=Math.sin(Math.min(h,Math.PI/2)),_=p*(p>0?a:l),S=f*l,C=u*(u>0?a:l),g=m*(m>0?l:a);return{x:_,y:c?-1*g:C,width:S-_,height:g-C}}};return In.Arc=r,r.prototype._centroid=!0,r.prototype.className="Arc",r.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clockwise",!1,(0,i.getBooleanValidator)()),In}var Un={},Bn={},dl;function ul(){if(dl)return Bn;dl=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.Line=void 0;const t=_t(),e=yt(),n=Gt(),i=bt();function s(a,l,c,h,p,f,u){const m=Math.sqrt(Math.pow(c-a,2)+Math.pow(h-l,2)),_=Math.sqrt(Math.pow(p-c,2)+Math.pow(f-h,2)),S=u*m/(m+_),C=u*_/(m+_),g=c-S*(p-a),d=h-S*(f-l),y=c+C*(p-a),b=h+C*(f-l);return[g,d,y,b]}function r(a,l){const c=a.length,h=[];for(let p=2;p<c-2;p+=2){const f=s(a[p-2],a[p-1],a[p],a[p+1],a[p+2],a[p+3],l);isNaN(f[0])||(h.push(f[0]),h.push(f[1]),h.push(a[p]),h.push(a[p+1]),h.push(f[2]),h.push(f[3]))}return h}let o=class extends n.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const c=this.points(),h=c.length,p=this.tension(),f=this.closed(),u=this.bezier();if(!h)return;let m=0;if(l.beginPath(),l.moveTo(c[0],c[1]),p!==0&&h>4){const _=this.getTensionPoints(),S=_.length;for(m=f?0:4,f||l.quadraticCurveTo(_[0],_[1],_[2],_[3]);m<S-2;)l.bezierCurveTo(_[m++],_[m++],_[m++],_[m++],_[m++],_[m++]);f||l.quadraticCurveTo(_[S-2],_[S-1],c[h-2],c[h-1])}else if(u)for(m=2;m<h;)l.bezierCurveTo(c[m++],c[m++],c[m++],c[m++],c[m++],c[m++]);else for(m=2;m<h;m+=2)l.lineTo(c[m],c[m+1]);f?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():r(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),c=l.length,h=this.tension(),p=s(l[c-2],l[c-1],l[0],l[1],l[2],l[3],h),f=s(l[c-4],l[c-3],l[c-2],l[c-1],l[0],l[1],h),u=r(l,h);return[p[2],p[3]].concat(u).concat([f[0],f[1],l[c-2],l[c-1],f[2],f[3],p[0],p[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let c=l[0],h=l[0],p=l[1],f=l[1],u,m;for(let _=0;_<l.length/2;_++)u=l[_*2],m=l[_*2+1],c=Math.min(c,u),h=Math.max(h,u),p=Math.min(p,m),f=Math.max(f,m);return{x:c,y:p,width:h-c,height:f-p}}};return Bn.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),t.Factory.addGetterSetter(o,"closed",!1),t.Factory.addGetterSetter(o,"bezier",!1),t.Factory.addGetterSetter(o,"tension",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,"points",[],(0,i.getNumberArrayValidator)()),Bn}var Hn={},ys={},fl;function Fu(){return fl||(fl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,l)=>{let c,h;const f=l/2;c=0;for(let u=0;u<20;u++)h=f*t.tValues[20][u]+f,c+=t.cValues[20][u]*i(o,a,h);return f*c};t.getCubicArcLength=e;const n=(o,a,l)=>{l===void 0&&(l=1);const c=o[0]-2*o[1]+o[2],h=a[0]-2*a[1]+a[2],p=2*o[1]-2*o[0],f=2*a[1]-2*a[0],u=4*(c*c+h*h),m=4*(c*p+h*f),_=p*p+f*f;if(u===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const S=m/(2*u),C=_/u,g=l+S,d=C-S*S,y=g*g+d>0?Math.sqrt(g*g+d):0,b=S*S+d>0?Math.sqrt(S*S+d):0,k=S+Math.sqrt(S*S+d)!==0?d*Math.log(Math.abs((g+y)/(S+b))):0;return Math.sqrt(u)/2*(g*y-S*b+k)};t.getQuadraticArcLength=n;function i(o,a,l){const c=s(1,l,o),h=s(1,l,a),p=c*c+h*h;return Math.sqrt(p)}const s=(o,a,l)=>{const c=l.length-1;let h,p;if(c===0)return 0;if(o===0){p=0;for(let f=0;f<=c;f++)p+=t.binomialCoefficients[c][f]*Math.pow(1-a,c-f)*Math.pow(a,f)*l[f];return p}else{h=new Array(c);for(let f=0;f<c;f++)h[f]=c*(l[f+1]-l[f]);return s(o-1,a,h)}},r=(o,a,l)=>{let c=1,h=o/a,p=(o-l(h))/a,f=0;for(;c>.001;){const u=l(h+p),m=Math.abs(o-u)/a;if(m<c)c=m,h+=p;else{const _=l(h-p),S=Math.abs(o-_)/a;S<c?(c=S,h-=p):p/=2}if(f++,f>500)break}return h};t.t2length=r}(ys)),ys}var gl;function _s(){if(gl)return Hn;gl=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.Path=void 0;const t=_t(),e=yt(),n=Gt(),i=Fu();let s=class Qt extends n.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Qt.parsePathData(this.data()),this.pathLength=Qt.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let l=!1;for(let c=0;c<a.length;c++){const h=a[c].command,p=a[c].points;switch(h){case"L":o.lineTo(p[0],p[1]);break;case"M":o.moveTo(p[0],p[1]);break;case"C":o.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":o.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":const f=p[0],u=p[1],m=p[2],_=p[3],S=p[4],C=p[5],g=p[6],d=p[7],y=m>_?m:_,b=m>_?1:m/_,k=m>_?_/m:1;o.translate(f,u),o.rotate(g),o.scale(b,k),o.arc(0,0,y,S,S+C,1-d),o.scale(1/b,1/k),o.rotate(-g),o.translate(-f,-u);break;case"z":l=!0,o.closePath();break}}!l&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(u){if(u.command==="A"){const m=u.points[4],_=u.points[5],S=u.points[4]+_;let C=Math.PI/180;if(Math.abs(m-S)<C&&(C=Math.abs(m-S)),_<0)for(let g=m-C;g>S;g-=C){const d=Qt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);o.push(d.x,d.y)}else for(let g=m+C;g<S;g+=C){const d=Qt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);o.push(d.x,d.y)}}else if(u.command==="C")for(let m=0;m<=1;m+=.01){const _=Qt.getPointOnCubicBezier(m,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);o.push(_.x,_.y)}else o=o.concat(u.points)});let a=o[0],l=o[0],c=o[1],h=o[1],p,f;for(let u=0;u<o.length/2;u++)p=o[u*2],f=o[u*2+1],isNaN(p)||(a=Math.min(a,p),l=Math.max(l,p)),isNaN(f)||(c=Math.min(c,f),h=Math.max(h,f));return{x:a,y:c,width:l-a,height:h-c}}getLength(){return this.pathLength}getPointAtLength(o){return Qt.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,l,c){return Math.sqrt((l-o)*(l-o)+(c-a)*(c-a))}static getPathLength(o){let a=0;for(let l=0;l<o.length;++l)a+=o[l].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let l,c=0,h=a.length;if(!h)return null;for(;c<h&&o>a[c].pathLength;)o-=a[c].pathLength,++c;if(c===h)return l=a[c-1].points.slice(-2),{x:l[0],y:l[1]};if(o<.01)return a[c].command==="M"?(l=a[c].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[c].start.x,y:a[c].start.y};const p=a[c],f=p.points;switch(p.command){case"L":return Qt.getPointOnLine(o,p.start.x,p.start.y,f[0],f[1]);case"C":return Qt.getPointOnCubicBezier((0,i.t2length)(o,Qt.getPathLength(a),y=>(0,i.getCubicArcLength)([p.start.x,f[0],f[2],f[4]],[p.start.y,f[1],f[3],f[5]],y)),p.start.x,p.start.y,f[0],f[1],f[2],f[3],f[4],f[5]);case"Q":return Qt.getPointOnQuadraticBezier((0,i.t2length)(o,Qt.getPathLength(a),y=>(0,i.getQuadraticArcLength)([p.start.x,f[0],f[2]],[p.start.y,f[1],f[3]],y)),p.start.x,p.start.y,f[0],f[1],f[2],f[3]);case"A":const u=f[0],m=f[1],_=f[2],S=f[3],C=f[5],g=f[6];let d=f[4];return d+=C*o/p.pathLength,Qt.getPointOnEllipticalArc(u,m,_,S,d,g)}return null}static getPointOnLine(o,a,l,c,h,p,f){p=p??a,f=f??l;const u=this.getLineLength(a,l,c,h);if(u<1e-10)return{x:a,y:l};if(c===a)return{x:p,y:f+(h>l?o:-o)};const m=(h-l)/(c-a),_=Math.sqrt(o*o/(1+m*m))*(c<a?-1:1),S=m*_;if(Math.abs(f-l-m*(p-a))<1e-10)return{x:p+_,y:f+S};const C=((p-a)*(c-a)+(f-l)*(h-l))/(u*u),g=a+C*(c-a),d=l+C*(h-l),y=this.getLineLength(p,f,g,d),b=Math.sqrt(o*o-y*y),k=Math.sqrt(b*b/(1+m*m))*(c<a?-1:1),D=m*k;return{x:g+k,y:d+D}}static getPointOnCubicBezier(o,a,l,c,h,p,f,u,m){function _(b){return b*b*b}function S(b){return 3*b*b*(1-b)}function C(b){return 3*b*(1-b)*(1-b)}function g(b){return(1-b)*(1-b)*(1-b)}const d=u*_(o)+p*S(o)+c*C(o)+a*g(o),y=m*_(o)+f*S(o)+h*C(o)+l*g(o);return{x:d,y}}static getPointOnQuadraticBezier(o,a,l,c,h,p,f){function u(g){return g*g}function m(g){return 2*g*(1-g)}function _(g){return(1-g)*(1-g)}const S=p*u(o)+c*m(o)+a*_(o),C=f*u(o)+h*m(o)+l*_(o);return{x:S,y:C}}static getPointOnEllipticalArc(o,a,l,c,h,p){const f=Math.cos(p),u=Math.sin(p),m={x:l*Math.cos(h),y:c*Math.sin(h)};return{x:o+(m.x*f-m.y*u),y:a+(m.x*u+m.y*f)}}static parsePathData(o){if(!o)return[];let a=o;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let S=0;S<l.length;S++)a=a.replace(new RegExp(l[S],"g"),"|"+l[S]);const c=a.split("|"),h=[],p=[];let f=0,u=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let S=1;S<c.length;S++){let C=c[S],g=C.charAt(0);for(C=C.slice(1),p.length=0;_=m.exec(C);)p.push(_[0]);const d=[];for(let y=0,b=p.length;y<b;y++){if(p[y]==="00"){d.push(0,0);continue}const k=parseFloat(p[y]);isNaN(k)?d.push(0):d.push(k)}for(;d.length>0&&!isNaN(d[0]);){let y="",b=[];const k=f,D=u;let x,w,T,M,L,I,V,G,X,v;switch(g){case"l":f+=d.shift(),u+=d.shift(),y="L",b.push(f,u);break;case"L":f=d.shift(),u=d.shift(),b.push(f,u);break;case"m":const P=d.shift(),E=d.shift();if(f+=P,u+=E,y="M",h.length>2&&h[h.length-1].command==="z"){for(let R=h.length-2;R>=0;R--)if(h[R].command==="M"){f=h[R].points[0]+P,u=h[R].points[1]+E;break}}b.push(f,u),g="l";break;case"M":f=d.shift(),u=d.shift(),y="M",b.push(f,u),g="L";break;case"h":f+=d.shift(),y="L",b.push(f,u);break;case"H":f=d.shift(),y="L",b.push(f,u);break;case"v":u+=d.shift(),y="L",b.push(f,u);break;case"V":u=d.shift(),y="L",b.push(f,u);break;case"C":b.push(d.shift(),d.shift(),d.shift(),d.shift()),f=d.shift(),u=d.shift(),b.push(f,u);break;case"c":b.push(f+d.shift(),u+d.shift(),f+d.shift(),u+d.shift()),f+=d.shift(),u+=d.shift(),y="C",b.push(f,u);break;case"S":w=f,T=u,x=h[h.length-1],x.command==="C"&&(w=f+(f-x.points[2]),T=u+(u-x.points[3])),b.push(w,T,d.shift(),d.shift()),f=d.shift(),u=d.shift(),y="C",b.push(f,u);break;case"s":w=f,T=u,x=h[h.length-1],x.command==="C"&&(w=f+(f-x.points[2]),T=u+(u-x.points[3])),b.push(w,T,f+d.shift(),u+d.shift()),f+=d.shift(),u+=d.shift(),y="C",b.push(f,u);break;case"Q":b.push(d.shift(),d.shift()),f=d.shift(),u=d.shift(),b.push(f,u);break;case"q":b.push(f+d.shift(),u+d.shift()),f+=d.shift(),u+=d.shift(),y="Q",b.push(f,u);break;case"T":w=f,T=u,x=h[h.length-1],x.command==="Q"&&(w=f+(f-x.points[0]),T=u+(u-x.points[1])),f=d.shift(),u=d.shift(),y="Q",b.push(w,T,f,u);break;case"t":w=f,T=u,x=h[h.length-1],x.command==="Q"&&(w=f+(f-x.points[0]),T=u+(u-x.points[1])),f+=d.shift(),u+=d.shift(),y="Q",b.push(w,T,f,u);break;case"A":M=d.shift(),L=d.shift(),I=d.shift(),V=d.shift(),G=d.shift(),X=f,v=u,f=d.shift(),u=d.shift(),y="A",b=this.convertEndpointToCenterParameterization(X,v,f,u,V,G,M,L,I);break;case"a":M=d.shift(),L=d.shift(),I=d.shift(),V=d.shift(),G=d.shift(),X=f,v=u,f+=d.shift(),u+=d.shift(),y="A",b=this.convertEndpointToCenterParameterization(X,v,f,u,V,G,M,L,I);break}h.push({command:y||g,points:b,start:{x:k,y:D},pathLength:this.calcLength(k,D,y||g,b)})}(g==="z"||g==="Z")&&h.push({command:"z",points:[],start:void 0,pathLength:0})}return h}static calcLength(o,a,l,c){let h,p,f,u;const m=Qt;switch(l){case"L":return m.getLineLength(o,a,c[0],c[1]);case"C":return(0,i.getCubicArcLength)([o,c[0],c[2],c[4]],[a,c[1],c[3],c[5]],1);case"Q":return(0,i.getQuadraticArcLength)([o,c[0],c[2]],[a,c[1],c[3]],1);case"A":h=0;const _=c[4],S=c[5],C=c[4]+S;let g=Math.PI/180;if(Math.abs(_-C)<g&&(g=Math.abs(_-C)),p=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],_,0),S<0)for(u=_-g;u>C;u-=g)f=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],u,0),h+=m.getLineLength(p.x,p.y,f.x,f.y),p=f;else for(u=_+g;u<C;u+=g)f=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],u,0),h+=m.getLineLength(p.x,p.y,f.x,f.y),p=f;return f=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],C,0),h+=m.getLineLength(p.x,p.y,f.x,f.y),h}return 0}static convertEndpointToCenterParameterization(o,a,l,c,h,p,f,u,m){const _=m*(Math.PI/180),S=Math.cos(_)*(o-l)/2+Math.sin(_)*(a-c)/2,C=-1*Math.sin(_)*(o-l)/2+Math.cos(_)*(a-c)/2,g=S*S/(f*f)+C*C/(u*u);g>1&&(f*=Math.sqrt(g),u*=Math.sqrt(g));let d=Math.sqrt((f*f*(u*u)-f*f*(C*C)-u*u*(S*S))/(f*f*(C*C)+u*u*(S*S)));h===p&&(d*=-1),isNaN(d)&&(d=0);const y=d*f*C/u,b=d*-u*S/f,k=(o+l)/2+Math.cos(_)*y-Math.sin(_)*b,D=(a+c)/2+Math.sin(_)*y+Math.cos(_)*b,x=function(G){return Math.sqrt(G[0]*G[0]+G[1]*G[1])},w=function(G,X){return(G[0]*X[0]+G[1]*X[1])/(x(G)*x(X))},T=function(G,X){return(G[0]*X[1]<G[1]*X[0]?-1:1)*Math.acos(w(G,X))},M=T([1,0],[(S-y)/f,(C-b)/u]),L=[(S-y)/f,(C-b)/u],I=[(-1*S-y)/f,(-1*C-b)/u];let V=T(L,I);return w(L,I)<=-1&&(V=Math.PI),w(L,I)>=1&&(V=0),p===0&&V>0&&(V=V-2*Math.PI),p===1&&V<0&&(V=V+2*Math.PI),[k,D,f,u,M,V,_,p]}};return Hn.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(s),t.Factory.addGetterSetter(s,"data"),Hn}var pl;function Du(){if(pl)return Un;pl=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.Arrow=void 0;const t=_t(),e=ul(),n=bt(),i=yt(),s=_s();let r=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,c=this.points();let h=c;const p=this.tension()!==0&&c.length>4;p&&(h=this.getTensionPoints());const f=this.pointerLength(),u=c.length;let m,_;if(p){const g=[h[h.length-4],h[h.length-3],h[h.length-2],h[h.length-1],c[u-2],c[u-1]],d=s.Path.calcLength(h[h.length-4],h[h.length-3],"C",g),y=s.Path.getPointOnQuadraticBezier(Math.min(1,1-f/d),g[0],g[1],g[2],g[3],g[4],g[5]);m=c[u-2]-y.x,_=c[u-1]-y.y}else m=c[u-2]-c[u-4],_=c[u-1]-c[u-3];const S=(Math.atan2(_,m)+l)%l,C=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(c[u-2],c[u-1]),a.rotate(S),a.moveTo(0,0),a.lineTo(-f,C/2),a.lineTo(-f,-C/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(c[0],c[1]),p?(m=(h[0]+h[2])/2-c[0],_=(h[1]+h[3])/2-c[1]):(m=c[2]-c[0],_=c[3]-c[1]),a.rotate((Math.atan2(-_,-m)+l)%l),a.moveTo(0,0),a.lineTo(-f,C/2),a.lineTo(-f,-C/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return Un.Arrow=r,r.prototype.className="Arrow",(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"pointerLength",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"pointerWidth",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"pointerAtBeginning",!1),t.Factory.addGetterSetter(r,"pointerAtEnding",!0),Un}var Vn={},ml;function Nu(){if(ml)return Vn;ml=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.Circle=void 0;const t=_t(),e=Gt(),n=bt(),i=yt();let s=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}};return Vn.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),Vn}var zn={},yl;function Ou(){if(yl)return zn;yl=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.Ellipse=void 0;const t=_t(),e=Gt(),n=bt(),i=yt();let s=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),l=this.radiusY();o.beginPath(),o.save(),a!==l&&o.scale(1,l/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return zn.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(s),t.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),t.Factory.addGetterSetter(s,"radiusX",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"radiusY",0,(0,n.getNumberValidator)()),zn}var Wn={},_l;function Lu(){if(_l)return Wn;_l=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.Image=void 0;const t=Ft(),e=_t(),n=Gt(),i=yt(),s=bt();let r=class jc extends n.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),c=this.getHeight(),h=this.cornerRadius(),p=this.attrs.image;let f;if(p){const u=this.attrs.cropWidth,m=this.attrs.cropHeight;u&&m?f=[p,this.cropX(),this.cropY(),u,m,0,0,l,c]:f=[p,0,0,l,c]}(this.hasFill()||this.hasStroke()||h)&&(a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)),p&&(h&&a.clip(),a.drawImage.apply(a,f))}_hitFunc(a){const l=this.width(),c=this.height(),h=this.cornerRadius();a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,c=null){const h=t.Util.createImageElement();h.onload=function(){const p=new jc({image:h});l(p)},h.onerror=c,h.crossOrigin="Anonymous",h.src=a}};return Wn.Image=r,r.prototype.className="Image",(0,i._registerNode)(r),e.Factory.addGetterSetter(r,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(r,"image"),e.Factory.addComponentsGetterSetter(r,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(r,"cropX",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropY",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropWidth",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropHeight",0,(0,s.getNumberValidator)()),Wn}var qe={},vl;function Gu(){if(vl)return qe;vl=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.Tag=qe.Label=void 0;const t=_t(),e=Gt(),n=gs(),i=bt(),s=yt(),r=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",l="up",c="right",h="down",p="left",f=r.length;let u=class extends n.Group{constructor(S){super(S),this.on("add.konva",function(C){this._addListeners(C.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(S){let C=this,g;const d=function(){C._sync()};for(g=0;g<f;g++)S.on(r[g]+o,d)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let S=this.getText(),C=this.getTag(),g,d,y,b,k,D,x;if(S&&C){switch(g=S.width(),d=S.height(),y=C.pointerDirection(),b=C.pointerWidth(),x=C.pointerHeight(),k=0,D=0,y){case l:k=g/2,D=-1*x;break;case c:k=g+b,D=d/2;break;case h:k=g/2,D=d+x;break;case p:k=-1*b,D=d/2;break}C.setAttrs({x:-1*k,y:-1*D,width:g,height:d}),S.setAttrs({x:-1*k,y:-1*D})}}};qe.Label=u,u.prototype.className="Label",(0,s._registerNode)(u);class m extends e.Shape{_sceneFunc(S){const C=this.width(),g=this.height(),d=this.pointerDirection(),y=this.pointerWidth(),b=this.pointerHeight(),k=this.cornerRadius();let D=0,x=0,w=0,T=0;typeof k=="number"?D=x=w=T=Math.min(k,C/2,g/2):(D=Math.min(k[0]||0,C/2,g/2),x=Math.min(k[1]||0,C/2,g/2),T=Math.min(k[2]||0,C/2,g/2),w=Math.min(k[3]||0,C/2,g/2)),S.beginPath(),S.moveTo(D,0),d===l&&(S.lineTo((C-y)/2,0),S.lineTo(C/2,-1*b),S.lineTo((C+y)/2,0)),S.lineTo(C-x,0),S.arc(C-x,x,x,Math.PI*3/2,0,!1),d===c&&(S.lineTo(C,(g-b)/2),S.lineTo(C+y,g/2),S.lineTo(C,(g+b)/2)),S.lineTo(C,g-T),S.arc(C-T,g-T,T,0,Math.PI/2,!1),d===h&&(S.lineTo((C+y)/2,g),S.lineTo(C/2,g+b),S.lineTo((C-y)/2,g)),S.lineTo(w,g),S.arc(w,g-w,w,Math.PI/2,Math.PI,!1),d===p&&(S.lineTo(0,(g+b)/2),S.lineTo(-1*y,g/2),S.lineTo(0,(g-b)/2)),S.lineTo(0,D),S.arc(D,D,D,Math.PI,Math.PI*3/2,!1),S.closePath(),S.fillStrokeShape(this)}getSelfRect(){let S=0,C=0,g=this.pointerWidth(),d=this.pointerHeight(),y=this.pointerDirection(),b=this.width(),k=this.height();return y===l?(C-=d,k+=d):y===h?k+=d:y===p?(S-=g*1.5,b+=g):y===c&&(b+=g*1.5),{x:S,y:C,width:b,height:k}}}return qe.Tag=m,m.prototype.className="Tag",(0,s._registerNode)(m),t.Factory.addGetterSetter(m,"pointerDirection",a),t.Factory.addGetterSetter(m,"pointerWidth",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(m,"pointerHeight",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(m,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),qe}var $n={},bl;function Sl(){if(bl)return $n;bl=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.Rect=void 0;const t=_t(),e=Gt(),n=yt(),i=Ft(),s=bt();let r=class extends e.Shape{_sceneFunc(a){const l=this.cornerRadius(),c=this.width(),h=this.height();a.beginPath(),l?i.Util.drawRoundedRectPath(a,c,h,l):a.rect(0,0,c,h),a.closePath(),a.fillStrokeShape(this)}};return $n.Rect=r,r.prototype.className="Rect",(0,n._registerNode)(r),t.Factory.addGetterSetter(r,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),$n}var jn={},xl;function Iu(){if(xl)return jn;xl=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.RegularPolygon=void 0;const t=_t(),e=Gt(),n=bt(),i=yt();let s=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)o.lineTo(a[l].x,a[l].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let c=0;c<o;c++)l.push({x:a*Math.sin(c*2*Math.PI/o),y:-1*a*Math.cos(c*2*Math.PI/o)});return l}getSelfRect(){const o=this._getPoints();let a=o[0].x,l=o[0].y,c=o[0].x,h=o[0].y;return o.forEach(p=>{a=Math.min(a,p.x),l=Math.max(l,p.x),c=Math.min(c,p.y),h=Math.max(h,p.y)}),{x:a,y:c,width:l-a,height:h-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return jn.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"sides",0,(0,n.getNumberValidator)()),jn}var qn={},wl;function Uu(){if(wl)return qn;wl=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.Ring=void 0;const t=_t(),e=Gt(),n=bt(),i=yt(),s=Math.PI*2;let r=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,s,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),s,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return qn.Ring=r,r.prototype.className="Ring",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,n.getNumberValidator)()),qn}var Kn={},Cl;function Bu(){if(Cl)return Kn;Cl=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.Sprite=void 0;const t=_t(),e=Gt(),n=ps(),i=bt(),s=yt();let r=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new n.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,p=this.animations()[l],f=this.frameOffsets(),u=p[h+0],m=p[h+1],_=p[h+2],S=p[h+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,_,S),a.closePath(),a.fillStrokeShape(this)),C)if(f){const g=f[l],d=c*2;a.drawImage(C,u,m,_,S,g[d+0],g[d+1],_,S)}else a.drawImage(C,u,m,_,S,0,0,_,S)}_hitFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,p=this.animations()[l],f=this.frameOffsets(),u=p[h+2],m=p[h+3];if(a.beginPath(),f){const _=f[l],S=c*2;a.rect(_[S+0],_[S+1],u,m)}else a.rect(0,0,u,m);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),c=this.animations(),h=c[l],p=h.length/4;a<p-1?this.frameIndex(a+1):this.frameIndex(0)}};return Kn.Sprite=r,r.prototype.className="Sprite",(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"animation"),t.Factory.addGetterSetter(r,"animations"),t.Factory.addGetterSetter(r,"frameOffsets"),t.Factory.addGetterSetter(r,"image"),t.Factory.addGetterSetter(r,"frameIndex",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"frameRate",17,(0,i.getNumberValidator)()),t.Factory.backCompat(r,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Kn}var Yn={},Pl;function Hu(){if(Pl)return Yn;Pl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.Star=void 0;const t=_t(),e=Gt(),n=bt(),i=yt();let s=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),l=this.outerRadius(),c=this.numPoints();o.beginPath(),o.moveTo(0,0-l);for(let h=1;h<c*2;h++){const p=h%2===0?l:a,f=p*Math.sin(h*Math.PI/c),u=-1*p*Math.cos(h*Math.PI/c);o.lineTo(f,u)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return Yn.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"numPoints",5,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,n.getNumberValidator)()),Yn}var ln={},Tl;function kl(){if(Tl)return ln;Tl=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.Text=void 0,ln.stringToArray=o;const t=Ft(),e=_t(),n=Gt(),i=yt(),s=bt(),r=yt();function o(j){return[...j].reduce((H,J,st,$)=>{if(/\p{Emoji}/u.test(J)){const F=$[st+1];F&&/\p{Emoji_Modifier}|\u200D/u.test(F)?(H.push(J+F),$[st+1]=""):H.push(J)}else/\p{Regional_Indicator}{2}/u.test(J+($[st+1]||""))?H.push(J+$[st+1]):st>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(J)?H[H.length-1]+=J:J&&H.push(J);return H},[])}const a="auto",l="center",c="inherit",h="justify",p="Change.konva",f="2d",u="-",m="left",_="text",S="Text",C="top",g="bottom",d="middle",y="normal",b="px ",k=" ",D="right",x="rtl",w="word",T="char",M="none",L="…",I=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],V=I.length;function G(j){return j.split(",").map(H=>{H=H.trim();const J=H.indexOf(" ")>=0,st=H.indexOf('"')>=0||H.indexOf("'")>=0;return J&&!st&&(H=`"${H}"`),H}).join(", ")}let X;function v(){return X||(X=t.Util.createCanvasElement().getContext(f),X)}function P(j){j.fillText(this._partialText,this._partialTextX,this._partialTextY)}function E(j){j.setAttr("miterLimit",2),j.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function R(j){return j=j||{},!j.fillLinearGradientColorStops&&!j.fillRadialGradientColorStops&&!j.fillPatternImage&&(j.fill=j.fill||"black"),j}let O=class extends n.Shape{constructor(H){super(R(H)),this._partialTextX=0,this._partialTextY=0;for(let J=0;J<V;J++)this.on(I[J]+p,this._setTextData);this._setTextData()}_sceneFunc(H){const J=this.textArr,st=J.length;if(!this.text())return;let $=this.padding(),F=this.fontSize(),W=this.lineHeight()*F,et=this.verticalAlign(),it=this.direction(),ht=0,A=this.align(),N=this.getWidth(),z=this.letterSpacing(),q=this.fill(),Y=this.textDecoration(),K=Y.indexOf("underline")!==-1,Q=Y.indexOf("line-through")!==-1,rt;it=it===c?H.direction:it;let B=W/2,U=d;if(i.Konva._fixTextRendering){const Z=this.measureSize("M");U="alphabetic",B=(Z.fontBoundingBoxAscent-Z.fontBoundingBoxDescent)/2+W/2}for(it===x&&H.setAttr("direction",it),H.setAttr("font",this._getContextFont()),H.setAttr("textBaseline",U),H.setAttr("textAlign",m),et===d?ht=(this.getHeight()-st*W-$*2)/2:et===g&&(ht=this.getHeight()-st*W-$*2),H.translate($,ht+$),rt=0;rt<st;rt++){let Z=0,nt=0;const at=J[rt],dt=at.text,ut=at.width,pt=at.lastInParagraph;if(H.save(),A===D?Z+=N-ut-$*2:A===l&&(Z+=(N-ut-$*2)/2),K){H.save(),H.beginPath();const ot=i.Konva._fixTextRendering?Math.round(F/4):Math.round(F/2),vt=Z,mt=B+nt+ot;H.moveTo(vt,mt);const xt=A===h&&!pt?N-$*2:ut;H.lineTo(vt+Math.round(xt),mt),H.lineWidth=F/15;const Et=this._getLinearGradient();H.strokeStyle=Et||q,H.stroke(),H.restore()}if(Q){H.save(),H.beginPath();const ot=i.Konva._fixTextRendering?-Math.round(F/4):0;H.moveTo(Z,B+nt+ot);const vt=A===h&&!pt?N-$*2:ut;H.lineTo(Z+Math.round(vt),B+nt+ot),H.lineWidth=F/15;const mt=this._getLinearGradient();H.strokeStyle=mt||q,H.stroke(),H.restore()}if(it!==x&&(z!==0||A===h)){const ot=dt.split(" ").length-1,vt=o(dt);for(let mt=0;mt<vt.length;mt++){const xt=vt[mt];xt===" "&&!pt&&A===h&&(Z+=(N-$*2-ut)/ot),this._partialTextX=Z,this._partialTextY=B+nt,this._partialText=xt,H.fillStrokeShape(this),Z+=this.measureSize(xt).width+z}}else z!==0&&H.setAttr("letterSpacing",`${z}px`),this._partialTextX=Z,this._partialTextY=B+nt,this._partialText=dt,H.fillStrokeShape(this);H.restore(),st>1&&(B+=W)}}_hitFunc(H){const J=this.getWidth(),st=this.getHeight();H.beginPath(),H.rect(0,0,J,st),H.closePath(),H.fillStrokeShape(this)}setText(H){const J=t.Util._isString(H)?H:H==null?"":H+"";return this._setAttr(_,J),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(H){var J,st,$,F,W,et,it,ht,A,N,z;let q=v(),Y=this.fontSize(),K;q.save(),q.font=this._getContextFont(),K=q.measureText(H),q.restore();const Q=Y/100;return{actualBoundingBoxAscent:(J=K.actualBoundingBoxAscent)!==null&&J!==void 0?J:71.58203125*Q,actualBoundingBoxDescent:(st=K.actualBoundingBoxDescent)!==null&&st!==void 0?st:0,actualBoundingBoxLeft:($=K.actualBoundingBoxLeft)!==null&&$!==void 0?$:-7.421875*Q,actualBoundingBoxRight:(F=K.actualBoundingBoxRight)!==null&&F!==void 0?F:75.732421875*Q,alphabeticBaseline:(W=K.alphabeticBaseline)!==null&&W!==void 0?W:0,emHeightAscent:(et=K.emHeightAscent)!==null&&et!==void 0?et:100*Q,emHeightDescent:(it=K.emHeightDescent)!==null&&it!==void 0?it:-20*Q,fontBoundingBoxAscent:(ht=K.fontBoundingBoxAscent)!==null&&ht!==void 0?ht:91*Q,fontBoundingBoxDescent:(A=K.fontBoundingBoxDescent)!==null&&A!==void 0?A:21*Q,hangingBaseline:(N=K.hangingBaseline)!==null&&N!==void 0?N:72.80000305175781*Q,ideographicBaseline:(z=K.ideographicBaseline)!==null&&z!==void 0?z:-21*Q,width:K.width,height:Y}}_getContextFont(){return this.fontStyle()+k+this.fontVariant()+k+(this.fontSize()+b)+G(this.fontFamily())}_addTextLine(H){this.align()===h&&(H=H.trim());const st=this._getTextWidth(H);return this.textArr.push({text:H,width:st,lastInParagraph:!1})}_getTextWidth(H){const J=this.letterSpacing(),st=H.length;return v().measureText(H).width+J*st}_setTextData(){let H=this.text().split(`
`),J=+this.fontSize(),st=0,$=this.lineHeight()*J,F=this.attrs.width,W=this.attrs.height,et=F!==a&&F!==void 0,it=W!==a&&W!==void 0,ht=this.padding(),A=F-ht*2,N=W-ht*2,z=0,q=this.wrap(),Y=q!==M,K=q!==T&&Y,Q=this.ellipsis();this.textArr=[],v().font=this._getContextFont();const rt=Q?this._getTextWidth(L):0;for(let B=0,U=H.length;B<U;++B){let Z=H[B],nt=this._getTextWidth(Z);if(et&&nt>A)for(;Z.length>0;){let at=0,dt=o(Z).length,ut="",pt=0;for(;at<dt;){const ot=at+dt>>>1,vt=o(Z),mt=vt.slice(0,ot+1).join(""),xt=this._getTextWidth(mt);(Q&&it&&z+$>N?xt+rt:xt)<=A?(at=ot+1,ut=mt,pt=xt):dt=ot}if(ut){if(K){const mt=o(Z),xt=o(ut),Et=mt[xt.length],Jt=Et===k||Et===u;let Vt;if(Jt&&pt<=A)Vt=xt.length;else{const Ut=xt.lastIndexOf(k),qt=xt.lastIndexOf(u);Vt=Math.max(Ut,qt)+1}Vt>0&&(at=Vt,ut=mt.slice(0,at).join(""),pt=this._getTextWidth(ut))}if(ut=ut.trimRight(),this._addTextLine(ut),st=Math.max(st,pt),z+=$,this._shouldHandleEllipsis(z)){this._tryToAddEllipsisToLastLine();break}if(Z=o(Z).slice(at).join("").trimLeft(),Z.length>0&&(nt=this._getTextWidth(Z),nt<=A)){this._addTextLine(Z),z+=$,st=Math.max(st,nt);break}}else break}else this._addTextLine(Z),z+=$,st=Math.max(st,nt),this._shouldHandleEllipsis(z)&&B<U-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),it&&z+$>N)break}this.textHeight=J,this.textWidth=st}_shouldHandleEllipsis(H){const J=+this.fontSize(),st=this.lineHeight()*J,$=this.attrs.height,F=$!==a&&$!==void 0,W=this.padding(),et=$-W*2;return!(this.wrap()!==M)||F&&H+st>et}_tryToAddEllipsisToLastLine(){const H=this.attrs.width,J=H!==a&&H!==void 0,st=this.padding(),$=H-st*2,F=this.ellipsis(),W=this.textArr[this.textArr.length-1];!W||!F||(J&&(this._getTextWidth(W.text+L)<$||(W.text=W.text.slice(0,W.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(W.text+L))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const H=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,J=this.hasShadow();return H&&J?!0:super._useBufferCanvas()}};return ln.Text=O,O.prototype._fillFunc=P,O.prototype._strokeFunc=E,O.prototype.className=S,O.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,r._registerNode)(O),e.Factory.overWriteSetter(O,"width",(0,s.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(O,"height",(0,s.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(O,"direction",c),e.Factory.addGetterSetter(O,"fontFamily","Arial"),e.Factory.addGetterSetter(O,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"fontStyle",y),e.Factory.addGetterSetter(O,"fontVariant",y),e.Factory.addGetterSetter(O,"padding",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"align",m),e.Factory.addGetterSetter(O,"verticalAlign",C),e.Factory.addGetterSetter(O,"lineHeight",1,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"wrap",w),e.Factory.addGetterSetter(O,"ellipsis",!1,(0,s.getBooleanValidator)()),e.Factory.addGetterSetter(O,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"text","",(0,s.getStringValidator)()),e.Factory.addGetterSetter(O,"textDecoration",""),ln}var Xn={},Al;function Vu(){if(Al)return Xn;Al=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.TextPath=void 0;const t=Ft(),e=_t(),n=Gt(),i=_s(),s=kl(),r=bt(),o=yt(),a="",l="normal";function c(f){f.fillText(this.partialText,0,0)}function h(f){f.strokeText(this.partialText,0,0)}let p=class extends n.Shape{constructor(u){super(u),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(u){if(!this.attrs.data)return null;const m=this.pathLength;return u-1>m?null:i.Path.getPointAtLengthOfDataArray(u,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(u){u.setAttr("font",this._getContextFont()),u.setAttr("textBaseline",this.textBaseline()),u.setAttr("textAlign","left"),u.save();const m=this.textDecoration(),_=this.fill(),S=this.fontSize(),C=this.glyphInfo;m==="underline"&&u.beginPath();for(let g=0;g<C.length;g++){u.save();const d=C[g].p0;u.translate(d.x,d.y),u.rotate(C[g].rotation),this.partialText=C[g].text,u.fillStrokeShape(this),m==="underline"&&(g===0&&u.moveTo(0,S/2+1),u.lineTo(S,S/2+1)),u.restore()}m==="underline"&&(u.strokeStyle=_,u.lineWidth=S/20,u.stroke()),u.restore()}_hitFunc(u){u.beginPath();const m=this.glyphInfo;if(m.length>=1){const _=m[0].p0;u.moveTo(_.x,_.y)}for(let _=0;_<m.length;_++){const S=m[_].p1;u.lineTo(S.x,S.y)}u.setAttr("lineWidth",this.fontSize()),u.setAttr("strokeStyle",this.colorKey),u.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(u){return s.Text.prototype.setText.call(this,u)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(u){const _=this.dummyCanvas.getContext("2d");_.save(),_.font=this._getContextFont();const S=_.measureText(u);return _.restore(),{width:S.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:u,height:m}=this._getTextSize(this.attrs.text);if(this.textWidth=u,this.textHeight=m,this.glyphInfo=[],!this.attrs.data)return null;const _=this.letterSpacing(),S=this.align(),C=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*_,0);let d=0;S==="center"&&(d=Math.max(0,this.pathLength/2-g/2)),S==="right"&&(d=Math.max(0,this.pathLength-g));const y=(0,s.stringToArray)(this.text());let b=d;for(let k=0;k<y.length;k++){const D=this._getPointAtLength(b);if(!D)return;let x=this._getTextSize(y[k]).width+_;if(y[k]===" "&&S==="justify"){const V=this.text().split(" ").length-1;x+=(this.pathLength-g)/V}const w=this._getPointAtLength(b+x);if(!w)return;const T=i.Path.getLineLength(D.x,D.y,w.x,w.y);let M=0;if(C)try{M=C(y[k-1],y[k])*this.fontSize()}catch{M=0}D.x+=M,w.x+=M,this.textWidth+=M;const L=i.Path.getPointOnLine(M+T/2,D.x,D.y,w.x,w.y),I=Math.atan2(w.y-D.y,w.x-D.x);this.glyphInfo.push({transposeX:L.x,transposeY:L.y,text:y[k],rotation:I,p0:D,p1:w}),b+=x}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const u=[];this.glyphInfo.forEach(function(b){u.push(b.p0.x),u.push(b.p0.y),u.push(b.p1.x),u.push(b.p1.y)});let m=u[0]||0,_=u[0]||0,S=u[1]||0,C=u[1]||0,g,d;for(let b=0;b<u.length/2;b++)g=u[b*2],d=u[b*2+1],m=Math.min(m,g),_=Math.max(_,g),S=Math.min(S,d),C=Math.max(C,d);const y=this.fontSize();return{x:m-y/2,y:S-y/2,width:_-m+y,height:C-S+y}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Xn.TextPath=p,p.prototype._fillFunc=c,p.prototype._strokeFunc=h,p.prototype._fillFuncHit=c,p.prototype._strokeFuncHit=h,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(p),e.Factory.addGetterSetter(p,"data"),e.Factory.addGetterSetter(p,"fontFamily","Arial"),e.Factory.addGetterSetter(p,"fontSize",12,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(p,"fontStyle",l),e.Factory.addGetterSetter(p,"align","left"),e.Factory.addGetterSetter(p,"letterSpacing",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(p,"textBaseline","middle"),e.Factory.addGetterSetter(p,"fontVariant",l),e.Factory.addGetterSetter(p,"text",a),e.Factory.addGetterSetter(p,"textDecoration",""),e.Factory.addGetterSetter(p,"kerningFunc",void 0),Xn}var Jn={},Rl;function zu(){if(Rl)return Jn;Rl=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.Transformer=void 0;const t=Ft(),e=_t(),n=Dt(),i=Gt(),s=Sl(),r=gs(),o=yt(),a=bt(),l=yt(),c="tr-konva",h=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(x=>x+`.${c}`).join(" "),p="nodesRect",f=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],u={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},m="ontouchstart"in o.Konva._global;function _(x,w,T){if(x==="rotater")return T;w+=t.Util.degToRad(u[x]||0);const M=(t.Util.radToDeg(w)%360+360)%360;return t.Util._inRange(M,337.5,360)||t.Util._inRange(M,0,22.5)?"ns-resize":t.Util._inRange(M,22.5,67.5)?"nesw-resize":t.Util._inRange(M,67.5,112.5)?"ew-resize":t.Util._inRange(M,112.5,157.5)?"nwse-resize":t.Util._inRange(M,157.5,202.5)?"ns-resize":t.Util._inRange(M,202.5,247.5)?"nesw-resize":t.Util._inRange(M,247.5,292.5)?"ew-resize":t.Util._inRange(M,292.5,337.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+M),"pointer")}const S=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function C(x){return{x:x.x+x.width/2*Math.cos(x.rotation)+x.height/2*Math.sin(-x.rotation),y:x.y+x.height/2*Math.cos(x.rotation)+x.width/2*Math.sin(x.rotation)}}function g(x,w,T){const M=T.x+(x.x-T.x)*Math.cos(w)-(x.y-T.y)*Math.sin(w),L=T.y+(x.x-T.x)*Math.sin(w)+(x.y-T.y)*Math.cos(w);return{...x,rotation:x.rotation+w,x:M,y:L}}function d(x,w){const T=C(x);return g(x,w,T)}function y(x,w,T){let M=w;for(let L=0;L<x.length;L++){const I=o.Konva.getAngle(x[L]),V=Math.abs(I-w)%(Math.PI*2);Math.min(V,Math.PI*2-V)<T&&(M=I)}return M}let b=0,k=class extends r.Group{constructor(w){super(w),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(h,this.update),this.getNode()&&this.update()}attachTo(w){return this.setNode(w),this}setNode(w){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([w])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(w=[]){this._nodes&&this._nodes.length&&this.detach();const T=w.filter(L=>L.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=w=T,w.length===1&&this.useSingleNodeRotation()?this.rotation(w[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(L=>{const I=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(L._attrsAffectingSize.length){const V=L._attrsAffectingSize.map(G=>G+"Change."+this._getEventNamespace()).join(" ");L.on(V,I)}L.on(f.map(V=>V+`.${this._getEventNamespace()}`).join(" "),I),L.on(`absoluteTransformChange.${this._getEventNamespace()}`,I),this._proxyDrag(L)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(w){let T;w.on(`dragstart.${this._getEventNamespace()}`,M=>{T=w.getAbsolutePosition(),!this.isDragging()&&w!==this.findOne(".back")&&this.startDrag(M,!1)}),w.on(`dragmove.${this._getEventNamespace()}`,M=>{if(!T)return;const L=w.getAbsolutePosition(),I=L.x-T.x,V=L.y-T.y;this.nodes().forEach(G=>{if(G===w||G.isDragging())return;const X=G.getAbsolutePosition();G.setAbsolutePosition({x:X.x+I,y:X.y+V}),G.startDrag(M)}),T=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(w=>{w.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(w,T=this.rotation(),M){const L=w.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),I=w.getAbsoluteScale(M),V=w.getAbsolutePosition(M),G=L.x*I.x-w.offsetX()*I.x,X=L.y*I.y-w.offsetY()*I.y,v=(o.Konva.getAngle(w.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),P={x:V.x+G*Math.cos(v)+X*Math.sin(-v),y:V.y+X*Math.cos(v)+G*Math.sin(v),width:L.width*I.x,height:L.height*I.y,rotation:v};return g(P,-o.Konva.getAngle(T),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const T=[];this.nodes().map(v=>{const P=v.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),E=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}],R=v.getAbsoluteTransform();E.forEach(function(O){const j=R.point(O);T.push(j)})});const M=new t.Transform;M.rotate(-o.Konva.getAngle(this.rotation()));let L=1/0,I=1/0,V=-1/0,G=-1/0;T.forEach(function(v){const P=M.point(v);L===void 0&&(L=V=P.x,I=G=P.y),L=Math.min(L,P.x),I=Math.min(I,P.y),V=Math.max(V,P.x),G=Math.max(G,P.y)}),M.invert();const X=M.point({x:L,y:I});return{x:X.x,y:X.y,width:V-L,height:G-I,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S.forEach(w=>{this._createAnchor(w)}),this._createAnchor("rotater")}_createAnchor(w){const T=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:w+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:m?10:"auto"}),M=this;T.on("mousedown touchstart",function(L){M._handleMouseDown(L)}),T.on("dragstart",L=>{T.stopDrag(),L.cancelBubble=!0}),T.on("dragend",L=>{L.cancelBubble=!0}),T.on("mouseenter",()=>{const L=o.Konva.getAngle(this.rotation()),I=this.rotateAnchorCursor(),V=_(w,L,I);T.getStage().content&&(T.getStage().content.style.cursor=V),this._cursorChange=!0}),T.on("mouseout",()=>{T.getStage().content&&(T.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(T)}_createBack(){const w=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(T,M){const L=M.getParent(),I=L.padding();T.beginPath(),T.rect(-I,-I,M.width()+I*2,M.height()+I*2),T.moveTo(M.width()/2,-I),L.rotateEnabled()&&L.rotateLineVisible()&&T.lineTo(M.width()/2,-L.rotateAnchorOffset()*t.Util._sign(M.height())-I),T.fillStrokeShape(M)},hitFunc:(T,M)=>{if(!this.shouldOverdrawWholeArea())return;const L=this.padding();T.beginPath(),T.rect(-L,-L,M.width()+L*2,M.height()+L*2),T.fillStrokeShape(M)}});this.add(w),this._proxyDrag(w),w.on("dragstart",T=>{T.cancelBubble=!0}),w.on("dragmove",T=>{T.cancelBubble=!0}),w.on("dragend",T=>{T.cancelBubble=!0}),this.on("dragmove",T=>{this.update()})}_handleMouseDown(w){if(this._transforming)return;this._movingAnchorName=w.target.name().split(" ")[0];const T=this._getNodeRect(),M=T.width,L=T.height,I=Math.sqrt(Math.pow(M,2)+Math.pow(L,2));this.sin=Math.abs(L/I),this.cos=Math.abs(M/I),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const V=w.target.getAbsolutePosition(),G=w.target.getStage().getPointerPosition();this._anchorDragOffset={x:G.x-V.x,y:G.y-V.y},b++,this._fire("transformstart",{evt:w.evt,target:this.getNode()}),this._nodes.forEach(X=>{X._fire("transformstart",{evt:w.evt,target:X})})}_handleMouseMove(w){let T,M,L;const I=this.findOne("."+this._movingAnchorName),V=I.getStage();V.setPointersPositions(w);const G=V.getPointerPosition();let X={x:G.x-this._anchorDragOffset.x,y:G.y-this._anchorDragOffset.y};const v=I.getAbsolutePosition();this.anchorDragBoundFunc()&&(X=this.anchorDragBoundFunc()(v,X,w)),I.setAbsolutePosition(X);const P=I.getAbsolutePosition();if(v.x===P.x&&v.y===P.y)return;if(this._movingAnchorName==="rotater"){const $=this._getNodeRect();T=I.x()-$.width/2,M=-I.y()+$.height/2;let F=Math.atan2(-M,T)+Math.PI/2;$.height<0&&(F-=Math.PI);const et=o.Konva.getAngle(this.rotation())+F,it=o.Konva.getAngle(this.rotationSnapTolerance()),A=y(this.rotationSnaps(),et,it)-$.rotation,N=d($,A);this._fitNodesInto(N,w);return}const E=this.shiftBehavior();let R;E==="inverted"?R=this.keepRatio()&&!w.shiftKey:E==="none"?R=this.keepRatio():R=this.keepRatio()||w.shiftKey;let O=this.centeredScaling()||w.altKey;if(this._movingAnchorName==="top-left"){if(R){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};L=Math.sqrt(Math.pow($.x-I.x(),2)+Math.pow($.y-I.y(),2));const F=this.findOne(".top-left").x()>$.x?-1:1,W=this.findOne(".top-left").y()>$.y?-1:1;T=L*this.cos*F,M=L*this.sin*W,this.findOne(".top-left").x($.x-T),this.findOne(".top-left").y($.y-M)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(I.y());else if(this._movingAnchorName==="top-right"){if(R){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};L=Math.sqrt(Math.pow(I.x()-$.x,2)+Math.pow($.y-I.y(),2));const F=this.findOne(".top-right").x()<$.x?-1:1,W=this.findOne(".top-right").y()>$.y?-1:1;T=L*this.cos*F,M=L*this.sin*W,this.findOne(".top-right").x($.x+T),this.findOne(".top-right").y($.y-M)}var j=I.position();this.findOne(".top-left").y(j.y),this.findOne(".bottom-right").x(j.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(I.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(I.x());else if(this._movingAnchorName==="bottom-left"){if(R){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};L=Math.sqrt(Math.pow($.x-I.x(),2)+Math.pow(I.y()-$.y,2));const F=$.x<I.x()?-1:1,W=I.y()<$.y?-1:1;T=L*this.cos*F,M=L*this.sin*W,I.x($.x-T),I.y($.y+M)}j=I.position(),this.findOne(".top-left").x(j.x),this.findOne(".bottom-right").y(j.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(I.y());else if(this._movingAnchorName==="bottom-right"){if(R){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};L=Math.sqrt(Math.pow(I.x()-$.x,2)+Math.pow(I.y()-$.y,2));const F=this.findOne(".bottom-right").x()<$.x?-1:1,W=this.findOne(".bottom-right").y()<$.y?-1:1;T=L*this.cos*F,M=L*this.sin*W,this.findOne(".bottom-right").x($.x+T),this.findOne(".bottom-right").y($.y+M)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(O=this.centeredScaling()||w.altKey,O){const $=this.findOne(".top-left"),F=this.findOne(".bottom-right"),W=$.x(),et=$.y(),it=this.getWidth()-F.x(),ht=this.getHeight()-F.y();F.move({x:-W,y:-et}),$.move({x:it,y:ht})}const H=this.findOne(".top-left").getAbsolutePosition();T=H.x,M=H.y;const J=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),st=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:T,y:M,width:J,height:st,rotation:o.Konva.getAngle(this.rotation())},w)}_handleMouseUp(w){this._removeEvents(w)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(w){var T;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const M=this.getNode();b--,this._fire("transformend",{evt:w,target:M}),(T=this.getLayer())===null||T===void 0||T.batchDraw(),M&&this._nodes.forEach(L=>{var I;L._fire("transformend",{evt:w,target:L}),(I=L.getLayer())===null||I===void 0||I.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(w,T){const M=this._getNodeRect(),L=1;if(t.Util._inRange(w.width,-this.padding()*2-L,L)){this.update();return}if(t.Util._inRange(w.height,-this.padding()*2-L,L)){this.update();return}const I=new t.Transform;if(I.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&w.width<0&&this._movingAnchorName.indexOf("left")>=0){const R=I.point({x:-this.padding()*2,y:0});w.x+=R.x,w.y+=R.y,w.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y}else if(this._movingAnchorName&&w.width<0&&this._movingAnchorName.indexOf("right")>=0){const R=I.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,w.width+=this.padding()*2}if(this._movingAnchorName&&w.height<0&&this._movingAnchorName.indexOf("top")>=0){const R=I.point({x:0,y:-this.padding()*2});w.x+=R.x,w.y+=R.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,w.height+=this.padding()*2}else if(this._movingAnchorName&&w.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const R=I.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,w.height+=this.padding()*2}if(this.boundBoxFunc()){const R=this.boundBoxFunc()(M,w);R?w=R:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const V=1e7,G=new t.Transform;G.translate(M.x,M.y),G.rotate(M.rotation),G.scale(M.width/V,M.height/V);const X=new t.Transform,v=w.width/V,P=w.height/V;this.flipEnabled()===!1?(X.translate(w.x,w.y),X.rotate(w.rotation),X.translate(w.width<0?w.width:0,w.height<0?w.height:0),X.scale(Math.abs(v),Math.abs(P))):(X.translate(w.x,w.y),X.rotate(w.rotation),X.scale(v,P));const E=X.multiply(G.invert());this._nodes.forEach(R=>{var O;const j=R.getParent().getAbsoluteTransform(),H=R.getTransform().copy();H.translate(R.offsetX(),R.offsetY());const J=new t.Transform;J.multiply(j.copy().invert()).multiply(E).multiply(j).multiply(H);const st=J.decompose();R.setAttrs(st),(O=R.getLayer())===null||O===void 0||O.batchDraw()}),this.rotation(t.Util._getRotation(w.rotation)),this._nodes.forEach(R=>{this._fire("transform",{evt:T,target:R}),R._fire("transform",{evt:T,target:R})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(w,T){this.findOne(w).setAttrs(T)}update(){var w;const T=this._getNodeRect();this.rotation(t.Util._getRotation(T.rotation));const M=T.width,L=T.height,I=this.enabledAnchors(),V=this.resizeEnabled(),G=this.padding(),X=this.anchorSize(),v=this.find("._anchor");v.forEach(E=>{E.setAttrs({width:X,height:X,offsetX:X/2,offsetY:X/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:X/2+G,offsetY:X/2+G,visible:V&&I.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:M/2,y:0,offsetY:X/2+G,visible:V&&I.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:M,y:0,offsetX:X/2-G,offsetY:X/2+G,visible:V&&I.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:L/2,offsetX:X/2+G,visible:V&&I.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:M,y:L/2,offsetX:X/2-G,visible:V&&I.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:L,offsetX:X/2+G,offsetY:X/2-G,visible:V&&I.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:M/2,y:L,offsetY:X/2-G,visible:V&&I.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:M,y:L,offsetX:X/2-G,offsetY:X/2-G,visible:V&&I.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:M/2,y:-this.rotateAnchorOffset()*t.Util._sign(L)-G,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:M,height:L,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const P=this.anchorStyleFunc();P&&v.forEach(E=>{P(E)}),(w=this.getLayer())===null||w===void 0||w.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const w=this.findOne("."+this._movingAnchorName);w&&w.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),r.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(w){return n.Node.prototype.clone.call(this,w)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Jn.Transformer=k,k.isTransforming=()=>b>0;function D(x){return x instanceof Array||t.Util.warn("enabledAnchors value should be an array"),x instanceof Array&&x.forEach(function(w){S.indexOf(w)===-1&&t.Util.warn("Unknown anchor name: "+w+". Available names are: "+S.join(", "))}),x||[]}return k.prototype.className="Transformer",(0,l._registerNode)(k),e.Factory.addGetterSetter(k,"enabledAnchors",S,D),e.Factory.addGetterSetter(k,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(k,"resizeEnabled",!0),e.Factory.addGetterSetter(k,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateEnabled",!0),e.Factory.addGetterSetter(k,"rotateLineVisible",!0),e.Factory.addGetterSetter(k,"rotationSnaps",[]),e.Factory.addGetterSetter(k,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(k,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderEnabled",!0),e.Factory.addGetterSetter(k,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"anchorFill","white"),e.Factory.addGetterSetter(k,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderDash"),e.Factory.addGetterSetter(k,"keepRatio",!0),e.Factory.addGetterSetter(k,"shiftBehavior","default"),e.Factory.addGetterSetter(k,"centeredScaling",!1),e.Factory.addGetterSetter(k,"ignoreStroke",!1),e.Factory.addGetterSetter(k,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"nodes"),e.Factory.addGetterSetter(k,"node"),e.Factory.addGetterSetter(k,"boundBoxFunc"),e.Factory.addGetterSetter(k,"anchorDragBoundFunc"),e.Factory.addGetterSetter(k,"anchorStyleFunc"),e.Factory.addGetterSetter(k,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(k,"useSingleNodeRotation",!0),e.Factory.backCompat(k,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Jn}var Qn={},El;function Wu(){if(El)return Qn;El=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.Wedge=void 0;const t=_t(),e=Gt(),n=yt(),i=bt(),s=yt();let r=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return Qn.Wedge=r,r.prototype.className="Wedge",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clockwise",!1),t.Factory.backCompat(r,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Qn}var Zn={},Ml;function $u(){if(Ml)return Zn;Ml=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.Blur=void 0;const t=_t(),e=Dt(),n=bt();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],r=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(l,c){const h=l.data,p=l.width,f=l.height;let u,m,_,S,C,g,d,y,b,k,D,x,w,T,M,L,I,V,G,X;const v=c+c+1,P=p-1,E=f-1,R=c+1,O=R*(R+1)/2,j=new i,H=s[c],J=r[c];let st=null,$=j,F=null,W=null;for(let et=1;et<v;et++)$=$.next=new i,et===R&&(st=$);$.next=j,_=m=0;for(let et=0;et<f;et++){x=w=T=M=S=C=g=d=0,y=R*(L=h[m]),b=R*(I=h[m+1]),k=R*(V=h[m+2]),D=R*(G=h[m+3]),S+=O*L,C+=O*I,g+=O*V,d+=O*G,$=j;for(let it=0;it<R;it++)$.r=L,$.g=I,$.b=V,$.a=G,$=$.next;for(let it=1;it<R;it++)u=m+((P<it?P:it)<<2),S+=($.r=L=h[u])*(X=R-it),C+=($.g=I=h[u+1])*X,g+=($.b=V=h[u+2])*X,d+=($.a=G=h[u+3])*X,x+=L,w+=I,T+=V,M+=G,$=$.next;F=j,W=st;for(let it=0;it<p;it++)h[m+3]=G=d*H>>J,G!==0?(G=255/G,h[m]=(S*H>>J)*G,h[m+1]=(C*H>>J)*G,h[m+2]=(g*H>>J)*G):h[m]=h[m+1]=h[m+2]=0,S-=y,C-=b,g-=k,d-=D,y-=F.r,b-=F.g,k-=F.b,D-=F.a,u=_+((u=it+c+1)<P?u:P)<<2,x+=F.r=h[u],w+=F.g=h[u+1],T+=F.b=h[u+2],M+=F.a=h[u+3],S+=x,C+=w,g+=T,d+=M,F=F.next,y+=L=W.r,b+=I=W.g,k+=V=W.b,D+=G=W.a,x-=L,w-=I,T-=V,M-=G,W=W.next,m+=4;_+=p}for(let et=0;et<p;et++){w=T=M=x=C=g=d=S=0,m=et<<2,y=R*(L=h[m]),b=R*(I=h[m+1]),k=R*(V=h[m+2]),D=R*(G=h[m+3]),S+=O*L,C+=O*I,g+=O*V,d+=O*G,$=j;for(let ht=0;ht<R;ht++)$.r=L,$.g=I,$.b=V,$.a=G,$=$.next;let it=p;for(let ht=1;ht<=c;ht++)m=it+et<<2,S+=($.r=L=h[m])*(X=R-ht),C+=($.g=I=h[m+1])*X,g+=($.b=V=h[m+2])*X,d+=($.a=G=h[m+3])*X,x+=L,w+=I,T+=V,M+=G,$=$.next,ht<E&&(it+=p);m=et,F=j,W=st;for(let ht=0;ht<f;ht++)u=m<<2,h[u+3]=G=d*H>>J,G>0?(G=255/G,h[u]=(S*H>>J)*G,h[u+1]=(C*H>>J)*G,h[u+2]=(g*H>>J)*G):h[u]=h[u+1]=h[u+2]=0,S-=y,C-=b,g-=k,d-=D,y-=F.r,b-=F.g,k-=F.b,D-=F.a,u=et+((u=ht+R)<E?u:E)*p<<2,S+=x+=F.r=h[u],C+=w+=F.g=h[u+1],g+=T+=F.b=h[u+2],d+=M+=F.a=h[u+3],F=F.next,y+=L=W.r,b+=I=W.g,k+=V=W.b,D+=G=W.a,x-=L,w-=I,T-=V,M-=G,W=W.next,m+=p}}const a=function(c){const h=Math.round(this.blurRadius());h>0&&o(c,h)};return Zn.Blur=a,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Zn}var ti={},Fl;function ju(){if(Fl)return ti;Fl=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.Brighten=void 0;const t=_t(),e=Dt(),n=bt(),i=function(s){const r=this.brightness()*255,o=s.data,a=o.length;for(let l=0;l<a;l+=4)o[l]+=r,o[l+1]+=r,o[l+2]+=r};return ti.Brighten=i,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ti}var ei={},Dl;function qu(){if(Dl)return ei;Dl=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.Contrast=void 0;const t=_t(),e=Dt(),n=bt(),i=function(s){const r=Math.pow((this.contrast()+100)/100,2),o=s.data,a=o.length;let l=150,c=150,h=150;for(let p=0;p<a;p+=4)l=o[p],c=o[p+1],h=o[p+2],l/=255,l-=.5,l*=r,l+=.5,l*=255,c/=255,c-=.5,c*=r,c+=.5,c*=255,h/=255,h-=.5,h*=r,h+=.5,h*=255,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,h=h<0?0:h>255?255:h,o[p]=l,o[p+1]=c,o[p+2]=h};return ei.Contrast=i,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ei}var ni={},Nl;function Ku(){if(Nl)return ni;Nl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.Emboss=void 0;const t=_t(),e=Dt(),n=Ft(),i=bt(),s=function(r){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),c=this.embossBlend(),h=r.data,p=r.width,f=r.height,u=p*4;let m=0,_=0,S=f;switch(l){case"top-left":m=-1,_=-1;break;case"top":m=-1,_=0;break;case"top-right":m=-1,_=1;break;case"right":m=0,_=1;break;case"bottom-right":m=1,_=1;break;case"bottom":m=1,_=0;break;case"bottom-left":m=1,_=-1;break;case"left":m=0,_=-1;break;default:n.Util.error("Unknown emboss direction: "+l)}do{const C=(S-1)*u;let g=m;S+g<1&&(g=0),S+g>f&&(g=0);const d=(S-1+g)*p*4;let y=p;do{const b=C+(y-1)*4;let k=_;y+k<1&&(k=0),y+k>p&&(k=0);const D=d+(y-1+k)*4,x=h[b]-h[D],w=h[b+1]-h[D+1],T=h[b+2]-h[D+2];let M=x;const L=M>0?M:-M,I=w>0?w:-w,V=T>0?T:-T;if(I>L&&(M=w),V>L&&(M=T),M*=o,c){const G=h[b]+M,X=h[b+1]+M,v=h[b+2]+M;h[b]=G>255?255:G<0?0:G,h[b+1]=X>255?255:X<0?0:X,h[b+2]=v>255?255:v<0?0:v}else{let G=a-M;G<0?G=0:G>255&&(G=255),h[b]=h[b+1]=h[b+2]=G}}while(--y)}while(--S)};return ni.Emboss=s,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),ni}var ii={},Ol;function Yu(){if(Ol)return ii;Ol=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.Enhance=void 0;const t=_t(),e=Dt(),n=bt();function i(r,o,a,l,c){const h=a-o,p=c-l;if(h===0)return l+p/2;if(p===0)return l;let f=(r-o)/h;return f=p*f+l,f}const s=function(r){const o=r.data,a=o.length;let l=o[0],c=l,h,p=o[1],f=p,u,m=o[2],_=m,S;const C=this.enhance();if(C===0)return;for(let x=0;x<a;x+=4)h=o[x+0],h<l?l=h:h>c&&(c=h),u=o[x+1],u<p?p=u:u>f&&(f=u),S=o[x+2],S<m?m=S:S>_&&(_=S);c===l&&(c=255,l=0),f===p&&(f=255,p=0),_===m&&(_=255,m=0);let g,d,y,b,k,D;if(C>0)g=c+C*(255-c),d=l-C*(l-0),y=f+C*(255-f),b=p-C*(p-0),k=_+C*(255-_),D=m-C*(m-0);else{const x=(c+l)*.5;g=c+C*(c-x),d=l+C*(l-x);const w=(f+p)*.5;y=f+C*(f-w),b=p+C*(p-w);const T=(_+m)*.5;k=_+C*(_-T),D=m+C*(m-T)}for(let x=0;x<a;x+=4)o[x+0]=i(o[x+0],l,c,d,g),o[x+1]=i(o[x+1],p,f,b,y),o[x+2]=i(o[x+2],m,_,D,k)};return ii.Enhance=s,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ii}var ri={},Ll;function Xu(){if(Ll)return ri;Ll=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.Grayscale=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4){const r=.34*n[s]+.5*n[s+1]+.16*n[s+2];n[s]=r,n[s+1]=r,n[s+2]=r}};return ri.Grayscale=t,ri}var si={},Gl;function Ju(){if(Gl)return si;Gl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.HSL=void 0;const t=_t(),e=Dt(),n=bt();t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter);const i=function(s){const r=s.data,o=r.length,a=1,l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=this.luminance()*127,p=a*l*Math.cos(c*Math.PI/180),f=a*l*Math.sin(c*Math.PI/180),u=.299*a+.701*p+.167*f,m=.587*a-.587*p+.33*f,_=.114*a-.114*p-.497*f,S=.299*a-.299*p-.328*f,C=.587*a+.413*p+.035*f,g=.114*a-.114*p+.293*f,d=.299*a-.3*p+1.25*f,y=.587*a-.586*p-1.05*f,b=.114*a+.886*p-.2*f;let k,D,x,w;for(let T=0;T<o;T+=4)k=r[T+0],D=r[T+1],x=r[T+2],w=r[T+3],r[T+0]=u*k+m*D+_*x+h,r[T+1]=S*k+C*D+g*x+h,r[T+2]=d*k+y*D+b*x+h,r[T+3]=w};return si.HSL=i,si}var oi={},Il;function Qu(){if(Il)return oi;Il=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.HSV=void 0;const t=_t(),e=Dt(),n=bt(),i=function(s){const r=s.data,o=r.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=a*l*Math.cos(c*Math.PI/180),p=a*l*Math.sin(c*Math.PI/180),f=.299*a+.701*h+.167*p,u=.587*a-.587*h+.33*p,m=.114*a-.114*h-.497*p,_=.299*a-.299*h-.328*p,S=.587*a+.413*h+.035*p,C=.114*a-.114*h+.293*p,g=.299*a-.3*h+1.25*p,d=.587*a-.586*h-1.05*p,y=.114*a+.886*h-.2*p;for(let b=0;b<o;b+=4){const k=r[b+0],D=r[b+1],x=r[b+2],w=r[b+3];r[b+0]=f*k+u*D+m*x,r[b+1]=_*k+S*D+C*x,r[b+2]=g*k+d*D+y*x,r[b+3]=w}};return oi.HSV=i,t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),oi}var ai={},Ul;function Zu(){if(Ul)return ai;Ul=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.Invert=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4)n[s]=255-n[s],n[s+1]=255-n[s+1],n[s+2]=255-n[s+2]};return ai.Invert=t,ai}var li={},Bl;function tf(){if(Bl)return li;Bl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Kaleidoscope=void 0;const t=_t(),e=Dt(),n=Ft(),i=bt(),s=function(a,l,c){const h=a.data,p=l.data,f=a.width,u=a.height,m=c.polarCenterX||f/2,_=c.polarCenterY||u/2;let S=Math.sqrt(m*m+_*_),C=f-m,g=u-_;const d=Math.sqrt(C*C+g*g);S=d>S?d:S;const y=u,b=f,k=360/b*Math.PI/180;for(let D=0;D<b;D+=1){const x=Math.sin(D*k),w=Math.cos(D*k);for(let T=0;T<y;T+=1){C=Math.floor(m+S*T/y*w),g=Math.floor(_+S*T/y*x);let M=(g*f+C)*4;const L=h[M+0],I=h[M+1],V=h[M+2],G=h[M+3];M=(D+T*f)*4,p[M+0]=L,p[M+1]=I,p[M+2]=V,p[M+3]=G}}},r=function(a,l,c){const h=a.data,p=l.data,f=a.width,u=a.height,m=c.polarCenterX||f/2,_=c.polarCenterY||u/2;let S=Math.sqrt(m*m+_*_),C=f-m,g=u-_;const d=Math.sqrt(C*C+g*g);S=d>S?d:S;const y=u,b=f,k=0;let D,x;for(C=0;C<f;C+=1)for(g=0;g<u;g+=1){const w=C-m,T=g-_,M=Math.sqrt(w*w+T*T)*y/S;let L=(Math.atan2(T,w)*180/Math.PI+360+k)%360;L=L*b/360,D=Math.floor(L),x=Math.floor(M);let I=(x*f+D)*4;const V=h[I+0],G=h[I+1],X=h[I+2],v=h[I+3];I=(g*f+C)*4,p[I+0]=V,p[I+1]=G,p[I+2]=X,p[I+3]=v}},o=function(a){const l=a.width,c=a.height;let h,p,f,u,m,_,S,C,g,d,y=Math.round(this.kaleidoscopePower());const b=Math.round(this.kaleidoscopeAngle()),k=Math.floor(l*(b%360)/360);if(y<1)return;const D=n.Util.createCanvasElement();D.width=l,D.height=c;const x=D.getContext("2d").getImageData(0,0,l,c);n.Util.releaseCanvas(D),s(a,x,{polarCenterX:l/2,polarCenterY:c/2});let w=l/Math.pow(2,y);for(;w<=8;)w=w*2,y-=1;w=Math.ceil(w);let T=w,M=0,L=T,I=1;for(k+w>l&&(M=T,L=0,I=-1),p=0;p<c;p+=1)for(h=M;h!==L;h+=I)f=Math.round(h+k)%l,g=(l*p+f)*4,m=x.data[g+0],_=x.data[g+1],S=x.data[g+2],C=x.data[g+3],d=(l*p+h)*4,x.data[d+0]=m,x.data[d+1]=_,x.data[d+2]=S,x.data[d+3]=C;for(p=0;p<c;p+=1)for(T=Math.floor(w),u=0;u<y;u+=1){for(h=0;h<T+1;h+=1)g=(l*p+h)*4,m=x.data[g+0],_=x.data[g+1],S=x.data[g+2],C=x.data[g+3],d=(l*p+T*2-h-1)*4,x.data[d+0]=m,x.data[d+1]=_,x.data[d+2]=S,x.data[d+3]=C;T*=2}r(x,a,{})};return li.Kaleidoscope=o,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),li}var ci={},Hl;function ef(){if(Hl)return ci;Hl=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.Mask=void 0;const t=_t(),e=Dt(),n=bt();function i(f,u,m){let _=(m*f.width+u)*4;const S=[];return S.push(f.data[_++],f.data[_++],f.data[_++],f.data[_++]),S}function s(f,u){return Math.sqrt(Math.pow(f[0]-u[0],2)+Math.pow(f[1]-u[1],2)+Math.pow(f[2]-u[2],2))}function r(f){const u=[0,0,0];for(let m=0;m<f.length;m++)u[0]+=f[m][0],u[1]+=f[m][1],u[2]+=f[m][2];return u[0]/=f.length,u[1]/=f.length,u[2]/=f.length,u}function o(f,u){const m=i(f,0,0),_=i(f,f.width-1,0),S=i(f,0,f.height-1),C=i(f,f.width-1,f.height-1),g=u||10;if(s(m,_)<g&&s(_,C)<g&&s(C,S)<g&&s(S,m)<g){const d=r([_,m,C,S]),y=[];for(let b=0;b<f.width*f.height;b++){const k=s(d,[f.data[b*4],f.data[b*4+1],f.data[b*4+2]]);y[b]=k<g?0:255}return y}}function a(f,u){for(let m=0;m<f.width*f.height;m++)f.data[4*m+3]=u[m]}function l(f,u,m){const _=[1,1,1,1,0,1,1,1,1],S=Math.round(Math.sqrt(_.length)),C=Math.floor(S/2),g=[];for(let d=0;d<m;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const w=d+D-C,T=y+x-C;if(w>=0&&w<m&&T>=0&&T<u){const M=w*u+T,L=_[D*S+x];k+=f[M]*L}}g[b]=k===2040?255:0}return g}function c(f,u,m){const _=[1,1,1,1,1,1,1,1,1],S=Math.round(Math.sqrt(_.length)),C=Math.floor(S/2),g=[];for(let d=0;d<m;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const w=d+D-C,T=y+x-C;if(w>=0&&w<m&&T>=0&&T<u){const M=w*u+T,L=_[D*S+x];k+=f[M]*L}}g[b]=k>=1020?255:0}return g}function h(f,u,m){const _=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],S=Math.round(Math.sqrt(_.length)),C=Math.floor(S/2),g=[];for(let d=0;d<m;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const w=d+D-C,T=y+x-C;if(w>=0&&w<m&&T>=0&&T<u){const M=w*u+T,L=_[D*S+x];k+=f[M]*L}}g[b]=k}return g}const p=function(f){const u=this.threshold();let m=o(f,u);return m&&(m=l(m,f.width,f.height),m=c(m,f.width,f.height),m=h(m,f.width,f.height),a(f,m)),f};return ci.Mask=p,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ci}var hi={},Vl;function nf(){if(Vl)return hi;Vl=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Noise=void 0;const t=_t(),e=Dt(),n=bt(),i=function(s){const r=this.noise()*255,o=s.data,a=o.length,l=r/2;for(let c=0;c<a;c+=4)o[c+0]+=l-2*l*Math.random(),o[c+1]+=l-2*l*Math.random(),o[c+2]+=l-2*l*Math.random()};return hi.Noise=i,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),hi}var di={},zl;function rf(){if(zl)return di;zl=1,Object.defineProperty(di,"__esModule",{value:!0}),di.Pixelate=void 0;const t=_t(),e=Ft(),n=Dt(),i=bt(),s=function(r){let o=Math.ceil(this.pixelSize()),a=r.width,l=r.height,c=Math.ceil(a/o),h=Math.ceil(l/o),p=r.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let f=0;f<c;f+=1)for(let u=0;u<h;u+=1){let m=0,_=0,S=0,C=0;const g=f*o,d=g+o,y=u*o,b=y+o;let k=0;for(let D=g;D<d;D+=1)if(!(D>=a))for(let x=y;x<b;x+=1){if(x>=l)continue;const w=(a*x+D)*4;m+=p[w+0],_+=p[w+1],S+=p[w+2],C+=p[w+3],k+=1}m=m/k,_=_/k,S=S/k,C=C/k;for(let D=g;D<d;D+=1)if(!(D>=a))for(let x=y;x<b;x+=1){if(x>=l)continue;const w=(a*x+D)*4;p[w+0]=m,p[w+1]=_,p[w+2]=S,p[w+3]=C}}};return di.Pixelate=s,t.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),di}var ui={},Wl;function sf(){if(Wl)return ui;Wl=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Posterize=void 0;const t=_t(),e=Dt(),n=bt(),i=function(s){const r=Math.round(this.levels()*254)+1,o=s.data,a=o.length,l=255/r;for(let c=0;c<a;c+=1)o[c]=Math.floor(o[c]/l)*l};return ui.Posterize=i,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ui}var fi={},$l;function of(){if($l)return fi;$l=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.RGB=void 0;const t=_t(),e=Dt(),n=bt(),i=function(s){const r=s.data,o=r.length,a=this.red(),l=this.green(),c=this.blue();for(let h=0;h<o;h+=4){const p=(.34*r[h]+.5*r[h+1]+.16*r[h+2])/255;r[h]=p*a,r[h+1]=p*l,r[h+2]=p*c,r[h+3]=r[h+3]}};return fi.RGB=i,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),fi}var gi={},jl;function af(){if(jl)return gi;jl=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.RGBA=void 0;const t=_t(),e=Dt(),n=bt(),i=function(s){const r=s.data,o=r.length,a=this.red(),l=this.green(),c=this.blue(),h=this.alpha();for(let p=0;p<o;p+=4){const f=1-h;r[p]=a*h+r[p]*f,r[p+1]=l*h+r[p+1]*f,r[p+2]=c*h+r[p+2]*f}};return gi.RGBA=i,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),gi}var pi={},ql;function lf(){if(ql)return pi;ql=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Sepia=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4){const r=n[s+0],o=n[s+1],a=n[s+2];n[s+0]=Math.min(255,r*.393+o*.769+a*.189),n[s+1]=Math.min(255,r*.349+o*.686+a*.168),n[s+2]=Math.min(255,r*.272+o*.534+a*.131)}};return pi.Sepia=t,pi}var mi={},Kl;function cf(){if(Kl)return mi;Kl=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.Solarize=void 0;const t=function(e){const n=e.data,i=e.width,s=e.height,r=i*4;let o=s;do{const a=(o-1)*r;let l=i;do{const c=a+(l-1)*4;let h=n[c],p=n[c+1],f=n[c+2];h>127&&(h=255-h),p>127&&(p=255-p),f>127&&(f=255-f),n[c]=h,n[c+1]=p,n[c+2]=f}while(--l)}while(--o)};return mi.Solarize=t,mi}var yi={},Yl;function hf(){if(Yl)return yi;Yl=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.Threshold=void 0;const t=_t(),e=Dt(),n=bt(),i=function(s){const r=this.threshold()*255,o=s.data,a=o.length;for(let l=0;l<a;l+=1)o[l]=o[l]<r?0:255};return yi.Threshold=i,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),yi}var Xl;function df(){if(Xl)return Mn;Xl=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.Konva=void 0;const t=Eu(),e=Mu(),n=Du(),i=Nu(),s=Ou(),r=Lu(),o=Gu(),a=ul(),l=_s(),c=Sl(),h=Iu(),p=Uu(),f=Bu(),u=Hu(),m=kl(),_=Vu(),S=zu(),C=Wu(),g=$u(),d=ju(),y=qu(),b=Ku(),k=Yu(),D=Xu(),x=Ju(),w=Qu(),T=Zu(),M=tf(),L=ef(),I=nf(),V=rf(),G=sf(),X=of(),v=af(),P=lf(),E=cf(),R=hf();return Mn.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:s.Ellipse,Image:r.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:l.Path,Rect:c.Rect,RegularPolygon:h.RegularPolygon,Ring:p.Ring,Sprite:f.Sprite,Star:u.Star,Text:m.Text,TextPath:_.TextPath,Transformer:S.Transformer,Wedge:C.Wedge,Filters:{Blur:g.Blur,Brighten:d.Brighten,Contrast:y.Contrast,Emboss:b.Emboss,Enhance:k.Enhance,Grayscale:D.Grayscale,HSL:x.HSL,HSV:w.HSV,Invert:T.Invert,Kaleidoscope:M.Kaleidoscope,Mask:L.Mask,Noise:I.Noise,Pixelate:V.Pixelate,Posterize:G.Posterize,RGB:X.RGB,RGBA:v.RGBA,Sepia:P.Sepia,Solarize:E.Solarize,Threshold:R.Threshold}}),Mn}var uf=or.exports,Jl;function ff(){if(Jl)return or.exports;Jl=1,Object.defineProperty(uf,"__esModule",{value:!0});const t=df();return or.exports=t.Konva,or.exports}var gf=ff();const tt=Tu(gf);class pf{constructor(e,n,i){this.captureState=e,this.restoreState=n,this.onStateChange=i}history=[];historyIndex=-1;inUndoRedo=!1;maxHistorySize=50;executeCommand(e,n){if(this.inUndoRedo){n();return}const i=this.captureState();if(!i)return;n();const s=this.captureState();if(!s||i===s)return;const r={name:e,beforeState:i,afterState:s};this.history.splice(this.historyIndex+1),this.history.push(r),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${e}" added to history. Index: ${this.historyIndex}`)}pushCommand(e,n,i){if(!n||!i||n===i)return;const s={name:e,beforeState:n,afterState:i};this.history.splice(this.historyIndex+1),this.history.push(s),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${e}" pushed. Index: ${this.historyIndex}`)}undo(){if(this.historyIndex<0)return;this.inUndoRedo=!0;const e=this.history[this.historyIndex];console.log(`Undoing command: ${e.name}`),this.restoreState(e.beforeState),this.historyIndex--,this.onStateChange?.(),this.inUndoRedo=!1}redo(){if(this.historyIndex>=this.history.length-1)return;this.inUndoRedo=!0,this.historyIndex++;const e=this.history[this.historyIndex];console.log(`Redoing command: ${e.name}`),this.restoreState(e.afterState),this.onStateChange?.(),this.inUndoRedo=!1}canUndo(){return this.historyIndex>=0}canRedo(){return this.historyIndex<this.history.length-1}}const mf=()=>{const t=Po(new Set),e=new Map,n=Nt(()=>[...t].map(i=>i.konvaNode));return{stage:void 0,konvaContainer:void 0,activeTool:Tt("select"),layers:{selectionOverlay:void 0,transformer:void 0,transformerLayer:void 0},canvasItems:new Map,callbacks:{},keyboardDisposables:[],freehand:{strokes:new Map,strokeGroups:new Map,dragSelectionState:Tt({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,isDrawing:!1,currentPoints:[],currentTimestamps:[],drawingStartTime:0,showGrid:Tt(!1),gridSize:20,selectedStrokesForTimeline:Tt(new Set),timelineDuration:Tt(0),currentPlaybackTime:Tt(0),freehandDrawMode:Tt(!0),useRealTiming:Tt(!1),maxInterStrokeDelay:300,isAnimating:Tt(!1),freehandDragStartState:null,serializedState:"",bakedRenderData:[],bakedGroupMap:{}},polygon:{shapes:new Map,groups:new Map,isDrawing:Tt(!1),currentPoints:Tt([]),mode:Tt("draw"),dragStartState:null,proximityThreshold:10,serializedState:"",bakedRenderData:[]},selection:{items:t,originalStyles:e,selectedKonvaNodes:n,dragSelectionState:Tt({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,selectionDragState:{isDragging:!1,startPos:{x:0,y:0},startNodePositions:new Map,beforeState:""},transformStartState:""},command:{},metadata:{activeNode:Tt(null),metadataText:Tt(""),showEditor:Tt(!1),highlight:{}},ancillary:{activeVisualizations:Tt(new Set),nodeVisualizations:new Map,listenersAttached:!1,rafToken:null,activeWatchStop:void 0}}},Xt=t=>t.freehand.strokes,vs=t=>t.freehand.strokeGroups,ae=t=>t.polygon.shapes,Ke=(t,e,n)=>{if(!t.command.executeCommand){console.warn("executeCommand called before setup - falling back to direct execution"),n();return}t.command.executeCommand(e,n)},cr=(t,e,n,i)=>{if(!t.command.pushCommand){console.warn("pushCommandWithStates called before setup - ignoring");return}t.command.pushCommand(e,n,i)};function yf(t,e,n=!1){n||bs(t),t.selection.items.add(e),xs(t),hr(t)}function _f(t,e,n=!1){t.selection.items.has(e)?t.selection.items.delete(e):(n||bs(t),t.selection.items.add(e)),xs(t),hr(t)}function bs(t){Ss(t),t.selection.items.clear(),hr(t)}function vf(t,e){return t.selection.items.has(e)}function bf(t){return t.selection.items.size===0}function Sf(t){return t.selection.items.size}function xf(t){return t.selection.items.size===1?[...t.selection.items][0].konvaNode:null}function Ss(t){t.selection.originalStyles.forEach(e=>{const n=e.node;n&&(n instanceof tt.Path||n instanceof tt.Line)&&(n.stroke(e.stroke),n.strokeWidth(e.strokeWidth))}),t.selection.originalStyles.clear(),ws(t)}function xs(t){Ss(t);for(const e of t.selection.items){const n=e.konvaNode;(n instanceof tt.Path||n instanceof tt.Line)&&(t.selection.originalStyles.set(e.id,{node:n,stroke:n.stroke(),strokeWidth:n.strokeWidth()}),n.stroke("#ff6b35"),n.strokeWidth(4))}ws(t)}function ws(t){const e=new Set;for(const n of t.selection.items){let i=n.konvaNode.getParent();for(;i&&!(i instanceof tt.Layer);)i=i.getParent();i instanceof tt.Layer&&e.add(i)}t.selection.originalStyles.forEach(n=>{let i=n.node.getParent();for(;i&&!(i instanceof tt.Layer);)i=i.getParent();i instanceof tt.Layer&&e.add(i)}),e.forEach(n=>n.batchDraw())}const Cs=(t,e)=>{const n=t.selection.originalStyles.size>0;n&&Ss(t);try{return e()}finally{t.selection.items.size>0?xs(t):n&&ws(t)}};function hr(t){t.callbacks.syncAppState?.(t),t.callbacks.refreshAncillaryViz?.()}function wf(t,e,n){Ke(t,"Edit Metadata",()=>{e.setMetadata(n),hr(t)})}function dr(t,e,n=!1){yf(t,e,n)}function Cf(t,e,n=!1){_f(t,e,n)}function le(t){bs(t)}function Ql(t,e){return vf(t,e)}function Ps(t){return bf(t)}function cn(t){return Sf(t)}const Pf=t=>xf(t);function Tf(t,e,n){wf(t,e,n)}const _i=(t="id_")=>`${t}${crypto.randomUUID()}`,ur=t=>{let e=1/0,n=-1/0,i=1/0,s=-1/0;for(let r=0;r<t.length;r+=2)e=Math.min(e,t[r]),n=Math.max(n,t[r]),i=Math.min(i,t[r+1]),s=Math.max(s,t[r+1]);return{minX:e,maxX:n,minY:i,maxY:s}},kf=t=>{for(let e=0;e<t.length;e++)for(let n=e+1;n<t.length;n++)if(t[e].isAncestorOf(t[n])||t[n].isAncestorOf(t[e]))return!0;return!1},Zl=(t,e,n)=>{e.id()||e.id(_i("stroke_"));const i={id:e.id(),type:"stroke",konvaNode:e,getBounds(){const s=e.getClientRect();return{minX:s.x,maxX:s.x+s.width,minY:s.y,maxY:s.y+s.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(s){s===void 0||Object.keys(s).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",s)}};return t.canvasItems.set(i.id,i),i},Ts=(t,e)=>{e.id()||e.id(_i("group_"));const n={id:e.id(),type:"strokeGroup",konvaNode:e,getBounds(){const i=e.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",i)}};return t.canvasItems.set(n.id,n),n},ks=(t,e)=>{e.id()||e.id(_i("poly_"));const n={id:e.id(),type:"polygon",konvaNode:e,getBounds(){const i=e.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",i)}};return t.canvasItems.set(n.id,n),n},Af=(t,e)=>t.canvasItems.get(e.id()),Rf=(t,e)=>{t.canvasItems.delete(e)},fr=(t,e)=>Af(t,e),tc=(t,e)=>{Rf(t,e)};function Ef(t,e,n,i=document.body){const s=o=>{o.key===e&&n(o)};i.addEventListener("keydown",s);const r=()=>{i.removeEventListener("keydown",s);const o=t.keyboardDisposables.indexOf(r);o!==-1&&t.keyboardDisposables.splice(o,1)};return t.keyboardDisposables.push(r),r}const Mf=()=>({canceled:!1}),ec=t=>{t.token.canceled||(t.token.canceled=!0,t.frameId!==null&&(cancelAnimationFrame(t.frameId),t.frameId=null))},Ff=t=>{const e={frameId:null,token:Mf()},n=i=>{if(e.token.canceled)return;e.frameId=null;const s=t(i,e.token);if(e.token.canceled||s===!1){ec(e);return}e.frameId=requestAnimationFrame(n)};return e.frameId=requestAnimationFrame(n),{token:e.token,cancel:()=>ec(e)}},Df={class:"timeline-container"},Nf={class:"timeline-controls"},Of=["disabled"],Lf=["disabled"],Gf={class:"time-display"},If=rn({__name:"Timeline",props:{strokes:{type:Map},selectedStrokes:{type:Set},useRealTiming:{type:Boolean},maxInterStrokeDelay:{type:Number},overrideDuration:{type:Number},lockWhileAnimating:{type:Function}},emits:["timeUpdate"],setup(t,{emit:e}){const n=t,i=e,s=Tt(0),r=Tt(0),o=Tt(!1),a=Tt(null);let l,c=0,h=null;const p=()=>{if(n.overrideDuration!==void 0)r.value=n.overrideDuration;else{let D=0;const x=[];if(n.selectedStrokes.size>0)n.selectedStrokes.forEach(w=>{const T=n.strokes.get(w);T&&x.push(T)}),x.sort((w,T)=>{const M=parseInt(w.id.split("-")[1]||"0"),L=parseInt(T.id.split("-")[1]||"0");return M-L}),x.forEach((w,T)=>{if(w.timestamps&&w.timestamps.length>0){const M=w.timestamps[w.timestamps.length-1]||0;D+=M,T<x.length-1&&(D+=100)}});else{const w=Array.from(n.strokes.values());w.sort((M,L)=>{const I=parseInt(M.id.split("-")[1]||"0"),V=parseInt(L.id.split("-")[1]||"0");return I-V});let T=0;w.forEach((M,L)=>{if(M.timestamps&&M.timestamps.length>0){const I=M.creationTime||parseInt(M.id.split("-")[1]||"0"),V=M.timestamps[M.timestamps.length-1]||0;if(L===0)D=V,T=I+V;else{let G=Math.max(0,I-T);!n.useRealTiming&&G>n.maxInterStrokeDelay&&(G=n.maxInterStrokeDelay),D+=G+V,T=I+V}}})}r.value=D}r.value>0&&s.value>r.value&&(s.value=0,i("timeUpdate",0))};It([()=>n.strokes,()=>n.selectedStrokes,()=>n.useRealTiming,()=>n.maxInterStrokeDelay,()=>n.overrideDuration],()=>{p()},{immediate:!0,deep:!0});const f=Nt(()=>r.value===0?0:s.value/r.value*100),u=D=>{const x=Math.floor(D/1e3),w=Math.floor(D%1e3/10);return`${x}.${w.toString().padStart(2,"0")}s`},m=()=>{o.value||r.value===0||(o.value=!0,n.lockWhileAnimating?.(!0),c=performance.now()-s.value,l=Ff(()=>o.value?(s.value=performance.now()-c,s.value>=r.value?(s.value=0,o.value=!1,n.lockWhileAnimating?.(!1),i("timeUpdate",0),l=void 0,!1):(i("timeUpdate",s.value),!0)):(l=void 0,!1)))},_=()=>{o.value=!1;const D=s.value===0;n.lockWhileAnimating?.(!D),l?.cancel(),l=void 0},S=()=>{o.value=!1,C.value=!1,n.lockWhileAnimating?.(!1),s.value=0,l?.cancel(),l=void 0,i("timeUpdate",0)},C=Tt(!1),g=D=>{if(!h)return;const x=Math.max(0,Math.min(D.clientX-h.left,h.width)),w=h.width>0?x/h.width:0;s.value=w*r.value,i("timeUpdate",s.value)},d=D=>{C.value&&g(D)},y=()=>{if(!C.value)return;C.value=!1;const D=s.value===0;n.lockWhileAnimating?.(!D),h=null,window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",y)},b=D=>{D.preventDefault();const x=a.value;x&&(C.value=!0,n.lockWhileAnimating?.(!0),h=x.getBoundingClientRect(),window.addEventListener("mousemove",d),window.addEventListener("mouseup",y),g(D))},k=D=>{if(!C.value){const w=D.currentTarget.getBoundingClientRect(),M=Math.max(0,Math.min(D.clientX-w.left,w.width))/w.width;s.value=M*r.value;const L=s.value===0;n.lockWhileAnimating?.(!L),o.value&&(c=performance.now()-s.value),i("timeUpdate",s.value)}};return Cn(()=>{l?.cancel(),l=void 0,C.value&&(C.value=!1,n.lockWhileAnimating?.(!1)),h=null,window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",y)}),(D,x)=>(Ct(),kt("div",Df,[lt("div",Nf,[lt("button",{onClick:m,disabled:o.value},"▶️",8,Of),lt("button",{onClick:_,disabled:!o.value},"⏸️",8,Lf),lt("button",{onClick:S},"⏹️"),lt("span",Gf,Zt(u(s.value))+" / "+Zt(u(r.value)),1)]),lt("div",{ref_key:"timelineTrackRef",ref:a,class:"timeline-track",onClick:k,onMousedown:b},[lt("div",{class:"timeline-progress",style:Ue({width:f.value+"%"})},null,4),lt("div",{class:"timeline-playhead",style:Ue({left:f.value+"%"}),onMousedown:Su(b,["stop"])},null,36)],544)]))}}),Uf=".timeline-container[data-v-bbee97de]{width:600px;background:#fff;border:1px solid #ccc;border-radius:8px;padding:15px;box-shadow:0 2px 10px #0000001a;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.timeline-controls[data-v-bbee97de]{display:flex;align-items:center;gap:10px;margin-bottom:10px}.timeline-controls button[data-v-bbee97de]{background:none;border:1px solid #ccc;border-radius:4px;padding:5px 10px;cursor:pointer;font-size:16px}.timeline-controls button[data-v-bbee97de]:hover:not(:disabled){background:#f0f0f0}.timeline-controls button[data-v-bbee97de]:disabled{opacity:.5;cursor:not-allowed}.time-display[data-v-bbee97de]{margin-left:auto;font-family:monospace;font-size:14px;color:#666}.timeline-track[data-v-bbee97de]{position:relative;height:40px;background:#f0f0f0;border-radius:4px;cursor:pointer}.timeline-progress[data-v-bbee97de]{position:absolute;top:0;left:0;height:100%;background:#06f;border-radius:4px}.timeline-playhead[data-v-bbee97de]{position:absolute;top:-5px;width:10px;height:50px;background:#06f;border-radius:2px;transform:translate(-50%);cursor:grab;z-index:10}.timeline-playhead[data-v-bbee97de]:hover{background:#0052cc}.timeline-playhead[data-v-bbee97de]:active{cursor:grabbing}",vi=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n},Bf=vi(If,[["styles",[Uf]],["__scopeId","data-v-bbee97de"]]),Hf={key:0,class:"metadata-editor"},Vf={class:"header"},zf={key:0,class:"unsaved-indicator"},Wf={key:0},$f={class:"buttons"},jf=["disabled"],qf=["disabled"],Kf={key:1,class:"warning"},nc=vi(rn({__name:"MetadataEditor",props:{metadata:{type:null},visible:{type:Boolean},canEdit:{type:Boolean}},emits:["apply","cancel"],setup(t,{emit:e}){const n=t,i=e,s=Tt(""),r=Tt(""),o=Nt(()=>s.value!==r.value);It(()=>[n.metadata,n.canEdit],([c,h])=>{if(h){const p=JSON.stringify(c??{},null,2);s.value=p,r.value=p}else s.value="",r.value=""},{immediate:!0,deep:!0});const a=()=>{try{const c=JSON.parse(s.value||"{}");i("apply",c),r.value=s.value}catch{alert("Invalid JSON format")}},l=()=>{s.value=r.value};return(c,h)=>c.visible?(Ct(),kt("div",Hf,[lt("div",Vf,[o.value?(Ct(),kt("div",zf,h[1]||(h[1]=[lt("span",{class:"dot"},null,-1),_a(" Unsaved changes ")]))):Kt("",!0)]),c.canEdit?(Ct(),kt("div",Wf,[h[2]||(h[2]=lt("p",{class:"help"},"Edit the metadata as JSON:",-1)),Lo(lt("textarea",{"onUpdate:modelValue":h[0]||(h[0]=p=>s.value=p),class:"textarea",placeholder:"{}"},null,512),[[yu,s.value]]),lt("div",$f,[lt("button",{onClick:a,class:"btn save",disabled:!o.value}," Save ",8,jf),lt("button",{onClick:l,class:"btn cancel",disabled:!o.value}," Cancel ",8,qf)])])):(Ct(),kt("div",Kf,h[3]||(h[3]=[lt("p",null,"Select multiple items to edit metadata (single selection only)",-1)])))])):Kt("",!0)}}),[["styles",[".metadata-editor[data-v-894edfb8]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:6px 16px;margin-top:8px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-894edfb8]{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}.header h3[data-v-894edfb8]{margin:0;font-size:17px;color:#333}.unsaved-indicator[data-v-894edfb8]{display:flex;align-items:center;gap:6px;font-size:13px;color:#f39c12;font-weight:500}.dot[data-v-894edfb8]{width:6px;height:6px;background:#f39c12;border-radius:50%;animation:pulse-894edfb8 1.5s infinite}@keyframes pulse-894edfb8{0%,to{opacity:1}50%{opacity:.5}}.help[data-v-894edfb8]{margin:0 0 4px;color:#666;font-size:14px}.textarea[data-v-894edfb8]{width:100%;min-height:120px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:14px;line-height:1.3;resize:vertical;margin-bottom:4px}.textarea[data-v-894edfb8]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 2px #0066ff26}.buttons[data-v-894edfb8]{display:flex;gap:8px}.btn[data-v-894edfb8]{padding:4px 12px;border:1px solid;border-radius:4px;cursor:pointer;font-size:14px;transition:all .2s}.btn[data-v-894edfb8]:disabled{opacity:.5;cursor:not-allowed}.save[data-v-894edfb8]{background:#28a745;color:#fff;border-color:#28a745}.save[data-v-894edfb8]:hover:not(:disabled){background:#218838}.cancel[data-v-894edfb8]{background:#6c757d;color:#fff;border-color:#6c757d}.cancel[data-v-894edfb8]:hover:not(:disabled){background:#5a6268}.warning[data-v-894edfb8]{text-align:center;color:#e67e22;padding:8px}.warning p[data-v-894edfb8]{margin:0;font-size:15px}"]],["__scopeId","data-v-894edfb8"]]),Yf={class:"smart-metadata-editor"},Xf={key:1,class:"hierarchical-editor"},Jf={class:"header"},Qf={key:0},Zf={key:1,class:"multi-selection-header"},t0={class:"help"},e0={key:0,class:"tree-view"},n0=["onClick","onMouseenter"],i0={class:"label"},r0={key:0,class:"metadata-indicator"},s0={key:1,class:"empty-state"},o0={key:3,class:"selection-hint"},a0={key:2,class:"empty-state"},l0=vi(rn({__name:"HierarchicalMetadataEditor",props:{selectedNodes:{type:Array},singleNode:{type:[Object,null]},multiSelected:{type:Boolean},groupSelected:{type:Boolean},collectHierarchyFromRoot:{type:Function},updateMetadataHighlight:{type:Function},updateHoverHighlight:{type:Function},onApplyMetadata:{type:Function}},setup(t){const e=t,n=Nt(()=>e.selectedNodes),i=Nt(()=>e.singleNode),s=Nt(()=>e.multiSelected),r=Nt(()=>e.groupSelected),o=Nt(()=>s.value||r.value?"hierarchical":i.value?"simple":"none"),a=Nt(()=>{if(s.value)return e.collectHierarchyFromRoot(n.value);if(r.value){const g=n.value[0];return g?e.collectHierarchyFromRoot([g]):[]}return[]}),l=Rh(null),c=Nt(()=>{const g=i.value;return g?g.getAttr("metadata")??{}:null}),h=Nt(()=>{const g=l.value;return g?g.getAttr("metadata")??{}:null});It([o,r,n],([g,d])=>{if(g==="hierarchical"&&d){const y=n.value[0];y&&(l.value=y,e.updateMetadataHighlight(y))}else g==="simple"&&i.value?(l.value=i.value,e.updateMetadataHighlight(i.value)):(g==="hierarchical"&&s.value||g==="none")&&(l.value=null,e.updateMetadataHighlight(void 0))},{immediate:!0}),It(i,g=>{o.value==="simple"&&(l.value=g,e.updateMetadataHighlight(g))}),It(l,g=>{e.updateMetadataHighlight(g)}),It(o,g=>{g==="none"&&(l.value=null,e.updateMetadataHighlight(void 0))}),Cn(()=>{e.updateMetadataHighlight(void 0),e.updateHoverHighlight(void 0)});const p=g=>{l.value=g},f=g=>{i.value&&e.onApplyMetadata(i.value,g)},u=g=>{l.value&&e.onApplyMetadata(l.value,g)},m=g=>{const d=g,y=d.id()||`#${d._id}`;if(d instanceof tt.Group){const b=d.getChildren().length;return`Group ${y} (${b} ${b===1?"child":"children"})`}else return d instanceof tt.Path?`Stroke ${y}`:d instanceof tt.Line?`Polygon ${y}`:`${d.constructor.name} ${y}`},_=g=>{const y=g.getAttr("metadata");return y&&Object.keys(y).length>0},S=g=>{e.updateHoverHighlight(g)},C=()=>{e.updateHoverHighlight(void 0)};return(g,d)=>(Ct(),kt("div",Yf,[o.value==="simple"?(Ct(),Qi(nc,{key:0,metadata:c.value,visible:!0,"can-edit":!!i.value,onApply:f},null,8,["metadata","can-edit"])):o.value==="hierarchical"?(Ct(),kt("div",Xf,[lt("div",Jf,[r.value?(Ct(),kt("h3",Qf,"Group: "+Zt(m(n.value[0])),1)):s.value?(Ct(),kt("h3",Zf,Zt(n.value.length)+" items selected – single-item editing only ",1)):Kt("",!0),lt("p",t0,Zt(s.value?"Pick one below to edit its metadata:":"Select a node to edit its metadata:"),1)]),a.value.length>0?(Ct(),kt("div",e0,[(Ct(!0),kt($t,null,Ho(a.value,y=>(Ct(),kt("div",{key:y.indexPath,class:ye(["tree-row",{active:y.node===l.value}]),style:Ue({paddingLeft:y.depth*50+"px"}),onClick:b=>p(y.node),onMouseenter:b=>S(y.node),onMouseleave:C},[lt("span",i0,Zt(m(y.node)),1),_(y.node)?(Ct(),kt("span",r0,"●")):Kt("",!0)],46,n0))),128))])):(Ct(),kt("div",s0,d[0]||(d[0]=[lt("p",null,"No shapes or groups available",-1)]))),l.value?(Ct(),Qi(nc,{key:2,metadata:h.value,visible:!0,"can-edit":!0,onApply:u},null,8,["metadata"])):s.value?(Ct(),kt("div",o0,d[1]||(d[1]=[lt("p",null,"← Click a row above to edit its metadata",-1)]))):Kt("",!0)])):(Ct(),kt("div",a0,d[2]||(d[2]=[lt("p",null,"Select something to edit its metadata",-1)])))]))}}),[["styles",[".smart-metadata-editor[data-v-cb312d1a]{margin-top:8px}.hierarchical-editor[data-v-cb312d1a]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:8px 16px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-cb312d1a]{margin-bottom:8px}.header h3[data-v-cb312d1a]{margin:0 0 4px;font-size:17px;color:#333}.multi-selection-header[data-v-cb312d1a]{color:#e67e22!important;font-weight:700}.help[data-v-cb312d1a]{margin:0;color:#666;font-size:14px}.tree-view[data-v-cb312d1a]{max-height:300px;overflow-y:auto;border:1px solid #eee;border-radius:4px;margin-bottom:8px}.tree-row[data-v-cb312d1a]{display:flex;align-items:center;justify-content:space-between;padding:4px 8px;cursor:pointer;user-select:none;border-bottom:1px solid #f5f5f5;transition:background-color .15s}.tree-row[data-v-cb312d1a]:last-child{border-bottom:none}.tree-row[data-v-cb312d1a]:hover{background-color:#f8f9fa}.tree-row.active[data-v-cb312d1a]{background-color:#fff2f2;border-left:3px solid #dc3545}.label[data-v-cb312d1a]{font-family:Monaco,Consolas,monospace;font-size:13px;color:#333}.metadata-indicator[data-v-cb312d1a]{color:#28a745;font-size:12px;font-weight:700}.empty-state[data-v-cb312d1a]{text-align:center;color:#666;padding:20px;font-style:italic}.empty-state p[data-v-cb312d1a]{margin:0}.selection-hint[data-v-cb312d1a]{text-align:center;color:#666;padding:15px;font-style:italic;border:2px dashed #ddd;border-radius:6px;margin-top:10px}.selection-hint p[data-v-cb312d1a]{margin:0}"]],["__scopeId","data-v-cb312d1a"]]),ic=t=>{const e=[],n=(i,s=0,r="")=>{e.push({node:i,depth:s,indexPath:r}),i instanceof tt.Group&&i.getChildren().forEach((o,a)=>n(o,s+1,r?`${r}/${a}`:`${a}`))};return t.forEach((i,s)=>n(i,0,`${s}`)),e},c0=t=>t?ic(t.getChildren()):[],gr=new Map,rc=t=>gr.set(t.key,t),sc=()=>Array.from(gr.values()),h0=t=>t.ancillary.nodeVisualizations,oc=t=>{const e=t.stage;if(e){if(!t.layers.ancillaryViz){const n=new tt.Layer({listening:!1,name:"ancillary-vis"});t.layers.ancillaryViz=n,e.add(n)}return t.layers.ancillaryViz}},d0=t=>{t.stage&&t.ancillary.rafToken===null&&(t.ancillary.rafToken=requestAnimationFrame(()=>{t.ancillary.rafToken=null,Ye(t)}))},u0=t=>{const e=t.stage;if(!e||t.ancillary.listenersAttached)return;const n=()=>d0(t);e.on("dragmove.av transform.av",n),e.on("destroy.av",n),e.on("dragend.av transformend.av",()=>Ye(t)),t.ancillary.listenersAttached=!0},f0=t=>{t.ancillary.activeWatchStop||(t.ancillary.activeWatchStop=It(()=>t.ancillary.activeVisualizations.value,()=>Ye(t),{deep:!0}))},ac=t=>{t.stage&&(oc(t),u0(t),f0(t),Ye(t))},Ye=t=>{const e=t.stage,n=oc(t);if(!e||!n)return;const s=c0(t.layers.freehandShape).filter(l=>l.depth===0).map(l=>l.node),r=new Map,o=t.ancillary.activeVisualizations.value;s.forEach(l=>{const c=l.getAttr("metadata")??{},h=l.getClientRect({relativeTo:e}),p={node:l,metadata:c,bbox:h};o.forEach(f=>{const u=gr.get(f);u&&u.validate(p)&&r.set(`${f}|${l.id()}`,{ctx:p,def:u})})});const a=h0(t);a.forEach((l,c)=>{r.has(c)||(gr.get(l.key)?.destroy?.(l.nodes),(Array.isArray(l.nodes)?l.nodes:[l.nodes]).forEach(f=>f.destroy()),a.delete(c))}),r.forEach((l,c)=>{const h=a.get(c);if(h)l.def.update?.(l.ctx,h.nodes);else{const p=l.def.create(l.ctx);(Array.isArray(p)?p:[p]).forEach(u=>n.add(u)),a.set(c,{key:l.def.key,nodes:p})}}),n.batchDraw()},g0=Object.freeze(Object.defineProperty({__proto__:null,getRegisteredAVs:sc,initAVLayer:ac,refreshAnciliaryViz:Ye,registerAV:rc},Symbol.toStringTag,{value:"Module"}));rc({key:"typo-guides",displayName:"Typography Guidelines",validate:({metadata:t})=>["lowLine","midLine","capHeight","ascender","descender","baseline"].some(e=>e in t&&typeof t[e]=="number"),create:t=>lc(t),update:(t,e)=>lc(t,e)});function lc({bbox:t,metadata:e},n){const i=[4,4],r=[{key:"baseline",fraction:e.baseline,color:"#333"},{key:"lowLine",fraction:e.lowLine,color:"#888"},{key:"midLine",fraction:e.midLine,color:"#f80"},{key:"capHeight",fraction:e.capHeight,color:"#0a0"},{key:"ascender",fraction:e.ascender,color:"#00f"},{key:"descender",fraction:e.descender,color:"#f00"}].filter(o=>o.fraction!==void 0&&typeof o.fraction=="number"&&o.fraction>=0&&o.fraction<=1).map(o=>{const a=t.y+t.height*o.fraction;return new tt.Line({points:[t.x,a,t.x+t.width,a],stroke:o.color,strokeWidth:1,dash:i,listening:!1,name:`typo-guide-${o.key}`})});return n?(n.forEach((o,a)=>{if(a<r.length){const l=r[a];o.points(l.points()),o.stroke(l.stroke())}}),n.length>r.length&&(n.slice(r.length).forEach(o=>o.destroy()),n.splice(r.length)),r.length>n.length&&n.push(...r.slice(n.length)),n):r}const p0={key:0,class:"av-toggle-pane"},m0={class:"toggles-grid"},y0=["checked","onChange"],_0=vi(rn({__name:"VisualizationToggles",props:{canvasState:{type:Object}},setup(t){const e=t,n=Nt(()=>sc()),i=Nt(()=>e.canvasState.ancillary.activeVisualizations.value),s=(o,a)=>{const l=new Set(i.value);a?l.add(o):l.delete(o),e.canvasState.ancillary.activeVisualizations.value=l},r=(o,a)=>{const l=a.target.checked;s(o,l)};return(o,a)=>n.value.length>0?(Ct(),kt("div",p0,[a[0]||(a[0]=lt("h4",null,"Visualizations",-1)),lt("div",m0,[(Ct(!0),kt($t,null,Ho(n.value,l=>(Ct(),kt("label",{key:l.key,class:"toggle-item"},[lt("input",{type:"checkbox",checked:i.value.has(l.key),onChange:c=>r(l.key,c)},null,40,y0),lt("span",null,Zt(l.displayName),1)]))),128))])])):Kt("",!0)}}),[["styles",[".av-toggle-pane[data-v-641f8251]{background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px;font-size:13px}.av-toggle-pane h4[data-v-641f8251]{margin:0 0 8px;font-size:14px;color:#333;font-weight:600}.toggles-grid[data-v-641f8251]{display:flex;flex-direction:column;gap:6px}.toggle-item[data-v-641f8251]{display:flex;align-items:center;gap:8px;cursor:pointer;transition:background-color .2s;padding:4px 6px;border-radius:4px}.toggle-item[data-v-641f8251]:hover{background-color:#f0f0f0}.toggle-item input[type=checkbox][data-v-641f8251]{margin:0;cursor:pointer}.toggle-item span[data-v-641f8251]{color:#555;font-size:13px;user-select:none}.toggle-item input[type=checkbox]:checked+span[data-v-641f8251]{color:#333;font-weight:500}"]],["__scopeId","data-v-641f8251"]]);function cc(t,e,n,i=s=>s){return t*i(.5-e*(.5-n))}function v0(t){return[-t[0],-t[1]]}function ue(t,e){return[t[0]+e[0],t[1]+e[1]]}function ce(t,e){return[t[0]-e[0],t[1]-e[1]]}function fe(t,e){return[t[0]*e,t[1]*e]}function b0(t,e){return[t[0]/e,t[1]/e]}function bi(t){return[t[1],-t[0]]}function hc(t,e){return t[0]*e[0]+t[1]*e[1]}function S0(t,e){return t[0]===e[0]&&t[1]===e[1]}function x0(t){return Math.hypot(t[0],t[1])}function w0(t){return t[0]*t[0]+t[1]*t[1]}function dc(t,e){return w0(ce(t,e))}function uc(t){return b0(t,x0(t))}function C0(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function Si(t,e,n){let i=Math.sin(n),s=Math.cos(n),r=t[0]-e[0],o=t[1]-e[1],a=r*s-o*i,l=r*i+o*s;return[a+e[0],l+e[1]]}function As(t,e,n){return ue(t,fe(ce(e,t),n))}function fc(t,e,n){return ue(t,fe(e,n))}var{min:hn,PI:P0}=Math,gc=.275,xi=P0+1e-4;function T0(t,e={}){let{size:n=16,smoothing:i=.5,thinning:s=.5,simulatePressure:r=!0,easing:o=v=>v,start:a={},end:l={},last:c=!1}=e,{cap:h=!0,easing:p=v=>v*(2-v)}=a,{cap:f=!0,easing:u=v=>--v*v*v+1}=l;if(t.length===0||n<=0)return[];let m=t[t.length-1].runningLength,_=a.taper===!1?0:a.taper===!0?Math.max(n,m):a.taper,S=l.taper===!1?0:l.taper===!0?Math.max(n,m):l.taper,C=Math.pow(n*i,2),g=[],d=[],y=t.slice(0,10).reduce((v,P)=>{let E=P.pressure;if(r){let R=hn(1,P.distance/n),O=hn(1,1-R);E=hn(1,v+(O-v)*(R*gc))}return(v+E)/2},t[0].pressure),b=cc(n,s,t[t.length-1].pressure,o),k,D=t[0].vector,x=t[0].point,w=x,T=x,M=w,L=!1;for(let v=0;v<t.length;v++){let{pressure:P}=t[v],{point:E,vector:R,distance:O,runningLength:j}=t[v];if(v<t.length-1&&m-j<3)continue;if(s){if(r){let it=hn(1,O/n),ht=hn(1,1-it);P=hn(1,y+(ht-y)*(it*gc))}b=cc(n,s,P,o)}else b=n/2;k===void 0&&(k=b);let H=j<_?p(j/_):1,J=m-j<S?u((m-j)/S):1;b=Math.max(.01,b*Math.min(H,J));let st=(v<t.length-1?t[v+1]:t[v]).vector,$=v<t.length-1?hc(R,st):1,F=hc(R,D)<0&&!L,W=$!==null&&$<0;if(F||W){let it=fe(bi(D),b);for(let ht=.07692307692307693,A=0;A<=1;A+=ht)T=Si(ce(E,it),E,xi*A),g.push(T),M=Si(ue(E,it),E,xi*-A),d.push(M);x=T,w=M,W&&(L=!0);continue}if(L=!1,v===t.length-1){let it=fe(bi(R),b);g.push(ce(E,it)),d.push(ue(E,it));continue}let et=fe(bi(As(st,R,$)),b);T=ce(E,et),(v<=1||dc(x,T)>C)&&(g.push(T),x=T),M=ue(E,et),(v<=1||dc(w,M)>C)&&(d.push(M),w=M),y=P,D=R}let I=t[0].point.slice(0,2),V=t.length>1?t[t.length-1].point.slice(0,2):ue(t[0].point,[1,1]),G=[],X=[];if(t.length===1){if(!(_||S)||c){let v=fc(I,uc(bi(ce(I,V))),-(k||b)),P=[];for(let E=.07692307692307693,R=E;R<=1;R+=E)P.push(Si(v,I,xi*2*R));return P}}else{if(!(_||S&&t.length===1))if(h)for(let P=.07692307692307693,E=P;E<=1;E+=P){let R=Si(d[0],I,xi*E);G.push(R)}else{let P=ce(g[0],d[0]),E=fe(P,.5),R=fe(P,.51);G.push(ce(I,E),ce(I,R),ue(I,R),ue(I,E))}let v=bi(v0(t[t.length-1].vector));if(S||_&&t.length===1)X.push(V);else if(f){let P=fc(V,v,b);for(let E=.034482758620689655,R=E;R<1;R+=E)X.push(Si(P,V,xi*3*R))}else X.push(ue(V,fe(v,b)),ue(V,fe(v,b*.99)),ce(V,fe(v,b*.99)),ce(V,fe(v,b)))}return g.concat(X,d.reverse(),G)}function k0(t,e={}){var n;let{streamline:i=.5,size:s=16,last:r=!1}=e;if(t.length===0)return[];let o=.15+(1-i)*.85,a=Array.isArray(t[0])?t:t.map(({x:u,y:m,pressure:_=.5})=>[u,m,_]);if(a.length===2){let u=a[1];a=a.slice(0,-1);for(let m=1;m<5;m++)a.push(As(a[0],u,m/4))}a.length===1&&(a=[...a,[...ue(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,h=0,p=l[0],f=a.length-1;for(let u=1;u<a.length;u++){let m=r&&u===f?a[u].slice(0,2):As(p.point,a[u],o);if(S0(p.point,m))continue;let _=C0(m,p.point);if(h+=_,u<f&&!c){if(h<s)continue;c=!0}p={point:m,pressure:a[u][2]>=0?a[u][2]:.5,vector:uc(ce(p.point,m)),distance:_,runningLength:h},l.push(p)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function A0(t,e={}){return T0(k0(t,e),e)}var R0=A0;const Rs=t=>t.metadata.highlight.layer,E0=t=>t.metadata.highlight.metadataRect,M0=t=>t.metadata.highlight.hoverRect,pc=(t,e)=>{const n=Rs(t);if(n)return n;const i=new tt.Layer({listening:!1}),s=new tt.Rect({stroke:"red",strokeWidth:2,dash:[4,4],listening:!1,visible:!1}),r=new tt.Rect({stroke:"green",strokeWidth:2,dash:[4,4],listening:!1,visible:!1});return i.add(s),i.add(r),e.add(i),t.metadata.highlight.layer=i,t.metadata.highlight.metadataRect=s,t.metadata.highlight.hoverRect=r,t.layers.metadataHighlight=i,i},F0=(t,e)=>{const n=E0(t),i=Rs(t);if(!n||!i)return;if(!e){n.visible(!1),i.batchDraw();return}const s=e.getClientRect({relativeTo:e.getStage()});n.setAttrs({x:s.x,y:s.y,width:s.width,height:s.height,visible:!0}),i.batchDraw()},D0=(t,e)=>{const n=M0(t),i=Rs(t);if(!n||!i)return;if(!e){n.visible(!1),i.batchDraw();return}const s=e.getClientRect({relativeTo:e.getStage()});n.setAttrs({x:s.x,y:s.y,width:s.width,height:s.height,visible:!0}),i.batchDraw()},N0=t=>({setNodeMetadata:(e,n)=>{n===void 0||Object.keys(n).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",n)},collectHierarchyFromRoot:ic,updateMetadataHighlight:e=>F0(t,e),updateHoverHighlight:e=>D0(t,e)}),Es=(t,e)=>{e instanceof tt.Path?Zl(t,e):e instanceof tt.Group&&(Ts(t,e),e.getChildren().forEach(n=>Es(t,n)))},pr=(t,e)=>{(e instanceof tt.Path||e instanceof tt.Group)&&(e instanceof tt.Path,e.draggable(!0),e.off("click.freehand"),e.off("dragstart.freehand"),e.off("dragend.freehand"),e.on("dragstart.freehand",()=>{Fs(t)}),e.on("dragend.freehand",()=>{Ds(t,e.constructor.name),t.layers.freehandShape?.batchDraw()}),e instanceof tt.Group&&e.getChildren().forEach(n=>{pr(t,n)}))},mc=(t,e,n=0,i=0)=>{const s=e.clone({x:e.x()+n,y:e.y()+i}),r=(o,a)=>{const l=_i();if(o.id(l),o instanceof tt.Path){const c=Array.from(Xt(t).values()).find(h=>h.shape===a);if(c){const h={...c,id:l,shape:o};Xt(t).set(l,h),console.log("Created stroke data for cloned Path:",l)}}else if(o instanceof tt.Group){const c=a,h=o;h.getChildren().forEach((f,u)=>{const m=c.getChildren()[u];r(f,m)});const p=h.find("Path").map(f=>f.id());p.length>0&&(vs(t).set(l,{id:l,strokeIds:p,group:h}),console.log("Created group data for cloned Group:",l,"with strokes:",p))}};return r(s,e),pr(t,s),Es(t,s),console.log("Successfully cloned",e.className,"with new ID:",s.id()),s},yc=(t,e)=>{t.layers.freehandShape=new tt.Layer,t.layers.freehandDrawing=new tt.Layer,t.layers.freehandSelection=new tt.Layer,e.add(t.layers.freehandShape),e.add(t.layers.freehandDrawing),e.add(t.layers.freehandSelection)},_c=t=>{const e=[],n=new Set;return t.selection.selectedKonvaNodes.value.forEach(i=>{if(i instanceof tt.Group){const s=r=>{r.getChildren().forEach(o=>{o instanceof tt.Group?s(o):o instanceof tt.Path&&Array.from(Xt(t).values()).forEach(a=>{a.shape===o&&!n.has(a.id)&&(e.push(a),n.add(a.id))})})};s(i)}else i instanceof tt.Path&&Array.from(Xt(t).values()).forEach(s=>{s.shape===i&&!n.has(s.id)&&(e.push(s),n.add(s.id))})}),e},Ms=t=>{t.freehand.timelineDuration.value;let e=0;if(Ps(t))t.freehand.selectedStrokesForTimeline.value=new Set,t.freehand.timelineDuration.value=0;else{const n=_c(t).filter(s=>s.isFreehand),i=new Set(n.map(s=>s.id));if(t.freehand.selectedStrokesForTimeline.value=i,n.length>0){const s=n.sort((o,a)=>o.creationTime-a.creationTime);let r=0;s.forEach((o,a)=>{const l=o.timestamps[o.timestamps.length-1]||0;r+=l,a<s.length-1&&(r+=100)}),e=r,t.freehand.timelineDuration.value=r}else t.freehand.timelineDuration.value=0}e>0&&t.freehand.currentPlaybackTime.value>e&&(t.freehand.currentPlaybackTime.value=0,Ls(t,0))},vc=t=>{t.freehand.strokes.clear(),t.freehand.strokeGroups.clear()},bc=(t,e,n)=>{const i={id:n.id,points:n.points,timestamps:n.timestamps,shape:n.shape,selected:n.selected,originalPath:n.originalPath,creationTime:n.creationTime,isFreehand:n.isFreehand};t.freehand.strokes.set(e,i)},Sc=(t,e,n)=>{const i={id:n.id,strokeIds:n.strokeIds,group:n.group};t.freehand.strokeGroups.set(e,i)},mr=300,xc=t=>Cs(t,()=>{const e=t.layers.freehandShape;if(!t.stage||!e)return null;try{const i=e.toObject(),s=Array.from(t.freehand.strokes.entries()),r=Array.from(t.freehand.strokeGroups.entries());return{layer:i,strokes:s,strokeGroups:r}}catch(i){return console.warn("Failed to get current state:",i),null}}),Fe=t=>{const e=xc(t);return JSON.stringify(e)},wc=(t,e,n={})=>{if(e)try{const i=t.freehand.currentPlaybackTime.value>0;t.freehand.currentPlaybackTime.value=0,t.freehand.isAnimating.value=!1,yr(t,e),i&&n.handleTimeUpdate?.(0)}catch(i){console.warn("Failed to restore state:",i)}},Fs=t=>{t.freehand.freehandDragStartState=Fe(t)},Ds=(t,e)=>{if(!t.freehand.freehandDragStartState)return;const n=Fe(t);t.freehand.freehandDragStartState!==n&&(cr(t,`Transform ${e}`,t.freehand.freehandDragStartState,n),console.log("Transform command added to global history"),ge(t)),t.freehand.freehandDragStartState=null},Ns=t=>{const e=t.stage;e&&Xt(t).forEach((n,i)=>{const s=e.findOne(`#${i}`);s&&s!==n.shape&&(console.log("Updating stroke connection for:",i),n.shape=s)})},Cc=t=>{const e=t.layers.freehandShape;if(!(!t.stage||!e))try{const i=xc(t);if(!i)return;t.freehand.serializedState=JSON.stringify(i),t.callbacks.syncAppState?.(t),console.log("Serialized canvas state:",{layerChildren:i.layer?.children?.length||0,strokes:i.strokes.length,strokeGroups:i.strokeGroups.length})}catch(i){console.warn("Failed to serialize Konva state:",i)}},Pc=t=>{const e=Fe(t);if(!e){console.warn("No drawing data to download");return}const n=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=`freehand_drawing_${new Date().toISOString().slice(0,16).replace(/:/g,"-")}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)},Tc=t=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=n=>{const i=n.target.files?.[0];if(!i)return;const s=new FileReader;s.onload=r=>{try{const o=r.target?.result;JSON.parse(o),yr(t,o),console.log("Successfully loaded drawing from file:",i.name)}catch(o){console.error("Failed to parse uploaded file:",o),alert("Invalid JSON file. Please upload a valid freehand drawing file.")}},s.readAsText(i)},e.click()},yr=(t,e)=>{const n=t.layers.freehandShape,i=t.stage;if(!(!e||!i||!n))try{const s=JSON.parse(e);console.log("Deserializing canvas state:",{layerChildren:s.layer?.children?.length||0,strokes:s.strokes?.length||0,strokeGroups:s.strokeGroups?.length||0}),n.destroyChildren(),vc(t),le(t);const r=s.layer;r&&r.children&&(console.log("Restoring",r.children.length,"children"),r.children.forEach((o,a)=>{console.log("Creating node",a,"of type",o.className);const l=tt.Node.create(JSON.stringify(o));n.add(l),console.log("Added node to layer:",l.id(),l.isVisible()),pr(t,l),Es(t,l)})),s.strokes&&s.strokes.forEach(([o,a])=>{const l=i.findOne(`#${o}`);console.log("Restoring stroke:",o,"found shape:",!!l);const c={id:a.id,points:a.points,timestamps:a.timestamps,originalPath:a.originalPath,creationTime:a.creationTime,isFreehand:a.isFreehand,shape:l};bc(t,o,c)}),s.strokeGroups&&s.strokeGroups.forEach(([o,a])=>{const l={id:a.id,strokeIds:a.strokeIds,group:i.findOne(`#${o}`)};Sc(t,o,l)}),Ns(t),Os(t),n.batchDraw(),console.log("Konva canvas state restored from hotreload"),t.freehand.serializedState=e,setTimeout(()=>{n.batchDraw(),ge(t)},30)}catch(s){console.warn("Failed to deserialize Konva state:",s)}},Os=t=>{const e=t.layers.freehandShape;Xt(t).forEach(n=>{n.shape&&n.shape.draggable(!1)}),e&&e.getChildren().forEach(n=>{n instanceof tt.Group&&n.draggable(!1)})},wi=(t,e=!1)=>{if(t.length<4)return"";const n=[];for(let o=0;o<t.length;o+=2)n.push([t[o],t[o+1]]);const i=R0(n,{size:8,thinning:.5,smoothing:.5,streamline:.5,simulatePressure:!0});if(i.length===0)return"";let s=i;if(e){let o=1/0,a=1/0;i.forEach(([l,c])=>{o=Math.min(o,l),a=Math.min(a,c)}),s=i.map(([l,c])=>[l-o,c-a])}return`${s.reduce((o,[a,l],c,h)=>{const[p,f]=h[(c+1)%h.length];return`${o} ${a},${l} ${p},${f}`},`M ${s[0][0]},${s[0][1]} L`)} Z`},kc=(t,e,n)=>{const i=t.layers.freehandShape,s=ur(e),r=[];for(let a=0;a<e.length;a+=2)r.push(e[a]-s.minX),r.push(e[a+1]-s.minY);const o=new tt.Path({data:wi(r),fill:"black",strokeWidth:0,id:n,x:s.minX,y:s.minY,draggable:!0});return o.on("dragstart",()=>{Fs(t)}),o.on("dragend",()=>{Ds(t,"Stroke"),i?.batchDraw()}),Zl(t,o),o},Ls=(t,e)=>{const n=t.layers.freehandShape;t.freehand.currentPlaybackTime.value=e;let i=[];const s=!Ps(t);if(s?i=_c(t).filter(c=>c.isFreehand):i=Array.from(Xt(t).values()).filter(l=>l.isFreehand),i.sort((l,c)=>l.creationTime-c.creationTime),e===0){if(s){const l=new Set;i.forEach(c=>{if(c.shape&&c.originalPath){c.shape.show(),c.shape.data(c.originalPath);let h=c.shape.getParent();for(;h&&h!==n;)h instanceof tt.Group&&l.add(h),h=h.getParent()}}),l.forEach(c=>c.show())}else Xt(t).forEach(l=>{l.shape&&l.originalPath&&l.isFreehand&&(l.shape.show(),l.shape.data(l.originalPath))}),n&&n.getChildren().forEach(l=>{l instanceof tt.Group&&l.show()});n?.batchDraw();return}s?i.forEach(l=>{l.shape&&l.shape.hide()}):(Xt(t).forEach(l=>{l.shape&&l.isFreehand&&l.shape.hide()}),n&&n.getChildren().forEach(l=>{l instanceof tt.Group&&l.hide()}));let r=0;const o=[];if(s)i.forEach((l,c)=>{const h=l.timestamps[l.timestamps.length-1]||0;o.push({stroke:l,startTime:r,endTime:r+h}),r+=h+(c<i.length-1?100:0)});else{let l=0;i.forEach((c,h)=>{const p=c.timestamps[c.timestamps.length-1]||0;if(h===0)o.push({stroke:c,startTime:0,endTime:p}),l=c.creationTime+p,r=p;else{let f=Math.max(0,c.creationTime-l);!t.freehand.useRealTiming.value&&f>mr&&(f=mr);const u=r+f;o.push({stroke:c,startTime:u,endTime:u+p}),r=u+p,l=c.creationTime+p}})}const a=new Set;o.forEach(({stroke:l,startTime:c,endTime:h})=>{if(!(!l.shape||!l.timestamps)){if(e>=c&&e<=h){const p=e-c;let f=-1;for(let u=0;u<l.timestamps.length&&l.timestamps[u]<=p;u++)f=u;if(f>=0){const u=l.points.slice(0,(f+1)*2);if(u.length>=4){const m=ur(l.points),_=[];for(let C=0;C<u.length;C+=2)_.push(u[C]-m.minX),_.push(u[C+1]-m.minY);l.shape.show(),l.shape.data(wi(_));let S=l.shape.getParent();for(;S&&S!==n;)S instanceof tt.Group&&a.add(S),S=S.getParent()}}}else if(e>h){l.shape.show(),l.shape.data(l.originalPath);let p=l.shape.getParent();for(;p&&p!==n;)p instanceof tt.Group&&a.add(p),p=p.getParent()}}}),a.forEach(l=>l.show()),n?.batchDraw()},O0=t=>{const e=t.layers.freehandShape;if(!e)return{data:[],groupMap:{}};const n=(a,l)=>{const c=ur(a),h=[];for(let u=0;u<a.length;u+=2)h.push(a[u]-c.minX),h.push(a[u+1]-c.minY);const p=l.getAbsoluteTransform(),f=[];for(let u=0;u<h.length;u+=2){const m=p.point({x:h[u],y:h[u+1]});f.push({x:m.x,y:m.y})}return f};let i=0;const s={},r=a=>{if(a instanceof tt.Path){const l=Array.from(t.freehand.strokes.values()).find(f=>f.shape===a);if(!l)return null;const h=n(l.points,a).map((f,u)=>({x:f.x,y:f.y,ts:l.timestamps[Math.floor(u/2)]||0})),p=a.getAttr("metadata");return p&&p.name&&typeof p.name=="string"&&(s[p.name]||(s[p.name]=[]),s[p.name].push(i)),i++,{type:"stroke",points:h,...p&&{metadata:p}}}else if(a instanceof tt.Group){const l=i,c=[];if(a.getChildren().forEach(p=>{const f=r(p);f&&c.push(f)}),c.length===0)return null;const h=a.getAttr("metadata");if(h&&h.name&&typeof h.name=="string"){const p=[];for(let f=l;f<i;f++)p.push(f);s[h.name]=p}return{type:"strokeGroup",children:c,...h&&{metadata:h}}}return null},o=[];return e.getChildren().forEach(a=>{const l=r(a);l&&(l.type==="stroke"?o.push({type:"strokeGroup",children:[l]}):o.push(l))}),{data:o,groupMap:s}},ge=t=>{const e=O0(t);t.freehand.bakedRenderData=e.data,t.freehand.bakedGroupMap=e.groupMap,t.callbacks.syncAppState?.(t)},Ac=Object.freeze(Object.defineProperty({__proto__:null,attachHandlersRecursively:pr,clearStrokesInState:vc,createStrokeShape:kc,deepCloneWithNewIds:mc,deserializeFreehandState:yr,downloadFreehandDrawing:Pc,finishFreehandDragTracking:Ds,getCurrentFreehandStateString:Fe,getStrokePath:wi,handleTimeUpdate:Ls,initFreehandLayers:yc,maxInterStrokeDelay:mr,refreshStrokeConnections:Ns,restoreFreehandState:wc,serializeFreehandState:Cc,setStrokeGroupInState:Sc,setStrokeInState:bc,startFreehandDragTracking:Fs,updateBakedFreehandData:ge,updateFreehandDraggableStates:Os,updateTimelineState:Ms,uploadFreehandDrawing:Tc},Symbol.toStringTag,{value:"Module"})),L0=(t,e,n)=>{const i=e.x-t.x,s=e.y-t.y,r=n.x-t.x,o=n.y-t.y,a=i*r+s*o;if(a<=0)return Math.hypot(r,o);const l=i*i+s*s;if(l<=a)return Math.hypot(n.x-e.x,n.y-e.y);const c=a/l,h=t.x+c*i,p=t.y+c*s;return Math.hypot(n.x-h,n.y-p)};function Rc(t,e){let n=-1,i=-1,s=1/0;for(let r=0;r<t.length;r++){const o=t[r];for(let a=0;a<o.points.length;a++){const l=o.points[a],c=o.points[(a+1)%o.points.length],h=L0(l,c,e);h<s&&(s=h,n=r,i=a)}}return{polygonIndex:n,lineIndex:i,distance:s}}const Ec=(t,e)=>{t.layers.polygonShapes=new tt.Layer,t.layers.polygonPreview=new tt.Layer,t.layers.polygonControls=new tt.Layer,t.layers.polygonSelection=new tt.Layer,e.add(t.layers.polygonShapes),e.add(t.layers.polygonPreview),e.add(t.layers.polygonControls),e.add(t.layers.polygonSelection)},Gs=t=>{le(t)},Mc=t=>{const e=t.layers.polygonShapes;if(!e)return[];const n=[],i=(s,r)=>{const o=[],a=r.getAbsoluteTransform();for(let l=0;l<s.length;l+=2){const c=a.point({x:s[l],y:s[l+1]});o.push({x:c.x,y:c.y})}return o};return e.getChildren().forEach(s=>{if(s instanceof tt.Line){const r=s.points(),o=i(r,s),a=s.getAttr("metadata");n.push({type:"polygon",points:o,...a&&{metadata:a}})}}),n},xe=t=>{t.polygon.bakedRenderData=Mc(t),t.callbacks.syncAppState?.(t)},Is=t=>Cs(t,()=>{const e=t.layers.polygonShapes;if(!t.stage||!e)return null;try{const i=e.toObject(),s=Array.from(t.polygon.shapes.entries()),r=Array.from(t.polygon.groups.entries());return{layer:i,polygons:s,polygonGroups:r}}catch(i){return console.warn("Failed to get current polygon state:",i),null}}),dn=t=>{const e=Is(t);return JSON.stringify(e)},Fc=(t,e)=>{if(e)try{Hs(t,e)}catch(n){console.warn("Failed to restore polygon state:",n)}},Us=t=>{const e=JSON.stringify({freehand:Fe(t),polygon:dn(t)});t.polygon.dragStartState=e},Bs=(t,e)=>{if(!t.polygon.dragStartState)return;const n=JSON.stringify({freehand:Fe(t),polygon:dn(t)});t.polygon.dragStartState!==n&&(cr(t,`Transform ${e}`,t.polygon.dragStartState,n),xe(t)),t.polygon.dragStartState=null},Ie=t=>{const e=t.layers.polygonShapes;if(!(!t.stage||!e))try{const i=Is(t);if(!i)return;t.polygon.serializedState=JSON.stringify(i),t.callbacks.syncAppState?.(t),console.log("Serialized polygon state:",{layerChildren:i.layer?.children?.length||0,polygons:i.polygons.length,polygonGroups:i.polygonGroups.length})}catch(i){console.warn("Failed to serialize polygon state:",i)}},_r=(t,e)=>{console.log("Attaching polygon handlers to:",e.id()),e.draggable(!1),e.on("dragstart",()=>Us(t)),e.on("dragend",()=>{Bs(t,"Polygon Drag"),Ie(t)})},Hs=(t,e)=>{const n=t.layers.polygonShapes,i=t.layers.polygonControls,s=t.stage;if(!(!e||!s||!n))try{const r=JSON.parse(e);console.log("Deserializing polygon state:",{layerChildren:r.layer?.children?.length||0,polygons:r.polygons?.length||0,polygonGroups:r.polygonGroups?.length||0}),n.destroyChildren(),t.polygon.shapes.clear(),t.polygon.groups.clear(),le(t);const o=r.layer;o&&o.children&&(console.log("Restoring",o.children.length,"polygon shapes"),o.children.forEach((a,l)=>{console.log("Creating polygon node",l,"of type",a.className);const c=tt.Node.create(JSON.stringify(a));n.add(c),console.log("Added polygon node to layer:",c.id(),c.isVisible()),c instanceof tt.Line?(_r(t,c),ks(t,c)):c instanceof tt.Group&&Ts(t,c)})),r.polygons&&r.polygons.forEach(([a,l])=>{const c=s.findOne(`#${a}`);console.log("Restoring polygon:",a,"found shape:",!!c);const h={id:l.id,points:l.points,closed:l.closed,creationTime:l.creationTime,konvaShape:c,controlPoints:[]};t.polygon.shapes.set(a,h)}),r.polygonGroups&&r.polygonGroups.forEach(([a,l])=>{const c={id:l.id,polygonIds:l.polygonIds,group:s.findOne(`#${a}`)};t.polygon.groups.set(a,c)}),i?.destroyChildren(),t.activeTool.value==="polygon"&&t.polygon.mode.value==="edit"&&un(t),n.batchDraw(),t.polygon.serializedState=e,xe(t),console.log("Polygon state restored from hotreload")}catch(r){console.warn("Failed to deserialize polygon state:",r)}},Dc=(t,e)=>{const n=t.layers.polygonShapes;if(n){if(t.polygon.mode.value==="draw"){if(!t.polygon.isDrawing.value)t.polygon.isDrawing.value=!0,t.polygon.currentPoints.value=[e.x,e.y];else{const i=t.polygon.currentPoints.value[0],s=t.polygon.currentPoints.value[1];Math.sqrt((e.x-i)**2+(e.y-s)**2)<t.polygon.proximityThreshold&&t.polygon.currentPoints.value.length>=6?Vs(t):(t.polygon.currentPoints.value.push(e.x,e.y),vr(t))}vr(t)}else if(t.polygon.mode.value==="edit"){const i=Array.from(ae(t).values()).map(s=>{const r=s.konvaShape,o=r?r.getAbsoluteTransform():null,a=[];for(let l=0;l<s.points.length;l+=2)if(o){const c=o.point({x:s.points[l],y:s.points[l+1]});a.push({x:c.x,y:c.y})}else a.push({x:s.points[l],y:s.points[l+1]});return{points:a}});if(i.length>0){const s=Rc(i,e);if(s.polygonIndex>=0&&s.distance<t.polygon.proximityThreshold*2){const r=Array.from(ae(t).keys())[s.polygonIndex],o=ae(t).get(r);o&&o.konvaShape&&Ke(t,"Add Polygon Point",()=>{const a=o.points,l=(s.lineIndex+1)*2,c=a[s.lineIndex*2],h=a[s.lineIndex*2+1],p=a[(s.lineIndex+1)*2%a.length],f=a[((s.lineIndex+1)*2+1)%a.length],u=(c+p)/2,m=(h+f)/2;o.points.splice(l,0,u,m),o.konvaShape.points(o.points),un(t),Ie(t),n?.batchDraw(),xe(t)})}}}}},Nc=t=>{!t.polygon.isDrawing.value||t.polygon.mode.value!=="draw"||vr(t)},Oc=t=>{const e=t.layers.polygonPreview,n=t.layers.polygonControls,i=t.stage;if(!e||!i||ae(t).size===0)return;const s=i.getPointerPosition();if(!s)return;const r=i.getIntersection(s);if(r&&r.getParent()===n){e.destroyChildren(),e.batchDraw();return}const o=Array.from(ae(t).values()).map(a=>{const l=a.konvaShape,c=l?l.getAbsoluteTransform():null,h=[];for(let p=0;p<a.points.length;p+=2)if(c){const f=c.point({x:a.points[p],y:a.points[p+1]});h.push({x:f.x,y:f.y})}else h.push({x:a.points[p],y:a.points[p+1]});return{points:h}});if(o.length>0){const a=Rc(o,s);if(e.destroyChildren(),a.polygonIndex>=0&&a.distance<20){const l=Array.from(ae(t).values())[a.polygonIndex],c=l.points,h=l.konvaShape,p=h?h.getAbsoluteTransform():null,f=c[a.lineIndex*2],u=c[a.lineIndex*2+1],m=c[(a.lineIndex+1)*2%c.length],_=c[((a.lineIndex+1)*2+1)%c.length],S=p?p.point({x:f,y:u}):{x:f,y:u},C=p?p.point({x:m,y:_}):{x:m,y:_},g=(S.x+C.x)/2,d=(S.y+C.y)/2,y=new tt.Line({points:[S.x,S.y,C.x,C.y],stroke:"#00ff00",strokeWidth:4,opacity:.8});e.add(y);const b=new tt.Circle({x:g,y:d,radius:5,fill:"#00ff00",stroke:"#00aa00",strokeWidth:2,opacity:.9});e.add(b)}e.batchDraw()}},vr=t=>{const e=t.layers.polygonPreview,n=t.stage;if(!e||!n)return;if(e.destroyChildren(),t.polygon.currentPoints.value.length<4){if(t.polygon.currentPoints.value.length===2){const o=new tt.Circle({x:t.polygon.currentPoints.value[0],y:t.polygon.currentPoints.value[1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});e.add(o)}e.batchDraw();return}const i=n.getPointerPosition();if(!i)return;for(let o=0;o<t.polygon.currentPoints.value.length;o+=2){const a=new tt.Circle({x:t.polygon.currentPoints.value[o],y:t.polygon.currentPoints.value[o+1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});e.add(a)}const s=[...t.polygon.currentPoints.value,i.x,i.y],r=new tt.Line({points:s,stroke:"#999",strokeWidth:2,fill:"rgba(153, 153, 153, 0.1)",closed:!1,dash:[5,5],listening:!1});if(e.add(r),t.polygon.currentPoints.value.length>=6){const o=t.polygon.currentPoints.value[0],a=t.polygon.currentPoints.value[1],l=Math.sqrt((i.x-o)**2+(i.y-a)**2),c=new tt.Circle({x:o,y:a,radius:t.polygon.proximityThreshold,stroke:l<t.polygon.proximityThreshold?"#00ff00":"#ff0000",strokeWidth:2,fill:"transparent",listening:!1});e.add(c)}e.batchDraw()},Vs=t=>{const e=t.layers.polygonShapes,n=t.layers.polygonPreview;t.polygon.currentPoints.value.length<6||Ke(t,"Create Polygon",()=>{const i=`polygon-${Date.now()}`,s={id:i,points:[...t.polygon.currentPoints.value],closed:!0,creationTime:Date.now()},r=new tt.Line({points:s.points,stroke:"#000",strokeWidth:2,fill:"rgba(0, 100, 255, 0.1)",closed:!0,draggable:!1,id:i});_r(t,r),s.konvaShape=r,ae(t).set(i,s),e?.add(r),ks(t,r),t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],n?.destroyChildren(),un(t),Ie(t),e?.batchDraw(),n?.batchDraw(),xe(t)})},Lc=t=>{const e=t.layers.polygonPreview;t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],e?.destroyChildren(),e?.batchDraw()},un=t=>{const e=t.layers.polygonControls,n=t.layers.polygonShapes;e&&(e.destroyChildren(),t.polygon.mode.value==="edit"&&ae(t).forEach(i=>{i.controlPoints=[];for(let s=0;s<i.points.length;s+=2){const r=s,o=i.points[r],a=i.points[r+1];let l=o,c=a;if(i.konvaShape){const f=i.konvaShape.getAbsoluteTransform().point({x:o,y:a});l=f.x,c=f.y}const h=new tt.Circle({x:l,y:c,radius:6,fill:"#ff6600",stroke:"#ff4400",strokeWidth:2,draggable:!0,id:`${i.id}-control-${r/2}`});h.on("mouseenter",()=>{h.fill("#ffaa00"),h.radius(8),e?.batchDraw()}),h.on("mouseleave",()=>{h.fill("#ff6600"),h.radius(6),e?.batchDraw()}),h.on("dragstart",()=>{Us(t)}),h.on("dragmove",()=>{const p={x:h.x(),y:h.y()};if(i.konvaShape){const f=i.konvaShape.getAbsoluteTransform().copy();f.invert();const u=f.point(p);i.points[r]=u.x,i.points[r+1]=u.y}else i.points[r]=p.x,i.points[r+1]=p.y;i.konvaShape&&(i.konvaShape.points(i.points),n?.batchDraw())}),h.on("dragend",()=>{Bs(t,"Polygon Control Point"),Ie(t)}),i.controlPoints.push(h),e.add(h)}}),e.batchDraw())},Gc=t=>It(()=>t.polygon.mode.value,e=>{const n=t.layers.polygonControls,i=t.layers.polygonPreview;if(t.activeTool.value!=="polygon"){n?.destroyChildren(),n?.batchDraw();return}Gs(t),e==="draw"?(t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],i?.destroyChildren(),i?.batchDraw(),ae(t).forEach(s=>{s.konvaShape?.draggable(!1)})):e==="edit"&&(i?.destroyChildren(),i?.batchDraw(),ae(t).forEach(s=>{s.konvaShape?.draggable(!1)})),un(t),Gs(t)}),Ic=Object.freeze(Object.defineProperty({__proto__:null,attachPolygonHandlers:_r,clearCurrentPolygon:Lc,clearPolygonSelection:Gs,deserializePolygonState:Hs,finishPolygon:Vs,finishPolygonDragTracking:Bs,generateBakedPolygonData:Mc,getCurrentPolygonState:Is,getCurrentPolygonStateString:dn,handlePolygonClick:Dc,handlePolygonEditMouseMove:Oc,handlePolygonMouseMove:Nc,initPolygonLayers:Ec,restorePolygonState:Fc,serializePolygonState:Ie,setupPolygonModeWatcher:Gc,startPolygonDragTracking:Us,updateBakedPolygonData:xe,updatePolygonControlPoints:un,updatePolygonPreview:vr},Symbol.toStringTag,{value:"Module"})),G0=(t,e)=>{t.layers.transformerLayer=e;const n=new tt.Transformer({rotateEnabled:!0,keepRatio:!1,padding:6});return t.layers.transformer=n,n.on("transformstart",()=>{B0(t)}),n.on("transformend",()=>{H0(t,"Transform")}),e.add(n),It(t.selection.selectedKonvaNodes,i=>{U0(t,i)},{immediate:!0}),n};function I0(t,e){G0(t,e)}function U0(t,e){const n=t.layers.transformer,i=t.layers.transformerLayer;if(!n||!i)return;const s=e.filter(r=>!(r instanceof tt.Line&&t.polygon.mode.value==="edit"&&t.activeTool.value==="polygon"));n.nodes(s),i.batchDraw()}function B0(t){Promise.resolve().then(()=>Ac).then(({getCurrentFreehandStateString:e})=>{Promise.resolve().then(()=>Ic).then(({getCurrentPolygonStateString:n})=>{const i=JSON.stringify({freehand:e(t),polygon:n(t)});t.selection.transformStartState=i})})}function H0(t,e){const n=t.selection.transformStartState;n&&Promise.resolve().then(()=>Ac).then(({getCurrentFreehandStateString:i})=>{Promise.resolve().then(()=>Ic).then(({getCurrentPolygonStateString:s})=>{const r=JSON.stringify({freehand:i(t),polygon:s(t)});n!==r&&cr(t,e,n,r),t.selection.transformStartState=""})})}function V0(t,e){t.layers.selectionOverlay=e,t.selection.selectionRect=new tt.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),e.add(t.selection.selectionRect)}function z0(t,e,n){const i=e.getPointerPosition();if(!i)return;const s=r=>{let o=r;for(;o&&!(o instanceof tt.Stage);){if(o instanceof tt.Transformer)return!0;o=o.getParent()}return!1};if(!(n.target&&s(n.target))){if(n.target!==e){let r=n.target,o=r.getParent();for(;o&&!(o instanceof tt.Layer);)r=o,o=r.getParent();const a=fr(t,r);if(a){const l=Ql(t,a);n.evt.shiftKey?Cf(t,a,!0):l||(le(t),dr(t,a,!0)),Ql(t,a)&&Y0(t,e);return}}(n.target===e||n.target instanceof tt.Layer)&&(t.selection.dragSelectionState.value={isSelecting:!0,startPos:{x:i.x,y:i.y},currentPos:{x:i.x,y:i.y},isShiftHeld:n.evt.shiftKey},j0(t,i.x,i.y))}}function W0(t,e,n){if(t.selection.selectionDragState.isDragging){X0(t,e);return}if(!t.selection.dragSelectionState.value.isSelecting)return;const i=e.getPointerPosition();i&&(t.selection.dragSelectionState.value.currentPos={x:i.x,y:i.y},q0(t))}function $0(t,e,n){if(t.selection.selectionDragState.isDragging){J0(t);return}t.selection.dragSelectionState.value.isSelecting&&(K0(t,t.selection.dragSelectionState.value.isShiftHeld),t.selection.dragSelectionState.value.isSelecting=!1)}function j0(t,e,n){t.selection.selectionRect&&t.selection.selectionRect.setAttrs({x:e,y:n,width:0,height:0,visible:!1})}function q0(t){if(!t.selection.selectionRect||!t.selection.dragSelectionState.value.isSelecting)return;const{startPos:e,currentPos:n}=t.selection.dragSelectionState.value,i=Math.min(e.x,n.x),s=Math.min(e.y,n.y),r=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y);t.selection.selectionRect.setAttrs({x:i,y:s,width:r,height:o,visible:r>5||o>5}),t.layers.selectionOverlay?.batchDraw()}function K0(t,e=!1){if(!t.selection.selectionRect)return;const{startPos:n,currentPos:i}=t.selection.dragSelectionState.value,s=Math.abs(i.x-n.x),r=Math.abs(i.y-n.y);if(!(s>=5||r>=5)){e||le(t),t.selection.selectionRect.visible(!1),t.layers.selectionOverlay?.batchDraw();return}const a=[],l=t.selection.selectionRect.getClientRect(),c=f=>f instanceof tt.Transformer?!1:f instanceof tt.Path||f instanceof tt.Line||f instanceof tt.Group,h=[],p=t.layers.selectionOverlay?.getStage();if(p){const f=t.layers.freehandShape;f&&h.push(f);const u=t.layers.polygonShapes;u&&h.push(u),h.length===0&&p.getLayers().forEach(m=>{m.getChildren().some(S=>c(S))&&h.push(m)})}h.forEach(f=>{f.getChildren().forEach(u=>{if(!c(u))return;const m=u.getClientRect();if(!(l.x+l.width<m.x||m.x+m.width<l.x||l.y+l.height<m.y||m.y+m.height<l.y)){const _=fr(t,u);_&&a.push(_)}})}),e||(le(t),Ms(t)),a.forEach(f=>dr(t,f,!0)),t.selection.selectionRect.setAttrs({x:0,y:0,width:0,height:0,visible:!1}),t.layers.selectionOverlay?.batchDraw()}function Y0(t,e){const n=e.getPointerPosition();if(!n)return;t.selection.selectionDragState.isDragging=!0,t.selection.selectionDragState.startPos={x:n.x,y:n.y},t.selection.selectionDragState.startNodePositions.clear(),t.selection.selectionDragState.beforeState=JSON.stringify({freehand:Fe(t),polygon:dn(t)}),t.selection.selectedKonvaNodes.value.forEach(s=>{const r=s.getAbsolutePosition();t.selection.selectionDragState.startNodePositions.set(s,{x:r.x,y:r.y})})}function X0(t,e){const n=e.getPointerPosition();if(!n)return;const i=n.x-t.selection.selectionDragState.startPos.x,s=n.y-t.selection.selectionDragState.startPos.y;t.selection.selectionDragState.startNodePositions.forEach((o,a)=>{a.absolutePosition({x:o.x+i,y:o.y+s})});const r=new Set;t.selection.selectionDragState.startNodePositions.forEach((o,a)=>{let l=a.getParent();for(;l&&!(l instanceof tt.Layer);)l=l.getParent();l instanceof tt.Layer&&r.add(l)}),r.forEach(o=>o.batchDraw())}function J0(t){const e=JSON.stringify({freehand:Fe(t),polygon:dn(t)});t.selection.selectionDragState.beforeState!==e&&cr(t,"Move Selection",t.selection.selectionDragState.beforeState,e),t.selection.selectionDragState.isDragging=!1,t.selection.selectionDragState.startNodePositions.clear()}function Uc(t){return t.selection.selectedKonvaNodes.value}function Bc(t){let e=t;for(;e&&!(e instanceof tt.Layer);)e=e.getParent();return e instanceof tt.Layer?e:null}function Hc(t,e){const n=t.getAbsoluteTransform().copy();t.moveTo(e);const i=e.getAbsoluteTransform().copy();i.invert();const r=i.multiply(n).decompose();t.setAttrs({x:r.x,y:r.y,scaleX:r.scaleX,scaleY:r.scaleY,rotation:r.rotation,skewX:r.skewX,skewY:r.skewY})}function Vc(t){const e=Uc(t);if(e.length<1||e.some(s=>s instanceof tt.Line)||new Set(e.map(s=>Bc(s))).size!==1)return!1;const i=e.filter(s=>s instanceof tt.Path||s instanceof tt.Group);return!(i.length<1||kf(i))}function Q0(t){if(!Vc(t))return;const e=t.selection.selectedKonvaNodes.value.filter(n=>n instanceof tt.Path||n instanceof tt.Group);e.length<1||Ke(t,"Group Selection",()=>{const n=e.filter(a=>!e.some(l=>l!==a&&l.isAncestorOf(a))),i=Bc(n[0]);if(!i)return;let s=n[0].getParent();n.every(a=>a.getParent()===s)||(s=i);const r=new tt.Group({draggable:!1});s.add(r),n.forEach(a=>{Hc(a,r)});const o=Ts(t,r);le(t),dr(t,o),r.getLayer()?.batchDraw(),ge(t)})}function zc(t){const e=Uc(t);return e.length!==1||e[0]instanceof tt.Line?!1:e[0]instanceof tt.Group}function Z0(t){if(!zc(t))return;const e=t.selection.selectedKonvaNodes.value[0],n=e.getParent();n&&Ke(t,"Ungroup Selection",()=>{[...e.getChildren()].forEach(r=>{Hc(r,n),r.draggable(!1)});const s=e.id();e.destroy(),tc(t,s),le(t),n.getLayer()?.batchDraw();try{Ns(t)}catch{console.error("refreshStrokeConnections failed")}ge(t)})}function Wc(t){const e=t.selection.selectedKonvaNodes.value;return e.filter(n=>!e.some(i=>i!==n&&i.isAncestorOf(n)))}function tg(t){const e=t.layers.freehandShape;t.selection.selectedKonvaNodes.value.length!==0&&Ke(t,"Duplicate",()=>{Cs(t,()=>{const i=Wc(t),s=[];i.forEach(r=>{if(r instanceof tt.Path||r instanceof tt.Group){const o=mc(t,r,50,50),a=r.getParent();a&&a.add(o),s.push(o)}else if(r instanceof tt.Line){const o=r.clone({x:r.x()+50,y:r.y()+50}),a=_i("poly_");o.id(a);const l=r.getParent();l&&l.add(o),ks(t,o),_r(t,o),ae(t).set(a,{id:a,points:[...o.points()],closed:!!o.closed(),creationTime:Date.now(),konvaShape:o}),s.push(o)}}),le(t),s.forEach(r=>{const o=fr(t,r);o&&dr(t,o,!0)}),e?.batchDraw(),t.layers.polygonShapes?.batchDraw(),ge(t),xe(t),Ie(t)})})}function eg(t){const e=t.layers.freehandShape;t.selection.selectedKonvaNodes.value.length!==0&&Ke(t,"Delete Selected",()=>{Wc(t).forEach(s=>{const r=[],o=a=>{r.push(a),a instanceof tt.Container&&a.getChildren().forEach(l=>o(l))};o(s),r.forEach(a=>{a instanceof tt.Path&&(Xt(t).delete(a.id()),Array.from(Xt(t).entries()).forEach(([l,c])=>{c.shape===a&&Xt(t).delete(l)}),Array.from(vs(t).values()).forEach(l=>{l.strokeIds=l.strokeIds.filter(c=>c!==a.id())})),a instanceof tt.Group&&vs(t).delete(a.id()),a instanceof tt.Line&&ae(t).delete(a.id()),tc(t,a.id())}),s.destroy()}),le(t),e?.batchDraw(),t.layers.polygonShapes?.batchDraw(),ge(t),xe(t),Ie(t),Promise.resolve().then(()=>g0).then(({refreshAnciliaryViz:s})=>s(t)).catch(()=>{})})}const ng={class:"canvas-root"},ig={class:"control-panel"},rg=["disabled"],sg={class:"button-group vertical"},og=["disabled"],ag=["disabled"],lg={class:"button-group vertical"},cg=["disabled"],hg=["disabled"],dg={class:"button-group vertical"},ug=["disabled"],fg=["disabled"],gg=["disabled"],pg=["disabled"],mg={class:"button-group vertical"},yg=["disabled"],_g=["disabled"],vg={class:"button-group vertical"},bg=["disabled"],Sg=["disabled"],xg=["disabled"],wg=["disabled"],Cg=["disabled"],Pg=["disabled"],Tg=["disabled"],kg={key:0,class:"info"},Ag={class:"info"},Rg={class:"canvas-wrapper"},Eg={key:0,class:"metadata-suite"},Mg={key:0,class:"animation-lock-warning"},Fg=vi(rn({__name:"CanvasRoot",props:{syncState:{type:Function},initialFreehandState:{default:"",type:String},initialPolygonState:{default:"",type:String},width:{default:1e3,type:[Number,String]},height:{default:500,type:[Number,String]},showTimeline:{type:Boolean,default:!1},showVisualizations:{type:Boolean,default:!1}},emits:["state-update"],setup(t,{emit:e}){const n=t,i=e,s=Nt(()=>{const B=Number(n.width),U=Number(n.height);return{width:Number.isFinite(B)?B:1e3,height:Number.isFinite(U)?U:500}}),r=mf(),o=N0(r);let a;const l=r.activeTool,c=r.metadata.showEditor,h=B=>B==null?B:typeof structuredClone=="function"?structuredClone(B):JSON.parse(JSON.stringify(B)),p=B=>B?h(St(B))??[]:[],f=B=>B?h(St(B))??[]:[],u=B=>B?h(St(B))??{}:{},m=B=>{const U=p(B.freehand.bakedRenderData),Z=u(B.freehand.bakedGroupMap),nt=f(B.polygon.bakedRenderData);return{freehand:{serializedState:B.freehand.serializedState??"",bakedRenderData:U??[],bakedGroupMap:Z??{}},polygon:{serializedState:B.polygon.serializedState??"",bakedRenderData:nt??[]}}},_=B=>{const U=m(B);n.syncState?.(U),i("state-update",U)};r.callbacks.syncAppState=_,It(()=>n.syncState,()=>{_(r)},{immediate:!0});const S=B=>V0(r,B),C=(B,U)=>z0(r,B,U),g=(B,U)=>W0(r,B),d=(B,U)=>$0(r),y=()=>Q0(r),b=()=>Z0(r),k=()=>tg(r),D=()=>eg(r),x=Nt(()=>Vc(r)),w=Nt(()=>zc(r)),T=(B,U)=>kc(r,B,U),M=()=>Os(r),L=()=>Ms(r),I=B=>Ls(r,B),V=()=>Pc(r),G=()=>Tc(r),X=()=>un(r),v=B=>Dc(r,B),P=()=>Nc(r),E=()=>Oc(r),R=()=>Vs(r),O=()=>Lc(r),j=()=>Gc(r),H=r.selection.selectedKonvaNodes,J=Nt(()=>Pf(r)),st=Nt(()=>cn(r)>1),$=Nt(()=>{const B=H.value;return B.length===1&&B[0]instanceof tt.Group});r.callbacks.refreshAncillaryViz=()=>Ye(r);const F=()=>{const B=Fe(r),U=dn(r);return JSON.stringify({freehand:B,polygon:U})},W=B=>{if(B)try{const U=JSON.parse(B);U.freehand&&wc(r,U.freehand,{handleTimeUpdate:I}),U.polygon&&Fc(r,U.polygon)}catch(U){console.warn("Failed to restore canvas state:",U)}},et=Tt(!1),it=Tt(!1),ht=()=>{ge(r),xe(r),Ye(r),et.value=A.canUndo(),it.value=A.canRedo()},A=new pf(F,W,ht);r.command.stack=A,et.value=A.canUndo(),it.value=A.canRedo();const N=(B,U)=>A.executeCommand(B,U),z=()=>A.undo(),q=()=>A.redo();r.command.executeCommand=N,r.command.pushCommand=(B,U,Z)=>{A.pushCommand(B,U,Z)};const Y=B=>{r.freehand.isAnimating.value=B;const U=r.stage;U&&(B?U.listening(!1):U.listening(!0))},K=Tt(),Q=(B,U)=>{const Z=B.layers.freehandShape,nt=B.layers.freehandDrawing,at=B.layers.transformerLayer??B.layers.freehandSelection,dt=B.stage;le(B),U==="select"?(Z?.listening(!0),B.layers.polygonShapes?.listening(!0),nt?.listening(!1),B.layers.polygonPreview?.listening(!1),B.layers.polygonControls?.listening(!1),at?.listening(!0),B.layers.polygonSelection?.listening(!0),at?.moveToTop(),dt&&pc(r,dt).moveToTop()):U==="freehand"?(Z?.listening(!0),nt?.listening(!0),at?.listening(!0),B.layers.polygonShapes?.listening(!1),B.layers.polygonPreview?.listening(!1),B.layers.polygonControls?.listening(!1),B.layers.polygonSelection?.listening(!1)):U==="polygon"&&(B.layers.polygonShapes?.listening(!0),B.layers.polygonPreview?.listening(!0),B.layers.polygonControls?.listening(!0),B.layers.polygonSelection?.listening(!0),Z?.listening(!1),nt?.listening(!1),at?.listening(!1)),U==="polygon"&&B.polygon.mode.value==="edit"?X():(B.layers.polygonControls?.destroyChildren(),B.layers.polygonControls?.batchDraw()),(pt=>{Z?.getChildren().forEach(ot=>{(ot instanceof tt.Path||ot instanceof tt.Group)&&ot.draggable(pt)}),B.layers.polygonShapes?.getChildren().forEach(ot=>{(ot instanceof tt.Line||ot instanceof tt.Group)&&ot.draggable(pt)})})(!1),dt?.batchDraw()};It(l,B=>{Q(r,B)},{immediate:!0});const rt=(B,U)=>{try{const Z=fr(r,B);Z?Tf(r,Z,U):(B.setAttr("metadata",U===void 0||Object.keys(U).length===0?void 0:U),ge(r),xe(r))}catch{B.setAttr("metadata",U===void 0||Object.keys(U).length===0?void 0:U),ge(r),xe(r)}};return Bo(async()=>{try{if(!K.value){console.error("Konva container ref not found");return}const B=s.value,U=new tt.Stage({container:K.value,width:B.width,height:B.height});r.stage=U,r.konvaContainer=K.value;const Z=()=>{K.value&&(K.value.style.cursor=l.value==="freehand"?"crosshair":"default")};r.callbacks.updateCursor=Z,r.callbacks.updateCursor?.(),yc(r,U),Ec(r,U);const nt=r.layers.freehandSelection;if(!nt){console.error("Freehand selection layer not initialized");return}I0(r,nt);const at=r.layers.transformerLayer??nt;S(at);const dt=pc(r,U);r.layers.transformerLayer?.moveToTop(),dt.moveToTop(),ac(r),Q(r,l.value),l.value==="polygon"&&r.polygon.mode.value==="edit"&&X(),r.callbacks.updateCursor?.();const ut=ot=>{!ot||ot===r.freehand.serializedState||yr(r,ot)},pt=ot=>{!ot||ot===r.polygon.serializedState||Hs(r,ot)};ut(n.initialFreehandState),pt(n.initialPolygonState),It(()=>n.initialFreehandState,ot=>{ut(ot)}),It(()=>n.initialPolygonState,ot=>{pt(ot)}),It(()=>[n.width,n.height],([ot,vt])=>{const mt=Number(ot),xt=Number(vt),Et=Number.isFinite(mt)?mt:s.value.width,Jt=Number.isFinite(xt)?xt:s.value.height,Vt=r.stage;Vt&&(Vt.width(Et),Vt.height(Jt),Vt.batchDraw()),r.konvaContainer&&(r.konvaContainer.style.width=`${Et}px`,r.konvaContainer.style.height=`${Jt}px`)},{immediate:!0}),Q(r,l.value),_(r),U.on("mousedown touchstart",ot=>{const vt=U.getPointerPosition();vt&&(l.value==="select"?C(U,ot):l.value==="freehand"?(r.freehand.isDrawing=!0,r.freehand.currentPoints=[vt.x,vt.y],r.freehand.drawingStartTime=performance.now(),r.freehand.currentTimestamps=[0],le(r)):l.value==="polygon"&&(ot.target.getParent?.()===r.layers.polygonControls||v(vt)))}),U.on("mousemove touchmove",ot=>{const vt=r.layers.freehandDrawing;if(l.value==="select")g(U,ot);else if(l.value==="freehand"){if(r.freehand.isDrawing){const mt=U.getPointerPosition();if(!mt)return;r.freehand.currentPoints.push(mt.x,mt.y),r.freehand.currentTimestamps.push(performance.now()-r.freehand.drawingStartTime),vt?.destroyChildren();const xt=new tt.Path({data:wi(r.freehand.currentPoints),fill:"#666",strokeWidth:0});vt?.add(xt),vt?.batchDraw()}}else l.value==="polygon"&&(r.polygon.mode.value==="draw"&&r.polygon.isDrawing.value?P():r.polygon.mode.value==="edit"&&E())}),U.on("mouseup touchend",ot=>{const vt=r.layers.freehandDrawing;l.value==="freehand"&&r.freehand.isDrawing?(r.freehand.isDrawing=!1,vt?.destroyChildren(),r.freehand.currentPoints.length>2&&N("Draw Stroke",()=>{const mt=r.layers.freehandShape,xt=Date.now(),Et=`stroke-${xt}`,Jt=ur(r.freehand.currentPoints),Vt=[];for(let br=0;br<r.freehand.currentPoints.length;br+=2)Vt.push(r.freehand.currentPoints[br]-Jt.minX),Vt.push(r.freehand.currentPoints[br+1]-Jt.minY);const Ut=wi(Vt),qt={id:Et,points:r.freehand.currentPoints,timestamps:r.freehand.currentTimestamps,originalPath:Ut,creationTime:xt,isFreehand:!0},Ci=T(r.freehand.currentPoints,Et);qt.shape=Ci,Xt(r).set(Et,qt),mt?.add(Ci),M(),L(),mt?.batchDraw(),ge(r)}),r.freehand.currentPoints=[],r.freehand.currentTimestamps=[]):d(U,ot)}),j(),a=Ef(r,"Escape",ot=>{l.value==="polygon"&&r.polygon.isDrawing.value&&(r.polygon.currentPoints.value.length>=6?R():O())})}catch(B){console.warn(B)}}),Cn(()=>{console.log("disposing livecoded resources"),Cc(r),Ie(r),a?.(),a=void 0,r.keyboardDisposables.splice(0).forEach(B=>B()),r.stage?.destroy()}),(B,U)=>(Ct(),kt("div",ng,[lt("div",ig,[Lo(lt("select",{"onUpdate:modelValue":U[0]||(U[0]=Z=>Lt(l)?l.value=Z:null),disabled:ct(r).freehand.isAnimating.value,class:"tool-dropdown"},U[7]||(U[7]=[lt("option",{value:"select"},"👆 Select",-1),lt("option",{value:"freehand"},"✏️ Freehand",-1),lt("option",{value:"polygon"},"⬟ Polygon",-1)]),8,rg),[[_u,ct(l)]]),U[15]||(U[15]=lt("span",{class:"separator"},"|",-1)),lt("div",sg,[lt("button",{onClick:z,disabled:!et.value||ct(r).freehand.isAnimating.value,title:"Undo (Ctrl/Cmd+Z)"}," ↶ Undo ",8,og),lt("button",{onClick:q,disabled:!it.value||ct(r).freehand.isAnimating.value,title:"Redo (Ctrl/Cmd+Shift+Z)"}," ↷ Redo ",8,ag)]),U[16]||(U[16]=lt("span",{class:"separator"},"|",-1)),ct(l)==="select"?(Ct(),kt($t,{key:0},[lt("div",lg,[lt("button",{onClick:y,disabled:!x.value||ct(r).freehand.isAnimating.value}," Group ",8,cg),lt("button",{onClick:b,disabled:!w.value||ct(r).freehand.isAnimating.value}," Ungroup ",8,hg)]),U[8]||(U[8]=lt("span",{class:"separator"},"|",-1)),lt("div",dg,[lt("button",{onClick:k,disabled:cn(ct(r))===0||ct(r).freehand.isAnimating.value}," 📄 Duplicate ",8,ug),lt("button",{onClick:D,disabled:cn(ct(r))===0||ct(r).freehand.isAnimating.value}," 🗑️ Delete ",8,fg)]),U[9]||(U[9]=lt("span",{class:"separator"},"|",-1)),lt("button",{onClick:U[1]||(U[1]=Z=>c.value=!ct(c)),class:ye({active:ct(c)}),disabled:ct(r).freehand.isAnimating.value}," 📝 Metadata ",10,gg),U[10]||(U[10]=lt("span",{class:"separator"},"|",-1))],64)):Kt("",!0),ct(l)==="freehand"?(Ct(),kt($t,{key:1},[lt("button",{onClick:U[2]||(U[2]=Z=>ct(r).freehand.showGrid.value=!ct(r).freehand.showGrid.value),class:ye({active:ct(r).freehand.showGrid.value}),disabled:ct(r).freehand.isAnimating.value},Zt(ct(r).freehand.showGrid.value?"⊞ Grid On":"⊡ Grid Off"),11,pg),lt("div",mg,[lt("button",{onClick:k,disabled:cn(ct(r))===0||ct(r).freehand.isAnimating.value}," 📄 Duplicate ",8,yg),lt("button",{onClick:D,disabled:cn(ct(r))===0||ct(r).freehand.isAnimating.value}," 🗑️ Delete ",8,_g)]),U[11]||(U[11]=lt("span",{class:"separator"},"|",-1)),lt("button",{onClick:U[3]||(U[3]=Z=>ct(r).freehand.useRealTiming.value=!ct(r).freehand.useRealTiming.value),class:ye({active:ct(r).freehand.useRealTiming.value})},Zt(ct(r).freehand.useRealTiming.value?"⏱️ Real Time":"⏱️ Max 0.3s"),3),U[12]||(U[12]=lt("span",{class:"separator"},"|",-1)),lt("div",vg,[lt("button",{onClick:V,disabled:ct(r).freehand.isAnimating.value}," 💾 Download ",8,bg),lt("button",{onClick:G,disabled:ct(r).freehand.isAnimating.value}," 📁 Upload ",8,Sg)])],64)):Kt("",!0),ct(l)==="polygon"?(Ct(),kt($t,{key:2},[lt("button",{onClick:U[4]||(U[4]=Z=>ct(r).polygon.mode.value="draw"),class:ye({active:ct(r).polygon.mode.value==="draw"}),disabled:ct(r).freehand.isAnimating.value}," ✏️ New Shape ",10,xg),lt("button",{onClick:U[5]||(U[5]=Z=>ct(r).polygon.mode.value="edit"),class:ye({active:ct(r).polygon.mode.value==="edit"}),disabled:ct(r).freehand.isAnimating.value}," ✏️ Edit Shape ",10,wg),lt("button",{onClick:U[6]||(U[6]=Z=>ct(r).freehand.showGrid.value=!ct(r).freehand.showGrid.value),class:ye({active:ct(r).freehand.showGrid.value}),disabled:ct(r).freehand.isAnimating.value},Zt(ct(r).freehand.showGrid.value?"⊞ Grid On":"⊡ Grid Off"),11,Cg),U[13]||(U[13]=lt("span",{class:"separator"},"|",-1)),lt("button",{onClick:O,disabled:!ct(r).polygon.isDrawing.value||ct(r).freehand.isAnimating.value}," 🗑️ Cancel Shape ",8,Pg),lt("button",{onClick:D,disabled:Ps(ct(r))||ct(r).freehand.isAnimating.value}," 🗑️ Delete ",8,Tg),U[14]||(U[14]=lt("span",{class:"separator"},"|",-1)),ct(r).polygon.isDrawing.value?(Ct(),kt("span",kg,"Drawing: "+Zt(ct(r).polygon.currentPoints.value.length/2)+" points",1)):Kt("",!0)],64)):Kt("",!0),U[17]||(U[17]=lt("span",{class:"separator"},"|",-1)),lt("span",Ag,Zt(cn(ct(r)))+" selected",1)]),lt("div",Rg,[lt("div",{ref_key:"konvaContainer",ref:K,class:"konva-container",style:Ue({width:s.value.width+"px",height:s.value.height+"px"})},null,4),ct(c)?(Ct(),kt("div",Eg,[n.showVisualizations?(Ct(),Qi(_0,{key:0,"canvas-state":ct(r)},null,8,["canvas-state"])):Kt("",!0),oe(l0,{"selected-nodes":ct(H),"single-node":J.value,"multi-selected":st.value,"group-selected":$.value,"collect-hierarchy-from-root":ct(o).collectHierarchyFromRoot,"update-metadata-highlight":ct(o).updateMetadataHighlight,"update-hover-highlight":ct(o).updateHoverHighlight,"on-apply-metadata":rt},null,8,["selected-nodes","single-node","multi-selected","group-selected","collect-hierarchy-from-root","update-metadata-highlight","update-hover-highlight"])])):Kt("",!0),n.showTimeline?(Ct(),kt($t,{key:1},[oe(Bf,{strokes:ct(Xt)(ct(r)),selectedStrokes:ct(r).freehand.selectedStrokesForTimeline.value,useRealTiming:ct(r).freehand.useRealTiming.value,maxInterStrokeDelay:ct(mr),overrideDuration:ct(r).freehand.timelineDuration.value>0?ct(r).freehand.timelineDuration.value:void 0,lockWhileAnimating:Y,onTimeUpdate:I},null,8,["strokes","selectedStrokes","useRealTiming","maxInterStrokeDelay","overrideDuration"]),ct(r).freehand.isAnimating.value?(Ct(),kt("div",Mg," ⚠️ Timeline has modified elements - press Stop to unlock ")):Kt("",!0)],64)):Kt("",!0)])]))}}),[["styles",[".canvas-root[data-v-145547ca]{display:flex;flex-direction:column;align-items:center;gap:20px;padding:20px}.control-panel[data-v-145547ca]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:10px 15px;display:flex;align-items:center;gap:10px;box-shadow:0 2px 10px #0000001a}.canvas-wrapper[data-v-145547ca]{display:flex;flex-direction:column;align-items:center;gap:20px}.control-panel button[data-v-145547ca]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 15px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-145547ca]:hover:not(:disabled){background:#e0e0e0}.control-panel button.active[data-v-145547ca]{background:#06f;color:#fff;border-color:#06f}.control-panel button[data-v-145547ca]:disabled{opacity:.5;cursor:not-allowed}.button-group.vertical[data-v-145547ca]{display:flex;flex-direction:column;gap:2px}.button-group.vertical button[data-v-145547ca]{margin:0;padding:3px 10px;font-size:12px}.tool-dropdown[data-v-145547ca]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 10px;font-size:14px;cursor:pointer;transition:all .2s}.tool-dropdown[data-v-145547ca]:hover{background:#e0e0e0}.tool-dropdown[data-v-145547ca]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-145547ca]{color:#ccc}.info[data-v-145547ca]{color:#666;font-size:14px}.animation-lock-warning[data-v-145547ca]{color:#e67e22;font-size:14px;font-weight:700;text-align:center;background:#fef5e7;border:1px solid #f39c12;border-radius:4px;padding:8px 15px;animation:pulse-145547ca 2s infinite}@keyframes pulse-145547ca{0%,to{opacity:1}50%{opacity:.6}}.konva-container[data-v-145547ca]{background-color:#fff;border:1px solid black}.metadata-suite[data-v-145547ca]{display:flex;flex-direction:column;gap:8px;max-width:600px}"]],["__scopeId","data-v-145547ca"]]),$c="handwriting-canvas",zs=gu(Fg);return customElements.get($c)||customElements.define($c,zs),Pi.CanvasElement=zs,Pi.default=zs,Object.defineProperties(Pi,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),Pi}({});
