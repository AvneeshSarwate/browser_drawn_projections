var HandwritingCanvas=function(mr){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Rs(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const Ge={},Ln=[],Gt=()=>{},hh=()=>!1,yr=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Ms=e=>e.startsWith("onUpdate:"),Ze=Object.assign,Ds=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},fh=Object.prototype.hasOwnProperty,Oe=(e,t)=>fh.call(e,t),me=Array.isArray,In=e=>ei(e)==="[object Map]",vr=e=>ei(e)==="[object Set]",_a=e=>ei(e)==="[object Date]",be=e=>typeof e=="function",We=e=>typeof e=="string",zt=e=>typeof e=="symbol",ze=e=>e!==null&&typeof e=="object",ba=e=>(ze(e)||be(e))&&be(e.then)&&be(e.catch),Sa=Object.prototype.toString,ei=e=>Sa.call(e),ph=e=>ei(e).slice(8,-1),_r=e=>ei(e)==="[object Object]",Os=e=>We(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,ti=Rs(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),br=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},gh=/-(\w)/g,ht=br(e=>e.replace(gh,(t,n)=>n?n.toUpperCase():"")),mh=/\B([A-Z])/g,xt=br(e=>e.replace(mh,"-$1").toLowerCase()),Sr=br(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ns=br(e=>e?`on${Sr(e)}`:""),an=(e,t)=>!Object.is(e,t),wr=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},wa=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},xr=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Fs=e=>{const t=We(e)?Number(e):NaN;return isNaN(t)?e:t};let xa;const Ca=()=>xa||(xa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function _n(e){if(me(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],s=We(i)?bh(i):_n(i);if(s)for(const o in s)t[o]=s[o]}return t}else if(We(e)||ze(e))return e}const yh=/;(?![^(]*\))/g,vh=/:([^]+)/,_h=/\/\*[^]*?\*\//g;function bh(e){const t={};return e.replace(_h,"").split(yh).forEach(n=>{if(n){const i=n.split(vh);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Rt(e){let t="";if(We(e))t=e;else if(me(e))for(let n=0;n<e.length;n++){const i=Rt(e[n]);i&&(t+=i+" ")}else if(ze(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const Sh=Rs("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function ka(e){return!!e||e===""}function wh(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=Cr(e[i],t[i]);return n}function Cr(e,t){if(e===t)return!0;let n=_a(e),i=_a(t);if(n||i)return n&&i?e.getTime()===t.getTime():!1;if(n=zt(e),i=zt(t),n||i)return e===t;if(n=me(e),i=me(t),n||i)return n&&i?wh(e,t):!1;if(n=ze(e),i=ze(t),n||i){if(!n||!i)return!1;const s=Object.keys(e).length,o=Object.keys(t).length;if(s!==o)return!1;for(const r in e){const a=e.hasOwnProperty(r),l=t.hasOwnProperty(r);if(a&&!l||!a&&l||!Cr(e[r],t[r]))return!1}}return String(e)===String(t)}function xh(e,t){return e.findIndex(n=>Cr(n,t))}const Pa=e=>!!(e&&e.__v_isRef===!0),Fe=e=>We(e)?e:e==null?"":me(e)||ze(e)&&(e.toString===Sa||!be(e.toString))?Pa(e)?Fe(e.value):JSON.stringify(e,Ta,2):String(e),Ta=(e,t)=>Pa(t)?Ta(e,t.value):In(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,s],o)=>(n[Ls(i,o)+" =>"]=s,n),{})}:vr(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>Ls(n))}:zt(t)?Ls(t):ze(t)&&!me(t)&&!_r(t)?String(t):t,Ls=(e,t="")=>{var n;return zt(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let bt;class Ch{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=bt,!t&&bt&&(this.index=(bt.scopes||(bt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=bt;try{return bt=this,t()}finally{bt=n}}}on(){bt=this}off(){bt=this.parent}stop(t){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function kh(){return bt}let $e;const Is=new WeakSet;class Ea{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,bt&&bt.active&&bt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Is.has(this)&&(Is.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ra(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Fa(this),Ma(this);const t=$e,n=Mt;$e=this,Mt=!0;try{return this.fn()}finally{Da(this),$e=t,Mt=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)$s(t);this.deps=this.depsTail=void 0,Fa(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Is.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Us(this)&&this.run()}get dirty(){return Us(this)}}let Aa=0,ni,ii;function Ra(e,t=!1){if(e.flags|=8,t){e.next=ii,ii=e;return}e.next=ni,ni=e}function Gs(){Aa++}function zs(){if(--Aa>0)return;if(ii){let t=ii;for(ii=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;ni;){let t=ni;for(ni=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=n}}if(e)throw e}function Ma(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Da(e){let t,n=e.depsTail,i=n;for(;i;){const s=i.prevDep;i.version===-1?(i===n&&(n=s),$s(i),Ph(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}e.deps=t,e.depsTail=n}function Us(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Oa(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Oa(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===ri))return;e.globalVersion=ri;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Us(e)){e.flags&=-3;return}const n=$e,i=Mt;$e=e,Mt=!0;try{Ma(e);const s=e.fn(e._value);(t.version===0||an(s,e._value))&&(e._value=s,t.version++)}catch(s){throw t.version++,s}finally{$e=n,Mt=i,Da(e),e.flags&=-3}}function $s(e,t=!1){const{dep:n,prevSub:i,nextSub:s}=e;if(i&&(i.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=i,e.nextSub=void 0),n.subs===e&&(n.subs=i),!n.subs&&n.computed){n.computed.flags&=-5;for(let o=n.computed.deps;o;o=o.nextDep)$s(o,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Ph(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Mt=!0;const Na=[];function Wt(){Na.push(Mt),Mt=!1}function Kt(){const e=Na.pop();Mt=e===void 0?!0:e}function Fa(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=$e;$e=void 0;try{t()}finally{$e=n}}}let ri=0;class Th{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Vs{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!$e||!Mt||$e===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==$e)n=this.activeLink=new Th($e,this),$e.deps?(n.prevDep=$e.depsTail,$e.depsTail.nextDep=n,$e.depsTail=n):$e.deps=$e.depsTail=n,La(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=$e.depsTail,n.nextDep=void 0,$e.depsTail.nextDep=n,$e.depsTail=n,$e.deps===n&&($e.deps=i)}return n}trigger(t){this.version++,ri++,this.notify(t)}notify(t){Gs();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{zs()}}}function La(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)La(i)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const Bs=new WeakMap,bn=Symbol(""),Hs=Symbol(""),si=Symbol("");function ct(e,t,n){if(Mt&&$e){let i=Bs.get(e);i||Bs.set(e,i=new Map);let s=i.get(n);s||(i.set(n,s=new Vs),s.map=i,s.key=n),s.track()}}function qt(e,t,n,i,s,o){const r=Bs.get(e);if(!r){ri++;return}const a=l=>{l&&l.trigger()};if(Gs(),t==="clear")r.forEach(a);else{const l=me(e),c=l&&Os(n);if(l&&n==="length"){const d=Number(i);r.forEach((f,p)=>{(p==="length"||p===si||!zt(p)&&p>=d)&&a(f)})}else switch(n!==void 0&&a(r.get(n)),c&&a(r.get(si)),t){case"add":l?c&&a(r.get("length")):(a(r.get(bn)),In(e)&&a(r.get(Hs)));break;case"delete":l||(a(r.get(bn)),In(e)&&a(r.get(Hs)));break;case"set":In(e)&&a(r.get(bn));break}}zs()}function Gn(e){const t=Pe(e);return t===e?t:(ct(t,"iterate",si),Ct(e)?t:t.map(dt))}function kr(e){return ct(e=Pe(e),"iterate",si),e}const Eh={__proto__:null,[Symbol.iterator](){return js(this,Symbol.iterator,dt)},concat(...e){return Gn(this).concat(...e.map(t=>me(t)?Gn(t):t))},entries(){return js(this,"entries",e=>(e[1]=dt(e[1]),e))},every(e,t){return Yt(this,"every",e,t,void 0,arguments)},filter(e,t){return Yt(this,"filter",e,t,n=>n.map(dt),arguments)},find(e,t){return Yt(this,"find",e,t,dt,arguments)},findIndex(e,t){return Yt(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Yt(this,"findLast",e,t,dt,arguments)},findLastIndex(e,t){return Yt(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Yt(this,"forEach",e,t,void 0,arguments)},includes(...e){return Ws(this,"includes",e)},indexOf(...e){return Ws(this,"indexOf",e)},join(e){return Gn(this).join(e)},lastIndexOf(...e){return Ws(this,"lastIndexOf",e)},map(e,t){return Yt(this,"map",e,t,void 0,arguments)},pop(){return oi(this,"pop")},push(...e){return oi(this,"push",e)},reduce(e,...t){return Ia(this,"reduce",e,t)},reduceRight(e,...t){return Ia(this,"reduceRight",e,t)},shift(){return oi(this,"shift")},some(e,t){return Yt(this,"some",e,t,void 0,arguments)},splice(...e){return oi(this,"splice",e)},toReversed(){return Gn(this).toReversed()},toSorted(e){return Gn(this).toSorted(e)},toSpliced(...e){return Gn(this).toSpliced(...e)},unshift(...e){return oi(this,"unshift",e)},values(){return js(this,"values",dt)}};function js(e,t,n){const i=kr(e),s=i[t]();return i!==e&&!Ct(e)&&(s._next=s.next,s.next=()=>{const o=s._next();return o.value&&(o.value=n(o.value)),o}),s}const Ah=Array.prototype;function Yt(e,t,n,i,s,o){const r=kr(e),a=r!==e&&!Ct(e),l=r[t];if(l!==Ah[t]){const f=l.apply(e,o);return a?dt(f):f}let c=n;r!==e&&(a?c=function(f,p){return n.call(this,dt(f),p,e)}:n.length>2&&(c=function(f,p){return n.call(this,f,p,e)}));const d=l.call(r,c,i);return a&&s?s(d):d}function Ia(e,t,n,i){const s=kr(e);let o=n;return s!==e&&(Ct(e)?n.length>3&&(o=function(r,a,l){return n.call(this,r,a,l,e)}):o=function(r,a,l){return n.call(this,r,dt(a),l,e)}),s[t](o,...i)}function Ws(e,t,n){const i=Pe(e);ct(i,"iterate",si);const s=i[t](...n);return(s===-1||s===!1)&&Ys(n[0])?(n[0]=Pe(n[0]),i[t](...n)):s}function oi(e,t,n=[]){Wt(),Gs();const i=Pe(e)[t].apply(e,n);return zs(),Kt(),i}const Rh=Rs("__proto__,__v_isRef,__isVue"),Ga=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(zt));function Mh(e){zt(e)||(e=String(e));const t=Pe(this);return ct(t,"has",e),t.hasOwnProperty(e)}class za{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,i){const s=this._isReadonly,o=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return o;if(n==="__v_raw")return i===(s?o?Ya:qa:o?Ka:Wa).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const r=me(t);if(!s){let l;if(r&&(l=Eh[n]))return l;if(n==="hasOwnProperty")return Mh}const a=Reflect.get(t,n,Qe(t)?t:i);return(zt(n)?Ga.has(n):Rh(n))||(s||ct(t,"get",n),o)?a:Qe(a)?r&&Os(n)?a:a.value:ze(a)?s?Za(a):qs(a):a}}class Ua extends za{constructor(t=!1){super(!1,t)}set(t,n,i,s){let o=t[n];if(!this._isShallow){const l=Sn(o);if(!Ct(i)&&!Sn(i)&&(o=Pe(o),i=Pe(i)),!me(t)&&Qe(o)&&!Qe(i))return l?!1:(o.value=i,!0)}const r=me(t)&&Os(n)?Number(n)<t.length:Oe(t,n),a=Reflect.set(t,n,i,Qe(t)?t:s);return t===Pe(s)&&(r?an(i,o)&&qt(t,"set",n,i):qt(t,"add",n,i)),a}deleteProperty(t,n){const i=Oe(t,n);t[n];const s=Reflect.deleteProperty(t,n);return s&&i&&qt(t,"delete",n,void 0),s}has(t,n){const i=Reflect.has(t,n);return(!zt(n)||!Ga.has(n))&&ct(t,"has",n),i}ownKeys(t){return ct(t,"iterate",me(t)?"length":bn),Reflect.ownKeys(t)}}class $a extends za{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const Dh=new Ua,Oh=new $a,Nh=new Ua(!0),Fh=new $a(!0),Ks=e=>e,Pr=e=>Reflect.getPrototypeOf(e);function Tr(e,t,n=!1,i=!1){e=e.__v_raw;const s=Pe(e),o=Pe(t);n||(an(t,o)&&ct(s,"get",t),ct(s,"get",o));const{has:r}=Pr(s),a=i?Ks:n?Xs:dt;if(r.call(s,t))return a(e.get(t));if(r.call(s,o))return a(e.get(o));e!==s&&e.get(t)}function Er(e,t=!1){const n=this.__v_raw,i=Pe(n),s=Pe(e);return t||(an(e,s)&&ct(i,"has",e),ct(i,"has",s)),e===s?n.has(e):n.has(e)||n.has(s)}function Ar(e,t=!1){return e=e.__v_raw,!t&&ct(Pe(e),"iterate",bn),Reflect.get(e,"size",e)}function Va(e,t=!1){!t&&!Ct(e)&&!Sn(e)&&(e=Pe(e));const n=Pe(this);return Pr(n).has.call(n,e)||(n.add(e),qt(n,"add",e,e)),this}function Ba(e,t,n=!1){!n&&!Ct(t)&&!Sn(t)&&(t=Pe(t));const i=Pe(this),{has:s,get:o}=Pr(i);let r=s.call(i,e);r||(e=Pe(e),r=s.call(i,e));const a=o.call(i,e);return i.set(e,t),r?an(t,a)&&qt(i,"set",e,t):qt(i,"add",e,t),this}function Ha(e){const t=Pe(this),{has:n,get:i}=Pr(t);let s=n.call(t,e);s||(e=Pe(e),s=n.call(t,e)),i&&i.call(t,e);const o=t.delete(e);return s&&qt(t,"delete",e,void 0),o}function ja(){const e=Pe(this),t=e.size!==0,n=e.clear();return t&&qt(e,"clear",void 0,void 0),n}function Rr(e,t){return function(i,s){const o=this,r=o.__v_raw,a=Pe(r),l=t?Ks:e?Xs:dt;return!e&&ct(a,"iterate",bn),r.forEach((c,d)=>i.call(s,l(c),l(d),o))}}function Mr(e,t,n){return function(...i){const s=this.__v_raw,o=Pe(s),r=In(o),a=e==="entries"||e===Symbol.iterator&&r,l=e==="keys"&&r,c=s[e](...i),d=n?Ks:t?Xs:dt;return!t&&ct(o,"iterate",l?Hs:bn),{next(){const{value:f,done:p}=c.next();return p?{value:f,done:p}:{value:a?[d(f[0]),d(f[1])]:d(f),done:p}},[Symbol.iterator](){return this}}}}function ln(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Lh(){const e={get(o){return Tr(this,o)},get size(){return Ar(this)},has:Er,add:Va,set:Ba,delete:Ha,clear:ja,forEach:Rr(!1,!1)},t={get(o){return Tr(this,o,!1,!0)},get size(){return Ar(this)},has:Er,add(o){return Va.call(this,o,!0)},set(o,r){return Ba.call(this,o,r,!0)},delete:Ha,clear:ja,forEach:Rr(!1,!0)},n={get(o){return Tr(this,o,!0)},get size(){return Ar(this,!0)},has(o){return Er.call(this,o,!0)},add:ln("add"),set:ln("set"),delete:ln("delete"),clear:ln("clear"),forEach:Rr(!0,!1)},i={get(o){return Tr(this,o,!0,!0)},get size(){return Ar(this,!0)},has(o){return Er.call(this,o,!0)},add:ln("add"),set:ln("set"),delete:ln("delete"),clear:ln("clear"),forEach:Rr(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{e[o]=Mr(o,!1,!1),n[o]=Mr(o,!0,!1),t[o]=Mr(o,!1,!0),i[o]=Mr(o,!0,!0)}),[e,n,t,i]}const[Ih,Gh,zh,Uh]=Lh();function Dr(e,t){const n=t?e?Uh:zh:e?Gh:Ih;return(i,s,o)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?i:Reflect.get(Oe(n,s)&&s in i?n:i,s,o)}const $h={get:Dr(!1,!1)},Vh={get:Dr(!1,!0)},Bh={get:Dr(!0,!1)},Hh={get:Dr(!0,!0)},Wa=new WeakMap,Ka=new WeakMap,qa=new WeakMap,Ya=new WeakMap;function jh(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Wh(e){return e.__v_skip||!Object.isExtensible(e)?0:jh(ph(e))}function qs(e){return Sn(e)?e:Or(e,!1,Dh,$h,Wa)}function Xa(e){return Or(e,!1,Nh,Vh,Ka)}function Za(e){return Or(e,!0,Oh,Bh,qa)}function wv(e){return Or(e,!0,Fh,Hh,Ya)}function Or(e,t,n,i,s){if(!ze(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const o=s.get(e);if(o)return o;const r=Wh(e);if(r===0)return e;const a=new Proxy(e,r===2?i:n);return s.set(e,a),a}function zn(e){return Sn(e)?zn(e.__v_raw):!!(e&&e.__v_isReactive)}function Sn(e){return!!(e&&e.__v_isReadonly)}function Ct(e){return!!(e&&e.__v_isShallow)}function Ys(e){return e?!!e.__v_raw:!1}function Pe(e){const t=e&&e.__v_raw;return t?Pe(t):e}function Kh(e){return!Oe(e,"__v_skip")&&Object.isExtensible(e)&&wa(e,"__v_skip",!0),e}const dt=e=>ze(e)?qs(e):e,Xs=e=>ze(e)?Za(e):e;function Qe(e){return e?e.__v_isRef===!0:!1}function ge(e){return Ja(e,!1)}function qh(e){return Ja(e,!0)}function Ja(e,t){return Qe(e)?e:new Yh(e,t)}class Yh{constructor(t,n){this.dep=new Vs,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:Pe(t),this._value=n?t:dt(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,i=this.__v_isShallow||Ct(t)||Sn(t);t=i?t:Pe(t),an(t,n)&&(this._rawValue=t,this._value=i?t:dt(t),this.dep.trigger())}}function fe(e){return Qe(e)?e.value:e}const Xh={get:(e,t,n)=>t==="__v_raw"?e:fe(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const s=e[t];return Qe(s)&&!Qe(n)?(s.value=n,!0):Reflect.set(e,t,n,i)}};function Qa(e){return zn(e)?e:new Proxy(e,Xh)}class Zh{constructor(t,n,i){this.fn=t,this.setter=n,this._value=void 0,this.dep=new Vs(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ri-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&$e!==this)return Ra(this,!0),!0}get value(){const t=this.dep.track();return Oa(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Jh(e,t,n=!1){let i,s;return be(e)?i=e:(i=e.get,s=e.set),new Zh(i,s,n)}const Nr={},Fr=new WeakMap;let wn;function Qh(e,t=!1,n=wn){if(n){let i=Fr.get(n);i||Fr.set(n,i=[]),i.push(e)}}function ef(e,t,n=Ge){const{immediate:i,deep:s,once:o,scheduler:r,augmentJob:a,call:l}=n,c=y=>s?y:Ct(y)||s===!1||s===0?Xt(y,1):Xt(y);let d,f,p,h,g=!1,v=!1;if(Qe(e)?(f=()=>e.value,g=Ct(e)):zn(e)?(f=()=>c(e),g=!0):me(e)?(v=!0,g=e.some(y=>zn(y)||Ct(y)),f=()=>e.map(y=>{if(Qe(y))return y.value;if(zn(y))return c(y);if(be(y))return l?l(y,2):y()})):be(e)?t?f=l?()=>l(e,2):e:f=()=>{if(p){Wt();try{p()}finally{Kt()}}const y=wn;wn=d;try{return l?l(e,3,[h]):e(h)}finally{wn=y}}:f=Gt,t&&s){const y=f,S=s===!0?1/0:s;f=()=>Xt(y(),S)}const b=kh(),C=()=>{d.stop(),b&&Ds(b.effects,d)};if(o&&t){const y=t;t=(...S)=>{y(...S),C()}}let m=v?new Array(e.length).fill(Nr):Nr;const u=y=>{if(!(!(d.flags&1)||!d.dirty&&!y))if(t){const S=d.run();if(s||g||(v?S.some((A,M)=>an(A,m[M])):an(S,m))){p&&p();const A=wn;wn=d;try{const M=[S,m===Nr?void 0:v&&m[0]===Nr?[]:m,h];l?l(t,3,M):t(...M),m=S}finally{wn=A}}}else d.run()};return a&&a(u),d=new Ea(f),d.scheduler=r?()=>r(u,!1):u,h=y=>Qh(y,!1,d),p=d.onStop=()=>{const y=Fr.get(d);if(y){if(l)l(y,4);else for(const S of y)S();Fr.delete(d)}},t?i?u(!0):m=d.run():r?r(u.bind(null,!0),!0):d.run(),C.pause=d.pause.bind(d),C.resume=d.resume.bind(d),C.stop=C,C}function Xt(e,t=1/0,n){if(t<=0||!ze(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,Qe(e))Xt(e.value,t,n);else if(me(e))for(let i=0;i<e.length;i++)Xt(e[i],t,n);else if(vr(e)||In(e))e.forEach(i=>{Xt(i,t,n)});else if(_r(e)){for(const i in e)Xt(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Xt(e[i],t,n)}return e}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const ai=[];let Zs=!1;function xv(e,...t){if(Zs)return;Zs=!0,Wt();const n=ai.length?ai[ai.length-1].component:null,i=n&&n.appContext.config.warnHandler,s=tf();if(i)Un(i,n,11,[e+t.map(o=>{var r,a;return(a=(r=o.toString)==null?void 0:r.call(o))!=null?a:JSON.stringify(o)}).join(""),n&&n.proxy,s.map(({vnode:o})=>`at <${Ql(n,o.type)}>`).join(`
`),s]);else{const o=[`[Vue warn]: ${e}`,...t];s.length&&o.push(`
`,...nf(s)),console.warn(...o)}Kt(),Zs=!1}function tf(){let e=ai[ai.length-1];if(!e)return[];const t=[];for(;e;){const n=t[0];n&&n.vnode===e?n.recurseCount++:t.push({vnode:e,recurseCount:0});const i=e.component&&e.component.parent;e=i&&i.vnode}return t}function nf(e){const t=[];return e.forEach((n,i)=>{t.push(...i===0?[]:[`
`],...rf(n))}),t}function rf({vnode:e,recurseCount:t}){const n=t>0?`... (${t} recursive calls)`:"",i=e.component?e.component.parent==null:!1,s=` at <${Ql(e.component,e.type,i)}`,o=">"+n;return e.props?[s,...sf(e.props),o]:[s+o]}function sf(e){const t=[],n=Object.keys(e);return n.slice(0,3).forEach(i=>{t.push(...el(i,e[i]))}),n.length>3&&t.push(" ..."),t}function el(e,t,n){return We(t)?(t=JSON.stringify(t),n?t:[`${e}=${t}`]):typeof t=="number"||typeof t=="boolean"||t==null?n?t:[`${e}=${t}`]:Qe(t)?(t=el(e,Pe(t.value),!0),n?t:[`${e}=Ref<`,t,">"]):be(t)?[`${e}=fn${t.name?`<${t.name}>`:""}`]:(t=Pe(t),n?t:[`${e}=`,t])}function Un(e,t,n,i){try{return i?e(...i):e()}catch(s){Lr(s,t,n)}}function Dt(e,t,n,i){if(be(e)){const s=Un(e,t,n,i);return s&&ba(s)&&s.catch(o=>{Lr(o,t,n)}),s}if(me(e)){const s=[];for(let o=0;o<e.length;o++)s.push(Dt(e[o],t,n,i));return s}}function Lr(e,t,n,i=!0){const s=t?t.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:r}=t&&t.appContext.config||Ge;if(t){let a=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const d=a.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](e,l,c)===!1)return}a=a.parent}if(o){Wt(),Un(o,null,10,[e,l,c]),Kt();return}}of(e,n,s,i,r)}function of(e,t,n,i=!0,s=!1){if(s)throw e;console.error(e)}const ft=[];let Ut=-1;const $n=[];let cn=null,Vn=0;const tl=Promise.resolve();let Ir=null;function li(e){const t=Ir||tl;return e?t.then(this?e.bind(this):e):t}function af(e){let t=Ut+1,n=ft.length;for(;t<n;){const i=t+n>>>1,s=ft[i],o=ci(s);o<e||o===e&&s.flags&2?t=i+1:n=i}return t}function Js(e){if(!(e.flags&1)){const t=ci(e),n=ft[ft.length-1];!n||!(e.flags&2)&&t>=ci(n)?ft.push(e):ft.splice(af(t),0,e),e.flags|=1,nl()}}function nl(){Ir||(Ir=tl.then(sl))}function lf(e){me(e)?$n.push(...e):cn&&e.id===-1?cn.splice(Vn+1,0,e):e.flags&1||($n.push(e),e.flags|=1),nl()}function il(e,t,n=Ut+1){for(;n<ft.length;n++){const i=ft[n];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;ft.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function rl(e){if($n.length){const t=[...new Set($n)].sort((n,i)=>ci(n)-ci(i));if($n.length=0,cn){cn.push(...t);return}for(cn=t,Vn=0;Vn<cn.length;Vn++){const n=cn[Vn];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}cn=null,Vn=0}}const ci=e=>e.id==null?e.flags&2?-1:1/0:e.id;function sl(e){try{for(Ut=0;Ut<ft.length;Ut++){const t=ft[Ut];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Un(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Ut<ft.length;Ut++){const t=ft[Ut];t&&(t.flags&=-2)}Ut=-1,ft.length=0,rl(),Ir=null,(ft.length||$n.length)&&sl()}}let et=null,ol=null;function Gr(e){const t=et;return et=e,ol=e&&e.type.__scopeId||null,t}function Qs(e,t=et,n){if(!t||e._n)return e;const i=(...s)=>{i._d&&jl(-1);const o=Gr(t);let r;try{r=e(...s)}finally{Gr(o),i._d&&jl(1)}return r};return i._n=!0,i._c=!0,i._d=!0,i}function eo(e,t){if(et===null)return e;const n=Zr(et),i=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[o,r,a,l=Ge]=t[s];o&&(be(o)&&(o={mounted:o,updated:o}),o.deep&&Xt(r),i.push({dir:o,instance:n,value:r,oldValue:void 0,arg:a,modifiers:l}))}return e}function xn(e,t,n,i){const s=e.dirs,o=t&&t.dirs;for(let r=0;r<s.length;r++){const a=s[r];o&&(a.oldValue=o[r].value);let l=a.dir[i];l&&(Wt(),Dt(l,n,8,[e.el,a,e,t]),Kt())}}const cf=Symbol("_vte"),al=e=>e.__isTeleport,dn=Symbol("_leaveCb"),zr=Symbol("_enterCb");function df(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Vr(()=>{e.isMounted=!0}),ro(()=>{e.isUnmounting=!0}),e}const kt=[Function,Array],ll={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:kt,onEnter:kt,onAfterEnter:kt,onEnterCancelled:kt,onBeforeLeave:kt,onLeave:kt,onAfterLeave:kt,onLeaveCancelled:kt,onBeforeAppear:kt,onAppear:kt,onAfterAppear:kt,onAppearCancelled:kt},cl=e=>{const t=e.subTree;return t.component?cl(t.component):t},uf={name:"BaseTransition",props:ll,setup(e,{slots:t}){const n=c0(),i=df();return()=>{const s=t.default&&fl(t.default(),!0);if(!s||!s.length)return;const o=dl(s),r=Pe(e),{mode:a}=r;if(i.isLeaving)return no(o);const l=hl(o);if(!l)return no(o);let c=to(l,r,i,n,p=>c=p);l.type!==gt&&di(l,c);const d=n.subTree,f=d&&hl(d);if(f&&f.type!==gt&&!kn(l,f)&&cl(n).type!==gt){const p=to(f,r,i,n);if(di(f,p),a==="out-in"&&l.type!==gt)return i.isLeaving=!0,p.afterLeave=()=>{i.isLeaving=!1,n.job.flags&8||n.update(),delete p.afterLeave},no(o);a==="in-out"&&l.type!==gt&&(p.delayLeave=(h,g,v)=>{const b=ul(i,f);b[String(f.key)]=f,h[dn]=()=>{g(),h[dn]=void 0,delete c.delayedLeave},c.delayedLeave=v})}return o}}};function dl(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==gt){t=n;break}}return t}const hf=uf;function ul(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function to(e,t,n,i,s){const{appear:o,mode:r,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:d,onEnterCancelled:f,onBeforeLeave:p,onLeave:h,onAfterLeave:g,onLeaveCancelled:v,onBeforeAppear:b,onAppear:C,onAfterAppear:m,onAppearCancelled:u}=t,y=String(e.key),S=ul(n,e),A=(w,k)=>{w&&Dt(w,i,9,k)},M=(w,k)=>{const T=k[1];A(w,k),me(w)?w.every(R=>R.length<=1)&&T():w.length<=1&&T()},x={mode:r,persisted:a,beforeEnter(w){let k=l;if(!n.isMounted)if(o)k=b||l;else return;w[dn]&&w[dn](!0);const T=S[y];T&&kn(e,T)&&T.el[dn]&&T.el[dn](),A(k,[w])},enter(w){let k=c,T=d,R=f;if(!n.isMounted)if(o)k=C||c,T=m||d,R=u||f;else return;let I=!1;const $=w[zr]=z=>{I||(I=!0,z?A(R,[w]):A(T,[w]),x.delayedLeave&&x.delayedLeave(),w[zr]=void 0)};k?M(k,[w,$]):$()},leave(w,k){const T=String(e.key);if(w[zr]&&w[zr](!0),n.isUnmounting)return k();A(p,[w]);let R=!1;const I=w[dn]=$=>{R||(R=!0,k(),$?A(v,[w]):A(g,[w]),w[dn]=void 0,S[T]===e&&delete S[T])};S[T]=e,h?M(h,[w,I]):I()},clone(w){const k=to(w,t,n,i,s);return s&&s(k),k}};return x}function no(e){if(Ur(e))return e=un(e),e.children=null,e}function hl(e){if(!Ur(e))return al(e.type)&&e.children?dl(e.children):e;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&be(n.default))return n.default()}}function di(e,t){e.shapeFlag&6&&e.component?(e.transition=t,di(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function fl(e,t=!1,n){let i=[],s=0;for(let o=0;o<e.length;o++){let r=e[o];const a=n==null?r.key:String(n)+String(r.key!=null?r.key:o);r.type===Re?(r.patchFlag&128&&s++,i=i.concat(fl(r.children,t,a))):(t||r.type!==gt)&&i.push(a!=null?un(r,{key:a}):r)}if(s>1)for(let o=0;o<i.length;o++)i[o].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function Zt(e,t){return be(e)?Ze({name:e.name},t,{setup:e}):e}function pl(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function io(e,t,n,i,s=!1){if(me(e)){e.forEach((g,v)=>io(g,t&&(me(t)?t[v]:t),n,i,s));return}if(Bn(i)&&!s)return;const o=i.shapeFlag&4?Zr(i.component):i.el,r=s?null:o,{i:a,r:l}=e,c=t&&t.r,d=a.refs===Ge?a.refs={}:a.refs,f=a.setupState,p=Pe(f),h=f===Ge?()=>!1:g=>Oe(p,g);if(c!=null&&c!==l&&(We(c)?(d[c]=null,h(c)&&(f[c]=null)):Qe(c)&&(c.value=null)),be(l))Un(l,a,12,[r,d]);else{const g=We(l),v=Qe(l);if(g||v){const b=()=>{if(e.f){const C=g?h(l)?f[l]:d[l]:l.value;s?me(C)&&Ds(C,o):me(C)?C.includes(o)||C.push(o):g?(d[l]=[o],h(l)&&(f[l]=d[l])):(l.value=[o],e.k&&(d[e.k]=l.value))}else g?(d[l]=r,h(l)&&(f[l]=r)):v&&(l.value=r,e.k&&(d[e.k]=r))};r?(b.id=-1,St(b,n)):b()}}}const Bn=e=>!!e.type.__asyncLoader,Ur=e=>e.type.__isKeepAlive;function ff(e,t){gl(e,"a",t)}function pf(e,t){gl(e,"da",t)}function gl(e,t,n=st){const i=e.__wdc||(e.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if($r(t,i,n),n){let s=n.parent;for(;s&&s.parent;)Ur(s.parent.vnode)&&gf(i,t,n,s),s=s.parent}}function gf(e,t,n,i){const s=$r(t,e,i,!0);ui(()=>{Ds(i[t],s)},n)}function $r(e,t,n=st,i=!1){if(n){const s=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...r)=>{Wt();const a=yi(n),l=Dt(t,n,e,r);return a(),Kt(),l});return i?s.unshift(o):s.push(o),o}}const Jt=e=>(t,n=st)=>{(!Xr||e==="sp")&&$r(e,(...i)=>t(...i),n)},mf=Jt("bm"),Vr=Jt("m"),yf=Jt("bu"),vf=Jt("u"),ro=Jt("bum"),ui=Jt("um"),_f=Jt("sp"),bf=Jt("rtg"),Sf=Jt("rtc");function wf(e,t=st){$r("ec",e,t)}const xf="components";function Cf(e,t){return Pf(xf,e,!0,t)||e}const kf=Symbol.for("v-ndc");function Pf(e,t,n=!0,i=!1){const s=et||st;if(s){const o=s.type;{const a=Jl(o,!1);if(a&&(a===t||a===ht(t)||a===Sr(ht(t))))return o}const r=ml(s[e]||o[e],t)||ml(s.appContext[e],t);return!r&&i?o:r}}function ml(e,t){return e&&(e[t]||e[ht(t)]||e[Sr(ht(t))])}function Qt(e,t,n,i){let s;const o=n,r=me(e);if(r||We(e)){const a=r&&zn(e);let l=!1;a&&(l=!Ct(e),e=kr(e)),s=new Array(e.length);for(let c=0,d=e.length;c<d;c++)s[c]=t(l?dt(e[c]):e[c],c,void 0,o)}else if(typeof e=="number"){s=new Array(e);for(let a=0;a<e;a++)s[a]=t(a+1,a,void 0,o)}else if(ze(e))if(e[Symbol.iterator])s=Array.from(e,(a,l)=>t(a,l,void 0,o));else{const a=Object.keys(e);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const d=a[l];s[l]=t(e[d],d,l,o)}}else s=[];return s}function yl(e,t,n={},i,s){if(et.ce||et.parent&&Bn(et.parent)&&et.parent.ce)return t!=="default"&&(n.name=t),ae(),jn(Re,null,[Ke("slot",n,i&&i())],64);let o=e[t];o&&o._c&&(o._d=!1),ae();const r=o&&vl(o(n)),a=jn(Re,{key:(n.key||r&&r.key||`_${t}`)+(!r&&i?"_fb":"")},r||(i?i():[]),r&&e._===1?64:-2);return o&&o._c&&(o._d=!0),a}function vl(e){return e.some(t=>mi(t)?!(t.type===gt||t.type===Re&&!vl(t.children)):!0)?e:null}const so=e=>e?Yl(e)?Zr(e):so(e.parent):null,hi=Ze(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>so(e.parent),$root:e=>so(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>wl(e),$forceUpdate:e=>e.f||(e.f=()=>{Js(e.update)}),$nextTick:e=>e.n||(e.n=li.bind(e.proxy)),$watch:e=>qf.bind(e)}),oo=(e,t)=>e!==Ge&&!e.__isScriptSetup&&Oe(e,t),Tf={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:i,data:s,props:o,accessCache:r,type:a,appContext:l}=e;let c;if(t[0]!=="$"){const h=r[t];if(h!==void 0)switch(h){case 1:return i[t];case 2:return s[t];case 4:return n[t];case 3:return o[t]}else{if(oo(i,t))return r[t]=1,i[t];if(s!==Ge&&Oe(s,t))return r[t]=2,s[t];if((c=e.propsOptions[0])&&Oe(c,t))return r[t]=3,o[t];if(n!==Ge&&Oe(n,t))return r[t]=4,n[t];ao&&(r[t]=0)}}const d=hi[t];let f,p;if(d)return t==="$attrs"&&ct(e.attrs,"get",""),d(e);if((f=a.__cssModules)&&(f=f[t]))return f;if(n!==Ge&&Oe(n,t))return r[t]=4,n[t];if(p=l.config.globalProperties,Oe(p,t))return p[t]},set({_:e},t,n){const{data:i,setupState:s,ctx:o}=e;return oo(s,t)?(s[t]=n,!0):i!==Ge&&Oe(i,t)?(i[t]=n,!0):Oe(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(o[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:s,propsOptions:o}},r){let a;return!!n[r]||e!==Ge&&Oe(e,r)||oo(t,r)||(a=o[0])&&Oe(a,r)||Oe(i,r)||Oe(hi,r)||Oe(s.config.globalProperties,r)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Oe(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function _l(e){return me(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let ao=!0;function Ef(e){const t=wl(e),n=e.proxy,i=e.ctx;ao=!1,t.beforeCreate&&bl(t.beforeCreate,e,"bc");const{data:s,computed:o,methods:r,watch:a,provide:l,inject:c,created:d,beforeMount:f,mounted:p,beforeUpdate:h,updated:g,activated:v,deactivated:b,beforeDestroy:C,beforeUnmount:m,destroyed:u,unmounted:y,render:S,renderTracked:A,renderTriggered:M,errorCaptured:x,serverPrefetch:w,expose:k,inheritAttrs:T,components:R,directives:I,filters:$}=t;if(c&&Af(c,i,null),r)for(const _ in r){const P=r[_];be(P)&&(i[_]=P.bind(n))}if(s){const _=s.call(n,n);ze(_)&&(e.data=qs(_))}if(ao=!0,o)for(const _ in o){const P=o[_],N=be(P)?P.bind(n,n):be(P.get)?P.get.bind(n,n):Gt,O=!be(P)&&be(P.set)?P.set.bind(n):Gt,G=xe({get:N,set:O});Object.defineProperty(i,_,{enumerable:!0,configurable:!0,get:()=>G.value,set:H=>G.value=H})}if(a)for(const _ in a)Sl(a[_],i,n,_);if(l){const _=be(l)?l.call(n):l;Reflect.ownKeys(_).forEach(P=>{Ff(P,_[P])})}d&&bl(d,e,"c");function q(_,P){me(P)?P.forEach(N=>_(N.bind(n))):P&&_(P.bind(n))}if(q(mf,f),q(Vr,p),q(yf,h),q(vf,g),q(ff,v),q(pf,b),q(wf,x),q(Sf,A),q(bf,M),q(ro,m),q(ui,y),q(_f,w),me(k))if(k.length){const _=e.exposed||(e.exposed={});k.forEach(P=>{Object.defineProperty(_,P,{get:()=>n[P],set:N=>n[P]=N})})}else e.exposed||(e.exposed={});S&&e.render===Gt&&(e.render=S),T!=null&&(e.inheritAttrs=T),R&&(e.components=R),I&&(e.directives=I),w&&pl(e)}function Af(e,t,n=Gt){me(e)&&(e=lo(e));for(const i in e){const s=e[i];let o;ze(s)?"default"in s?o=Hr(s.from||i,s.default,!0):o=Hr(s.from||i):o=Hr(s),Qe(o)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:r=>o.value=r}):t[i]=o}}function bl(e,t,n){Dt(me(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function Sl(e,t,n,i){let s=i.includes(".")?Ul(n,i):()=>n[i];if(We(e)){const o=t[e];be(o)&&He(s,o)}else if(be(e))He(s,e.bind(n));else if(ze(e))if(me(e))e.forEach(o=>Sl(o,t,n,i));else{const o=be(e.handler)?e.handler.bind(n):t[e.handler];be(o)&&He(s,o,e)}}function wl(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:s,optionsCache:o,config:{optionMergeStrategies:r}}=e.appContext,a=o.get(t);let l;return a?l=a:!s.length&&!n&&!i?l=t:(l={},s.length&&s.forEach(c=>Br(l,c,r,!0)),Br(l,t,r)),ze(t)&&o.set(t,l),l}function Br(e,t,n,i=!1){const{mixins:s,extends:o}=t;o&&Br(e,o,n,!0),s&&s.forEach(r=>Br(e,r,n,!0));for(const r in t)if(!(i&&r==="expose")){const a=Rf[r]||n&&n[r];e[r]=a?a(e[r],t[r]):t[r]}return e}const Rf={data:xl,props:Cl,emits:Cl,methods:fi,computed:fi,beforeCreate:pt,created:pt,beforeMount:pt,mounted:pt,beforeUpdate:pt,updated:pt,beforeDestroy:pt,beforeUnmount:pt,destroyed:pt,unmounted:pt,activated:pt,deactivated:pt,errorCaptured:pt,serverPrefetch:pt,components:fi,directives:fi,watch:Df,provide:xl,inject:Mf};function xl(e,t){return t?e?function(){return Ze(be(e)?e.call(this,this):e,be(t)?t.call(this,this):t)}:t:e}function Mf(e,t){return fi(lo(e),lo(t))}function lo(e){if(me(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function pt(e,t){return e?[...new Set([].concat(e,t))]:t}function fi(e,t){return e?Ze(Object.create(null),e,t):t}function Cl(e,t){return e?me(e)&&me(t)?[...new Set([...e,...t])]:Ze(Object.create(null),_l(e),_l(t??{})):t}function Df(e,t){if(!e)return t;if(!t)return e;const n=Ze(Object.create(null),e);for(const i in t)n[i]=pt(e[i],t[i]);return n}function kl(){return{app:null,config:{isNativeTag:hh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Of=0;function Nf(e,t){return function(i,s=null){be(i)||(i=Ze({},i)),s!=null&&!ze(s)&&(s=null);const o=kl(),r=new WeakSet,a=[];let l=!1;const c=o.app={_uid:Of++,_component:i,_props:s,_container:null,_context:o,_instance:null,version:v0,get config(){return o.config},set config(d){},use(d,...f){return r.has(d)||(d&&be(d.install)?(r.add(d),d.install(c,...f)):be(d)&&(r.add(d),d(c,...f))),c},mixin(d){return o.mixins.includes(d)||o.mixins.push(d),c},component(d,f){return f?(o.components[d]=f,c):o.components[d]},directive(d,f){return f?(o.directives[d]=f,c):o.directives[d]},mount(d,f,p){if(!l){const h=c._ceVNode||Ke(i,s);return h.appContext=o,p===!0?p="svg":p===!1&&(p=void 0),e(h,d,p),l=!0,c._container=d,d.__vue_app__=c,Zr(h.component)}},onUnmount(d){a.push(d)},unmount(){l&&(Dt(a,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(d,f){return o.provides[d]=f,c},runWithContext(d){const f=Hn;Hn=c;try{return d()}finally{Hn=f}}};return c}}let Hn=null;function Ff(e,t){if(st){let n=st.provides;const i=st.parent&&st.parent.provides;i===n&&(n=st.provides=Object.create(i)),n[e]=t}}function Hr(e,t,n=!1){const i=st||et;if(i||Hn){const s=Hn?Hn._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return n&&be(t)?t.call(i&&i.proxy):t}}const Pl={},Tl=()=>Object.create(Pl),El=e=>Object.getPrototypeOf(e)===Pl;function Lf(e,t,n,i=!1){const s={},o=Tl();e.propsDefaults=Object.create(null),Al(e,t,s,o);for(const r in e.propsOptions[0])r in s||(s[r]=void 0);n?e.props=i?s:Xa(s):e.type.props?e.props=s:e.props=o,e.attrs=o}function If(e,t,n,i){const{props:s,attrs:o,vnode:{patchFlag:r}}=e,a=Pe(s),[l]=e.propsOptions;let c=!1;if((i||r>0)&&!(r&16)){if(r&8){const d=e.vnode.dynamicProps;for(let f=0;f<d.length;f++){let p=d[f];if(jr(e.emitsOptions,p))continue;const h=t[p];if(l)if(Oe(o,p))h!==o[p]&&(o[p]=h,c=!0);else{const g=ht(p);s[g]=co(l,a,g,h,e,!1)}else h!==o[p]&&(o[p]=h,c=!0)}}}else{Al(e,t,s,o)&&(c=!0);let d;for(const f in a)(!t||!Oe(t,f)&&((d=xt(f))===f||!Oe(t,d)))&&(l?n&&(n[f]!==void 0||n[d]!==void 0)&&(s[f]=co(l,a,f,void 0,e,!0)):delete s[f]);if(o!==a)for(const f in o)(!t||!Oe(t,f))&&(delete o[f],c=!0)}c&&qt(e.attrs,"set","")}function Al(e,t,n,i){const[s,o]=e.propsOptions;let r=!1,a;if(t)for(let l in t){if(ti(l))continue;const c=t[l];let d;s&&Oe(s,d=ht(l))?!o||!o.includes(d)?n[d]=c:(a||(a={}))[d]=c:jr(e.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,r=!0)}if(o){const l=Pe(n),c=a||Ge;for(let d=0;d<o.length;d++){const f=o[d];n[f]=co(s,l,f,c[f],e,!Oe(c,f))}}return r}function co(e,t,n,i,s,o){const r=e[n];if(r!=null){const a=Oe(r,"default");if(a&&i===void 0){const l=r.default;if(r.type!==Function&&!r.skipFactory&&be(l)){const{propsDefaults:c}=s;if(n in c)i=c[n];else{const d=yi(s);i=c[n]=l.call(null,t),d()}}else i=l;s.ce&&s.ce._setProp(n,i)}r[0]&&(o&&!a?i=!1:r[1]&&(i===""||i===xt(n))&&(i=!0))}return i}const Gf=new WeakMap;function Rl(e,t,n=!1){const i=n?Gf:t.propsCache,s=i.get(e);if(s)return s;const o=e.props,r={},a=[];let l=!1;if(!be(e)){const d=f=>{l=!0;const[p,h]=Rl(f,t,!0);Ze(r,p),h&&a.push(...h)};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!o&&!l)return ze(e)&&i.set(e,Ln),Ln;if(me(o))for(let d=0;d<o.length;d++){const f=ht(o[d]);Ml(f)&&(r[f]=Ge)}else if(o)for(const d in o){const f=ht(d);if(Ml(f)){const p=o[d],h=r[f]=me(p)||be(p)?{type:p}:Ze({},p),g=h.type;let v=!1,b=!0;if(me(g))for(let C=0;C<g.length;++C){const m=g[C],u=be(m)&&m.name;if(u==="Boolean"){v=!0;break}else u==="String"&&(b=!1)}else v=be(g)&&g.name==="Boolean";h[0]=v,h[1]=b,(v||Oe(h,"default"))&&a.push(f)}}const c=[r,a];return ze(e)&&i.set(e,c),c}function Ml(e){return e[0]!=="$"&&!ti(e)}const Dl=e=>e[0]==="_"||e==="$stable",uo=e=>me(e)?e.map($t):[$t(e)],zf=(e,t,n)=>{if(t._n)return t;const i=Qs((...s)=>uo(t(...s)),n);return i._c=!1,i},Ol=(e,t,n)=>{const i=e._ctx;for(const s in e){if(Dl(s))continue;const o=e[s];if(be(o))t[s]=zf(s,o,i);else if(o!=null){const r=uo(o);t[s]=()=>r}}},Nl=(e,t)=>{const n=uo(t);e.slots.default=()=>n},Fl=(e,t,n)=>{for(const i in t)(n||i!=="_")&&(e[i]=t[i])},Uf=(e,t,n)=>{const i=e.slots=Tl();if(e.vnode.shapeFlag&32){const s=t._;s?(Fl(i,t,n),n&&wa(i,"_",s,!0)):Ol(t,i)}else t&&Nl(e,t)},$f=(e,t,n)=>{const{vnode:i,slots:s}=e;let o=!0,r=Ge;if(i.shapeFlag&32){const a=t._;a?n&&a===1?o=!1:Fl(s,t,n):(o=!t.$stable,Ol(t,s)),r=t}else t&&(Nl(e,t),r={default:1});if(o)for(const a in s)!Dl(a)&&r[a]==null&&delete s[a]},St=t0;function Vf(e){return Bf(e)}function Bf(e,t){const n=Ca();n.__VUE__=!0;const{insert:i,remove:s,patchProp:o,createElement:r,createText:a,createComment:l,setText:c,setElementText:d,parentNode:f,nextSibling:p,setScopeId:h=Gt,insertStaticContent:g}=e,v=(D,L,B,W=null,Z=null,Y=null,ie=void 0,oe=null,re=!!L.dynamicChildren)=>{if(D===L)return;D&&!kn(D,L)&&(W=E(D),H(D,Z,Y,!0),D=null),L.patchFlag===-2&&(re=!1,L.dynamicChildren=null);const{type:te,ref:de,shapeFlag:le}=L;switch(te){case Wr:b(D,L,B,W);break;case gt:C(D,L,B,W);break;case fo:D==null&&m(L,B,W,ie);break;case Re:R(D,L,B,W,Z,Y,ie,oe,re);break;default:le&1?S(D,L,B,W,Z,Y,ie,oe,re):le&6?I(D,L,B,W,Z,Y,ie,oe,re):(le&64||le&128)&&te.process(D,L,B,W,Z,Y,ie,oe,re,ee)}de!=null&&Z&&io(de,D&&D.ref,Y,L||D,!L)},b=(D,L,B,W)=>{if(D==null)i(L.el=a(L.children),B,W);else{const Z=L.el=D.el;L.children!==D.children&&c(Z,L.children)}},C=(D,L,B,W)=>{D==null?i(L.el=l(L.children||""),B,W):L.el=D.el},m=(D,L,B,W)=>{[D.el,D.anchor]=g(D.children,L,B,W,D.el,D.anchor)},u=({el:D,anchor:L},B,W)=>{let Z;for(;D&&D!==L;)Z=p(D),i(D,B,W),D=Z;i(L,B,W)},y=({el:D,anchor:L})=>{let B;for(;D&&D!==L;)B=p(D),s(D),D=B;s(L)},S=(D,L,B,W,Z,Y,ie,oe,re)=>{L.type==="svg"?ie="svg":L.type==="math"&&(ie="mathml"),D==null?A(L,B,W,Z,Y,ie,oe,re):w(D,L,Z,Y,ie,oe,re)},A=(D,L,B,W,Z,Y,ie,oe)=>{let re,te;const{props:de,shapeFlag:le,transition:ue,dirs:pe}=D;if(re=D.el=r(D.type,Y,de&&de.is,de),le&8?d(re,D.children):le&16&&x(D.children,re,null,W,Z,ho(D,Y),ie,oe),pe&&xn(D,null,W,"created"),M(re,D,D.scopeId,ie,W),de){for(const Ee in de)Ee!=="value"&&!ti(Ee)&&o(re,Ee,null,de[Ee],Y,W);"value"in de&&o(re,"value",null,de.value,Y),(te=de.onVnodeBeforeMount)&&Vt(te,W,D)}pe&&xn(D,null,W,"beforeMount");const _e=Hf(Z,ue);_e&&ue.beforeEnter(re),i(re,L,B),((te=de&&de.onVnodeMounted)||_e||pe)&&St(()=>{te&&Vt(te,W,D),_e&&ue.enter(re),pe&&xn(D,null,W,"mounted")},Z)},M=(D,L,B,W,Z)=>{if(B&&h(D,B),W)for(let Y=0;Y<W.length;Y++)h(D,W[Y]);if(Z){let Y=Z.subTree;if(L===Y||Hl(Y.type)&&(Y.ssContent===L||Y.ssFallback===L)){const ie=Z.vnode;M(D,ie,ie.scopeId,ie.slotScopeIds,Z.parent)}}},x=(D,L,B,W,Z,Y,ie,oe,re=0)=>{for(let te=re;te<D.length;te++){const de=D[te]=oe?hn(D[te]):$t(D[te]);v(null,de,L,B,W,Z,Y,ie,oe)}},w=(D,L,B,W,Z,Y,ie)=>{const oe=L.el=D.el;let{patchFlag:re,dynamicChildren:te,dirs:de}=L;re|=D.patchFlag&16;const le=D.props||Ge,ue=L.props||Ge;let pe;if(B&&Cn(B,!1),(pe=ue.onVnodeBeforeUpdate)&&Vt(pe,B,L,D),de&&xn(L,D,B,"beforeUpdate"),B&&Cn(B,!0),(le.innerHTML&&ue.innerHTML==null||le.textContent&&ue.textContent==null)&&d(oe,""),te?k(D.dynamicChildren,te,oe,B,W,ho(L,Z),Y):ie||P(D,L,oe,null,B,W,ho(L,Z),Y,!1),re>0){if(re&16)T(oe,le,ue,B,Z);else if(re&2&&le.class!==ue.class&&o(oe,"class",null,ue.class,Z),re&4&&o(oe,"style",le.style,ue.style,Z),re&8){const _e=L.dynamicProps;for(let Ee=0;Ee<_e.length;Ee++){const we=_e[Ee],Le=le[we],Ce=ue[we];(Ce!==Le||we==="value")&&o(oe,we,Le,Ce,Z,B)}}re&1&&D.children!==L.children&&d(oe,L.children)}else!ie&&te==null&&T(oe,le,ue,B,Z);((pe=ue.onVnodeUpdated)||de)&&St(()=>{pe&&Vt(pe,B,L,D),de&&xn(L,D,B,"updated")},W)},k=(D,L,B,W,Z,Y,ie)=>{for(let oe=0;oe<L.length;oe++){const re=D[oe],te=L[oe],de=re.el&&(re.type===Re||!kn(re,te)||re.shapeFlag&70)?f(re.el):B;v(re,te,de,null,W,Z,Y,ie,!0)}},T=(D,L,B,W,Z)=>{if(L!==B){if(L!==Ge)for(const Y in L)!ti(Y)&&!(Y in B)&&o(D,Y,L[Y],null,Z,W);for(const Y in B){if(ti(Y))continue;const ie=B[Y],oe=L[Y];ie!==oe&&Y!=="value"&&o(D,Y,oe,ie,Z,W)}"value"in B&&o(D,"value",L.value,B.value,Z)}},R=(D,L,B,W,Z,Y,ie,oe,re)=>{const te=L.el=D?D.el:a(""),de=L.anchor=D?D.anchor:a("");let{patchFlag:le,dynamicChildren:ue,slotScopeIds:pe}=L;pe&&(oe=oe?oe.concat(pe):pe),D==null?(i(te,B,W),i(de,B,W),x(L.children||[],B,de,Z,Y,ie,oe,re)):le>0&&le&64&&ue&&D.dynamicChildren?(k(D.dynamicChildren,ue,B,Z,Y,ie,oe),(L.key!=null||Z&&L===Z.subTree)&&Ll(D,L,!0)):P(D,L,B,de,Z,Y,ie,oe,re)},I=(D,L,B,W,Z,Y,ie,oe,re)=>{L.slotScopeIds=oe,D==null?L.shapeFlag&512?Z.ctx.activate(L,B,W,ie,re):$(L,B,W,Z,Y,ie,re):z(D,L,re)},$=(D,L,B,W,Z,Y,ie)=>{const oe=D.component=l0(D,W,Z);if(Ur(D)&&(oe.ctx.renderer=ee),d0(oe,!1,ie),oe.asyncDep){if(Z&&Z.registerDep(oe,q,ie),!D.el){const re=oe.subTree=Ke(gt);C(null,re,L,B)}}else q(oe,D,L,B,Z,Y,ie)},z=(D,L,B)=>{const W=L.component=D.component;if(Qf(D,L,B))if(W.asyncDep&&!W.asyncResolved){_(W,L,B);return}else W.next=L,W.update();else L.el=D.el,W.vnode=L},q=(D,L,B,W,Z,Y,ie)=>{const oe=()=>{if(D.isMounted){let{next:le,bu:ue,u:pe,parent:_e,vnode:Ee}=D;{const it=Il(D);if(it){le&&(le.el=Ee.el,_(D,le,ie)),it.asyncDep.then(()=>{D.isUnmounted||oe()});return}}let we=le,Le;Cn(D,!1),le?(le.el=Ee.el,_(D,le,ie)):le=Ee,ue&&wr(ue),(Le=le.props&&le.props.onVnodeBeforeUpdate)&&Vt(Le,_e,le,Ee),Cn(D,!0);const Ce=Vl(D),Ie=D.subTree;D.subTree=Ce,v(Ie,Ce,f(Ie.el),E(Ie),D,Z,Y),le.el=Ce.el,we===null&&e0(D,Ce.el),pe&&St(pe,Z),(Le=le.props&&le.props.onVnodeUpdated)&&St(()=>Vt(Le,_e,le,Ee),Z)}else{let le;const{el:ue,props:pe}=L,{bm:_e,m:Ee,parent:we,root:Le,type:Ce}=D,Ie=Bn(L);Cn(D,!1),_e&&wr(_e),!Ie&&(le=pe&&pe.onVnodeBeforeMount)&&Vt(le,we,L),Cn(D,!0);{Le.ce&&Le.ce._injectChildStyle(Ce);const it=D.subTree=Vl(D);v(null,it,B,W,D,Z,Y),L.el=it.el}if(Ee&&St(Ee,Z),!Ie&&(le=pe&&pe.onVnodeMounted)){const it=L;St(()=>Vt(le,we,it),Z)}(L.shapeFlag&256||we&&Bn(we.vnode)&&we.vnode.shapeFlag&256)&&D.a&&St(D.a,Z),D.isMounted=!0,L=B=W=null}};D.scope.on();const re=D.effect=new Ea(oe);D.scope.off();const te=D.update=re.run.bind(re),de=D.job=re.runIfDirty.bind(re);de.i=D,de.id=D.uid,re.scheduler=()=>Js(de),Cn(D,!0),te()},_=(D,L,B)=>{L.component=D;const W=D.vnode.props;D.vnode=L,D.next=null,If(D,L.props,W,B),$f(D,L.children,B),Wt(),il(D),Kt()},P=(D,L,B,W,Z,Y,ie,oe,re=!1)=>{const te=D&&D.children,de=D?D.shapeFlag:0,le=L.children,{patchFlag:ue,shapeFlag:pe}=L;if(ue>0){if(ue&128){O(te,le,B,W,Z,Y,ie,oe,re);return}else if(ue&256){N(te,le,B,W,Z,Y,ie,oe,re);return}}pe&8?(de&16&&F(te,Z,Y),le!==te&&d(B,le)):de&16?pe&16?O(te,le,B,W,Z,Y,ie,oe,re):F(te,Z,Y,!0):(de&8&&d(B,""),pe&16&&x(le,B,W,Z,Y,ie,oe,re))},N=(D,L,B,W,Z,Y,ie,oe,re)=>{D=D||Ln,L=L||Ln;const te=D.length,de=L.length,le=Math.min(te,de);let ue;for(ue=0;ue<le;ue++){const pe=L[ue]=re?hn(L[ue]):$t(L[ue]);v(D[ue],pe,B,null,Z,Y,ie,oe,re)}te>de?F(D,Z,Y,!0,!1,le):x(L,B,W,Z,Y,ie,oe,re,le)},O=(D,L,B,W,Z,Y,ie,oe,re)=>{let te=0;const de=L.length;let le=D.length-1,ue=de-1;for(;te<=le&&te<=ue;){const pe=D[te],_e=L[te]=re?hn(L[te]):$t(L[te]);if(kn(pe,_e))v(pe,_e,B,null,Z,Y,ie,oe,re);else break;te++}for(;te<=le&&te<=ue;){const pe=D[le],_e=L[ue]=re?hn(L[ue]):$t(L[ue]);if(kn(pe,_e))v(pe,_e,B,null,Z,Y,ie,oe,re);else break;le--,ue--}if(te>le){if(te<=ue){const pe=ue+1,_e=pe<de?L[pe].el:W;for(;te<=ue;)v(null,L[te]=re?hn(L[te]):$t(L[te]),B,_e,Z,Y,ie,oe,re),te++}}else if(te>ue)for(;te<=le;)H(D[te],Z,Y,!0),te++;else{const pe=te,_e=te,Ee=new Map;for(te=_e;te<=ue;te++){const ye=L[te]=re?hn(L[te]):$t(L[te]);ye.key!=null&&Ee.set(ye.key,te)}let we,Le=0;const Ce=ue-_e+1;let Ie=!1,it=0;const ne=new Array(Ce);for(te=0;te<Ce;te++)ne[te]=0;for(te=pe;te<=le;te++){const ye=D[te];if(Le>=Ce){H(ye,Z,Y,!0);continue}let De;if(ye.key!=null)De=Ee.get(ye.key);else for(we=_e;we<=ue;we++)if(ne[we-_e]===0&&kn(ye,L[we])){De=we;break}De===void 0?H(ye,Z,Y,!0):(ne[De-_e]=te+1,De>=it?it=De:Ie=!0,v(ye,L[De],B,null,Z,Y,ie,oe,re),Le++)}const K=Ie?jf(ne):Ln;for(we=K.length-1,te=Ce-1;te>=0;te--){const ye=_e+te,De=L[ye],je=ye+1<de?L[ye+1].el:W;ne[te]===0?v(null,De,B,je,Z,Y,ie,oe,re):Ie&&(we<0||te!==K[we]?G(De,B,je,2):we--)}}},G=(D,L,B,W,Z=null)=>{const{el:Y,type:ie,transition:oe,children:re,shapeFlag:te}=D;if(te&6){G(D.component.subTree,L,B,W);return}if(te&128){D.suspense.move(L,B,W);return}if(te&64){ie.move(D,L,B,ee);return}if(ie===Re){i(Y,L,B);for(let le=0;le<re.length;le++)G(re[le],L,B,W);i(D.anchor,L,B);return}if(ie===fo){u(D,L,B);return}if(W!==2&&te&1&&oe)if(W===0)oe.beforeEnter(Y),i(Y,L,B),St(()=>oe.enter(Y),Z);else{const{leave:le,delayLeave:ue,afterLeave:pe}=oe,_e=()=>i(Y,L,B),Ee=()=>{le(Y,()=>{_e(),pe&&pe()})};ue?ue(Y,_e,Ee):Ee()}else i(Y,L,B)},H=(D,L,B,W=!1,Z=!1)=>{const{type:Y,props:ie,ref:oe,children:re,dynamicChildren:te,shapeFlag:de,patchFlag:le,dirs:ue,cacheIndex:pe}=D;if(le===-2&&(Z=!1),oe!=null&&io(oe,null,B,D,!0),pe!=null&&(L.renderCache[pe]=void 0),de&256){L.ctx.deactivate(D);return}const _e=de&1&&ue,Ee=!Bn(D);let we;if(Ee&&(we=ie&&ie.onVnodeBeforeUnmount)&&Vt(we,L,D),de&6)se(D.component,B,W);else{if(de&128){D.suspense.unmount(B,W);return}_e&&xn(D,null,L,"beforeUnmount"),de&64?D.type.remove(D,L,B,ee,W):te&&!te.hasOnce&&(Y!==Re||le>0&&le&64)?F(te,L,B,!1,!0):(Y===Re&&le&384||!Z&&de&16)&&F(re,L,B),W&&V(D)}(Ee&&(we=ie&&ie.onVnodeUnmounted)||_e)&&St(()=>{we&&Vt(we,L,D),_e&&xn(D,null,L,"unmounted")},B)},V=D=>{const{type:L,el:B,anchor:W,transition:Z}=D;if(L===Re){Q(B,W);return}if(L===fo){y(D);return}const Y=()=>{s(B),Z&&!Z.persisted&&Z.afterLeave&&Z.afterLeave()};if(D.shapeFlag&1&&Z&&!Z.persisted){const{leave:ie,delayLeave:oe}=Z,re=()=>ie(B,Y);oe?oe(D.el,Y,re):re()}else Y()},Q=(D,L)=>{let B;for(;D!==L;)B=p(D),s(D),D=B;s(L)},se=(D,L,B)=>{const{bum:W,scope:Z,job:Y,subTree:ie,um:oe,m:re,a:te}=D;Gl(re),Gl(te),W&&wr(W),Z.stop(),Y&&(Y.flags|=8,H(ie,D,L,B)),oe&&St(oe,L),St(()=>{D.isUnmounted=!0},L),L&&L.pendingBranch&&!L.isUnmounted&&D.asyncDep&&!D.asyncResolved&&D.suspenseId===L.pendingId&&(L.deps--,L.deps===0&&L.resolve())},F=(D,L,B,W=!1,Z=!1,Y=0)=>{for(let ie=Y;ie<D.length;ie++)H(D[ie],L,B,W,Z)},E=D=>{if(D.shapeFlag&6)return E(D.component.subTree);if(D.shapeFlag&128)return D.suspense.next();const L=p(D.anchor||D.el),B=L&&L[cf];return B?p(B):L};let U=!1;const j=(D,L,B)=>{D==null?L._vnode&&H(L._vnode,null,null,!0):v(L._vnode||null,D,L,null,null,null,B),L._vnode=D,U||(U=!0,il(),rl(),U=!1)},ee={p:v,um:H,m:G,r:V,mt:$,mc:x,pc:P,pbc:k,n:E,o:e};return{render:j,hydrate:void 0,createApp:Nf(j)}}function ho({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Cn({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Hf(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Ll(e,t,n=!1){const i=e.children,s=t.children;if(me(i)&&me(s))for(let o=0;o<i.length;o++){const r=i[o];let a=s[o];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[o]=hn(s[o]),a.el=r.el),!n&&a.patchFlag!==-2&&Ll(r,a)),a.type===Wr&&(a.el=r.el)}}function jf(e){const t=e.slice(),n=[0];let i,s,o,r,a;const l=e.length;for(i=0;i<l;i++){const c=e[i];if(c!==0){if(s=n[n.length-1],e[s]<c){t[i]=s,n.push(i);continue}for(o=0,r=n.length-1;o<r;)a=o+r>>1,e[n[a]]<c?o=a+1:r=a;c<e[n[o]]&&(o>0&&(t[i]=n[o-1]),n[o]=i)}}for(o=n.length,r=n[o-1];o-- >0;)n[o]=r,r=t[r];return n}function Il(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Il(t)}function Gl(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const Wf=Symbol.for("v-scx"),Kf=()=>Hr(Wf);function He(e,t,n){return zl(e,t,n)}function zl(e,t,n=Ge){const{immediate:i,deep:s,flush:o,once:r}=n,a=Ze({},n);let l;if(Xr)if(o==="sync"){const p=Kf();l=p.__watcherHandles||(p.__watcherHandles=[])}else if(!t||i)a.once=!0;else{const p=()=>{};return p.stop=Gt,p.resume=Gt,p.pause=Gt,p}const c=st;a.call=(p,h,g)=>Dt(p,c,h,g);let d=!1;o==="post"?a.scheduler=p=>{St(p,c&&c.suspense)}:o!=="sync"&&(d=!0,a.scheduler=(p,h)=>{h?p():Js(p)}),a.augmentJob=p=>{t&&(p.flags|=4),d&&(p.flags|=2,c&&(p.id=c.uid,p.i=c))};const f=ef(e,t,a);return l&&l.push(f),f}function qf(e,t,n){const i=this.proxy,s=We(e)?e.includes(".")?Ul(i,e):()=>i[e]:e.bind(i,i);let o;be(t)?o=t:(o=t.handler,n=t);const r=yi(this),a=zl(s,o.bind(i),n);return r(),a}function Ul(e,t){const n=t.split(".");return()=>{let i=e;for(let s=0;s<n.length&&i;s++)i=i[n[s]];return i}}const Yf=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${ht(t)}Modifiers`]||e[`${xt(t)}Modifiers`];function Xf(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||Ge;let s=n;const o=t.startsWith("update:"),r=o&&Yf(i,t.slice(7));r&&(r.trim&&(s=n.map(d=>We(d)?d.trim():d)),r.number&&(s=n.map(xr)));let a,l=i[a=Ns(t)]||i[a=Ns(ht(t))];!l&&o&&(l=i[a=Ns(xt(t))]),l&&Dt(l,e,6,s);const c=i[a+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Dt(c,e,6,s)}}function $l(e,t,n=!1){const i=t.emitsCache,s=i.get(e);if(s!==void 0)return s;const o=e.emits;let r={},a=!1;if(!be(e)){const l=c=>{const d=$l(c,t,!0);d&&(a=!0,Ze(r,d))};!n&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!o&&!a?(ze(e)&&i.set(e,null),null):(me(o)?o.forEach(l=>r[l]=null):Ze(r,o),ze(e)&&i.set(e,r),r)}function jr(e,t){return!e||!yr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Oe(e,t[0].toLowerCase()+t.slice(1))||Oe(e,xt(t))||Oe(e,t))}function Cv(){}function Vl(e){const{type:t,vnode:n,proxy:i,withProxy:s,propsOptions:[o],slots:r,attrs:a,emit:l,render:c,renderCache:d,props:f,data:p,setupState:h,ctx:g,inheritAttrs:v}=e,b=Gr(e);let C,m;try{if(n.shapeFlag&4){const y=s||i,S=y;C=$t(c.call(S,y,d,f,h,p,g)),m=a}else{const y=t;C=$t(y.length>1?y(f,{attrs:a,slots:r,emit:l}):y(f,null)),m=t.props?a:Zf(a)}}catch(y){pi.length=0,Lr(y,e,1),C=Ke(gt)}let u=C;if(m&&v!==!1){const y=Object.keys(m),{shapeFlag:S}=u;y.length&&S&7&&(o&&y.some(Ms)&&(m=Jf(m,o)),u=un(u,m,!1,!0))}return n.dirs&&(u=un(u,null,!1,!0),u.dirs=u.dirs?u.dirs.concat(n.dirs):n.dirs),n.transition&&di(u,n.transition),C=u,Gr(b),C}const Zf=e=>{let t;for(const n in e)(n==="class"||n==="style"||yr(n))&&((t||(t={}))[n]=e[n]);return t},Jf=(e,t)=>{const n={};for(const i in e)(!Ms(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function Qf(e,t,n){const{props:i,children:s,component:o}=e,{props:r,children:a,patchFlag:l}=t,c=o.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?Bl(i,r,c):!!r;if(l&8){const d=t.dynamicProps;for(let f=0;f<d.length;f++){const p=d[f];if(r[p]!==i[p]&&!jr(c,p))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:i===r?!1:i?r?Bl(i,r,c):!0:!!r;return!1}function Bl(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const o=i[s];if(t[o]!==e[o]&&!jr(n,o))return!0}return!1}function e0({vnode:e,parent:t},n){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=n,t=t.parent;else break}}const Hl=e=>e.__isSuspense;function t0(e,t){t&&t.pendingBranch?me(e)?t.effects.push(...e):t.effects.push(e):lf(e)}const Re=Symbol.for("v-fgt"),Wr=Symbol.for("v-txt"),gt=Symbol.for("v-cmt"),fo=Symbol.for("v-stc"),pi=[];let wt=null;function ae(e=!1){pi.push(wt=e?null:[])}function n0(){pi.pop(),wt=pi[pi.length-1]||null}let gi=1;function jl(e){gi+=e,e<0&&wt&&(wt.hasOnce=!0)}function Wl(e){return e.dynamicChildren=gi>0?wt||Ln:null,n0(),gi>0&&wt&&wt.push(e),e}function ce(e,t,n,i,s,o){return Wl(J(e,t,n,i,s,o,!0))}function jn(e,t,n,i,s){return Wl(Ke(e,t,n,i,s,!0))}function mi(e){return e?e.__v_isVNode===!0:!1}function kn(e,t){return e.type===t.type&&e.key===t.key}const Kl=({key:e})=>e??null,Kr=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?We(e)||Qe(e)||be(e)?{i:et,r:e,k:t,f:!!n}:e:null);function J(e,t=null,n=null,i=0,s=null,o=e===Re?0:1,r=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Kl(t),ref:t&&Kr(t),scopeId:ol,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:et};return a?(po(l,n),o&128&&e.normalize(l)):n&&(l.shapeFlag|=We(n)?8:16),gi>0&&!r&&wt&&(l.patchFlag>0||o&6)&&l.patchFlag!==32&&wt.push(l),l}const Ke=i0;function i0(e,t=null,n=null,i=0,s=null,o=!1){if((!e||e===kf)&&(e=gt),mi(e)){const a=un(e,t,!0);return n&&po(a,n),gi>0&&!o&&wt&&(a.shapeFlag&6?wt[wt.indexOf(e)]=a:wt.push(a)),a.patchFlag=-2,a}if(m0(e)&&(e=e.__vccOpts),t){t=r0(t);let{class:a,style:l}=t;a&&!We(a)&&(t.class=Rt(a)),ze(l)&&(Ys(l)&&!me(l)&&(l=Ze({},l)),t.style=_n(l))}const r=We(e)?1:Hl(e)?128:al(e)?64:ze(e)?4:be(e)?2:0;return J(e,t,n,i,s,r,o,!0)}function r0(e){return e?Ys(e)||El(e)?Ze({},e):e:null}function un(e,t,n=!1,i=!1){const{props:s,ref:o,patchFlag:r,children:a,transition:l}=e,c=t?s0(s||{},t):s,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&Kl(c),ref:t&&t.ref?n&&o?me(o)?o.concat(Kr(t)):[o,Kr(t)]:Kr(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Re?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&un(e.ssContent),ssFallback:e.ssFallback&&un(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&i&&di(d,l.clone(d)),d}function qr(e=" ",t=0){return Ke(Wr,null,e,t)}function Ne(e="",t=!1){return t?(ae(),jn(gt,null,e)):Ke(gt,null,e)}function $t(e){return e==null||typeof e=="boolean"?Ke(gt):me(e)?Ke(Re,null,e.slice()):mi(e)?hn(e):Ke(Wr,null,String(e))}function hn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:un(e)}function po(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(me(t))n=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),po(e,s()),s._c&&(s._d=!0));return}else{n=32;const s=t._;!s&&!El(t)?t._ctx=et:s===3&&et&&(et.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else be(t)?(t={default:t,_ctx:et},n=32):(t=String(t),i&64?(n=16,t=[qr(t)]):n=8);e.children=t,e.shapeFlag|=n}function s0(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=Rt([t.class,i.class]));else if(s==="style")t.style=_n([t.style,i.style]);else if(yr(s)){const o=t[s],r=i[s];r&&o!==r&&!(me(o)&&o.includes(r))&&(t[s]=o?[].concat(o,r):r)}else s!==""&&(t[s]=i[s])}return t}function Vt(e,t,n,i=null){Dt(e,t,7,[n,i])}const o0=kl();let a0=0;function l0(e,t,n){const i=e.type,s=(t?t.appContext:e.appContext)||o0,o={uid:a0++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Ch(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Rl(i,s),emitsOptions:$l(i,s),emit:null,emitted:null,propsDefaults:Ge,inheritAttrs:i.inheritAttrs,ctx:Ge,data:Ge,props:Ge,attrs:Ge,slots:Ge,refs:Ge,setupState:Ge,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=Xf.bind(null,o),e.ce&&e.ce(o),o}let st=null;const c0=()=>st||et;let Yr,go;{const e=Ca(),t=(n,i)=>{let s;return(s=e[n])||(s=e[n]=[]),s.push(i),o=>{s.length>1?s.forEach(r=>r(o)):s[0](o)}};Yr=t("__VUE_INSTANCE_SETTERS__",n=>st=n),go=t("__VUE_SSR_SETTERS__",n=>Xr=n)}const yi=e=>{const t=st;return Yr(e),e.scope.on(),()=>{e.scope.off(),Yr(t)}},ql=()=>{st&&st.scope.off(),Yr(null)};function Yl(e){return e.vnode.shapeFlag&4}let Xr=!1;function d0(e,t=!1,n=!1){t&&go(t);const{props:i,children:s}=e.vnode,o=Yl(e);Lf(e,i,o,t),Uf(e,s,n);const r=o?u0(e,t):void 0;return t&&go(!1),r}function u0(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Tf);const{setup:i}=n;if(i){const s=e.setupContext=i.length>1?f0(e):null,o=yi(e);Wt();const r=Un(i,e,0,[e.props,s]);if(Kt(),o(),ba(r)){if(Bn(e)||pl(e),r.then(ql,ql),t)return r.then(a=>{Xl(e,a)}).catch(a=>{Lr(a,e,0)});e.asyncDep=r}else Xl(e,r)}else Zl(e)}function Xl(e,t,n){be(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:ze(t)&&(e.setupState=Qa(t)),Zl(e)}function Zl(e,t,n){const i=e.type;e.render||(e.render=i.render||Gt);{const s=yi(e);Wt();try{Ef(e)}finally{Kt(),s()}}}const h0={get(e,t){return ct(e,"get",""),e[t]}};function f0(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,h0),slots:e.slots,emit:e.emit,expose:t}}function Zr(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Qa(Kh(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in hi)return hi[n](e)},has(t,n){return n in t||n in hi}})):e.proxy}const p0=/(?:^|[-_])(\w)/g,g0=e=>e.replace(p0,t=>t.toUpperCase()).replace(/[-_]/g,"");function Jl(e,t=!0){return be(e)?e.displayName||e.name:e.name||t&&e.__name}function Ql(e,t,n=!1){let i=Jl(t);if(!i&&t.__file){const s=t.__file.match(/([^/\\]+)\.\w+$/);s&&(i=s[1])}if(!i&&e&&e.parent){const s=o=>{for(const r in o)if(o[r]===t)return r};i=s(e.components||e.parent.type.components)||s(e.appContext.components)}return i?g0(i):n?"App":"Anonymous"}function m0(e){return be(e)&&"__vccOpts"in e}const xe=(e,t)=>Jh(e,t,Xr);function y0(e,t,n){const i=arguments.length;return i===2?ze(t)&&!me(t)?mi(t)?Ke(e,null,[t]):Ke(e,t):Ke(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&mi(n)&&(n=[n]),Ke(e,t,n))}const v0="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let mo;const ec=typeof window<"u"&&window.trustedTypes;if(ec)try{mo=ec.createPolicy("vue",{createHTML:e=>e})}catch{}const tc=mo?e=>mo.createHTML(e):e=>e,_0="http://www.w3.org/2000/svg",b0="http://www.w3.org/1998/Math/MathML",en=typeof document<"u"?document:null,nc=en&&en.createElement("template"),S0={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const s=t==="svg"?en.createElementNS(_0,e):t==="mathml"?en.createElementNS(b0,e):n?en.createElement(e,{is:n}):en.createElement(e);return e==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:e=>en.createTextNode(e),createComment:e=>en.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>en.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,s,o){const r=n?n.previousSibling:t.lastChild;if(s&&(s===o||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),!(s===o||!(s=s.nextSibling)););else{nc.innerHTML=tc(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const a=nc.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,n)}return[r?r.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},fn="transition",vi="animation",_i=Symbol("_vtc"),ic={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},w0=Ze({},ll,ic),x0=(e=>(e.displayName="Transition",e.props=w0,e))((e,{slots:t})=>y0(hf,C0(e),t)),Pn=(e,t=[])=>{me(e)?e.forEach(n=>n(...t)):e&&e(...t)},rc=e=>e?me(e)?e.some(t=>t.length>1):e.length>1:!1;function C0(e){const t={};for(const R in e)R in ic||(t[R]=e[R]);if(e.css===!1)return t;const{name:n="v",type:i,duration:s,enterFromClass:o=`${n}-enter-from`,enterActiveClass:r=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=o,appearActiveClass:c=r,appearToClass:d=a,leaveFromClass:f=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:h=`${n}-leave-to`}=e,g=k0(s),v=g&&g[0],b=g&&g[1],{onBeforeEnter:C,onEnter:m,onEnterCancelled:u,onLeave:y,onLeaveCancelled:S,onBeforeAppear:A=C,onAppear:M=m,onAppearCancelled:x=u}=t,w=(R,I,$)=>{Tn(R,I?d:a),Tn(R,I?c:r),$&&$()},k=(R,I)=>{R._isLeaving=!1,Tn(R,f),Tn(R,h),Tn(R,p),I&&I()},T=R=>(I,$)=>{const z=R?M:m,q=()=>w(I,R,$);Pn(z,[I,q]),sc(()=>{Tn(I,R?l:o),pn(I,R?d:a),rc(z)||oc(I,i,v,q)})};return Ze(t,{onBeforeEnter(R){Pn(C,[R]),pn(R,o),pn(R,r)},onBeforeAppear(R){Pn(A,[R]),pn(R,l),pn(R,c)},onEnter:T(!1),onAppear:T(!0),onLeave(R,I){R._isLeaving=!0;const $=()=>k(R,I);pn(R,f),pn(R,p),E0(),sc(()=>{R._isLeaving&&(Tn(R,f),pn(R,h),rc(y)||oc(R,i,b,$))}),Pn(y,[R,$])},onEnterCancelled(R){w(R,!1),Pn(u,[R])},onAppearCancelled(R){w(R,!0),Pn(x,[R])},onLeaveCancelled(R){k(R),Pn(S,[R])}})}function k0(e){if(e==null)return null;if(ze(e))return[yo(e.enter),yo(e.leave)];{const t=yo(e);return[t,t]}}function yo(e){return Fs(e)}function pn(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[_i]||(e[_i]=new Set)).add(t)}function Tn(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const n=e[_i];n&&(n.delete(t),n.size||(e[_i]=void 0))}function sc(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let P0=0;function oc(e,t,n,i){const s=e._endId=++P0,o=()=>{s===e._endId&&i()};if(n!=null)return setTimeout(o,n);const{type:r,timeout:a,propCount:l}=T0(e,t);if(!r)return i();const c=r+"end";let d=0;const f=()=>{e.removeEventListener(c,p),o()},p=h=>{h.target===e&&++d>=l&&f()};setTimeout(()=>{d<l&&f()},a+1),e.addEventListener(c,p)}function T0(e,t){const n=window.getComputedStyle(e),i=g=>(n[g]||"").split(", "),s=i(`${fn}Delay`),o=i(`${fn}Duration`),r=ac(s,o),a=i(`${vi}Delay`),l=i(`${vi}Duration`),c=ac(a,l);let d=null,f=0,p=0;t===fn?r>0&&(d=fn,f=r,p=o.length):t===vi?c>0&&(d=vi,f=c,p=l.length):(f=Math.max(r,c),d=f>0?r>c?fn:vi:null,p=d?d===fn?o.length:l.length:0);const h=d===fn&&/\b(transform|all)(,|$)/.test(i(`${fn}Property`).toString());return{type:d,timeout:f,propCount:p,hasTransform:h}}function ac(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,i)=>lc(n)+lc(e[i])))}function lc(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function E0(){return document.body.offsetHeight}function A0(e,t,n){const i=e[_i];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const cc=Symbol("_vod"),R0=Symbol("_vsh"),M0=Symbol(""),D0=/(^|;)\s*display\s*:/;function O0(e,t,n){const i=e.style,s=We(n);let o=!1;if(n&&!s){if(t)if(We(t))for(const r of t.split(";")){const a=r.slice(0,r.indexOf(":")).trim();n[a]==null&&Jr(i,a,"")}else for(const r in t)n[r]==null&&Jr(i,r,"");for(const r in n)r==="display"&&(o=!0),Jr(i,r,n[r])}else if(s){if(t!==n){const r=i[M0];r&&(n+=";"+r),i.cssText=n,o=D0.test(n)}}else t&&e.removeAttribute("style");cc in e&&(e[cc]=o?i.display:"",e[R0]&&(i.display="none"))}const dc=/\s*!important$/;function Jr(e,t,n){if(me(n))n.forEach(i=>Jr(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=N0(e,t);dc.test(n)?e.setProperty(xt(i),n.replace(dc,""),"important"):e[i]=n}}const uc=["Webkit","Moz","ms"],vo={};function N0(e,t){const n=vo[t];if(n)return n;let i=ht(t);if(i!=="filter"&&i in e)return vo[t]=i;i=Sr(i);for(let s=0;s<uc.length;s++){const o=uc[s]+i;if(o in e)return vo[t]=o}return t}const hc="http://www.w3.org/1999/xlink";function fc(e,t,n,i,s,o=Sh(t)){i&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(hc,t.slice(6,t.length)):e.setAttributeNS(hc,t,n):n==null||o&&!ka(n)?e.removeAttribute(t):e.setAttribute(t,o?"":zt(n)?String(n):n)}function pc(e,t,n,i){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?tc(n):n);return}const s=e.tagName;if(t==="value"&&s!=="PROGRESS"&&!s.includes("-")){const r=s==="OPTION"?e.getAttribute("value")||"":e.value,a=n==null?e.type==="checkbox"?"on":"":String(n);(r!==a||!("_value"in e))&&(e.value=a),n==null&&e.removeAttribute(t),e._value=n;return}let o=!1;if(n===""||n==null){const r=typeof e[t];r==="boolean"?n=ka(n):n==null&&r==="string"?(n="",o=!0):r==="number"&&(n=0,o=!0)}try{e[t]=n}catch{}o&&e.removeAttribute(t)}function En(e,t,n,i){e.addEventListener(t,n,i)}function F0(e,t,n,i){e.removeEventListener(t,n,i)}const gc=Symbol("_vei");function L0(e,t,n,i,s=null){const o=e[gc]||(e[gc]={}),r=o[t];if(i&&r)r.value=i;else{const[a,l]=I0(t);if(i){const c=o[t]=U0(i,s);En(e,a,c,l)}else r&&(F0(e,a,r,l),o[t]=void 0)}}const mc=/(?:Once|Passive|Capture)$/;function I0(e){let t;if(mc.test(e)){t={};let i;for(;i=e.match(mc);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):xt(e.slice(2)),t]}let _o=0;const G0=Promise.resolve(),z0=()=>_o||(G0.then(()=>_o=0),_o=Date.now());function U0(e,t){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;Dt($0(i,n.value),t,5,[i])};return n.value=e,n.attached=z0(),n}function $0(e,t){if(me(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const yc=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,V0=(e,t,n,i,s,o)=>{const r=s==="svg";t==="class"?A0(e,i,r):t==="style"?O0(e,n,i):yr(t)?Ms(t)||L0(e,t,n,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):B0(e,t,i,r))?(pc(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&fc(e,t,i,r,o,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!We(i))?pc(e,ht(t),i):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),fc(e,t,i,r))};function B0(e,t,n,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&yc(t)&&be(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return yc(t)&&We(n)?!1:t in e}const vc={};/*! #__NO_SIDE_EFFECTS__ */function H0(e,t,n){const i=Zt(e,t);_r(i)&&Ze(i,t);class s extends bo{constructor(r){super(i,r,n)}}return s.def=i,s}const j0=typeof HTMLElement<"u"?HTMLElement:class{};class bo extends j0{constructor(t,n={},i=Cc){super(),this._def=t,this._props=n,this._createApp=i,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&i!==Cc?this._root=this.shadowRoot:t.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let t=this;for(;t=t&&(t.parentNode||t.host);)if(t instanceof bo){this._parent=t;break}this._instance||(this._resolved?(this._setParent(),this._update()):t&&t._pendingResolve?this._pendingResolve=t._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(t=this._parent){t&&(this._instance.parent=t._instance,this._instance.provides=t._instance.provides)}disconnectedCallback(){this._connected=!1,li(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const s of i)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const t=(i,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:o,styles:r}=i;let a;if(o&&!me(o))for(const l in o){const c=o[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=Fs(this._props[l])),(a||(a=Object.create(null)))[ht(l)]=!0)}this._numberProps=a,s&&this._resolveProps(i),this.shadowRoot&&this._applyStyles(r),this._mount(i)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(i=>t(this._def=i,!0)):t(this._def)}_mount(t){this._app=this._createApp(t),t.configureApp&&t.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const i in n)Oe(this,i)||Object.defineProperty(this,i,{get:()=>fe(n[i])})}_resolveProps(t){const{props:n}=t,i=me(n)?n:Object.keys(n||{});for(const s of Object.keys(this))s[0]!=="_"&&i.includes(s)&&this._setProp(s,this[s]);for(const s of i.map(ht))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(o){this._setProp(s,o,!0,!0)}})}_setAttr(t){if(t.startsWith("data-v-"))return;const n=this.hasAttribute(t);let i=n?this.getAttribute(t):vc;const s=ht(t);n&&this._numberProps&&this._numberProps[s]&&(i=Fs(i)),this._setProp(s,i,!1,!0)}_getProp(t){return this._props[t]}_setProp(t,n,i=!0,s=!1){n!==this._props[t]&&(n===vc?delete this._props[t]:(this._props[t]=n,t==="key"&&this._app&&(this._app._ceVNode.key=n)),s&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(xt(t),""):typeof n=="string"||typeof n=="number"?this.setAttribute(xt(t),n+""):n||this.removeAttribute(xt(t))))}_update(){Z0(this._createVNode(),this._root)}_createVNode(){const t={};this.shadowRoot||(t.onVnodeMounted=t.onVnodeUpdated=this._renderSlots.bind(this));const n=Ke(this._def,Ze(t,this._props));return this._instance||(n.ce=i=>{this._instance=i,i.ce=this,i.isCE=!0;const s=(o,r)=>{this.dispatchEvent(new CustomEvent(o,_r(r[0])?Ze({detail:r},r[0]):{detail:r}))};i.emit=(o,...r)=>{s(o,r),xt(o)!==o&&s(xt(o),r)},this._setParent()}),n}_applyStyles(t,n){if(!t)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const i=this._nonce;for(let s=t.length-1;s>=0;s--){const o=document.createElement("style");i&&o.setAttribute("nonce",i),o.textContent=t[s],this.shadowRoot.prepend(o)}}_parseSlots(){const t=this._slots={};let n;for(;n=this.firstChild;){const i=n.nodeType===1&&n.getAttribute("slot")||"default";(t[i]||(t[i]=[])).push(n),this.removeChild(n)}}_renderSlots(){const t=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let i=0;i<t.length;i++){const s=t[i],o=s.getAttribute("name")||"default",r=this._slots[o],a=s.parentNode;if(r)for(const l of r){if(n&&l.nodeType===1){const c=n+"-s",d=document.createTreeWalker(l,1);l.setAttribute(c,"");let f;for(;f=d.nextNode();)f.setAttribute(c,"")}a.insertBefore(l,s)}else for(;s.firstChild;)a.insertBefore(s.firstChild,s);a.removeChild(s)}}_injectChildStyle(t){this._applyStyles(t.styles,t)}_removeChildStyle(t){}}const Qr=e=>{const t=e.props["onUpdate:modelValue"]||!1;return me(t)?n=>wr(t,n):t};function W0(e){e.target.composing=!0}function _c(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Wn=Symbol("_assign"),bc={created(e,{modifiers:{lazy:t,trim:n,number:i}},s){e[Wn]=Qr(s);const o=i||s.props&&s.props.type==="number";En(e,t?"change":"input",r=>{if(r.target.composing)return;let a=e.value;n&&(a=a.trim()),o&&(a=xr(a)),e[Wn](a)}),n&&En(e,"change",()=>{e.value=e.value.trim()}),t||(En(e,"compositionstart",W0),En(e,"compositionend",_c),En(e,"change",_c))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:i,trim:s,number:o}},r){if(e[Wn]=Qr(r),e.composing)return;const a=(o||e.type==="number")&&!/^0\d/.test(e.value)?xr(e.value):e.value,l=t??"";a!==l&&(document.activeElement===e&&e.type!=="range"&&(i&&t===n||s&&e.value.trim()===l)||(e.value=l))}},K0={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const s=vr(t);En(e,"change",()=>{const o=Array.prototype.filter.call(e.options,r=>r.selected).map(r=>n?xr(es(r)):es(r));e[Wn](e.multiple?s?new Set(o):o:o[0]),e._assigning=!0,li(()=>{e._assigning=!1})}),e[Wn]=Qr(i)},mounted(e,{value:t}){Sc(e,t)},beforeUpdate(e,t,n){e[Wn]=Qr(n)},updated(e,{value:t}){e._assigning||Sc(e,t)}};function Sc(e,t){const n=e.multiple,i=me(t);if(!(n&&!i&&!vr(t))){for(let s=0,o=e.options.length;s<o;s++){const r=e.options[s],a=es(r);if(n)if(i){const l=typeof a;l==="string"||l==="number"?r.selected=t.some(c=>String(c)===String(a)):r.selected=xh(t,a)>-1}else r.selected=t.has(a);else if(Cr(es(r),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function es(e){return"_value"in e?e._value:e.value}const q0=["ctrl","shift","alt","meta"],Y0={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>q0.some(n=>e[`${n}Key`]&&!t.includes(n))},So=(e,t)=>{const n=e._withMods||(e._withMods={}),i=t.join(".");return n[i]||(n[i]=(s,...o)=>{for(let r=0;r<t.length;r++){const a=Y0[t[r]];if(a&&a(s,t))return}return e(s,...o)})},X0=Ze({patchProp:V0},S0);let wc;function xc(){return wc||(wc=Vf(X0))}const Z0=(...e)=>{xc().render(...e)},Cc=(...e)=>{const t=xc().createApp(...e),{mount:n}=t;return t.mount=i=>{const s=Q0(i);if(!s)return;const o=t._component;!be(o)&&!o.render&&!o.template&&(o.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const r=n(s,!1,J0(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),r},t};function J0(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Q0(e){return We(e)?document.querySelector(e):e}var kc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ep(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ts={exports:{}},bi={},wo={},xo={},Pc;function ke(){return Pc||(Pc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof kc<"u"?kc:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.21",isBrowser:n(),isUnminified:/param/.test(function(s){}.toString()),dblClickWindow:400,getAngle(s){return e.Konva.angleDeg?s*t:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var s;return(s=e.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(s){e.glob.Konva=s}};const i=s=>{e.Konva[s.prototype.getClassName()]=s};e._registerNode=i,e.Konva._injectGlobal(e.Konva)}(xo)),xo}var Co={},Tc;function qe(){return Tc||(Tc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=ke();class n{constructor(y=[1,0,0,1,0,0]){this.dirty=!1,this.m=y&&y.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(y){y.m[0]=this.m[0],y.m[1]=this.m[1],y.m[2]=this.m[2],y.m[3]=this.m[3],y.m[4]=this.m[4],y.m[5]=this.m[5]}point(y){const S=this.m;return{x:S[0]*y.x+S[2]*y.y+S[4],y:S[1]*y.x+S[3]*y.y+S[5]}}translate(y,S){return this.m[4]+=this.m[0]*y+this.m[2]*S,this.m[5]+=this.m[1]*y+this.m[3]*S,this}scale(y,S){return this.m[0]*=y,this.m[1]*=y,this.m[2]*=S,this.m[3]*=S,this}rotate(y){const S=Math.cos(y),A=Math.sin(y),M=this.m[0]*S+this.m[2]*A,x=this.m[1]*S+this.m[3]*A,w=this.m[0]*-A+this.m[2]*S,k=this.m[1]*-A+this.m[3]*S;return this.m[0]=M,this.m[1]=x,this.m[2]=w,this.m[3]=k,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(y,S){const A=this.m[0]+this.m[2]*S,M=this.m[1]+this.m[3]*S,x=this.m[2]+this.m[0]*y,w=this.m[3]+this.m[1]*y;return this.m[0]=A,this.m[1]=M,this.m[2]=x,this.m[3]=w,this}multiply(y){const S=this.m[0]*y.m[0]+this.m[2]*y.m[1],A=this.m[1]*y.m[0]+this.m[3]*y.m[1],M=this.m[0]*y.m[2]+this.m[2]*y.m[3],x=this.m[1]*y.m[2]+this.m[3]*y.m[3],w=this.m[0]*y.m[4]+this.m[2]*y.m[5]+this.m[4],k=this.m[1]*y.m[4]+this.m[3]*y.m[5]+this.m[5];return this.m[0]=S,this.m[1]=A,this.m[2]=M,this.m[3]=x,this.m[4]=w,this.m[5]=k,this}invert(){const y=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),S=this.m[3]*y,A=-this.m[1]*y,M=-this.m[2]*y,x=this.m[0]*y,w=y*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),k=y*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=S,this.m[1]=A,this.m[2]=M,this.m[3]=x,this.m[4]=w,this.m[5]=k,this}getMatrix(){return this.m}decompose(){const y=this.m[0],S=this.m[1],A=this.m[2],M=this.m[3],x=this.m[4],w=this.m[5],k=y*M-S*A,T={x,y:w,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(y!=0||S!=0){const R=Math.sqrt(y*y+S*S);T.rotation=S>0?Math.acos(y/R):-Math.acos(y/R),T.scaleX=R,T.scaleY=k/R,T.skewX=(y*A+S*M)/k,T.skewY=0}else if(A!=0||M!=0){const R=Math.sqrt(A*A+M*M);T.rotation=Math.PI/2-(M>0?Math.acos(-A/R):-Math.acos(A/R)),T.scaleX=k/R,T.scaleY=R,T.skewX=0,T.skewY=(y*A+S*M)/k}return T.rotation=e.Util._getRotation(T.rotation),T}}e.Transform=n;const i="[object Array]",s="[object Number]",o="[object String]",r="[object Boolean]",a=Math.PI/180,l=180/Math.PI,c="#",d="",f="0",p="Konva warning: ",h="Konva error: ",g="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},b=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const m=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(u){setTimeout(u,60)};e.Util={_isElement(u){return!!(u&&u.nodeType==1)},_isFunction(u){return!!(u&&u.constructor&&u.call&&u.apply)},_isPlainObject(u){return!!u&&u.constructor===Object},_isArray(u){return Object.prototype.toString.call(u)===i},_isNumber(u){return Object.prototype.toString.call(u)===s&&!isNaN(u)&&isFinite(u)},_isString(u){return Object.prototype.toString.call(u)===o},_isBoolean(u){return Object.prototype.toString.call(u)===r},isObject(u){return u instanceof Object},isValidSelector(u){if(typeof u!="string")return!1;const y=u[0];return y==="#"||y==="."||y===y.toUpperCase()},_sign(u){return u===0||u>0?1:-1},requestAnimFrame(u){C.push(u),C.length===1&&m(function(){const y=C;C=[],y.forEach(function(S){S()})})},createCanvasElement(){const u=document.createElement("canvas");try{u.style=u.style||{}}catch{}return u},createImageElement(){return document.createElement("img")},_isInDocument(u){for(;u=u.parentNode;)if(u==document)return!0;return!1},_urlToImage(u,y){const S=e.Util.createImageElement();S.onload=function(){y(S)},S.src=u},_rgbToHex(u,y,S){return(16777216+(u<<16)+(y<<8)+S).toString(16).slice(1)},_hexToRgb(u){u=u.replace(c,d);const y=parseInt(u,16);return{r:y>>16&255,g:y>>8&255,b:y&255}},getRandomColor(){let u=(Math.random()*16777215<<0).toString(16);for(;u.length<6;)u=f+u;return c+u},getRGB(u){let y;return u in v?(y=v[u],{r:y[0],g:y[1],b:y[2]}):u[0]===c?this._hexToRgb(u.substring(1)):u.substr(0,4)===g?(y=b.exec(u.replace(/ /g,"")),{r:parseInt(y[1],10),g:parseInt(y[2],10),b:parseInt(y[3],10)}):{r:0,g:0,b:0}},colorToRGBA(u){return u=u||"black",e.Util._namedColorToRBA(u)||e.Util._hex3ColorToRGBA(u)||e.Util._hex4ColorToRGBA(u)||e.Util._hex6ColorToRGBA(u)||e.Util._hex8ColorToRGBA(u)||e.Util._rgbColorToRGBA(u)||e.Util._rgbaColorToRGBA(u)||e.Util._hslColorToRGBA(u)},_namedColorToRBA(u){const y=v[u.toLowerCase()];return y?{r:y[0],g:y[1],b:y[2],a:1}:null},_rgbColorToRGBA(u){if(u.indexOf("rgb(")===0){u=u.match(/rgb\(([^)]+)\)/)[1];const y=u.split(/ *, */).map(Number);return{r:y[0],g:y[1],b:y[2],a:1}}},_rgbaColorToRGBA(u){if(u.indexOf("rgba(")===0){u=u.match(/rgba\(([^)]+)\)/)[1];const y=u.split(/ *, */).map((S,A)=>S.slice(-1)==="%"?A===3?parseInt(S)/100:parseInt(S)/100*255:Number(S));return{r:y[0],g:y[1],b:y[2],a:y[3]}}},_hex8ColorToRGBA(u){if(u[0]==="#"&&u.length===9)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:parseInt(u.slice(7,9),16)/255}},_hex6ColorToRGBA(u){if(u[0]==="#"&&u.length===7)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:1}},_hex4ColorToRGBA(u){if(u[0]==="#"&&u.length===5)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:parseInt(u[4]+u[4],16)/255}},_hex3ColorToRGBA(u){if(u[0]==="#"&&u.length===4)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:1}},_hslColorToRGBA(u){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(u)){const[y,...S]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(u),A=Number(S[0])/360,M=Number(S[1])/100,x=Number(S[2])/100;let w,k,T;if(M===0)return T=x*255,{r:Math.round(T),g:Math.round(T),b:Math.round(T),a:1};x<.5?w=x*(1+M):w=x+M-x*M;const R=2*x-w,I=[0,0,0];for(let $=0;$<3;$++)k=A+.3333333333333333*-($-1),k<0&&k++,k>1&&k--,6*k<1?T=R+(w-R)*6*k:2*k<1?T=w:3*k<2?T=R+(w-R)*(.6666666666666666-k)*6:T=R,I[$]=T*255;return{r:Math.round(I[0]),g:Math.round(I[1]),b:Math.round(I[2]),a:1}}},haveIntersection(u,y){return!(y.x>u.x+u.width||y.x+y.width<u.x||y.y>u.y+u.height||y.y+y.height<u.y)},cloneObject(u){const y={};for(const S in u)this._isPlainObject(u[S])?y[S]=this.cloneObject(u[S]):this._isArray(u[S])?y[S]=this.cloneArray(u[S]):y[S]=u[S];return y},cloneArray(u){return u.slice(0)},degToRad(u){return u*a},radToDeg(u){return u*l},_degToRad(u){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(u)},_radToDeg(u){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(u)},_getRotation(u){return t.Konva.angleDeg?e.Util.radToDeg(u):u},_capitalize(u){return u.charAt(0).toUpperCase()+u.slice(1)},throw(u){throw new Error(h+u)},error(u){console.error(h+u)},warn(u){t.Konva.showWarnings&&console.warn(p+u)},each(u,y){for(const S in u)y(S,u[S])},_inRange(u,y,S){return y<=u&&u<S},_getProjectionToSegment(u,y,S,A,M,x){let w,k,T;const R=(u-S)*(u-S)+(y-A)*(y-A);if(R==0)w=u,k=y,T=(M-S)*(M-S)+(x-A)*(x-A);else{const I=((M-u)*(S-u)+(x-y)*(A-y))/R;I<0?(w=u,k=y,T=(u-M)*(u-M)+(y-x)*(y-x)):I>1?(w=S,k=A,T=(S-M)*(S-M)+(A-x)*(A-x)):(w=u+I*(S-u),k=y+I*(A-y),T=(w-M)*(w-M)+(k-x)*(k-x))}return[w,k,T]},_getProjectionToLine(u,y,S){const A=e.Util.cloneObject(u);let M=Number.MAX_VALUE;return y.forEach(function(x,w){if(!S&&w===y.length-1)return;const k=y[(w+1)%y.length],T=e.Util._getProjectionToSegment(x.x,x.y,k.x,k.y,u.x,u.y),R=T[0],I=T[1],$=T[2];$<M&&(A.x=R,A.y=I,M=$)}),A},_prepareArrayForTween(u,y,S){const A=[],M=[];if(u.length>y.length){const w=y;y=u,u=w}for(let w=0;w<u.length;w+=2)A.push({x:u[w],y:u[w+1]});for(let w=0;w<y.length;w+=2)M.push({x:y[w],y:y[w+1]});const x=[];return M.forEach(function(w){const k=e.Util._getProjectionToLine(w,A,S);x.push(k.x),x.push(k.y)}),x},_prepareToStringify(u){let y;u.visitedByCircularReferenceRemoval=!0;for(const S in u)if(u.hasOwnProperty(S)&&u[S]&&typeof u[S]=="object"){if(y=Object.getOwnPropertyDescriptor(u,S),u[S].visitedByCircularReferenceRemoval||e.Util._isElement(u[S]))if(y.configurable)delete u[S];else return null;else if(e.Util._prepareToStringify(u[S])===null)if(y.configurable)delete u[S];else return null}return delete u.visitedByCircularReferenceRemoval,u},_assign(u,y){for(const S in y)u[S]=y[S];return u},_getFirstPointerId(u){return u.touches?u.changedTouches[0].identifier:u.pointerId||999},releaseCanvas(...u){t.Konva.releaseCanvasOnDestroy&&u.forEach(y=>{y.width=0,y.height=0})},drawRoundedRectPath(u,y,S,A){let M=0,x=0,w=0,k=0;typeof A=="number"?M=x=w=k=Math.min(A,y/2,S/2):(M=Math.min(A[0]||0,y/2,S/2),x=Math.min(A[1]||0,y/2,S/2),k=Math.min(A[2]||0,y/2,S/2),w=Math.min(A[3]||0,y/2,S/2)),u.moveTo(M,0),u.lineTo(y-x,0),u.arc(y-x,x,x,Math.PI*3/2,0,!1),u.lineTo(y,S-k),u.arc(y-k,S-k,k,0,Math.PI/2,!1),u.lineTo(w,S),u.arc(w,S-w,w,Math.PI/2,Math.PI,!1),u.lineTo(0,M),u.arc(M,M,M,Math.PI,Math.PI*3/2,!1)}}}(Co)),Co}var Si={},tn={},nn={},Ec;function Ac(){if(Ec)return nn;Ec=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.HitContext=nn.SceneContext=nn.Context=void 0;const e=qe(),t=ke();function n(C){const m=[],u=C.length,y=e.Util;for(let S=0;S<u;S++){let A=C[S];y._isNumber(A)?A=Math.round(A*1e3)/1e3:y._isString(A)||(A=A+""),m.push(A)}return m}const i=",",s="(",o=")",r="([",a="])",l=";",c="()",d="=",f=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],p=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],h=100;let g=class{constructor(m){this.canvas=m,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(m){m.fillEnabled()&&this._fill(m)}_fill(m){}strokeShape(m){m.hasStroke()&&this._stroke(m)}_stroke(m){}fillStrokeShape(m){m.attrs.fillAfterStrokeEnabled?(this.strokeShape(m),this.fillShape(m)):(this.fillShape(m),this.strokeShape(m))}getTrace(m,u){let y=this.traceArr,S=y.length,A="",M,x,w,k;for(M=0;M<S;M++)x=y[M],w=x.method,w?(k=x.args,A+=w,m?A+=c:e.Util._isArray(k[0])?A+=r+k.join(i)+a:(u&&(k=k.map(T=>typeof T=="number"?Math.floor(T):T)),A+=s+k.join(i)+o)):(A+=x.property,m||(A+=d+x.val)),A+=l;return A}clearTrace(){this.traceArr=[]}_trace(m){let u=this.traceArr,y;u.push(m),y=u.length,y>=h&&u.shift()}reset(){const m=this.getCanvas().getPixelRatio();this.setTransform(1*m,0,0,1*m,0,0)}getCanvas(){return this.canvas}clear(m){const u=this.getCanvas();m?this.clearRect(m.x||0,m.y||0,m.width||0,m.height||0):this.clearRect(0,0,u.getWidth()/u.pixelRatio,u.getHeight()/u.pixelRatio)}_applyLineCap(m){const u=m.attrs.lineCap;u&&this.setAttr("lineCap",u)}_applyOpacity(m){const u=m.getAbsoluteOpacity();u!==1&&this.setAttr("globalAlpha",u)}_applyLineJoin(m){const u=m.attrs.lineJoin;u&&this.setAttr("lineJoin",u)}setAttr(m,u){this._context[m]=u}arc(m,u,y,S,A,M){this._context.arc(m,u,y,S,A,M)}arcTo(m,u,y,S,A){this._context.arcTo(m,u,y,S,A)}beginPath(){this._context.beginPath()}bezierCurveTo(m,u,y,S,A,M){this._context.bezierCurveTo(m,u,y,S,A,M)}clearRect(m,u,y,S){this._context.clearRect(m,u,y,S)}clip(...m){this._context.clip.apply(this._context,m)}closePath(){this._context.closePath()}createImageData(m,u){const y=arguments;if(y.length===2)return this._context.createImageData(m,u);if(y.length===1)return this._context.createImageData(m)}createLinearGradient(m,u,y,S){return this._context.createLinearGradient(m,u,y,S)}createPattern(m,u){return this._context.createPattern(m,u)}createRadialGradient(m,u,y,S,A,M){return this._context.createRadialGradient(m,u,y,S,A,M)}drawImage(m,u,y,S,A,M,x,w,k){const T=arguments,R=this._context;T.length===3?R.drawImage(m,u,y):T.length===5?R.drawImage(m,u,y,S,A):T.length===9&&R.drawImage(m,u,y,S,A,M,x,w,k)}ellipse(m,u,y,S,A,M,x,w){this._context.ellipse(m,u,y,S,A,M,x,w)}isPointInPath(m,u,y,S){return y?this._context.isPointInPath(y,m,u,S):this._context.isPointInPath(m,u,S)}fill(...m){this._context.fill.apply(this._context,m)}fillRect(m,u,y,S){this._context.fillRect(m,u,y,S)}strokeRect(m,u,y,S){this._context.strokeRect(m,u,y,S)}fillText(m,u,y,S){S?this._context.fillText(m,u,y,S):this._context.fillText(m,u,y)}measureText(m){return this._context.measureText(m)}getImageData(m,u,y,S){return this._context.getImageData(m,u,y,S)}lineTo(m,u){this._context.lineTo(m,u)}moveTo(m,u){this._context.moveTo(m,u)}rect(m,u,y,S){this._context.rect(m,u,y,S)}roundRect(m,u,y,S,A){this._context.roundRect(m,u,y,S,A)}putImageData(m,u,y){this._context.putImageData(m,u,y)}quadraticCurveTo(m,u,y,S){this._context.quadraticCurveTo(m,u,y,S)}restore(){this._context.restore()}rotate(m){this._context.rotate(m)}save(){this._context.save()}scale(m,u){this._context.scale(m,u)}setLineDash(m){this._context.setLineDash?this._context.setLineDash(m):"mozDash"in this._context?this._context.mozDash=m:"webkitLineDash"in this._context&&(this._context.webkitLineDash=m)}getLineDash(){return this._context.getLineDash()}setTransform(m,u,y,S,A,M){this._context.setTransform(m,u,y,S,A,M)}stroke(m){m?this._context.stroke(m):this._context.stroke()}strokeText(m,u,y,S){this._context.strokeText(m,u,y,S)}transform(m,u,y,S,A,M){this._context.transform(m,u,y,S,A,M)}translate(m,u){this._context.translate(m,u)}_enableTrace(){let m=this,u=f.length,y=this.setAttr,S,A;const M=function(x){let w=m[x],k;m[x]=function(){return A=n(Array.prototype.slice.call(arguments,0)),k=w.apply(m,arguments),m._trace({method:x,args:A}),k}};for(S=0;S<u;S++)M(f[S]);m.setAttr=function(){y.apply(m,arguments);const x=arguments[0];let w=arguments[1];(x==="shadowOffsetX"||x==="shadowOffsetY"||x==="shadowBlur")&&(w=w/this.canvas.getPixelRatio()),m._trace({property:x,val:w})}}_applyGlobalCompositeOperation(m){const u=m.attrs.globalCompositeOperation;!u||u==="source-over"||this.setAttr("globalCompositeOperation",u)}};nn.Context=g,p.forEach(function(C){Object.defineProperty(g.prototype,C,{get(){return this._context[C]},set(m){this._context[C]=m}})});class v extends g{constructor(m,{willReadFrequently:u=!1}={}){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:u})}_fillColor(m){const u=m.fill();this.setAttr("fillStyle",u),m._fillFunc(this)}_fillPattern(m){this.setAttr("fillStyle",m._getFillPattern()),m._fillFunc(this)}_fillLinearGradient(m){const u=m._getLinearGradient();u&&(this.setAttr("fillStyle",u),m._fillFunc(this))}_fillRadialGradient(m){const u=m._getRadialGradient();u&&(this.setAttr("fillStyle",u),m._fillFunc(this))}_fill(m){const u=m.fill(),y=m.getFillPriority();if(u&&y==="color"){this._fillColor(m);return}const S=m.getFillPatternImage();if(S&&y==="pattern"){this._fillPattern(m);return}const A=m.getFillLinearGradientColorStops();if(A&&y==="linear-gradient"){this._fillLinearGradient(m);return}const M=m.getFillRadialGradientColorStops();if(M&&y==="radial-gradient"){this._fillRadialGradient(m);return}u?this._fillColor(m):S?this._fillPattern(m):A?this._fillLinearGradient(m):M&&this._fillRadialGradient(m)}_strokeLinearGradient(m){const u=m.getStrokeLinearGradientStartPoint(),y=m.getStrokeLinearGradientEndPoint(),S=m.getStrokeLinearGradientColorStops(),A=this.createLinearGradient(u.x,u.y,y.x,y.y);if(S){for(let M=0;M<S.length;M+=2)A.addColorStop(S[M],S[M+1]);this.setAttr("strokeStyle",A)}}_stroke(m){const u=m.dash(),y=m.getStrokeScaleEnabled();if(m.hasStroke()){if(!y){this.save();const A=this.getCanvas().getPixelRatio();this.setTransform(A,0,0,A,0,0)}this._applyLineCap(m),u&&m.dashEnabled()&&(this.setLineDash(u),this.setAttr("lineDashOffset",m.dashOffset())),this.setAttr("lineWidth",m.strokeWidth()),m.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),m.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(m):this.setAttr("strokeStyle",m.stroke()),m._strokeFunc(this),y||this.restore()}}_applyShadow(m){var u,y,S;const A=(u=m.getShadowRGBA())!==null&&u!==void 0?u:"black",M=(y=m.getShadowBlur())!==null&&y!==void 0?y:5,x=(S=m.getShadowOffset())!==null&&S!==void 0?S:{x:0,y:0},w=m.getAbsoluteScale(),k=this.canvas.getPixelRatio(),T=w.x*k,R=w.y*k;this.setAttr("shadowColor",A),this.setAttr("shadowBlur",M*Math.min(Math.abs(T),Math.abs(R))),this.setAttr("shadowOffsetX",x.x*T),this.setAttr("shadowOffsetY",x.y*R)}}nn.SceneContext=v;class b extends g{constructor(m){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:!0})}_fill(m){this.save(),this.setAttr("fillStyle",m.colorKey),m._fillFuncHit(this),this.restore()}strokeShape(m){m.hasHitStroke()&&this._stroke(m)}_stroke(m){if(m.hasHitStroke()){const u=m.getStrokeScaleEnabled();if(!u){this.save();const A=this.getCanvas().getPixelRatio();this.setTransform(A,0,0,A,0,0)}this._applyLineCap(m);const y=m.hitStrokeWidth(),S=y==="auto"?m.strokeWidth():y;this.setAttr("lineWidth",S),this.setAttr("strokeStyle",m.colorKey),m._strokeFuncHit(this),u||this.restore()}}}return nn.HitContext=b,nn}var Rc;function ns(){if(Rc)return tn;Rc=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.HitCanvas=tn.SceneCanvas=tn.Canvas=void 0;const e=qe(),t=Ac(),n=ke();let i;function s(){if(i)return i;const l=e.Util.createCanvasElement(),c=l.getContext("2d");return i=function(){const d=n.Konva._global.devicePixelRatio||1,f=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;return d/f}(),e.Util.releaseCanvas(l),i}let o=class{constructor(c){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const f=(c||{}).pixelRatio||n.Konva.pixelRatio||s();this.pixelRatio=f,this._canvas=e.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(c){const d=this.pixelRatio;this.pixelRatio=c,this.setSize(this.getWidth()/d,this.getHeight()/d)}setWidth(c){this.width=this._canvas.width=c*this.pixelRatio,this._canvas.style.width=c+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}setHeight(c){this.height=this._canvas.height=c*this.pixelRatio,this._canvas.style.height=c+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}getWidth(){return this.width}getHeight(){return this.height}setSize(c,d){this.setWidth(c||0),this.setHeight(d||0)}toDataURL(c,d){try{return this._canvas.toDataURL(c,d)}catch{try{return this._canvas.toDataURL()}catch(p){return e.Util.error("Unable to get data URL. "+p.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};tn.Canvas=o;class r extends o{constructor(c={width:0,height:0,willReadFrequently:!1}){super(c),this.context=new t.SceneContext(this,{willReadFrequently:c.willReadFrequently}),this.setSize(c.width,c.height)}}tn.SceneCanvas=r;class a extends o{constructor(c={width:0,height:0}){super(c),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(c.width,c.height)}}return tn.HitCanvas=a,tn}var ko={},Mc;function Po(){return Mc||(Mc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=ke(),n=qe();e.DD={get isDragging(){let i=!1;return e.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return e.DD._dragElements.forEach(s=>{i=s.node}),i},_dragElements:new Map,_drag(i){const s=[];e.DD._dragElements.forEach((o,r)=>{const{node:a}=o,l=a.getStage();l.setPointersPositions(i),o.pointerId===void 0&&(o.pointerId=n.Util._getFirstPointerId(i));const c=l._changedPointerPositions.find(d=>d.id===o.pointerId);if(c){if(o.dragStatus!=="dragging"){const d=a.dragDistance();if(Math.max(Math.abs(c.x-o.startPointerPos.x),Math.abs(c.y-o.startPointerPos.y))<d||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,o),s.push(a)}}),s.forEach(o=>{o.fire("dragmove",{type:"dragmove",target:o,evt:i},!0)})},_endDragBefore(i){const s=[];e.DD._dragElements.forEach(o=>{const{node:r}=o,a=r.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(d=>d.id===o.pointerId))return;(o.dragStatus==="dragging"||o.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,o.dragStatus="stopped");const c=o.node.getLayer()||o.node instanceof t.Konva.Stage&&o.node;c&&s.indexOf(c)===-1&&s.push(c)}),s.forEach(o=>{o.draw()})},_endDragAfter(i){e.DD._dragElements.forEach((s,o)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:i},!0),s.dragStatus!=="dragging"&&e.DD._dragElements.delete(o)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))}(ko)),ko}var To={},mt={},Dc;function Ae(){if(Dc)return mt;Dc=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.RGBComponent=i,mt.alphaComponent=s,mt.getNumberValidator=o,mt.getNumberOrArrayOfNumbersValidator=r,mt.getNumberOrAutoValidator=a,mt.getStringValidator=l,mt.getStringOrGradientValidator=c,mt.getFunctionValidator=d,mt.getNumberArrayValidator=f,mt.getBooleanValidator=p,mt.getComponentValidator=h;const e=ke(),t=qe();function n(g){return t.Util._isString(g)?'"'+g+'"':Object.prototype.toString.call(g)==="[object Number]"||t.Util._isBoolean(g)?g:Object.prototype.toString.call(g)}function i(g){return g>255?255:g<0?0:Math.round(g)}function s(g){return g>1?1:g<1e-4?1e-4:g}function o(){if(e.Konva.isUnminified)return function(g,v){return t.Util._isNumber(g)||t.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a number.'),g}}function r(g){if(e.Konva.isUnminified)return function(v,b){let C=t.Util._isNumber(v),m=t.Util._isArray(v)&&v.length==g;return!C&&!m&&t.Util.warn(n(v)+' is a not valid value for "'+b+'" attribute. The value should be a number or Array<number>('+g+")"),v}}function a(){if(e.Konva.isUnminified)return function(g,v){return t.Util._isNumber(g)||g==="auto"||t.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a number or "auto".'),g}}function l(){if(e.Konva.isUnminified)return function(g,v){return t.Util._isString(g)||t.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a string.'),g}}function c(){if(e.Konva.isUnminified)return function(g,v){const b=t.Util._isString(g),C=Object.prototype.toString.call(g)==="[object CanvasGradient]"||g&&g.addColorStop;return b||C||t.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a string or a native gradient.'),g}}function d(){if(e.Konva.isUnminified)return function(g,v){return t.Util._isFunction(g)||t.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a function.'),g}}function f(){if(e.Konva.isUnminified)return function(g,v){const b=Int8Array?Object.getPrototypeOf(Int8Array):null;return b&&g instanceof b||(t.Util._isArray(g)?g.forEach(function(C){t.Util._isNumber(C)||t.Util.warn('"'+v+'" attribute has non numeric element '+C+". Make sure that all elements are numbers.")}):t.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a array of numbers.')),g}}function p(){if(e.Konva.isUnminified)return function(g,v){return g===!0||g===!1||t.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a boolean.'),g}}function h(g){if(e.Konva.isUnminified)return function(v,b){return v==null||t.Util.isObject(v)||t.Util.warn(n(v)+' is a not valid value for "'+b+'" attribute. The value should be an object with properties '+g),v}}return mt}var Oc;function Te(){return Oc||(Oc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=qe(),n=Ae(),i="get",s="set";e.Factory={addGetterSetter(o,r,a,l,c){e.Factory.addGetter(o,r,a),e.Factory.addSetter(o,r,l,c),e.Factory.addOverloadedGetterSetter(o,r)},addGetter(o,r,a){const l=i+t.Util._capitalize(r);o.prototype[l]=o.prototype[l]||function(){const c=this.attrs[r];return c===void 0?a:c}},addSetter(o,r,a,l){const c=s+t.Util._capitalize(r);o.prototype[c]||e.Factory.overWriteSetter(o,r,a,l)},overWriteSetter(o,r,a,l){const c=s+t.Util._capitalize(r);o.prototype[c]=function(d){return a&&d!==void 0&&d!==null&&(d=a.call(this,d,r)),this._setAttr(r,d),l&&l.call(this),this}},addComponentsGetterSetter(o,r,a,l,c){const d=a.length,f=t.Util._capitalize,p=i+f(r),h=s+f(r);o.prototype[p]=function(){const v={};for(let b=0;b<d;b++){const C=a[b];v[C]=this.getAttr(r+f(C))}return v};const g=(0,n.getComponentValidator)(a);o.prototype[h]=function(v){const b=this.attrs[r];l&&(v=l.call(this,v,r)),g&&g.call(this,v,r);for(const C in v)v.hasOwnProperty(C)&&this._setAttr(r+f(C),v[C]);return v||a.forEach(C=>{this._setAttr(r+f(C),void 0)}),this._fireChangeEvent(r,b,v),c&&c.call(this),this},e.Factory.addOverloadedGetterSetter(o,r)},addOverloadedGetterSetter(o,r){const a=t.Util._capitalize(r),l=s+a,c=i+a;o.prototype[r]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(o,r,a,l){t.Util.error("Adding deprecated "+r);const c=i+t.Util._capitalize(r),d=r+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[c]=function(){t.Util.error(d);const f=this.attrs[r];return f===void 0?a:f},e.Factory.addSetter(o,r,l,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(o,r)},backCompat(o,r){t.Util.each(r,function(a,l){const c=o.prototype[l],d=i+t.Util._capitalize(a),f=s+t.Util._capitalize(a);function p(){c.apply(this,arguments),t.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}o.prototype[a]=p,o.prototype[d]=p,o.prototype[f]=p})},afterSetFilter(){this._filterUpToDate=!1}}}(To)),To}var Nc;function Ye(){if(Nc)return Si;Nc=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.Node=void 0;const e=ns(),t=Po(),n=Te(),i=ke(),s=qe(),o=Ae(),r="absoluteOpacity",a="allEventListeners",l="absoluteTransform",c="absoluteScale",d="canvas",f="Change",p="children",h="konva",g="listening",v="mouseenter",b="mouseleave",C="pointerenter",m="pointerleave",u="touchenter",y="touchleave",S="set",A="Shape",M=" ",x="stage",w="transform",k="Stage",T="visible",R=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(M);let I=1,$=class va{constructor(_){this._id=I++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(_),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(_){(_===w||_===l)&&this._cache.get(_)?this._cache.get(_).dirty=!0:_?this._cache.delete(_):this._cache.clear()}_getCache(_,P){let N=this._cache.get(_);return(N===void 0||(_===w||_===l)&&N.dirty===!0)&&(N=P.call(this),this._cache.set(_,N)),N}_calculate(_,P,N){if(!this._attachedDepsListeners.get(_)){const O=P.map(G=>G+"Change.konva").join(M);this.on(O,()=>{this._clearCache(_)}),this._attachedDepsListeners.set(_,!0)}return this._getCache(_,N)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(_){this._clearCache(_),_===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(d)){const{scene:_,filter:P,hit:N,buffer:O}=this._cache.get(d);s.Util.releaseCanvas(_,P,N,O),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(_){const P=_||{};let N={};(P.x===void 0||P.y===void 0||P.width===void 0||P.height===void 0)&&(N=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let O=Math.ceil(P.width||N.width),G=Math.ceil(P.height||N.height),H=P.pixelRatio,V=P.x===void 0?Math.floor(N.x):P.x,Q=P.y===void 0?Math.floor(N.y):P.y,se=P.offset||0,F=P.drawBorder||!1,E=P.hitCanvasPixelRatio||1;if(!O||!G){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const U=Math.abs(Math.round(N.x)-V)>.5?1:0,j=Math.abs(Math.round(N.y)-Q)>.5?1:0;O+=se*2+U,G+=se*2+j,V-=se,Q-=se;const ee=new e.SceneCanvas({pixelRatio:H,width:O,height:G}),he=new e.SceneCanvas({pixelRatio:H,width:0,height:0,willReadFrequently:!0}),D=new e.HitCanvas({pixelRatio:E,width:O,height:G}),L=ee.getContext(),B=D.getContext(),W=new e.SceneCanvas({width:ee.width/ee.pixelRatio+Math.abs(V),height:ee.height/ee.pixelRatio+Math.abs(Q),pixelRatio:ee.pixelRatio}),Z=W.getContext();return D.isCache=!0,ee.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,P.imageSmoothingEnabled===!1&&(ee.getContext()._context.imageSmoothingEnabled=!1,he.getContext()._context.imageSmoothingEnabled=!1),L.save(),B.save(),Z.save(),L.translate(-V,-Q),B.translate(-V,-Q),Z.translate(-V,-Q),W.x=V,W.y=Q,this._isUnderCache=!0,this._clearSelfAndDescendantCache(r),this._clearSelfAndDescendantCache(c),this.drawScene(ee,this,W),this.drawHit(D,this),this._isUnderCache=!1,L.restore(),B.restore(),F&&(L.save(),L.beginPath(),L.rect(0,0,O,G),L.closePath(),L.setAttr("strokeStyle","red"),L.setAttr("lineWidth",5),L.stroke(),L.restore()),this._cache.set(d,{scene:ee,filter:he,hit:D,buffer:W,x:V,y:Q}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(_){throw new Error('abstract "getClientRect" method call')}_transformedRect(_,P){const N=[{x:_.x,y:_.y},{x:_.x+_.width,y:_.y},{x:_.x+_.width,y:_.y+_.height},{x:_.x,y:_.y+_.height}];let O=1/0,G=1/0,H=-1/0,V=-1/0;const Q=this.getAbsoluteTransform(P);return N.forEach(function(se){const F=Q.point(se);O===void 0&&(O=H=F.x,G=V=F.y),O=Math.min(O,F.x),G=Math.min(G,F.y),H=Math.max(H,F.x),V=Math.max(V,F.y)}),{x:O,y:G,width:H-O,height:V-G}}_drawCachedSceneCanvas(_){_.save(),_._applyOpacity(this),_._applyGlobalCompositeOperation(this);const P=this._getCanvasCache();_.translate(P.x,P.y);const N=this._getCachedSceneCanvas(),O=N.pixelRatio;_.drawImage(N._canvas,0,0,N.width/O,N.height/O),_.restore()}_drawCachedHitCanvas(_){const P=this._getCanvasCache(),N=P.hit;_.save(),_.translate(P.x,P.y),_.drawImage(N._canvas,0,0,N.width/N.pixelRatio,N.height/N.pixelRatio),_.restore()}_getCachedSceneCanvas(){let _=this.filters(),P=this._getCanvasCache(),N=P.scene,O=P.filter,G=O.getContext(),H,V,Q,se;if(_){if(!this._filterUpToDate){const F=N.pixelRatio;O.setSize(N.width/N.pixelRatio,N.height/N.pixelRatio);try{for(H=_.length,G.clear(),G.drawImage(N._canvas,0,0,N.getWidth()/F,N.getHeight()/F),V=G.getImageData(0,0,O.getWidth(),O.getHeight()),Q=0;Q<H;Q++){if(se=_[Q],typeof se!="function"){s.Util.error("Filter should be type of function, but got "+typeof se+" instead. Please check correct filters");continue}se.call(this,V),G.putImageData(V,0,0)}}catch(E){s.Util.error("Unable to apply filter. "+E.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return O}return N}on(_,P){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const N=_.split(M);for(let O=0;O<N.length;O++){const H=N[O].split("."),V=H[0],Q=H[1]||"";this.eventListeners[V]||(this.eventListeners[V]=[]),this.eventListeners[V].push({name:Q,handler:P})}return this}off(_,P){let N=(_||"").split(M),O=N.length,G,H,V,Q,se,F;if(this._cache&&this._cache.delete(a),!_)for(H in this.eventListeners)this._off(H);for(G=0;G<O;G++)if(V=N[G],Q=V.split("."),se=Q[0],F=Q[1],se)this.eventListeners[se]&&this._off(se,F,P);else for(H in this.eventListeners)this._off(H,F,P);return this}dispatchEvent(_){const P={target:this,type:_.type,evt:_};return this.fire(_.type,P),this}addEventListener(_,P){return this.on(_,function(N){P.call(this,N.evt)}),this}removeEventListener(_){return this.off(_),this}_delegate(_,P,N){const O=this;this.on(_,function(G){const H=G.target.findAncestors(P,!0,O);for(let V=0;V<H.length;V++)G=s.Util.cloneObject(G),G.currentTarget=H[V],N.call(H[V],G)})}remove(){return this.isDragging()&&this.stopDrag(),t.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(r),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(x),this._clearSelfAndDescendantCache(T),this._clearSelfAndDescendantCache(g)}_remove(){this._clearCaches();const _=this.getParent();_&&_.children&&(_.children.splice(this.index,1),_._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(_){const P="get"+s.Util._capitalize(_);return s.Util._isFunction(this[P])?this[P]():this.attrs[_]}getAncestors(){let _=this.getParent(),P=[];for(;_;)P.push(_),_=_.getParent();return P}getAttrs(){return this.attrs||{}}setAttrs(_){return this._batchTransformChanges(()=>{let P,N;if(!_)return this;for(P in _)P!==p&&(N=S+s.Util._capitalize(P),s.Util._isFunction(this[N])?this[N](_[P]):this._setAttr(P,_[P]))}),this}isListening(){return this._getCache(g,this._isListening)}_isListening(_){if(!this.listening())return!1;const N=this.getParent();return N&&N!==_&&this!==_?N._isListening(_):!0}isVisible(){return this._getCache(T,this._isVisible)}_isVisible(_){if(!this.visible())return!1;const N=this.getParent();return N&&N!==_&&this!==_?N._isVisible(_):!0}shouldDrawHit(_,P=!1){if(_)return this._isVisible(_)&&this._isListening(_);const N=this.getLayer();let O=!1;t.DD._dragElements.forEach(H=>{H.dragStatus==="dragging"&&(H.node.nodeType==="Stage"||H.node.getLayer()===N)&&(O=!0)});const G=!P&&!i.Konva.hitOnDragEnabled&&(O||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!G}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let _=this.getDepth(),P=this,N=0,O,G,H,V;function Q(F){for(O=[],G=F.length,H=0;H<G;H++)V=F[H],N++,V.nodeType!==A&&(O=O.concat(V.getChildren().slice())),V._id===P._id&&(H=G);O.length>0&&O[0].getDepth()<=_&&Q(O)}const se=this.getStage();return P.nodeType!==k&&se&&Q(se.getChildren()),N}getDepth(){let _=0,P=this.parent;for(;P;)_++,P=P.parent;return _}_batchTransformChanges(_){this._batchingTransformChange=!0,_(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(w),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(_){return this._batchTransformChanges(()=>{this.x(_.x),this.y(_.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const _=this.getStage();if(!_)return null;const P=_.getPointerPosition();if(!P)return null;const N=this.getAbsoluteTransform().copy();return N.invert(),N.point(P)}getAbsolutePosition(_){let P=!1,N=this.parent;for(;N;){if(N.isCached()){P=!0;break}N=N.parent}P&&!_&&(_=!0);const O=this.getAbsoluteTransform(_).getMatrix(),G=new s.Transform,H=this.offset();return G.m=O.slice(),G.translate(H.x,H.y),G.getTranslation()}setAbsolutePosition(_){const{x:P,y:N,...O}=this._clearTransform();this.attrs.x=P,this.attrs.y=N,this._clearCache(w);const G=this._getAbsoluteTransform().copy();return G.invert(),G.translate(_.x,_.y),_={x:this.attrs.x+G.getTranslation().x,y:this.attrs.y+G.getTranslation().y},this._setTransform(O),this.setPosition({x:_.x,y:_.y}),this._clearCache(w),this._clearSelfAndDescendantCache(l),this}_setTransform(_){let P;for(P in _)this.attrs[P]=_[P]}_clearTransform(){const _={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,_}move(_){let P=_.x,N=_.y,O=this.x(),G=this.y();return P!==void 0&&(O+=P),N!==void 0&&(G+=N),this.setPosition({x:O,y:G}),this}_eachAncestorReverse(_,P){let N=[],O=this.getParent(),G,H;if(!(P&&P._id===this._id)){for(N.unshift(this);O&&(!P||O._id!==P._id);)N.unshift(O),O=O.parent;for(G=N.length,H=0;H<G;H++)_(N[H])}}rotate(_){return this.rotation(this.rotation()+_),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const _=this.index,P=this.parent.getChildren().length;return _<P-1?(this.parent.children.splice(_,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const _=this.index,P=this.parent.getChildren().length;return _<P-1?(this.parent.children.splice(_,1),this.parent.children.splice(_+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const _=this.index;return _>0?(this.parent.children.splice(_,1),this.parent.children.splice(_-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const _=this.index;return _>0?(this.parent.children.splice(_,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(_){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(_<0||_>=this.parent.children.length)&&s.Util.warn("Unexpected value "+_+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const P=this.index;return this.parent.children.splice(P,1),this.parent.children.splice(_,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(r,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let _=this.opacity();const P=this.getParent();return P&&!P._isUnderCache&&(_*=P.getAbsoluteOpacity()),_}moveTo(_){return this.getParent()!==_&&(this._remove(),_.add(this)),this}toObject(){let _=this.getAttrs(),P,N,O,G,H;const V={attrs:{},className:this.getClassName()};for(P in _)N=_[P],H=s.Util.isObject(N)&&!s.Util._isPlainObject(N)&&!s.Util._isArray(N),!H&&(O=typeof this[P]=="function"&&this[P],delete _[P],G=O?O.call(this):null,_[P]=N,G!==N&&(V.attrs[P]=N));return s.Util._prepareToStringify(V)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(_,P,N){const O=[];P&&this._isMatch(_)&&O.push(this);let G=this.parent;for(;G;){if(G===N)return O;G._isMatch(_)&&O.push(G),G=G.parent}return O}isAncestorOf(_){return!1}findAncestor(_,P,N){return this.findAncestors(_,P,N)[0]}_isMatch(_){if(!_)return!1;if(typeof _=="function")return _(this);let P=_.replace(/ /g,"").split(","),N=P.length,O,G;for(O=0;O<N;O++)if(G=P[O],s.Util.isValidSelector(G)||(s.Util.warn('Selector "'+G+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),G.charAt(0)==="#"){if(this.id()===G.slice(1))return!0}else if(G.charAt(0)==="."){if(this.hasName(G.slice(1)))return!0}else if(this.className===G||this.nodeType===G)return!0;return!1}getLayer(){const _=this.getParent();return _?_.getLayer():null}getStage(){return this._getCache(x,this._getStage)}_getStage(){const _=this.getParent();return _?_.getStage():null}fire(_,P={},N){return P.target=P.target||this,N?this._fireAndBubble(_,P):this._fire(_,P),this}getAbsoluteTransform(_){return _?this._getAbsoluteTransform(_):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(_){let P;if(_)return P=new s.Transform,this._eachAncestorReverse(function(N){const O=N.transformsEnabled();O==="all"?P.multiply(N.getTransform()):O==="position"&&P.translate(N.x()-N.offsetX(),N.y()-N.offsetY())},_),P;{P=this._cache.get(l)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(P):P.reset();const N=this.transformsEnabled();if(N==="all")P.multiply(this.getTransform());else if(N==="position"){const O=this.attrs.x||0,G=this.attrs.y||0,H=this.attrs.offsetX||0,V=this.attrs.offsetY||0;P.translate(O-H,G-V)}return P.dirty=!1,P}}getAbsoluteScale(_){let P=this;for(;P;)P._isUnderCache&&(_=P),P=P.getParent();const O=this.getAbsoluteTransform(_).decompose();return{x:O.scaleX,y:O.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(w,this._getTransform)}_getTransform(){var _,P;const N=this._cache.get(w)||new s.Transform;N.reset();const O=this.x(),G=this.y(),H=i.Konva.getAngle(this.rotation()),V=(_=this.attrs.scaleX)!==null&&_!==void 0?_:1,Q=(P=this.attrs.scaleY)!==null&&P!==void 0?P:1,se=this.attrs.skewX||0,F=this.attrs.skewY||0,E=this.attrs.offsetX||0,U=this.attrs.offsetY||0;return(O!==0||G!==0)&&N.translate(O,G),H!==0&&N.rotate(H),(se!==0||F!==0)&&N.skew(se,F),(V!==1||Q!==1)&&N.scale(V,Q),(E!==0||U!==0)&&N.translate(-1*E,-1*U),N.dirty=!1,N}clone(_){let P=s.Util.cloneObject(this.attrs),N,O,G,H,V;for(N in _)P[N]=_[N];const Q=new this.constructor(P);for(N in this.eventListeners)for(O=this.eventListeners[N],G=O.length,H=0;H<G;H++)V=O[H],V.name.indexOf(h)<0&&(Q.eventListeners[N]||(Q.eventListeners[N]=[]),Q.eventListeners[N].push(V));return Q}_toKonvaCanvas(_){_=_||{};const P=this.getClientRect(),N=this.getStage(),O=_.x!==void 0?_.x:Math.floor(P.x),G=_.y!==void 0?_.y:Math.floor(P.y),H=_.pixelRatio||1,V=new e.SceneCanvas({width:_.width||Math.ceil(P.width)||(N?N.width():0),height:_.height||Math.ceil(P.height)||(N?N.height():0),pixelRatio:H}),Q=V.getContext(),se=new e.SceneCanvas({width:V.width/V.pixelRatio+Math.abs(O),height:V.height/V.pixelRatio+Math.abs(G),pixelRatio:V.pixelRatio});return _.imageSmoothingEnabled===!1&&(Q._context.imageSmoothingEnabled=!1),Q.save(),(O||G)&&Q.translate(-1*O,-1*G),this.drawScene(V,void 0,se),Q.restore(),V}toCanvas(_){return this._toKonvaCanvas(_)._canvas}toDataURL(_){_=_||{};const P=_.mimeType||null,N=_.quality||null,O=this._toKonvaCanvas(_).toDataURL(P,N);return _.callback&&_.callback(O),O}toImage(_){return new Promise((P,N)=>{try{const O=_?.callback;O&&delete _.callback,s.Util._urlToImage(this.toDataURL(_),function(G){P(G),O?.(G)})}catch(O){N(O)}})}toBlob(_){return new Promise((P,N)=>{try{const O=_?.callback;O&&delete _.callback,this.toCanvas(_).toBlob(G=>{P(G),O?.(G)},_?.mimeType,_?.quality)}catch(O){N(O)}})}setSize(_){return this.width(_.width),this.height(_.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(_,P,N){let O=this.eventListeners[_],G,H,V;for(G=0;G<O.length;G++)if(H=O[G].name,V=O[G].handler,(H!=="konva"||P==="konva")&&(!P||H===P)&&(!N||N===V)){if(O.splice(G,1),O.length===0){delete this.eventListeners[_];break}G--}}_fireChangeEvent(_,P,N){this._fire(_+f,{oldVal:P,newVal:N})}addName(_){if(!this.hasName(_)){const P=this.name(),N=P?P+" "+_:_;this.name(N)}return this}hasName(_){if(!_)return!1;const P=this.name();return P?(P||"").split(/\s/g).indexOf(_)!==-1:!1}removeName(_){const P=(this.name()||"").split(/\s/g),N=P.indexOf(_);return N!==-1&&(P.splice(N,1),this.name(P.join(" "))),this}setAttr(_,P){const N=this[S+s.Util._capitalize(_)];return s.Util._isFunction(N)?N.call(this,P):this._setAttr(_,P),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const _=this.getLayer()||this.getStage();_?.batchDraw()}}_setAttr(_,P){const N=this.attrs[_];N===P&&!s.Util.isObject(P)||(P==null?delete this.attrs[_]:this.attrs[_]=P,this._shouldFireChangeEvents&&this._fireChangeEvent(_,N,P),this._requestDraw())}_setComponentAttr(_,P,N){let O;N!==void 0&&(O=this.attrs[_],O||(this.attrs[_]=this.getAttr(_)),this.attrs[_][P]=N,this._fireChangeEvent(_,O,N))}_fireAndBubble(_,P,N){P&&this.nodeType===A&&(P.target=this);const O=[v,b,C,m,u,y];if(!(O.indexOf(_)!==-1&&(N&&(this===N||this.isAncestorOf&&this.isAncestorOf(N))||this.nodeType==="Stage"&&!N))){this._fire(_,P);const H=O.indexOf(_)!==-1&&N&&N.isAncestorOf&&N.isAncestorOf(this)&&!N.isAncestorOf(this.parent);(P&&!P.cancelBubble||!P)&&this.parent&&this.parent.isListening()&&!H&&(N&&N.parent?this._fireAndBubble.call(this.parent,_,P,N):this._fireAndBubble.call(this.parent,_,P))}}_getProtoListeners(_){var P,N,O;const G=(P=this._cache.get(a))!==null&&P!==void 0?P:{};let H=G?.[_];if(H===void 0){H=[];let V=Object.getPrototypeOf(this);for(;V;){const Q=(O=(N=V.eventListeners)===null||N===void 0?void 0:N[_])!==null&&O!==void 0?O:[];H.push(...Q),V=Object.getPrototypeOf(V)}G[_]=H,this._cache.set(a,G)}return H}_fire(_,P){P=P||{},P.currentTarget=this,P.type=_;const N=this._getProtoListeners(_);if(N)for(let G=0;G<N.length;G++)N[G].handler.call(this,P);const O=this.eventListeners[_];if(O)for(let G=0;G<O.length;G++)O[G].handler.call(this,P)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(_){const P=_?_.pointerId:void 0,N=this.getStage(),O=this.getAbsolutePosition();if(!N)return;const G=N._getPointerById(P)||N._changedPointerPositions[0]||O;t.DD._dragElements.set(this._id,{node:this,startPointerPos:G,offset:{x:G.x-O.x,y:G.y-O.y},dragStatus:"ready",pointerId:P})}startDrag(_,P=!0){t.DD._dragElements.has(this._id)||this._createDragElement(_);const N=t.DD._dragElements.get(this._id);N.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:_&&_.evt},P)}_setDragPosition(_,P){const N=this.getStage()._getPointerById(P.pointerId);if(!N)return;let O={x:N.x-P.offset.x,y:N.y-P.offset.y};const G=this.dragBoundFunc();if(G!==void 0){const H=G.call(this,O,_);H?O=H:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==O.x||this._lastPos.y!==O.y)&&(this.setAbsolutePosition(O),this._requestDraw()),this._lastPos=O}stopDrag(_){const P=t.DD._dragElements.get(this._id);P&&(P.dragStatus="stopped"),t.DD._endDragBefore(_),t.DD._endDragAfter(_)}setDraggable(_){this._setAttr("draggable",_),this._dragChange()}isDragging(){const _=t.DD._dragElements.get(this._id);return _?_.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(_){if(!(!(_.evt.button!==void 0)||i.Konva.dragButtons.indexOf(_.evt.button)>=0)||this.isDragging())return;let O=!1;t.DD._dragElements.forEach(G=>{this.isAncestorOf(G.node)&&(O=!0)}),O||this._createDragElement(_)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const P=t.DD._dragElements.get(this._id),N=P&&P.dragStatus==="dragging",O=P&&P.dragStatus==="ready";N?this.stopDrag():O&&t.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(_={x:0,y:0}){const P=this.getStage();if(!P)return!1;const N={x:-_.x,y:-_.y,width:P.width()+2*_.x,height:P.height()+2*_.y};return s.Util.haveIntersection(N,this.getClientRect())}static create(_,P){return s.Util._isString(_)&&(_=JSON.parse(_)),this._createNode(_,P)}static _createNode(_,P){let N=va.prototype.getClassName.call(_),O=_.children,G,H,V;P&&(_.attrs.container=P),i.Konva[N]||(s.Util.warn('Can not find a node with class name "'+N+'". Fallback to "Shape".'),N="Shape");const Q=i.Konva[N];if(G=new Q(_.attrs),O)for(H=O.length,V=0;V<H;V++)G.add(va._createNode(O[V]));return G}};Si.Node=$,$.prototype.nodeType="Node",$.prototype._attrsAffectingSize=[],$.prototype.eventListeners={},$.prototype.on.call($.prototype,R,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(w),this._clearSelfAndDescendantCache(l)}),$.prototype.on.call($.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(T)}),$.prototype.on.call($.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(g)}),$.prototype.on.call($.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(r)});const z=n.Factory.addGetterSetter;return z($,"zIndex"),z($,"absolutePosition"),z($,"position"),z($,"x",0,(0,o.getNumberValidator)()),z($,"y",0,(0,o.getNumberValidator)()),z($,"globalCompositeOperation","source-over",(0,o.getStringValidator)()),z($,"opacity",1,(0,o.getNumberValidator)()),z($,"name","",(0,o.getStringValidator)()),z($,"id","",(0,o.getStringValidator)()),z($,"rotation",0,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter($,"scale",["x","y"]),z($,"scaleX",1,(0,o.getNumberValidator)()),z($,"scaleY",1,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter($,"skew",["x","y"]),z($,"skewX",0,(0,o.getNumberValidator)()),z($,"skewY",0,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter($,"offset",["x","y"]),z($,"offsetX",0,(0,o.getNumberValidator)()),z($,"offsetY",0,(0,o.getNumberValidator)()),z($,"dragDistance",void 0,(0,o.getNumberValidator)()),z($,"width",0,(0,o.getNumberValidator)()),z($,"height",0,(0,o.getNumberValidator)()),z($,"listening",!0,(0,o.getBooleanValidator)()),z($,"preventDefault",!0,(0,o.getBooleanValidator)()),z($,"filters",void 0,function(q){return this._filterUpToDate=!1,q}),z($,"visible",!0,(0,o.getBooleanValidator)()),z($,"transformsEnabled","all",(0,o.getStringValidator)()),z($,"size"),z($,"dragBoundFunc"),z($,"draggable",!1,(0,o.getBooleanValidator)()),n.Factory.backCompat($,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Si}var wi={},Fc;function is(){if(Fc)return wi;Fc=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.Container=void 0;const e=Te(),t=Ye(),n=Ae();let i=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(o){const r=this.children||[];return o?r.filter(o):r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(o=>{o.parent=null,o.index=0,o.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(o=>{o.parent=null,o.index=0,o.destroy()}),this.children=[],this._requestDraw(),this}add(...o){if(o.length===0)return this;if(o.length>1){for(let a=0;a<o.length;a++)this.add(o[a]);return this}const r=o[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(o){return this._generalFind(o,!1)}findOne(o){const r=this._generalFind(o,!0);return r.length>0?r[0]:void 0}_generalFind(o,r){const a=[];return this._descendants(l=>{const c=l._isMatch(o);return c&&a.push(l),!!(c&&r)}),a}_descendants(o){let r=!1;const a=this.getChildren();for(const l of a){if(r=o(l),r)return!0;if(l.hasChildren()&&(r=l._descendants(o),r))return!0}return!1}toObject(){const o=t.Node.prototype.toObject.call(this);return o.children=[],this.getChildren().forEach(r=>{o.children.push(r.toObject())}),o}isAncestorOf(o){let r=o.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(o){const r=t.Node.prototype.clone.call(this,o);return this.getChildren().forEach(function(a){r.add(a.clone())}),r}getAllIntersections(o){const r=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(o)&&r.push(a)}),r}_clearSelfAndDescendantCache(o){var r;super._clearSelfAndDescendantCache(o),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(a){a._clearSelfAndDescendantCache(o)}))}_setChildrenIndices(){var o;(o=this.children)===null||o===void 0||o.forEach(function(r,a){r.index=a}),this._requestDraw()}drawScene(o,r,a){const l=this.getLayer(),c=o||l&&l.getCanvas(),d=c&&c.getContext(),f=this._getCanvasCache(),p=f&&f.scene,h=c&&c.isCache;if(!this.isVisible()&&!h)return this;if(p){d.save();const g=this.getAbsoluteTransform(r).getMatrix();d.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedSceneCanvas(d),d.restore()}else this._drawChildren("drawScene",c,r,a);return this}drawHit(o,r){if(!this.shouldDrawHit(r))return this;const a=this.getLayer(),l=o||a&&a.hitCanvas,c=l&&l.getContext(),d=this._getCanvasCache();if(d&&d.hit){c.save();const p=this.getAbsoluteTransform(r).getMatrix();c.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",l,r);return this}_drawChildren(o,r,a,l){var c;const d=r&&r.getContext(),f=this.clipWidth(),p=this.clipHeight(),h=this.clipFunc(),g=typeof f=="number"&&typeof p=="number"||h,v=a===this;if(g){d.save();const C=this.getAbsoluteTransform(a);let m=C.getMatrix();d.transform(m[0],m[1],m[2],m[3],m[4],m[5]),d.beginPath();let u;if(h)u=h.call(this,d,this);else{const y=this.clipX(),S=this.clipY();d.rect(y||0,S||0,f,p)}d.clip.apply(d,u),m=C.copy().invert().getMatrix(),d.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const b=!v&&this.globalCompositeOperation()!=="source-over"&&o==="drawScene";b&&(d.save(),d._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(C){C[o](r,a,l)}),b&&d.restore(),g&&d.restore()}getClientRect(o={}){var r;const a=o.skipTransform,l=o.relativeTo;let c,d,f,p,h={x:1/0,y:1/0,width:0,height:0};const g=this;(r=this.children)===null||r===void 0||r.forEach(function(C){if(!C.visible())return;const m=C.getClientRect({relativeTo:g,skipShadow:o.skipShadow,skipStroke:o.skipStroke});m.width===0&&m.height===0||(c===void 0?(c=m.x,d=m.y,f=m.x+m.width,p=m.y+m.height):(c=Math.min(c,m.x),d=Math.min(d,m.y),f=Math.max(f,m.x+m.width),p=Math.max(p,m.y+m.height)))});const v=this.find("Shape");let b=!1;for(let C=0;C<v.length;C++)if(v[C]._isVisible(this)){b=!0;break}return b&&c!==void 0?h={x:c,y:d,width:f-c,height:p-d}:h={x:0,y:0,width:0,height:0},a?h:this._transformedRect(h,l)}};return wi.Container=i,e.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),e.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"clipFunc"),wi}var Eo={},gn={},Lc;function Ic(){if(Lc)return gn;Lc=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.getCapturedShape=i,gn.createEvent=s,gn.hasPointerCapture=o,gn.setPointerCapture=r,gn.releaseCapture=a;const e=ke(),t=new Map,n=e.Konva._global.PointerEvent!==void 0;function i(l){return t.get(l)}function s(l){return{evt:l,pointerId:l.pointerId}}function o(l,c){return t.get(l)===c}function r(l,c){a(l),c.getStage()&&(t.set(l,c),n&&c._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function a(l,c){const d=t.get(l);if(!d)return;const f=d.getStage();f&&f.content,t.delete(l),n&&d._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return gn}var Gc;function tp(){return Gc||(Gc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=qe(),n=Te(),i=is(),s=ke(),o=ns(),r=Po(),a=ke(),l=Ic(),c="Stage",d="string",f="px",p="mouseout",h="mouseleave",g="mouseover",v="mouseenter",b="mousemove",C="mousedown",m="mouseup",u="pointermove",y="pointerdown",S="pointerup",A="pointercancel",M="lostpointercapture",x="pointerout",w="pointerleave",k="pointerover",T="pointerenter",R="contextmenu",I="touchstart",$="touchend",z="touchmove",q="touchcancel",_="wheel",P=5,N=[[v,"_pointerenter"],[C,"_pointerdown"],[b,"_pointermove"],[m,"_pointerup"],[h,"_pointerleave"],[I,"_pointerdown"],[z,"_pointermove"],[$,"_pointerup"],[q,"_pointercancel"],[g,"_pointerover"],[_,"_wheel"],[R,"_contextmenu"],[y,"_pointerdown"],[u,"_pointermove"],[S,"_pointerup"],[A,"_pointercancel"],[w,"_pointerleave"],[M,"_lostpointercapture"]],O={mouse:{[x]:p,[w]:h,[k]:g,[T]:v,[u]:b,[y]:C,[S]:m,[A]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[x]:"touchout",[w]:"touchleave",[k]:"touchover",[T]:"touchenter",[u]:z,[y]:I,[S]:$,[A]:q,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[x]:x,[w]:w,[k]:k,[T]:T,[u]:u,[y]:y,[S]:S,[A]:A,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},G=F=>F.indexOf("pointer")>=0?"pointer":F.indexOf("touch")>=0?"touch":"mouse",H=F=>{const E=G(F);if(E==="pointer")return s.Konva.pointerEventsEnabled&&O.pointer;if(E==="touch")return O.touch;if(E==="mouse")return O.mouse};function V(F={}){return(F.clipFunc||F.clipWidth||F.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),F}const Q="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class se extends i.Container{constructor(E){super(V(E)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{V(this.attrs)}),this._checkVisibility()}_validateAdd(E){const U=E.getType()==="Layer",j=E.getType()==="FastLayer";U||j||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const E=this.visible()?"":"none";this.content.style.display=E}setContainer(E){if(typeof E===d){let U;if(E.charAt(0)==="."){const j=E.slice(1);E=document.getElementsByClassName(j)[0]}else E.charAt(0)!=="#"?U=E:U=E.slice(1),E=document.getElementById(U);if(!E)throw"Can not find container in document with id "+U}return this._setAttr("container",E),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),E.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const E=this.children,U=E.length;for(let j=0;j<U;j++)E[j].clear();return this}clone(E){return E||(E={}),E.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,E)}destroy(){super.destroy();const E=this.content;E&&t.Util._isInDocument(E)&&this.container().removeChild(E);const U=e.stages.indexOf(this);return U>-1&&e.stages.splice(U,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const E=this._pointerPositions[0]||this._changedPointerPositions[0];return E?{x:E.x,y:E.y}:(t.Util.warn(Q),null)}_getPointerById(E){return this._pointerPositions.find(U=>U.id===E)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(E){E=E||{},E.x=E.x||0,E.y=E.y||0,E.width=E.width||this.width(),E.height=E.height||this.height();const U=new o.SceneCanvas({width:E.width,height:E.height,pixelRatio:E.pixelRatio||1}),j=U.getContext()._context,ee=this.children;return(E.x||E.y)&&j.translate(-1*E.x,-1*E.y),ee.forEach(function(he){if(!he.isVisible())return;const D=he._toKonvaCanvas(E);j.drawImage(D._canvas,E.x,E.y,D.getWidth()/D.getPixelRatio(),D.getHeight()/D.getPixelRatio())}),U}getIntersection(E){if(!E)return null;const U=this.children,j=U.length,ee=j-1;for(let he=ee;he>=0;he--){const D=U[he].getIntersection(E);if(D)return D}return null}_resizeDOM(){const E=this.width(),U=this.height();this.content&&(this.content.style.width=E+f,this.content.style.height=U+f),this.bufferCanvas.setSize(E,U),this.bufferHitCanvas.setSize(E,U),this.children.forEach(j=>{j.setSize({width:E,height:U}),j.draw()})}add(E,...U){if(arguments.length>1){for(let ee=0;ee<arguments.length;ee++)this.add(arguments[ee]);return this}super.add(E);const j=this.children.length;return j>P&&t.Util.warn("The stage has "+j+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),E.setSize({width:this.width(),height:this.height()}),E.draw(),s.Konva.isBrowser&&this.content.appendChild(E.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(E){return l.hasPointerCapture(E,this)}setPointerCapture(E){l.setPointerCapture(E,this)}releaseCapture(E){l.releaseCapture(E,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&N.forEach(([E,U])=>{this.content.addEventListener(E,j=>{this[U](j)},{passive:!1})})}_pointerenter(E){this.setPointersPositions(E);const U=H(E.type);U&&this._fire(U.pointerenter,{evt:E,target:this,currentTarget:this})}_pointerover(E){this.setPointersPositions(E);const U=H(E.type);U&&this._fire(U.pointerover,{evt:E,target:this,currentTarget:this})}_getTargetShape(E){let U=this[E+"targetShape"];return U&&!U.getStage()&&(U=null),U}_pointerleave(E){const U=H(E.type),j=G(E.type);if(!U)return;this.setPointersPositions(E);const ee=this._getTargetShape(j),he=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;ee&&he?(ee._fireAndBubble(U.pointerout,{evt:E}),ee._fireAndBubble(U.pointerleave,{evt:E}),this._fire(U.pointerleave,{evt:E,target:this,currentTarget:this}),this[j+"targetShape"]=null):he&&(this._fire(U.pointerleave,{evt:E,target:this,currentTarget:this}),this._fire(U.pointerout,{evt:E,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(E){const U=H(E.type),j=G(E.type);if(!U)return;this.setPointersPositions(E);let ee=!1;this._changedPointerPositions.forEach(he=>{const D=this.getIntersection(he);if(r.DD.justDragged=!1,s.Konva["_"+j+"ListenClick"]=!0,!D||!D.isListening()){this[j+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&D.setPointerCapture(he.id),this[j+"ClickStartShape"]=D,D._fireAndBubble(U.pointerdown,{evt:E,pointerId:he.id}),ee=!0;const L=E.type.indexOf("touch")>=0;D.preventDefault()&&E.cancelable&&L&&E.preventDefault()}),ee||this._fire(U.pointerdown,{evt:E,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(E){const U=H(E.type),j=G(E.type);if(!U||(s.Konva.isDragging()&&r.DD.node.preventDefault()&&E.cancelable&&E.preventDefault(),this.setPointersPositions(E),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const he={};let D=!1;const L=this._getTargetShape(j);this._changedPointerPositions.forEach(B=>{const W=l.getCapturedShape(B.id)||this.getIntersection(B),Z=B.id,Y={evt:E,pointerId:Z},ie=L!==W;if(ie&&L&&(L._fireAndBubble(U.pointerout,{...Y},W),L._fireAndBubble(U.pointerleave,{...Y},W)),W){if(he[W._id])return;he[W._id]=!0}W&&W.isListening()?(D=!0,ie&&(W._fireAndBubble(U.pointerover,{...Y},L),W._fireAndBubble(U.pointerenter,{...Y},L),this[j+"targetShape"]=W),W._fireAndBubble(U.pointermove,{...Y})):L&&(this._fire(U.pointerover,{evt:E,target:this,currentTarget:this,pointerId:Z}),this[j+"targetShape"]=null)}),D||this._fire(U.pointermove,{evt:E,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(E){const U=H(E.type),j=G(E.type);if(!U)return;this.setPointersPositions(E);const ee=this[j+"ClickStartShape"],he=this[j+"ClickEndShape"],D={};let L=!1;this._changedPointerPositions.forEach(B=>{const W=l.getCapturedShape(B.id)||this.getIntersection(B);if(W){if(W.releaseCapture(B.id),D[W._id])return;D[W._id]=!0}const Z=B.id,Y={evt:E,pointerId:Z};let ie=!1;s.Konva["_"+j+"InDblClickWindow"]?(ie=!0,clearTimeout(this[j+"DblTimeout"])):r.DD.justDragged||(s.Konva["_"+j+"InDblClickWindow"]=!0,clearTimeout(this[j+"DblTimeout"])),this[j+"DblTimeout"]=setTimeout(function(){s.Konva["_"+j+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),W&&W.isListening()?(L=!0,this[j+"ClickEndShape"]=W,W._fireAndBubble(U.pointerup,{...Y}),s.Konva["_"+j+"ListenClick"]&&ee&&ee===W&&(W._fireAndBubble(U.pointerclick,{...Y}),ie&&he&&he===W&&W._fireAndBubble(U.pointerdblclick,{...Y}))):(this[j+"ClickEndShape"]=null,s.Konva["_"+j+"ListenClick"]&&this._fire(U.pointerclick,{evt:E,target:this,currentTarget:this,pointerId:Z}),ie&&this._fire(U.pointerdblclick,{evt:E,target:this,currentTarget:this,pointerId:Z}))}),L||this._fire(U.pointerup,{evt:E,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+j+"ListenClick"]=!1,E.cancelable&&j!=="touch"&&j!=="pointer"&&E.preventDefault()}_contextmenu(E){this.setPointersPositions(E);const U=this.getIntersection(this.getPointerPosition());U&&U.isListening()?U._fireAndBubble(R,{evt:E}):this._fire(R,{evt:E,target:this,currentTarget:this})}_wheel(E){this.setPointersPositions(E);const U=this.getIntersection(this.getPointerPosition());U&&U.isListening()?U._fireAndBubble(_,{evt:E}):this._fire(_,{evt:E,target:this,currentTarget:this})}_pointercancel(E){this.setPointersPositions(E);const U=l.getCapturedShape(E.pointerId)||this.getIntersection(this.getPointerPosition());U&&U._fireAndBubble(S,l.createEvent(E)),l.releaseCapture(E.pointerId)}_lostpointercapture(E){l.releaseCapture(E.pointerId)}setPointersPositions(E){const U=this._getContentPosition();let j=null,ee=null;E=E||window.event,E.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(E.touches,he=>{this._pointerPositions.push({id:he.identifier,x:(he.clientX-U.left)/U.scaleX,y:(he.clientY-U.top)/U.scaleY})}),Array.prototype.forEach.call(E.changedTouches||E.touches,he=>{this._changedPointerPositions.push({id:he.identifier,x:(he.clientX-U.left)/U.scaleX,y:(he.clientY-U.top)/U.scaleY})})):(j=(E.clientX-U.left)/U.scaleX,ee=(E.clientY-U.top)/U.scaleY,this.pointerPos={x:j,y:ee},this._pointerPositions=[{x:j,y:ee,id:t.Util._getFirstPointerId(E)}],this._changedPointerPositions=[{x:j,y:ee,id:t.Util._getFirstPointerId(E)}])}_setPointerPosition(E){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(E)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const E=this.content.getBoundingClientRect();return{top:E.top,left:E.left,scaleX:E.width/this.content.clientWidth||1,scaleY:E.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new o.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new o.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const E=this.container();if(!E)throw"Stage has no container. A container is required.";E.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),E.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(E){E.batchDraw()}),this}}e.Stage=se,se.prototype.nodeType=c,(0,a._registerNode)(se),n.Factory.addGetterSetter(se,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(F=>{F.batchDraw()})})}(Eo)),Eo}var xi={},Ao={},zc;function tt(){return zc||(zc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=ke(),n=qe(),i=Te(),s=Ye(),o=Ae(),r=ke(),a=Ic(),l="hasShadow",c="shadowRGBA",d="patternImage",f="linearGradient",p="radialGradient";let h;function g(){return h||(h=n.Util.createCanvasElement().getContext("2d"),h)}e.shapes={};function v(w){const k=this.attrs.fillRule;k?w.fill(k):w.fill()}function b(w){w.stroke()}function C(w){const k=this.attrs.fillRule;k?w.fill(k):w.fill()}function m(w){w.stroke()}function u(){this._clearCache(l)}function y(){this._clearCache(c)}function S(){this._clearCache(d)}function A(){this._clearCache(f)}function M(){this._clearCache(p)}class x extends s.Node{constructor(k){super(k);let T;for(;T=n.Util.getRandomColor(),!(T&&!(T in e.shapes)););this.colorKey=T,e.shapes[T]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const T=g().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(T&&T.setTransform){const R=new n.Transform;R.translate(this.fillPatternX(),this.fillPatternY()),R.rotate(t.Konva.getAngle(this.fillPatternRotation())),R.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),R.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const I=R.getMatrix(),$=typeof DOMMatrix>"u"?{a:I[0],b:I[1],c:I[2],d:I[3],e:I[4],f:I[5]}:new DOMMatrix(I);T.setTransform($)}return T}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){const k=this.fillLinearGradientColorStops();if(k){const T=g(),R=this.fillLinearGradientStartPoint(),I=this.fillLinearGradientEndPoint(),$=T.createLinearGradient(R.x,R.y,I.x,I.y);for(let z=0;z<k.length;z+=2)$.addColorStop(k[z],k[z+1]);return $}}_getRadialGradient(){return this._getCache(p,this.__getRadialGradient)}__getRadialGradient(){const k=this.fillRadialGradientColorStops();if(k){const T=g(),R=this.fillRadialGradientStartPoint(),I=this.fillRadialGradientEndPoint(),$=T.createRadialGradient(R.x,R.y,this.fillRadialGradientStartRadius(),I.x,I.y,this.fillRadialGradientEndRadius());for(let z=0;z<k.length;z+=2)$.addColorStop(k[z],k[z+1]);return $}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const k=n.Util.colorToRGBA(this.shadowColor());if(k)return"rgba("+k.r+","+k.g+","+k.b+","+k.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const k=this.hitStrokeWidth();return k==="auto"?this.hasStroke():this.strokeEnabled()&&!!k}intersects(k){const T=this.getStage();if(!T)return!1;const R=T.bufferHitCanvas;return R.getContext().clear(),this.drawHit(R,void 0,!0),R.context.getImageData(Math.round(k.x),Math.round(k.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(k){var T;if(!((T=this.attrs.perfectDrawEnabled)!==null&&T!==void 0?T:!0))return!1;const I=k||this.hasFill(),$=this.hasStroke(),z=this.getAbsoluteOpacity()!==1;if(I&&$&&z)return!0;const q=this.hasShadow(),_=this.shadowForStrokeEnabled();return!!(I&&$&&q&&_)}setStrokeHitEnabled(k){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),k?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const k=this.size();return{x:this._centroid?-k.width/2:0,y:this._centroid?-k.height/2:0,width:k.width,height:k.height}}getClientRect(k={}){let T=!1,R=this.getParent();for(;R;){if(R.isCached()){T=!0;break}R=R.getParent()}const I=k.skipTransform,$=k.relativeTo||T&&this.getStage()||void 0,z=this.getSelfRect(),_=!k.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,P=z.width+_,N=z.height+_,O=!k.skipShadow&&this.hasShadow(),G=O?this.shadowOffsetX():0,H=O?this.shadowOffsetY():0,V=P+Math.abs(G),Q=N+Math.abs(H),se=O&&this.shadowBlur()||0,F=V+se*2,E=Q+se*2,U={width:F,height:E,x:-(_/2+se)+Math.min(G,0)+z.x,y:-(_/2+se)+Math.min(H,0)+z.y};return I?U:this._transformedRect(U,$)}drawScene(k,T,R){const I=this.getLayer(),$=k||I.getCanvas(),z=$.getContext(),q=this._getCanvasCache(),_=this.getSceneFunc(),P=this.hasShadow();let N;const O=T===this;if(!this.isVisible()&&!O)return this;if(q){z.save();const G=this.getAbsoluteTransform(T).getMatrix();return z.transform(G[0],G[1],G[2],G[3],G[4],G[5]),this._drawCachedSceneCanvas(z),z.restore(),this}if(!_)return this;if(z.save(),this._useBufferCanvas()){N=this.getStage();const G=R||N.bufferCanvas,H=G.getContext();H.clear(),H.save(),H._applyLineJoin(this);const V=this.getAbsoluteTransform(T).getMatrix();H.transform(V[0],V[1],V[2],V[3],V[4],V[5]),_.call(this,H,this),H.restore();const Q=G.pixelRatio;P&&z._applyShadow(this),z._applyOpacity(this),z._applyGlobalCompositeOperation(this),z.drawImage(G._canvas,G.x||0,G.y||0,G.width/Q,G.height/Q)}else{if(z._applyLineJoin(this),!O){const G=this.getAbsoluteTransform(T).getMatrix();z.transform(G[0],G[1],G[2],G[3],G[4],G[5]),z._applyOpacity(this),z._applyGlobalCompositeOperation(this)}P&&z._applyShadow(this),_.call(this,z,this)}return z.restore(),this}drawHit(k,T,R=!1){if(!this.shouldDrawHit(T,R))return this;const I=this.getLayer(),$=k||I.hitCanvas,z=$&&$.getContext(),q=this.hitFunc()||this.sceneFunc(),_=this._getCanvasCache(),P=_&&_.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),P){z.save();const O=this.getAbsoluteTransform(T).getMatrix();return z.transform(O[0],O[1],O[2],O[3],O[4],O[5]),this._drawCachedHitCanvas(z),z.restore(),this}if(!q)return this;if(z.save(),z._applyLineJoin(this),!(this===T)){const O=this.getAbsoluteTransform(T).getMatrix();z.transform(O[0],O[1],O[2],O[3],O[4],O[5])}return q.call(this,z,this),z.restore(),this}drawHitFromCache(k=0){const T=this._getCanvasCache(),R=this._getCachedSceneCanvas(),I=T.hit,$=I.getContext(),z=I.getWidth(),q=I.getHeight();$.clear(),$.drawImage(R._canvas,0,0,z,q);try{const _=$.getImageData(0,0,z,q),P=_.data,N=P.length,O=n.Util._hexToRgb(this.colorKey);for(let G=0;G<N;G+=4)P[G+3]>k?(P[G]=O.r,P[G+1]=O.g,P[G+2]=O.b,P[G+3]=255):P[G+3]=0;$.putImageData(_,0,0)}catch(_){n.Util.error("Unable to draw hit graph from cached scene canvas. "+_.message)}return this}hasPointerCapture(k){return a.hasPointerCapture(k,this)}setPointerCapture(k){a.setPointerCapture(k,this)}releaseCapture(k){a.releaseCapture(k,this)}}e.Shape=x,x.prototype._fillFunc=v,x.prototype._strokeFunc=b,x.prototype._fillFuncHit=C,x.prototype._strokeFuncHit=m,x.prototype._centroid=!1,x.prototype.nodeType="Shape",(0,r._registerNode)(x),x.prototype.eventListeners={},x.prototype.on.call(x.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",u),x.prototype.on.call(x.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",S),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",A),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",M),i.Factory.addGetterSetter(x,"stroke",void 0,(0,o.getStringOrGradientValidator)()),i.Factory.addGetterSetter(x,"strokeWidth",2,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(x,"hitStrokeWidth","auto",(0,o.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(x,"strokeHitEnabled",!0,(0,o.getBooleanValidator)()),i.Factory.addGetterSetter(x,"perfectDrawEnabled",!0,(0,o.getBooleanValidator)()),i.Factory.addGetterSetter(x,"shadowForStrokeEnabled",!0,(0,o.getBooleanValidator)()),i.Factory.addGetterSetter(x,"lineJoin"),i.Factory.addGetterSetter(x,"lineCap"),i.Factory.addGetterSetter(x,"sceneFunc"),i.Factory.addGetterSetter(x,"hitFunc"),i.Factory.addGetterSetter(x,"dash"),i.Factory.addGetterSetter(x,"dashOffset",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowColor",void 0,(0,o.getStringValidator)()),i.Factory.addGetterSetter(x,"shadowBlur",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowOpacity",1,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(x,"shadowOffsetX",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowOffsetY",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternImage"),i.Factory.addGetterSetter(x,"fill",void 0,(0,o.getStringOrGradientValidator)()),i.Factory.addGetterSetter(x,"fillPatternX",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternY",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(x,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(x,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(x,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(x,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(x,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(x,"fillEnabled",!0),i.Factory.addGetterSetter(x,"strokeEnabled",!0),i.Factory.addGetterSetter(x,"shadowEnabled",!0),i.Factory.addGetterSetter(x,"dashEnabled",!0),i.Factory.addGetterSetter(x,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(x,"fillPriority","color"),i.Factory.addComponentsGetterSetter(x,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(x,"fillPatternOffsetX",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternOffsetY",0,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(x,"fillPatternScaleX",1,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternScaleY",1,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(x,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(x,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(x,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(x,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(x,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(x,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(x,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(x,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(x,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(x,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(x,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(x,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(x,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(x,"fillPatternRotation",0),i.Factory.addGetterSetter(x,"fillRule",void 0,(0,o.getStringValidator)()),i.Factory.backCompat(x,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(Ao)),Ao}var Uc;function $c(){if(Uc)return xi;Uc=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.Layer=void 0;const e=qe(),t=is(),n=Ye(),i=Te(),s=ns(),o=Ae(),r=tt(),a=ke(),l="#",c="beforeDraw",d="draw",f=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],p=f.length;let h=class extends t.Container{constructor(v){super(v),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(v){return this.getContext().clear(v),this.getHitCanvas().getContext().clear(v),this}setZIndex(v){super.setZIndex(v);const b=this.getStage();return b&&b.content&&(b.content.removeChild(this.getNativeCanvasElement()),v<b.children.length-1?b.content.insertBefore(this.getNativeCanvasElement(),b.children[v+1].getCanvas()._canvas):b.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!n.Node.prototype.moveUp.call(this))return!1;const b=this.getStage();return!b||!b.content?!1:(b.content.removeChild(this.getNativeCanvasElement()),this.index<b.children.length-1?b.content.insertBefore(this.getNativeCanvasElement(),b.children[this.index+1].getCanvas()._canvas):b.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){const v=this.getStage();if(v){const b=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),b[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){const v=this.getStage();if(v){const b=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),b[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const v=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),v&&v.parentNode&&e.Util._isInDocument(v)&&v.parentNode.removeChild(v),this}getStage(){return this.parent}setSize({width:v,height:b}){return this.canvas.setSize(v,b),this.hitCanvas.setSize(v,b),this._setSmoothEnabled(),this}_validateAdd(v){const b=v.getType();b!=="Group"&&b!=="Shape"&&e.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(v){return v=v||{},v.width=v.width||this.getWidth(),v.height=v.height||this.getHeight(),v.x=v.x!==void 0?v.x:this.x(),v.y=v.y!==void 0?v.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,v)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){e.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){e.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,e.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(v){if(!this.isListening()||!this.isVisible())return null;let b=1,C=!1;for(;;){for(let m=0;m<p;m++){const u=f[m],y=this._getIntersection({x:v.x+u.x*b,y:v.y+u.y*b}),S=y.shape;if(S)return S;if(C=!!y.antialiased,!y.antialiased)break}if(C)b+=1;else return null}}_getIntersection(v){const b=this.hitCanvas.pixelRatio,C=this.hitCanvas.context.getImageData(Math.round(v.x*b),Math.round(v.y*b),1,1).data,m=C[3];if(m===255){const u=e.Util._rgbToHex(C[0],C[1],C[2]),y=r.shapes[l+u];return y?{shape:y}:{antialiased:!0}}else if(m>0)return{antialiased:!0};return{}}drawScene(v,b,C){const m=this.getLayer(),u=v||m&&m.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&u.getContext().clear(),t.Container.prototype.drawScene.call(this,u,b,C),this._fire(d,{node:this}),this}drawHit(v,b){const C=this.getLayer(),m=v||C&&C.hitCanvas;return C&&C.clearBeforeDraw()&&C.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,m,b),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(v){e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(v)}getHitGraphEnabled(v){return e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const v=this.parent;!!this.hitCanvas._canvas.parentNode?v.content.removeChild(this.hitCanvas._canvas):v.content.appendChild(this.hitCanvas._canvas)}destroy(){return e.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return xi.Layer=h,h.prototype.nodeType="Layer",(0,a._registerNode)(h),i.Factory.addGetterSetter(h,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(h,"clearBeforeDraw",!0),i.Factory.addGetterSetter(h,"hitGraphEnabled",!0,(0,o.getBooleanValidator)()),xi}var Ci={},Vc;function np(){if(Vc)return Ci;Vc=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.FastLayer=void 0;const e=qe(),t=$c(),n=ke();let i=class extends t.Layer{constructor(o){super(o),this.listening(!1),e.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return Ci.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),Ci}var ki={},Bc;function Ro(){if(Bc)return ki;Bc=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.Group=void 0;const e=qe(),t=is(),n=ke();let i=class extends t.Container{_validateAdd(o){const r=o.getType();r!=="Group"&&r!=="Shape"&&e.Util.throw("You may only add groups and shapes to groups.")}};return ki.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),ki}var Pi={},Hc;function Mo(){if(Hc)return Pi;Hc=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.Animation=void 0;const e=ke(),t=qe(),n=function(){return e.glob.performance&&e.glob.performance.now?function(){return e.glob.performance.now()}:function(){return new Date().getTime()}}();let i=class Qn{constructor(o,r){this.id=Qn.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=o,this.setLayers(r)}setLayers(o){let r=[];return o&&(r=Array.isArray(o)?o:[o]),this.layers=r,this}getLayers(){return this.layers}addLayer(o){const r=this.layers,a=r.length;for(let l=0;l<a;l++)if(r[l]._id===o._id)return!1;return this.layers.push(o),!0}isRunning(){const r=Qn.animations,a=r.length;for(let l=0;l<a;l++)if(r[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),Qn._addAnimation(this),this}stop(){return Qn._removeAnimation(this),this}_updateFrameObject(o){this.frame.timeDiff=o-this.frame.lastTime,this.frame.lastTime=o,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(o){this.animations.push(o),this._handleAnimation()}static _removeAnimation(o){const r=o.id,a=this.animations,l=a.length;for(let c=0;c<l;c++)if(a[c].id===r){this.animations.splice(c,1);break}}static _runFrames(){const o={},r=this.animations;for(let a=0;a<r.length;a++){const l=r[a],c=l.layers,d=l.func;l._updateFrameObject(n());const f=c.length;let p;if(d?p=d.call(l,l.frame)!==!1:p=!0,!!p)for(let h=0;h<f;h++){const g=c[h];g._id!==void 0&&(o[g._id]=g)}}for(const a in o)o.hasOwnProperty(a)&&o[a].batchDraw()}static _animationLoop(){const o=Qn;o.animations.length?(o._runFrames(),t.Util.requestAnimFrame(o._animationLoop)):o.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return Pi.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,Pi}var Do={},jc;function ip(){return jc||(jc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=qe(),n=Mo(),i=Ye(),s=ke(),o={node:1,duration:1,easing:1,onFinish:1,yoyo:1},r=1,a=2,l=3,c=["fill","stroke","shadowColor"];let d=0;class f{constructor(g,v,b,C,m,u,y){this.prop=g,this.propFunc=v,this.begin=C,this._pos=C,this.duration=u,this._change=0,this.prevPos=0,this.yoyo=y,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=b,this._change=m-this.begin,this.pause()}fire(g){const v=this[g];v&&v()}setTime(g){g>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():g<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=g,this.update())}getTime(){return this._time}setPosition(g){this.prevPos=this._pos,this.propFunc(g),this._pos=g}getPosition(g){return g===void 0&&(g=this._time),this.func(g,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(g){this.pause(),this._time=g,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const g=this.getTimer()-this._startTime;this.state===a?this.setTime(g):this.state===l&&this.setTime(this.duration-g)}pause(){this.state=r,this.fire("onPause")}getTimer(){return new Date().getTime()}}class p{constructor(g){const v=this,b=g.node,C=b._id,m=g.easing||e.Easings.Linear,u=!!g.yoyo;let y,S;typeof g.duration>"u"?y=.3:g.duration===0?y=.001:y=g.duration,this.node=b,this._id=d++;const A=b.getLayer()||(b instanceof s.Konva.Stage?b.getLayers():null);A||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){v.tween.onEnterFrame()},A),this.tween=new f(S,function(M){v._tweenFunc(M)},m,0,1,y*1e3,u),this._addListeners(),p.attrs[C]||(p.attrs[C]={}),p.attrs[C][this._id]||(p.attrs[C][this._id]={}),p.tweens[C]||(p.tweens[C]={});for(S in g)o[S]===void 0&&this._addAttr(S,g[S]);this.reset(),this.onFinish=g.onFinish,this.onReset=g.onReset,this.onUpdate=g.onUpdate}_addAttr(g,v){const b=this.node,C=b._id;let m,u,y,S,A;const M=p.tweens[C][g];M&&delete p.attrs[C][M][g];let x=b.getAttr(g);if(t.Util._isArray(v))if(m=[],u=Math.max(v.length,x.length),g==="points"&&v.length!==x.length&&(v.length>x.length?(S=x,x=t.Util._prepareArrayForTween(x,v,b.closed())):(y=v,v=t.Util._prepareArrayForTween(v,x,b.closed()))),g.indexOf("fill")===0)for(let w=0;w<u;w++)if(w%2===0)m.push(v[w]-x[w]);else{const k=t.Util.colorToRGBA(x[w]);A=t.Util.colorToRGBA(v[w]),x[w]=k,m.push({r:A.r-k.r,g:A.g-k.g,b:A.b-k.b,a:A.a-k.a})}else for(let w=0;w<u;w++)m.push(v[w]-x[w]);else c.indexOf(g)!==-1?(x=t.Util.colorToRGBA(x),A=t.Util.colorToRGBA(v),m={r:A.r-x.r,g:A.g-x.g,b:A.b-x.b,a:A.a-x.a}):m=v-x;p.attrs[C][this._id][g]={start:x,diff:m,end:v,trueEnd:y,trueStart:S},p.tweens[C][g]=this._id}_tweenFunc(g){const v=this.node,b=p.attrs[v._id][this._id];let C,m,u,y,S,A,M,x;for(C in b){if(m=b[C],u=m.start,y=m.diff,x=m.end,t.Util._isArray(u))if(S=[],M=Math.max(u.length,x.length),C.indexOf("fill")===0)for(A=0;A<M;A++)A%2===0?S.push((u[A]||0)+y[A]*g):S.push("rgba("+Math.round(u[A].r+y[A].r*g)+","+Math.round(u[A].g+y[A].g*g)+","+Math.round(u[A].b+y[A].b*g)+","+(u[A].a+y[A].a*g)+")");else for(A=0;A<M;A++)S.push((u[A]||0)+y[A]*g);else c.indexOf(C)!==-1?S="rgba("+Math.round(u.r+y.r*g)+","+Math.round(u.g+y.g*g)+","+Math.round(u.b+y.b*g)+","+(u.a+y.a*g)+")":S=u+y*g;v.setAttr(C,S)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const g=this.node,v=p.attrs[g._id][this._id];v.points&&v.points.trueEnd&&g.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const g=this.node,v=p.attrs[g._id][this._id];v.points&&v.points.trueStart&&g.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(g){return this.tween.seek(g*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const g=this.node._id,v=this._id,b=p.tweens[g];this.pause(),this.anim&&this.anim.stop();for(const C in b)delete p.tweens[g][C];delete p.attrs[g][v],Object.keys(p.tweens[g]).length===0&&delete p.tweens[g],Object.keys(p.attrs[g]).length===0&&delete p.attrs[g]}}e.Tween=p,p.attrs={},p.tweens={},i.Node.prototype.to=function(h){const g=h.onFinish;h.node=this,h.onFinish=function(){this.destroy(),g&&g()},new p(h).play()},e.Easings={BackEaseIn(h,g,v,b){return v*(h/=b)*h*(2.70158*h-1.70158)+g},BackEaseOut(h,g,v,b){return v*((h=h/b-1)*h*(2.70158*h+1.70158)+1)+g},BackEaseInOut(h,g,v,b){let C=1.70158;return(h/=b/2)<1?v/2*(h*h*(((C*=1.525)+1)*h-C))+g:v/2*((h-=2)*h*(((C*=1.525)+1)*h+C)+2)+g},ElasticEaseIn(h,g,v,b,C,m){let u=0;return h===0?g:(h/=b)===1?g+v:(m||(m=b*.3),!C||C<Math.abs(v)?(C=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/C),-(C*Math.pow(2,10*(h-=1))*Math.sin((h*b-u)*(2*Math.PI)/m))+g)},ElasticEaseOut(h,g,v,b,C,m){let u=0;return h===0?g:(h/=b)===1?g+v:(m||(m=b*.3),!C||C<Math.abs(v)?(C=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/C),C*Math.pow(2,-10*h)*Math.sin((h*b-u)*(2*Math.PI)/m)+v+g)},ElasticEaseInOut(h,g,v,b,C,m){let u=0;return h===0?g:(h/=b/2)===2?g+v:(m||(m=b*.44999999999999996),!C||C<Math.abs(v)?(C=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/C),h<1?-.5*(C*Math.pow(2,10*(h-=1))*Math.sin((h*b-u)*(2*Math.PI)/m))+g:C*Math.pow(2,-10*(h-=1))*Math.sin((h*b-u)*(2*Math.PI)/m)*.5+v+g)},BounceEaseOut(h,g,v,b){return(h/=b)<.36363636363636365?v*(7.5625*h*h)+g:h<.7272727272727273?v*(7.5625*(h-=.5454545454545454)*h+.75)+g:h<.9090909090909091?v*(7.5625*(h-=.8181818181818182)*h+.9375)+g:v*(7.5625*(h-=.9545454545454546)*h+.984375)+g},BounceEaseIn(h,g,v,b){return v-e.Easings.BounceEaseOut(b-h,0,v,b)+g},BounceEaseInOut(h,g,v,b){return h<b/2?e.Easings.BounceEaseIn(h*2,0,v,b)*.5+g:e.Easings.BounceEaseOut(h*2-b,0,v,b)*.5+v*.5+g},EaseIn(h,g,v,b){return v*(h/=b)*h+g},EaseOut(h,g,v,b){return-v*(h/=b)*(h-2)+g},EaseInOut(h,g,v,b){return(h/=b/2)<1?v/2*h*h+g:-v/2*(--h*(h-2)-1)+g},StrongEaseIn(h,g,v,b){return v*(h/=b)*h*h*h*h+g},StrongEaseOut(h,g,v,b){return v*((h=h/b-1)*h*h*h*h+1)+g},StrongEaseInOut(h,g,v,b){return(h/=b/2)<1?v/2*h*h*h*h*h+g:v/2*((h-=2)*h*h*h*h+2)+g},Linear(h,g,v,b){return v*h/b+g}}}(Do)),Do}var Wc;function rp(){return Wc||(Wc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=ke(),n=qe(),i=Ye(),s=is(),o=tp(),r=$c(),a=np(),l=Ro(),c=Po(),d=tt(),f=Mo(),p=ip(),h=Ac(),g=ns();e.Konva=n.Util._assign(t.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:s.Container,Stage:o.Stage,stages:o.stages,Layer:r.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:c.DD,Shape:d.Shape,shapes:d.shapes,Animation:f.Animation,Tween:p.Tween,Easings:p.Easings,Context:h.Context,Canvas:g.Canvas}),e.default=e.Konva}(wo)),wo}var Ti={},Kc;function sp(){if(Kc)return Ti;Kc=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.Arc=void 0;const e=Te(),t=tt(),n=ke(),i=Ae(),s=ke();let o=class extends t.Shape{_sceneFunc(a){const l=n.Konva.getAngle(this.angle()),c=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,c),a.arc(0,0,this.innerRadius(),l,0,!c),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),c=this.clockwise(),d=n.Konva.getAngle(c?360-this.angle():this.angle()),f=Math.cos(Math.min(d,Math.PI)),p=1,h=Math.sin(Math.min(Math.max(Math.PI,d),3*Math.PI/2)),g=Math.sin(Math.min(d,Math.PI/2)),v=f*(f>0?a:l),b=p*l,C=h*(h>0?a:l),m=g*(g>0?l:a);return{x:v,y:c?-1*m:C,width:b-v,height:m-C}}};return Ti.Arc=o,o.prototype._centroid=!0,o.prototype.className="Arc",o.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(o),e.Factory.addGetterSetter(o,"innerRadius",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"outerRadius",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"angle",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"clockwise",!1,(0,i.getBooleanValidator)()),Ti}var Ei={},Ai={},qc;function Yc(){if(qc)return Ai;qc=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.Line=void 0;const e=Te(),t=ke(),n=tt(),i=Ae();function s(a,l,c,d,f,p,h){const g=Math.sqrt(Math.pow(c-a,2)+Math.pow(d-l,2)),v=Math.sqrt(Math.pow(f-c,2)+Math.pow(p-d,2)),b=h*g/(g+v),C=h*v/(g+v),m=c-b*(f-a),u=d-b*(p-l),y=c+C*(f-a),S=d+C*(p-l);return[m,u,y,S]}function o(a,l){const c=a.length,d=[];for(let f=2;f<c-2;f+=2){const p=s(a[f-2],a[f-1],a[f],a[f+1],a[f+2],a[f+3],l);isNaN(p[0])||(d.push(p[0]),d.push(p[1]),d.push(a[f]),d.push(a[f+1]),d.push(p[2]),d.push(p[3]))}return d}let r=class extends n.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const c=this.points(),d=c.length,f=this.tension(),p=this.closed(),h=this.bezier();if(!d)return;let g=0;if(l.beginPath(),l.moveTo(c[0],c[1]),f!==0&&d>4){const v=this.getTensionPoints(),b=v.length;for(g=p?0:4,p||l.quadraticCurveTo(v[0],v[1],v[2],v[3]);g<b-2;)l.bezierCurveTo(v[g++],v[g++],v[g++],v[g++],v[g++],v[g++]);p||l.quadraticCurveTo(v[b-2],v[b-1],c[d-2],c[d-1])}else if(h)for(g=2;g<d;)l.bezierCurveTo(c[g++],c[g++],c[g++],c[g++],c[g++],c[g++]);else for(g=2;g<d;g+=2)l.lineTo(c[g],c[g+1]);p?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():o(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),c=l.length,d=this.tension(),f=s(l[c-2],l[c-1],l[0],l[1],l[2],l[3],d),p=s(l[c-4],l[c-3],l[c-2],l[c-1],l[0],l[1],d),h=o(l,d);return[f[2],f[3]].concat(h).concat([p[0],p[1],l[c-2],l[c-1],p[2],p[3],f[0],f[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let c=l[0],d=l[0],f=l[1],p=l[1],h,g;for(let v=0;v<l.length/2;v++)h=l[v*2],g=l[v*2+1],c=Math.min(c,h),d=Math.max(d,h),f=Math.min(f,g),p=Math.max(p,g);return{x:c,y:f,width:d-c,height:p-f}}};return Ai.Line=r,r.prototype.className="Line",r.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(r),e.Factory.addGetterSetter(r,"closed",!1),e.Factory.addGetterSetter(r,"bezier",!1),e.Factory.addGetterSetter(r,"tension",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(r,"points",[],(0,i.getNumberArrayValidator)()),Ai}var Ri={},Oo={},Xc;function op(){return Xc||(Xc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(r,a,l)=>{let c,d;const p=l/2;c=0;for(let h=0;h<20;h++)d=p*e.tValues[20][h]+p,c+=e.cValues[20][h]*i(r,a,d);return p*c};e.getCubicArcLength=t;const n=(r,a,l)=>{l===void 0&&(l=1);const c=r[0]-2*r[1]+r[2],d=a[0]-2*a[1]+a[2],f=2*r[1]-2*r[0],p=2*a[1]-2*a[0],h=4*(c*c+d*d),g=4*(c*f+d*p),v=f*f+p*p;if(h===0)return l*Math.sqrt(Math.pow(r[2]-r[0],2)+Math.pow(a[2]-a[0],2));const b=g/(2*h),C=v/h,m=l+b,u=C-b*b,y=m*m+u>0?Math.sqrt(m*m+u):0,S=b*b+u>0?Math.sqrt(b*b+u):0,A=b+Math.sqrt(b*b+u)!==0?u*Math.log(Math.abs((m+y)/(b+S))):0;return Math.sqrt(h)/2*(m*y-b*S+A)};e.getQuadraticArcLength=n;function i(r,a,l){const c=s(1,l,r),d=s(1,l,a),f=c*c+d*d;return Math.sqrt(f)}const s=(r,a,l)=>{const c=l.length-1;let d,f;if(c===0)return 0;if(r===0){f=0;for(let p=0;p<=c;p++)f+=e.binomialCoefficients[c][p]*Math.pow(1-a,c-p)*Math.pow(a,p)*l[p];return f}else{d=new Array(c);for(let p=0;p<c;p++)d[p]=c*(l[p+1]-l[p]);return s(r-1,a,d)}},o=(r,a,l)=>{let c=1,d=r/a,f=(r-l(d))/a,p=0;for(;c>.001;){const h=l(d+f),g=Math.abs(r-h)/a;if(g<c)c=g,d+=f;else{const v=l(d-f),b=Math.abs(r-v)/a;b<c?(c=b,d-=f):f/=2}if(p++,p>500)break}return d};e.t2length=o}(Oo)),Oo}var Zc;function No(){if(Zc)return Ri;Zc=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.Path=void 0;const e=Te(),t=ke(),n=tt(),i=op();let s=class _t extends n.Shape{constructor(r){super(r),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=_t.parsePathData(this.data()),this.pathLength=_t.getPathLength(this.dataArray)}_sceneFunc(r){const a=this.dataArray;r.beginPath();let l=!1;for(let c=0;c<a.length;c++){const d=a[c].command,f=a[c].points;switch(d){case"L":r.lineTo(f[0],f[1]);break;case"M":r.moveTo(f[0],f[1]);break;case"C":r.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":r.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":const p=f[0],h=f[1],g=f[2],v=f[3],b=f[4],C=f[5],m=f[6],u=f[7],y=g>v?g:v,S=g>v?1:g/v,A=g>v?v/g:1;r.translate(p,h),r.rotate(m),r.scale(S,A),r.arc(0,0,y,b,b+C,1-u),r.scale(1/S,1/A),r.rotate(-m),r.translate(-p,-h);break;case"z":l=!0,r.closePath();break}}!l&&!this.hasFill()?r.strokeShape(this):r.fillStrokeShape(this)}getSelfRect(){let r=[];this.dataArray.forEach(function(h){if(h.command==="A"){const g=h.points[4],v=h.points[5],b=h.points[4]+v;let C=Math.PI/180;if(Math.abs(g-b)<C&&(C=Math.abs(g-b)),v<0)for(let m=g-C;m>b;m-=C){const u=_t.getPointOnEllipticalArc(h.points[0],h.points[1],h.points[2],h.points[3],m,0);r.push(u.x,u.y)}else for(let m=g+C;m<b;m+=C){const u=_t.getPointOnEllipticalArc(h.points[0],h.points[1],h.points[2],h.points[3],m,0);r.push(u.x,u.y)}}else if(h.command==="C")for(let g=0;g<=1;g+=.01){const v=_t.getPointOnCubicBezier(g,h.start.x,h.start.y,h.points[0],h.points[1],h.points[2],h.points[3],h.points[4],h.points[5]);r.push(v.x,v.y)}else r=r.concat(h.points)});let a=r[0],l=r[0],c=r[1],d=r[1],f,p;for(let h=0;h<r.length/2;h++)f=r[h*2],p=r[h*2+1],isNaN(f)||(a=Math.min(a,f),l=Math.max(l,f)),isNaN(p)||(c=Math.min(c,p),d=Math.max(d,p));return{x:a,y:c,width:l-a,height:d-c}}getLength(){return this.pathLength}getPointAtLength(r){return _t.getPointAtLengthOfDataArray(r,this.dataArray)}static getLineLength(r,a,l,c){return Math.sqrt((l-r)*(l-r)+(c-a)*(c-a))}static getPathLength(r){let a=0;for(let l=0;l<r.length;++l)a+=r[l].pathLength;return a}static getPointAtLengthOfDataArray(r,a){let l,c=0,d=a.length;if(!d)return null;for(;c<d&&r>a[c].pathLength;)r-=a[c].pathLength,++c;if(c===d)return l=a[c-1].points.slice(-2),{x:l[0],y:l[1]};if(r<.01)return a[c].command==="M"?(l=a[c].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[c].start.x,y:a[c].start.y};const f=a[c],p=f.points;switch(f.command){case"L":return _t.getPointOnLine(r,f.start.x,f.start.y,p[0],p[1]);case"C":return _t.getPointOnCubicBezier((0,i.t2length)(r,_t.getPathLength(a),y=>(0,i.getCubicArcLength)([f.start.x,p[0],p[2],p[4]],[f.start.y,p[1],p[3],p[5]],y)),f.start.x,f.start.y,p[0],p[1],p[2],p[3],p[4],p[5]);case"Q":return _t.getPointOnQuadraticBezier((0,i.t2length)(r,_t.getPathLength(a),y=>(0,i.getQuadraticArcLength)([f.start.x,p[0],p[2]],[f.start.y,p[1],p[3]],y)),f.start.x,f.start.y,p[0],p[1],p[2],p[3]);case"A":const h=p[0],g=p[1],v=p[2],b=p[3],C=p[5],m=p[6];let u=p[4];return u+=C*r/f.pathLength,_t.getPointOnEllipticalArc(h,g,v,b,u,m)}return null}static getPointOnLine(r,a,l,c,d,f,p){f=f??a,p=p??l;const h=this.getLineLength(a,l,c,d);if(h<1e-10)return{x:a,y:l};if(c===a)return{x:f,y:p+(d>l?r:-r)};const g=(d-l)/(c-a),v=Math.sqrt(r*r/(1+g*g))*(c<a?-1:1),b=g*v;if(Math.abs(p-l-g*(f-a))<1e-10)return{x:f+v,y:p+b};const C=((f-a)*(c-a)+(p-l)*(d-l))/(h*h),m=a+C*(c-a),u=l+C*(d-l),y=this.getLineLength(f,p,m,u),S=Math.sqrt(r*r-y*y),A=Math.sqrt(S*S/(1+g*g))*(c<a?-1:1),M=g*A;return{x:m+A,y:u+M}}static getPointOnCubicBezier(r,a,l,c,d,f,p,h,g){function v(S){return S*S*S}function b(S){return 3*S*S*(1-S)}function C(S){return 3*S*(1-S)*(1-S)}function m(S){return(1-S)*(1-S)*(1-S)}const u=h*v(r)+f*b(r)+c*C(r)+a*m(r),y=g*v(r)+p*b(r)+d*C(r)+l*m(r);return{x:u,y}}static getPointOnQuadraticBezier(r,a,l,c,d,f,p){function h(m){return m*m}function g(m){return 2*m*(1-m)}function v(m){return(1-m)*(1-m)}const b=f*h(r)+c*g(r)+a*v(r),C=p*h(r)+d*g(r)+l*v(r);return{x:b,y:C}}static getPointOnEllipticalArc(r,a,l,c,d,f){const p=Math.cos(f),h=Math.sin(f),g={x:l*Math.cos(d),y:c*Math.sin(d)};return{x:r+(g.x*p-g.y*h),y:a+(g.x*h+g.y*p)}}static parsePathData(r){if(!r)return[];let a=r;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let b=0;b<l.length;b++)a=a.replace(new RegExp(l[b],"g"),"|"+l[b]);const c=a.split("|"),d=[],f=[];let p=0,h=0;const g=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let v;for(let b=1;b<c.length;b++){let C=c[b],m=C.charAt(0);for(C=C.slice(1),f.length=0;v=g.exec(C);)f.push(v[0]);const u=[];for(let y=0,S=f.length;y<S;y++){if(f[y]==="00"){u.push(0,0);continue}const A=parseFloat(f[y]);isNaN(A)?u.push(0):u.push(A)}for(;u.length>0&&!isNaN(u[0]);){let y="",S=[];const A=p,M=h;let x,w,k,T,R,I,$,z,q,_;switch(m){case"l":p+=u.shift(),h+=u.shift(),y="L",S.push(p,h);break;case"L":p=u.shift(),h=u.shift(),S.push(p,h);break;case"m":const P=u.shift(),N=u.shift();if(p+=P,h+=N,y="M",d.length>2&&d[d.length-1].command==="z"){for(let O=d.length-2;O>=0;O--)if(d[O].command==="M"){p=d[O].points[0]+P,h=d[O].points[1]+N;break}}S.push(p,h),m="l";break;case"M":p=u.shift(),h=u.shift(),y="M",S.push(p,h),m="L";break;case"h":p+=u.shift(),y="L",S.push(p,h);break;case"H":p=u.shift(),y="L",S.push(p,h);break;case"v":h+=u.shift(),y="L",S.push(p,h);break;case"V":h=u.shift(),y="L",S.push(p,h);break;case"C":S.push(u.shift(),u.shift(),u.shift(),u.shift()),p=u.shift(),h=u.shift(),S.push(p,h);break;case"c":S.push(p+u.shift(),h+u.shift(),p+u.shift(),h+u.shift()),p+=u.shift(),h+=u.shift(),y="C",S.push(p,h);break;case"S":w=p,k=h,x=d[d.length-1],x.command==="C"&&(w=p+(p-x.points[2]),k=h+(h-x.points[3])),S.push(w,k,u.shift(),u.shift()),p=u.shift(),h=u.shift(),y="C",S.push(p,h);break;case"s":w=p,k=h,x=d[d.length-1],x.command==="C"&&(w=p+(p-x.points[2]),k=h+(h-x.points[3])),S.push(w,k,p+u.shift(),h+u.shift()),p+=u.shift(),h+=u.shift(),y="C",S.push(p,h);break;case"Q":S.push(u.shift(),u.shift()),p=u.shift(),h=u.shift(),S.push(p,h);break;case"q":S.push(p+u.shift(),h+u.shift()),p+=u.shift(),h+=u.shift(),y="Q",S.push(p,h);break;case"T":w=p,k=h,x=d[d.length-1],x.command==="Q"&&(w=p+(p-x.points[0]),k=h+(h-x.points[1])),p=u.shift(),h=u.shift(),y="Q",S.push(w,k,p,h);break;case"t":w=p,k=h,x=d[d.length-1],x.command==="Q"&&(w=p+(p-x.points[0]),k=h+(h-x.points[1])),p+=u.shift(),h+=u.shift(),y="Q",S.push(w,k,p,h);break;case"A":T=u.shift(),R=u.shift(),I=u.shift(),$=u.shift(),z=u.shift(),q=p,_=h,p=u.shift(),h=u.shift(),y="A",S=this.convertEndpointToCenterParameterization(q,_,p,h,$,z,T,R,I);break;case"a":T=u.shift(),R=u.shift(),I=u.shift(),$=u.shift(),z=u.shift(),q=p,_=h,p+=u.shift(),h+=u.shift(),y="A",S=this.convertEndpointToCenterParameterization(q,_,p,h,$,z,T,R,I);break}d.push({command:y||m,points:S,start:{x:A,y:M},pathLength:this.calcLength(A,M,y||m,S)})}(m==="z"||m==="Z")&&d.push({command:"z",points:[],start:void 0,pathLength:0})}return d}static calcLength(r,a,l,c){let d,f,p,h;const g=_t;switch(l){case"L":return g.getLineLength(r,a,c[0],c[1]);case"C":return(0,i.getCubicArcLength)([r,c[0],c[2],c[4]],[a,c[1],c[3],c[5]],1);case"Q":return(0,i.getQuadraticArcLength)([r,c[0],c[2]],[a,c[1],c[3]],1);case"A":d=0;const v=c[4],b=c[5],C=c[4]+b;let m=Math.PI/180;if(Math.abs(v-C)<m&&(m=Math.abs(v-C)),f=g.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],v,0),b<0)for(h=v-m;h>C;h-=m)p=g.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],h,0),d+=g.getLineLength(f.x,f.y,p.x,p.y),f=p;else for(h=v+m;h<C;h+=m)p=g.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],h,0),d+=g.getLineLength(f.x,f.y,p.x,p.y),f=p;return p=g.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],C,0),d+=g.getLineLength(f.x,f.y,p.x,p.y),d}return 0}static convertEndpointToCenterParameterization(r,a,l,c,d,f,p,h,g){const v=g*(Math.PI/180),b=Math.cos(v)*(r-l)/2+Math.sin(v)*(a-c)/2,C=-1*Math.sin(v)*(r-l)/2+Math.cos(v)*(a-c)/2,m=b*b/(p*p)+C*C/(h*h);m>1&&(p*=Math.sqrt(m),h*=Math.sqrt(m));let u=Math.sqrt((p*p*(h*h)-p*p*(C*C)-h*h*(b*b))/(p*p*(C*C)+h*h*(b*b)));d===f&&(u*=-1),isNaN(u)&&(u=0);const y=u*p*C/h,S=u*-h*b/p,A=(r+l)/2+Math.cos(v)*y-Math.sin(v)*S,M=(a+c)/2+Math.sin(v)*y+Math.cos(v)*S,x=function(z){return Math.sqrt(z[0]*z[0]+z[1]*z[1])},w=function(z,q){return(z[0]*q[0]+z[1]*q[1])/(x(z)*x(q))},k=function(z,q){return(z[0]*q[1]<z[1]*q[0]?-1:1)*Math.acos(w(z,q))},T=k([1,0],[(b-y)/p,(C-S)/h]),R=[(b-y)/p,(C-S)/h],I=[(-1*b-y)/p,(-1*C-S)/h];let $=k(R,I);return w(R,I)<=-1&&($=Math.PI),w(R,I)>=1&&($=0),f===0&&$>0&&($=$-2*Math.PI),f===1&&$<0&&($=$+2*Math.PI),[A,M,p,h,T,$,v,f]}};return Ri.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,t._registerNode)(s),e.Factory.addGetterSetter(s,"data"),Ri}var Jc;function ap(){if(Jc)return Ei;Jc=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.Arrow=void 0;const e=Te(),t=Yc(),n=Ae(),i=ke(),s=No();let o=class extends t.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,c=this.points();let d=c;const f=this.tension()!==0&&c.length>4;f&&(d=this.getTensionPoints());const p=this.pointerLength(),h=c.length;let g,v;if(f){const m=[d[d.length-4],d[d.length-3],d[d.length-2],d[d.length-1],c[h-2],c[h-1]],u=s.Path.calcLength(d[d.length-4],d[d.length-3],"C",m),y=s.Path.getPointOnQuadraticBezier(Math.min(1,1-p/u),m[0],m[1],m[2],m[3],m[4],m[5]);g=c[h-2]-y.x,v=c[h-1]-y.y}else g=c[h-2]-c[h-4],v=c[h-1]-c[h-3];const b=(Math.atan2(v,g)+l)%l,C=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(c[h-2],c[h-1]),a.rotate(b),a.moveTo(0,0),a.lineTo(-p,C/2),a.lineTo(-p,-C/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(c[0],c[1]),f?(g=(d[0]+d[2])/2-c[0],v=(d[1]+d[3])/2-c[1]):(g=c[2]-c[0],v=c[3]-c[1]),a.rotate((Math.atan2(-v,-g)+l)%l),a.moveTo(0,0),a.lineTo(-p,C/2),a.lineTo(-p,-C/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return Ei.Arrow=o,o.prototype.className="Arrow",(0,i._registerNode)(o),e.Factory.addGetterSetter(o,"pointerLength",10,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(o,"pointerWidth",10,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(o,"pointerAtBeginning",!1),e.Factory.addGetterSetter(o,"pointerAtEnding",!0),Ei}var Mi={},Qc;function lp(){if(Qc)return Mi;Qc=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.Circle=void 0;const e=Te(),t=tt(),n=Ae(),i=ke();let s=class extends t.Shape{_sceneFunc(r){r.beginPath(),r.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),r.closePath(),r.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(r){this.radius()!==r/2&&this.radius(r/2)}setHeight(r){this.radius()!==r/2&&this.radius(r/2)}};return Mi.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),Mi}var Di={},ed;function cp(){if(ed)return Di;ed=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.Ellipse=void 0;const e=Te(),t=tt(),n=Ae(),i=ke();let s=class extends t.Shape{_sceneFunc(r){const a=this.radiusX(),l=this.radiusY();r.beginPath(),r.save(),a!==l&&r.scale(1,l/a),r.arc(0,0,a,0,Math.PI*2,!1),r.restore(),r.closePath(),r.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(r){this.radiusX(r/2)}setHeight(r){this.radiusY(r/2)}};return Di.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(s),e.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),e.Factory.addGetterSetter(s,"radiusX",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(s,"radiusY",0,(0,n.getNumberValidator)()),Di}var Oi={},td;function dp(){if(td)return Oi;td=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.Image=void 0;const e=qe(),t=Te(),n=tt(),i=ke(),s=Ae();let o=class uh extends n.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),c=this.getHeight(),d=this.cornerRadius(),f=this.attrs.image;let p;if(f){const h=this.attrs.cropWidth,g=this.attrs.cropHeight;h&&g?p=[f,this.cropX(),this.cropY(),h,g,0,0,l,c]:p=[f,0,0,l,c]}(this.hasFill()||this.hasStroke()||d)&&(a.beginPath(),d?e.Util.drawRoundedRectPath(a,l,c,d):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)),f&&(d&&a.clip(),a.drawImage.apply(a,p))}_hitFunc(a){const l=this.width(),c=this.height(),d=this.cornerRadius();a.beginPath(),d?e.Util.drawRoundedRectPath(a,l,c,d):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,c=null){const d=e.Util.createImageElement();d.onload=function(){const f=new uh({image:d});l(f)},d.onerror=c,d.crossOrigin="Anonymous",d.src=a}};return Oi.Image=o,o.prototype.className="Image",(0,i._registerNode)(o),t.Factory.addGetterSetter(o,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(o,"image"),t.Factory.addComponentsGetterSetter(o,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(o,"cropX",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(o,"cropY",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(o,"cropWidth",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(o,"cropHeight",0,(0,s.getNumberValidator)()),Oi}var An={},nd;function up(){if(nd)return An;nd=1,Object.defineProperty(An,"__esModule",{value:!0}),An.Tag=An.Label=void 0;const e=Te(),t=tt(),n=Ro(),i=Ae(),s=ke(),o=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],r="Change.konva",a="none",l="up",c="right",d="down",f="left",p=o.length;let h=class extends n.Group{constructor(b){super(b),this.on("add.konva",function(C){this._addListeners(C.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(b){let C=this,m;const u=function(){C._sync()};for(m=0;m<p;m++)b.on(o[m]+r,u)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let b=this.getText(),C=this.getTag(),m,u,y,S,A,M,x;if(b&&C){switch(m=b.width(),u=b.height(),y=C.pointerDirection(),S=C.pointerWidth(),x=C.pointerHeight(),A=0,M=0,y){case l:A=m/2,M=-1*x;break;case c:A=m+S,M=u/2;break;case d:A=m/2,M=u+x;break;case f:A=-1*S,M=u/2;break}C.setAttrs({x:-1*A,y:-1*M,width:m,height:u}),b.setAttrs({x:-1*A,y:-1*M})}}};An.Label=h,h.prototype.className="Label",(0,s._registerNode)(h);class g extends t.Shape{_sceneFunc(b){const C=this.width(),m=this.height(),u=this.pointerDirection(),y=this.pointerWidth(),S=this.pointerHeight(),A=this.cornerRadius();let M=0,x=0,w=0,k=0;typeof A=="number"?M=x=w=k=Math.min(A,C/2,m/2):(M=Math.min(A[0]||0,C/2,m/2),x=Math.min(A[1]||0,C/2,m/2),k=Math.min(A[2]||0,C/2,m/2),w=Math.min(A[3]||0,C/2,m/2)),b.beginPath(),b.moveTo(M,0),u===l&&(b.lineTo((C-y)/2,0),b.lineTo(C/2,-1*S),b.lineTo((C+y)/2,0)),b.lineTo(C-x,0),b.arc(C-x,x,x,Math.PI*3/2,0,!1),u===c&&(b.lineTo(C,(m-S)/2),b.lineTo(C+y,m/2),b.lineTo(C,(m+S)/2)),b.lineTo(C,m-k),b.arc(C-k,m-k,k,0,Math.PI/2,!1),u===d&&(b.lineTo((C+y)/2,m),b.lineTo(C/2,m+S),b.lineTo((C-y)/2,m)),b.lineTo(w,m),b.arc(w,m-w,w,Math.PI/2,Math.PI,!1),u===f&&(b.lineTo(0,(m+S)/2),b.lineTo(-1*y,m/2),b.lineTo(0,(m-S)/2)),b.lineTo(0,M),b.arc(M,M,M,Math.PI,Math.PI*3/2,!1),b.closePath(),b.fillStrokeShape(this)}getSelfRect(){let b=0,C=0,m=this.pointerWidth(),u=this.pointerHeight(),y=this.pointerDirection(),S=this.width(),A=this.height();return y===l?(C-=u,A+=u):y===d?A+=u:y===f?(b-=m*1.5,S+=m):y===c&&(S+=m*1.5),{x:b,y:C,width:S,height:A}}}return An.Tag=g,g.prototype.className="Tag",(0,s._registerNode)(g),e.Factory.addGetterSetter(g,"pointerDirection",a),e.Factory.addGetterSetter(g,"pointerWidth",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(g,"pointerHeight",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(g,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),An}var Ni={},id;function rd(){if(id)return Ni;id=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.Rect=void 0;const e=Te(),t=tt(),n=ke(),i=qe(),s=Ae();let o=class extends t.Shape{_sceneFunc(a){const l=this.cornerRadius(),c=this.width(),d=this.height();a.beginPath(),l?i.Util.drawRoundedRectPath(a,c,d,l):a.rect(0,0,c,d),a.closePath(),a.fillStrokeShape(this)}};return Ni.Rect=o,o.prototype.className="Rect",(0,n._registerNode)(o),e.Factory.addGetterSetter(o,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),Ni}var Fi={},sd;function hp(){if(sd)return Fi;sd=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.RegularPolygon=void 0;const e=Te(),t=tt(),n=Ae(),i=ke();let s=class extends t.Shape{_sceneFunc(r){const a=this._getPoints();r.beginPath(),r.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)r.lineTo(a[l].x,a[l].y);r.closePath(),r.fillStrokeShape(this)}_getPoints(){const r=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let c=0;c<r;c++)l.push({x:a*Math.sin(c*2*Math.PI/r),y:-1*a*Math.cos(c*2*Math.PI/r)});return l}getSelfRect(){const r=this._getPoints();let a=r[0].x,l=r[0].y,c=r[0].x,d=r[0].y;return r.forEach(f=>{a=Math.min(a,f.x),l=Math.max(l,f.x),c=Math.min(c,f.y),d=Math.max(d,f.y)}),{x:a,y:c,width:l-a,height:d-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(r){this.radius(r/2)}setHeight(r){this.radius(r/2)}};return Fi.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(s,"sides",0,(0,n.getNumberValidator)()),Fi}var Li={},od;function fp(){if(od)return Li;od=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.Ring=void 0;const e=Te(),t=tt(),n=Ae(),i=ke(),s=Math.PI*2;let o=class extends t.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,s,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),s,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return Li.Ring=o,o.prototype.className="Ring",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(o),e.Factory.addGetterSetter(o,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(o,"outerRadius",0,(0,n.getNumberValidator)()),Li}var Ii={},ad;function pp(){if(ad)return Ii;ad=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.Sprite=void 0;const e=Te(),t=tt(),n=Mo(),i=Ae(),s=ke();let o=class extends t.Shape{constructor(a){super(a),this._updated=!0,this.anim=new n.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),c=this.frameIndex(),d=c*4,f=this.animations()[l],p=this.frameOffsets(),h=f[d+0],g=f[d+1],v=f[d+2],b=f[d+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,v,b),a.closePath(),a.fillStrokeShape(this)),C)if(p){const m=p[l],u=c*2;a.drawImage(C,h,g,v,b,m[u+0],m[u+1],v,b)}else a.drawImage(C,h,g,v,b,0,0,v,b)}_hitFunc(a){const l=this.animation(),c=this.frameIndex(),d=c*4,f=this.animations()[l],p=this.frameOffsets(),h=f[d+2],g=f[d+3];if(a.beginPath(),p){const v=p[l],b=c*2;a.rect(v[b+0],v[b+1],h,g)}else a.rect(0,0,h,g);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),c=this.animations(),d=c[l],f=d.length/4;a<f-1?this.frameIndex(a+1):this.frameIndex(0)}};return Ii.Sprite=o,o.prototype.className="Sprite",(0,s._registerNode)(o),e.Factory.addGetterSetter(o,"animation"),e.Factory.addGetterSetter(o,"animations"),e.Factory.addGetterSetter(o,"frameOffsets"),e.Factory.addGetterSetter(o,"image"),e.Factory.addGetterSetter(o,"frameIndex",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"frameRate",17,(0,i.getNumberValidator)()),e.Factory.backCompat(o,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Ii}var Gi={},ld;function gp(){if(ld)return Gi;ld=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.Star=void 0;const e=Te(),t=tt(),n=Ae(),i=ke();let s=class extends t.Shape{_sceneFunc(r){const a=this.innerRadius(),l=this.outerRadius(),c=this.numPoints();r.beginPath(),r.moveTo(0,0-l);for(let d=1;d<c*2;d++){const f=d%2===0?l:a,p=f*Math.sin(d*Math.PI/c),h=-1*f*Math.cos(d*Math.PI/c);r.lineTo(p,h)}r.closePath(),r.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(r){this.outerRadius(r/2)}setHeight(r){this.outerRadius(r/2)}};return Gi.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),e.Factory.addGetterSetter(s,"numPoints",5,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(s,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(s,"outerRadius",0,(0,n.getNumberValidator)()),Gi}var Kn={},cd;function dd(){if(cd)return Kn;cd=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.Text=void 0,Kn.stringToArray=r;const e=qe(),t=Te(),n=tt(),i=ke(),s=Ae(),o=ke();function r(H){return[...H].reduce((V,Q,se,F)=>{if(/\p{Emoji}/u.test(Q)){const E=F[se+1];E&&/\p{Emoji_Modifier}|\u200D/u.test(E)?(V.push(Q+E),F[se+1]=""):V.push(Q)}else/\p{Regional_Indicator}{2}/u.test(Q+(F[se+1]||""))?V.push(Q+F[se+1]):se>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(Q)?V[V.length-1]+=Q:Q&&V.push(Q);return V},[])}const a="auto",l="center",c="inherit",d="justify",f="Change.konva",p="2d",h="-",g="left",v="text",b="Text",C="top",m="bottom",u="middle",y="normal",S="px ",A=" ",M="right",x="rtl",w="word",k="char",T="none",R="",I=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],$=I.length;function z(H){return H.split(",").map(V=>{V=V.trim();const Q=V.indexOf(" ")>=0,se=V.indexOf('"')>=0||V.indexOf("'")>=0;return Q&&!se&&(V=`"${V}"`),V}).join(", ")}let q;function _(){return q||(q=e.Util.createCanvasElement().getContext(p),q)}function P(H){H.fillText(this._partialText,this._partialTextX,this._partialTextY)}function N(H){H.setAttr("miterLimit",2),H.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function O(H){return H=H||{},!H.fillLinearGradientColorStops&&!H.fillRadialGradientColorStops&&!H.fillPatternImage&&(H.fill=H.fill||"black"),H}let G=class extends n.Shape{constructor(V){super(O(V)),this._partialTextX=0,this._partialTextY=0;for(let Q=0;Q<$;Q++)this.on(I[Q]+f,this._setTextData);this._setTextData()}_sceneFunc(V){const Q=this.textArr,se=Q.length;if(!this.text())return;let F=this.padding(),E=this.fontSize(),U=this.lineHeight()*E,j=this.verticalAlign(),ee=this.direction(),he=0,D=this.align(),L=this.getWidth(),B=this.letterSpacing(),W=this.fill(),Z=this.textDecoration(),Y=Z.indexOf("underline")!==-1,ie=Z.indexOf("line-through")!==-1,oe;ee=ee===c?V.direction:ee;let re=U/2,te=u;if(i.Konva._fixTextRendering){const de=this.measureSize("M");te="alphabetic",re=(de.fontBoundingBoxAscent-de.fontBoundingBoxDescent)/2+U/2}for(ee===x&&V.setAttr("direction",ee),V.setAttr("font",this._getContextFont()),V.setAttr("textBaseline",te),V.setAttr("textAlign",g),j===u?he=(this.getHeight()-se*U-F*2)/2:j===m&&(he=this.getHeight()-se*U-F*2),V.translate(F,he+F),oe=0;oe<se;oe++){let de=0,le=0;const ue=Q[oe],pe=ue.text,_e=ue.width,Ee=ue.lastInParagraph;if(V.save(),D===M?de+=L-_e-F*2:D===l&&(de+=(L-_e-F*2)/2),Y){V.save(),V.beginPath();const we=i.Konva._fixTextRendering?Math.round(E/4):Math.round(E/2),Le=de,Ce=re+le+we;V.moveTo(Le,Ce);const Ie=D===d&&!Ee?L-F*2:_e;V.lineTo(Le+Math.round(Ie),Ce),V.lineWidth=E/15;const it=this._getLinearGradient();V.strokeStyle=it||W,V.stroke(),V.restore()}if(ie){V.save(),V.beginPath();const we=i.Konva._fixTextRendering?-Math.round(E/4):0;V.moveTo(de,re+le+we);const Le=D===d&&!Ee?L-F*2:_e;V.lineTo(de+Math.round(Le),re+le+we),V.lineWidth=E/15;const Ce=this._getLinearGradient();V.strokeStyle=Ce||W,V.stroke(),V.restore()}if(ee!==x&&(B!==0||D===d)){const we=pe.split(" ").length-1,Le=r(pe);for(let Ce=0;Ce<Le.length;Ce++){const Ie=Le[Ce];Ie===" "&&!Ee&&D===d&&(de+=(L-F*2-_e)/we),this._partialTextX=de,this._partialTextY=re+le,this._partialText=Ie,V.fillStrokeShape(this),de+=this.measureSize(Ie).width+B}}else B!==0&&V.setAttr("letterSpacing",`${B}px`),this._partialTextX=de,this._partialTextY=re+le,this._partialText=pe,V.fillStrokeShape(this);V.restore(),se>1&&(re+=U)}}_hitFunc(V){const Q=this.getWidth(),se=this.getHeight();V.beginPath(),V.rect(0,0,Q,se),V.closePath(),V.fillStrokeShape(this)}setText(V){const Q=e.Util._isString(V)?V:V==null?"":V+"";return this._setAttr(v,Q),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(V){var Q,se,F,E,U,j,ee,he,D,L,B;let W=_(),Z=this.fontSize(),Y;W.save(),W.font=this._getContextFont(),Y=W.measureText(V),W.restore();const ie=Z/100;return{actualBoundingBoxAscent:(Q=Y.actualBoundingBoxAscent)!==null&&Q!==void 0?Q:71.58203125*ie,actualBoundingBoxDescent:(se=Y.actualBoundingBoxDescent)!==null&&se!==void 0?se:0,actualBoundingBoxLeft:(F=Y.actualBoundingBoxLeft)!==null&&F!==void 0?F:-7.421875*ie,actualBoundingBoxRight:(E=Y.actualBoundingBoxRight)!==null&&E!==void 0?E:75.732421875*ie,alphabeticBaseline:(U=Y.alphabeticBaseline)!==null&&U!==void 0?U:0,emHeightAscent:(j=Y.emHeightAscent)!==null&&j!==void 0?j:100*ie,emHeightDescent:(ee=Y.emHeightDescent)!==null&&ee!==void 0?ee:-20*ie,fontBoundingBoxAscent:(he=Y.fontBoundingBoxAscent)!==null&&he!==void 0?he:91*ie,fontBoundingBoxDescent:(D=Y.fontBoundingBoxDescent)!==null&&D!==void 0?D:21*ie,hangingBaseline:(L=Y.hangingBaseline)!==null&&L!==void 0?L:72.80000305175781*ie,ideographicBaseline:(B=Y.ideographicBaseline)!==null&&B!==void 0?B:-21*ie,width:Y.width,height:Z}}_getContextFont(){return this.fontStyle()+A+this.fontVariant()+A+(this.fontSize()+S)+z(this.fontFamily())}_addTextLine(V){this.align()===d&&(V=V.trim());const se=this._getTextWidth(V);return this.textArr.push({text:V,width:se,lastInParagraph:!1})}_getTextWidth(V){const Q=this.letterSpacing(),se=V.length;return _().measureText(V).width+Q*se}_setTextData(){let V=this.text().split(`
`),Q=+this.fontSize(),se=0,F=this.lineHeight()*Q,E=this.attrs.width,U=this.attrs.height,j=E!==a&&E!==void 0,ee=U!==a&&U!==void 0,he=this.padding(),D=E-he*2,L=U-he*2,B=0,W=this.wrap(),Z=W!==T,Y=W!==k&&Z,ie=this.ellipsis();this.textArr=[],_().font=this._getContextFont();const oe=ie?this._getTextWidth(R):0;for(let re=0,te=V.length;re<te;++re){let de=V[re],le=this._getTextWidth(de);if(j&&le>D)for(;de.length>0;){let ue=0,pe=r(de).length,_e="",Ee=0;for(;ue<pe;){const we=ue+pe>>>1,Le=r(de),Ce=Le.slice(0,we+1).join(""),Ie=this._getTextWidth(Ce);(ie&&ee&&B+F>L?Ie+oe:Ie)<=D?(ue=we+1,_e=Ce,Ee=Ie):pe=we}if(_e){if(Y){const Ce=r(de),Ie=r(_e),it=Ce[Ie.length],ne=it===A||it===h;let K;if(ne&&Ee<=D)K=Ie.length;else{const ye=Ie.lastIndexOf(A),De=Ie.lastIndexOf(h);K=Math.max(ye,De)+1}K>0&&(ue=K,_e=Ce.slice(0,ue).join(""),Ee=this._getTextWidth(_e))}if(_e=_e.trimRight(),this._addTextLine(_e),se=Math.max(se,Ee),B+=F,this._shouldHandleEllipsis(B)){this._tryToAddEllipsisToLastLine();break}if(de=r(de).slice(ue).join("").trimLeft(),de.length>0&&(le=this._getTextWidth(de),le<=D)){this._addTextLine(de),B+=F,se=Math.max(se,le);break}}else break}else this._addTextLine(de),B+=F,se=Math.max(se,le),this._shouldHandleEllipsis(B)&&re<te-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),ee&&B+F>L)break}this.textHeight=Q,this.textWidth=se}_shouldHandleEllipsis(V){const Q=+this.fontSize(),se=this.lineHeight()*Q,F=this.attrs.height,E=F!==a&&F!==void 0,U=this.padding(),j=F-U*2;return!(this.wrap()!==T)||E&&V+se>j}_tryToAddEllipsisToLastLine(){const V=this.attrs.width,Q=V!==a&&V!==void 0,se=this.padding(),F=V-se*2,E=this.ellipsis(),U=this.textArr[this.textArr.length-1];!U||!E||(Q&&(this._getTextWidth(U.text+R)<F||(U.text=U.text.slice(0,U.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(U.text+R))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const V=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,Q=this.hasShadow();return V&&Q?!0:super._useBufferCanvas()}};return Kn.Text=G,G.prototype._fillFunc=P,G.prototype._strokeFunc=N,G.prototype.className=b,G.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,o._registerNode)(G),t.Factory.overWriteSetter(G,"width",(0,s.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(G,"height",(0,s.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(G,"direction",c),t.Factory.addGetterSetter(G,"fontFamily","Arial"),t.Factory.addGetterSetter(G,"fontSize",12,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(G,"fontStyle",y),t.Factory.addGetterSetter(G,"fontVariant",y),t.Factory.addGetterSetter(G,"padding",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(G,"align",g),t.Factory.addGetterSetter(G,"verticalAlign",C),t.Factory.addGetterSetter(G,"lineHeight",1,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(G,"wrap",w),t.Factory.addGetterSetter(G,"ellipsis",!1,(0,s.getBooleanValidator)()),t.Factory.addGetterSetter(G,"letterSpacing",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(G,"text","",(0,s.getStringValidator)()),t.Factory.addGetterSetter(G,"textDecoration",""),Kn}var zi={},ud;function mp(){if(ud)return zi;ud=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.TextPath=void 0;const e=qe(),t=Te(),n=tt(),i=No(),s=dd(),o=Ae(),r=ke(),a="",l="normal";function c(p){p.fillText(this.partialText,0,0)}function d(p){p.strokeText(this.partialText,0,0)}let f=class extends n.Shape{constructor(h){super(h),this.dummyCanvas=e.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(h){if(!this.attrs.data)return null;const g=this.pathLength;return h-1>g?null:i.Path.getPointAtLengthOfDataArray(h,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(h){h.setAttr("font",this._getContextFont()),h.setAttr("textBaseline",this.textBaseline()),h.setAttr("textAlign","left"),h.save();const g=this.textDecoration(),v=this.fill(),b=this.fontSize(),C=this.glyphInfo;g==="underline"&&h.beginPath();for(let m=0;m<C.length;m++){h.save();const u=C[m].p0;h.translate(u.x,u.y),h.rotate(C[m].rotation),this.partialText=C[m].text,h.fillStrokeShape(this),g==="underline"&&(m===0&&h.moveTo(0,b/2+1),h.lineTo(b,b/2+1)),h.restore()}g==="underline"&&(h.strokeStyle=v,h.lineWidth=b/20,h.stroke()),h.restore()}_hitFunc(h){h.beginPath();const g=this.glyphInfo;if(g.length>=1){const v=g[0].p0;h.moveTo(v.x,v.y)}for(let v=0;v<g.length;v++){const b=g[v].p1;h.lineTo(b.x,b.y)}h.setAttr("lineWidth",this.fontSize()),h.setAttr("strokeStyle",this.colorKey),h.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(h){return s.Text.prototype.setText.call(this,h)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(h){const v=this.dummyCanvas.getContext("2d");v.save(),v.font=this._getContextFont();const b=v.measureText(h);return v.restore(),{width:b.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:h,height:g}=this._getTextSize(this.attrs.text);if(this.textWidth=h,this.textHeight=g,this.glyphInfo=[],!this.attrs.data)return null;const v=this.letterSpacing(),b=this.align(),C=this.kerningFunc(),m=Math.max(this.textWidth+((this.attrs.text||"").length-1)*v,0);let u=0;b==="center"&&(u=Math.max(0,this.pathLength/2-m/2)),b==="right"&&(u=Math.max(0,this.pathLength-m));const y=(0,s.stringToArray)(this.text());let S=u;for(let A=0;A<y.length;A++){const M=this._getPointAtLength(S);if(!M)return;let x=this._getTextSize(y[A]).width+v;if(y[A]===" "&&b==="justify"){const $=this.text().split(" ").length-1;x+=(this.pathLength-m)/$}const w=this._getPointAtLength(S+x);if(!w)return;const k=i.Path.getLineLength(M.x,M.y,w.x,w.y);let T=0;if(C)try{T=C(y[A-1],y[A])*this.fontSize()}catch{T=0}M.x+=T,w.x+=T,this.textWidth+=T;const R=i.Path.getPointOnLine(T+k/2,M.x,M.y,w.x,w.y),I=Math.atan2(w.y-M.y,w.x-M.x);this.glyphInfo.push({transposeX:R.x,transposeY:R.y,text:y[A],rotation:I,p0:M,p1:w}),S+=x}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const h=[];this.glyphInfo.forEach(function(S){h.push(S.p0.x),h.push(S.p0.y),h.push(S.p1.x),h.push(S.p1.y)});let g=h[0]||0,v=h[0]||0,b=h[1]||0,C=h[1]||0,m,u;for(let S=0;S<h.length/2;S++)m=h[S*2],u=h[S*2+1],g=Math.min(g,m),v=Math.max(v,m),b=Math.min(b,u),C=Math.max(C,u);const y=this.fontSize();return{x:g-y/2,y:b-y/2,width:v-g+y,height:C-b+y}}destroy(){return e.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return zi.TextPath=f,f.prototype._fillFunc=c,f.prototype._strokeFunc=d,f.prototype._fillFuncHit=c,f.prototype._strokeFuncHit=d,f.prototype.className="TextPath",f.prototype._attrsAffectingSize=["text","fontSize","data"],(0,r._registerNode)(f),t.Factory.addGetterSetter(f,"data"),t.Factory.addGetterSetter(f,"fontFamily","Arial"),t.Factory.addGetterSetter(f,"fontSize",12,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(f,"fontStyle",l),t.Factory.addGetterSetter(f,"align","left"),t.Factory.addGetterSetter(f,"letterSpacing",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(f,"textBaseline","middle"),t.Factory.addGetterSetter(f,"fontVariant",l),t.Factory.addGetterSetter(f,"text",a),t.Factory.addGetterSetter(f,"textDecoration",""),t.Factory.addGetterSetter(f,"kerningFunc",void 0),zi}var Ui={},hd;function yp(){if(hd)return Ui;hd=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.Transformer=void 0;const e=qe(),t=Te(),n=Ye(),i=tt(),s=rd(),o=Ro(),r=ke(),a=Ae(),l=ke(),c="tr-konva",d=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(x=>x+`.${c}`).join(" "),f="nodesRect",p=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],h={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},g="ontouchstart"in r.Konva._global;function v(x,w,k){if(x==="rotater")return k;w+=e.Util.degToRad(h[x]||0);const T=(e.Util.radToDeg(w)%360+360)%360;return e.Util._inRange(T,337.5,360)||e.Util._inRange(T,0,22.5)?"ns-resize":e.Util._inRange(T,22.5,67.5)?"nesw-resize":e.Util._inRange(T,67.5,112.5)?"ew-resize":e.Util._inRange(T,112.5,157.5)?"nwse-resize":e.Util._inRange(T,157.5,202.5)?"ns-resize":e.Util._inRange(T,202.5,247.5)?"nesw-resize":e.Util._inRange(T,247.5,292.5)?"ew-resize":e.Util._inRange(T,292.5,337.5)?"nwse-resize":(e.Util.error("Transformer has unknown angle for cursor detection: "+T),"pointer")}const b=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function C(x){return{x:x.x+x.width/2*Math.cos(x.rotation)+x.height/2*Math.sin(-x.rotation),y:x.y+x.height/2*Math.cos(x.rotation)+x.width/2*Math.sin(x.rotation)}}function m(x,w,k){const T=k.x+(x.x-k.x)*Math.cos(w)-(x.y-k.y)*Math.sin(w),R=k.y+(x.x-k.x)*Math.sin(w)+(x.y-k.y)*Math.cos(w);return{...x,rotation:x.rotation+w,x:T,y:R}}function u(x,w){const k=C(x);return m(x,w,k)}function y(x,w,k){let T=w;for(let R=0;R<x.length;R++){const I=r.Konva.getAngle(x[R]),$=Math.abs(I-w)%(Math.PI*2);Math.min($,Math.PI*2-$)<k&&(T=I)}return T}let S=0,A=class extends o.Group{constructor(w){super(w),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(w){return this.setNode(w),this}setNode(w){return e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([w])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(w=[]){this._nodes&&this._nodes.length&&this.detach();const k=w.filter(R=>R.isAncestorOf(this)?(e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=w=k,w.length===1&&this.useSingleNodeRotation()?this.rotation(w[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(R=>{const I=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(R._attrsAffectingSize.length){const $=R._attrsAffectingSize.map(z=>z+"Change."+this._getEventNamespace()).join(" ");R.on($,I)}R.on(p.map($=>$+`.${this._getEventNamespace()}`).join(" "),I),R.on(`absoluteTransformChange.${this._getEventNamespace()}`,I),this._proxyDrag(R)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(w){let k;w.on(`dragstart.${this._getEventNamespace()}`,T=>{k=w.getAbsolutePosition(),!this.isDragging()&&w!==this.findOne(".back")&&this.startDrag(T,!1)}),w.on(`dragmove.${this._getEventNamespace()}`,T=>{if(!k)return;const R=w.getAbsolutePosition(),I=R.x-k.x,$=R.y-k.y;this.nodes().forEach(z=>{if(z===w||z.isDragging())return;const q=z.getAbsolutePosition();z.setAbsolutePosition({x:q.x+I,y:q.y+$}),z.startDrag(T)}),k=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(w=>{w.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(f),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(f,this.__getNodeRect)}__getNodeShape(w,k=this.rotation(),T){const R=w.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),I=w.getAbsoluteScale(T),$=w.getAbsolutePosition(T),z=R.x*I.x-w.offsetX()*I.x,q=R.y*I.y-w.offsetY()*I.y,_=(r.Konva.getAngle(w.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),P={x:$.x+z*Math.cos(_)+q*Math.sin(-_),y:$.y+q*Math.cos(_)+z*Math.sin(_),width:R.width*I.x,height:R.height*I.y,rotation:_};return m(P,-r.Konva.getAngle(k),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const k=[];this.nodes().map(_=>{const P=_.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),N=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}],O=_.getAbsoluteTransform();N.forEach(function(G){const H=O.point(G);k.push(H)})});const T=new e.Transform;T.rotate(-r.Konva.getAngle(this.rotation()));let R=1/0,I=1/0,$=-1/0,z=-1/0;k.forEach(function(_){const P=T.point(_);R===void 0&&(R=$=P.x,I=z=P.y),R=Math.min(R,P.x),I=Math.min(I,P.y),$=Math.max($,P.x),z=Math.max(z,P.y)}),T.invert();const q=T.point({x:R,y:I});return{x:q.x,y:q.y,width:$-R,height:z-I,rotation:r.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),b.forEach(w=>{this._createAnchor(w)}),this._createAnchor("rotater")}_createAnchor(w){const k=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:w+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:g?10:"auto"}),T=this;k.on("mousedown touchstart",function(R){T._handleMouseDown(R)}),k.on("dragstart",R=>{k.stopDrag(),R.cancelBubble=!0}),k.on("dragend",R=>{R.cancelBubble=!0}),k.on("mouseenter",()=>{const R=r.Konva.getAngle(this.rotation()),I=this.rotateAnchorCursor(),$=v(w,R,I);k.getStage().content&&(k.getStage().content.style.cursor=$),this._cursorChange=!0}),k.on("mouseout",()=>{k.getStage().content&&(k.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(k)}_createBack(){const w=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(k,T){const R=T.getParent(),I=R.padding();k.beginPath(),k.rect(-I,-I,T.width()+I*2,T.height()+I*2),k.moveTo(T.width()/2,-I),R.rotateEnabled()&&R.rotateLineVisible()&&k.lineTo(T.width()/2,-R.rotateAnchorOffset()*e.Util._sign(T.height())-I),k.fillStrokeShape(T)},hitFunc:(k,T)=>{if(!this.shouldOverdrawWholeArea())return;const R=this.padding();k.beginPath(),k.rect(-R,-R,T.width()+R*2,T.height()+R*2),k.fillStrokeShape(T)}});this.add(w),this._proxyDrag(w),w.on("dragstart",k=>{k.cancelBubble=!0}),w.on("dragmove",k=>{k.cancelBubble=!0}),w.on("dragend",k=>{k.cancelBubble=!0}),this.on("dragmove",k=>{this.update()})}_handleMouseDown(w){if(this._transforming)return;this._movingAnchorName=w.target.name().split(" ")[0];const k=this._getNodeRect(),T=k.width,R=k.height,I=Math.sqrt(Math.pow(T,2)+Math.pow(R,2));this.sin=Math.abs(R/I),this.cos=Math.abs(T/I),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const $=w.target.getAbsolutePosition(),z=w.target.getStage().getPointerPosition();this._anchorDragOffset={x:z.x-$.x,y:z.y-$.y},S++,this._fire("transformstart",{evt:w.evt,target:this.getNode()}),this._nodes.forEach(q=>{q._fire("transformstart",{evt:w.evt,target:q})})}_handleMouseMove(w){let k,T,R;const I=this.findOne("."+this._movingAnchorName),$=I.getStage();$.setPointersPositions(w);const z=$.getPointerPosition();let q={x:z.x-this._anchorDragOffset.x,y:z.y-this._anchorDragOffset.y};const _=I.getAbsolutePosition();this.anchorDragBoundFunc()&&(q=this.anchorDragBoundFunc()(_,q,w)),I.setAbsolutePosition(q);const P=I.getAbsolutePosition();if(_.x===P.x&&_.y===P.y)return;if(this._movingAnchorName==="rotater"){const F=this._getNodeRect();k=I.x()-F.width/2,T=-I.y()+F.height/2;let E=Math.atan2(-T,k)+Math.PI/2;F.height<0&&(E-=Math.PI);const j=r.Konva.getAngle(this.rotation())+E,ee=r.Konva.getAngle(this.rotationSnapTolerance()),D=y(this.rotationSnaps(),j,ee)-F.rotation,L=u(F,D);this._fitNodesInto(L,w);return}const N=this.shiftBehavior();let O;N==="inverted"?O=this.keepRatio()&&!w.shiftKey:N==="none"?O=this.keepRatio():O=this.keepRatio()||w.shiftKey;let G=this.centeredScaling()||w.altKey;if(this._movingAnchorName==="top-left"){if(O){const F=G?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};R=Math.sqrt(Math.pow(F.x-I.x(),2)+Math.pow(F.y-I.y(),2));const E=this.findOne(".top-left").x()>F.x?-1:1,U=this.findOne(".top-left").y()>F.y?-1:1;k=R*this.cos*E,T=R*this.sin*U,this.findOne(".top-left").x(F.x-k),this.findOne(".top-left").y(F.y-T)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(I.y());else if(this._movingAnchorName==="top-right"){if(O){const F=G?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};R=Math.sqrt(Math.pow(I.x()-F.x,2)+Math.pow(F.y-I.y(),2));const E=this.findOne(".top-right").x()<F.x?-1:1,U=this.findOne(".top-right").y()>F.y?-1:1;k=R*this.cos*E,T=R*this.sin*U,this.findOne(".top-right").x(F.x+k),this.findOne(".top-right").y(F.y-T)}var H=I.position();this.findOne(".top-left").y(H.y),this.findOne(".bottom-right").x(H.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(I.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(I.x());else if(this._movingAnchorName==="bottom-left"){if(O){const F=G?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};R=Math.sqrt(Math.pow(F.x-I.x(),2)+Math.pow(I.y()-F.y,2));const E=F.x<I.x()?-1:1,U=I.y()<F.y?-1:1;k=R*this.cos*E,T=R*this.sin*U,I.x(F.x-k),I.y(F.y+T)}H=I.position(),this.findOne(".top-left").x(H.x),this.findOne(".bottom-right").y(H.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(I.y());else if(this._movingAnchorName==="bottom-right"){if(O){const F=G?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};R=Math.sqrt(Math.pow(I.x()-F.x,2)+Math.pow(I.y()-F.y,2));const E=this.findOne(".bottom-right").x()<F.x?-1:1,U=this.findOne(".bottom-right").y()<F.y?-1:1;k=R*this.cos*E,T=R*this.sin*U,this.findOne(".bottom-right").x(F.x+k),this.findOne(".bottom-right").y(F.y+T)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(G=this.centeredScaling()||w.altKey,G){const F=this.findOne(".top-left"),E=this.findOne(".bottom-right"),U=F.x(),j=F.y(),ee=this.getWidth()-E.x(),he=this.getHeight()-E.y();E.move({x:-U,y:-j}),F.move({x:ee,y:he})}const V=this.findOne(".top-left").getAbsolutePosition();k=V.x,T=V.y;const Q=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),se=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:k,y:T,width:Q,height:se,rotation:r.Konva.getAngle(this.rotation())},w)}_handleMouseUp(w){this._removeEvents(w)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(w){var k;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const T=this.getNode();S--,this._fire("transformend",{evt:w,target:T}),(k=this.getLayer())===null||k===void 0||k.batchDraw(),T&&this._nodes.forEach(R=>{var I;R._fire("transformend",{evt:w,target:R}),(I=R.getLayer())===null||I===void 0||I.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(w,k){const T=this._getNodeRect(),R=1;if(e.Util._inRange(w.width,-this.padding()*2-R,R)){this.update();return}if(e.Util._inRange(w.height,-this.padding()*2-R,R)){this.update();return}const I=new e.Transform;if(I.rotate(r.Konva.getAngle(this.rotation())),this._movingAnchorName&&w.width<0&&this._movingAnchorName.indexOf("left")>=0){const O=I.point({x:-this.padding()*2,y:0});w.x+=O.x,w.y+=O.y,w.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y}else if(this._movingAnchorName&&w.width<0&&this._movingAnchorName.indexOf("right")>=0){const O=I.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y,w.width+=this.padding()*2}if(this._movingAnchorName&&w.height<0&&this._movingAnchorName.indexOf("top")>=0){const O=I.point({x:0,y:-this.padding()*2});w.x+=O.x,w.y+=O.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y,w.height+=this.padding()*2}else if(this._movingAnchorName&&w.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const O=I.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y,w.height+=this.padding()*2}if(this.boundBoxFunc()){const O=this.boundBoxFunc()(T,w);O?w=O:e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const $=1e7,z=new e.Transform;z.translate(T.x,T.y),z.rotate(T.rotation),z.scale(T.width/$,T.height/$);const q=new e.Transform,_=w.width/$,P=w.height/$;this.flipEnabled()===!1?(q.translate(w.x,w.y),q.rotate(w.rotation),q.translate(w.width<0?w.width:0,w.height<0?w.height:0),q.scale(Math.abs(_),Math.abs(P))):(q.translate(w.x,w.y),q.rotate(w.rotation),q.scale(_,P));const N=q.multiply(z.invert());this._nodes.forEach(O=>{var G;const H=O.getParent().getAbsoluteTransform(),V=O.getTransform().copy();V.translate(O.offsetX(),O.offsetY());const Q=new e.Transform;Q.multiply(H.copy().invert()).multiply(N).multiply(H).multiply(V);const se=Q.decompose();O.setAttrs(se),(G=O.getLayer())===null||G===void 0||G.batchDraw()}),this.rotation(e.Util._getRotation(w.rotation)),this._nodes.forEach(O=>{this._fire("transform",{evt:k,target:O}),O._fire("transform",{evt:k,target:O})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(w,k){this.findOne(w).setAttrs(k)}update(){var w;const k=this._getNodeRect();this.rotation(e.Util._getRotation(k.rotation));const T=k.width,R=k.height,I=this.enabledAnchors(),$=this.resizeEnabled(),z=this.padding(),q=this.anchorSize(),_=this.find("._anchor");_.forEach(N=>{N.setAttrs({width:q,height:q,offsetX:q/2,offsetY:q/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:q/2+z,offsetY:q/2+z,visible:$&&I.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:T/2,y:0,offsetY:q/2+z,visible:$&&I.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:T,y:0,offsetX:q/2-z,offsetY:q/2+z,visible:$&&I.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:R/2,offsetX:q/2+z,visible:$&&I.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:T,y:R/2,offsetX:q/2-z,visible:$&&I.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:R,offsetX:q/2+z,offsetY:q/2-z,visible:$&&I.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:T/2,y:R,offsetY:q/2-z,visible:$&&I.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:T,y:R,offsetX:q/2-z,offsetY:q/2-z,visible:$&&I.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:T/2,y:-this.rotateAnchorOffset()*e.Util._sign(R)-z,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:T,height:R,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const P=this.anchorStyleFunc();P&&_.forEach(N=>{P(N)}),(w=this.getLayer())===null||w===void 0||w.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const w=this.findOne("."+this._movingAnchorName);w&&w.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),o.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(w){return n.Node.prototype.clone.call(this,w)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Ui.Transformer=A,A.isTransforming=()=>S>0;function M(x){return x instanceof Array||e.Util.warn("enabledAnchors value should be an array"),x instanceof Array&&x.forEach(function(w){b.indexOf(w)===-1&&e.Util.warn("Unknown anchor name: "+w+". Available names are: "+b.join(", "))}),x||[]}return A.prototype.className="Transformer",(0,l._registerNode)(A),t.Factory.addGetterSetter(A,"enabledAnchors",b,M),t.Factory.addGetterSetter(A,"flipEnabled",!0,(0,a.getBooleanValidator)()),t.Factory.addGetterSetter(A,"resizeEnabled",!0),t.Factory.addGetterSetter(A,"anchorSize",10,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(A,"rotateEnabled",!0),t.Factory.addGetterSetter(A,"rotateLineVisible",!0),t.Factory.addGetterSetter(A,"rotationSnaps",[]),t.Factory.addGetterSetter(A,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(A,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(A,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(A,"borderEnabled",!0),t.Factory.addGetterSetter(A,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(A,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(A,"anchorFill","white"),t.Factory.addGetterSetter(A,"anchorCornerRadius",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(A,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(A,"borderStrokeWidth",1,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(A,"borderDash"),t.Factory.addGetterSetter(A,"keepRatio",!0),t.Factory.addGetterSetter(A,"shiftBehavior","default"),t.Factory.addGetterSetter(A,"centeredScaling",!1),t.Factory.addGetterSetter(A,"ignoreStroke",!1),t.Factory.addGetterSetter(A,"padding",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(A,"nodes"),t.Factory.addGetterSetter(A,"node"),t.Factory.addGetterSetter(A,"boundBoxFunc"),t.Factory.addGetterSetter(A,"anchorDragBoundFunc"),t.Factory.addGetterSetter(A,"anchorStyleFunc"),t.Factory.addGetterSetter(A,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(A,"useSingleNodeRotation",!0),t.Factory.backCompat(A,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Ui}var $i={},fd;function vp(){if(fd)return $i;fd=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.Wedge=void 0;const e=Te(),t=tt(),n=ke(),i=Ae(),s=ke();let o=class extends t.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return $i.Wedge=o,o.prototype.className="Wedge",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(o),e.Factory.addGetterSetter(o,"radius",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"angle",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"clockwise",!1),e.Factory.backCompat(o,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),$i}var Vi={},pd;function _p(){if(pd)return Vi;pd=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.Blur=void 0;const e=Te(),t=Ye(),n=Ae();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],o=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function r(l,c){const d=l.data,f=l.width,p=l.height;let h,g,v,b,C,m,u,y,S,A,M,x,w,k,T,R,I,$,z,q;const _=c+c+1,P=f-1,N=p-1,O=c+1,G=O*(O+1)/2,H=new i,V=s[c],Q=o[c];let se=null,F=H,E=null,U=null;for(let j=1;j<_;j++)F=F.next=new i,j===O&&(se=F);F.next=H,v=g=0;for(let j=0;j<p;j++){x=w=k=T=b=C=m=u=0,y=O*(R=d[g]),S=O*(I=d[g+1]),A=O*($=d[g+2]),M=O*(z=d[g+3]),b+=G*R,C+=G*I,m+=G*$,u+=G*z,F=H;for(let ee=0;ee<O;ee++)F.r=R,F.g=I,F.b=$,F.a=z,F=F.next;for(let ee=1;ee<O;ee++)h=g+((P<ee?P:ee)<<2),b+=(F.r=R=d[h])*(q=O-ee),C+=(F.g=I=d[h+1])*q,m+=(F.b=$=d[h+2])*q,u+=(F.a=z=d[h+3])*q,x+=R,w+=I,k+=$,T+=z,F=F.next;E=H,U=se;for(let ee=0;ee<f;ee++)d[g+3]=z=u*V>>Q,z!==0?(z=255/z,d[g]=(b*V>>Q)*z,d[g+1]=(C*V>>Q)*z,d[g+2]=(m*V>>Q)*z):d[g]=d[g+1]=d[g+2]=0,b-=y,C-=S,m-=A,u-=M,y-=E.r,S-=E.g,A-=E.b,M-=E.a,h=v+((h=ee+c+1)<P?h:P)<<2,x+=E.r=d[h],w+=E.g=d[h+1],k+=E.b=d[h+2],T+=E.a=d[h+3],b+=x,C+=w,m+=k,u+=T,E=E.next,y+=R=U.r,S+=I=U.g,A+=$=U.b,M+=z=U.a,x-=R,w-=I,k-=$,T-=z,U=U.next,g+=4;v+=f}for(let j=0;j<f;j++){w=k=T=x=C=m=u=b=0,g=j<<2,y=O*(R=d[g]),S=O*(I=d[g+1]),A=O*($=d[g+2]),M=O*(z=d[g+3]),b+=G*R,C+=G*I,m+=G*$,u+=G*z,F=H;for(let he=0;he<O;he++)F.r=R,F.g=I,F.b=$,F.a=z,F=F.next;let ee=f;for(let he=1;he<=c;he++)g=ee+j<<2,b+=(F.r=R=d[g])*(q=O-he),C+=(F.g=I=d[g+1])*q,m+=(F.b=$=d[g+2])*q,u+=(F.a=z=d[g+3])*q,x+=R,w+=I,k+=$,T+=z,F=F.next,he<N&&(ee+=f);g=j,E=H,U=se;for(let he=0;he<p;he++)h=g<<2,d[h+3]=z=u*V>>Q,z>0?(z=255/z,d[h]=(b*V>>Q)*z,d[h+1]=(C*V>>Q)*z,d[h+2]=(m*V>>Q)*z):d[h]=d[h+1]=d[h+2]=0,b-=y,C-=S,m-=A,u-=M,y-=E.r,S-=E.g,A-=E.b,M-=E.a,h=j+((h=he+O)<N?h:N)*f<<2,b+=x+=E.r=d[h],C+=w+=E.g=d[h+1],m+=k+=E.b=d[h+2],u+=T+=E.a=d[h+3],E=E.next,y+=R=U.r,S+=I=U.g,A+=$=U.b,M+=z=U.a,x-=R,w-=I,k-=$,T-=z,U=U.next,g+=f}}const a=function(c){const d=Math.round(this.blurRadius());d>0&&r(c,d)};return Vi.Blur=a,e.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Vi}var Bi={},gd;function bp(){if(gd)return Bi;gd=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.Brighten=void 0;const e=Te(),t=Ye(),n=Ae(),i=function(s){const o=this.brightness()*255,r=s.data,a=r.length;for(let l=0;l<a;l+=4)r[l]+=o,r[l+1]+=o,r[l+2]+=o};return Bi.Brighten=i,e.Factory.addGetterSetter(t.Node,"brightness",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Bi}var Hi={},md;function Sp(){if(md)return Hi;md=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.Contrast=void 0;const e=Te(),t=Ye(),n=Ae(),i=function(s){const o=Math.pow((this.contrast()+100)/100,2),r=s.data,a=r.length;let l=150,c=150,d=150;for(let f=0;f<a;f+=4)l=r[f],c=r[f+1],d=r[f+2],l/=255,l-=.5,l*=o,l+=.5,l*=255,c/=255,c-=.5,c*=o,c+=.5,c*=255,d/=255,d-=.5,d*=o,d+=.5,d*=255,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,d=d<0?0:d>255?255:d,r[f]=l,r[f+1]=c,r[f+2]=d};return Hi.Contrast=i,e.Factory.addGetterSetter(t.Node,"contrast",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Hi}var ji={},yd;function wp(){if(yd)return ji;yd=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.Emboss=void 0;const e=Te(),t=Ye(),n=qe(),i=Ae(),s=function(o){const r=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),c=this.embossBlend(),d=o.data,f=o.width,p=o.height,h=f*4;let g=0,v=0,b=p;switch(l){case"top-left":g=-1,v=-1;break;case"top":g=-1,v=0;break;case"top-right":g=-1,v=1;break;case"right":g=0,v=1;break;case"bottom-right":g=1,v=1;break;case"bottom":g=1,v=0;break;case"bottom-left":g=1,v=-1;break;case"left":g=0,v=-1;break;default:n.Util.error("Unknown emboss direction: "+l)}do{const C=(b-1)*h;let m=g;b+m<1&&(m=0),b+m>p&&(m=0);const u=(b-1+m)*f*4;let y=f;do{const S=C+(y-1)*4;let A=v;y+A<1&&(A=0),y+A>f&&(A=0);const M=u+(y-1+A)*4,x=d[S]-d[M],w=d[S+1]-d[M+1],k=d[S+2]-d[M+2];let T=x;const R=T>0?T:-T,I=w>0?w:-w,$=k>0?k:-k;if(I>R&&(T=w),$>R&&(T=k),T*=r,c){const z=d[S]+T,q=d[S+1]+T,_=d[S+2]+T;d[S]=z>255?255:z<0?0:z,d[S+1]=q>255?255:q<0?0:q,d[S+2]=_>255?255:_<0?0:_}else{let z=a-T;z<0?z=0:z>255&&(z=255),d[S]=d[S+1]=d[S+2]=z}}while(--y)}while(--b)};return ji.Emboss=s,e.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,i.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,e.Factory.afterSetFilter),ji}var Wi={},vd;function xp(){if(vd)return Wi;vd=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.Enhance=void 0;const e=Te(),t=Ye(),n=Ae();function i(o,r,a,l,c){const d=a-r,f=c-l;if(d===0)return l+f/2;if(f===0)return l;let p=(o-r)/d;return p=f*p+l,p}const s=function(o){const r=o.data,a=r.length;let l=r[0],c=l,d,f=r[1],p=f,h,g=r[2],v=g,b;const C=this.enhance();if(C===0)return;for(let x=0;x<a;x+=4)d=r[x+0],d<l?l=d:d>c&&(c=d),h=r[x+1],h<f?f=h:h>p&&(p=h),b=r[x+2],b<g?g=b:b>v&&(v=b);c===l&&(c=255,l=0),p===f&&(p=255,f=0),v===g&&(v=255,g=0);let m,u,y,S,A,M;if(C>0)m=c+C*(255-c),u=l-C*(l-0),y=p+C*(255-p),S=f-C*(f-0),A=v+C*(255-v),M=g-C*(g-0);else{const x=(c+l)*.5;m=c+C*(c-x),u=l+C*(l-x);const w=(p+f)*.5;y=p+C*(p-w),S=f+C*(f-w);const k=(v+g)*.5;A=v+C*(v-k),M=g+C*(g-k)}for(let x=0;x<a;x+=4)r[x+0]=i(r[x+0],l,c,u,m),r[x+1]=i(r[x+1],f,p,S,y),r[x+2]=i(r[x+2],g,v,M,A)};return Wi.Enhance=s,e.Factory.addGetterSetter(t.Node,"enhance",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Wi}var Ki={},_d;function Cp(){if(_d)return Ki;_d=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.Grayscale=void 0;const e=function(t){const n=t.data,i=n.length;for(let s=0;s<i;s+=4){const o=.34*n[s]+.5*n[s+1]+.16*n[s+2];n[s]=o,n[s+1]=o,n[s+2]=o}};return Ki.Grayscale=e,Ki}var qi={},bd;function kp(){if(bd)return qi;bd=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.HSL=void 0;const e=Te(),t=Ye(),n=Ae();e.Factory.addGetterSetter(t.Node,"hue",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"luminance",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter);const i=function(s){const o=s.data,r=o.length,a=1,l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,d=this.luminance()*127,f=a*l*Math.cos(c*Math.PI/180),p=a*l*Math.sin(c*Math.PI/180),h=.299*a+.701*f+.167*p,g=.587*a-.587*f+.33*p,v=.114*a-.114*f-.497*p,b=.299*a-.299*f-.328*p,C=.587*a+.413*f+.035*p,m=.114*a-.114*f+.293*p,u=.299*a-.3*f+1.25*p,y=.587*a-.586*f-1.05*p,S=.114*a+.886*f-.2*p;let A,M,x,w;for(let k=0;k<r;k+=4)A=o[k+0],M=o[k+1],x=o[k+2],w=o[k+3],o[k+0]=h*A+g*M+v*x+d,o[k+1]=b*A+C*M+m*x+d,o[k+2]=u*A+y*M+S*x+d,o[k+3]=w};return qi.HSL=i,qi}var Yi={},Sd;function Pp(){if(Sd)return Yi;Sd=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.HSV=void 0;const e=Te(),t=Ye(),n=Ae(),i=function(s){const o=s.data,r=o.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,d=a*l*Math.cos(c*Math.PI/180),f=a*l*Math.sin(c*Math.PI/180),p=.299*a+.701*d+.167*f,h=.587*a-.587*d+.33*f,g=.114*a-.114*d-.497*f,v=.299*a-.299*d-.328*f,b=.587*a+.413*d+.035*f,C=.114*a-.114*d+.293*f,m=.299*a-.3*d+1.25*f,u=.587*a-.586*d-1.05*f,y=.114*a+.886*d-.2*f;for(let S=0;S<r;S+=4){const A=o[S+0],M=o[S+1],x=o[S+2],w=o[S+3];o[S+0]=p*A+h*M+g*x,o[S+1]=v*A+b*M+C*x,o[S+2]=m*A+u*M+y*x,o[S+3]=w}};return Yi.HSV=i,e.Factory.addGetterSetter(t.Node,"hue",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"value",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Yi}var Xi={},wd;function Tp(){if(wd)return Xi;wd=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.Invert=void 0;const e=function(t){const n=t.data,i=n.length;for(let s=0;s<i;s+=4)n[s]=255-n[s],n[s+1]=255-n[s+1],n[s+2]=255-n[s+2]};return Xi.Invert=e,Xi}var Zi={},xd;function Ep(){if(xd)return Zi;xd=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.Kaleidoscope=void 0;const e=Te(),t=Ye(),n=qe(),i=Ae(),s=function(a,l,c){const d=a.data,f=l.data,p=a.width,h=a.height,g=c.polarCenterX||p/2,v=c.polarCenterY||h/2;let b=Math.sqrt(g*g+v*v),C=p-g,m=h-v;const u=Math.sqrt(C*C+m*m);b=u>b?u:b;const y=h,S=p,A=360/S*Math.PI/180;for(let M=0;M<S;M+=1){const x=Math.sin(M*A),w=Math.cos(M*A);for(let k=0;k<y;k+=1){C=Math.floor(g+b*k/y*w),m=Math.floor(v+b*k/y*x);let T=(m*p+C)*4;const R=d[T+0],I=d[T+1],$=d[T+2],z=d[T+3];T=(M+k*p)*4,f[T+0]=R,f[T+1]=I,f[T+2]=$,f[T+3]=z}}},o=function(a,l,c){const d=a.data,f=l.data,p=a.width,h=a.height,g=c.polarCenterX||p/2,v=c.polarCenterY||h/2;let b=Math.sqrt(g*g+v*v),C=p-g,m=h-v;const u=Math.sqrt(C*C+m*m);b=u>b?u:b;const y=h,S=p,A=0;let M,x;for(C=0;C<p;C+=1)for(m=0;m<h;m+=1){const w=C-g,k=m-v,T=Math.sqrt(w*w+k*k)*y/b;let R=(Math.atan2(k,w)*180/Math.PI+360+A)%360;R=R*S/360,M=Math.floor(R),x=Math.floor(T);let I=(x*p+M)*4;const $=d[I+0],z=d[I+1],q=d[I+2],_=d[I+3];I=(m*p+C)*4,f[I+0]=$,f[I+1]=z,f[I+2]=q,f[I+3]=_}},r=function(a){const l=a.width,c=a.height;let d,f,p,h,g,v,b,C,m,u,y=Math.round(this.kaleidoscopePower());const S=Math.round(this.kaleidoscopeAngle()),A=Math.floor(l*(S%360)/360);if(y<1)return;const M=n.Util.createCanvasElement();M.width=l,M.height=c;const x=M.getContext("2d").getImageData(0,0,l,c);n.Util.releaseCanvas(M),s(a,x,{polarCenterX:l/2,polarCenterY:c/2});let w=l/Math.pow(2,y);for(;w<=8;)w=w*2,y-=1;w=Math.ceil(w);let k=w,T=0,R=k,I=1;for(A+w>l&&(T=k,R=0,I=-1),f=0;f<c;f+=1)for(d=T;d!==R;d+=I)p=Math.round(d+A)%l,m=(l*f+p)*4,g=x.data[m+0],v=x.data[m+1],b=x.data[m+2],C=x.data[m+3],u=(l*f+d)*4,x.data[u+0]=g,x.data[u+1]=v,x.data[u+2]=b,x.data[u+3]=C;for(f=0;f<c;f+=1)for(k=Math.floor(w),h=0;h<y;h+=1){for(d=0;d<k+1;d+=1)m=(l*f+d)*4,g=x.data[m+0],v=x.data[m+1],b=x.data[m+2],C=x.data[m+3],u=(l*f+k*2-d-1)*4,x.data[u+0]=g,x.data[u+1]=v,x.data[u+2]=b,x.data[u+3]=C;k*=2}o(x,a,{})};return Zi.Kaleidoscope=r,e.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),e.Factory.afterSetFilter),Zi}var Ji={},Cd;function Ap(){if(Cd)return Ji;Cd=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.Mask=void 0;const e=Te(),t=Ye(),n=Ae();function i(p,h,g){let v=(g*p.width+h)*4;const b=[];return b.push(p.data[v++],p.data[v++],p.data[v++],p.data[v++]),b}function s(p,h){return Math.sqrt(Math.pow(p[0]-h[0],2)+Math.pow(p[1]-h[1],2)+Math.pow(p[2]-h[2],2))}function o(p){const h=[0,0,0];for(let g=0;g<p.length;g++)h[0]+=p[g][0],h[1]+=p[g][1],h[2]+=p[g][2];return h[0]/=p.length,h[1]/=p.length,h[2]/=p.length,h}function r(p,h){const g=i(p,0,0),v=i(p,p.width-1,0),b=i(p,0,p.height-1),C=i(p,p.width-1,p.height-1),m=h||10;if(s(g,v)<m&&s(v,C)<m&&s(C,b)<m&&s(b,g)<m){const u=o([v,g,C,b]),y=[];for(let S=0;S<p.width*p.height;S++){const A=s(u,[p.data[S*4],p.data[S*4+1],p.data[S*4+2]]);y[S]=A<m?0:255}return y}}function a(p,h){for(let g=0;g<p.width*p.height;g++)p.data[4*g+3]=h[g]}function l(p,h,g){const v=[1,1,1,1,0,1,1,1,1],b=Math.round(Math.sqrt(v.length)),C=Math.floor(b/2),m=[];for(let u=0;u<g;u++)for(let y=0;y<h;y++){const S=u*h+y;let A=0;for(let M=0;M<b;M++)for(let x=0;x<b;x++){const w=u+M-C,k=y+x-C;if(w>=0&&w<g&&k>=0&&k<h){const T=w*h+k,R=v[M*b+x];A+=p[T]*R}}m[S]=A===2040?255:0}return m}function c(p,h,g){const v=[1,1,1,1,1,1,1,1,1],b=Math.round(Math.sqrt(v.length)),C=Math.floor(b/2),m=[];for(let u=0;u<g;u++)for(let y=0;y<h;y++){const S=u*h+y;let A=0;for(let M=0;M<b;M++)for(let x=0;x<b;x++){const w=u+M-C,k=y+x-C;if(w>=0&&w<g&&k>=0&&k<h){const T=w*h+k,R=v[M*b+x];A+=p[T]*R}}m[S]=A>=1020?255:0}return m}function d(p,h,g){const v=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],b=Math.round(Math.sqrt(v.length)),C=Math.floor(b/2),m=[];for(let u=0;u<g;u++)for(let y=0;y<h;y++){const S=u*h+y;let A=0;for(let M=0;M<b;M++)for(let x=0;x<b;x++){const w=u+M-C,k=y+x-C;if(w>=0&&w<g&&k>=0&&k<h){const T=w*h+k,R=v[M*b+x];A+=p[T]*R}}m[S]=A}return m}const f=function(p){const h=this.threshold();let g=r(p,h);return g&&(g=l(g,p.width,p.height),g=c(g,p.width,p.height),g=d(g,p.width,p.height),a(p,g)),p};return Ji.Mask=f,e.Factory.addGetterSetter(t.Node,"threshold",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Ji}var Qi={},kd;function Rp(){if(kd)return Qi;kd=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.Noise=void 0;const e=Te(),t=Ye(),n=Ae(),i=function(s){const o=this.noise()*255,r=s.data,a=r.length,l=o/2;for(let c=0;c<a;c+=4)r[c+0]+=l-2*l*Math.random(),r[c+1]+=l-2*l*Math.random(),r[c+2]+=l-2*l*Math.random()};return Qi.Noise=i,e.Factory.addGetterSetter(t.Node,"noise",.2,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Qi}var er={},Pd;function Mp(){if(Pd)return er;Pd=1,Object.defineProperty(er,"__esModule",{value:!0}),er.Pixelate=void 0;const e=Te(),t=qe(),n=Ye(),i=Ae(),s=function(o){let r=Math.ceil(this.pixelSize()),a=o.width,l=o.height,c=Math.ceil(a/r),d=Math.ceil(l/r),f=o.data;if(r<=0){t.Util.error("pixelSize value can not be <= 0");return}for(let p=0;p<c;p+=1)for(let h=0;h<d;h+=1){let g=0,v=0,b=0,C=0;const m=p*r,u=m+r,y=h*r,S=y+r;let A=0;for(let M=m;M<u;M+=1)if(!(M>=a))for(let x=y;x<S;x+=1){if(x>=l)continue;const w=(a*x+M)*4;g+=f[w+0],v+=f[w+1],b+=f[w+2],C+=f[w+3],A+=1}g=g/A,v=v/A,b=b/A,C=C/A;for(let M=m;M<u;M+=1)if(!(M>=a))for(let x=y;x<S;x+=1){if(x>=l)continue;const w=(a*x+M)*4;f[w+0]=g,f[w+1]=v,f[w+2]=b,f[w+3]=C}}};return er.Pixelate=s,e.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),e.Factory.afterSetFilter),er}var tr={},Td;function Dp(){if(Td)return tr;Td=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.Posterize=void 0;const e=Te(),t=Ye(),n=Ae(),i=function(s){const o=Math.round(this.levels()*254)+1,r=s.data,a=r.length,l=255/o;for(let c=0;c<a;c+=1)r[c]=Math.floor(r[c]/l)*l};return tr.Posterize=i,e.Factory.addGetterSetter(t.Node,"levels",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),tr}var nr={},Ed;function Op(){if(Ed)return nr;Ed=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.RGB=void 0;const e=Te(),t=Ye(),n=Ae(),i=function(s){const o=s.data,r=o.length,a=this.red(),l=this.green(),c=this.blue();for(let d=0;d<r;d+=4){const f=(.34*o[d]+.5*o[d+1]+.16*o[d+2])/255;o[d]=f*a,o[d+1]=f*l,o[d+2]=f*c,o[d+3]=o[d+3]}};return nr.RGB=i,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,n.RGBComponent,e.Factory.afterSetFilter),nr}var ir={},Ad;function Np(){if(Ad)return ir;Ad=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.RGBA=void 0;const e=Te(),t=Ye(),n=Ae(),i=function(s){const o=s.data,r=o.length,a=this.red(),l=this.green(),c=this.blue(),d=this.alpha();for(let f=0;f<r;f+=4){const p=1-d;o[f]=a*d+o[f]*p,o[f+1]=l*d+o[f+1]*p,o[f+2]=c*d+o[f+2]*p}};return ir.RGBA=i,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,n.RGBComponent,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),ir}var rr={},Rd;function Fp(){if(Rd)return rr;Rd=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.Sepia=void 0;const e=function(t){const n=t.data,i=n.length;for(let s=0;s<i;s+=4){const o=n[s+0],r=n[s+1],a=n[s+2];n[s+0]=Math.min(255,o*.393+r*.769+a*.189),n[s+1]=Math.min(255,o*.349+r*.686+a*.168),n[s+2]=Math.min(255,o*.272+r*.534+a*.131)}};return rr.Sepia=e,rr}var sr={},Md;function Lp(){if(Md)return sr;Md=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.Solarize=void 0;const e=function(t){const n=t.data,i=t.width,s=t.height,o=i*4;let r=s;do{const a=(r-1)*o;let l=i;do{const c=a+(l-1)*4;let d=n[c],f=n[c+1],p=n[c+2];d>127&&(d=255-d),f>127&&(f=255-f),p>127&&(p=255-p),n[c]=d,n[c+1]=f,n[c+2]=p}while(--l)}while(--r)};return sr.Solarize=e,sr}var or={},Dd;function Ip(){if(Dd)return or;Dd=1,Object.defineProperty(or,"__esModule",{value:!0}),or.Threshold=void 0;const e=Te(),t=Ye(),n=Ae(),i=function(s){const o=this.threshold()*255,r=s.data,a=r.length;for(let l=0;l<a;l+=1)r[l]=r[l]<o?0:255};return or.Threshold=i,e.Factory.addGetterSetter(t.Node,"threshold",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),or}var Od;function Gp(){if(Od)return bi;Od=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.Konva=void 0;const e=rp(),t=sp(),n=ap(),i=lp(),s=cp(),o=dp(),r=up(),a=Yc(),l=No(),c=rd(),d=hp(),f=fp(),p=pp(),h=gp(),g=dd(),v=mp(),b=yp(),C=vp(),m=_p(),u=bp(),y=Sp(),S=wp(),A=xp(),M=Cp(),x=kp(),w=Pp(),k=Tp(),T=Ep(),R=Ap(),I=Rp(),$=Mp(),z=Dp(),q=Op(),_=Np(),P=Fp(),N=Lp(),O=Ip();return bi.Konva=e.Konva.Util._assign(e.Konva,{Arc:t.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:s.Ellipse,Image:o.Image,Label:r.Label,Tag:r.Tag,Line:a.Line,Path:l.Path,Rect:c.Rect,RegularPolygon:d.RegularPolygon,Ring:f.Ring,Sprite:p.Sprite,Star:h.Star,Text:g.Text,TextPath:v.TextPath,Transformer:b.Transformer,Wedge:C.Wedge,Filters:{Blur:m.Blur,Brighten:u.Brighten,Contrast:y.Contrast,Emboss:S.Emboss,Enhance:A.Enhance,Grayscale:M.Grayscale,HSL:x.HSL,HSV:w.HSV,Invert:k.Invert,Kaleidoscope:T.Kaleidoscope,Mask:R.Mask,Noise:I.Noise,Pixelate:$.Pixelate,Posterize:z.Posterize,RGB:q.RGB,RGBA:_.RGBA,Sepia:P.Sepia,Solarize:N.Solarize,Threshold:O.Threshold}}),bi}var zp=ts.exports,Nd;function Up(){if(Nd)return ts.exports;Nd=1,Object.defineProperty(zp,"__esModule",{value:!0});const e=Gp();return ts.exports=e.Konva,ts.exports}var $p=Up();const X=ep($p);class Vp{constructor(t,n,i){this.captureState=t,this.restoreState=n,this.onStateChange=i}history=[];historyIndex=-1;inUndoRedo=!1;maxHistorySize=50;executeCommand(t,n){if(this.inUndoRedo){n();return}const i=this.captureState();if(!i)return;n();const s=this.captureState();if(!s||i===s)return;const o={name:t,beforeState:i,afterState:s};this.history.splice(this.historyIndex+1),this.history.push(o),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${t}" added to history. Index: ${this.historyIndex}`)}pushCommand(t,n,i){if(!n||!i||n===i)return;const s={name:t,beforeState:n,afterState:i};this.history.splice(this.historyIndex+1),this.history.push(s),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${t}" pushed. Index: ${this.historyIndex}`)}undo(){if(this.historyIndex<0)return;this.inUndoRedo=!0;const t=this.history[this.historyIndex];console.log(`Undoing command: ${t.name}`),this.restoreState(t.beforeState),this.historyIndex--,this.onStateChange?.(),this.inUndoRedo=!1}redo(){if(this.historyIndex>=this.history.length-1)return;this.inUndoRedo=!0,this.historyIndex++;const t=this.history[this.historyIndex];console.log(`Redoing command: ${t.name}`),this.restoreState(t.afterState),this.onStateChange?.(),this.inUndoRedo=!1}canUndo(){return this.historyIndex>=0}canRedo(){return this.historyIndex<this.history.length-1}}const Bp=()=>{const e=Xa(new Set),t=new Map,n=xe(()=>Array.from(e,i=>i.konvaNode));return{stage:void 0,konvaContainer:void 0,activeTool:ge("select"),metadataSchemas:[],layers:{grid:void 0,drawing:void 0,overlay:void 0,transformer:void 0},groups:{freehandShape:void 0,freehandDrawing:void 0,polygonShapes:void 0,polygonPreview:void 0,polygonControls:void 0,polygonSelection:void 0,ancillaryViz:void 0,metadataHighlight:void 0,selectionOverlay:void 0},grid:{visible:ge(!1),size:20},canvasItems:new Map,notification:{message:ge(""),visible:ge(!1)},callbacks:{},keyboardDisposables:[],freehand:{strokes:new Map,strokeGroups:new Map,dragSelectionState:ge({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,isDrawing:!1,currentPoints:[],currentTimestamps:[],drawingStartTime:0,selectedStrokesForTimeline:ge(new Set),timelineDuration:ge(0),currentPlaybackTime:ge(0),freehandDrawMode:ge(!0),useRealTiming:ge(!1),maxInterStrokeDelay:300,isAnimating:ge(!1),freehandDragStartState:null,serializedState:"",bakedRenderData:[],bakedGroupMap:{}},polygon:{shapes:new Map,groups:new Map,isDrawing:ge(!1),currentPoints:ge([]),mode:ge("draw"),dragStartState:null,proximityThreshold:10,serializedState:"",bakedRenderData:[]},circle:{shapes:new Map,isDrawing:ge(!1),currentCenter:ge(null),currentRadius:ge(0),dragStartState:null,serializedState:"",bakedRenderData:[],bakedGroupMap:{}},selection:{items:e,originalStyles:t,selectedKonvaNodes:n,dragSelectionState:ge({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,selectionDragState:{isDragging:!1,startPos:{x:0,y:0},startNodePositions:new Map,beforeState:""},transformStartState:""},command:{},metadata:{activeNode:ge(null),metadataText:ge(""),showEditor:ge(!0),highlight:{}},ancillary:{activeVisualizations:ge(new Set),nodeVisualizations:new Map,listenersAttached:!1,rafToken:null,activeWatchStop:void 0},snapshots:{showPanel:ge(!1),items:ge([]),selectedId:ge(null)}}},yt=e=>e.freehand.strokes,Fo=e=>e.freehand.strokeGroups,Pt=e=>e.polygon.shapes,Lo=e=>e.circle.shapes;let rs=null;const Hp=(e,t,n=2e3)=>{e.notification.message.value=t,e.notification.visible.value=!0,rs&&clearTimeout(rs),rs=setTimeout(()=>{e.notification.visible.value=!1,rs=null},n)};function Fd(e,t){const n=new Set(t);return e.filter(i=>!n.has(i))}function jp(e,t){const n=new Set(t);return e.filter(i=>n.has(i))}function Wp(e,t){const n={};for(const i of e)n[String(t(i))]=i;return n}function Kp(e,t,n={}){let{embeddedObjKeys:i}=n;const{keysToSkip:s,treatTypeChangeAsReplace:o}=n;return i instanceof Map?i=new Map(Array.from(i.entries()).map(([r,a])=>[r instanceof RegExp?r:r.replace(/^\./,""),a])):i&&(i=Object.fromEntries(Object.entries(i).map(([r,a])=>[r.replace(/^\./,""),a]))),Ld(e,t,[],[],{embeddedObjKeys:i,keysToSkip:s??[],treatTypeChangeAsReplace:o??!0})}var Io=e=>typeof e>"u"?"undefined":e===null?null:Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1],Ot=e=>{const t=e[e.length-1];return t??"$root"},Ld=(e,t,n,i,s)=>{let o=[];const r=i.join(".");if(s.keysToSkip?.some(c=>{if(r===c)return!0;if(c.includes(".")&&c.startsWith(r+"."))return!1;if(c.includes(".")){const d=c.split("."),f=r.split(".");if(f.length>=d.length){for(let p=0;p<d.length;p++)if(d[p]!==f[p])return!1;return!0}}return!1}))return o;const a=Io(e),l=Io(t);if(s.treatTypeChangeAsReplace&&a!==l)return a!=="undefined"&&o.push({type:"REMOVE",key:Ot(n),value:e}),l!=="undefined"&&o.push({type:"ADD",key:Ot(n),value:t}),o;if(l==="undefined"&&a!=="undefined")return o.push({type:"REMOVE",key:Ot(n),value:e}),o;if(l==="Object"&&a==="Array")return o.push({type:"UPDATE",key:Ot(n),value:t,oldValue:e}),o;if(l===null)return a!==null&&o.push({type:"UPDATE",key:Ot(n),value:t,oldValue:e}),o;switch(a){case"Date":l==="Date"?o=o.concat(Go(e.getTime(),t.getTime(),n).map(c=>({...c,value:new Date(c.value),oldValue:new Date(c.oldValue)}))):o=o.concat(Go(e,t,n));break;case"Object":{const c=Id(e,t,n,i,!1,s);c.length&&(n.length?o.push({type:"UPDATE",key:Ot(n),changes:c}):o=o.concat(c));break}case"Array":o=o.concat(qp(e,t,n,i,s));break;case"Function":break;default:o=o.concat(Go(e,t,n))}return o},Id=(e,t,n,i,s=!1,o={})=>{let r,a,l;s==null&&(s=!1);let c=[];const d=Object.keys(e),f=Object.keys(t),p=jp(d,f);for(r of p){l=n.concat([r]),a=s?i:i.concat([r]);const v=Ld(e[r],t[r],l,a,o);v.length&&(c=c.concat(v))}const h=Fd(f,d);for(r of h){l=n.concat([r]),a=s?i:i.concat([r]);const v=a.join(".");o.keysToSkip?.some(b=>v===b||v.startsWith(b+"."))||c.push({type:"ADD",key:Ot(l),value:t[r]})}const g=Fd(d,f);for(r of g){l=n.concat([r]),a=s?i:i.concat([r]);const v=a.join(".");o.keysToSkip?.some(b=>v===b||v.startsWith(b+"."))||c.push({type:"REMOVE",key:Ot(l),value:e[r]})}return c},qp=(e,t,n,i,s)=>{if(Io(t)!=="Array")return[{type:"UPDATE",key:Ot(n),value:t,oldValue:e}];const o=Yp(s.embeddedObjKeys,i),r=o??"$index",a=Gd(e,r),l=Gd(t,r),c=Id(a,l,n,i,!0,s);return c.length?[{type:"UPDATE",key:Ot(n),embeddedKey:typeof r=="function"&&r.length===2?r(t[0],!0):r,changes:c}]:[]},Yp=(e,t)=>{if(e!=null){const n=t.join(".");if(e instanceof Map){for(const[s,o]of e.entries())if(s instanceof RegExp){if(n.match(s))return o}else if(n===s)return o}const i=e[n];if(i!=null)return i}},Gd=(e,t)=>{let n={};if(t==="$value")e.forEach(i=>{n[i]=i});else if(t!=="$index")n=Wp(e,typeof t=="string"?s=>s[t]:t);else for(let i=0;i<e.length;i++){const s=e[i];n[i]=s}return n},Go=(e,t,n)=>{const i=[];return e!==t&&i.push({type:"UPDATE",key:Ot(n),value:t,oldValue:e}),i};const rn=(e,t,n)=>{if(!e.command.executeCommand){console.warn("executeCommand called before setup - falling back to direct execution"),n();return}e.command.executeCommand(t,n)},ss=(e,t,n,i)=>{if(!e.command.pushCommand){console.warn("pushCommandWithStates called before setup - ignoring");return}e.command.pushCommand(t,n,i)};function Xp(e,t,n=!1){n||zo(e),e.selection.items.add(t),$o(e),as(e)}function Zp(e,t,n=!1){e.selection.items.has(t)?e.selection.items.delete(t):(n||zo(e),e.selection.items.add(t)),$o(e),as(e)}function zo(e){Uo(e),e.selection.items.clear(),as(e)}function Jp(e,t){return e.selection.items.has(t)}function Qp(e){return e.selection.items.size===0}function eg(e){return e.selection.items.size}function tg(e){return e.selection.items.size===1?[...e.selection.items][0].konvaNode:null}function Uo(e){e.selection.originalStyles.forEach(t=>{const n=t.node;n&&(n instanceof X.Path||n instanceof X.Line)&&(n.stroke(t.stroke),n.strokeWidth(t.strokeWidth))}),e.selection.originalStyles.clear(),Vo(e)}function $o(e){Uo(e);for(const t of e.selection.items){const n=t.konvaNode;(n instanceof X.Path||n instanceof X.Line)&&(e.selection.originalStyles.set(t.id,{node:n,stroke:n.stroke(),strokeWidth:n.strokeWidth()}),n.stroke("#ff6b35"),n.strokeWidth(4))}Vo(e)}function Vo(e){const t=new Set;for(const n of e.selection.items){let i=n.konvaNode.getParent();for(;i&&!(i instanceof X.Layer);)i=i.getParent();i instanceof X.Layer&&t.add(i)}e.selection.originalStyles.forEach(n=>{let i=n.node.getParent();for(;i&&!(i instanceof X.Layer);)i=i.getParent();i instanceof X.Layer&&t.add(i)}),t.forEach(n=>n.batchDraw())}const os=(e,t)=>{const n=e.selection.originalStyles.size>0;n&&Uo(e);try{return t()}finally{e.selection.items.size>0?$o(e):n&&Vo(e)}};function as(e){e.callbacks.syncAppState?.(e),e.callbacks.refreshAncillaryViz?.()}function ng(e,t,n){rn(e,"Edit Metadata",()=>{t.setMetadata(n),as(e)})}function ls(e,t,n=!1){Xp(e,t,n)}function ig(e,t,n=!1){Zp(e,t,n)}function vt(e){zo(e)}function zd(e,t){return Jp(e,t)}function Ud(e){return Qp(e)}function cs(e){return eg(e)}const rg=e=>tg(e);function sg(e,t,n){ng(e,t,n)}const sn=(e="id_")=>`${e}${crypto.randomUUID()}`,ds=e=>{let t=1/0,n=-1/0,i=1/0,s=-1/0;for(let o=0;o<e.length;o+=2)t=Math.min(t,e[o]),n=Math.max(n,e[o]),i=Math.min(i,e[o+1]),s=Math.max(s,e[o+1]);return{minX:t,maxX:n,minY:i,maxY:s}},og=e=>{for(let t=0;t<e.length;t++)for(let n=t+1;n<e.length;n++)if(e[t].isAncestorOf(e[n])||e[n].isAncestorOf(e[t]))return!0;return!1},us=(e,t)=>{if(e.metadataSchemas.length>0&&!t.getAttr("metadata")){const n=Object.fromEntries(e.metadataSchemas.map(i=>[i.name,i.schema.parse({})]));t.setAttr("metadata",n)}},$d=(e,t,n)=>{t.id()||t.id(sn("stroke_")),us(e,t);const i={id:t.id(),type:"stroke",konvaNode:t,getBounds(){const s=t.getClientRect();return{minX:s.x,maxX:s.x+s.width,minY:s.y,maxY:s.y+s.height}},getMetadata(){return t.getAttr("metadata")},setMetadata(s){s===void 0||Object.keys(s).length===0?t.setAttr("metadata",void 0):t.setAttr("metadata",s)}};return e.canvasItems.set(i.id,i),i},hs=(e,t)=>{t.id()||t.id(sn("group_")),us(e,t);const n={id:t.id(),type:"strokeGroup",konvaNode:t,getBounds(){const i=t.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return t.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?t.setAttr("metadata",void 0):t.setAttr("metadata",i)}};return e.canvasItems.set(n.id,n),n},Bo=(e,t)=>{t.id()||t.id(sn("poly_")),us(e,t);const n={id:t.id(),type:"polygon",konvaNode:t,getBounds(){const i=t.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return t.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?t.setAttr("metadata",void 0):t.setAttr("metadata",i)}};return e.canvasItems.set(n.id,n),n},Ho=(e,t)=>{t.id()||t.id(sn("circle_")),us(e,t);const n={id:t.id(),type:"circle",konvaNode:t,getBounds(){const i=t.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return t.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?t.setAttr("metadata",void 0):t.setAttr("metadata",i)}};return e.canvasItems.set(n.id,n),n},ag=(e,t)=>e.canvasItems.get(t.id()),lg=(e,t)=>{e.canvasItems.delete(t)},ar=(e,t)=>ag(e,t),Vd=(e,t)=>{lg(e,t)};function cg(e,t,n,i=document.body){const s=r=>{r.key===t&&n(r)};i.addEventListener("keydown",s);const o=()=>{i.removeEventListener("keydown",s);const r=e.keyboardDisposables.indexOf(o);r!==-1&&e.keyboardDisposables.splice(r,1)};return e.keyboardDisposables.push(o),o}const dg=()=>({canceled:!1}),Bd=e=>{e.token.canceled||(e.token.canceled=!0,e.frameId!==null&&(cancelAnimationFrame(e.frameId),e.frameId=null))},ug=e=>{const t={frameId:null,token:dg()},n=i=>{if(t.token.canceled)return;t.frameId=null;const s=e(i,t.token);if(t.token.canceled||s===!1){Bd(t);return}t.frameId=requestAnimationFrame(n)};return t.frameId=requestAnimationFrame(n),{token:t.token,cancel:()=>Bd(t)}},hg={class:"timeline-container"},fg={class:"timeline-controls"},pg=["disabled"],gg=["disabled"],mg={class:"time-display"},yg=Zt({__name:"Timeline",props:{strokes:{type:Map},selectedStrokes:{type:Set},useRealTiming:{type:Boolean},maxInterStrokeDelay:{type:Number},overrideDuration:{type:Number},lockWhileAnimating:{type:Function}},emits:["timeUpdate"],setup(e,{emit:t}){const n=e,i=t,s=ge(0),o=ge(0),r=ge(!1),a=ge(null);let l,c=0,d=null;const f=()=>{if(n.overrideDuration!==void 0)o.value=n.overrideDuration;else{let M=0;const x=[];if(n.selectedStrokes.size>0)n.selectedStrokes.forEach(w=>{const k=n.strokes.get(w);k&&x.push(k)}),x.sort((w,k)=>{const T=parseInt(w.id.split("-")[1]||"0"),R=parseInt(k.id.split("-")[1]||"0");return T-R}),x.forEach((w,k)=>{if(w.timestamps&&w.timestamps.length>0){const T=w.timestamps[w.timestamps.length-1]||0;M+=T,k<x.length-1&&(M+=100)}});else{const w=Array.from(n.strokes.values());w.sort((T,R)=>{const I=parseInt(T.id.split("-")[1]||"0"),$=parseInt(R.id.split("-")[1]||"0");return I-$});let k=0;w.forEach((T,R)=>{if(T.timestamps&&T.timestamps.length>0){const I=T.creationTime||parseInt(T.id.split("-")[1]||"0"),$=T.timestamps[T.timestamps.length-1]||0;if(R===0)M=$,k=I+$;else{let z=Math.max(0,I-k);!n.useRealTiming&&z>n.maxInterStrokeDelay&&(z=n.maxInterStrokeDelay),M+=z+$,k=I+$}}})}o.value=M}o.value>0&&s.value>o.value&&(s.value=0,i("timeUpdate",0))};He([()=>n.strokes,()=>n.selectedStrokes,()=>n.useRealTiming,()=>n.maxInterStrokeDelay,()=>n.overrideDuration],()=>{f()},{immediate:!0,deep:!0});const p=xe(()=>o.value===0?0:s.value/o.value*100),h=M=>{const x=Math.floor(M/1e3),w=Math.floor(M%1e3/10);return`${x}.${w.toString().padStart(2,"0")}s`},g=()=>{r.value||o.value===0||(r.value=!0,n.lockWhileAnimating?.(!0),c=performance.now()-s.value,l=ug(()=>r.value?(s.value=performance.now()-c,s.value>=o.value?(s.value=0,r.value=!1,n.lockWhileAnimating?.(!1),i("timeUpdate",0),l=void 0,!1):(i("timeUpdate",s.value),!0)):(l=void 0,!1)))},v=()=>{r.value=!1;const M=s.value===0;n.lockWhileAnimating?.(!M),l?.cancel(),l=void 0},b=()=>{r.value=!1,C.value=!1,n.lockWhileAnimating?.(!1),s.value=0,l?.cancel(),l=void 0,i("timeUpdate",0)},C=ge(!1),m=M=>{if(!d)return;const x=Math.max(0,Math.min(M.clientX-d.left,d.width)),w=d.width>0?x/d.width:0;s.value=w*o.value,i("timeUpdate",s.value)},u=M=>{C.value&&m(M)},y=()=>{if(!C.value)return;C.value=!1;const M=s.value===0;n.lockWhileAnimating?.(!M),d=null,window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",y)},S=M=>{M.preventDefault();const x=a.value;x&&(C.value=!0,n.lockWhileAnimating?.(!0),d=x.getBoundingClientRect(),window.addEventListener("mousemove",u),window.addEventListener("mouseup",y),m(M))},A=M=>{if(!C.value){const w=M.currentTarget.getBoundingClientRect(),T=Math.max(0,Math.min(M.clientX-w.left,w.width))/w.width;s.value=T*o.value;const R=s.value===0;n.lockWhileAnimating?.(!R),r.value&&(c=performance.now()-s.value),i("timeUpdate",s.value)}};return ui(()=>{l?.cancel(),l=void 0,C.value&&(C.value=!1,n.lockWhileAnimating?.(!1)),d=null,window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",y)}),(M,x)=>(ae(),ce("div",hg,[J("div",fg,[J("button",{onClick:g,disabled:r.value},"",8,pg),J("button",{onClick:v,disabled:!r.value},"",8,gg),J("button",{onClick:b},""),J("span",mg,Fe(h(s.value))+" / "+Fe(h(o.value)),1)]),J("div",{ref_key:"timelineTrackRef",ref:a,class:"timeline-track",onClick:A,onMousedown:S},[J("div",{class:"timeline-progress",style:_n({width:p.value+"%"})},null,4),J("div",{class:"timeline-playhead",style:_n({left:p.value+"%"}),onMousedown:So(S,["stop"])},null,36)],544)]))}}),vg=".timeline-container[data-v-bbee97de]{width:600px;background:#fff;border:1px solid #ccc;border-radius:8px;padding:15px;box-shadow:0 2px 10px #0000001a;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.timeline-controls[data-v-bbee97de]{display:flex;align-items:center;gap:10px;margin-bottom:10px}.timeline-controls button[data-v-bbee97de]{background:none;border:1px solid #ccc;border-radius:4px;padding:5px 10px;cursor:pointer;font-size:16px}.timeline-controls button[data-v-bbee97de]:hover:not(:disabled){background:#f0f0f0}.timeline-controls button[data-v-bbee97de]:disabled{opacity:.5;cursor:not-allowed}.time-display[data-v-bbee97de]{margin-left:auto;font-family:monospace;font-size:14px;color:#666}.timeline-track[data-v-bbee97de]{position:relative;height:40px;background:#f0f0f0;border-radius:4px;cursor:pointer}.timeline-progress[data-v-bbee97de]{position:absolute;top:0;left:0;height:100%;background:#06f;border-radius:4px}.timeline-playhead[data-v-bbee97de]{position:absolute;top:-5px;width:10px;height:50px;background:#06f;border-radius:2px;transform:translate(-50%);cursor:grab;z-index:10}.timeline-playhead[data-v-bbee97de]:hover{background:#0052cc}.timeline-playhead[data-v-bbee97de]:active{cursor:grabbing}",mn=(e,t)=>{const n=e.__vccOpts||e;for(const[i,s]of t)n[i]=s;return n},_g=mn(yg,[["styles",[vg]],["__scopeId","data-v-bbee97de"]]);function Se(e,t,n){function i(a,l){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:l,constr:r,traits:new Set},enumerable:!1}),a._zod.traits.has(e))return;a._zod.traits.add(e),t(a,l);const c=r.prototype,d=Object.keys(c);for(let f=0;f<d.length;f++){const p=d[f];p in a||(a[p]=c[p].bind(a))}}const s=n?.Parent??Object;class o extends s{}Object.defineProperty(o,"name",{value:e});function r(a){var l;const c=n?.Parent?new o:this;i(c,a),(l=c._zod).deferred??(l.deferred=[]);for(const d of c._zod.deferred)d();return c}return Object.defineProperty(r,"init",{value:i}),Object.defineProperty(r,Symbol.hasInstance,{value:a=>n?.Parent&&a instanceof n.Parent?!0:a?._zod?.traits?.has(e)}),Object.defineProperty(r,"name",{value:e}),r}class qn extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Hd extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const jd={};function Rn(e){return jd}function bg(e){const t=Object.values(e).filter(i=>typeof i=="number");return Object.entries(e).filter(([i,s])=>t.indexOf(+i)===-1).map(([i,s])=>s)}function jo(e,t){return typeof t=="bigint"?t.toString():t}function Wo(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function Ko(e){return e==null}function qo(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}const Wd=Symbol("evaluating");function Ve(e,t,n){let i;Object.defineProperty(e,t,{get(){if(i!==Wd)return i===void 0&&(i=Wd,i=n()),i},set(s){Object.defineProperty(e,t,{value:s})},configurable:!0})}function Mn(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function Dn(...e){const t={};for(const n of e){const i=Object.getOwnPropertyDescriptors(n);Object.assign(t,i)}return Object.defineProperties({},t)}function Kd(e){return JSON.stringify(e)}const qd="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function fs(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const Sg=Wo(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function lr(e){if(fs(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const n=t.prototype;return!(fs(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function Yd(e){return lr(e)?{...e}:Array.isArray(e)?[...e]:e}const wg=new Set(["string","number","symbol"]);function xg(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function yn(e,t,n){const i=new e._zod.constr(t??e._zod.def);return(!t||n?.parent)&&(i._zod.parent=e),i}function Tt(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Cg(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}function kg(e,t){const n=e._zod.def,i=Dn(e._zod.def,{get shape(){const s={};for(const o in t){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&(s[o]=n.shape[o])}return Mn(this,"shape",s),s},checks:[]});return yn(e,i)}function Pg(e,t){const n=e._zod.def,i=Dn(e._zod.def,{get shape(){const s={...e._zod.def.shape};for(const o in t){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&delete s[o]}return Mn(this,"shape",s),s},checks:[]});return yn(e,i)}function Tg(e,t){if(!lr(t))throw new Error("Invalid input to extend: expected a plain object");const n=e._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const s=Dn(e._zod.def,{get shape(){const o={...e._zod.def.shape,...t};return Mn(this,"shape",o),o},checks:[]});return yn(e,s)}function Eg(e,t){if(!lr(t))throw new Error("Invalid input to safeExtend: expected a plain object");const n={...e._zod.def,get shape(){const i={...e._zod.def.shape,...t};return Mn(this,"shape",i),i},checks:e._zod.def.checks};return yn(e,n)}function Ag(e,t){const n=Dn(e._zod.def,{get shape(){const i={...e._zod.def.shape,...t._zod.def.shape};return Mn(this,"shape",i),i},get catchall(){return t._zod.def.catchall},checks:[]});return yn(e,n)}function Rg(e,t,n){const i=Dn(t._zod.def,{get shape(){const s=t._zod.def.shape,o={...s};if(n)for(const r in n){if(!(r in s))throw new Error(`Unrecognized key: "${r}"`);n[r]&&(o[r]=e?new e({type:"optional",innerType:s[r]}):s[r])}else for(const r in s)o[r]=e?new e({type:"optional",innerType:s[r]}):s[r];return Mn(this,"shape",o),o},checks:[]});return yn(t,i)}function Mg(e,t,n){const i=Dn(t._zod.def,{get shape(){const s=t._zod.def.shape,o={...s};if(n)for(const r in n){if(!(r in o))throw new Error(`Unrecognized key: "${r}"`);n[r]&&(o[r]=new e({type:"nonoptional",innerType:s[r]}))}else for(const r in s)o[r]=new e({type:"nonoptional",innerType:s[r]});return Mn(this,"shape",o),o},checks:[]});return yn(t,i)}function Yn(e,t=0){if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(e.issues[n]?.continue!==!0)return!0;return!1}function Xd(e,t){return t.map(n=>{var i;return(i=n).path??(i.path=[]),n.path.unshift(e),n})}function ps(e){return typeof e=="string"?e:e?.message}function On(e,t,n){const i={...e,path:e.path??[]};if(!e.message){const s=ps(e.inst?._zod.def?.error?.(e))??ps(t?.error?.(e))??ps(n.customError?.(e))??ps(n.localeError?.(e))??"Invalid input";i.message=s}return delete i.inst,delete i.continue,t?.reportInput||delete i.input,i}function Yo(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function cr(...e){const[t,n,i]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:i}:{...t}}const Zd=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,jo,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Jd=Se("$ZodError",Zd),Qd=Se("$ZodError",Zd,{Parent:Error});function Dg(e,t=n=>n.message){const n={},i=[];for(const s of e.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):i.push(t(s));return{formErrors:i,fieldErrors:n}}function Og(e,t=n=>n.message){const n={_errors:[]},i=s=>{for(const o of s.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(r=>i({issues:r}));else if(o.code==="invalid_key")i({issues:o.issues});else if(o.code==="invalid_element")i({issues:o.issues});else if(o.path.length===0)n._errors.push(t(o));else{let r=n,a=0;for(;a<o.path.length;){const l=o.path[a];a===o.path.length-1?(r[l]=r[l]||{_errors:[]},r[l]._errors.push(t(o))):r[l]=r[l]||{_errors:[]},r=r[l],a++}}};return i(e),n}const Xo=e=>(t,n,i,s)=>{const o=i?Object.assign(i,{async:!1}):{async:!1},r=t._zod.run({value:n,issues:[]},o);if(r instanceof Promise)throw new qn;if(r.issues.length){const a=new(s?.Err??e)(r.issues.map(l=>On(l,o,Rn())));throw qd(a,s?.callee),a}return r.value},Zo=e=>async(t,n,i,s)=>{const o=i?Object.assign(i,{async:!0}):{async:!0};let r=t._zod.run({value:n,issues:[]},o);if(r instanceof Promise&&(r=await r),r.issues.length){const a=new(s?.Err??e)(r.issues.map(l=>On(l,o,Rn())));throw qd(a,s?.callee),a}return r.value},gs=e=>(t,n,i)=>{const s=i?{...i,async:!1}:{async:!1},o=t._zod.run({value:n,issues:[]},s);if(o instanceof Promise)throw new qn;return o.issues.length?{success:!1,error:new(e??Jd)(o.issues.map(r=>On(r,s,Rn())))}:{success:!0,data:o.value}},Ng=gs(Qd),ms=e=>async(t,n,i)=>{const s=i?Object.assign(i,{async:!0}):{async:!0};let o=t._zod.run({value:n,issues:[]},s);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(r=>On(r,s,Rn())))}:{success:!0,data:o.value}},Fg=ms(Qd),Lg=e=>(t,n,i)=>{const s=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Xo(e)(t,n,s)},Ig=e=>(t,n,i)=>Xo(e)(t,n,i),Gg=e=>async(t,n,i)=>{const s=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Zo(e)(t,n,s)},zg=e=>async(t,n,i)=>Zo(e)(t,n,i),Ug=e=>(t,n,i)=>{const s=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return gs(e)(t,n,s)},$g=e=>(t,n,i)=>gs(e)(t,n,i),Vg=e=>async(t,n,i)=>{const s=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return ms(e)(t,n,s)},Bg=e=>async(t,n,i)=>ms(e)(t,n,i),Xn=Se("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),Hg=Se("$ZodCheckMaxLength",(e,t)=>{var n;Xn.init(e,t),(n=e._zod.def).when??(n.when=i=>{const s=i.value;return!Ko(s)&&s.length!==void 0}),e._zod.onattach.push(i=>{const s=i._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<s&&(i._zod.bag.maximum=t.maximum)}),e._zod.check=i=>{const s=i.value;if(s.length<=t.maximum)return;const r=Yo(s);i.issues.push({origin:r,code:"too_big",maximum:t.maximum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),jg=Se("$ZodCheckMinLength",(e,t)=>{var n;Xn.init(e,t),(n=e._zod.def).when??(n.when=i=>{const s=i.value;return!Ko(s)&&s.length!==void 0}),e._zod.onattach.push(i=>{const s=i._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>s&&(i._zod.bag.minimum=t.minimum)}),e._zod.check=i=>{const s=i.value;if(s.length>=t.minimum)return;const r=Yo(s);i.issues.push({origin:r,code:"too_small",minimum:t.minimum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),Wg=Se("$ZodCheckLengthEquals",(e,t)=>{var n;Xn.init(e,t),(n=e._zod.def).when??(n.when=i=>{const s=i.value;return!Ko(s)&&s.length!==void 0}),e._zod.onattach.push(i=>{const s=i._zod.bag;s.minimum=t.length,s.maximum=t.length,s.length=t.length}),e._zod.check=i=>{const s=i.value,o=s.length;if(o===t.length)return;const r=Yo(s),a=o>t.length;i.issues.push({origin:r,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:i.value,inst:e,continue:!t.abort})}}),Kg=Se("$ZodCheckOverwrite",(e,t)=>{Xn.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class qg{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const i=t.split(`
`).filter(r=>r),s=Math.min(...i.map(r=>r.length-r.trimStart().length)),o=i.map(r=>r.slice(s)).map(r=>" ".repeat(this.indent*2)+r);for(const r of o)this.content.push(r)}compile(){const t=Function,n=this?.args,s=[...(this?.content??[""]).map(o=>`  ${o}`)];return new t(...n,s.join(`
`))}}const Yg={major:4,minor:1,patch:13},nt=Se("$ZodType",(e,t)=>{var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Yg;const i=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&i.unshift(e);for(const s of i)for(const o of s._zod.onattach)o(e);if(i.length===0)(n=e._zod).deferred??(n.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const s=(r,a,l)=>{let c=Yn(r),d;for(const f of a){if(f._zod.def.when){if(!f._zod.def.when(r))continue}else if(c)continue;const p=r.issues.length,h=f._zod.check(r);if(h instanceof Promise&&l?.async===!1)throw new qn;if(d||h instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await h,r.issues.length!==p&&(c||(c=Yn(r,p)))});else{if(r.issues.length===p)continue;c||(c=Yn(r,p))}}return d?d.then(()=>r):r},o=(r,a,l)=>{if(Yn(r))return r.aborted=!0,r;const c=s(a,i,l);if(c instanceof Promise){if(l.async===!1)throw new qn;return c.then(d=>e._zod.parse(d,l))}return e._zod.parse(c,l)};e._zod.run=(r,a)=>{if(a.skipChecks)return e._zod.parse(r,a);if(a.direction==="backward"){const c=e._zod.parse({value:r.value,issues:[]},{...a,skipChecks:!0});return c instanceof Promise?c.then(d=>o(d,r,a)):o(c,r,a)}const l=e._zod.parse(r,a);if(l instanceof Promise){if(a.async===!1)throw new qn;return l.then(c=>s(c,i,a))}return s(l,i,a)}}e["~standard"]={validate:s=>{try{const o=Ng(e,s);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return Fg(e,s).then(r=>r.success?{value:r.data}:{issues:r.error?.issues})}},vendor:"zod",version:1}}),Xg=Se("$ZodUnknown",(e,t)=>{nt.init(e,t),e._zod.parse=n=>n}),Zg=Se("$ZodNever",(e,t)=>{nt.init(e,t),e._zod.parse=(n,i)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)});function eu(e,t,n){e.issues.length&&t.issues.push(...Xd(n,e.issues)),t.value[n]=e.value}const Jg=Se("$ZodArray",(e,t)=>{nt.init(e,t),e._zod.parse=(n,i)=>{const s=n.value;if(!Array.isArray(s))return n.issues.push({expected:"array",code:"invalid_type",input:s,inst:e}),n;n.value=Array(s.length);const o=[];for(let r=0;r<s.length;r++){const a=s[r],l=t.element._zod.run({value:a,issues:[]},i);l instanceof Promise?o.push(l.then(c=>eu(c,n,r))):eu(l,n,r)}return o.length?Promise.all(o).then(()=>n):n}});function ys(e,t,n,i){e.issues.length&&t.issues.push(...Xd(n,e.issues)),e.value===void 0?n in i&&(t.value[n]=void 0):t.value[n]=e.value}function tu(e){const t=Object.keys(e.shape);for(const i of t)if(!e.shape?.[i]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${i}": expected a Zod schema`);const n=Cg(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(n)}}function nu(e,t,n,i,s,o){const r=[],a=s.keySet,l=s.catchall._zod,c=l.def.type;for(const d in t){if(a.has(d))continue;if(c==="never"){r.push(d);continue}const f=l.run({value:t[d],issues:[]},i);f instanceof Promise?e.push(f.then(p=>ys(p,n,d,t))):ys(f,n,d,t)}return r.length&&n.issues.push({code:"unrecognized_keys",keys:r,input:t,inst:o}),e.length?Promise.all(e).then(()=>n):n}const Qg=Se("$ZodObject",(e,t)=>{if(nt.init(e,t),!Object.getOwnPropertyDescriptor(t,"shape")?.get){const a=t.shape;Object.defineProperty(t,"shape",{get:()=>{const l={...a};return Object.defineProperty(t,"shape",{value:l}),l}})}const i=Wo(()=>tu(t));Ve(e._zod,"propValues",()=>{const a=t.shape,l={};for(const c in a){const d=a[c]._zod;if(d.values){l[c]??(l[c]=new Set);for(const f of d.values)l[c].add(f)}}return l});const s=fs,o=t.catchall;let r;e._zod.parse=(a,l)=>{r??(r=i.value);const c=a.value;if(!s(c))return a.issues.push({expected:"object",code:"invalid_type",input:c,inst:e}),a;a.value={};const d=[],f=r.shape;for(const p of r.keys){const g=f[p]._zod.run({value:c[p],issues:[]},l);g instanceof Promise?d.push(g.then(v=>ys(v,a,p,c))):ys(g,a,p,c)}return o?nu(d,c,a,l,i.value,e):d.length?Promise.all(d).then(()=>a):a}}),e1=Se("$ZodObjectJIT",(e,t)=>{Qg.init(e,t);const n=e._zod.parse,i=Wo(()=>tu(t)),s=p=>{const h=new qg(["shape","payload","ctx"]),g=i.value,v=u=>{const y=Kd(u);return`shape[${y}]._zod.run({ value: input[${y}], issues: [] }, ctx)`};h.write("const input = payload.value;");const b=Object.create(null);let C=0;for(const u of g.keys)b[u]=`key_${C++}`;h.write("const newResult = {};");for(const u of g.keys){const y=b[u],S=Kd(u);h.write(`const ${y} = ${v(u)};`),h.write(`
        if (${y}.issues.length) {
          payload.issues = payload.issues.concat(${y}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${S}, ...iss.path] : [${S}]
          })));
        }
        
        
        if (${y}.value === undefined) {
          if (${S} in input) {
            newResult[${S}] = undefined;
          }
        } else {
          newResult[${S}] = ${y}.value;
        }
        
      `)}h.write("payload.value = newResult;"),h.write("return payload;");const m=h.compile();return(u,y)=>m(p,u,y)};let o;const r=fs,a=!jd.jitless,c=a&&Sg.value,d=t.catchall;let f;e._zod.parse=(p,h)=>{f??(f=i.value);const g=p.value;return r(g)?a&&c&&h?.async===!1&&h.jitless!==!0?(o||(o=s(t.shape)),p=o(p,h),d?nu([],g,p,h,f,e):p):n(p,h):(p.issues.push({expected:"object",code:"invalid_type",input:g,inst:e}),p)}});function iu(e,t,n,i){for(const o of e)if(o.issues.length===0)return t.value=o.value,t;const s=e.filter(o=>!Yn(o));return s.length===1?(t.value=s[0].value,s[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(o=>o.issues.map(r=>On(r,i,Rn())))}),t)}const t1=Se("$ZodUnion",(e,t)=>{nt.init(e,t),Ve(e._zod,"optin",()=>t.options.some(s=>s._zod.optin==="optional")?"optional":void 0),Ve(e._zod,"optout",()=>t.options.some(s=>s._zod.optout==="optional")?"optional":void 0),Ve(e._zod,"values",()=>{if(t.options.every(s=>s._zod.values))return new Set(t.options.flatMap(s=>Array.from(s._zod.values)))}),Ve(e._zod,"pattern",()=>{if(t.options.every(s=>s._zod.pattern)){const s=t.options.map(o=>o._zod.pattern);return new RegExp(`^(${s.map(o=>qo(o.source)).join("|")})$`)}});const n=t.options.length===1,i=t.options[0]._zod.run;e._zod.parse=(s,o)=>{if(n)return i(s,o);let r=!1;const a=[];for(const l of t.options){const c=l._zod.run({value:s.value,issues:[]},o);if(c instanceof Promise)a.push(c),r=!0;else{if(c.issues.length===0)return c;a.push(c)}}return r?Promise.all(a).then(l=>iu(l,s,e,o)):iu(a,s,e,o)}}),n1=Se("$ZodIntersection",(e,t)=>{nt.init(e,t),e._zod.parse=(n,i)=>{const s=n.value,o=t.left._zod.run({value:s,issues:[]},i),r=t.right._zod.run({value:s,issues:[]},i);return o instanceof Promise||r instanceof Promise?Promise.all([o,r]).then(([l,c])=>ru(n,l,c)):ru(n,o,r)}});function Jo(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(lr(e)&&lr(t)){const n=Object.keys(t),i=Object.keys(e).filter(o=>n.indexOf(o)!==-1),s={...e,...t};for(const o of i){const r=Jo(e[o],t[o]);if(!r.valid)return{valid:!1,mergeErrorPath:[o,...r.mergeErrorPath]};s[o]=r.data}return{valid:!0,data:s}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let i=0;i<e.length;i++){const s=e[i],o=t[i],r=Jo(s,o);if(!r.valid)return{valid:!1,mergeErrorPath:[i,...r.mergeErrorPath]};n.push(r.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function ru(e,t,n){if(t.issues.length&&e.issues.push(...t.issues),n.issues.length&&e.issues.push(...n.issues),Yn(e))return e;const i=Jo(t.value,n.value);if(!i.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(i.mergeErrorPath)}`);return e.value=i.data,e}const i1=Se("$ZodEnum",(e,t)=>{nt.init(e,t);const n=bg(t.entries),i=new Set(n);e._zod.values=i,e._zod.pattern=new RegExp(`^(${n.filter(s=>wg.has(typeof s)).map(s=>typeof s=="string"?xg(s):s.toString()).join("|")})$`),e._zod.parse=(s,o)=>{const r=s.value;return i.has(r)||s.issues.push({code:"invalid_value",values:n,input:r,inst:e}),s}}),r1=Se("$ZodTransform",(e,t)=>{nt.init(e,t),e._zod.parse=(n,i)=>{if(i.direction==="backward")throw new Hd(e.constructor.name);const s=t.transform(n.value,n);if(i.async)return(s instanceof Promise?s:Promise.resolve(s)).then(r=>(n.value=r,n));if(s instanceof Promise)throw new qn;return n.value=s,n}});function su(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const s1=Se("$ZodOptional",(e,t)=>{nt.init(e,t),e._zod.optin="optional",e._zod.optout="optional",Ve(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),Ve(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${qo(n.source)})?$`):void 0}),e._zod.parse=(n,i)=>{if(t.innerType._zod.optin==="optional"){const s=t.innerType._zod.run(n,i);return s instanceof Promise?s.then(o=>su(o,n.value)):su(s,n.value)}return n.value===void 0?n:t.innerType._zod.run(n,i)}}),o1=Se("$ZodNullable",(e,t)=>{nt.init(e,t),Ve(e._zod,"optin",()=>t.innerType._zod.optin),Ve(e._zod,"optout",()=>t.innerType._zod.optout),Ve(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${qo(n.source)}|null)$`):void 0}),Ve(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,i)=>n.value===null?n:t.innerType._zod.run(n,i)}),a1=Se("$ZodDefault",(e,t)=>{nt.init(e,t),e._zod.optin="optional",Ve(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,i)=>{if(i.direction==="backward")return t.innerType._zod.run(n,i);if(n.value===void 0)return n.value=t.defaultValue,n;const s=t.innerType._zod.run(n,i);return s instanceof Promise?s.then(o=>ou(o,t)):ou(s,t)}});function ou(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const l1=Se("$ZodPrefault",(e,t)=>{nt.init(e,t),e._zod.optin="optional",Ve(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,i)=>(i.direction==="backward"||n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,i))}),c1=Se("$ZodNonOptional",(e,t)=>{nt.init(e,t),Ve(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(i=>i!==void 0)):void 0}),e._zod.parse=(n,i)=>{const s=t.innerType._zod.run(n,i);return s instanceof Promise?s.then(o=>au(o,e)):au(s,e)}});function au(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const d1=Se("$ZodCatch",(e,t)=>{nt.init(e,t),Ve(e._zod,"optin",()=>t.innerType._zod.optin),Ve(e._zod,"optout",()=>t.innerType._zod.optout),Ve(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,i)=>{if(i.direction==="backward")return t.innerType._zod.run(n,i);const s=t.innerType._zod.run(n,i);return s instanceof Promise?s.then(o=>(n.value=o.value,o.issues.length&&(n.value=t.catchValue({...n,error:{issues:o.issues.map(r=>On(r,i,Rn()))},input:n.value}),n.issues=[]),n)):(n.value=s.value,s.issues.length&&(n.value=t.catchValue({...n,error:{issues:s.issues.map(o=>On(o,i,Rn()))},input:n.value}),n.issues=[]),n)}}),u1=Se("$ZodPipe",(e,t)=>{nt.init(e,t),Ve(e._zod,"values",()=>t.in._zod.values),Ve(e._zod,"optin",()=>t.in._zod.optin),Ve(e._zod,"optout",()=>t.out._zod.optout),Ve(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,i)=>{if(i.direction==="backward"){const o=t.out._zod.run(n,i);return o instanceof Promise?o.then(r=>vs(r,t.in,i)):vs(o,t.in,i)}const s=t.in._zod.run(n,i);return s instanceof Promise?s.then(o=>vs(o,t.out,i)):vs(s,t.out,i)}});function vs(e,t,n){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},n)}const h1=Se("$ZodReadonly",(e,t)=>{nt.init(e,t),Ve(e._zod,"propValues",()=>t.innerType._zod.propValues),Ve(e._zod,"values",()=>t.innerType._zod.values),Ve(e._zod,"optin",()=>t.innerType?._zod?.optin),Ve(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(n,i)=>{if(i.direction==="backward")return t.innerType._zod.run(n,i);const s=t.innerType._zod.run(n,i);return s instanceof Promise?s.then(lu):lu(s)}});function lu(e){return e.value=Object.freeze(e.value),e}const f1=Se("$ZodCustom",(e,t)=>{Xn.init(e,t),nt.init(e,t),e._zod.parse=(n,i)=>n,e._zod.check=n=>{const i=n.value,s=t.fn(i);if(s instanceof Promise)return s.then(o=>cu(o,n,i,e));cu(s,n,i,e)}});function cu(e,t,n,i){if(!e){const s={code:"custom",input:n,inst:i,path:[...i._zod.def.path??[]],continue:!i._zod.def.abort};i._zod.def.params&&(s.params=i._zod.def.params),t.issues.push(cr(s))}}var du;class p1{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...n){const i=n[0];if(this._map.set(t,i),i&&typeof i=="object"&&"id"in i){if(this._idmap.has(i.id))throw new Error(`ID ${i.id} already exists in the registry`);this._idmap.set(i.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const i={...this.get(n)??{}};delete i.id;const s={...i,...this._map.get(t)};return Object.keys(s).length?s:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function g1(){return new p1}(du=globalThis).__zod_globalRegistry??(du.__zod_globalRegistry=g1());const _s=globalThis.__zod_globalRegistry;function m1(e){return new e({type:"unknown"})}function y1(e,t){return new e({type:"never",...Tt(t)})}function v1(e,t){return new Hg({check:"max_length",...Tt(t),maximum:e})}function uu(e,t){return new jg({check:"min_length",...Tt(t),minimum:e})}function _1(e,t){return new Wg({check:"length_equals",...Tt(t),length:e})}function b1(e){return new Kg({check:"overwrite",tx:e})}function S1(e,t,n){return new e({type:"array",element:t,...Tt(n)})}function w1(e,t,n){return new e({type:"custom",check:"custom",fn:t,...Tt(n)})}function x1(e){const t=C1(n=>(n.addIssue=i=>{if(typeof i=="string")n.issues.push(cr(i,n.value,t._zod.def));else{const s=i;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=n.value),s.inst??(s.inst=t),s.continue??(s.continue=!t._zod.def.abort),n.issues.push(cr(s))}},e(n.value,n)));return t}function C1(e,t){const n=new Xn({check:"custom",...Tt(t)});return n._zod.check=e,n}const Et=Se("ZodError",(e,t)=>{Jd.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>Og(e,n)},flatten:{value:n=>Dg(e,n)},addIssue:{value:n=>{e.issues.push(n),e.message=JSON.stringify(e.issues,jo,2)}},addIssues:{value:n=>{e.issues.push(...n),e.message=JSON.stringify(e.issues,jo,2)}},isEmpty:{get(){return e.issues.length===0}}})},{Parent:Error}),k1=Xo(Et),P1=Zo(Et),T1=gs(Et),E1=ms(Et),A1=Lg(Et),R1=Ig(Et),M1=Gg(Et),D1=zg(Et),O1=Ug(Et),N1=$g(Et),F1=Vg(Et),L1=Bg(Et),ot=Se("ZodType",(e,t)=>(nt.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone(Dn(t,{checks:[...t.checks??[],...n.map(i=>typeof i=="function"?{_zod:{check:i,def:{check:"custom"},onattach:[]}}:i)]})),e.clone=(n,i)=>yn(e,n,i),e.brand=()=>e,e.register=(n,i)=>(n.add(e,i),e),e.parse=(n,i)=>k1(e,n,i,{callee:e.parse}),e.safeParse=(n,i)=>T1(e,n,i),e.parseAsync=async(n,i)=>P1(e,n,i,{callee:e.parseAsync}),e.safeParseAsync=async(n,i)=>E1(e,n,i),e.spa=e.safeParseAsync,e.encode=(n,i)=>A1(e,n,i),e.decode=(n,i)=>R1(e,n,i),e.encodeAsync=async(n,i)=>M1(e,n,i),e.decodeAsync=async(n,i)=>D1(e,n,i),e.safeEncode=(n,i)=>O1(e,n,i),e.safeDecode=(n,i)=>N1(e,n,i),e.safeEncodeAsync=async(n,i)=>F1(e,n,i),e.safeDecodeAsync=async(n,i)=>L1(e,n,i),e.refine=(n,i)=>e.check(a2(n,i)),e.superRefine=n=>e.check(l2(n)),e.overwrite=n=>e.check(b1(n)),e.optional=()=>pu(e),e.nullable=()=>gu(e),e.nullish=()=>pu(gu(e)),e.nonoptional=n=>e2(e,n),e.array=()=>$1(e),e.or=n=>B1([e,n]),e.and=n=>j1(e,n),e.transform=n=>yu(e,q1(n)),e.default=n=>Z1(e,n),e.prefault=n=>Q1(e,n),e.catch=n=>n2(e,n),e.pipe=n=>yu(e,n),e.readonly=()=>s2(e),e.describe=n=>{const i=e.clone();return _s.add(i,{description:n}),i},Object.defineProperty(e,"description",{get(){return _s.get(e)?.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return _s.get(e);const i=e.clone();return _s.add(i,n[0]),i},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),I1=Se("ZodUnknown",(e,t)=>{Xg.init(e,t),ot.init(e,t)});function hu(){return m1(I1)}const G1=Se("ZodNever",(e,t)=>{Zg.init(e,t),ot.init(e,t)});function z1(e){return y1(G1,e)}const U1=Se("ZodArray",(e,t)=>{Jg.init(e,t),ot.init(e,t),e.element=t.element,e.min=(n,i)=>e.check(uu(n,i)),e.nonempty=n=>e.check(uu(1,n)),e.max=(n,i)=>e.check(v1(n,i)),e.length=(n,i)=>e.check(_1(n,i)),e.unwrap=()=>e.element});function $1(e,t){return S1(U1,e,t)}const bs=Se("ZodObject",(e,t)=>{e1.init(e,t),ot.init(e,t),Ve(e,"shape",()=>t.shape),e.keyof=()=>W1(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:hu()}),e.loose=()=>e.clone({...e._zod.def,catchall:hu()}),e.strict=()=>e.clone({...e._zod.def,catchall:z1()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>Tg(e,n),e.safeExtend=n=>Eg(e,n),e.merge=n=>Ag(e,n),e.pick=n=>kg(e,n),e.omit=n=>Pg(e,n),e.partial=(...n)=>Rg(fu,e,n[0]),e.required=(...n)=>Mg(mu,e,n[0])}),V1=Se("ZodUnion",(e,t)=>{t1.init(e,t),ot.init(e,t),e.options=t.options});function B1(e,t){return new V1({type:"union",options:e,...Tt(t)})}const H1=Se("ZodIntersection",(e,t)=>{n1.init(e,t),ot.init(e,t)});function j1(e,t){return new H1({type:"intersection",left:e,right:t})}const Ss=Se("ZodEnum",(e,t)=>{i1.init(e,t),ot.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(i,s)=>{const o={};for(const r of i)if(n.has(r))o[r]=t.entries[r];else throw new Error(`Key ${r} not found in enum`);return new Ss({...t,checks:[],...Tt(s),entries:o})},e.exclude=(i,s)=>{const o={...t.entries};for(const r of i)if(n.has(r))delete o[r];else throw new Error(`Key ${r} not found in enum`);return new Ss({...t,checks:[],...Tt(s),entries:o})}});function W1(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(i=>[i,i])):e;return new Ss({type:"enum",entries:n,...Tt(t)})}const K1=Se("ZodTransform",(e,t)=>{r1.init(e,t),ot.init(e,t),e._zod.parse=(n,i)=>{if(i.direction==="backward")throw new Hd(e.constructor.name);n.addIssue=o=>{if(typeof o=="string")n.issues.push(cr(o,n.value,t));else{const r=o;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=e),n.issues.push(cr(r))}};const s=t.transform(n.value,n);return s instanceof Promise?s.then(o=>(n.value=o,n)):(n.value=s,n)}});function q1(e){return new K1({type:"transform",transform:e})}const fu=Se("ZodOptional",(e,t)=>{s1.init(e,t),ot.init(e,t),e.unwrap=()=>e._zod.def.innerType});function pu(e){return new fu({type:"optional",innerType:e})}const Y1=Se("ZodNullable",(e,t)=>{o1.init(e,t),ot.init(e,t),e.unwrap=()=>e._zod.def.innerType});function gu(e){return new Y1({type:"nullable",innerType:e})}const X1=Se("ZodDefault",(e,t)=>{a1.init(e,t),ot.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Z1(e,t){return new X1({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():Yd(t)}})}const J1=Se("ZodPrefault",(e,t)=>{l1.init(e,t),ot.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Q1(e,t){return new J1({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():Yd(t)}})}const mu=Se("ZodNonOptional",(e,t)=>{c1.init(e,t),ot.init(e,t),e.unwrap=()=>e._zod.def.innerType});function e2(e,t){return new mu({type:"nonoptional",innerType:e,...Tt(t)})}const t2=Se("ZodCatch",(e,t)=>{d1.init(e,t),ot.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function n2(e,t){return new t2({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const i2=Se("ZodPipe",(e,t)=>{u1.init(e,t),ot.init(e,t),e.in=t.in,e.out=t.out});function yu(e,t){return new i2({type:"pipe",in:e,out:t})}const r2=Se("ZodReadonly",(e,t)=>{h1.init(e,t),ot.init(e,t),e.unwrap=()=>e._zod.def.innerType});function s2(e){return new r2({type:"readonly",innerType:e})}const o2=Se("ZodCustom",(e,t)=>{f1.init(e,t),ot.init(e,t)});function a2(e,t={}){return w1(o2,e,t)}function l2(e){return x1(e)}function c2(e){return typeof e=="object"&&e!==null&&"_switchMeta"in e&&e._switchMeta!==null}function d2(e,t){const n=e.variants[t];return n?Object.keys(n):[]}function u2(e){return Object.keys(e.baseShape).filter(t=>t!==e.switchKey)}const h2={class:"zod-editor"},f2={key:0,class:"field-row"},p2=["value","disabled"],g2=["disabled"],m2={key:1,class:"field-row"},y2=["value","disabled"],v2=["disabled"],_2={key:2,class:"field-row"},b2=["value","disabled"],S2=["value"],w2=["disabled"],x2={key:3,class:"field-row boolean-row"},C2={class:"checkbox"},k2=["checked","disabled"],P2=["disabled"],T2={class:"object-grid"},E2={class:"field-label"},A2=["value","disabled","onInput"],R2=["value","disabled","onInput"],M2=["value","disabled","onChange"],D2=["value"],O2={class:"checkbox"},N2=["checked","disabled","onChange"],F2=["disabled","onClick"],L2=["disabled","onClick"],I2={class:"field-row"},G2=["disabled"],z2={key:5,class:"unsupported"},U2={key:6,class:"issues"},$2=mn(Zt({name:"ZodDataEditor",__name:"ZodDataEditor",props:{schema:{type:null},modelValue:{type:null},disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,i=t,s=xe(()=>N(n.schema)),o=xe(()=>G(s.value)),r=ge([]),a=ge(""),l=ge(""),c=ge(void 0),d=ge(void 0),f=ge({}),p=xe(()=>H(s.value)),h=ge(!1),g=xe(()=>c2(n.schema)?n.schema._switchMeta:null),v=xe(()=>g.value?f.value[g.value.switchKey]??"":""),b=xe(()=>!g.value||!v.value?new Set:new Set(d2(g.value,v.value))),C=xe(()=>g.value?new Set(u2(g.value)):new Set),m=F=>!g.value||F===g.value.switchKey||C.value.has(F)?!0:b.value.has(F);He(()=>n.modelValue,F=>{if(h.value){h.value=!1;return}u(F)},{immediate:!0,deep:!0,flush:"sync"}),He([o,s],()=>{u(n.modelValue)});function u(F){switch(r.value=[],o.value){case"string":a.value=typeof F=="string"?F:"";break;case"number":l.value=typeof F=="number"?`${F}`:typeof F=="string"?F:"";break;case"enum":c.value=typeof F=="string"?F:void 0;break;case"boolean":d.value=typeof F=="boolean"?F:void 0;break;case"object":f.value=_(F);break}}const y=xe(()=>O(n.schema)),S=xe(()=>r.value.length>0),A=xe(()=>{if(!(s.value instanceof bs))return[];const F=s.value.shape;return Object.entries(F).filter(([E,U])=>G(N(U))==="unsupported"?!1:m(E)).map(([E,U])=>({key:E,schema:U,kind:G(N(U)),isSwitchKey:g.value?.switchKey===E}))}),M=F=>{a.value=F;const E=y.value&&F.trim()==="";q(E?void 0:F)},x=F=>{l.value=F;const E=F.trim();if(!E){q(void 0);return}if(se(E)){r.value=[];return}const U=Number(E);q(Number.isFinite(U)?U:E)},w=F=>{c.value=F||void 0,q(F||void 0)},k=F=>{d.value=F,q(F)},T=()=>{d.value=void 0,q(void 0)},R=()=>{switch(o.value){case"string":a.value="",q(void 0);break;case"number":l.value="",q(void 0);break;case"enum":c.value=void 0,q(void 0);break;case"boolean":T();break;case"object":f.value=_(void 0),r.value=[],h.value=!0,i("update:modelValue",void 0);break}},I=(F,E)=>{f.value={...f.value,[F]:E},z()},$=(F,E)=>{f.value={...f.value,[F]:E};const U=E.trim();if(!U){z();return}if(se(U)){r.value=[];return}z()};function z(){if(!(s.value instanceof bs))return;const F=P();if(y.value&&Q(F)){r.value=[],h.value=!0,i("update:modelValue",void 0);return}const E=n.schema.safeParse(F);r.value=E.success?[]:E.error.issues.map(V),h.value=!0,i("update:modelValue",E.success?E.data:F)}function q(F){const E=n.schema.safeParse(F);r.value=E.success?[]:E.error.issues.map(V),h.value=!0,i("update:modelValue",E.success?E.data:F)}function _(F){if(!(s.value instanceof bs))return{};const E=s.value.shape,U={};return Object.entries(E).forEach(([j,ee])=>{const he=N(ee),D=G(he),L=F?.[j];D==="string"?U[j]=typeof L=="string"?L:"":D==="number"?U[j]=typeof L=="number"?`${L}`:typeof L=="string"?L:"":D==="enum"?U[j]=typeof L=="string"?L:"":D==="boolean"?U[j]=typeof L=="boolean"?L:void 0:D==="object"&&(U[j]=L)}),U}function P(){if(!(s.value instanceof bs))return{};const F=s.value.shape,E={};return Object.entries(F).forEach(([U,j])=>{if(!m(U))return;const ee=N(j),he=G(ee),D=f.value[U];if(he==="string"){if(D===""&&O(j))return;D!==void 0&&(E[U]=D)}else if(he==="number"){if(D===""||D===void 0||typeof D=="string"&&se(D.trim()))return;if(typeof D=="number"){E[U]=D;return}const L=Number(D);if(Number.isFinite(L)){E[U]=L;return}E[U]=D}else if(he==="enum"){if(D===""||D===void 0)return;E[U]=D}else if(he==="boolean")D!==void 0&&(E[U]=!!D);else if(he==="object"){if(Q(D)&&O(j))return;D!==void 0&&(E[U]=D)}}),E}function N(F){const E=F._def?.type;if(E==="optional"||E==="nullable"||E==="default"||E==="readonly"){const U=F._def?.innerType;return U?N(U):F}if(E==="pipe"){const U=F._def?.out??F._def?.innerType??F._def?.schema;return U?N(U):F}return F}function O(F){const E=F._def?.type;if(E==="optional"||E==="nullable")return!0;if(E==="default"||E==="readonly"){const U=F._def?.innerType;return U?O(U):!1}if(E==="pipe"){const U=F._def?.out??F._def?.innerType??F._def?.schema;return U?O(U):!1}return!1}function G(F){const E=F._def?.type;return E==="string"?"string":E==="number"?"number":E==="boolean"?"boolean":E==="enum"?"enum":E==="object"?"object":"unsupported"}function H(F){const E=N(F);if(!(E instanceof Ss))return[];const U=E._def?.values??E._def?.entries??[];return(Array.isArray(U)?U:Object.values(U)).filter(ee=>typeof ee=="string")}function V(F){const E=F.path.map(U=>U?.toString?.()??String(U)).join(".");return E?`${E}: ${F.message}`:F.message}function Q(F){return F!==null&&typeof F=="object"&&!Array.isArray(F)&&Object.keys(F).length===0}function se(F){return!!(F===""||F==="-"||F==="+"||F==="."||/^[-+]?\d*\.$/.test(F))}return(F,E)=>{const U=Cf("ZodDataEditor",!0);return ae(),ce("div",h2,[o.value==="string"?(ae(),ce("div",f2,[J("input",{class:"input",type:"text",value:a.value,disabled:F.disabled,onInput:E[0]||(E[0]=j=>M(j.target.value))},null,40,p2),J("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!y.value&&a.value==="",onClick:R}," Clear ",8,g2)])):o.value==="number"?(ae(),ce("div",m2,[J("input",{class:"input",type:"text",value:l.value,disabled:F.disabled,onInput:E[1]||(E[1]=j=>x(j.target.value))},null,40,y2),J("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!y.value&&l.value==="",onClick:R}," Clear ",8,v2)])):o.value==="enum"?(ae(),ce("div",_2,[J("select",{class:"input",value:c.value??"",disabled:F.disabled,onChange:E[2]||(E[2]=j=>w(j.target.value))},[E[4]||(E[4]=J("option",{value:""},"-- select --",-1)),(ae(!0),ce(Re,null,Qt(p.value,j=>(ae(),ce("option",{key:j,value:j},Fe(j),9,S2))),128))],40,b2),J("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!y.value,onClick:R}," Clear ",8,w2)])):o.value==="boolean"?(ae(),ce("div",x2,[J("label",C2,[J("input",{type:"checkbox",checked:!!d.value,disabled:F.disabled,onChange:E[3]||(E[3]=j=>k(j.target.checked))},null,40,k2),J("span",null,Fe(d.value===void 0?"Unset":d.value?"True":"False"),1)]),J("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!y.value,onClick:T}," Clear ",8,P2)])):o.value==="object"?(ae(),ce(Re,{key:4},[J("div",T2,[(ae(!0),ce(Re,null,Qt(A.value,j=>(ae(),ce("div",{key:j.key,class:"object-row"},[J("label",E2,Fe(j.key),1),j.kind==="string"?(ae(),ce("input",{key:0,class:"input",type:"text",value:f.value[j.key]??"",disabled:F.disabled,onInput:ee=>I(j.key,ee.target.value)},null,40,A2)):j.kind==="number"?(ae(),ce("input",{key:1,class:"input",type:"text",value:f.value[j.key]??"",disabled:F.disabled,onInput:ee=>$(j.key,ee.target.value)},null,40,R2)):j.kind==="enum"?(ae(),ce("select",{key:2,class:"input",value:f.value[j.key]??"",disabled:F.disabled,onChange:ee=>I(j.key,ee.target.value)},[E[5]||(E[5]=J("option",{value:""},"-- select --",-1)),(ae(!0),ce(Re,null,Qt(H(j.schema),ee=>(ae(),ce("option",{key:ee,value:ee},Fe(ee),9,D2))),128))],40,M2)):j.kind==="boolean"?(ae(),ce(Re,{key:3},[J("label",O2,[J("input",{type:"checkbox",checked:!!f.value[j.key],disabled:F.disabled,onChange:ee=>I(j.key,ee.target.checked)},null,40,N2),J("span",null,Fe(f.value[j.key]===void 0?"Unset":f.value[j.key]?"True":"False"),1)]),J("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!O(j.schema),onClick:ee=>I(j.key,void 0)}," Clear ",8,F2)],64)):j.kind==="object"?(ae(),ce(Re,{key:4},[Ke(U,{schema:j.schema,"model-value":f.value[j.key],disabled:F.disabled,"onUpdate:modelValue":ee=>I(j.key,ee)},null,8,["schema","model-value","disabled","onUpdate:modelValue"]),J("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!O(j.schema),onClick:ee=>I(j.key,void 0)}," Clear ",8,L2)],64)):Ne("",!0)]))),128))]),J("div",I2,[J("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!y.value&&!Object.keys(f.value).length,onClick:R}," Clear object ",8,G2)])],64)):(ae(),ce("p",z2,"Unsupported schema type for this editor.")),S.value?(ae(),ce("div",U2,[(ae(!0),ce(Re,null,Qt(r.value,j=>(ae(),ce("div",{key:j}," "+Fe(j),1))),128))])):Ne("",!0)])}}}),[["styles",[".zod-editor[data-v-b99ee620]{display:flex;flex-direction:column;gap:6px;font-size:13px}.field-row[data-v-b99ee620]{display:flex;align-items:center;gap:6px}.object-grid[data-v-b99ee620]{display:flex;flex-direction:column;gap:6px;border:1px solid #e5e5e5;padding:6px;border-radius:4px;background:#fafafa}.object-row[data-v-b99ee620]{display:grid;grid-template-columns:90px 1fr auto;align-items:center;gap:6px}.field-label[data-v-b99ee620]{font-weight:600;color:#444}.input[data-v-b99ee620]{flex:1;border:1px solid #ccc;border-radius:4px;padding:4px 6px;font-size:13px}.input[data-v-b99ee620]:disabled{background:#f5f5f5;color:#777}.tiny-btn[data-v-b99ee620]{padding:4px 6px;border:1px solid #bbb;border-radius:4px;background:#f7f7f7;font-size:12px;cursor:pointer}.tiny-btn[data-v-b99ee620]:disabled{opacity:.6;cursor:not-allowed}.issues[data-v-b99ee620]{color:#c0392b;font-size:12px;border-left:3px solid #c0392b;padding-left:8px}.boolean-row[data-v-b99ee620]{justify-content:space-between}.checkbox[data-v-b99ee620]{display:flex;align-items:center;gap:6px;font-weight:600;color:#333}.unsupported[data-v-b99ee620]{margin:0;color:#c0392b;font-weight:600}"]],["__scopeId","data-v-b99ee620"]]),V2={key:0,class:"metadata-editor"},B2={class:"header"},H2={class:"mode-switcher"},j2=["value","disabled"],W2=["value"],K2={class:"status"},q2={key:0,class:"unsaved-indicator"},Y2={key:1,class:"pill error"},X2={key:2,class:"pill warn"},Z2={key:0,class:"inline-error"},J2={key:1,class:"body"},Q2={key:0,class:"inline-error"},em={key:1,class:"inline-error"},tm={class:"schema-header"},nm={class:"schema-title"},im={key:0,class:"inline-error"},rm={key:2,class:"warning"},sm={key:3,class:"buttons"},om=["disabled"],am=["disabled"],vu=mn(Zt({__name:"MetadataEditor",props:{metadata:{type:null},visible:{type:Boolean},canEdit:{type:Boolean},schemaOptions:{default:()=>[],type:Array}},emits:["apply","cancel"],setup(e,{emit:t}){const n=e,i=t,s=ge(""),o=ge(""),r=ge(null),a=ge({}),l=ge({}),c=ge("raw"),d=ge(null),f=xe(()=>n.schemaOptions??[]),p=xe(()=>new Set(f.value.map(T=>T.name))),h=xe(()=>s.value!==o.value),g=xe(()=>Object.entries(a.value).filter(([,T])=>!!T)),v=xe(()=>g.value.length>0),b=xe(()=>f.value.find(T=>T.name===c.value)),C=xe(()=>b.value?.name??""),m=xe(()=>b.value?l.value?.[b.value.name]:void 0),u=xe(()=>!r.value),y=xe(()=>n.canEdit&&h.value&&!r.value&&!v.value);function S(T){const R=T.path.join(".");return R?`${R}: ${T.message}`:T.message}function A(T){const R={};f.value.forEach(({name:I,schema:$})=>{if(!Object.prototype.hasOwnProperty.call(T,I)){R[I]=null;return}const z=$.safeParse(T[I]);R[I]=z.success?null:z.error.issues.map(S).join("; ")}),a.value=R}He([()=>n.metadata,()=>n.canEdit],([T,R])=>{if(R){const I=JSON.stringify(T??{},null,2);s.value=I,o.value=I,r.value=null,l.value=T??{},A(l.value),d.value=null,p.value.has(c.value)||(c.value=f.value[0]?.name??"raw")}else s.value="",o.value="",r.value=null,l.value={},a.value={},d.value=null,c.value="raw"},{immediate:!0,deep:!0}),He(s,T=>{if(n.canEdit)try{const R=JSON.parse(T&&T.trim()?T:"{}");r.value=null,d.value=null,l.value=R??{},A(R??{})}catch(R){r.value=R instanceof Error?R.message:"Invalid JSON",a.value={}}},{immediate:!0});const M=T=>{if(T!=="raw"&&!u.value){d.value="Fix the JSON to use structured editors.",c.value="raw";return}if(d.value=null,T==="raw"){c.value="raw";return}c.value=p.value.has(T)?T:"raw"},x=(T,R)=>{if(!u.value){d.value="Fix the JSON to use structured editors.",c.value="raw";return}const I=l.value??{},$=JSON.parse(JSON.stringify(I??{}));R===void 0?delete $[T]:$[T]=R,s.value=JSON.stringify($,null,2)},w=()=>{if(!(!n.canEdit||r.value))try{const T=JSON.parse(s.value&&s.value.trim()?s.value:"{}");if(A(T??{}),Object.values(a.value).some(R=>!!R))return;i("apply",T),o.value=s.value}catch{r.value="Invalid JSON format"}},k=()=>{s.value=o.value,r.value=null,d.value=null;const T=JSON.parse(o.value&&o.value.trim()?o.value:"{}");l.value=T??{},A(T??{})};return(T,R)=>T.visible?(ae(),ce("div",V2,[J("div",B2,[J("div",H2,[R[4]||(R[4]=J("label",{class:"mode-label"},"Editor",-1)),J("select",{class:"mode-select",value:c.value,disabled:!T.canEdit,onChange:R[0]||(R[0]=I=>M(I.target.value))},[(ae(!0),ce(Re,null,Qt(f.value,I=>(ae(),ce("option",{key:I.name,value:I.name},Fe(I.name),9,W2))),128)),R[3]||(R[3]=J("option",{value:"raw"},"Raw JSON",-1))],40,j2)]),J("div",K2,[h.value?(ae(),ce("div",q2,R[5]||(R[5]=[J("span",{class:"dot"},null,-1),qr(" Unsaved ")]))):Ne("",!0),r.value?(ae(),ce("div",Y2,"Invalid JSON")):v.value?(ae(),ce("div",X2,"Schema issues")):Ne("",!0)])]),d.value?(ae(),ce("p",Z2,Fe(d.value),1)):Ne("",!0),T.canEdit?(ae(),ce("div",J2,[c.value==="raw"?(ae(),ce(Re,{key:0},[R[6]||(R[6]=J("p",{class:"help"},"Edit the metadata as JSON:",-1)),eo(J("textarea",{"onUpdate:modelValue":R[1]||(R[1]=I=>s.value=I),class:"textarea",placeholder:"{}"},null,512),[[bc,s.value]]),r.value?(ae(),ce("p",Q2,Fe(r.value),1)):Ne("",!0),g.value.length?(ae(),ce("div",em,[(ae(!0),ce(Re,null,Qt(g.value,([I,$])=>(ae(),ce("div",{key:I},Fe(I)+": "+Fe($),1))),128))])):Ne("",!0)],64)):b.value?(ae(),ce(Re,{key:1},[J("div",tm,[J("div",nm,[R[7]||(R[7]=J("span",{class:"key-label"},"Key",-1)),J("code",null,Fe(C.value),1)]),R[8]||(R[8]=J("span",{class:"schema-note"},"Stored on the top-level metadata object",-1))]),Ke($2,{schema:b.value.schema,"model-value":m.value,disabled:!T.canEdit,"onUpdate:modelValue":R[2]||(R[2]=I=>x(C.value,I))},null,8,["schema","model-value","disabled"]),a.value[C.value]?(ae(),ce("p",im,Fe(a.value[C.value]),1)):Ne("",!0)],64)):Ne("",!0)])):(ae(),ce("div",rm,R[9]||(R[9]=[J("p",null,"Select multiple items to edit metadata (single selection only)",-1)]))),T.canEdit?(ae(),ce("div",sm,[J("button",{onClick:w,class:"btn save",disabled:!y.value}," Save ",8,om),J("button",{onClick:k,class:"btn cancel",disabled:!h.value}," Cancel ",8,am)])):Ne("",!0)])):Ne("",!0)}}),[["styles",[".metadata-editor[data-v-ea30a7a8]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:8px 14px;margin-top:8px;box-shadow:0 1px 4px #0000001a;max-width:720px;font-size:14px}.header[data-v-ea30a7a8]{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:6px}.mode-switcher[data-v-ea30a7a8]{display:flex;align-items:center;gap:8px}.mode-label[data-v-ea30a7a8]{font-weight:600;color:#333}.mode-select[data-v-ea30a7a8]{border:1px solid #ccc;border-radius:4px;padding:4px 8px;font-size:13px}.status[data-v-ea30a7a8]{display:flex;align-items:center;gap:8px}.unsaved-indicator[data-v-ea30a7a8]{display:flex;align-items:center;gap:6px;font-size:13px;color:#f39c12;font-weight:600}.dot[data-v-ea30a7a8]{width:6px;height:6px;background:#f39c12;border-radius:50%;animation:pulse-ea30a7a8 1.5s infinite}@keyframes pulse-ea30a7a8{0%,to{opacity:1}50%{opacity:.5}}.pill[data-v-ea30a7a8]{padding:2px 8px;border-radius:12px;font-size:12px;font-weight:600}.pill.error[data-v-ea30a7a8]{background:#fdecea;color:#c0392b;border:1px solid #e6b8b4}.pill.warn[data-v-ea30a7a8]{background:#fff4e5;color:#d35400;border:1px solid #f0cba8}.body[data-v-ea30a7a8]{display:flex;flex-direction:column;gap:6px}.help[data-v-ea30a7a8]{margin:0;color:#555;font-size:13px}.textarea[data-v-ea30a7a8]{width:100%;min-height:140px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:13px;line-height:1.35;resize:vertical}.textarea[data-v-ea30a7a8]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 2px #0066ff1f}.schema-header[data-v-ea30a7a8]{display:flex;justify-content:space-between;align-items:center}.schema-title[data-v-ea30a7a8]{display:flex;align-items:center;gap:6px;font-weight:700;color:#333}.key-label[data-v-ea30a7a8]{font-size:12px;text-transform:uppercase;letter-spacing:.04em;color:#777}.schema-note[data-v-ea30a7a8]{font-size:12px;color:#666}.inline-error[data-v-ea30a7a8]{margin:0;color:#c0392b;font-size:12px}.buttons[data-v-ea30a7a8]{display:flex;gap:8px;margin-top:8px}.btn[data-v-ea30a7a8]{padding:5px 12px;border:1px solid;border-radius:4px;cursor:pointer;font-size:13px;transition:all .15s}.btn[data-v-ea30a7a8]:disabled{opacity:.5;cursor:not-allowed}.save[data-v-ea30a7a8]{background:#28a745;color:#fff;border-color:#28a745}.save[data-v-ea30a7a8]:hover:not(:disabled){background:#218838}.cancel[data-v-ea30a7a8]{background:#6c757d;color:#fff;border-color:#6c757d}.cancel[data-v-ea30a7a8]:hover:not(:disabled){background:#5a6268}.warning[data-v-ea30a7a8]{text-align:center;color:#e67e22;padding:8px}.warning p[data-v-ea30a7a8]{margin:0;font-size:15px}"]],["__scopeId","data-v-ea30a7a8"]]),lm={class:"smart-metadata-editor"},cm={key:0,class:"single-node-header"},dm={class:"node-id"},um={key:1,class:"hierarchical-editor"},hm={class:"header"},fm={key:0},pm={key:1,class:"multi-selection-header"},gm={class:"help"},mm={key:0,class:"tree-view"},ym=["onClick","onMouseenter"],vm={class:"label"},_m={key:0,class:"metadata-indicator"},bm={key:1,class:"empty-state"},Sm={key:3,class:"selection-hint"},wm={key:2,class:"empty-state"},xm=mn(Zt({__name:"HierarchicalMetadataEditor",props:{selectedNodes:{type:Array},singleNode:{type:[Object,null]},multiSelected:{type:Boolean},groupSelected:{type:Boolean},collectHierarchyFromRoot:{type:Function},updateMetadataHighlight:{type:Function},updateHoverHighlight:{type:Function},onApplyMetadata:{type:Function},schemaOptions:{default:()=>[],type:Array}},setup(e){const t=e,n=xe(()=>t.selectedNodes),i=xe(()=>t.singleNode),s=xe(()=>t.multiSelected),o=xe(()=>t.groupSelected),r=xe(()=>s.value||o.value?"hierarchical":i.value?"simple":"none"),a=xe(()=>{if(s.value)return t.collectHierarchyFromRoot(n.value);if(o.value){const m=n.value[0];return m?t.collectHierarchyFromRoot([m]):[]}return[]}),l=qh(null),c=xe(()=>{const m=i.value;return m?m.getAttr("metadata")??{}:null}),d=xe(()=>{const m=l.value;return m?m.getAttr("metadata")??{}:null});He([r,o,n],([m,u])=>{if(m==="hierarchical"&&u){const y=n.value[0];y&&(l.value=y,t.updateMetadataHighlight(y))}else m==="simple"&&i.value?(l.value=i.value,t.updateMetadataHighlight(i.value)):(m==="hierarchical"&&s.value||m==="none")&&(l.value=null,t.updateMetadataHighlight(void 0))},{immediate:!0}),He(i,m=>{r.value==="simple"&&(l.value=m,t.updateMetadataHighlight(m))}),He(l,m=>{t.updateMetadataHighlight(m)}),He(r,m=>{m==="none"&&(l.value=null,t.updateMetadataHighlight(void 0))}),ui(()=>{t.updateMetadataHighlight(void 0),t.updateHoverHighlight(void 0)});const f=m=>{l.value=m},p=m=>{i.value&&t.onApplyMetadata(i.value,m)},h=m=>{l.value&&t.onApplyMetadata(l.value,m)},g=m=>{const u=m,y=u.id()||`#${u._id}`;if(u instanceof X.Group){const S=u.getChildren().length;return`Group ${y} (${S} ${S===1?"child":"children"})`}else return u instanceof X.Path?`Stroke ${y}`:u instanceof X.Line?`Polygon ${y}`:`${u.constructor.name} ${y}`},v=m=>{const y=m.getAttr("metadata");return y&&Object.keys(y).length>0},b=m=>{t.updateHoverHighlight(m)},C=()=>{t.updateHoverHighlight(void 0)};return(m,u)=>(ae(),ce("div",lm,[r.value==="simple"?(ae(),ce(Re,{key:0},[i.value?(ae(),ce("div",cm,[J("span",dm,Fe(g(i.value)),1)])):Ne("",!0),Ke(vu,{metadata:c.value,visible:!0,"can-edit":!!i.value,"schema-options":t.schemaOptions,onApply:p},null,8,["metadata","can-edit","schema-options"])],64)):r.value==="hierarchical"?(ae(),ce("div",um,[J("div",hm,[o.value?(ae(),ce("h3",fm,"Group: "+Fe(g(n.value[0])),1)):s.value?(ae(),ce("h3",pm,Fe(n.value.length)+" items selected  single-item editing only ",1)):Ne("",!0),J("p",gm,Fe(s.value?"Pick one below to edit its metadata:":"Select a node to edit its metadata:"),1)]),a.value.length>0?(ae(),ce("div",mm,[(ae(!0),ce(Re,null,Qt(a.value,y=>(ae(),ce("div",{key:y.indexPath,class:Rt(["tree-row",{active:y.node===l.value}]),style:_n({paddingLeft:y.depth*50+"px"}),onClick:S=>f(y.node),onMouseenter:S=>b(y.node),onMouseleave:C},[J("span",vm,Fe(g(y.node)),1),v(y.node)?(ae(),ce("span",_m,"")):Ne("",!0)],46,ym))),128))])):(ae(),ce("div",bm,u[0]||(u[0]=[J("p",null,"No shapes or groups available",-1)]))),l.value?(ae(),jn(vu,{key:2,metadata:d.value,visible:!0,"can-edit":!0,"schema-options":t.schemaOptions,onApply:h},null,8,["metadata","schema-options"])):s.value?(ae(),ce("div",Sm,u[1]||(u[1]=[J("p",null," Click a row above to edit its metadata",-1)]))):Ne("",!0)])):(ae(),ce("div",wm,u[2]||(u[2]=[J("p",null,"Select something to edit its metadata",-1)])))]))}}),[["styles",[".smart-metadata-editor[data-v-3d029686]{margin-top:8px}.single-node-header[data-v-3d029686]{background:#fff;border:1px solid #ddd;border-bottom:none;border-radius:6px 6px 0 0;padding:8px 16px;font-family:Monaco,Consolas,monospace;font-size:13px;color:#333}.node-id[data-v-3d029686]{font-weight:500}.hierarchical-editor[data-v-3d029686]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:8px 16px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-3d029686]{margin-bottom:8px}.header h3[data-v-3d029686]{margin:0 0 4px;font-size:17px;color:#333}.multi-selection-header[data-v-3d029686]{color:#e67e22!important;font-weight:700}.help[data-v-3d029686]{margin:0;color:#666;font-size:14px}.tree-view[data-v-3d029686]{max-height:300px;overflow-y:auto;border:1px solid #eee;border-radius:4px;margin-bottom:8px}.tree-row[data-v-3d029686]{display:flex;align-items:center;justify-content:space-between;padding:4px 8px;cursor:pointer;user-select:none;border-bottom:1px solid #f5f5f5;transition:background-color .15s}.tree-row[data-v-3d029686]:last-child{border-bottom:none}.tree-row[data-v-3d029686]:hover{background-color:#f8f9fa}.tree-row.active[data-v-3d029686]{background-color:#fff2f2;border-left:3px solid #dc3545}.label[data-v-3d029686]{font-family:Monaco,Consolas,monospace;font-size:13px;color:#333}.metadata-indicator[data-v-3d029686]{color:#28a745;font-size:12px;font-weight:700}.empty-state[data-v-3d029686]{text-align:center;color:#666;padding:20px;font-style:italic}.empty-state p[data-v-3d029686]{margin:0}.selection-hint[data-v-3d029686]{text-align:center;color:#666;padding:15px;font-style:italic;border:2px dashed #ddd;border-radius:6px;margin-top:10px}.selection-hint p[data-v-3d029686]{margin:0}"]],["__scopeId","data-v-3d029686"]]),_u=e=>{const t=[],n=(i,s=0,o="")=>{t.push({node:i,depth:s,indexPath:o}),i instanceof X.Group&&i.getChildren().forEach((r,a)=>n(r,s+1,o?`${o}/${a}`:`${a}`))};return e.forEach((i,s)=>n(i,0,`${s}`)),t},Cm=e=>e?_u(e.getChildren()):[],ws=new Map,bu=e=>ws.set(e.key,e),Su=()=>Array.from(ws.values()),km=e=>e.ancillary.nodeVisualizations,wu=e=>{const t=e.layers.overlay;if(t){if(!e.groups.ancillaryViz){const n=new X.Group({listening:!1,name:"ancillary-vis"});e.groups.ancillaryViz=n,t.add(n)}return e.groups.ancillaryViz}},Pm=e=>{e.stage&&e.ancillary.rafToken===null&&(e.ancillary.rafToken=requestAnimationFrame(()=>{e.ancillary.rafToken=null,Nn(e)}))},Tm=e=>{const t=e.stage;if(!t||e.ancillary.listenersAttached)return;const n=()=>Pm(e);t.on("dragmove.av transform.av",n),t.on("destroy.av",n),t.on("dragend.av transformend.av",()=>Nn(e)),e.ancillary.listenersAttached=!0},Em=e=>{e.ancillary.activeWatchStop||(e.ancillary.activeWatchStop=He(()=>e.ancillary.activeVisualizations.value,()=>Nn(e),{deep:!0}))},xu=e=>{e.stage&&(wu(e),Tm(e),Em(e),Nn(e))},Nn=e=>{const t=e.stage,n=wu(e);if(!t||!n)return;const s=Cm(e.groups.freehandShape).filter(l=>l.depth===0).map(l=>l.node),o=new Map,r=e.ancillary.activeVisualizations.value;s.forEach(l=>{const c=l.getAttr("metadata")??{},d=l.getClientRect({relativeTo:t}),f={node:l,metadata:c,bbox:d};r.forEach(p=>{const h=ws.get(p);h&&h.validate(f)&&o.set(`${p}|${l.id()}`,{ctx:f,def:h})})});const a=km(e);a.forEach((l,c)=>{o.has(c)||(ws.get(l.key)?.destroy?.(l.nodes),(Array.isArray(l.nodes)?l.nodes:[l.nodes]).forEach(p=>p.destroy()),a.delete(c))}),o.forEach((l,c)=>{const d=a.get(c);if(d)l.def.update?.(l.ctx,d.nodes);else{const f=l.def.create(l.ctx);(Array.isArray(f)?f:[f]).forEach(h=>{h instanceof X.Group||h instanceof X.Shape?n.add(h):console.warn("Ancillary visualization produced unsupported node type",h)}),a.set(c,{key:l.def.key,nodes:f})}}),n.getLayer()?.batchDraw()},Am=Object.freeze(Object.defineProperty({__proto__:null,getRegisteredAVs:Su,initAVLayer:xu,refreshAnciliaryViz:Nn,registerAV:bu},Symbol.toStringTag,{value:"Module"}));bu({key:"typo-guides",displayName:"Typography Guidelines",validate:({metadata:e})=>["lowLine","midLine","capHeight","ascender","descender","baseline"].some(t=>t in e&&typeof e[t]=="number"),create:e=>Cu(e),update:(e,t)=>Cu(e,t)});function Cu({bbox:e,metadata:t},n){const i=[4,4],o=[{key:"baseline",fraction:t.baseline,color:"#333"},{key:"lowLine",fraction:t.lowLine,color:"#888"},{key:"midLine",fraction:t.midLine,color:"#0a0"},{key:"capHeight",fraction:t.capHeight,color:"#f80"},{key:"ascender",fraction:t.ascender,color:"#00f"},{key:"descender",fraction:t.descender,color:"#f00"}].filter(r=>r.fraction!==void 0&&typeof r.fraction=="number"&&r.fraction>=0&&r.fraction<=1).map(r=>{const a=e.y+e.height*r.fraction;return new X.Line({points:[e.x,a,e.x+e.width,a],stroke:r.color,strokeWidth:5,dash:i,listening:!1,name:`typo-guide-${r.key}`})});return n?(n.forEach((r,a)=>{if(a<o.length){const l=o[a];r.points(l.points()),r.stroke(l.stroke())}}),n.length>o.length&&(n.slice(o.length).forEach(r=>r.destroy()),n.splice(o.length)),o.length>n.length&&n.push(...o.slice(n.length)),n):o}const Rm={key:0,class:"av-toggle-pane"},Mm={class:"toggles-grid"},Dm=["checked","onChange"],Om=mn(Zt({__name:"VisualizationToggles",props:{canvasState:{type:Object}},setup(e){const t=e,n=xe(()=>Su()),i=xe(()=>t.canvasState.ancillary.activeVisualizations.value),s=(r,a)=>{const l=new Set(i.value);a?l.add(r):l.delete(r),t.canvasState.ancillary.activeVisualizations.value=l},o=(r,a)=>{const l=a.target.checked;s(r,l)};return(r,a)=>n.value.length>0?(ae(),ce("div",Rm,[a[0]||(a[0]=J("h4",null,"Visualizations",-1)),J("div",Mm,[(ae(!0),ce(Re,null,Qt(n.value,l=>(ae(),ce("label",{key:l.key,class:"toggle-item"},[J("input",{type:"checkbox",checked:i.value.has(l.key),onChange:c=>o(l.key,c)},null,40,Dm),J("span",null,Fe(l.displayName),1)]))),128))])])):Ne("",!0)}}),[["styles",[".av-toggle-pane[data-v-641f8251]{background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px;font-size:13px}.av-toggle-pane h4[data-v-641f8251]{margin:0 0 8px;font-size:14px;color:#333;font-weight:600}.toggles-grid[data-v-641f8251]{display:flex;flex-direction:column;gap:6px}.toggle-item[data-v-641f8251]{display:flex;align-items:center;gap:8px;cursor:pointer;transition:background-color .2s;padding:4px 6px;border-radius:4px}.toggle-item[data-v-641f8251]:hover{background-color:#f0f0f0}.toggle-item input[type=checkbox][data-v-641f8251]{margin:0;cursor:pointer}.toggle-item span[data-v-641f8251]{color:#555;font-size:13px;user-select:none}.toggle-item input[type=checkbox]:checked+span[data-v-641f8251]{color:#333;font-weight:500}"]],["__scopeId","data-v-641f8251"]]),Nm={class:"snapshots-panel"},Fm={class:"panel-header"},Lm={class:"header-buttons"},Im=["disabled"],Gm={key:0,class:"snapshots-list"},zm=["onClick","onDblclick"],Um={class:"snapshot-name"},$m=["onClick"],Vm={key:1,class:"empty-state"},Bm=mn(Zt({__name:"SnapshotsPanel",props:{snapshots:{type:Array},selectedId:{type:[String,null]},onSaveSnapshot:{type:Function},onRestoreSnapshot:{type:Function},executeCommand:{type:Function}},emits:["update:snapshots","update:selectedId"],setup(e,{emit:t}){const n=e,i=t,s=ge(null),o=ge(""),r=ge(null),a=xe(()=>n.snapshots.find(b=>b.id===n.selectedId)),l=()=>crypto.randomUUID(),c=()=>{const b=n.onSaveSnapshot(),C=l(),m=C.slice(0,8),u={id:C,name:m,data:b};i("update:snapshots",[...n.snapshots,u]),i("update:selectedId",C)},d=()=>{if(!a.value)return;const b=a.value.data;n.executeCommand("Restore Snapshot",()=>{n.onRestoreSnapshot(b)})},f=b=>{i("update:selectedId",b)},p=b=>{s.value=b.id,o.value=b.name,li(()=>{r.value?.focus(),r.value?.select()})},h=()=>{if(!s.value)return;const b=o.value.trim();if(b){const C=n.snapshots.map(m=>m.id===s.value?{...m,name:b}:m);i("update:snapshots",C)}s.value=null,o.value=""},g=b=>{b.key==="Enter"?h():b.key==="Escape"&&(s.value=null,o.value="")},v=b=>{const C=n.snapshots.filter(m=>m.id!==b);i("update:snapshots",C),n.selectedId===b&&i("update:selectedId",null)};return(b,C)=>(ae(),ce("div",Nm,[J("div",Fm,[C[2]||(C[2]=J("span",{class:"panel-title"},"Snapshots",-1)),J("div",Lm,[J("button",{onClick:c,class:"panel-btn save-btn",title:"Save current state as snapshot"}," Save "),J("button",{onClick:d,disabled:!a.value,class:"panel-btn restore-btn",title:"Restore selected snapshot"}," Restore ",8,Im)])]),b.snapshots.length>0?(ae(),ce("div",Gm,[(ae(!0),ce(Re,null,Qt(b.snapshots,m=>(ae(),ce("div",{key:m.id,class:Rt(["snapshot-row",{selected:m.id===b.selectedId}]),onClick:u=>f(m.id),onDblclick:u=>p(m)},[s.value===m.id?eo((ae(),ce("input",{key:0,ref_for:!0,ref_key:"editInput",ref:r,"onUpdate:modelValue":C[0]||(C[0]=u=>o.value=u),class:"name-input",onBlur:h,onKeydown:g,onClick:C[1]||(C[1]=So(()=>{},["stop"]))},null,544)),[[bc,o.value]]):(ae(),ce(Re,{key:1},[J("span",Um,Fe(m.name),1),J("button",{class:"delete-btn",onClick:So(u=>v(m.id),["stop"]),title:"Delete snapshot"}," x ",8,$m)],64))],42,zm))),128))])):(ae(),ce("div",Vm," No snapshots yet "))]))}}),[["styles",[".snapshots-panel[data-v-20847978]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:8px;font-size:13px;width:280px}.panel-header[data-v-20847978]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;padding-bottom:6px;border-bottom:1px solid #eee}.panel-title[data-v-20847978]{font-weight:600;color:#333;font-size:14px}.header-buttons[data-v-20847978]{display:flex;gap:4px}.panel-btn[data-v-20847978]{border:1px solid;border-radius:4px;padding:4px 10px;font-size:12px;cursor:pointer;transition:all .15s;font-weight:500}.panel-btn[data-v-20847978]:disabled{opacity:.5;cursor:not-allowed}.save-btn[data-v-20847978]{background:#28a745;color:#fff;border-color:#28a745}.save-btn[data-v-20847978]:hover:not(:disabled){background:#218838}.restore-btn[data-v-20847978]{background:#f0f0f0;border-color:#ccc;color:#333}.restore-btn[data-v-20847978]:hover:not(:disabled){background:#e0e0e0;border-color:#999}.snapshots-list[data-v-20847978]{max-height:200px;overflow-y:auto;border:1px solid #eee;border-radius:4px}.snapshot-row[data-v-20847978]{display:flex;align-items:center;gap:8px;padding:4px 8px;cursor:pointer;border-bottom:1px solid #f5f5f5;transition:background-color .1s}.snapshot-row[data-v-20847978]:last-child{border-bottom:none}.snapshot-row[data-v-20847978]:hover{background-color:#f8f9fa}.snapshot-row.selected[data-v-20847978]{background-color:#e8f0fe;border-left:2px solid #0066ff}.snapshot-name[data-v-20847978]{font-family:Monaco,Consolas,monospace;font-size:12px;color:#333;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.name-input[data-v-20847978]{flex:1;font-family:Monaco,Consolas,monospace;font-size:12px;padding:2px 4px;border:1px solid #0066ff;border-radius:2px;outline:none}.delete-btn[data-v-20847978]{background:none;border:none;color:#999;cursor:pointer;padding:0 4px;font-size:14px;line-height:1;opacity:0;transition:opacity .15s,color .15s}.snapshot-row:hover .delete-btn[data-v-20847978]{opacity:1}.delete-btn[data-v-20847978]:hover{color:#dc3545}.empty-state[data-v-20847978]{text-align:center;color:#999;padding:16px 8px;font-style:italic;font-size:12px}"]],["__scopeId","data-v-20847978"]]),Hm={class:"popout-wrapper"},jm={class:"popout-toolbar"},Wm=mn(Zt({__name:"PopoutWindow",props:{title:{type:String,default:"Popout"},modelValue:{type:Boolean,default:!1},width:{type:Number,default:1280},height:{type:Number,default:720},left:{type:Number,default:void 0},top:{type:Number,default:void 0},features:{type:String,default:""},copyStyles:{type:Boolean,default:!0},fullscreenTarget:{type:[String,Function],default:""},fill:{type:Boolean,default:!0}},emits:["update:modelValue","beforePopOut","beforePopIn","opened","closed"],setup(e,{expose:t,emit:n}){const i=e,s=n,o=ge(null),r=ge(null),a=ge(null);let l=null,c=null;const d=xe({get:()=>i.modelValue,set:M=>s("update:modelValue",M)});function f(){if(i.features)return i.features;const M=[];return M.push(`width=${i.width}`),M.push(`height=${i.height}`),i.left!=null&&M.push(`left=${i.left}`),i.top!=null&&M.push(`top=${i.top}`),M.join(",")}function p(M,x){try{M.adoptedStyleSheets?.length&&"adoptedStyleSheets"in x&&(x.adoptedStyleSheets=M.adoptedStyleSheets)}catch{}Array.from(M.querySelectorAll('link[rel="stylesheet"], style')).forEach(w=>{const k=w.cloneNode(!0);x.head.appendChild(k)})}function h(M){return typeof i.fullscreenTarget=="function"?i.fullscreenTarget(M)??M:typeof i.fullscreenTarget=="string"&&i.fullscreenTarget?M.querySelector(i.fullscreenTarget)??M:M}function g(M,x){const w=M.createElement("button");w.textContent="Fullscreen",Object.assign(w.style,{position:"fixed",top:"8px",right:"8px",zIndex:"999999",padding:"8px 16px",backgroundColor:"#333",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"});const k=h(x),T=()=>{const R=!!M.fullscreenElement;w.style.display=R?"none":"inline-block"};return w.addEventListener("click",()=>{k.requestFullscreen?.()}),M.addEventListener("fullscreenchange",T),c=T,T(),M.body.appendChild(w),w}function v(M){const x=r.value,w=M.document,k=w.adoptNode(x);i.fill&&(Object.assign(k.style,{width:"100vw",height:"100vh"}),Object.assign(w.documentElement.style,{height:"100%"}),Object.assign(w.body.style,{margin:"0",height:"100%"})),w.body.appendChild(k)}function b(){const M=r.value;M&&o.value&&(document.adoptNode(M),M.style.removeProperty("width"),M.style.removeProperty("height"),o.value.appendChild(M))}function C(){if(l!=null&&(clearInterval(l),l=null),a.value&&c)try{a.value.document.removeEventListener("fullscreenchange",c),c=null}catch{}if(a.value)try{a.value.removeEventListener("beforeunload",m),a.value.removeEventListener("unload",m)}catch{}}function m(){d.value&&(s("beforePopIn"),b(),d.value=!1,s("closed")),u()}function u(){C();try{a.value?.close()}catch{}a.value=null}function y(){if(a.value&&!a.value.closed)return;s("beforePopOut");const M=window.open("","_blank",f());M&&(a.value=M,M.document.title=i.title,M.document.body.style.background="black",i.copyStyles&&p(document,M.document),M.document.documentElement.className=document.documentElement.className,M.document.body.className=document.body.className,v(M),g(M.document,r.value),M.addEventListener("beforeunload",m),M.addEventListener("unload",m),l=window.setInterval(()=>{(!a.value||a.value.closed)&&m()},1e3),s("opened",M),d.value=!0)}function S(){s("beforePopIn"),b(),d.value=!1,s("closed"),u()}function A(){d.value?S():y()}return He(()=>i.modelValue,async M=>{await li(),M?y():S()}),Vr(()=>{i.modelValue&&y()}),ro(()=>{if(d.value)try{S()}catch{}}),t({openPopup:y,closePopup:S,toggle:A,isPopped:d}),(M,x)=>(ae(),ce("div",Hm,[J("div",jm,[yl(M.$slots,"controls",{popped:d.value,popOut:y,popIn:S},()=>[d.value?(ae(),ce("button",{key:1,onClick:S},"Pop in")):(ae(),ce("button",{key:0,onClick:y},"Pop out"))])]),J("div",{ref_key:"anchor",ref:o,class:"popout-anchor"},[J("div",{ref_key:"contentRoot",ref:r},[yl(M.$slots,"default",{},void 0)],512)],512)]))}}),[["styles",[".popout-wrapper[data-v-77babdfc]{display:flex;flex-direction:column;gap:.5rem}.popout-toolbar[data-v-77babdfc]{display:flex;gap:.5rem;align-items:center}.popout-anchor[data-v-77babdfc]{display:block}"]],["__scopeId","data-v-77babdfc"]]);function ku(e,t,n,i=s=>s){return e*i(.5-t*(.5-n))}function Km(e){return[-e[0],-e[1]]}function Nt(e,t){return[e[0]+t[0],e[1]+t[1]]}function At(e,t){return[e[0]-t[0],e[1]-t[1]]}function Ft(e,t){return[e[0]*t,e[1]*t]}function qm(e,t){return[e[0]/t,e[1]/t]}function dr(e){return[e[1],-e[0]]}function Pu(e,t){return e[0]*t[0]+e[1]*t[1]}function Ym(e,t){return e[0]===t[0]&&e[1]===t[1]}function Xm(e){return Math.hypot(e[0],e[1])}function Zm(e){return e[0]*e[0]+e[1]*e[1]}function Tu(e,t){return Zm(At(e,t))}function Eu(e){return qm(e,Xm(e))}function Jm(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function ur(e,t,n){let i=Math.sin(n),s=Math.cos(n),o=e[0]-t[0],r=e[1]-t[1],a=o*s-r*i,l=o*i+r*s;return[a+t[0],l+t[1]]}function Qo(e,t,n){return Nt(e,Ft(At(t,e),n))}function Au(e,t,n){return Nt(e,Ft(t,n))}var{min:Zn,PI:Qm}=Math,Ru=.275,hr=Qm+1e-4;function ey(e,t={}){let{size:n=16,smoothing:i=.5,thinning:s=.5,simulatePressure:o=!0,easing:r=_=>_,start:a={},end:l={},last:c=!1}=t,{cap:d=!0,easing:f=_=>_*(2-_)}=a,{cap:p=!0,easing:h=_=>--_*_*_+1}=l;if(e.length===0||n<=0)return[];let g=e[e.length-1].runningLength,v=a.taper===!1?0:a.taper===!0?Math.max(n,g):a.taper,b=l.taper===!1?0:l.taper===!0?Math.max(n,g):l.taper,C=Math.pow(n*i,2),m=[],u=[],y=e.slice(0,10).reduce((_,P)=>{let N=P.pressure;if(o){let O=Zn(1,P.distance/n),G=Zn(1,1-O);N=Zn(1,_+(G-_)*(O*Ru))}return(_+N)/2},e[0].pressure),S=ku(n,s,e[e.length-1].pressure,r),A,M=e[0].vector,x=e[0].point,w=x,k=x,T=w,R=!1;for(let _=0;_<e.length;_++){let{pressure:P}=e[_],{point:N,vector:O,distance:G,runningLength:H}=e[_];if(_<e.length-1&&g-H<3)continue;if(s){if(o){let ee=Zn(1,G/n),he=Zn(1,1-ee);P=Zn(1,y+(he-y)*(ee*Ru))}S=ku(n,s,P,r)}else S=n/2;A===void 0&&(A=S);let V=H<v?f(H/v):1,Q=g-H<b?h((g-H)/b):1;S=Math.max(.01,S*Math.min(V,Q));let se=(_<e.length-1?e[_+1]:e[_]).vector,F=_<e.length-1?Pu(O,se):1,E=Pu(O,M)<0&&!R,U=F!==null&&F<0;if(E||U){let ee=Ft(dr(M),S);for(let he=.07692307692307693,D=0;D<=1;D+=he)k=ur(At(N,ee),N,hr*D),m.push(k),T=ur(Nt(N,ee),N,hr*-D),u.push(T);x=k,w=T,U&&(R=!0);continue}if(R=!1,_===e.length-1){let ee=Ft(dr(O),S);m.push(At(N,ee)),u.push(Nt(N,ee));continue}let j=Ft(dr(Qo(se,O,F)),S);k=At(N,j),(_<=1||Tu(x,k)>C)&&(m.push(k),x=k),T=Nt(N,j),(_<=1||Tu(w,T)>C)&&(u.push(T),w=T),y=P,M=O}let I=e[0].point.slice(0,2),$=e.length>1?e[e.length-1].point.slice(0,2):Nt(e[0].point,[1,1]),z=[],q=[];if(e.length===1){if(!(v||b)||c){let _=Au(I,Eu(dr(At(I,$))),-(A||S)),P=[];for(let N=.07692307692307693,O=N;O<=1;O+=N)P.push(ur(_,I,hr*2*O));return P}}else{if(!(v||b&&e.length===1))if(d)for(let P=.07692307692307693,N=P;N<=1;N+=P){let O=ur(u[0],I,hr*N);z.push(O)}else{let P=At(m[0],u[0]),N=Ft(P,.5),O=Ft(P,.51);z.push(At(I,N),At(I,O),Nt(I,O),Nt(I,N))}let _=dr(Km(e[e.length-1].vector));if(b||v&&e.length===1)q.push($);else if(p){let P=Au($,_,S);for(let N=.034482758620689655,O=N;O<1;O+=N)q.push(ur(P,$,hr*3*O))}else q.push(Nt($,Ft(_,S)),Nt($,Ft(_,S*.99)),At($,Ft(_,S*.99)),At($,Ft(_,S)))}return m.concat(q,u.reverse(),z)}function ty(e,t={}){var n;let{streamline:i=.5,size:s=16,last:o=!1}=t;if(e.length===0)return[];let r=.15+(1-i)*.85,a=Array.isArray(e[0])?e:e.map(({x:h,y:g,pressure:v=.5})=>[h,g,v]);if(a.length===2){let h=a[1];a=a.slice(0,-1);for(let g=1;g<5;g++)a.push(Qo(a[0],h,g/4))}a.length===1&&(a=[...a,[...Nt(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,d=0,f=l[0],p=a.length-1;for(let h=1;h<a.length;h++){let g=o&&h===p?a[h].slice(0,2):Qo(f.point,a[h],r);if(Ym(f.point,g))continue;let v=Jm(g,f.point);if(d+=v,h<p&&!c){if(d<s)continue;c=!0}f={point:g,pressure:a[h][2]>=0?a[h][2]:.5,vector:Eu(At(f.point,g)),distance:v,runningLength:d},l.push(f)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function ny(e,t={}){return ey(ty(e,t),t)}var iy=ny;const ea=e=>e.metadata.highlight.layer,ry=e=>e.metadata.highlight.metadataRect,sy=e=>e.metadata.highlight.hoverRect,Mu=(e,t)=>{const n=ea(e);if(n)return n;const i=new X.Group({listening:!1,name:"metadata-highlight"}),s=new X.Rect({stroke:"red",strokeWidth:2,dash:[4,4],listening:!1,visible:!1}),o=new X.Rect({stroke:"green",strokeWidth:2,dash:[4,4],listening:!1,visible:!1});i.add(s),i.add(o);const r=e.layers.overlay;if(r)r.add(i);else{const a=new X.Layer({listening:!1,name:"metadata-highlight-layer"});a.add(i),t.add(a),a.moveToTop()}return e.metadata.highlight.layer=i,e.metadata.highlight.metadataRect=s,e.metadata.highlight.hoverRect=o,e.groups.metadataHighlight=i,i},fr=(e,t)=>{const n=ry(e),i=ea(e);if(!n||!i)return;if(!t){n.visible(!1),n.rotation(0),i.getLayer()?.batchDraw();return}const s=t.getClientRect({skipTransform:!0}),o=t.getAbsoluteScale(),r=Math.abs(o.x),a=Math.abs(o.y),l=s.width*r,c=s.height*a,d=t.getAbsoluteTransform().point({x:s.x+s.width/2,y:s.y+s.height/2});n.setAttrs({x:d.x,y:d.y,width:l,height:c,offsetX:l/2,offsetY:c/2,rotation:t.getAbsoluteRotation(),visible:!0}),i.getLayer()?.batchDraw()},oy=(e,t)=>{const n=sy(e),i=ea(e);if(!n||!i)return;if(!t){n.visible(!1),n.rotation(0),i.getLayer()?.batchDraw();return}const s=t.getClientRect({skipTransform:!0}),o=t.getAbsoluteScale(),r=Math.abs(o.x),a=Math.abs(o.y),l=s.width*r,c=s.height*a,d=t.getAbsoluteTransform().point({x:s.x+s.width/2,y:s.y+s.height/2});n.setAttrs({x:d.x,y:d.y,width:l,height:c,offsetX:l/2,offsetY:c/2,rotation:t.getAbsoluteRotation(),visible:!0}),i.getLayer()?.batchDraw()},ay=e=>({setNodeMetadata:(t,n)=>{n===void 0||Object.keys(n).length===0?t.setAttr("metadata",void 0):t.setAttr("metadata",n)},collectHierarchyFromRoot:_u,updateMetadataHighlight:t=>fr(e,t),updateHoverHighlight:t=>oy(e,t)}),ta=(e,t)=>{t instanceof X.Path?$d(e,t):t instanceof X.Group&&(hs(e,t),t.getChildren().forEach(n=>ta(e,n)))},xs=(e,t)=>{(t instanceof X.Path||t instanceof X.Group)&&(t instanceof X.Path,t.draggable(!0),t.off("click.freehand"),t.off("dragstart.freehand"),t.off("dragend.freehand"),t.on("dragstart.freehand",()=>{ia(e)}),t.on("dragend.freehand",()=>{ra(e,t.constructor.name),e.groups.freehandShape?.getLayer()?.batchDraw()}),t instanceof X.Group&&t.getChildren().forEach(n=>{xs(e,n)}))},Du=(e,t,n=0,i=0)=>{const s=t.clone({x:t.x()+n,y:t.y()+i}),o=(r,a)=>{const l=sn();if(r.id(l),r instanceof X.Path){const c=Array.from(yt(e).values()).find(d=>d.shape===a);if(c){const d={...c,id:l,shape:r};yt(e).set(l,d),console.log("Created stroke data for cloned Path:",l)}}else if(r instanceof X.Group){const c=a,d=r;d.getChildren().forEach((p,h)=>{const g=c.getChildren()[h];o(p,g)});const f=d.find("Path").map(p=>p.id());f.length>0&&(Fo(e).set(l,{id:l,strokeIds:f,group:d}),console.log("Created group data for cloned Group:",l,"with strokes:",f))}};return o(s,t),xs(e,s),ta(e,s),console.log("Successfully cloned",t.className,"with new ID:",s.id()),s},Ou=(e,t)=>{const n=e.layers.drawing;if(!n){console.warn("Cannot initialize freehand groups without drawing layer");return}if(!e.groups.freehandShape){const i=new X.Group({name:"freehand-shapes"});e.groups.freehandShape=i,n.add(i)}if(!e.groups.freehandDrawing){const i=new X.Group({name:"freehand-drawing"});e.groups.freehandDrawing=i,n.add(i)}},Nu=e=>{const t=[],n=new Set;return e.selection.selectedKonvaNodes.value.forEach(i=>{if(i instanceof X.Group){const s=o=>{o.getChildren().forEach(r=>{r instanceof X.Group?s(r):r instanceof X.Path&&Array.from(yt(e).values()).forEach(a=>{a.shape===r&&!n.has(a.id)&&(t.push(a),n.add(a.id))})})};s(i)}else i instanceof X.Path&&Array.from(yt(e).values()).forEach(s=>{s.shape===i&&!n.has(s.id)&&(t.push(s),n.add(s.id))})}),t},na=e=>{e.freehand.timelineDuration.value;let t=0;if(Ud(e))e.freehand.selectedStrokesForTimeline.value=new Set,e.freehand.timelineDuration.value=0;else{const n=Nu(e).filter(s=>s.isFreehand),i=new Set(n.map(s=>s.id));if(e.freehand.selectedStrokesForTimeline.value=i,n.length>0){const s=n.sort((r,a)=>r.creationTime-a.creationTime);let o=0;s.forEach((r,a)=>{const l=r.timestamps[r.timestamps.length-1]||0;o+=l,a<s.length-1&&(o+=100)}),t=o,e.freehand.timelineDuration.value=o}else e.freehand.timelineDuration.value=0}t>0&&e.freehand.currentPlaybackTime.value>t&&(e.freehand.currentPlaybackTime.value=0,aa(e,0))},Fu=e=>{e.freehand.strokes.clear(),e.freehand.strokeGroups.clear()},Lu=(e,t,n)=>{const i={id:n.id,points:n.points,timestamps:n.timestamps,shape:n.shape,selected:n.selected,originalPath:n.originalPath,creationTime:n.creationTime,isFreehand:n.isFreehand};e.freehand.strokes.set(t,i)},Iu=(e,t,n)=>{const i={id:n.id,strokeIds:n.strokeIds,group:n.group};e.freehand.strokeGroups.set(t,i)},Cs=300,Gu=e=>os(e,()=>{const t=e.groups.freehandShape;if(!e.stage||!t)return null;try{const i=t.toObject(),s=Array.from(e.freehand.strokes.entries()),o=Array.from(e.freehand.strokeGroups.entries());return{layer:i,strokes:s,strokeGroups:o}}catch(i){return console.warn("Failed to get current state:",i),null}}),vn=e=>{const t=Gu(e);return JSON.stringify(t)},zu=(e,t,n={})=>{if(t)try{const i=e.freehand.currentPlaybackTime.value>0;e.freehand.currentPlaybackTime.value=0,e.freehand.isAnimating.value=!1,oa(e,t),i&&n.handleTimeUpdate?.(0)}catch(i){console.warn("Failed to restore state:",i)}},ia=e=>{e.freehand.freehandDragStartState=vn(e)},ra=(e,t)=>{if(!e.freehand.freehandDragStartState)return;const n=vn(e);e.freehand.freehandDragStartState!==n&&(ss(e,`Transform ${t}`,e.freehand.freehandDragStartState,n),console.log("Transform command added to global history"),Lt(e)),e.freehand.freehandDragStartState=null},sa=e=>{const t=e.stage;t&&yt(e).forEach((n,i)=>{const s=t.findOne(`#${i}`);s&&s!==n.shape&&(console.log("Updating stroke connection for:",i),n.shape=s)})},Uu=e=>{const t=e.groups.freehandShape;if(!(!e.stage||!t))try{const i=Gu(e);if(!i)return;e.freehand.serializedState=JSON.stringify(i),e.callbacks.syncAppState?.(e),console.log("Serialized canvas state:",{layerChildren:i.layer?.children?.length||0,strokes:i.strokes.length,strokeGroups:i.strokeGroups.length})}catch(i){console.warn("Failed to serialize Konva state:",i)}},oa=(e,t)=>{const n=e.groups.freehandShape,i=e.stage;if(!(!t||!i||!n))try{const s=JSON.parse(t);console.log("Deserializing canvas state:",{layerChildren:s.layer?.children?.length||0,strokes:s.strokes?.length||0,strokeGroups:s.strokeGroups?.length||0}),n.destroyChildren(),Fu(e),vt(e);const o=s.layer;o&&o.children&&(console.log("Restoring",o.children.length,"children"),o.children.forEach((r,a)=>{console.log("Creating node",a,"of type",r.className);const l=X.Node.create(JSON.stringify(r));n.add(l),console.log("Added node to layer:",l.id(),l.isVisible()),xs(e,l),ta(e,l)})),s.strokes&&s.strokes.forEach(([r,a])=>{const l=i.findOne(`#${r}`);console.log("Restoring stroke:",r,"found shape:",!!l);const c={id:a.id,points:a.points,timestamps:a.timestamps,originalPath:a.originalPath,creationTime:a.creationTime,isFreehand:a.isFreehand,shape:l};Lu(e,r,c)}),s.strokeGroups&&s.strokeGroups.forEach(([r,a])=>{const l={id:a.id,strokeIds:a.strokeIds,group:i.findOne(`#${r}`)};Iu(e,r,l)}),sa(e),ks(e),n.getLayer()?.batchDraw(),console.log("Konva canvas state restored from hotreload"),e.freehand.serializedState=t,setTimeout(()=>{n.getLayer()?.batchDraw(),Lt(e)},30)}catch(s){console.warn("Failed to deserialize Konva state:",s)}},ks=e=>{const t=e.groups.freehandShape;yt(e).forEach(n=>{n.shape&&n.shape.draggable(!1)}),t&&t.getChildren().forEach(n=>{n instanceof X.Group&&n.draggable(!1)})},pr=(e,t=!1)=>{if(e.length<4)return"";const n=[];for(let r=0;r<e.length;r+=2)n.push([e[r],e[r+1]]);const i=iy(n,{size:8,thinning:.5,smoothing:.5,streamline:.5,simulatePressure:!0});if(i.length===0)return"";let s=i;if(t){let r=1/0,a=1/0;i.forEach(([l,c])=>{r=Math.min(r,l),a=Math.min(a,c)}),s=i.map(([l,c])=>[l-r,c-a])}return`${s.reduce((r,[a,l],c,d)=>{const[f,p]=d[(c+1)%d.length];return`${r} ${a},${l} ${f},${p}`},`M ${s[0][0]},${s[0][1]} L`)} Z`},$u=(e,t,n)=>{const i=e.groups.freehandShape,s=ds(t),o=[];for(let a=0;a<t.length;a+=2)o.push(t[a]-s.minX),o.push(t[a+1]-s.minY);const r=new X.Path({data:pr(o),fill:"black",strokeWidth:0,id:n,x:s.minX,y:s.minY,draggable:!0});return r.on("dragstart",()=>{ia(e)}),r.on("dragend",()=>{ra(e,"Stroke"),i?.getLayer()?.batchDraw()}),$d(e,r),r},aa=(e,t)=>{const n=e.groups.freehandShape;e.freehand.currentPlaybackTime.value=t;let i=[];const s=!Ud(e);if(s?i=Nu(e).filter(c=>c.isFreehand):i=Array.from(yt(e).values()).filter(l=>l.isFreehand),i.sort((l,c)=>l.creationTime-c.creationTime),t===0){if(s){const l=new Set;i.forEach(c=>{if(c.shape&&c.originalPath){c.shape.show(),c.shape.data(c.originalPath);let d=c.shape.getParent();for(;d&&d!==n;)d instanceof X.Group&&l.add(d),d=d.getParent()}}),l.forEach(c=>c.show())}else yt(e).forEach(l=>{l.shape&&l.originalPath&&l.isFreehand&&(l.shape.show(),l.shape.data(l.originalPath))}),n&&n.getChildren().forEach(l=>{l instanceof X.Group&&l.show()});n?.getLayer()?.batchDraw();return}s?i.forEach(l=>{l.shape&&l.shape.hide()}):(yt(e).forEach(l=>{l.shape&&l.isFreehand&&l.shape.hide()}),n&&n.getChildren().forEach(l=>{l instanceof X.Group&&l.hide()}));let o=0;const r=[];if(s)i.forEach((l,c)=>{const d=l.timestamps[l.timestamps.length-1]||0;r.push({stroke:l,startTime:o,endTime:o+d}),o+=d+(c<i.length-1?100:0)});else{let l=0;i.forEach((c,d)=>{const f=c.timestamps[c.timestamps.length-1]||0;if(d===0)r.push({stroke:c,startTime:0,endTime:f}),l=c.creationTime+f,o=f;else{let p=Math.max(0,c.creationTime-l);!e.freehand.useRealTiming.value&&p>Cs&&(p=Cs);const h=o+p;r.push({stroke:c,startTime:h,endTime:h+f}),o=h+f,l=c.creationTime+f}})}const a=new Set;r.forEach(({stroke:l,startTime:c,endTime:d})=>{if(!(!l.shape||!l.timestamps)){if(t>=c&&t<=d){const f=t-c;let p=-1;for(let h=0;h<l.timestamps.length&&l.timestamps[h]<=f;h++)p=h;if(p>=0){const h=l.points.slice(0,(p+1)*2);if(h.length>=4){const g=ds(l.points),v=[];for(let C=0;C<h.length;C+=2)v.push(h[C]-g.minX),v.push(h[C+1]-g.minY);l.shape.show(),l.shape.data(pr(v));let b=l.shape.getParent();for(;b&&b!==n;)b instanceof X.Group&&a.add(b),b=b.getParent()}}}else if(t>d){l.shape.show(),l.shape.data(l.originalPath);let f=l.shape.getParent();for(;f&&f!==n;)f instanceof X.Group&&a.add(f),f=f.getParent()}}}),a.forEach(l=>l.show()),n?.getLayer()?.batchDraw()},ly=e=>{const t=e.groups.freehandShape;if(!t)return{data:[],groupMap:{}};const n=(a,l)=>{const c=ds(a),d=[];for(let h=0;h<a.length;h+=2)d.push(a[h]-c.minX),d.push(a[h+1]-c.minY);const f=l.getAbsoluteTransform(),p=[];for(let h=0;h<d.length;h+=2){const g=f.point({x:d[h],y:d[h+1]});p.push({x:g.x,y:g.y})}return p};let i=0;const s={},o=a=>{if(a instanceof X.Path){const l=Array.from(e.freehand.strokes.values()).find(p=>p.shape===a);if(!l)return null;const d=n(l.points,a).map((p,h)=>({x:p.x,y:p.y,ts:l.timestamps[Math.floor(h/2)]||0})),f=a.getAttr("metadata");return f&&f.name&&typeof f.name=="string"&&(s[f.name]||(s[f.name]=[]),s[f.name].push(i)),i++,{type:"stroke",id:l.id,points:d,...f&&{metadata:f}}}else if(a instanceof X.Group){const l=i,c=[];if(a.getChildren().forEach(h=>{const g=o(h);g&&c.push(g)}),c.length===0)return null;const d=a.getAttr("metadata"),f=[];for(let h=l;h<i;h++)f.push(h);const p=d&&d.name&&typeof d.name=="string"?d.name:a.id();return p&&(s[p]=f),{type:"strokeGroup",id:a.id(),children:c,...d&&{metadata:d}}}return null},r=[];return t.getChildren().forEach(a=>{const l=o(a);l&&(l.type==="stroke"?r.push({type:"strokeGroup",id:l.id,children:[l]}):r.push(l))}),{data:r,groupMap:s}},Lt=e=>{const t=ly(e);e.freehand.bakedRenderData=t.data,e.freehand.bakedGroupMap=t.groupMap,e.callbacks.syncAppState?.(e)},Vu=Object.freeze(Object.defineProperty({__proto__:null,attachHandlersRecursively:xs,clearStrokesInState:Fu,createStrokeShape:$u,deepCloneWithNewIds:Du,deserializeFreehandState:oa,finishFreehandDragTracking:ra,getCurrentFreehandStateString:vn,getStrokePath:pr,handleTimeUpdate:aa,initFreehandLayers:Ou,maxInterStrokeDelay:Cs,refreshStrokeConnections:sa,restoreFreehandState:zu,serializeFreehandState:Uu,setStrokeGroupInState:Iu,setStrokeInState:Lu,startFreehandDragTracking:ia,updateBakedFreehandData:Lt,updateFreehandDraggableStates:ks,updateTimelineState:na},Symbol.toStringTag,{value:"Module"})),cy=(e,t,n)=>{const i=t.x-e.x,s=t.y-e.y,o=n.x-e.x,r=n.y-e.y,a=i*o+s*r;if(a<=0)return Math.hypot(o,r);const l=i*i+s*s;if(l<=a)return Math.hypot(n.x-t.x,n.y-t.y);const c=a/l,d=e.x+c*i,f=e.y+c*s;return Math.hypot(n.x-d,n.y-f)};function Bu(e,t){let n=-1,i=-1,s=1/0;for(let o=0;o<e.length;o++){const r=e[o];for(let a=0;a<r.points.length;a++){const l=r.points[a],c=r.points[(a+1)%r.points.length],d=cy(l,c,t);d<s&&(s=d,n=o,i=a)}}return{polygonIndex:n,lineIndex:i,distance:s}}const Hu=(e,t)=>{const n=e.layers.drawing,i=e.layers.overlay;if(!n||!i){console.warn("Cannot initialize polygon groups without required layers");return}if(!e.groups.polygonShapes){const s=new X.Group({name:"polygon-shapes"});e.groups.polygonShapes=s,n.add(s)}if(!e.groups.polygonPreview){const s=new X.Group({name:"polygon-preview"});e.groups.polygonPreview=s,i.add(s)}if(!e.groups.polygonControls){const s=new X.Group({name:"polygon-controls"});e.groups.polygonControls=s,i.add(s)}if(!e.groups.polygonSelection){const s=new X.Group({name:"polygon-selection"});e.groups.polygonSelection=s,i.add(s)}},la=e=>{vt(e)},ju=e=>{const t=e.groups.polygonShapes;if(!t)return[];const n=[],i=(s,o)=>{const r=[],a=o.getAbsoluteTransform();for(let l=0;l<s.length;l+=2){const c=a.point({x:s[l],y:s[l+1]});r.push({x:c.x,y:c.y})}return r};return t.getChildren().forEach(s=>{if(s instanceof X.Line){const o=s.points(),r=i(o,s),a=s.getAttr("metadata"),c=Array.from(e.polygon.shapes.values()).find(d=>d.konvaShape===s)?.id||s.id();n.push({type:"polygon",id:c,points:r,...a&&{metadata:a}})}}),n},It=e=>{e.polygon.bakedRenderData=ju(e),e.callbacks.syncAppState?.(e)},ca=e=>os(e,()=>{const t=e.groups.polygonShapes;if(!e.stage||!t)return null;try{const i=t.toObject(),s=Array.from(e.polygon.shapes.entries()),o=Array.from(e.polygon.groups.entries());return{layer:i,polygons:s,polygonGroups:o}}catch(i){return console.warn("Failed to get current polygon state:",i),null}}),Jn=e=>{const t=ca(e);return JSON.stringify(t)},Wu=(e,t)=>{if(t)try{ha(e,t)}catch(n){console.warn("Failed to restore polygon state:",n)}},da=e=>{const t=JSON.stringify({freehand:vn(e),polygon:Jn(e)});e.polygon.dragStartState=t},ua=(e,t)=>{if(!e.polygon.dragStartState)return;const n=JSON.stringify({freehand:vn(e),polygon:Jn(e)});e.polygon.dragStartState!==n&&(ss(e,`Transform ${t}`,e.polygon.dragStartState,n),It(e)),e.polygon.dragStartState=null},on=e=>{const t=e.groups.polygonShapes;if(!(!e.stage||!t))try{const i=ca(e);if(!i)return;e.polygon.serializedState=JSON.stringify(i),e.callbacks.syncAppState?.(e),console.log("Serialized polygon state:",{layerChildren:i.layer?.children?.length||0,polygons:i.polygons.length,polygonGroups:i.polygonGroups.length})}catch(i){console.warn("Failed to serialize polygon state:",i)}},Ps=(e,t)=>{console.log("Attaching polygon handlers to:",t.id()),t.draggable(!1),t.on("dragstart",()=>da(e)),t.on("dragend",()=>{ua(e,"Polygon Drag"),on(e)})},ha=(e,t)=>{const n=e.groups.polygonShapes,i=e.groups.polygonControls,s=e.stage;if(!(!t||!s||!n))try{const o=JSON.parse(t);console.log("Deserializing polygon state:",{layerChildren:o.layer?.children?.length||0,polygons:o.polygons?.length||0,polygonGroups:o.polygonGroups?.length||0}),n.destroyChildren(),e.polygon.shapes.clear(),e.polygon.groups.clear(),vt(e);const r=o.layer;r&&r.children&&(console.log("Restoring",r.children.length,"polygon shapes"),r.children.forEach((a,l)=>{console.log("Creating polygon node",l,"of type",a.className);const c=X.Node.create(JSON.stringify(a));n.add(c),console.log("Added polygon node to layer:",c.id(),c.isVisible()),c instanceof X.Line?(Ps(e,c),Bo(e,c)):c instanceof X.Group&&hs(e,c)})),o.polygons&&o.polygons.forEach(([a,l])=>{const c=s.findOne(`#${a}`);console.log("Restoring polygon:",a,"found shape:",!!c);const d={id:l.id,points:l.points,closed:l.closed,creationTime:l.creationTime,konvaShape:c,controlPoints:[]};e.polygon.shapes.set(a,d)}),o.polygonGroups&&o.polygonGroups.forEach(([a,l])=>{const c={id:l.id,polygonIds:l.polygonIds,group:s.findOne(`#${a}`)};e.polygon.groups.set(a,c)}),i?.destroyChildren(),e.activeTool.value==="polygon"&&e.polygon.mode.value==="edit"&&Fn(e),n.getLayer()?.batchDraw(),e.polygon.serializedState=t,It(e),console.log("Polygon state restored from hotreload")}catch(o){console.warn("Failed to deserialize polygon state:",o)}},Ku=(e,t)=>{const n=e.groups.polygonShapes;if(n){if(e.polygon.mode.value==="draw"){if(!e.polygon.isDrawing.value)e.polygon.isDrawing.value=!0,e.polygon.currentPoints.value=[t.x,t.y];else{const i=e.polygon.currentPoints.value[0],s=e.polygon.currentPoints.value[1];Math.sqrt((t.x-i)**2+(t.y-s)**2)<e.polygon.proximityThreshold&&e.polygon.currentPoints.value.length>=6?fa(e):(e.polygon.currentPoints.value.push(t.x,t.y),Ts(e))}Ts(e)}else if(e.polygon.mode.value==="edit"){const i=Array.from(Pt(e).values()).map(s=>{const o=s.konvaShape,r=o?o.getAbsoluteTransform():null,a=[];for(let l=0;l<s.points.length;l+=2)if(r){const c=r.point({x:s.points[l],y:s.points[l+1]});a.push({x:c.x,y:c.y})}else a.push({x:s.points[l],y:s.points[l+1]});return{points:a}});if(i.length>0){const s=Bu(i,t);if(s.polygonIndex>=0&&s.distance<e.polygon.proximityThreshold*2){const o=Array.from(Pt(e).keys())[s.polygonIndex],r=Pt(e).get(o);r&&r.konvaShape&&rn(e,"Add Polygon Point",()=>{const a=r.points,l=(s.lineIndex+1)*2,c=a[s.lineIndex*2],d=a[s.lineIndex*2+1],f=a[(s.lineIndex+1)*2%a.length],p=a[((s.lineIndex+1)*2+1)%a.length],h=(c+f)/2,g=(d+p)/2;r.points.splice(l,0,h,g),r.konvaShape.points(r.points),Fn(e),on(e),n?.getLayer()?.batchDraw(),It(e)})}}}}},qu=e=>{!e.polygon.isDrawing.value||e.polygon.mode.value!=="draw"||Ts(e)},Yu=e=>{const t=e.groups.polygonPreview,n=e.groups.polygonControls,i=e.stage;if(!t||!i||Pt(e).size===0)return;const s=i.getPointerPosition();if(!s)return;const o=i.getIntersection(s);if(o&&o.getParent()===n){t.destroyChildren(),t.getLayer()?.batchDraw();return}const r=Array.from(Pt(e).values()).map(a=>{const l=a.konvaShape,c=l?l.getAbsoluteTransform():null,d=[];for(let f=0;f<a.points.length;f+=2)if(c){const p=c.point({x:a.points[f],y:a.points[f+1]});d.push({x:p.x,y:p.y})}else d.push({x:a.points[f],y:a.points[f+1]});return{points:d}});if(r.length>0){const a=Bu(r,s);if(t.destroyChildren(),a.polygonIndex>=0&&a.distance<20){const l=Array.from(Pt(e).values())[a.polygonIndex],c=l.points,d=l.konvaShape,f=d?d.getAbsoluteTransform():null,p=c[a.lineIndex*2],h=c[a.lineIndex*2+1],g=c[(a.lineIndex+1)*2%c.length],v=c[((a.lineIndex+1)*2+1)%c.length],b=f?f.point({x:p,y:h}):{x:p,y:h},C=f?f.point({x:g,y:v}):{x:g,y:v},m=(b.x+C.x)/2,u=(b.y+C.y)/2,y=new X.Line({points:[b.x,b.y,C.x,C.y],stroke:"#00ff00",strokeWidth:4,opacity:.8});t.add(y);const S=new X.Circle({x:m,y:u,radius:5,fill:"#00ff00",stroke:"#00aa00",strokeWidth:2,opacity:.9});t.add(S)}t.getLayer()?.batchDraw()}},Ts=e=>{const t=e.groups.polygonPreview,n=e.stage;if(!t||!n)return;if(t.destroyChildren(),e.polygon.currentPoints.value.length<4){if(e.polygon.currentPoints.value.length===2){const r=new X.Circle({x:e.polygon.currentPoints.value[0],y:e.polygon.currentPoints.value[1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});t.add(r)}t.getLayer()?.batchDraw();return}const i=n.getPointerPosition();if(!i)return;for(let r=0;r<e.polygon.currentPoints.value.length;r+=2){const a=new X.Circle({x:e.polygon.currentPoints.value[r],y:e.polygon.currentPoints.value[r+1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});t.add(a)}const s=[...e.polygon.currentPoints.value,i.x,i.y],o=new X.Line({points:s,stroke:"#999",strokeWidth:2,fill:"rgba(153, 153, 153, 0.1)",closed:!1,dash:[5,5],listening:!1});if(t.add(o),e.polygon.currentPoints.value.length>=6){const r=e.polygon.currentPoints.value[0],a=e.polygon.currentPoints.value[1],l=Math.sqrt((i.x-r)**2+(i.y-a)**2),c=new X.Circle({x:r,y:a,radius:e.polygon.proximityThreshold,stroke:l<e.polygon.proximityThreshold?"#00ff00":"#ff0000",strokeWidth:2,fill:"transparent",listening:!1});t.add(c)}t.getLayer()?.batchDraw()},fa=e=>{const t=e.groups.polygonShapes,n=e.groups.polygonPreview;e.polygon.currentPoints.value.length<6||rn(e,"Create Polygon",()=>{const i=`polygon-${Date.now()}`,s={id:i,points:[...e.polygon.currentPoints.value],closed:!0,creationTime:Date.now()},o=new X.Line({points:s.points,stroke:"#000",strokeWidth:2,fill:"rgba(0, 100, 255, 0.1)",closed:!0,draggable:!1,id:i});Ps(e,o),s.konvaShape=o,Pt(e).set(i,s),t?.add(o),Bo(e,o),e.polygon.isDrawing.value=!1,e.polygon.currentPoints.value=[],n?.destroyChildren(),Fn(e),on(e),t?.getLayer()?.batchDraw(),n?.getLayer()?.batchDraw(),It(e)})},Xu=e=>{const t=e.groups.polygonPreview;e.polygon.isDrawing.value=!1,e.polygon.currentPoints.value=[],t?.destroyChildren(),t?.getLayer()?.batchDraw()},Fn=e=>{const t=e.groups.polygonControls,n=e.groups.polygonShapes;t&&(t.destroyChildren(),e.polygon.mode.value==="edit"&&Pt(e).forEach(i=>{i.controlPoints=[];for(let s=0;s<i.points.length;s+=2){const o=s,r=i.points[o],a=i.points[o+1];let l=r,c=a;if(i.konvaShape){const p=i.konvaShape.getAbsoluteTransform().point({x:r,y:a});l=p.x,c=p.y}const d=new X.Circle({x:l,y:c,radius:6,fill:"#ff6600",stroke:"#ff4400",strokeWidth:2,draggable:!0,id:`${i.id}-control-${o/2}`});d.on("mouseenter",()=>{d.fill("#ffaa00"),d.radius(8),t?.getLayer()?.batchDraw()}),d.on("mouseleave",()=>{d.fill("#ff6600"),d.radius(6),t?.getLayer()?.batchDraw()}),d.on("contextmenu",f=>{f.evt.preventDefault()}),d.on("mousedown",f=>{const p=f.evt;if(p.button===0&&(p.ctrlKey||p.metaKey)){if(p.preventDefault(),i.points.length<=6){Hp(e,"Cannot delete point: polygon must have at least 3 points");return}rn(e,"Delete Polygon Point",()=>{i.points.splice(o,2),i.konvaShape&&(i.konvaShape.points(i.points),n?.getLayer()?.batchDraw()),Fn(e),on(e),It(e)}),f.cancelBubble=!0}}),d.on("dragstart",()=>{da(e)}),d.on("dragmove",()=>{const f={x:d.x(),y:d.y()};if(i.konvaShape){const p=i.konvaShape.getAbsoluteTransform().copy();p.invert();const h=p.point(f);i.points[o]=h.x,i.points[o+1]=h.y}else i.points[o]=f.x,i.points[o+1]=f.y;i.konvaShape&&(i.konvaShape.points(i.points),n?.getLayer()?.batchDraw())}),d.on("dragend",()=>{ua(e,"Polygon Control Point"),on(e)}),i.controlPoints.push(d),t.add(d)}}),t.getLayer()?.batchDraw())},Zu=e=>He(()=>e.polygon.mode.value,t=>{const n=e.groups.polygonControls,i=e.groups.polygonPreview;if(e.activeTool.value!=="polygon"){n?.destroyChildren(),n?.getLayer()?.batchDraw();return}la(e),t==="draw"?(e.polygon.isDrawing.value=!1,e.polygon.currentPoints.value=[],i?.destroyChildren(),i?.getLayer()?.batchDraw(),Pt(e).forEach(s=>{s.konvaShape?.draggable(!1)})):t==="edit"&&(i?.destroyChildren(),i?.getLayer()?.batchDraw(),Pt(e).forEach(s=>{s.konvaShape?.draggable(!1)})),Fn(e),la(e)}),Ju=Object.freeze(Object.defineProperty({__proto__:null,attachPolygonHandlers:Ps,clearCurrentPolygon:Xu,clearPolygonSelection:la,deserializePolygonState:ha,finishPolygon:fa,finishPolygonDragTracking:ua,generateBakedPolygonData:ju,getCurrentPolygonState:ca,getCurrentPolygonStateString:Jn,handlePolygonClick:Ku,handlePolygonEditMouseMove:Yu,handlePolygonMouseMove:qu,initPolygonLayers:Hu,restorePolygonState:Wu,serializePolygonState:on,setupPolygonModeWatcher:Zu,startPolygonDragTracking:da,updateBakedPolygonData:It,updatePolygonControlPoints:Fn,updatePolygonPreview:Ts},Symbol.toStringTag,{value:"Module"})),dy=(e,t)=>{const n=e.layers.drawing,i=e.layers.overlay;if(!n||!i){console.warn("Cannot initialize circle groups without required layers");return}if(!e.groups.circleShapes){const s=new X.Group({name:"circle-shapes"});e.groups.circleShapes=s,n.add(s)}if(!e.groups.circlePreview){const s=new X.Group({name:"circle-preview"});e.groups.circlePreview=s,i.add(s)}},pa=(e,t)=>{console.log("Attaching circle handlers to:",t.id()),t.draggable(!1)},Qu=e=>os(e,()=>{const t=e.groups.circleShapes;if(!e.stage||!t)return null;try{const i=t.toObject(),s=Array.from(e.circle.shapes.entries()).map(([r,a])=>[r,{id:a.id,x:a.shape?.x()??a.x,y:a.shape?.y()??a.y,r:a.shape?.radius()??a.r,creationTime:a.creationTime}]);return{layer:i,circles:s}}catch(i){return console.warn("Failed to get current circle state:",i),null}}),ga=e=>{const t=Qu(e);return JSON.stringify(t)},uy=(e,t)=>{if(t)try{hy(e,t)}catch(n){console.warn("Failed to restore circle state:",n)}},Es=e=>{const t=e.groups.circleShapes;if(!(!e.stage||!t))try{const i=Qu(e);if(!i)return;e.circle.serializedState=JSON.stringify(i),e.callbacks.syncAppState?.(e),console.log("Serialized circle state:",{layerChildren:i.layer?.children?.length||0,circles:i.circles.length})}catch(i){console.warn("Failed to serialize circle state:",i)}},hy=(e,t)=>{const n=e.groups.circleShapes,i=e.stage;if(!(!t||!i||!n))try{const s=JSON.parse(t);console.log("Deserializing circle state:",{layerChildren:s.layer?.children?.length||0,circles:s.circles?.length||0}),n.destroyChildren(),e.circle.shapes.clear(),vt(e);const o=s.layer;o&&o.children&&(console.log("Restoring",o.children.length,"circle shapes"),o.children.forEach((a,l)=>{console.log("Creating circle node",l,"of type",a.className);const c=X.Node.create(a);n.add(c),console.log("Added circle node to layer:",c.id(),c.isVisible()),c instanceof X.Group&&hs(e,c)}));const r=n.find("Circle");e.circle.shapes.clear(),r.forEach(a=>{a.id()||a.id(sn("circle_"));const l={id:a.id(),x:a.x(),y:a.y(),r:a.radius(),creationTime:a.getAttr("creationTime")??Date.now(),shape:a};e.circle.shapes.set(l.id,l),pa(e,a),Ho(e,a)}),n.getLayer()?.batchDraw(),e.circle.serializedState=t,gr(e),console.log("Circle state restored from hotreload")}catch(s){console.warn("Failed to deserialize circle state:",s)}},fy=(e,t)=>{const n=e.groups.circlePreview;n&&(e.circle.isDrawing.value=!0,e.circle.currentCenter.value=t,e.circle.currentRadius.value=0,n.destroyChildren(),n.getLayer()?.batchDraw())},py=e=>{const t=e.groups.circlePreview,n=e.stage;if(!e.circle.isDrawing.value||!t||!n)return;const i=n.getPointerPosition();if(!i||!e.circle.currentCenter.value)return;const s=e.circle.currentCenter.value,o=Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2));e.circle.currentRadius.value=o,t.destroyChildren();const r=new X.Circle({x:s.x,y:s.y,radius:o,stroke:"#999",strokeWidth:2,dash:[5,5],listening:!1});t.add(r),t.getLayer()?.batchDraw()},gy=e=>{const t=e.groups.circleShapes,n=e.groups.circlePreview;if(!e.circle.isDrawing.value)return;const i=e.circle.currentCenter.value,s=e.circle.currentRadius.value;e.circle.isDrawing.value=!1,n?.destroyChildren(),n?.getLayer()?.batchDraw(),!(!i||s<2)&&rn(e,"Create Circle",()=>{const o=sn("circle_"),r=Date.now(),a={id:o,x:i.x,y:i.y,r:s,creationTime:r},l=new X.Circle({x:i.x,y:i.y,radius:s,stroke:"#000",strokeWidth:2,fill:"rgba(0, 100, 255, 0.1)",draggable:!1,id:o});l.setAttr("creationTime",r),pa(e,l),a.shape=l,Lo(e).set(o,a),t?.add(l),Ho(e,l),e.circle.currentCenter.value=null,e.circle.currentRadius.value=0,Es(e),t?.getLayer()?.batchDraw(),gr(e)})},my=e=>{const t=e.groups.circleShapes;if(!t)return{data:[],groupMap:{}};let n=0;const i={},s=r=>{if(r instanceof X.Circle){const a=r.radius(),l=r.getAbsoluteTransform(),c=l.point({x:0,y:0}),d=l.point({x:a,y:0}),f=l.point({x:0,y:a}),p=Math.hypot(d.x-c.x,d.y-c.y),h=Math.hypot(f.x-c.x,f.y-c.y),g=Math.atan2(d.y-c.y,d.x-c.x),v=r.getAttr("metadata"),C=Array.from(e.circle.shapes.values()).find(m=>m.shape===r)?.id||r.id();return v&&v.name&&typeof v.name=="string"&&(i[v.name]||(i[v.name]=[]),i[v.name].push(n)),n++,{type:"circle",id:C,center:{x:c.x,y:c.y},r:Math.abs(p-h)<.001?p:void 0,rx:p,ry:h,rotation:g,...v&&{metadata:v}}}else if(r instanceof X.Group){const a=n;r.getChildren().forEach(f=>{s(f)});const l=r.getAttr("metadata"),c=[];for(let f=a;f<n;f++)c.push(f);const d=l&&l.name&&typeof l.name=="string"?l.name:r.id();return d&&(i[d]=c),null}return null},o=[];return t.getChildren().forEach(r=>{const a=s(r);a&&o.push(a)}),{data:o,groupMap:i}},gr=e=>{const t=my(e);e.circle.bakedRenderData=t.data,e.circle.bakedGroupMap=t.groupMap,e.callbacks.syncAppState?.(e)},yy=(e,t)=>{const n=new X.Transformer({rotateEnabled:!0,keepRatio:!1,padding:6});e.layers.transformer=n,n.on("transformstart",()=>{by(e)});const i=()=>{const s=e.selection.selectedKonvaNodes.value;s.length===1&&fr(e,s[0])};return n.on("transformend",()=>{Sy(e,"Transform"),i()}),n.on("transform",i),n.on("dragmove",i),t.add(n),He(e.selection.selectedKonvaNodes,s=>{_y(e,s)},{immediate:!0}),n};function vy(e,t){yy(e,t)}function _y(e,t){const n=e.layers.transformer;if(!n)return;const i=t.filter(s=>!(s instanceof X.Line&&e.polygon.mode.value==="edit"&&e.activeTool.value==="polygon"));n.nodes(i),e.layers.overlay?.batchDraw()}function by(e){Promise.resolve().then(()=>Vu).then(({getCurrentFreehandStateString:t})=>{Promise.resolve().then(()=>Ju).then(({getCurrentPolygonStateString:n})=>{const i=JSON.stringify({freehand:t(e),polygon:n(e)});e.selection.transformStartState=i})})}function Sy(e,t){const n=e.selection.transformStartState;n&&Promise.resolve().then(()=>Vu).then(({getCurrentFreehandStateString:i})=>{Promise.resolve().then(()=>Ju).then(({getCurrentPolygonStateString:s})=>{const o=JSON.stringify({freehand:i(e),polygon:s(e)});n!==o&&ss(e,t,n,o),e.selection.transformStartState=""})})}function wy(e,t){e.groups.selectionOverlay=t;const n=e.stage??t.getStage();if(!e.layers.grid&&n){const i=new X.Layer({listening:!1,name:"grid-layer"});n.add(i),i.moveToBottom(),e.layers.grid=i}e.selection.selectionRect=new X.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),t.add(e.selection.selectionRect)}function xy(e,t,n){const i=t.getPointerPosition();if(!i)return;const s=o=>{let r=o;for(;r&&!(r instanceof X.Stage);){if(r instanceof X.Transformer)return!0;r=r.getParent()}return!1};if(!(n.target&&s(n.target))){if(n.target!==t){let o=n.target,r=ar(e,o);for(;o&&!(o instanceof X.Stage)&&(o=o.getParent(),!(!o||o instanceof X.Stage));){const a=ar(e,o);a&&(r=a)}if(r){const a=zd(e,r);n.evt.shiftKey?ig(e,r,!0):a||(vt(e),ls(e,r,!0)),zd(e,r)&&Ay(e,t);return}}(n.target===t||n.target instanceof X.Layer)&&(e.selection.dragSelectionState.value={isSelecting:!0,startPos:{x:i.x,y:i.y},currentPos:{x:i.x,y:i.y},isShiftHeld:n.evt.shiftKey},Py(e,i.x,i.y))}}function Cy(e,t,n){if(e.selection.selectionDragState.isDragging){Ry(e,t);return}if(!e.selection.dragSelectionState.value.isSelecting)return;const i=t.getPointerPosition();i&&(e.selection.dragSelectionState.value.currentPos={x:i.x,y:i.y},Ty(e))}function ky(e,t,n){if(e.selection.selectionDragState.isDragging){My(e);return}e.selection.dragSelectionState.value.isSelecting&&(Ey(e,e.selection.dragSelectionState.value.isShiftHeld),e.selection.dragSelectionState.value.isSelecting=!1)}function Py(e,t,n){e.selection.selectionRect&&e.selection.selectionRect.setAttrs({x:t,y:n,width:0,height:0,visible:!1})}function Ty(e){if(!e.selection.selectionRect||!e.selection.dragSelectionState.value.isSelecting)return;const{startPos:t,currentPos:n}=e.selection.dragSelectionState.value,i=Math.min(t.x,n.x),s=Math.min(t.y,n.y),o=Math.abs(n.x-t.x),r=Math.abs(n.y-t.y);e.selection.selectionRect.setAttrs({x:i,y:s,width:o,height:r,visible:o>5||r>5}),e.groups.selectionOverlay?.getLayer()?.batchDraw()}function Ey(e,t=!1){if(!e.selection.selectionRect)return;const{startPos:n,currentPos:i}=e.selection.dragSelectionState.value,s=Math.abs(i.x-n.x),o=Math.abs(i.y-n.y);if(!(s>=5||o>=5)){t||vt(e),e.selection.selectionRect.visible(!1),e.groups.selectionOverlay?.getLayer()?.batchDraw();return}const a=[],l=e.selection.selectionRect.getClientRect(),c=g=>g instanceof X.Transformer?!1:g instanceof X.Path||g instanceof X.Line||g instanceof X.Circle||g instanceof X.Group,d=[],f=e.groups.selectionOverlay?.getStage();f&&(e.groups.freehandShape&&d.push(e.groups.freehandShape),e.groups.polygonShapes&&d.push(e.groups.polygonShapes),e.groups.circleShapes&&d.push(e.groups.circleShapes),d.length===0&&f.getLayers().forEach(g=>{g.getChildren().some(b=>c(b))&&d.push(g)}));const p=g=>{const v=g.getClientRect();return!(l.x+l.width<v.x||v.x+v.width<l.x||l.y+l.height<v.y||v.y+v.height<l.y)},h=g=>{if(!c(g)){g instanceof X.Container&&g.getChildren().forEach(b=>h(b));return}const v=ar(e,g);if(v){p(g)&&a.push(v);return}g instanceof X.Container&&g.getChildren().forEach(b=>h(b))};d.forEach(g=>{g.getChildren().forEach(v=>{h(v)})}),t||(vt(e),na(e)),a.forEach(g=>ls(e,g,!0)),e.selection.selectionRect.setAttrs({x:0,y:0,width:0,height:0,visible:!1}),e.groups.selectionOverlay?.getLayer()?.batchDraw()}function Ay(e,t){const n=t.getPointerPosition();if(!n)return;e.selection.selectionDragState.isDragging=!0,e.selection.selectionDragState.startPos={x:n.x,y:n.y},e.selection.selectionDragState.startNodePositions.clear(),e.selection.selectionDragState.beforeState=JSON.stringify({freehand:vn(e),polygon:Jn(e),circle:ga(e)}),e.selection.selectedKonvaNodes.value.forEach(s=>{const o=s.getAbsolutePosition();e.selection.selectionDragState.startNodePositions.set(s,{x:o.x,y:o.y})})}function Ry(e,t){const n=t.getPointerPosition();if(!n)return;const i=n.x-e.selection.selectionDragState.startPos.x,s=n.y-e.selection.selectionDragState.startPos.y;e.selection.selectionDragState.startNodePositions.forEach((a,l)=>{l.absolutePosition({x:a.x+i,y:a.y+s})});const o=new Set;e.selection.selectionDragState.startNodePositions.forEach((a,l)=>{let c=l.getParent();for(;c&&!(c instanceof X.Layer);)c=c.getParent();c instanceof X.Layer&&o.add(c)}),o.forEach(a=>a.batchDraw());const r=e.selection.selectedKonvaNodes.value;r.length===1&&fr(e,r[0])}function My(e){const t=JSON.stringify({freehand:vn(e),polygon:Jn(e),circle:ga(e)});e.selection.selectionDragState.beforeState!==t&&ss(e,"Move Selection",e.selection.selectionDragState.beforeState,t),e.selection.selectionDragState.isDragging=!1,e.selection.selectionDragState.startNodePositions.clear();const n=e.selection.selectedKonvaNodes.value;n.length===1?fr(e,n[0]):fr(e,void 0)}function eh(e){return e.selection.selectedKonvaNodes.value}function th(e){let t=e;for(;t&&!(t instanceof X.Layer);)t=t.getParent();return t instanceof X.Layer?t:null}function nh(e,t){const n=e.getAbsoluteTransform().copy();e.moveTo(t);const i=t.getAbsoluteTransform().copy();i.invert();const o=i.multiply(n).decompose();e.setAttrs({x:o.x,y:o.y,scaleX:o.scaleX,scaleY:o.scaleY,rotation:o.rotation,skewX:o.skewX,skewY:o.skewY})}function ih(e){const t=eh(e);if(t.length<1||t.some(s=>s instanceof X.Line)||new Set(t.map(s=>th(s))).size!==1)return!1;const i=t.filter(s=>s instanceof X.Path||s instanceof X.Circle||s instanceof X.Group);return!(i.length<1||og(i))}function Dy(e){if(!ih(e))return;const t=e.selection.selectedKonvaNodes.value.filter(n=>n instanceof X.Path||n instanceof X.Circle||n instanceof X.Group);t.length<1||rn(e,"Group Selection",()=>{const n=t.filter(a=>!t.some(l=>l!==a&&l.isAncestorOf(a))),i=th(n[0]);if(!i)return;let s=n[0].getParent();n.every(a=>a.getParent()===s)||(s=i);const o=new X.Group({draggable:!1});s.add(o),n.forEach(a=>{nh(a,o)});const r=hs(e,o);vt(e),ls(e,r),o.getLayer()?.batchDraw(),Lt(e)})}function rh(e){const t=eh(e);return t.length!==1||t[0]instanceof X.Line?!1:t[0]instanceof X.Group}function Oy(e){if(!rh(e))return;const t=e.selection.selectedKonvaNodes.value[0],n=t.getParent();n&&rn(e,"Ungroup Selection",()=>{[...t.getChildren()].forEach(o=>{nh(o,n),o.draggable(!1)});const s=t.id();t.destroy(),Vd(e,s),vt(e),n.getLayer()?.batchDraw();try{sa(e)}catch{console.error("refreshStrokeConnections failed")}Lt(e)})}function sh(e){const t=e.selection.selectedKonvaNodes.value;return t.filter(n=>!t.some(i=>i!==n&&i.isAncestorOf(n)))}function Ny(e){const t=e.groups.freehandShape;e.selection.selectedKonvaNodes.value.length!==0&&rn(e,"Duplicate",()=>{os(e,()=>{const i=sh(e),s=[];i.forEach(o=>{if(o instanceof X.Path||o instanceof X.Group){const r=Du(e,o,50,50),a=o.getParent();a&&a.add(r),s.push(r)}else if(o instanceof X.Line){const r=o.clone({x:o.x()+50,y:o.y()+50}),a=sn("poly_");r.id(a);const l=o.getParent();l&&l.add(r),Bo(e,r),Ps(e,r),Pt(e).set(a,{id:a,points:[...r.points()],closed:!!r.closed(),creationTime:Date.now(),konvaShape:r}),s.push(r)}else if(o instanceof X.Circle){const r=o.clone({x:o.x()+50,y:o.y()+50}),a=sn("circle_"),l=Date.now();r.id(a),r.setAttr("creationTime",l);const c=o.getParent();c&&c.add(r),Ho(e,r),pa(e,r),Lo(e).set(a,{id:a,x:r.x(),y:r.y(),r:r.radius(),creationTime:l,shape:r}),s.push(r)}}),vt(e),s.forEach(o=>{const r=ar(e,o);r&&ls(e,r,!0)}),ks(e),t?.getLayer()?.batchDraw(),e.groups.polygonShapes?.getLayer()?.batchDraw(),e.groups.circleShapes?.getLayer()?.batchDraw(),Lt(e),It(e),gr(e),on(e),Es(e)})})}function Fy(e){const t=e.groups.freehandShape;e.selection.selectedKonvaNodes.value.length!==0&&rn(e,"Delete Selected",()=>{sh(e).forEach(s=>{const o=[],r=a=>{o.push(a),a instanceof X.Container&&a.getChildren().forEach(l=>r(l))};r(s),o.forEach(a=>{a instanceof X.Path&&(yt(e).delete(a.id()),Array.from(yt(e).entries()).forEach(([l,c])=>{c.shape===a&&yt(e).delete(l)}),Array.from(Fo(e).values()).forEach(l=>{l.strokeIds=l.strokeIds.filter(c=>c!==a.id())})),a instanceof X.Group&&Fo(e).delete(a.id()),a instanceof X.Line&&Pt(e).delete(a.id()),a instanceof X.Circle&&Lo(e).delete(a.id()),Vd(e,a.id())}),s.destroy()}),vt(e),t?.getLayer()?.batchDraw(),e.groups.polygonShapes?.getLayer()?.batchDraw(),e.groups.circleShapes?.getLayer()?.batchDraw(),Lt(e),It(e),gr(e),on(e),Es(e),Promise.resolve().then(()=>Am).then(({refreshAnciliaryViz:s})=>s(e)).catch(()=>{})})}const ma=e=>{if(!e)return null;try{return JSON.parse(e)}catch(t){return console.warn("Failed to parse state string:",t),null}},Ly=e=>{if(!e||typeof e!="object")return{};if("freehand"in e||"polygon"in e||"circle"in e){const t={};return e.freehand!==void 0&&(t.freehand=typeof e.freehand=="string"?e.freehand:JSON.stringify(e.freehand)),e.polygon!==void 0&&(t.polygon=typeof e.polygon=="string"?e.polygon:JSON.stringify(e.polygon)),e.circle!==void 0&&(t.circle=typeof e.circle=="string"?e.circle:JSON.stringify(e.circle)),t}return"layer"in e&&(e.strokes||e.strokeGroups)?{freehand:JSON.stringify(e)}:"layer"in e&&(e.polygons||e.polygonGroups)?{polygon:JSON.stringify(e)}:"layer"in e&&e.circles?{circle:JSON.stringify(e)}:{}},oh=e=>{const t=vn(e),n=Jn(e),i=ga(e),s=ma(t),o=ma(n),r=ma(i);return JSON.stringify({version:1,freehand:s,polygon:o,circle:r})},ah=(e,t,n={})=>{if(!t)return!1;let i;try{i=JSON.parse(t)}catch(a){return console.warn("Failed to parse canvas state JSON:",a),!1}const{freehand:s,polygon:o,circle:r}=Ly(i);return!s&&!o&&!r?(console.warn("Canvas state payload missing freehand, polygon, and circle data"),!1):(s&&zu(e,s,{handleTimeUpdate:n.handleTimeUpdate}),o&&Wu(e,o),r&&uy(e,r),!0)},Iy=(e,t)=>{const n=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)},Gy=e=>{const t=oh(e);if(!t){console.warn("No canvas state available to download");return}let n=t;try{n=JSON.stringify(JSON.parse(t),null,2)}catch(s){console.warn("Failed to pretty-print canvas state JSON:",s)}const i=new Date().toISOString().slice(0,16).replace(/:/g,"-");Iy(n,`canvas_state_${i}.json`)},zy=(e,t={})=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=async i=>{const s=i.target.files?.[0];if(s)try{const o=await s.text();if(!ah(e,o,t)){alert("Invalid canvas state file. Please upload a valid JSON export.");return}console.log("Canvas state restored from file:",s.name)}catch(o){console.error("Failed to restore canvas state from file:",o),alert("Failed to load canvas state. Please check the console for details.")}},n.click()},Uy={class:"canvas-root"},$y={class:"control-panel"},Vy=["disabled"],By={class:"button-group vertical"},Hy=["disabled"],jy=["disabled"],Wy=["disabled"],Ky={class:"button-group vertical"},qy=["disabled"],Yy=["disabled"],Xy={class:"button-group vertical"},Zy=["disabled"],Jy=["disabled"],Qy={class:"button-group vertical"},ev=["disabled"],tv=["disabled"],nv=["disabled"],iv=["disabled"],rv={class:"radio-button-group"},sv=["disabled"],ov=["disabled"],av={class:"button-group vertical"},lv=["disabled"],cv=["disabled"],dv={key:0,class:"info"},uv={key:0,class:"info"},hv={class:"info"},fv={class:"canvas-wrapper"},pv={key:0,class:"panels-container"},gv={key:1,class:"metadata-suite"},mv={key:0,class:"animation-lock-warning"},yv={key:0,class:"notification-toast"},vv=20,_v=mn(Zt({__name:"CanvasRoot",props:{syncState:{type:Function},initialFreehandState:{default:"",type:String},initialPolygonState:{default:"",type:String},width:{default:1e3,type:[Number,String]},height:{default:500,type:[Number,String]},showTimeline:{type:Boolean,default:!1},showVisualizations:{type:Boolean,default:!1},showSnapshots:{type:Boolean,default:!1},metadataSchemas:{default:()=>[],type:Array}},emits:["state-update"],setup(e,{expose:t,emit:n}){const i=e,s=n,o=xe(()=>{const ne=Number(i.width),K=Number(i.height);return{width:Number.isFinite(ne)?ne:1e3,height:Number.isFinite(K)?K:500}}),r=Bp();r.metadataSchemas=i.metadataSchemas;const a=ay(r);let l;const c=r.activeTool,d=r.metadata.showEditor,f=r.snapshots.showPanel,p=r.snapshots.items,h=r.snapshots.selectedId,g=ge(!1),v=ne=>ne==null?ne:typeof structuredClone=="function"?structuredClone(ne):JSON.parse(JSON.stringify(ne)),b=ne=>ne?v(Pe(ne))??[]:[],C=ne=>ne?v(Pe(ne))??[]:[],m=ne=>ne?v(Pe(ne))??{}:{},u=ge(null),y=()=>({freehand:{serializedState:"",bakedRenderData:[],bakedGroupMap:{}},polygon:{serializedState:"",bakedRenderData:[]},circle:{serializedState:"",bakedRenderData:[],bakedGroupMap:{}}}),S=ne=>{const K=b(ne.freehand.bakedRenderData),ye=m(ne.freehand.bakedGroupMap),De=C(ne.polygon.bakedRenderData),je=v(Pe(ne.circle.bakedRenderData))??[],at=m(ne.circle.bakedGroupMap);return{freehand:{serializedState:ne.freehand.serializedState??"",bakedRenderData:K??[],bakedGroupMap:ye??{}},polygon:{serializedState:ne.polygon.serializedState??"",bakedRenderData:De??[]},circle:{serializedState:ne.circle.serializedState??"",bakedRenderData:je??[],bakedGroupMap:at??{}}}},A=(ne,K)=>{const ye=y(),De=y(),je=y(),at=["freehand.bakedRenderData","polygon.bakedRenderData","circle.bakedRenderData"],rt=(Be,lt,ve)=>{lt==="freehand.bakedRenderData"?Be.freehand.bakedRenderData.push(ve):lt==="polygon.bakedRenderData"?Be.polygon.bakedRenderData.push(ve):lt==="circle.bakedRenderData"&&Be.circle.bakedRenderData.push(ve)},Je=Be=>Be==="freehand.bakedRenderData"?K.freehand.bakedRenderData:Be==="polygon.bakedRenderData"?K.polygon.bakedRenderData:K.circle.bakedRenderData,Bt=(Be,lt="")=>{const ve=lt?`${lt}.${Be.key}`:Be.key;if(at.includes(ve)&&Be.changes){const Me=ve,Xe=Je(Me);for(const Ue of Be.changes)if(Ue.type==="ADD"){const ut=Ue.value??Ue.oldValue;ut&&rt(ye,Me,ut)}else if(Ue.type==="REMOVE"){const ut=Ue.value??Ue.oldValue;ut&&rt(De,Me,ut)}else if(Ue.type==="UPDATE"){const ut=Ue.key,Ht=Xe.find(jt=>jt.id===ut);Ht&&rt(je,Me,Ht)}}else if(Be.changes)for(const Me of Be.changes)Bt(Me,ve)};for(const Be of ne)Bt(Be);return{added:ye,deleted:De,changed:je}},M=ne=>{const K=S(ne),ye={embeddedObjKeys:{"freehand.bakedRenderData":"id","freehand.bakedRenderData.children":"id","polygon.bakedRenderData":"id","circle.bakedRenderData":"id"}},De=u.value,je=De?Kp(De,K,ye):[],{added:at,deleted:rt,changed:Je}=De?A(je,K):{added:y(),deleted:y(),changed:y()};return u.value=v(K),{...K,added:at,deleted:rt,changed:Je}},x=ne=>{const K=M(ne);i.syncState?.(K),s("state-update",K)};r.callbacks.syncAppState=x,He(()=>i.syncState,()=>{x(r)},{immediate:!0});const w=ne=>wy(r,ne),k=(ne,K)=>xy(r,ne,K),T=(ne,K)=>Cy(r,ne),R=(ne,K)=>ky(r),I=()=>Dy(r),$=()=>Oy(r),z=()=>Ny(r),q=()=>Fy(r),_=xe(()=>ih(r)),P=xe(()=>rh(r)),N=(ne,K)=>$u(r,ne,K),O=()=>ks(r),G=()=>na(r),H=ne=>aa(r,ne),V=()=>Gy(r),Q=()=>zy(r,{handleTimeUpdate:H}),se=()=>Fn(r),F=ne=>Ku(r,ne),E=()=>qu(r),U=()=>Yu(r),j=()=>fa(r),ee=()=>Xu(r),he=()=>Zu(r),D=ne=>fy(r,ne),L=()=>py(r),B=()=>gy(r),W=r.selection.selectedKonvaNodes,Z=xe(()=>rg(r)),Y=xe(()=>cs(r)>1),ie=xe(()=>{const ne=W.value;return ne.length===1&&ne[0]instanceof X.Group});r.callbacks.refreshAncillaryViz=()=>Nn(r);const oe=()=>oh(r),re=ne=>{if(!ne)return;ah(r,ne,{handleTimeUpdate:H})||console.warn("Failed to restore canvas state: invalid payload")},te=ge(!1),de=ge(!1),le=()=>{Lt(r),It(r),gr(r),Nn(r),te.value=ue.canUndo(),de.value=ue.canRedo()},ue=new Vp(oe,re,le);r.command.stack=ue,te.value=ue.canUndo(),de.value=ue.canRedo();const pe=(ne,K)=>ue.executeCommand(ne,K),_e=()=>ue.undo(),Ee=()=>ue.redo();r.command.executeCommand=pe,r.command.pushCommand=(ne,K,ye)=>{ue.pushCommand(ne,K,ye)};const we=ne=>{r.freehand.isAnimating.value=ne;const K=r.stage;K&&(ne?K.listening(!1):K.listening(!0))};t({canvasState:r});const Le=()=>{const ne=r.stage,K=r.layers.grid;if(!ne||!K)return;const ye=!!r.grid.visible.value;if(K.visible(ye),K.destroyChildren(),!ye){K.batchDraw();return}const De=r.grid.size,je=Number.isFinite(De)&&De>0?De:vv,at=5,rt=ne.width(),Je=ne.height(),Bt=Math.ceil(rt/je),Be=Math.ceil(Je/je),lt=(ve,Me)=>{K.add(new X.Line({points:ve,stroke:Me?"rgba(0, 0, 0, 0.2)":"rgba(0, 0, 0, 0.08)",strokeWidth:Me?1:.5,listening:!1}))};for(let ve=0;ve<=Bt;ve++){const Me=Math.min(ve*je,rt),Xe=ve%at===0;lt([Me,0,Me,Je],Xe)}for(let ve=0;ve<=Be;ve++){const Me=Math.min(ve*je,Je),Xe=ve%at===0;lt([0,Me,rt,Me],Xe)}K.batchDraw()},Ce=ge(),Ie=(ne,K)=>{const ye=ne.groups.freehandShape,De=ne.groups.freehandDrawing,je=ne.groups.selectionOverlay,at=ne.groups.polygonShapes,rt=ne.groups.polygonPreview,Je=ne.groups.polygonControls,Bt=ne.groups.polygonSelection,Be=ne.groups.circleShapes,lt=ne.groups.circlePreview,ve=ne.stage;vt(ne),K==="select"?(ye?.listening(!0),at?.listening(!0),Be?.listening(!0),De?.listening(!1),rt?.listening(!1),Je?.listening(!1),lt?.listening(!1),je?.listening(!0),Bt?.listening(!0),ne.layers.overlay?.moveToTop(),ve&&Mu(r,ve).moveToTop()):K==="freehand"?(ye?.listening(!0),De?.listening(!0),je?.listening(!0),at?.listening(!1),rt?.listening(!1),Je?.listening(!1),Bt?.listening(!1),Be?.listening(!1),lt?.listening(!1)):K==="polygon"?(at?.listening(!0),rt?.listening(!0),Je?.listening(!0),Bt?.listening(!0),ye?.listening(!1),De?.listening(!1),je?.listening(!1),Be?.listening(!1),lt?.listening(!1)):K==="circle"&&(Be?.listening(!0),lt?.listening(!0),ye?.listening(!1),De?.listening(!1),je?.listening(!1),at?.listening(!1),rt?.listening(!1),Je?.listening(!1),Bt?.listening(!1)),K==="polygon"&&ne.polygon.mode.value==="edit"?se():(Je?.destroyChildren(),Je?.getLayer()?.batchDraw()),(Xe=>{ye?.getChildren().forEach(Ue=>{(Ue instanceof X.Path||Ue instanceof X.Group)&&Ue.draggable(Xe)}),at?.getChildren().forEach(Ue=>{(Ue instanceof X.Line||Ue instanceof X.Group)&&Ue.draggable(Xe)})})(!1),ve?.batchDraw()};He(c,ne=>{Ie(r,ne)},{immediate:!0});const it=(ne,K)=>{try{const ye=ar(r,ne);ye?sg(r,ye,K):(ne.setAttr("metadata",K===void 0||Object.keys(K).length===0?void 0:K),Lt(r),It(r))}catch{ne.setAttr("metadata",K===void 0||Object.keys(K).length===0?void 0:K),Lt(r),It(r)}};return Vr(async()=>{try{if(!Ce.value){console.error("Konva container ref not found");return}const ne=o.value,K=new X.Stage({container:Ce.value,width:ne.width,height:ne.height});r.stage=K,r.konvaContainer=Ce.value;const ye=K.getPointerPosition.bind(K);K.getPointerPosition=function(){const ve=ye();if(!ve)return null;const Me=this.container(),Xe=Me.clientWidth,Ue=Me.clientHeight,ut=this.width(),Ht=this.height();return{x:ve.x*(ut/Xe),y:ve.y*(Ht/Ue)}},Ce.value.addEventListener("contextmenu",ve=>{(ve.ctrlKey||ve.metaKey)&&ve.preventDefault()});const De=()=>{Ce.value&&(Ce.value.style.cursor=c.value==="freehand"?"crosshair":"default")};r.callbacks.updateCursor=De,r.callbacks.updateCursor?.();const je=new X.Layer({listening:!1,name:"grid-layer"}),at=new X.Layer({name:"drawing-layer"}),rt=new X.Layer({name:"overlay-layer"});K.add(je),K.add(at),K.add(rt),je.moveToBottom(),r.layers.grid=je,r.layers.drawing=at,r.layers.overlay=rt,Ou(r,K),Hu(r,K),dy(r,K);const Je=new X.Group({name:"selection-overlay"});rt.add(Je),w(Je),vy(r,Je),Le(),Mu(r,K).moveToTop(),xu(r),Ie(r,c.value),c.value==="polygon"&&r.polygon.mode.value==="edit"&&se(),r.callbacks.updateCursor?.();const Be=ve=>{!ve||ve===r.freehand.serializedState||oa(r,ve)},lt=ve=>{!ve||ve===r.polygon.serializedState||ha(r,ve)};Be(i.initialFreehandState),lt(i.initialPolygonState),He(()=>i.initialFreehandState,ve=>{Be(ve)}),He(()=>i.initialPolygonState,ve=>{lt(ve)}),He(()=>r.grid.visible.value,()=>{Le()},{immediate:!0}),He(()=>r.layers.grid,()=>{Le()},{immediate:!0}),He(()=>[i.width,i.height],([ve,Me])=>{const Xe=Number(ve),Ue=Number(Me),ut=Number.isFinite(Xe)?Xe:o.value.width,Ht=Number.isFinite(Ue)?Ue:o.value.height,jt=r.stage;jt&&(jt.width(ut),jt.height(Ht),jt.batchDraw()),r.konvaContainer&&(r.konvaContainer.style.width=`${ut}px`,r.konvaContainer.style.height=`${Ht}px`),Le()},{immediate:!0}),Ie(r,c.value),x(r),K.on("mousedown touchstart",ve=>{const Me=K.getPointerPosition();Me&&(c.value==="select"?k(K,ve):c.value==="freehand"?(r.freehand.isDrawing=!0,r.freehand.currentPoints=[Me.x,Me.y],r.freehand.drawingStartTime=performance.now(),r.freehand.currentTimestamps=[0],vt(r)):c.value==="polygon"?ve.target.getParent?.()===r.groups.polygonControls||F(Me):c.value==="circle"&&(D(Me),vt(r)))}),K.on("mousemove touchmove",ve=>{const Me=r.groups.freehandDrawing;if(c.value==="select")T(K,ve);else if(c.value==="freehand"){if(r.freehand.isDrawing){const Xe=K.getPointerPosition();if(!Xe)return;r.freehand.currentPoints.push(Xe.x,Xe.y),r.freehand.currentTimestamps.push(performance.now()-r.freehand.drawingStartTime),Me?.destroyChildren();const Ue=new X.Path({data:pr(r.freehand.currentPoints),fill:"#666",strokeWidth:0});Me?.add(Ue),Me?.getLayer()?.batchDraw()}}else c.value==="polygon"?r.polygon.mode.value==="draw"&&r.polygon.isDrawing.value?E():r.polygon.mode.value==="edit"&&U():c.value==="circle"&&r.circle.isDrawing.value&&L()}),K.on("mouseup touchend",ve=>{const Me=r.groups.freehandDrawing;c.value==="freehand"&&r.freehand.isDrawing?(r.freehand.isDrawing=!1,Me?.destroyChildren(),r.freehand.currentPoints.length>2&&pe("Draw Stroke",()=>{const Xe=r.groups.freehandShape,Ue=Date.now(),ut=`stroke-${Ue}`,Ht=ds(r.freehand.currentPoints),jt=[];for(let As=0;As<r.freehand.currentPoints.length;As+=2)jt.push(r.freehand.currentPoints[As]-Ht.minX),jt.push(r.freehand.currentPoints[As+1]-Ht.minY);const bv=pr(jt),ch={id:ut,points:r.freehand.currentPoints,timestamps:r.freehand.currentTimestamps,originalPath:bv,creationTime:Ue,isFreehand:!0},dh=N(r.freehand.currentPoints,ut);ch.shape=dh,yt(r).set(ut,ch),Xe?.add(dh),O(),G(),Xe?.getLayer()?.batchDraw(),Lt(r)}),r.freehand.currentPoints=[],r.freehand.currentTimestamps=[]):c.value==="circle"&&r.circle.isDrawing.value?B():R(K,ve)}),he(),Ce.value?.focus(),l=cg(r,"c",()=>{c.value==="polygon"&&r.polygon.isDrawing.value&&(r.polygon.currentPoints.value.length>=6?j():ee())},Ce.value)}catch(ne){console.warn(ne)}}),ui(()=>{console.log("disposing livecoded resources"),Uu(r),on(r),Es(r),l?.(),l=void 0,r.keyboardDisposables.splice(0).forEach(ne=>ne()),r.stage?.destroy()}),(ne,K)=>(ae(),ce("div",Uy,[J("div",$y,[eo(J("select",{"onUpdate:modelValue":K[0]||(K[0]=ye=>Qe(c)?c.value=ye:null),disabled:fe(r).freehand.isAnimating.value,class:"tool-dropdown"},K[10]||(K[10]=[J("option",{value:"select"}," Select",-1),J("option",{value:"freehand"}," Freehand",-1),J("option",{value:"polygon"}," Polygon",-1),J("option",{value:"circle"}," Circle",-1)]),8,Vy),[[K0,fe(c)]]),K[18]||(K[18]=J("span",{class:"separator"},"|",-1)),J("div",By,[J("button",{onClick:_e,disabled:!te.value||fe(r).freehand.isAnimating.value,title:"Undo (Ctrl/Cmd+Z)"},"  Undo ",8,Hy),J("button",{onClick:Ee,disabled:!de.value||fe(r).freehand.isAnimating.value,title:"Redo (Ctrl/Cmd+Shift+Z)"},"  Redo ",8,jy)]),K[19]||(K[19]=J("span",{class:"separator"},"|",-1)),J("button",{onClick:K[1]||(K[1]=ye=>fe(r).grid.visible.value=!fe(r).grid.visible.value),class:Rt({active:fe(r).grid.visible.value}),disabled:fe(r).freehand.isAnimating.value},Fe(fe(r).grid.visible.value?" Grid On":" Grid Off"),11,Wy),K[20]||(K[20]=J("span",{class:"separator"},"|",-1)),J("div",Ky,[J("button",{onClick:V,disabled:fe(r).freehand.isAnimating.value},"  Download ",8,qy),J("button",{onClick:Q,disabled:fe(r).freehand.isAnimating.value},"  Upload ",8,Yy)]),K[21]||(K[21]=J("span",{class:"separator"},"|",-1)),K[22]||(K[22]=J("span",{class:"flex-break","aria-hidden":"true"},null,-1)),fe(c)==="select"?(ae(),ce(Re,{key:0},[J("div",Xy,[J("button",{onClick:I,disabled:!_.value||fe(r).freehand.isAnimating.value}," Group ",8,Zy),J("button",{onClick:$,disabled:!P.value||fe(r).freehand.isAnimating.value}," Ungroup ",8,Jy)]),K[11]||(K[11]=J("span",{class:"separator"},"|",-1)),J("div",Qy,[J("button",{onClick:z,disabled:cs(fe(r))===0||fe(r).freehand.isAnimating.value},"  Duplicate ",8,ev),J("button",{onClick:q,disabled:cs(fe(r))===0||fe(r).freehand.isAnimating.value},"  Delete ",8,tv)]),K[12]||(K[12]=J("span",{class:"separator"},"|",-1)),J("button",{onClick:K[2]||(K[2]=ye=>d.value=!fe(d)),class:Rt({active:fe(d)}),disabled:fe(r).freehand.isAnimating.value},"  Metadata ",10,nv),i.showSnapshots?(ae(),ce("button",{key:0,onClick:K[3]||(K[3]=ye=>f.value=!fe(f)),class:Rt({active:fe(f)}),disabled:fe(r).freehand.isAnimating.value},"  Snapshots ",10,iv)):Ne("",!0),K[13]||(K[13]=J("span",{class:"separator"},"|",-1))],64)):Ne("",!0),fe(c)==="freehand"?(ae(),ce(Re,{key:1},[i.showTimeline?(ae(),ce("button",{key:0,onClick:K[4]||(K[4]=ye=>fe(r).freehand.useRealTiming.value=!fe(r).freehand.useRealTiming.value),class:Rt({active:fe(r).freehand.useRealTiming.value})},Fe(fe(r).freehand.useRealTiming.value?" Real Time":" Max 0.3s"),3)):Ne("",!0)],64)):Ne("",!0),fe(c)==="polygon"?(ae(),ce(Re,{key:2},[J("div",rv,[J("button",{onClick:K[5]||(K[5]=ye=>fe(r).polygon.mode.value="draw"),class:Rt([{active:fe(r).polygon.mode.value==="draw"},"radio-button"]),disabled:fe(r).freehand.isAnimating.value},K[14]||(K[14]=[J("span",{class:"radio-indicator"},null,-1),qr("  New Shape ")]),10,sv),J("button",{onClick:K[6]||(K[6]=ye=>fe(r).polygon.mode.value="edit"),class:Rt([{active:fe(r).polygon.mode.value==="edit"},"radio-button"]),disabled:fe(r).freehand.isAnimating.value},K[15]||(K[15]=[J("span",{class:"radio-indicator"},null,-1),qr("  Edit Shape ")]),10,ov)]),K[16]||(K[16]=J("span",{class:"separator"},"|",-1)),J("div",av,[J("button",{onClick:j,disabled:!fe(r).polygon.isDrawing.value||fe(r).freehand.isAnimating.value},"  End Shape (c) ",8,lv),J("button",{onClick:ee,disabled:!fe(r).polygon.isDrawing.value||fe(r).freehand.isAnimating.value},"  Cancel Shape ",8,cv)]),K[17]||(K[17]=J("span",{class:"separator"},"|",-1)),fe(r).polygon.isDrawing.value?(ae(),ce("span",dv,"Drawing: "+Fe(fe(r).polygon.currentPoints.value.length/2)+" points",1)):Ne("",!0)],64)):Ne("",!0),fe(c)==="circle"?(ae(),ce(Re,{key:3},[fe(r).circle.isDrawing.value?(ae(),ce("span",uv,"Radius: "+Fe(Math.round(fe(r).circle.currentRadius.value))+"px",1)):Ne("",!0)],64)):Ne("",!0),K[23]||(K[23]=J("span",{class:"separator"},"|",-1)),J("span",hv,Fe(cs(fe(r)))+" selected",1)]),J("div",fv,[Ke(Wm,{modelValue:g.value,"onUpdate:modelValue":K[7]||(K[7]=ye=>g.value=ye),title:"Canvas",width:o.value.width,height:o.value.height},{default:Qs(()=>[J("div",{ref_key:"konvaContainer",ref:Ce,class:"konva-container",tabindex:"0",style:_n({width:g.value?"100%":o.value.width+"px",height:g.value?"100%":o.value.height+"px"})},null,4)]),_:1},8,["modelValue","width","height"]),fe(d)||fe(f)?(ae(),ce("div",pv,[fe(f)?(ae(),jn(Bm,{key:0,snapshots:fe(p),"selected-id":fe(h),"on-save-snapshot":oe,"on-restore-snapshot":re,"execute-command":pe,"onUpdate:snapshots":K[8]||(K[8]=ye=>p.value=ye),"onUpdate:selectedId":K[9]||(K[9]=ye=>h.value=ye)},null,8,["snapshots","selected-id"])):Ne("",!0),fe(d)?(ae(),ce("div",gv,[i.showVisualizations?(ae(),jn(Om,{key:0,"canvas-state":fe(r)},null,8,["canvas-state"])):Ne("",!0),Ke(xm,{"selected-nodes":fe(W),"single-node":Z.value,"multi-selected":Y.value,"group-selected":ie.value,"collect-hierarchy-from-root":fe(a).collectHierarchyFromRoot,"update-metadata-highlight":fe(a).updateMetadataHighlight,"update-hover-highlight":fe(a).updateHoverHighlight,"on-apply-metadata":it,"schema-options":i.metadataSchemas},null,8,["selected-nodes","single-node","multi-selected","group-selected","collect-hierarchy-from-root","update-metadata-highlight","update-hover-highlight","schema-options"])])):Ne("",!0)])):Ne("",!0),i.showTimeline?(ae(),ce(Re,{key:1},[Ke(_g,{strokes:fe(yt)(fe(r)),selectedStrokes:fe(r).freehand.selectedStrokesForTimeline.value,useRealTiming:fe(r).freehand.useRealTiming.value,maxInterStrokeDelay:fe(Cs),overrideDuration:fe(r).freehand.timelineDuration.value>0?fe(r).freehand.timelineDuration.value:void 0,lockWhileAnimating:we,onTimeUpdate:H},null,8,["strokes","selectedStrokes","useRealTiming","maxInterStrokeDelay","overrideDuration"]),fe(r).freehand.isAnimating.value?(ae(),ce("div",mv,"  Timeline has modified elements - press Stop to unlock ")):Ne("",!0)],64)):Ne("",!0)]),Ke(x0,{name:"notification"},{default:Qs(()=>[fe(r).notification.visible.value?(ae(),ce("div",yv,Fe(fe(r).notification.message.value),1)):Ne("",!0)]),_:1})]))}}),[["styles",['.canvas-root[data-v-82e906c0]{position:relative;display:flex;flex-direction:column;align-items:center;gap:20px;padding:20px}.notification-toast[data-v-82e906c0]{position:fixed;bottom:30px;left:50%;transform:translate(-50%);background:#333;color:#fff;padding:12px 24px;border-radius:6px;font-size:14px;box-shadow:0 4px 12px #0000004d;z-index:10000;max-width:500px;text-align:center}.notification-enter-active[data-v-82e906c0],.notification-leave-active[data-v-82e906c0]{transition:all .3s ease}.notification-enter-from[data-v-82e906c0]{opacity:0;transform:translate(-50%) translateY(20px)}.notification-leave-to[data-v-82e906c0]{opacity:0;transform:translate(-50%) translateY(-20px)}.control-panel[data-v-82e906c0]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:10px 15px;display:flex;flex-wrap:wrap;align-items:center;gap:10px;box-shadow:0 2px 10px #0000001a}.canvas-wrapper[data-v-82e906c0]{display:flex;flex-direction:column;align-items:center;gap:20px}.control-panel button[data-v-82e906c0]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 15px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-82e906c0]:hover:not(:disabled){background:#e0e0e0}.control-panel button.active[data-v-82e906c0]{background:#06f;color:#fff;border-color:#06f}.control-panel button[data-v-82e906c0]:disabled{opacity:.5;cursor:not-allowed}.button-group.vertical[data-v-82e906c0]{display:flex;flex-direction:column;gap:2px}.button-group.vertical button[data-v-82e906c0]{margin:0;padding:3px 10px;font-size:12px}.radio-button-group[data-v-82e906c0]{display:flex;flex-direction:column;gap:4px}.radio-button[data-v-82e906c0]{display:flex;align-items:center;gap:6px;padding:4px 10px!important;font-size:13px!important;background:#fff!important;border:1px solid #ccc!important;text-align:left}.radio-button[data-v-82e906c0]:hover:not(:disabled){background:#f5f5f5!important;border-color:#999!important}.radio-button.active[data-v-82e906c0]{background:#e8f0fe!important;border-color:#06f!important;color:inherit!important}.radio-button.active .radio-indicator[data-v-82e906c0]{border-color:#06f;background:#06f}.radio-button.active .radio-indicator[data-v-82e906c0]:after{opacity:1}.radio-indicator[data-v-82e906c0]{display:inline-block;width:14px;height:14px;border:2px solid #999;border-radius:50%;background:#fff;position:relative;flex-shrink:0;transition:all .2s}.radio-indicator[data-v-82e906c0]:after{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:6px;height:6px;border-radius:50%;background:#fff;opacity:0;transition:opacity .2s}.tool-dropdown[data-v-82e906c0]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 10px;font-size:14px;cursor:pointer;transition:all .2s}.tool-dropdown[data-v-82e906c0]:hover{background:#e0e0e0}.tool-dropdown[data-v-82e906c0]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-82e906c0]{color:#ccc}.flex-break[data-v-82e906c0]{display:none;flex-basis:100%;height:0}@media (max-width: 1100px){.control-panel .flex-break[data-v-82e906c0]{display:block}}.info[data-v-82e906c0]{color:#666;font-size:14px}.animation-lock-warning[data-v-82e906c0]{color:#e67e22;font-size:14px;font-weight:700;text-align:center;background:#fef5e7;border:1px solid #f39c12;border-radius:4px;padding:8px 15px;animation:pulse-82e906c0 2s infinite}@keyframes pulse-82e906c0{0%,to{opacity:1}50%{opacity:.6}}.konva-container[data-v-82e906c0]{background-color:#fff;border:1px solid black}.konva-container[data-v-82e906c0] .konvajs-content,.konva-container[data-v-82e906c0] canvas{width:100%!important;height:100%!important}.panels-container[data-v-82e906c0]{display:flex;flex-direction:row;gap:12px;align-items:flex-start}.metadata-suite[data-v-82e906c0]{display:flex;flex-direction:column;gap:8px;max-width:600px;width:500px}']],["__scopeId","data-v-82e906c0"]]),lh="handwriting-canvas",ya=H0(_v);return customElements.get(lh)||customElements.define(lh,ya),mr.CanvasElement=ya,mr.default=ya,Object.defineProperties(mr,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),mr}({});
