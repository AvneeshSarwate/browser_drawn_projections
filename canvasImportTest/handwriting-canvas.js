var HandwritingCanvas=function(rs){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function os(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const ze={},qn=[],Kt=()=>{},ff=()=>!1,Or=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),ss=e=>e.startsWith("onUpdate:"),rt=Object.assign,as=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},pf=Object.prototype.hasOwnProperty,Fe=(e,t)=>pf.call(e,t),_e=Array.isArray,Yn=e=>mi(e)==="[object Map]",Nr=e=>mi(e)==="[object Set]",Ka=e=>mi(e)==="[object Date]",we=e=>typeof e=="function",Je=e=>typeof e=="string",qt=e=>typeof e=="symbol",$e=e=>e!==null&&typeof e=="object",qa=e=>($e(e)||we(e))&&we(e.then)&&we(e.catch),Ya=Object.prototype.toString,mi=e=>Ya.call(e),gf=e=>mi(e).slice(8,-1),Fr=e=>mi(e)==="[object Object]",ls=e=>Je(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,yi=os(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ir=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},mf=/-(\w)/g,vt=Ir(e=>e.replace(mf,(t,n)=>n?n.toUpperCase():"")),yf=/\B([A-Z])/g,Nt=Ir(e=>e.replace(yf,"-$1").toLowerCase()),Lr=Ir(e=>e.charAt(0).toUpperCase()+e.slice(1)),cs=Ir(e=>e?`on${Lr(e)}`:""),bn=(e,t)=>!Object.is(e,t),Gr=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},Xa=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},zr=e=>{const t=parseFloat(e);return isNaN(t)?e:t},us=e=>{const t=Je(e)?Number(e):NaN;return isNaN(t)?e:t};let Ja;const Qa=()=>Ja||(Ja=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Nn(e){if(_e(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=Je(i)?Sf(i):Nn(i);if(r)for(const o in r)t[o]=r[o]}return t}else if(Je(e)||$e(e))return e}const vf=/;(?![^(]*\))/g,_f=/:([^]+)/,bf=/\/\*[^]*?\*\//g;function Sf(e){const t={};return e.replace(bf,"").split(vf).forEach(n=>{if(n){const i=n.split(_f);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function $t(e){let t="";if(Je(e))t=e;else if(_e(e))for(let n=0;n<e.length;n++){const i=$t(e[n]);i&&(t+=i+" ")}else if($e(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const wf=os("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function el(e){return!!e||e===""}function xf(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=$r(e[i],t[i]);return n}function $r(e,t){if(e===t)return!0;let n=Ka(e),i=Ka(t);if(n||i)return n&&i?e.getTime()===t.getTime():!1;if(n=qt(e),i=qt(t),n||i)return e===t;if(n=_e(e),i=_e(t),n||i)return n&&i?xf(e,t):!1;if(n=$e(e),i=$e(t),n||i){if(!n||!i)return!1;const r=Object.keys(e).length,o=Object.keys(t).length;if(r!==o)return!1;for(const s in e){const a=e.hasOwnProperty(s),l=t.hasOwnProperty(s);if(a&&!l||!a&&l||!$r(e[s],t[s]))return!1}}return String(e)===String(t)}function Cf(e,t){return e.findIndex(n=>$r(n,t))}const tl=e=>!!(e&&e.__v_isRef===!0),Le=e=>Je(e)?e:e==null?"":_e(e)||$e(e)&&(e.toString===Ya||!we(e.toString))?tl(e)?Le(e.value):JSON.stringify(e,nl,2):String(e),nl=(e,t)=>tl(t)?nl(e,t.value):Yn(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,r],o)=>(n[ds(i,o)+" =>"]=r,n),{})}:Nr(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>ds(n))}:qt(t)?ds(t):$e(t)&&!_e(t)&&!Fr(t)?String(t):t,ds=(e,t="")=>{var n;return qt(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Et;class kf{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Et,!t&&Et&&(this.index=(Et.scopes||(Et.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Et;try{return Et=this,t()}finally{Et=n}}}on(){Et=this}off(){Et=this.parent}stop(t){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function Pf(){return Et}let Be;const hs=new WeakSet;class il{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Et&&Et.active&&Et.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,hs.has(this)&&(hs.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ol(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ul(this),sl(this);const t=Be,n=Ut;Be=this,Ut=!0;try{return this.fn()}finally{al(this),Be=t,Ut=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)ms(t);this.deps=this.depsTail=void 0,ul(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?hs.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){gs(this)&&this.run()}get dirty(){return gs(this)}}let rl=0,vi,_i;function ol(e,t=!1){if(e.flags|=8,t){e.next=_i,_i=e;return}e.next=vi,vi=e}function fs(){rl++}function ps(){if(--rl>0)return;if(_i){let t=_i;for(_i=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;vi;){let t=vi;for(vi=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=n}}if(e)throw e}function sl(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function al(e){let t,n=e.depsTail,i=n;for(;i;){const r=i.prevDep;i.version===-1?(i===n&&(n=r),ms(i),Tf(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}e.deps=t,e.depsTail=n}function gs(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(ll(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function ll(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===bi))return;e.globalVersion=bi;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!gs(e)){e.flags&=-3;return}const n=Be,i=Ut;Be=e,Ut=!0;try{sl(e);const r=e.fn(e._value);(t.version===0||bn(r,e._value))&&(e._value=r,t.version++)}catch(r){throw t.version++,r}finally{Be=n,Ut=i,al(e),e.flags&=-3}}function ms(e,t=!1){const{dep:n,prevSub:i,nextSub:r}=e;if(i&&(i.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=i,e.nextSub=void 0),n.subs===e&&(n.subs=i),!n.subs&&n.computed){n.computed.flags&=-5;for(let o=n.computed.deps;o;o=o.nextDep)ms(o,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Tf(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Ut=!0;const cl=[];function rn(){cl.push(Ut),Ut=!1}function on(){const e=cl.pop();Ut=e===void 0?!0:e}function ul(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=Be;Be=void 0;try{t()}finally{Be=n}}}let bi=0;class Af{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ys{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Be||!Ut||Be===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Be)n=this.activeLink=new Af(Be,this),Be.deps?(n.prevDep=Be.depsTail,Be.depsTail.nextDep=n,Be.depsTail=n):Be.deps=Be.depsTail=n,dl(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=Be.depsTail,n.nextDep=void 0,Be.depsTail.nextDep=n,Be.depsTail=n,Be.deps===n&&(Be.deps=i)}return n}trigger(t){this.version++,bi++,this.notify(t)}notify(t){fs();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{ps()}}}function dl(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)dl(i)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const vs=new WeakMap,Fn=Symbol(""),_s=Symbol(""),Si=Symbol("");function gt(e,t,n){if(Ut&&Be){let i=vs.get(e);i||vs.set(e,i=new Map);let r=i.get(n);r||(i.set(n,r=new ys),r.map=i,r.key=n),r.track()}}function sn(e,t,n,i,r,o){const s=vs.get(e);if(!s){bi++;return}const a=l=>{l&&l.trigger()};if(fs(),t==="clear")s.forEach(a);else{const l=_e(e),c=l&&ls(n);if(l&&n==="length"){const d=Number(i);s.forEach((f,g)=>{(g==="length"||g===Si||!qt(g)&&g>=d)&&a(f)})}else switch(n!==void 0&&a(s.get(n)),c&&a(s.get(Si)),t){case"add":l?c&&a(s.get("length")):(a(s.get(Fn)),Yn(e)&&a(s.get(_s)));break;case"delete":l||(a(s.get(Fn)),Yn(e)&&a(s.get(_s)));break;case"set":Yn(e)&&a(s.get(Fn));break}}ps()}function Xn(e){const t=Te(e);return t===e?t:(gt(t,"iterate",Si),Ft(e)?t:t.map(mt))}function Ur(e){return gt(e=Te(e),"iterate",Si),e}const Ef={__proto__:null,[Symbol.iterator](){return bs(this,Symbol.iterator,mt)},concat(...e){return Xn(this).concat(...e.map(t=>_e(t)?Xn(t):t))},entries(){return bs(this,"entries",e=>(e[1]=mt(e[1]),e))},every(e,t){return an(this,"every",e,t,void 0,arguments)},filter(e,t){return an(this,"filter",e,t,n=>n.map(mt),arguments)},find(e,t){return an(this,"find",e,t,mt,arguments)},findIndex(e,t){return an(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return an(this,"findLast",e,t,mt,arguments)},findLastIndex(e,t){return an(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return an(this,"forEach",e,t,void 0,arguments)},includes(...e){return Ss(this,"includes",e)},indexOf(...e){return Ss(this,"indexOf",e)},join(e){return Xn(this).join(e)},lastIndexOf(...e){return Ss(this,"lastIndexOf",e)},map(e,t){return an(this,"map",e,t,void 0,arguments)},pop(){return wi(this,"pop")},push(...e){return wi(this,"push",e)},reduce(e,...t){return hl(this,"reduce",e,t)},reduceRight(e,...t){return hl(this,"reduceRight",e,t)},shift(){return wi(this,"shift")},some(e,t){return an(this,"some",e,t,void 0,arguments)},splice(...e){return wi(this,"splice",e)},toReversed(){return Xn(this).toReversed()},toSorted(e){return Xn(this).toSorted(e)},toSpliced(...e){return Xn(this).toSpliced(...e)},unshift(...e){return wi(this,"unshift",e)},values(){return bs(this,"values",mt)}};function bs(e,t,n){const i=Ur(e),r=i[t]();return i!==e&&!Ft(e)&&(r._next=r.next,r.next=()=>{const o=r._next();return o.value&&(o.value=n(o.value)),o}),r}const Rf=Array.prototype;function an(e,t,n,i,r,o){const s=Ur(e),a=s!==e&&!Ft(e),l=s[t];if(l!==Rf[t]){const f=l.apply(e,o);return a?mt(f):f}let c=n;s!==e&&(a?c=function(f,g){return n.call(this,mt(f),g,e)}:n.length>2&&(c=function(f,g){return n.call(this,f,g,e)}));const d=l.call(s,c,i);return a&&r?r(d):d}function hl(e,t,n,i){const r=Ur(e);let o=n;return r!==e&&(Ft(e)?n.length>3&&(o=function(s,a,l){return n.call(this,s,a,l,e)}):o=function(s,a,l){return n.call(this,s,mt(a),l,e)}),r[t](o,...i)}function Ss(e,t,n){const i=Te(e);gt(i,"iterate",Si);const r=i[t](...n);return(r===-1||r===!1)&&xs(n[0])?(n[0]=Te(n[0]),i[t](...n)):r}function wi(e,t,n=[]){rn(),fs();const i=Te(e)[t].apply(e,n);return ps(),on(),i}const Df=os("__proto__,__v_isRef,__isVue"),fl=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(qt));function Mf(e){qt(e)||(e=String(e));const t=Te(this);return gt(t,"has",e),t.hasOwnProperty(e)}class pl{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,i){const r=this._isReadonly,o=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return o;if(n==="__v_raw")return i===(r?o?Cl:xl:o?wl:Sl).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const s=_e(t);if(!r){let l;if(s&&(l=Ef[n]))return l;if(n==="hasOwnProperty")return Mf}const a=Reflect.get(t,n,st(t)?t:i);return(qt(n)?fl.has(n):Df(n))||(r||gt(t,"get",n),o)?a:st(a)?s&&ls(n)?a:a.value:$e(a)?r?Pl(a):qr(a):a}}class gl extends pl{constructor(t=!1){super(!1,t)}set(t,n,i,r){let o=t[n];if(!this._isShallow){const l=In(o);if(!Ft(i)&&!In(i)&&(o=Te(o),i=Te(i)),!_e(t)&&st(o)&&!st(i))return l?!1:(o.value=i,!0)}const s=_e(t)&&ls(n)?Number(n)<t.length:Fe(t,n),a=Reflect.set(t,n,i,st(t)?t:r);return t===Te(r)&&(s?bn(i,o)&&sn(t,"set",n,i):sn(t,"add",n,i)),a}deleteProperty(t,n){const i=Fe(t,n);t[n];const r=Reflect.deleteProperty(t,n);return r&&i&&sn(t,"delete",n,void 0),r}has(t,n){const i=Reflect.has(t,n);return(!qt(n)||!fl.has(n))&&gt(t,"has",n),i}ownKeys(t){return gt(t,"iterate",_e(t)?"length":Fn),Reflect.ownKeys(t)}}class ml extends pl{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const Of=new gl,Nf=new ml,Ff=new gl(!0),If=new ml(!0),ws=e=>e,Vr=e=>Reflect.getPrototypeOf(e);function Br(e,t,n=!1,i=!1){e=e.__v_raw;const r=Te(e),o=Te(t);n||(bn(t,o)&&gt(r,"get",t),gt(r,"get",o));const{has:s}=Vr(r),a=i?ws:n?Cs:mt;if(s.call(r,t))return a(e.get(t));if(s.call(r,o))return a(e.get(o));e!==r&&e.get(t)}function Hr(e,t=!1){const n=this.__v_raw,i=Te(n),r=Te(e);return t||(bn(e,r)&&gt(i,"has",e),gt(i,"has",r)),e===r?n.has(e):n.has(e)||n.has(r)}function jr(e,t=!1){return e=e.__v_raw,!t&&gt(Te(e),"iterate",Fn),Reflect.get(e,"size",e)}function yl(e,t=!1){!t&&!Ft(e)&&!In(e)&&(e=Te(e));const n=Te(this);return Vr(n).has.call(n,e)||(n.add(e),sn(n,"add",e,e)),this}function vl(e,t,n=!1){!n&&!Ft(t)&&!In(t)&&(t=Te(t));const i=Te(this),{has:r,get:o}=Vr(i);let s=r.call(i,e);s||(e=Te(e),s=r.call(i,e));const a=o.call(i,e);return i.set(e,t),s?bn(t,a)&&sn(i,"set",e,t):sn(i,"add",e,t),this}function _l(e){const t=Te(this),{has:n,get:i}=Vr(t);let r=n.call(t,e);r||(e=Te(e),r=n.call(t,e)),i&&i.call(t,e);const o=t.delete(e);return r&&sn(t,"delete",e,void 0),o}function bl(){const e=Te(this),t=e.size!==0,n=e.clear();return t&&sn(e,"clear",void 0,void 0),n}function Wr(e,t){return function(i,r){const o=this,s=o.__v_raw,a=Te(s),l=t?ws:e?Cs:mt;return!e&&gt(a,"iterate",Fn),s.forEach((c,d)=>i.call(r,l(c),l(d),o))}}function Zr(e,t,n){return function(...i){const r=this.__v_raw,o=Te(r),s=Yn(o),a=e==="entries"||e===Symbol.iterator&&s,l=e==="keys"&&s,c=r[e](...i),d=n?ws:t?Cs:mt;return!t&&gt(o,"iterate",l?_s:Fn),{next(){const{value:f,done:g}=c.next();return g?{value:f,done:g}:{value:a?[d(f[0]),d(f[1])]:d(f),done:g}},[Symbol.iterator](){return this}}}}function Sn(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Lf(){const e={get(o){return Br(this,o)},get size(){return jr(this)},has:Hr,add:yl,set:vl,delete:_l,clear:bl,forEach:Wr(!1,!1)},t={get(o){return Br(this,o,!1,!0)},get size(){return jr(this)},has:Hr,add(o){return yl.call(this,o,!0)},set(o,s){return vl.call(this,o,s,!0)},delete:_l,clear:bl,forEach:Wr(!1,!0)},n={get(o){return Br(this,o,!0)},get size(){return jr(this,!0)},has(o){return Hr.call(this,o,!0)},add:Sn("add"),set:Sn("set"),delete:Sn("delete"),clear:Sn("clear"),forEach:Wr(!0,!1)},i={get(o){return Br(this,o,!0,!0)},get size(){return jr(this,!0)},has(o){return Hr.call(this,o,!0)},add:Sn("add"),set:Sn("set"),delete:Sn("delete"),clear:Sn("clear"),forEach:Wr(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{e[o]=Zr(o,!1,!1),n[o]=Zr(o,!0,!1),t[o]=Zr(o,!1,!0),i[o]=Zr(o,!0,!0)}),[e,n,t,i]}const[Gf,zf,$f,Uf]=Lf();function Kr(e,t){const n=t?e?Uf:$f:e?zf:Gf;return(i,r,o)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(Fe(n,r)&&r in i?n:i,r,o)}const Vf={get:Kr(!1,!1)},Bf={get:Kr(!1,!0)},Hf={get:Kr(!0,!1)},jf={get:Kr(!0,!0)},Sl=new WeakMap,wl=new WeakMap,xl=new WeakMap,Cl=new WeakMap;function Wf(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Zf(e){return e.__v_skip||!Object.isExtensible(e)?0:Wf(gf(e))}function qr(e){return In(e)?e:Yr(e,!1,Of,Vf,Sl)}function kl(e){return Yr(e,!1,Ff,Bf,wl)}function Pl(e){return Yr(e,!0,Nf,Hf,xl)}function p3(e){return Yr(e,!0,If,jf,Cl)}function Yr(e,t,n,i,r){if(!$e(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const o=r.get(e);if(o)return o;const s=Zf(e);if(s===0)return e;const a=new Proxy(e,s===2?i:n);return r.set(e,a),a}function Jn(e){return In(e)?Jn(e.__v_raw):!!(e&&e.__v_isReactive)}function In(e){return!!(e&&e.__v_isReadonly)}function Ft(e){return!!(e&&e.__v_isShallow)}function xs(e){return e?!!e.__v_raw:!1}function Te(e){const t=e&&e.__v_raw;return t?Te(t):e}function Kf(e){return!Fe(e,"__v_skip")&&Object.isExtensible(e)&&Xa(e,"__v_skip",!0),e}const mt=e=>$e(e)?qr(e):e,Cs=e=>$e(e)?Pl(e):e;function st(e){return e?e.__v_isRef===!0:!1}function ye(e){return Al(e,!1)}function Tl(e){return Al(e,!0)}function Al(e,t){return st(e)?e:new qf(e,t)}class qf{constructor(t,n){this.dep=new ys,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:Te(t),this._value=n?t:mt(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,i=this.__v_isShallow||Ft(t)||In(t);t=i?t:Te(t),bn(t,n)&&(this._rawValue=t,this._value=i?t:mt(t),this.dep.trigger())}}function pe(e){return st(e)?e.value:e}const Yf={get:(e,t,n)=>t==="__v_raw"?e:pe(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return st(r)&&!st(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function El(e){return Jn(e)?e:new Proxy(e,Yf)}class Xf{constructor(t,n,i){this.fn=t,this.setter=n,this._value=void 0,this.dep=new ys(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=bi-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Be!==this)return ol(this,!0),!0}get value(){const t=this.dep.track();return ll(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Jf(e,t,n=!1){let i,r;return we(e)?i=e:(i=e.get,r=e.set),new Xf(i,r,n)}const Xr={},Jr=new WeakMap;let Ln;function Qf(e,t=!1,n=Ln){if(n){let i=Jr.get(n);i||Jr.set(n,i=[]),i.push(e)}}function ep(e,t,n=ze){const{immediate:i,deep:r,once:o,scheduler:s,augmentJob:a,call:l}=n,c=y=>r?y:Ft(y)||r===!1||r===0?ln(y,1):ln(y);let d,f,g,p,u=!1,v=!1;if(st(e)?(f=()=>e.value,u=Ft(e)):Jn(e)?(f=()=>c(e),u=!0):_e(e)?(v=!0,u=e.some(y=>Jn(y)||Ft(y)),f=()=>e.map(y=>{if(st(y))return y.value;if(Jn(y))return c(y);if(we(y))return l?l(y,2):y()})):we(e)?t?f=l?()=>l(e,2):e:f=()=>{if(g){rn();try{g()}finally{on()}}const y=Ln;Ln=d;try{return l?l(e,3,[p]):e(p)}finally{Ln=y}}:f=Kt,t&&r){const y=f,S=r===!0?1/0:r;f=()=>ln(y(),S)}const b=Pf(),x=()=>{d.stop(),b&&as(b.effects,d)};if(o&&t){const y=t;t=(...S)=>{y(...S),x()}}let m=v?new Array(e.length).fill(Xr):Xr;const h=y=>{if(!(!(d.flags&1)||!d.dirty&&!y))if(t){const S=d.run();if(r||u||(v?S.some((E,D)=>bn(E,m[D])):bn(S,m))){g&&g();const E=Ln;Ln=d;try{const D=[S,m===Xr?void 0:v&&m[0]===Xr?[]:m,p];l?l(t,3,D):t(...D),m=S}finally{Ln=E}}}else d.run()};return a&&a(h),d=new il(f),d.scheduler=s?()=>s(h,!1):h,p=y=>Qf(y,!1,d),g=d.onStop=()=>{const y=Jr.get(d);if(y){if(l)l(y,4);else for(const S of y)S();Jr.delete(d)}},t?i?h(!0):m=d.run():s?s(h.bind(null,!0),!0):d.run(),x.pause=d.pause.bind(d),x.resume=d.resume.bind(d),x.stop=x,x}function ln(e,t=1/0,n){if(t<=0||!$e(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,st(e))ln(e.value,t,n);else if(_e(e))for(let i=0;i<e.length;i++)ln(e[i],t,n);else if(Nr(e)||Yn(e))e.forEach(i=>{ln(i,t,n)});else if(Fr(e)){for(const i in e)ln(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&ln(e[i],t,n)}return e}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const xi=[];let ks=!1;function g3(e,...t){if(ks)return;ks=!0,rn();const n=xi.length?xi[xi.length-1].component:null,i=n&&n.appContext.config.warnHandler,r=tp();if(i)Qn(i,n,11,[e+t.map(o=>{var s,a;return(a=(s=o.toString)==null?void 0:s.call(o))!=null?a:JSON.stringify(o)}).join(""),n&&n.proxy,r.map(({vnode:o})=>`at <${Ec(n,o.type)}>`).join(`
`),r]);else{const o=[`[Vue warn]: ${e}`,...t];r.length&&o.push(`
`,...np(r)),console.warn(...o)}on(),ks=!1}function tp(){let e=xi[xi.length-1];if(!e)return[];const t=[];for(;e;){const n=t[0];n&&n.vnode===e?n.recurseCount++:t.push({vnode:e,recurseCount:0});const i=e.component&&e.component.parent;e=i&&i.vnode}return t}function np(e){const t=[];return e.forEach((n,i)=>{t.push(...i===0?[]:[`
`],...ip(n))}),t}function ip({vnode:e,recurseCount:t}){const n=t>0?`... (${t} recursive calls)`:"",i=e.component?e.component.parent==null:!1,r=` at <${Ec(e.component,e.type,i)}`,o=">"+n;return e.props?[r,...rp(e.props),o]:[r+o]}function rp(e){const t=[],n=Object.keys(e);return n.slice(0,3).forEach(i=>{t.push(...Rl(i,e[i]))}),n.length>3&&t.push(" ..."),t}function Rl(e,t,n){return Je(t)?(t=JSON.stringify(t),n?t:[`${e}=${t}`]):typeof t=="number"||typeof t=="boolean"||t==null?n?t:[`${e}=${t}`]:st(t)?(t=Rl(e,Te(t.value),!0),n?t:[`${e}=Ref<`,t,">"]):we(t)?[`${e}=fn${t.name?`<${t.name}>`:""}`]:(t=Te(t),n?t:[`${e}=`,t])}function Qn(e,t,n,i){try{return i?e(...i):e()}catch(r){Qr(r,t,n)}}function Vt(e,t,n,i){if(we(e)){const r=Qn(e,t,n,i);return r&&qa(r)&&r.catch(o=>{Qr(o,t,n)}),r}if(_e(e)){const r=[];for(let o=0;o<e.length;o++)r.push(Vt(e[o],t,n,i));return r}}function Qr(e,t,n,i=!0){const r=t?t.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:s}=t&&t.appContext.config||ze;if(t){let a=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const d=a.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](e,l,c)===!1)return}a=a.parent}if(o){rn(),Qn(o,null,10,[e,l,c]),on();return}}op(e,n,r,i,s)}function op(e,t,n,i=!0,r=!1){if(r)throw e;console.error(e)}const _t=[];let Yt=-1;const ei=[];let wn=null,ti=0;const Dl=Promise.resolve();let eo=null;function Ci(e){const t=eo||Dl;return e?t.then(this?e.bind(this):e):t}function sp(e){let t=Yt+1,n=_t.length;for(;t<n;){const i=t+n>>>1,r=_t[i],o=ki(r);o<e||o===e&&r.flags&2?t=i+1:n=i}return t}function Ps(e){if(!(e.flags&1)){const t=ki(e),n=_t[_t.length-1];!n||!(e.flags&2)&&t>=ki(n)?_t.push(e):_t.splice(sp(t),0,e),e.flags|=1,Ml()}}function Ml(){eo||(eo=Dl.then(Fl))}function ap(e){_e(e)?ei.push(...e):wn&&e.id===-1?wn.splice(ti+1,0,e):e.flags&1||(ei.push(e),e.flags|=1),Ml()}function Ol(e,t,n=Yt+1){for(;n<_t.length;n++){const i=_t[n];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;_t.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Nl(e){if(ei.length){const t=[...new Set(ei)].sort((n,i)=>ki(n)-ki(i));if(ei.length=0,wn){wn.push(...t);return}for(wn=t,ti=0;ti<wn.length;ti++){const n=wn[ti];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}wn=null,ti=0}}const ki=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Fl(e){try{for(Yt=0;Yt<_t.length;Yt++){const t=_t[Yt];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Qn(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Yt<_t.length;Yt++){const t=_t[Yt];t&&(t.flags&=-2)}Yt=-1,_t.length=0,Nl(),eo=null,(_t.length||ei.length)&&Fl()}}let at=null,Il=null;function to(e){const t=at;return at=e,Il=e&&e.type.__scopeId||null,t}function Ts(e,t=at,n){if(!t||e._n)return e;const i=(...r)=>{i._d&&Sc(-1);const o=to(t);let s;try{s=e(...r)}finally{to(o),i._d&&Sc(1)}return s};return i._n=!0,i._c=!0,i._d=!0,i}function As(e,t){if(at===null)return e;const n=go(at),i=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[o,s,a,l=ze]=t[r];o&&(we(o)&&(o={mounted:o,updated:o}),o.deep&&ln(s),i.push({dir:o,instance:n,value:s,oldValue:void 0,arg:a,modifiers:l}))}return e}function Gn(e,t,n,i){const r=e.dirs,o=t&&t.dirs;for(let s=0;s<r.length;s++){const a=r[s];o&&(a.oldValue=o[s].value);let l=a.dir[i];l&&(rn(),Vt(l,n,8,[e.el,a,e,t]),on())}}const lp=Symbol("_vte"),Ll=e=>e.__isTeleport,xn=Symbol("_leaveCb"),no=Symbol("_enterCb");function cp(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return oo(()=>{e.isMounted=!0}),Ms(()=>{e.isUnmounting=!0}),e}const It=[Function,Array],Gl={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:It,onEnter:It,onAfterEnter:It,onEnterCancelled:It,onBeforeLeave:It,onLeave:It,onAfterLeave:It,onLeaveCancelled:It,onBeforeAppear:It,onAppear:It,onAfterAppear:It,onAppearCancelled:It},zl=e=>{const t=e.subTree;return t.component?zl(t.component):t},up={name:"BaseTransition",props:Gl,setup(e,{slots:t}){const n=l0(),i=cp();return()=>{const r=t.default&&Bl(t.default(),!0);if(!r||!r.length)return;const o=$l(r),s=Te(e),{mode:a}=s;if(i.isLeaving)return Rs(o);const l=Vl(o);if(!l)return Rs(o);let c=Es(l,s,i,n,g=>c=g);l.type!==St&&Pi(l,c);const d=n.subTree,f=d&&Vl(d);if(f&&f.type!==St&&!$n(l,f)&&zl(n).type!==St){const g=Es(f,s,i,n);if(Pi(f,g),a==="out-in"&&l.type!==St)return i.isLeaving=!0,g.afterLeave=()=>{i.isLeaving=!1,n.job.flags&8||n.update(),delete g.afterLeave},Rs(o);a==="in-out"&&l.type!==St&&(g.delayLeave=(p,u,v)=>{const b=Ul(i,f);b[String(f.key)]=f,p[xn]=()=>{u(),p[xn]=void 0,delete c.delayedLeave},c.delayedLeave=v})}return o}}};function $l(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==St){t=n;break}}return t}const dp=up;function Ul(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function Es(e,t,n,i,r){const{appear:o,mode:s,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:d,onEnterCancelled:f,onBeforeLeave:g,onLeave:p,onAfterLeave:u,onLeaveCancelled:v,onBeforeAppear:b,onAppear:x,onAfterAppear:m,onAppearCancelled:h}=t,y=String(e.key),S=Ul(n,e),E=(w,k)=>{w&&Vt(w,i,9,k)},D=(w,k)=>{const T=k[1];E(w,k),_e(w)?w.every(R=>R.length<=1)&&T():w.length<=1&&T()},C={mode:s,persisted:a,beforeEnter(w){let k=l;if(!n.isMounted)if(o)k=b||l;else return;w[xn]&&w[xn](!0);const T=S[y];T&&$n(e,T)&&T.el[xn]&&T.el[xn](),E(k,[w])},enter(w){let k=c,T=d,R=f;if(!n.isMounted)if(o)k=x||c,T=m||d,R=h||f;else return;let L=!1;const U=w[no]=z=>{L||(L=!0,z?E(R,[w]):E(T,[w]),C.delayedLeave&&C.delayedLeave(),w[no]=void 0)};k?D(k,[w,U]):U()},leave(w,k){const T=String(e.key);if(w[no]&&w[no](!0),n.isUnmounting)return k();E(g,[w]);let R=!1;const L=w[xn]=U=>{R||(R=!0,k(),U?E(v,[w]):E(u,[w]),w[xn]=void 0,S[T]===e&&delete S[T])};S[T]=e,p?D(p,[w,L]):L()},clone(w){const k=Es(w,t,n,i,r);return r&&r(k),k}};return C}function Rs(e){if(io(e))return e=Cn(e),e.children=null,e}function Vl(e){if(!io(e))return Ll(e.type)&&e.children?$l(e.children):e;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&we(n.default))return n.default()}}function Pi(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Pi(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Bl(e,t=!1,n){let i=[],r=0;for(let o=0;o<e.length;o++){let s=e[o];const a=n==null?s.key:String(n)+String(s.key!=null?s.key:o);s.type===De?(s.patchFlag&128&&r++,i=i.concat(Bl(s.children,t,a))):(t||s.type!==St)&&i.push(a!=null?Cn(s,{key:a}):s)}if(r>1)for(let o=0;o<i.length;o++)i[o].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function cn(e,t){return we(e)?rt({name:e.name},t,{setup:e}):e}function Hl(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Ds(e,t,n,i,r=!1){if(_e(e)){e.forEach((u,v)=>Ds(u,t&&(_e(t)?t[v]:t),n,i,r));return}if(ni(i)&&!r)return;const o=i.shapeFlag&4?go(i.component):i.el,s=r?null:o,{i:a,r:l}=e,c=t&&t.r,d=a.refs===ze?a.refs={}:a.refs,f=a.setupState,g=Te(f),p=f===ze?()=>!1:u=>Fe(g,u);if(c!=null&&c!==l&&(Je(c)?(d[c]=null,p(c)&&(f[c]=null)):st(c)&&(c.value=null)),we(l))Qn(l,a,12,[s,d]);else{const u=Je(l),v=st(l);if(u||v){const b=()=>{if(e.f){const x=u?p(l)?f[l]:d[l]:l.value;r?_e(x)&&as(x,o):_e(x)?x.includes(o)||x.push(o):u?(d[l]=[o],p(l)&&(f[l]=d[l])):(l.value=[o],e.k&&(d[e.k]=l.value))}else u?(d[l]=s,p(l)&&(f[l]=s)):v&&(l.value=s,e.k&&(d[e.k]=s))};s?(b.id=-1,Rt(b,n)):b()}}}const ni=e=>!!e.type.__asyncLoader,io=e=>e.type.__isKeepAlive;function hp(e,t){jl(e,"a",t)}function fp(e,t){jl(e,"da",t)}function jl(e,t,n=ht){const i=e.__wdc||(e.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(ro(t,i,n),n){let r=n.parent;for(;r&&r.parent;)io(r.parent.vnode)&&pp(i,t,n,r),r=r.parent}}function pp(e,t,n,i){const r=ro(t,e,i,!0);Ti(()=>{as(i[t],r)},n)}function ro(e,t,n=ht,i=!1){if(n){const r=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...s)=>{rn();const a=Oi(n),l=Vt(t,n,e,s);return a(),on(),l});return i?r.unshift(o):r.push(o),o}}const un=e=>(t,n=ht)=>{(!po||e==="sp")&&ro(e,(...i)=>t(...i),n)},gp=un("bm"),oo=un("m"),mp=un("bu"),yp=un("u"),Ms=un("bum"),Ti=un("um"),vp=un("sp"),_p=un("rtg"),bp=un("rtc");function Sp(e,t=ht){ro("ec",e,t)}const wp="components";function xp(e,t){return kp(wp,e,!0,t)||e}const Cp=Symbol.for("v-ndc");function kp(e,t,n=!0,i=!1){const r=at||ht;if(r){const o=r.type;{const a=Ac(o,!1);if(a&&(a===t||a===vt(t)||a===Lr(vt(t))))return o}const s=Wl(r[e]||o[e],t)||Wl(r.appContext[e],t);return!s&&i?o:s}}function Wl(e,t){return e&&(e[t]||e[vt(t)]||e[Lr(vt(t))])}function dn(e,t,n,i){let r;const o=n,s=_e(e);if(s||Je(e)){const a=s&&Jn(e);let l=!1;a&&(l=!Ft(e),e=Ur(e)),r=new Array(e.length);for(let c=0,d=e.length;c<d;c++)r[c]=t(l?mt(e[c]):e[c],c,void 0,o)}else if(typeof e=="number"){r=new Array(e);for(let a=0;a<e;a++)r[a]=t(a+1,a,void 0,o)}else if($e(e))if(e[Symbol.iterator])r=Array.from(e,(a,l)=>t(a,l,void 0,o));else{const a=Object.keys(e);r=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const d=a[l];r[l]=t(e[d],d,l,o)}}else r=[];return r}function Zl(e,t,n={},i,r){if(at.ce||at.parent&&ni(at.parent)&&at.parent.ce)return t!=="default"&&(n.name=t),le(),ri(De,null,[Qe("slot",n,i&&i())],64);let o=e[t];o&&o._c&&(o._d=!1),le();const s=o&&Kl(o(n)),a=ri(De,{key:(n.key||s&&s.key||`_${t}`)+(!s&&i?"_fb":"")},s||(i?i():[]),s&&e._===1?64:-2);return o&&o._c&&(o._d=!0),a}function Kl(e){return e.some(t=>Mi(t)?!(t.type===St||t.type===De&&!Kl(t.children)):!0)?e:null}const Os=e=>e?kc(e)?go(e):Os(e.parent):null,Ai=rt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Os(e.parent),$root:e=>Os(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Jl(e),$forceUpdate:e=>e.f||(e.f=()=>{Ps(e.update)}),$nextTick:e=>e.n||(e.n=Ci.bind(e.proxy)),$watch:e=>Zp.bind(e)}),Ns=(e,t)=>e!==ze&&!e.__isScriptSetup&&Fe(e,t),Pp={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:i,data:r,props:o,accessCache:s,type:a,appContext:l}=e;let c;if(t[0]!=="$"){const p=s[t];if(p!==void 0)switch(p){case 1:return i[t];case 2:return r[t];case 4:return n[t];case 3:return o[t]}else{if(Ns(i,t))return s[t]=1,i[t];if(r!==ze&&Fe(r,t))return s[t]=2,r[t];if((c=e.propsOptions[0])&&Fe(c,t))return s[t]=3,o[t];if(n!==ze&&Fe(n,t))return s[t]=4,n[t];Fs&&(s[t]=0)}}const d=Ai[t];let f,g;if(d)return t==="$attrs"&&gt(e.attrs,"get",""),d(e);if((f=a.__cssModules)&&(f=f[t]))return f;if(n!==ze&&Fe(n,t))return s[t]=4,n[t];if(g=l.config.globalProperties,Fe(g,t))return g[t]},set({_:e},t,n){const{data:i,setupState:r,ctx:o}=e;return Ns(r,t)?(r[t]=n,!0):i!==ze&&Fe(i,t)?(i[t]=n,!0):Fe(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(o[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:r,propsOptions:o}},s){let a;return!!n[s]||e!==ze&&Fe(e,s)||Ns(t,s)||(a=o[0])&&Fe(a,s)||Fe(i,s)||Fe(Ai,s)||Fe(r.config.globalProperties,s)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Fe(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function ql(e){return _e(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let Fs=!0;function Tp(e){const t=Jl(e),n=e.proxy,i=e.ctx;Fs=!1,t.beforeCreate&&Yl(t.beforeCreate,e,"bc");const{data:r,computed:o,methods:s,watch:a,provide:l,inject:c,created:d,beforeMount:f,mounted:g,beforeUpdate:p,updated:u,activated:v,deactivated:b,beforeDestroy:x,beforeUnmount:m,destroyed:h,unmounted:y,render:S,renderTracked:E,renderTriggered:D,errorCaptured:C,serverPrefetch:w,expose:k,inheritAttrs:T,components:R,directives:L,filters:U}=t;if(c&&Ap(c,i,null),s)for(const _ in s){const P=s[_];we(P)&&(i[_]=P.bind(n))}if(r){const _=r.call(n,n);$e(_)&&(e.data=qr(_))}if(Fs=!0,o)for(const _ in o){const P=o[_],N=we(P)?P.bind(n,n):we(P.get)?P.get.bind(n,n):Kt,O=!we(P)&&we(P.set)?P.set.bind(n):Kt,G=Se({get:N,set:O});Object.defineProperty(i,_,{enumerable:!0,configurable:!0,get:()=>G.value,set:H=>G.value=H})}if(a)for(const _ in a)Xl(a[_],i,n,_);if(l){const _=we(l)?l.call(n):l;Reflect.ownKeys(_).forEach(P=>{Np(P,_[P])})}d&&Yl(d,e,"c");function Z(_,P){_e(P)?P.forEach(N=>_(N.bind(n))):P&&_(P.bind(n))}if(Z(gp,f),Z(oo,g),Z(mp,p),Z(yp,u),Z(hp,v),Z(fp,b),Z(Sp,C),Z(bp,E),Z(_p,D),Z(Ms,m),Z(Ti,y),Z(vp,w),_e(k))if(k.length){const _=e.exposed||(e.exposed={});k.forEach(P=>{Object.defineProperty(_,P,{get:()=>n[P],set:N=>n[P]=N})})}else e.exposed||(e.exposed={});S&&e.render===Kt&&(e.render=S),T!=null&&(e.inheritAttrs=T),R&&(e.components=R),L&&(e.directives=L),w&&Hl(e)}function Ap(e,t,n=Kt){_e(e)&&(e=Is(e));for(const i in e){const r=e[i];let o;$e(r)?"default"in r?o=ao(r.from||i,r.default,!0):o=ao(r.from||i):o=ao(r),st(o)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:s=>o.value=s}):t[i]=o}}function Yl(e,t,n){Vt(_e(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function Xl(e,t,n,i){let r=i.includes(".")?mc(n,i):()=>n[i];if(Je(e)){const o=t[e];we(o)&&Ke(r,o)}else if(we(e))Ke(r,e.bind(n));else if($e(e))if(_e(e))e.forEach(o=>Xl(o,t,n,i));else{const o=we(e.handler)?e.handler.bind(n):t[e.handler];we(o)&&Ke(r,o,e)}}function Jl(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:r,optionsCache:o,config:{optionMergeStrategies:s}}=e.appContext,a=o.get(t);let l;return a?l=a:!r.length&&!n&&!i?l=t:(l={},r.length&&r.forEach(c=>so(l,c,s,!0)),so(l,t,s)),$e(t)&&o.set(t,l),l}function so(e,t,n,i=!1){const{mixins:r,extends:o}=t;o&&so(e,o,n,!0),r&&r.forEach(s=>so(e,s,n,!0));for(const s in t)if(!(i&&s==="expose")){const a=Ep[s]||n&&n[s];e[s]=a?a(e[s],t[s]):t[s]}return e}const Ep={data:Ql,props:ec,emits:ec,methods:Ei,computed:Ei,beforeCreate:bt,created:bt,beforeMount:bt,mounted:bt,beforeUpdate:bt,updated:bt,beforeDestroy:bt,beforeUnmount:bt,destroyed:bt,unmounted:bt,activated:bt,deactivated:bt,errorCaptured:bt,serverPrefetch:bt,components:Ei,directives:Ei,watch:Dp,provide:Ql,inject:Rp};function Ql(e,t){return t?e?function(){return rt(we(e)?e.call(this,this):e,we(t)?t.call(this,this):t)}:t:e}function Rp(e,t){return Ei(Is(e),Is(t))}function Is(e){if(_e(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function bt(e,t){return e?[...new Set([].concat(e,t))]:t}function Ei(e,t){return e?rt(Object.create(null),e,t):t}function ec(e,t){return e?_e(e)&&_e(t)?[...new Set([...e,...t])]:rt(Object.create(null),ql(e),ql(t??{})):t}function Dp(e,t){if(!e)return t;if(!t)return e;const n=rt(Object.create(null),e);for(const i in t)n[i]=bt(e[i],t[i]);return n}function tc(){return{app:null,config:{isNativeTag:ff,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Mp=0;function Op(e,t){return function(i,r=null){we(i)||(i=rt({},i)),r!=null&&!$e(r)&&(r=null);const o=tc(),s=new WeakSet,a=[];let l=!1;const c=o.app={_uid:Mp++,_component:i,_props:r,_container:null,_context:o,_instance:null,version:y0,get config(){return o.config},set config(d){},use(d,...f){return s.has(d)||(d&&we(d.install)?(s.add(d),d.install(c,...f)):we(d)&&(s.add(d),d(c,...f))),c},mixin(d){return o.mixins.includes(d)||o.mixins.push(d),c},component(d,f){return f?(o.components[d]=f,c):o.components[d]},directive(d,f){return f?(o.directives[d]=f,c):o.directives[d]},mount(d,f,g){if(!l){const p=c._ceVNode||Qe(i,r);return p.appContext=o,g===!0?g="svg":g===!1&&(g=void 0),e(p,d,g),l=!0,c._container=d,d.__vue_app__=c,go(p.component)}},onUnmount(d){a.push(d)},unmount(){l&&(Vt(a,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(d,f){return o.provides[d]=f,c},runWithContext(d){const f=ii;ii=c;try{return d()}finally{ii=f}}};return c}}let ii=null;function Np(e,t){if(ht){let n=ht.provides;const i=ht.parent&&ht.parent.provides;i===n&&(n=ht.provides=Object.create(i)),n[e]=t}}function ao(e,t,n=!1){const i=ht||at;if(i||ii){const r=ii?ii._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&e in r)return r[e];if(arguments.length>1)return n&&we(t)?t.call(i&&i.proxy):t}}const nc={},ic=()=>Object.create(nc),rc=e=>Object.getPrototypeOf(e)===nc;function Fp(e,t,n,i=!1){const r={},o=ic();e.propsDefaults=Object.create(null),oc(e,t,r,o);for(const s in e.propsOptions[0])s in r||(r[s]=void 0);n?e.props=i?r:kl(r):e.type.props?e.props=r:e.props=o,e.attrs=o}function Ip(e,t,n,i){const{props:r,attrs:o,vnode:{patchFlag:s}}=e,a=Te(r),[l]=e.propsOptions;let c=!1;if((i||s>0)&&!(s&16)){if(s&8){const d=e.vnode.dynamicProps;for(let f=0;f<d.length;f++){let g=d[f];if(lo(e.emitsOptions,g))continue;const p=t[g];if(l)if(Fe(o,g))p!==o[g]&&(o[g]=p,c=!0);else{const u=vt(g);r[u]=Ls(l,a,u,p,e,!1)}else p!==o[g]&&(o[g]=p,c=!0)}}}else{oc(e,t,r,o)&&(c=!0);let d;for(const f in a)(!t||!Fe(t,f)&&((d=Nt(f))===f||!Fe(t,d)))&&(l?n&&(n[f]!==void 0||n[d]!==void 0)&&(r[f]=Ls(l,a,f,void 0,e,!0)):delete r[f]);if(o!==a)for(const f in o)(!t||!Fe(t,f))&&(delete o[f],c=!0)}c&&sn(e.attrs,"set","")}function oc(e,t,n,i){const[r,o]=e.propsOptions;let s=!1,a;if(t)for(let l in t){if(yi(l))continue;const c=t[l];let d;r&&Fe(r,d=vt(l))?!o||!o.includes(d)?n[d]=c:(a||(a={}))[d]=c:lo(e.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,s=!0)}if(o){const l=Te(n),c=a||ze;for(let d=0;d<o.length;d++){const f=o[d];n[f]=Ls(r,l,f,c[f],e,!Fe(c,f))}}return s}function Ls(e,t,n,i,r,o){const s=e[n];if(s!=null){const a=Fe(s,"default");if(a&&i===void 0){const l=s.default;if(s.type!==Function&&!s.skipFactory&&we(l)){const{propsDefaults:c}=r;if(n in c)i=c[n];else{const d=Oi(r);i=c[n]=l.call(null,t),d()}}else i=l;r.ce&&r.ce._setProp(n,i)}s[0]&&(o&&!a?i=!1:s[1]&&(i===""||i===Nt(n))&&(i=!0))}return i}const Lp=new WeakMap;function sc(e,t,n=!1){const i=n?Lp:t.propsCache,r=i.get(e);if(r)return r;const o=e.props,s={},a=[];let l=!1;if(!we(e)){const d=f=>{l=!0;const[g,p]=sc(f,t,!0);rt(s,g),p&&a.push(...p)};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!o&&!l)return $e(e)&&i.set(e,qn),qn;if(_e(o))for(let d=0;d<o.length;d++){const f=vt(o[d]);ac(f)&&(s[f]=ze)}else if(o)for(const d in o){const f=vt(d);if(ac(f)){const g=o[d],p=s[f]=_e(g)||we(g)?{type:g}:rt({},g),u=p.type;let v=!1,b=!0;if(_e(u))for(let x=0;x<u.length;++x){const m=u[x],h=we(m)&&m.name;if(h==="Boolean"){v=!0;break}else h==="String"&&(b=!1)}else v=we(u)&&u.name==="Boolean";p[0]=v,p[1]=b,(v||Fe(p,"default"))&&a.push(f)}}const c=[s,a];return $e(e)&&i.set(e,c),c}function ac(e){return e[0]!=="$"&&!yi(e)}const lc=e=>e[0]==="_"||e==="$stable",Gs=e=>_e(e)?e.map(Xt):[Xt(e)],Gp=(e,t,n)=>{if(t._n)return t;const i=Ts((...r)=>Gs(t(...r)),n);return i._c=!1,i},cc=(e,t,n)=>{const i=e._ctx;for(const r in e){if(lc(r))continue;const o=e[r];if(we(o))t[r]=Gp(r,o,i);else if(o!=null){const s=Gs(o);t[r]=()=>s}}},uc=(e,t)=>{const n=Gs(t);e.slots.default=()=>n},dc=(e,t,n)=>{for(const i in t)(n||i!=="_")&&(e[i]=t[i])},zp=(e,t,n)=>{const i=e.slots=ic();if(e.vnode.shapeFlag&32){const r=t._;r?(dc(i,t,n),n&&Xa(i,"_",r,!0)):cc(t,i)}else t&&uc(e,t)},$p=(e,t,n)=>{const{vnode:i,slots:r}=e;let o=!0,s=ze;if(i.shapeFlag&32){const a=t._;a?n&&a===1?o=!1:dc(r,t,n):(o=!t.$stable,cc(t,r)),s=t}else t&&(uc(e,t),s={default:1});if(o)for(const a in r)!lc(a)&&s[a]==null&&delete r[a]},Rt=e0;function Up(e){return Vp(e)}function Vp(e,t){const n=Qa();n.__VUE__=!0;const{insert:i,remove:r,patchProp:o,createElement:s,createText:a,createComment:l,setText:c,setElementText:d,parentNode:f,nextSibling:g,setScopeId:p=Kt,insertStaticContent:u}=e,v=(M,I,B,W=null,J=null,K=null,ie=void 0,ae=null,re=!!I.dynamicChildren)=>{if(M===I)return;M&&!$n(M,I)&&(W=A(M),H(M,J,K,!0),M=null),I.patchFlag===-2&&(re=!1,I.dynamicChildren=null);const{type:ne,ref:he,shapeFlag:ce}=I;switch(ne){case co:b(M,I,B,W);break;case St:x(M,I,B,W);break;case $s:M==null&&m(I,B,W,ie);break;case De:R(M,I,B,W,J,K,ie,ae,re);break;default:ce&1?S(M,I,B,W,J,K,ie,ae,re):ce&6?L(M,I,B,W,J,K,ie,ae,re):(ce&64||ce&128)&&ne.process(M,I,B,W,J,K,ie,ae,re,ee)}he!=null&&J&&Ds(he,M&&M.ref,K,I||M,!I)},b=(M,I,B,W)=>{if(M==null)i(I.el=a(I.children),B,W);else{const J=I.el=M.el;I.children!==M.children&&c(J,I.children)}},x=(M,I,B,W)=>{M==null?i(I.el=l(I.children||""),B,W):I.el=M.el},m=(M,I,B,W)=>{[M.el,M.anchor]=u(M.children,I,B,W,M.el,M.anchor)},h=({el:M,anchor:I},B,W)=>{let J;for(;M&&M!==I;)J=g(M),i(M,B,W),M=J;i(I,B,W)},y=({el:M,anchor:I})=>{let B;for(;M&&M!==I;)B=g(M),r(M),M=B;r(I)},S=(M,I,B,W,J,K,ie,ae,re)=>{I.type==="svg"?ie="svg":I.type==="math"&&(ie="mathml"),M==null?E(I,B,W,J,K,ie,ae,re):w(M,I,J,K,ie,ae,re)},E=(M,I,B,W,J,K,ie,ae)=>{let re,ne;const{props:he,shapeFlag:ce,transition:ge,dirs:ve}=M;if(re=M.el=s(M.type,K,he&&he.is,he),ce&8?d(re,M.children):ce&16&&C(M.children,re,null,W,J,zs(M,K),ie,ae),ve&&Gn(M,null,W,"created"),D(re,M,M.scopeId,ie,W),he){for(const ke in he)ke!=="value"&&!yi(ke)&&o(re,ke,null,he[ke],K,W);"value"in he&&o(re,"value",null,he.value,K),(ne=he.onVnodeBeforeMount)&&Jt(ne,W,M)}ve&&Gn(M,null,W,"beforeMount");const be=Bp(J,ge);be&&ge.beforeEnter(re),i(re,I,B),((ne=he&&he.onVnodeMounted)||be||ve)&&Rt(()=>{ne&&Jt(ne,W,M),be&&ge.enter(re),ve&&Gn(M,null,W,"mounted")},J)},D=(M,I,B,W,J)=>{if(B&&p(M,B),W)for(let K=0;K<W.length;K++)p(M,W[K]);if(J){let K=J.subTree;if(I===K||bc(K.type)&&(K.ssContent===I||K.ssFallback===I)){const ie=J.vnode;D(M,ie,ie.scopeId,ie.slotScopeIds,J.parent)}}},C=(M,I,B,W,J,K,ie,ae,re=0)=>{for(let ne=re;ne<M.length;ne++){const he=M[ne]=ae?kn(M[ne]):Xt(M[ne]);v(null,he,I,B,W,J,K,ie,ae)}},w=(M,I,B,W,J,K,ie)=>{const ae=I.el=M.el;let{patchFlag:re,dynamicChildren:ne,dirs:he}=I;re|=M.patchFlag&16;const ce=M.props||ze,ge=I.props||ze;let ve;if(B&&zn(B,!1),(ve=ge.onVnodeBeforeUpdate)&&Jt(ve,B,I,M),he&&Gn(I,M,B,"beforeUpdate"),B&&zn(B,!0),(ce.innerHTML&&ge.innerHTML==null||ce.textContent&&ge.textContent==null)&&d(ae,""),ne?k(M.dynamicChildren,ne,ae,B,W,zs(I,J),K):ie||P(M,I,ae,null,B,W,zs(I,J),K,!1),re>0){if(re&16)T(ae,ce,ge,B,J);else if(re&2&&ce.class!==ge.class&&o(ae,"class",null,ge.class,J),re&4&&o(ae,"style",ce.style,ge.style,J),re&8){const be=I.dynamicProps;for(let ke=0;ke<be.length;ke++){const xe=be[ke],Ge=ce[xe],Me=ge[xe];(Me!==Ge||xe==="value")&&o(ae,xe,Ge,Me,J,B)}}re&1&&M.children!==I.children&&d(ae,I.children)}else!ie&&ne==null&&T(ae,ce,ge,B,J);((ve=ge.onVnodeUpdated)||he)&&Rt(()=>{ve&&Jt(ve,B,I,M),he&&Gn(I,M,B,"updated")},W)},k=(M,I,B,W,J,K,ie)=>{for(let ae=0;ae<I.length;ae++){const re=M[ae],ne=I[ae],he=re.el&&(re.type===De||!$n(re,ne)||re.shapeFlag&70)?f(re.el):B;v(re,ne,he,null,W,J,K,ie,!0)}},T=(M,I,B,W,J)=>{if(I!==B){if(I!==ze)for(const K in I)!yi(K)&&!(K in B)&&o(M,K,I[K],null,J,W);for(const K in B){if(yi(K))continue;const ie=B[K],ae=I[K];ie!==ae&&K!=="value"&&o(M,K,ae,ie,J,W)}"value"in B&&o(M,"value",I.value,B.value,J)}},R=(M,I,B,W,J,K,ie,ae,re)=>{const ne=I.el=M?M.el:a(""),he=I.anchor=M?M.anchor:a("");let{patchFlag:ce,dynamicChildren:ge,slotScopeIds:ve}=I;ve&&(ae=ae?ae.concat(ve):ve),M==null?(i(ne,B,W),i(he,B,W),C(I.children||[],B,he,J,K,ie,ae,re)):ce>0&&ce&64&&ge&&M.dynamicChildren?(k(M.dynamicChildren,ge,B,J,K,ie,ae),(I.key!=null||J&&I===J.subTree)&&hc(M,I,!0)):P(M,I,B,he,J,K,ie,ae,re)},L=(M,I,B,W,J,K,ie,ae,re)=>{I.slotScopeIds=ae,M==null?I.shapeFlag&512?J.ctx.activate(I,B,W,ie,re):U(I,B,W,J,K,ie,re):z(M,I,re)},U=(M,I,B,W,J,K,ie)=>{const ae=M.component=a0(M,W,J);if(io(M)&&(ae.ctx.renderer=ee),c0(ae,!1,ie),ae.asyncDep){if(J&&J.registerDep(ae,Z,ie),!M.el){const re=ae.subTree=Qe(St);x(null,re,I,B)}}else Z(ae,M,I,B,J,K,ie)},z=(M,I,B)=>{const W=I.component=M.component;if(Jp(M,I,B))if(W.asyncDep&&!W.asyncResolved){_(W,I,B);return}else W.next=I,W.update();else I.el=M.el,W.vnode=I},Z=(M,I,B,W,J,K,ie)=>{const ae=()=>{if(M.isMounted){let{next:ce,bu:ge,u:ve,parent:be,vnode:ke}=M;{const He=fc(M);if(He){ce&&(ce.el=ke.el,_(M,ce,ie)),He.asyncDep.then(()=>{M.isUnmounted||ae()});return}}let xe=ce,Ge;zn(M,!1),ce?(ce.el=ke.el,_(M,ce,ie)):ce=ke,ge&&Gr(ge),(Ge=ce.props&&ce.props.onVnodeBeforeUpdate)&&Jt(Ge,be,ce,ke),zn(M,!0);const Me=vc(M),Ue=M.subTree;M.subTree=Me,v(Ue,Me,f(Ue.el),A(Ue),M,J,K),ce.el=Me.el,xe===null&&Qp(M,Me.el),ve&&Rt(ve,J),(Ge=ce.props&&ce.props.onVnodeUpdated)&&Rt(()=>Jt(Ge,be,ce,ke),J)}else{let ce;const{el:ge,props:ve}=I,{bm:be,m:ke,parent:xe,root:Ge,type:Me}=M,Ue=ni(I);zn(M,!1),be&&Gr(be),!Ue&&(ce=ve&&ve.onVnodeBeforeMount)&&Jt(ce,xe,I),zn(M,!0);{Ge.ce&&Ge.ce._injectChildStyle(Me);const He=M.subTree=vc(M);v(null,He,B,W,M,J,K),I.el=He.el}if(ke&&Rt(ke,J),!Ue&&(ce=ve&&ve.onVnodeMounted)){const He=I;Rt(()=>Jt(ce,xe,He),J)}(I.shapeFlag&256||xe&&ni(xe.vnode)&&xe.vnode.shapeFlag&256)&&M.a&&Rt(M.a,J),M.isMounted=!0,I=B=W=null}};M.scope.on();const re=M.effect=new il(ae);M.scope.off();const ne=M.update=re.run.bind(re),he=M.job=re.runIfDirty.bind(re);he.i=M,he.id=M.uid,re.scheduler=()=>Ps(he),zn(M,!0),ne()},_=(M,I,B)=>{I.component=M;const W=M.vnode.props;M.vnode=I,M.next=null,Ip(M,I.props,W,B),$p(M,I.children,B),rn(),Ol(M),on()},P=(M,I,B,W,J,K,ie,ae,re=!1)=>{const ne=M&&M.children,he=M?M.shapeFlag:0,ce=I.children,{patchFlag:ge,shapeFlag:ve}=I;if(ge>0){if(ge&128){O(ne,ce,B,W,J,K,ie,ae,re);return}else if(ge&256){N(ne,ce,B,W,J,K,ie,ae,re);return}}ve&8?(he&16&&F(ne,J,K),ce!==ne&&d(B,ce)):he&16?ve&16?O(ne,ce,B,W,J,K,ie,ae,re):F(ne,J,K,!0):(he&8&&d(B,""),ve&16&&C(ce,B,W,J,K,ie,ae,re))},N=(M,I,B,W,J,K,ie,ae,re)=>{M=M||qn,I=I||qn;const ne=M.length,he=I.length,ce=Math.min(ne,he);let ge;for(ge=0;ge<ce;ge++){const ve=I[ge]=re?kn(I[ge]):Xt(I[ge]);v(M[ge],ve,B,null,J,K,ie,ae,re)}ne>he?F(M,J,K,!0,!1,ce):C(I,B,W,J,K,ie,ae,re,ce)},O=(M,I,B,W,J,K,ie,ae,re)=>{let ne=0;const he=I.length;let ce=M.length-1,ge=he-1;for(;ne<=ce&&ne<=ge;){const ve=M[ne],be=I[ne]=re?kn(I[ne]):Xt(I[ne]);if($n(ve,be))v(ve,be,B,null,J,K,ie,ae,re);else break;ne++}for(;ne<=ce&&ne<=ge;){const ve=M[ce],be=I[ge]=re?kn(I[ge]):Xt(I[ge]);if($n(ve,be))v(ve,be,B,null,J,K,ie,ae,re);else break;ce--,ge--}if(ne>ce){if(ne<=ge){const ve=ge+1,be=ve<he?I[ve].el:W;for(;ne<=ge;)v(null,I[ne]=re?kn(I[ne]):Xt(I[ne]),B,be,J,K,ie,ae,re),ne++}}else if(ne>ge)for(;ne<=ce;)H(M[ne],J,K,!0),ne++;else{const ve=ne,be=ne,ke=new Map;for(ne=be;ne<=ge;ne++){const ut=I[ne]=re?kn(I[ne]):Xt(I[ne]);ut.key!=null&&ke.set(ut.key,ne)}let xe,Ge=0;const Me=ge-be+1;let Ue=!1,He=0;const Ot=new Array(Me);for(ne=0;ne<Me;ne++)Ot[ne]=0;for(ne=ve;ne<=ce;ne++){const ut=M[ne];if(Ge>=Me){H(ut,J,K,!0);continue}let Tt;if(ut.key!=null)Tt=ke.get(ut.key);else for(xe=be;xe<=ge;xe++)if(Ot[xe-be]===0&&$n(ut,I[xe])){Tt=xe;break}Tt===void 0?H(ut,J,K,!0):(Ot[Tt-be]=ne+1,Tt>=He?He=Tt:Ue=!0,v(ut,I[Tt],B,null,J,K,ie,ae,re),Ge++)}const Qt=Ue?Hp(Ot):qn;for(xe=Qt.length-1,ne=Me-1;ne>=0;ne--){const ut=be+ne,Tt=I[ut],ts=ut+1<he?I[ut+1].el:W;Ot[ne]===0?v(null,Tt,B,ts,J,K,ie,ae,re):Ue&&(xe<0||ne!==Qt[xe]?G(Tt,B,ts,2):xe--)}}},G=(M,I,B,W,J=null)=>{const{el:K,type:ie,transition:ae,children:re,shapeFlag:ne}=M;if(ne&6){G(M.component.subTree,I,B,W);return}if(ne&128){M.suspense.move(I,B,W);return}if(ne&64){ie.move(M,I,B,ee);return}if(ie===De){i(K,I,B);for(let ce=0;ce<re.length;ce++)G(re[ce],I,B,W);i(M.anchor,I,B);return}if(ie===$s){h(M,I,B);return}if(W!==2&&ne&1&&ae)if(W===0)ae.beforeEnter(K),i(K,I,B),Rt(()=>ae.enter(K),J);else{const{leave:ce,delayLeave:ge,afterLeave:ve}=ae,be=()=>i(K,I,B),ke=()=>{ce(K,()=>{be(),ve&&ve()})};ge?ge(K,be,ke):ke()}else i(K,I,B)},H=(M,I,B,W=!1,J=!1)=>{const{type:K,props:ie,ref:ae,children:re,dynamicChildren:ne,shapeFlag:he,patchFlag:ce,dirs:ge,cacheIndex:ve}=M;if(ce===-2&&(J=!1),ae!=null&&Ds(ae,null,B,M,!0),ve!=null&&(I.renderCache[ve]=void 0),he&256){I.ctx.deactivate(M);return}const be=he&1&&ge,ke=!ni(M);let xe;if(ke&&(xe=ie&&ie.onVnodeBeforeUnmount)&&Jt(xe,I,M),he&6)se(M.component,B,W);else{if(he&128){M.suspense.unmount(B,W);return}be&&Gn(M,null,I,"beforeUnmount"),he&64?M.type.remove(M,I,B,ee,W):ne&&!ne.hasOnce&&(K!==De||ce>0&&ce&64)?F(ne,I,B,!1,!0):(K===De&&ce&384||!J&&he&16)&&F(re,I,B),W&&V(M)}(ke&&(xe=ie&&ie.onVnodeUnmounted)||be)&&Rt(()=>{xe&&Jt(xe,I,M),be&&Gn(M,null,I,"unmounted")},B)},V=M=>{const{type:I,el:B,anchor:W,transition:J}=M;if(I===De){te(B,W);return}if(I===$s){y(M);return}const K=()=>{r(B),J&&!J.persisted&&J.afterLeave&&J.afterLeave()};if(M.shapeFlag&1&&J&&!J.persisted){const{leave:ie,delayLeave:ae}=J,re=()=>ie(B,K);ae?ae(M.el,K,re):re()}else K()},te=(M,I)=>{let B;for(;M!==I;)B=g(M),r(M),M=B;r(I)},se=(M,I,B)=>{const{bum:W,scope:J,job:K,subTree:ie,um:ae,m:re,a:ne}=M;pc(re),pc(ne),W&&Gr(W),J.stop(),K&&(K.flags|=8,H(ie,M,I,B)),ae&&Rt(ae,I),Rt(()=>{M.isUnmounted=!0},I),I&&I.pendingBranch&&!I.isUnmounted&&M.asyncDep&&!M.asyncResolved&&M.suspenseId===I.pendingId&&(I.deps--,I.deps===0&&I.resolve())},F=(M,I,B,W=!1,J=!1,K=0)=>{for(let ie=K;ie<M.length;ie++)H(M[ie],I,B,W,J)},A=M=>{if(M.shapeFlag&6)return A(M.component.subTree);if(M.shapeFlag&128)return M.suspense.next();const I=g(M.anchor||M.el),B=I&&I[lp];return B?g(B):I};let $=!1;const j=(M,I,B)=>{M==null?I._vnode&&H(I._vnode,null,null,!0):v(I._vnode||null,M,I,null,null,null,B),I._vnode=M,$||($=!0,Ol(),Nl(),$=!1)},ee={p:v,um:H,m:G,r:V,mt:U,mc:C,pc:P,pbc:k,n:A,o:e};return{render:j,hydrate:void 0,createApp:Op(j)}}function zs({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function zn({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Bp(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function hc(e,t,n=!1){const i=e.children,r=t.children;if(_e(i)&&_e(r))for(let o=0;o<i.length;o++){const s=i[o];let a=r[o];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[o]=kn(r[o]),a.el=s.el),!n&&a.patchFlag!==-2&&hc(s,a)),a.type===co&&(a.el=s.el)}}function Hp(e){const t=e.slice(),n=[0];let i,r,o,s,a;const l=e.length;for(i=0;i<l;i++){const c=e[i];if(c!==0){if(r=n[n.length-1],e[r]<c){t[i]=r,n.push(i);continue}for(o=0,s=n.length-1;o<s;)a=o+s>>1,e[n[a]]<c?o=a+1:s=a;c<e[n[o]]&&(o>0&&(t[i]=n[o-1]),n[o]=i)}}for(o=n.length,s=n[o-1];o-- >0;)n[o]=s,s=t[s];return n}function fc(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:fc(t)}function pc(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const jp=Symbol.for("v-scx"),Wp=()=>ao(jp);function Ke(e,t,n){return gc(e,t,n)}function gc(e,t,n=ze){const{immediate:i,deep:r,flush:o,once:s}=n,a=rt({},n);let l;if(po)if(o==="sync"){const g=Wp();l=g.__watcherHandles||(g.__watcherHandles=[])}else if(!t||i)a.once=!0;else{const g=()=>{};return g.stop=Kt,g.resume=Kt,g.pause=Kt,g}const c=ht;a.call=(g,p,u)=>Vt(g,c,p,u);let d=!1;o==="post"?a.scheduler=g=>{Rt(g,c&&c.suspense)}:o!=="sync"&&(d=!0,a.scheduler=(g,p)=>{p?g():Ps(g)}),a.augmentJob=g=>{t&&(g.flags|=4),d&&(g.flags|=2,c&&(g.id=c.uid,g.i=c))};const f=ep(e,t,a);return l&&l.push(f),f}function Zp(e,t,n){const i=this.proxy,r=Je(e)?e.includes(".")?mc(i,e):()=>i[e]:e.bind(i,i);let o;we(t)?o=t:(o=t.handler,n=t);const s=Oi(this),a=gc(r,o.bind(i),n);return s(),a}function mc(e,t){const n=t.split(".");return()=>{let i=e;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}const Kp=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${vt(t)}Modifiers`]||e[`${Nt(t)}Modifiers`];function qp(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||ze;let r=n;const o=t.startsWith("update:"),s=o&&Kp(i,t.slice(7));s&&(s.trim&&(r=n.map(d=>Je(d)?d.trim():d)),s.number&&(r=n.map(zr)));let a,l=i[a=cs(t)]||i[a=cs(vt(t))];!l&&o&&(l=i[a=cs(Nt(t))]),l&&Vt(l,e,6,r);const c=i[a+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Vt(c,e,6,r)}}function yc(e,t,n=!1){const i=t.emitsCache,r=i.get(e);if(r!==void 0)return r;const o=e.emits;let s={},a=!1;if(!we(e)){const l=c=>{const d=yc(c,t,!0);d&&(a=!0,rt(s,d))};!n&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!o&&!a?($e(e)&&i.set(e,null),null):(_e(o)?o.forEach(l=>s[l]=null):rt(s,o),$e(e)&&i.set(e,s),s)}function lo(e,t){return!e||!Or(t)?!1:(t=t.slice(2).replace(/Once$/,""),Fe(e,t[0].toLowerCase()+t.slice(1))||Fe(e,Nt(t))||Fe(e,t))}function m3(){}function vc(e){const{type:t,vnode:n,proxy:i,withProxy:r,propsOptions:[o],slots:s,attrs:a,emit:l,render:c,renderCache:d,props:f,data:g,setupState:p,ctx:u,inheritAttrs:v}=e,b=to(e);let x,m;try{if(n.shapeFlag&4){const y=r||i,S=y;x=Xt(c.call(S,y,d,f,p,g,u)),m=a}else{const y=t;x=Xt(y.length>1?y(f,{attrs:a,slots:s,emit:l}):y(f,null)),m=t.props?a:Yp(a)}}catch(y){Ri.length=0,Qr(y,e,1),x=Qe(St)}let h=x;if(m&&v!==!1){const y=Object.keys(m),{shapeFlag:S}=h;y.length&&S&7&&(o&&y.some(ss)&&(m=Xp(m,o)),h=Cn(h,m,!1,!0))}return n.dirs&&(h=Cn(h,null,!1,!0),h.dirs=h.dirs?h.dirs.concat(n.dirs):n.dirs),n.transition&&Pi(h,n.transition),x=h,to(b),x}const Yp=e=>{let t;for(const n in e)(n==="class"||n==="style"||Or(n))&&((t||(t={}))[n]=e[n]);return t},Xp=(e,t)=>{const n={};for(const i in e)(!ss(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function Jp(e,t,n){const{props:i,children:r,component:o}=e,{props:s,children:a,patchFlag:l}=t,c=o.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?_c(i,s,c):!!s;if(l&8){const d=t.dynamicProps;for(let f=0;f<d.length;f++){const g=d[f];if(s[g]!==i[g]&&!lo(c,g))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===s?!1:i?s?_c(i,s,c):!0:!!s;return!1}function _c(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const o=i[r];if(t[o]!==e[o]&&!lo(n,o))return!0}return!1}function Qp({vnode:e,parent:t},n){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=n,t=t.parent;else break}}const bc=e=>e.__isSuspense;function e0(e,t){t&&t.pendingBranch?_e(e)?t.effects.push(...e):t.effects.push(e):ap(e)}const De=Symbol.for("v-fgt"),co=Symbol.for("v-txt"),St=Symbol.for("v-cmt"),$s=Symbol.for("v-stc"),Ri=[];let Dt=null;function le(e=!1){Ri.push(Dt=e?null:[])}function t0(){Ri.pop(),Dt=Ri[Ri.length-1]||null}let Di=1;function Sc(e){Di+=e,e<0&&Dt&&(Dt.hasOnce=!0)}function wc(e){return e.dynamicChildren=Di>0?Dt||qn:null,t0(),Di>0&&Dt&&Dt.push(e),e}function ue(e,t,n,i,r,o){return wc(Q(e,t,n,i,r,o,!0))}function ri(e,t,n,i,r){return wc(Qe(e,t,n,i,r,!0))}function Mi(e){return e?e.__v_isVNode===!0:!1}function $n(e,t){return e.type===t.type&&e.key===t.key}const xc=({key:e})=>e??null,uo=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Je(e)||st(e)||we(e)?{i:at,r:e,k:t,f:!!n}:e:null);function Q(e,t=null,n=null,i=0,r=null,o=e===De?0:1,s=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&xc(t),ref:t&&uo(t),scopeId:Il,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:at};return a?(Us(l,n),o&128&&e.normalize(l)):n&&(l.shapeFlag|=Je(n)?8:16),Di>0&&!s&&Dt&&(l.patchFlag>0||o&6)&&l.patchFlag!==32&&Dt.push(l),l}const Qe=n0;function n0(e,t=null,n=null,i=0,r=null,o=!1){if((!e||e===Cp)&&(e=St),Mi(e)){const a=Cn(e,t,!0);return n&&Us(a,n),Di>0&&!o&&Dt&&(a.shapeFlag&6?Dt[Dt.indexOf(e)]=a:Dt.push(a)),a.patchFlag=-2,a}if(g0(e)&&(e=e.__vccOpts),t){t=i0(t);let{class:a,style:l}=t;a&&!Je(a)&&(t.class=$t(a)),$e(l)&&(xs(l)&&!_e(l)&&(l=rt({},l)),t.style=Nn(l))}const s=Je(e)?1:bc(e)?128:Ll(e)?64:$e(e)?4:we(e)?2:0;return Q(e,t,n,i,r,s,o,!0)}function i0(e){return e?xs(e)||rc(e)?rt({},e):e:null}function Cn(e,t,n=!1,i=!1){const{props:r,ref:o,patchFlag:s,children:a,transition:l}=e,c=t?r0(r||{},t):r,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&xc(c),ref:t&&t.ref?n&&o?_e(o)?o.concat(uo(t)):[o,uo(t)]:uo(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==De?s===-1?16:s|16:s,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Cn(e.ssContent),ssFallback:e.ssFallback&&Cn(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&i&&Pi(d,l.clone(d)),d}function ho(e=" ",t=0){return Qe(co,null,e,t)}function Oe(e="",t=!1){return t?(le(),ri(St,null,e)):Qe(St,null,e)}function Xt(e){return e==null||typeof e=="boolean"?Qe(St):_e(e)?Qe(De,null,e.slice()):Mi(e)?kn(e):Qe(co,null,String(e))}function kn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Cn(e)}function Us(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(_e(t))n=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),Us(e,r()),r._c&&(r._d=!0));return}else{n=32;const r=t._;!r&&!rc(t)?t._ctx=at:r===3&&at&&(at.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else we(t)?(t={default:t,_ctx:at},n=32):(t=String(t),i&64?(n=16,t=[ho(t)]):n=8);e.children=t,e.shapeFlag|=n}function r0(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=$t([t.class,i.class]));else if(r==="style")t.style=Nn([t.style,i.style]);else if(Or(r)){const o=t[r],s=i[r];s&&o!==s&&!(_e(o)&&o.includes(s))&&(t[r]=o?[].concat(o,s):s)}else r!==""&&(t[r]=i[r])}return t}function Jt(e,t,n,i=null){Vt(e,t,7,[n,i])}const o0=tc();let s0=0;function a0(e,t,n){const i=e.type,r=(t?t.appContext:e.appContext)||o0,o={uid:s0++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new kf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:sc(i,r),emitsOptions:yc(i,r),emit:null,emitted:null,propsDefaults:ze,inheritAttrs:i.inheritAttrs,ctx:ze,data:ze,props:ze,attrs:ze,slots:ze,refs:ze,setupState:ze,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=qp.bind(null,o),e.ce&&e.ce(o),o}let ht=null;const l0=()=>ht||at;let fo,Vs;{const e=Qa(),t=(n,i)=>{let r;return(r=e[n])||(r=e[n]=[]),r.push(i),o=>{r.length>1?r.forEach(s=>s(o)):r[0](o)}};fo=t("__VUE_INSTANCE_SETTERS__",n=>ht=n),Vs=t("__VUE_SSR_SETTERS__",n=>po=n)}const Oi=e=>{const t=ht;return fo(e),e.scope.on(),()=>{e.scope.off(),fo(t)}},Cc=()=>{ht&&ht.scope.off(),fo(null)};function kc(e){return e.vnode.shapeFlag&4}let po=!1;function c0(e,t=!1,n=!1){t&&Vs(t);const{props:i,children:r}=e.vnode,o=kc(e);Fp(e,i,o,t),zp(e,r,n);const s=o?u0(e,t):void 0;return t&&Vs(!1),s}function u0(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Pp);const{setup:i}=n;if(i){const r=e.setupContext=i.length>1?h0(e):null,o=Oi(e);rn();const s=Qn(i,e,0,[e.props,r]);if(on(),o(),qa(s)){if(ni(e)||Hl(e),s.then(Cc,Cc),t)return s.then(a=>{Pc(e,a)}).catch(a=>{Qr(a,e,0)});e.asyncDep=s}else Pc(e,s)}else Tc(e)}function Pc(e,t,n){we(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:$e(t)&&(e.setupState=El(t)),Tc(e)}function Tc(e,t,n){const i=e.type;e.render||(e.render=i.render||Kt);{const r=Oi(e);rn();try{Tp(e)}finally{on(),r()}}}const d0={get(e,t){return gt(e,"get",""),e[t]}};function h0(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,d0),slots:e.slots,emit:e.emit,expose:t}}function go(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(El(Kf(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Ai)return Ai[n](e)},has(t,n){return n in t||n in Ai}})):e.proxy}const f0=/(?:^|[-_])(\w)/g,p0=e=>e.replace(f0,t=>t.toUpperCase()).replace(/[-_]/g,"");function Ac(e,t=!0){return we(e)?e.displayName||e.name:e.name||t&&e.__name}function Ec(e,t,n=!1){let i=Ac(t);if(!i&&t.__file){const r=t.__file.match(/([^/\\]+)\.\w+$/);r&&(i=r[1])}if(!i&&e&&e.parent){const r=o=>{for(const s in o)if(o[s]===t)return s};i=r(e.components||e.parent.type.components)||r(e.appContext.components)}return i?p0(i):n?"App":"Anonymous"}function g0(e){return we(e)&&"__vccOpts"in e}const Se=(e,t)=>Jf(e,t,po);function m0(e,t,n){const i=arguments.length;return i===2?$e(t)&&!_e(t)?Mi(t)?Qe(e,null,[t]):Qe(e,t):Qe(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&Mi(n)&&(n=[n]),Qe(e,t,n))}const y0="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Bs;const Rc=typeof window<"u"&&window.trustedTypes;if(Rc)try{Bs=Rc.createPolicy("vue",{createHTML:e=>e})}catch{}const Dc=Bs?e=>Bs.createHTML(e):e=>e,v0="http://www.w3.org/2000/svg",_0="http://www.w3.org/1998/Math/MathML",hn=typeof document<"u"?document:null,Mc=hn&&hn.createElement("template"),b0={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r=t==="svg"?hn.createElementNS(v0,e):t==="mathml"?hn.createElementNS(_0,e):n?hn.createElement(e,{is:n}):hn.createElement(e);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>hn.createTextNode(e),createComment:e=>hn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>hn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,r,o){const s=n?n.previousSibling:t.lastChild;if(r&&(r===o||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),!(r===o||!(r=r.nextSibling)););else{Mc.innerHTML=Dc(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const a=Mc.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,n)}return[s?s.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Pn="transition",Ni="animation",Fi=Symbol("_vtc"),Oc={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},S0=rt({},Gl,Oc),w0=(e=>(e.displayName="Transition",e.props=S0,e))((e,{slots:t})=>m0(dp,x0(e),t)),Un=(e,t=[])=>{_e(e)?e.forEach(n=>n(...t)):e&&e(...t)},Nc=e=>e?_e(e)?e.some(t=>t.length>1):e.length>1:!1;function x0(e){const t={};for(const R in e)R in Oc||(t[R]=e[R]);if(e.css===!1)return t;const{name:n="v",type:i,duration:r,enterFromClass:o=`${n}-enter-from`,enterActiveClass:s=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=o,appearActiveClass:c=s,appearToClass:d=a,leaveFromClass:f=`${n}-leave-from`,leaveActiveClass:g=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=e,u=C0(r),v=u&&u[0],b=u&&u[1],{onBeforeEnter:x,onEnter:m,onEnterCancelled:h,onLeave:y,onLeaveCancelled:S,onBeforeAppear:E=x,onAppear:D=m,onAppearCancelled:C=h}=t,w=(R,L,U)=>{Vn(R,L?d:a),Vn(R,L?c:s),U&&U()},k=(R,L)=>{R._isLeaving=!1,Vn(R,f),Vn(R,p),Vn(R,g),L&&L()},T=R=>(L,U)=>{const z=R?D:m,Z=()=>w(L,R,U);Un(z,[L,Z]),Fc(()=>{Vn(L,R?l:o),Tn(L,R?d:a),Nc(z)||Ic(L,i,v,Z)})};return rt(t,{onBeforeEnter(R){Un(x,[R]),Tn(R,o),Tn(R,s)},onBeforeAppear(R){Un(E,[R]),Tn(R,l),Tn(R,c)},onEnter:T(!1),onAppear:T(!0),onLeave(R,L){R._isLeaving=!0;const U=()=>k(R,L);Tn(R,f),Tn(R,g),T0(),Fc(()=>{R._isLeaving&&(Vn(R,f),Tn(R,p),Nc(y)||Ic(R,i,b,U))}),Un(y,[R,U])},onEnterCancelled(R){w(R,!1),Un(h,[R])},onAppearCancelled(R){w(R,!0),Un(C,[R])},onLeaveCancelled(R){k(R),Un(S,[R])}})}function C0(e){if(e==null)return null;if($e(e))return[Hs(e.enter),Hs(e.leave)];{const t=Hs(e);return[t,t]}}function Hs(e){return us(e)}function Tn(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[Fi]||(e[Fi]=new Set)).add(t)}function Vn(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const n=e[Fi];n&&(n.delete(t),n.size||(e[Fi]=void 0))}function Fc(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let k0=0;function Ic(e,t,n,i){const r=e._endId=++k0,o=()=>{r===e._endId&&i()};if(n!=null)return setTimeout(o,n);const{type:s,timeout:a,propCount:l}=P0(e,t);if(!s)return i();const c=s+"end";let d=0;const f=()=>{e.removeEventListener(c,g),o()},g=p=>{p.target===e&&++d>=l&&f()};setTimeout(()=>{d<l&&f()},a+1),e.addEventListener(c,g)}function P0(e,t){const n=window.getComputedStyle(e),i=u=>(n[u]||"").split(", "),r=i(`${Pn}Delay`),o=i(`${Pn}Duration`),s=Lc(r,o),a=i(`${Ni}Delay`),l=i(`${Ni}Duration`),c=Lc(a,l);let d=null,f=0,g=0;t===Pn?s>0&&(d=Pn,f=s,g=o.length):t===Ni?c>0&&(d=Ni,f=c,g=l.length):(f=Math.max(s,c),d=f>0?s>c?Pn:Ni:null,g=d?d===Pn?o.length:l.length:0);const p=d===Pn&&/\b(transform|all)(,|$)/.test(i(`${Pn}Property`).toString());return{type:d,timeout:f,propCount:g,hasTransform:p}}function Lc(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,i)=>Gc(n)+Gc(e[i])))}function Gc(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function T0(){return document.body.offsetHeight}function A0(e,t,n){const i=e[Fi];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const zc=Symbol("_vod"),E0=Symbol("_vsh"),R0=Symbol(""),D0=/(^|;)\s*display\s*:/;function M0(e,t,n){const i=e.style,r=Je(n);let o=!1;if(n&&!r){if(t)if(Je(t))for(const s of t.split(";")){const a=s.slice(0,s.indexOf(":")).trim();n[a]==null&&mo(i,a,"")}else for(const s in t)n[s]==null&&mo(i,s,"");for(const s in n)s==="display"&&(o=!0),mo(i,s,n[s])}else if(r){if(t!==n){const s=i[R0];s&&(n+=";"+s),i.cssText=n,o=D0.test(n)}}else t&&e.removeAttribute("style");zc in e&&(e[zc]=o?i.display:"",e[E0]&&(i.display="none"))}const $c=/\s*!important$/;function mo(e,t,n){if(_e(n))n.forEach(i=>mo(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=O0(e,t);$c.test(n)?e.setProperty(Nt(i),n.replace($c,""),"important"):e[i]=n}}const Uc=["Webkit","Moz","ms"],js={};function O0(e,t){const n=js[t];if(n)return n;let i=vt(t);if(i!=="filter"&&i in e)return js[t]=i;i=Lr(i);for(let r=0;r<Uc.length;r++){const o=Uc[r]+i;if(o in e)return js[t]=o}return t}const Vc="http://www.w3.org/1999/xlink";function Bc(e,t,n,i,r,o=wf(t)){i&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Vc,t.slice(6,t.length)):e.setAttributeNS(Vc,t,n):n==null||o&&!el(n)?e.removeAttribute(t):e.setAttribute(t,o?"":qt(n)?String(n):n)}function Hc(e,t,n,i){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Dc(n):n);return}const r=e.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const s=r==="OPTION"?e.getAttribute("value")||"":e.value,a=n==null?e.type==="checkbox"?"on":"":String(n);(s!==a||!("_value"in e))&&(e.value=a),n==null&&e.removeAttribute(t),e._value=n;return}let o=!1;if(n===""||n==null){const s=typeof e[t];s==="boolean"?n=el(n):n==null&&s==="string"?(n="",o=!0):s==="number"&&(n=0,o=!0)}try{e[t]=n}catch{}o&&e.removeAttribute(t)}function Bn(e,t,n,i){e.addEventListener(t,n,i)}function N0(e,t,n,i){e.removeEventListener(t,n,i)}const jc=Symbol("_vei");function F0(e,t,n,i,r=null){const o=e[jc]||(e[jc]={}),s=o[t];if(i&&s)s.value=i;else{const[a,l]=I0(t);if(i){const c=o[t]=z0(i,r);Bn(e,a,c,l)}else s&&(N0(e,a,s,l),o[t]=void 0)}}const Wc=/(?:Once|Passive|Capture)$/;function I0(e){let t;if(Wc.test(e)){t={};let i;for(;i=e.match(Wc);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Nt(e.slice(2)),t]}let Ws=0;const L0=Promise.resolve(),G0=()=>Ws||(L0.then(()=>Ws=0),Ws=Date.now());function z0(e,t){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;Vt($0(i,n.value),t,5,[i])};return n.value=e,n.attached=G0(),n}function $0(e,t){if(_e(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const Zc=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,U0=(e,t,n,i,r,o)=>{const s=r==="svg";t==="class"?A0(e,i,s):t==="style"?M0(e,n,i):Or(t)?ss(t)||F0(e,t,n,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):V0(e,t,i,s))?(Hc(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Bc(e,t,i,s,o,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Je(i))?Hc(e,vt(t),i):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Bc(e,t,i,s))};function V0(e,t,n,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&Zc(t)&&we(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Zc(t)&&Je(n)?!1:t in e}const Kc={};/*! #__NO_SIDE_EFFECTS__ */function B0(e,t,n){const i=cn(e,t);Fr(i)&&rt(i,t);class r extends Zs{constructor(s){super(i,s,n)}}return r.def=i,r}const H0=typeof HTMLElement<"u"?HTMLElement:class{};class Zs extends H0{constructor(t,n={},i=eu){super(),this._def=t,this._props=n,this._createApp=i,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&i!==eu?this._root=this.shadowRoot:t.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let t=this;for(;t=t&&(t.parentNode||t.host);)if(t instanceof Zs){this._parent=t;break}this._instance||(this._resolved?(this._setParent(),this._update()):t&&t._pendingResolve?this._pendingResolve=t._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(t=this._parent){t&&(this._instance.parent=t._instance,this._instance.provides=t._instance.provides)}disconnectedCallback(){this._connected=!1,Ci(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const r of i)this._setAttr(r.attributeName)}),this._ob.observe(this,{attributes:!0});const t=(i,r=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:o,styles:s}=i;let a;if(o&&!_e(o))for(const l in o){const c=o[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=us(this._props[l])),(a||(a=Object.create(null)))[vt(l)]=!0)}this._numberProps=a,r&&this._resolveProps(i),this.shadowRoot&&this._applyStyles(s),this._mount(i)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(i=>t(this._def=i,!0)):t(this._def)}_mount(t){this._app=this._createApp(t),t.configureApp&&t.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const i in n)Fe(this,i)||Object.defineProperty(this,i,{get:()=>pe(n[i])})}_resolveProps(t){const{props:n}=t,i=_e(n)?n:Object.keys(n||{});for(const r of Object.keys(this))r[0]!=="_"&&i.includes(r)&&this._setProp(r,this[r]);for(const r of i.map(vt))Object.defineProperty(this,r,{get(){return this._getProp(r)},set(o){this._setProp(r,o,!0,!0)}})}_setAttr(t){if(t.startsWith("data-v-"))return;const n=this.hasAttribute(t);let i=n?this.getAttribute(t):Kc;const r=vt(t);n&&this._numberProps&&this._numberProps[r]&&(i=us(i)),this._setProp(r,i,!1,!0)}_getProp(t){return this._props[t]}_setProp(t,n,i=!0,r=!1){n!==this._props[t]&&(n===Kc?delete this._props[t]:(this._props[t]=n,t==="key"&&this._app&&(this._app._ceVNode.key=n)),r&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(Nt(t),""):typeof n=="string"||typeof n=="number"?this.setAttribute(Nt(t),n+""):n||this.removeAttribute(Nt(t))))}_update(){Y0(this._createVNode(),this._root)}_createVNode(){const t={};this.shadowRoot||(t.onVnodeMounted=t.onVnodeUpdated=this._renderSlots.bind(this));const n=Qe(this._def,rt(t,this._props));return this._instance||(n.ce=i=>{this._instance=i,i.ce=this,i.isCE=!0;const r=(o,s)=>{this.dispatchEvent(new CustomEvent(o,Fr(s[0])?rt({detail:s},s[0]):{detail:s}))};i.emit=(o,...s)=>{r(o,s),Nt(o)!==o&&r(Nt(o),s)},this._setParent()}),n}_applyStyles(t,n){if(!t)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const i=this._nonce;for(let r=t.length-1;r>=0;r--){const o=document.createElement("style");i&&o.setAttribute("nonce",i),o.textContent=t[r],this.shadowRoot.prepend(o)}}_parseSlots(){const t=this._slots={};let n;for(;n=this.firstChild;){const i=n.nodeType===1&&n.getAttribute("slot")||"default";(t[i]||(t[i]=[])).push(n),this.removeChild(n)}}_renderSlots(){const t=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let i=0;i<t.length;i++){const r=t[i],o=r.getAttribute("name")||"default",s=this._slots[o],a=r.parentNode;if(s)for(const l of s){if(n&&l.nodeType===1){const c=n+"-s",d=document.createTreeWalker(l,1);l.setAttribute(c,"");let f;for(;f=d.nextNode();)f.setAttribute(c,"")}a.insertBefore(l,r)}else for(;r.firstChild;)a.insertBefore(r.firstChild,r);a.removeChild(r)}}_injectChildStyle(t){this._applyStyles(t.styles,t)}_removeChildStyle(t){}}const yo=e=>{const t=e.props["onUpdate:modelValue"]||!1;return _e(t)?n=>Gr(t,n):t};function j0(e){e.target.composing=!0}function qc(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const oi=Symbol("_assign"),Yc={created(e,{modifiers:{lazy:t,trim:n,number:i}},r){e[oi]=yo(r);const o=i||r.props&&r.props.type==="number";Bn(e,t?"change":"input",s=>{if(s.target.composing)return;let a=e.value;n&&(a=a.trim()),o&&(a=zr(a)),e[oi](a)}),n&&Bn(e,"change",()=>{e.value=e.value.trim()}),t||(Bn(e,"compositionstart",j0),Bn(e,"compositionend",qc),Bn(e,"change",qc))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:i,trim:r,number:o}},s){if(e[oi]=yo(s),e.composing)return;const a=(o||e.type==="number")&&!/^0\d/.test(e.value)?zr(e.value):e.value,l=t??"";a!==l&&(document.activeElement===e&&e.type!=="range"&&(i&&t===n||r&&e.value.trim()===l)||(e.value=l))}},W0={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const r=Nr(t);Bn(e,"change",()=>{const o=Array.prototype.filter.call(e.options,s=>s.selected).map(s=>n?zr(vo(s)):vo(s));e[oi](e.multiple?r?new Set(o):o:o[0]),e._assigning=!0,Ci(()=>{e._assigning=!1})}),e[oi]=yo(i)},mounted(e,{value:t}){Xc(e,t)},beforeUpdate(e,t,n){e[oi]=yo(n)},updated(e,{value:t}){e._assigning||Xc(e,t)}};function Xc(e,t){const n=e.multiple,i=_e(t);if(!(n&&!i&&!Nr(t))){for(let r=0,o=e.options.length;r<o;r++){const s=e.options[r],a=vo(s);if(n)if(i){const l=typeof a;l==="string"||l==="number"?s.selected=t.some(c=>String(c)===String(a)):s.selected=Cf(t,a)>-1}else s.selected=t.has(a);else if($r(vo(s),t)){e.selectedIndex!==r&&(e.selectedIndex=r);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function vo(e){return"_value"in e?e._value:e.value}const Z0=["ctrl","shift","alt","meta"],K0={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Z0.some(n=>e[`${n}Key`]&&!t.includes(n))},Ks=(e,t)=>{const n=e._withMods||(e._withMods={}),i=t.join(".");return n[i]||(n[i]=(r,...o)=>{for(let s=0;s<t.length;s++){const a=K0[t[s]];if(a&&a(r,t))return}return e(r,...o)})},q0=rt({patchProp:U0},b0);let Jc;function Qc(){return Jc||(Jc=Up(q0))}const Y0=(...e)=>{Qc().render(...e)},eu=(...e)=>{const t=Qc().createApp(...e),{mount:n}=t;return t.mount=i=>{const r=J0(i);if(!r)return;const o=t._component;!we(o)&&!o.render&&!o.template&&(o.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const s=n(r,!1,X0(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),s},t};function X0(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function J0(e){return Je(e)?document.querySelector(e):e}var tu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Q0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _o={exports:{}},Ii={},qs={},Ys={},nu;function Pe(){return nu||(nu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof tu<"u"?tu:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.21",isBrowser:n(),isUnminified:/param/.test(function(r){}.toString()),dblClickWindow:400,getAngle(r){return e.Konva.angleDeg?r*t:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var r;return(r=e.Konva.Transformer)===null||r===void 0?void 0:r.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(r){e.glob.Konva=r}};const i=r=>{e.Konva[r.prototype.getClassName()]=r};e._registerNode=i,e.Konva._injectGlobal(e.Konva)}(Ys)),Ys}var Xs={},iu;function et(){return iu||(iu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=Pe();class n{constructor(y=[1,0,0,1,0,0]){this.dirty=!1,this.m=y&&y.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(y){y.m[0]=this.m[0],y.m[1]=this.m[1],y.m[2]=this.m[2],y.m[3]=this.m[3],y.m[4]=this.m[4],y.m[5]=this.m[5]}point(y){const S=this.m;return{x:S[0]*y.x+S[2]*y.y+S[4],y:S[1]*y.x+S[3]*y.y+S[5]}}translate(y,S){return this.m[4]+=this.m[0]*y+this.m[2]*S,this.m[5]+=this.m[1]*y+this.m[3]*S,this}scale(y,S){return this.m[0]*=y,this.m[1]*=y,this.m[2]*=S,this.m[3]*=S,this}rotate(y){const S=Math.cos(y),E=Math.sin(y),D=this.m[0]*S+this.m[2]*E,C=this.m[1]*S+this.m[3]*E,w=this.m[0]*-E+this.m[2]*S,k=this.m[1]*-E+this.m[3]*S;return this.m[0]=D,this.m[1]=C,this.m[2]=w,this.m[3]=k,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(y,S){const E=this.m[0]+this.m[2]*S,D=this.m[1]+this.m[3]*S,C=this.m[2]+this.m[0]*y,w=this.m[3]+this.m[1]*y;return this.m[0]=E,this.m[1]=D,this.m[2]=C,this.m[3]=w,this}multiply(y){const S=this.m[0]*y.m[0]+this.m[2]*y.m[1],E=this.m[1]*y.m[0]+this.m[3]*y.m[1],D=this.m[0]*y.m[2]+this.m[2]*y.m[3],C=this.m[1]*y.m[2]+this.m[3]*y.m[3],w=this.m[0]*y.m[4]+this.m[2]*y.m[5]+this.m[4],k=this.m[1]*y.m[4]+this.m[3]*y.m[5]+this.m[5];return this.m[0]=S,this.m[1]=E,this.m[2]=D,this.m[3]=C,this.m[4]=w,this.m[5]=k,this}invert(){const y=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),S=this.m[3]*y,E=-this.m[1]*y,D=-this.m[2]*y,C=this.m[0]*y,w=y*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),k=y*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=S,this.m[1]=E,this.m[2]=D,this.m[3]=C,this.m[4]=w,this.m[5]=k,this}getMatrix(){return this.m}decompose(){const y=this.m[0],S=this.m[1],E=this.m[2],D=this.m[3],C=this.m[4],w=this.m[5],k=y*D-S*E,T={x:C,y:w,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(y!=0||S!=0){const R=Math.sqrt(y*y+S*S);T.rotation=S>0?Math.acos(y/R):-Math.acos(y/R),T.scaleX=R,T.scaleY=k/R,T.skewX=(y*E+S*D)/k,T.skewY=0}else if(E!=0||D!=0){const R=Math.sqrt(E*E+D*D);T.rotation=Math.PI/2-(D>0?Math.acos(-E/R):-Math.acos(E/R)),T.scaleX=k/R,T.scaleY=R,T.skewX=0,T.skewY=(y*E+S*D)/k}return T.rotation=e.Util._getRotation(T.rotation),T}}e.Transform=n;const i="[object Array]",r="[object Number]",o="[object String]",s="[object Boolean]",a=Math.PI/180,l=180/Math.PI,c="#",d="",f="0",g="Konva warning: ",p="Konva error: ",u="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},b=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let x=[];const m=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(h){setTimeout(h,60)};e.Util={_isElement(h){return!!(h&&h.nodeType==1)},_isFunction(h){return!!(h&&h.constructor&&h.call&&h.apply)},_isPlainObject(h){return!!h&&h.constructor===Object},_isArray(h){return Object.prototype.toString.call(h)===i},_isNumber(h){return Object.prototype.toString.call(h)===r&&!isNaN(h)&&isFinite(h)},_isString(h){return Object.prototype.toString.call(h)===o},_isBoolean(h){return Object.prototype.toString.call(h)===s},isObject(h){return h instanceof Object},isValidSelector(h){if(typeof h!="string")return!1;const y=h[0];return y==="#"||y==="."||y===y.toUpperCase()},_sign(h){return h===0||h>0?1:-1},requestAnimFrame(h){x.push(h),x.length===1&&m(function(){const y=x;x=[],y.forEach(function(S){S()})})},createCanvasElement(){const h=document.createElement("canvas");try{h.style=h.style||{}}catch{}return h},createImageElement(){return document.createElement("img")},_isInDocument(h){for(;h=h.parentNode;)if(h==document)return!0;return!1},_urlToImage(h,y){const S=e.Util.createImageElement();S.onload=function(){y(S)},S.src=h},_rgbToHex(h,y,S){return(16777216+(h<<16)+(y<<8)+S).toString(16).slice(1)},_hexToRgb(h){h=h.replace(c,d);const y=parseInt(h,16);return{r:y>>16&255,g:y>>8&255,b:y&255}},getRandomColor(){let h=(Math.random()*16777215<<0).toString(16);for(;h.length<6;)h=f+h;return c+h},getRGB(h){let y;return h in v?(y=v[h],{r:y[0],g:y[1],b:y[2]}):h[0]===c?this._hexToRgb(h.substring(1)):h.substr(0,4)===u?(y=b.exec(h.replace(/ /g,"")),{r:parseInt(y[1],10),g:parseInt(y[2],10),b:parseInt(y[3],10)}):{r:0,g:0,b:0}},colorToRGBA(h){return h=h||"black",e.Util._namedColorToRBA(h)||e.Util._hex3ColorToRGBA(h)||e.Util._hex4ColorToRGBA(h)||e.Util._hex6ColorToRGBA(h)||e.Util._hex8ColorToRGBA(h)||e.Util._rgbColorToRGBA(h)||e.Util._rgbaColorToRGBA(h)||e.Util._hslColorToRGBA(h)},_namedColorToRBA(h){const y=v[h.toLowerCase()];return y?{r:y[0],g:y[1],b:y[2],a:1}:null},_rgbColorToRGBA(h){if(h.indexOf("rgb(")===0){h=h.match(/rgb\(([^)]+)\)/)[1];const y=h.split(/ *, */).map(Number);return{r:y[0],g:y[1],b:y[2],a:1}}},_rgbaColorToRGBA(h){if(h.indexOf("rgba(")===0){h=h.match(/rgba\(([^)]+)\)/)[1];const y=h.split(/ *, */).map((S,E)=>S.slice(-1)==="%"?E===3?parseInt(S)/100:parseInt(S)/100*255:Number(S));return{r:y[0],g:y[1],b:y[2],a:y[3]}}},_hex8ColorToRGBA(h){if(h[0]==="#"&&h.length===9)return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16),a:parseInt(h.slice(7,9),16)/255}},_hex6ColorToRGBA(h){if(h[0]==="#"&&h.length===7)return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16),a:1}},_hex4ColorToRGBA(h){if(h[0]==="#"&&h.length===5)return{r:parseInt(h[1]+h[1],16),g:parseInt(h[2]+h[2],16),b:parseInt(h[3]+h[3],16),a:parseInt(h[4]+h[4],16)/255}},_hex3ColorToRGBA(h){if(h[0]==="#"&&h.length===4)return{r:parseInt(h[1]+h[1],16),g:parseInt(h[2]+h[2],16),b:parseInt(h[3]+h[3],16),a:1}},_hslColorToRGBA(h){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(h)){const[y,...S]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(h),E=Number(S[0])/360,D=Number(S[1])/100,C=Number(S[2])/100;let w,k,T;if(D===0)return T=C*255,{r:Math.round(T),g:Math.round(T),b:Math.round(T),a:1};C<.5?w=C*(1+D):w=C+D-C*D;const R=2*C-w,L=[0,0,0];for(let U=0;U<3;U++)k=E+.3333333333333333*-(U-1),k<0&&k++,k>1&&k--,6*k<1?T=R+(w-R)*6*k:2*k<1?T=w:3*k<2?T=R+(w-R)*(.6666666666666666-k)*6:T=R,L[U]=T*255;return{r:Math.round(L[0]),g:Math.round(L[1]),b:Math.round(L[2]),a:1}}},haveIntersection(h,y){return!(y.x>h.x+h.width||y.x+y.width<h.x||y.y>h.y+h.height||y.y+y.height<h.y)},cloneObject(h){const y={};for(const S in h)this._isPlainObject(h[S])?y[S]=this.cloneObject(h[S]):this._isArray(h[S])?y[S]=this.cloneArray(h[S]):y[S]=h[S];return y},cloneArray(h){return h.slice(0)},degToRad(h){return h*a},radToDeg(h){return h*l},_degToRad(h){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(h)},_radToDeg(h){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(h)},_getRotation(h){return t.Konva.angleDeg?e.Util.radToDeg(h):h},_capitalize(h){return h.charAt(0).toUpperCase()+h.slice(1)},throw(h){throw new Error(p+h)},error(h){console.error(p+h)},warn(h){t.Konva.showWarnings&&console.warn(g+h)},each(h,y){for(const S in h)y(S,h[S])},_inRange(h,y,S){return y<=h&&h<S},_getProjectionToSegment(h,y,S,E,D,C){let w,k,T;const R=(h-S)*(h-S)+(y-E)*(y-E);if(R==0)w=h,k=y,T=(D-S)*(D-S)+(C-E)*(C-E);else{const L=((D-h)*(S-h)+(C-y)*(E-y))/R;L<0?(w=h,k=y,T=(h-D)*(h-D)+(y-C)*(y-C)):L>1?(w=S,k=E,T=(S-D)*(S-D)+(E-C)*(E-C)):(w=h+L*(S-h),k=y+L*(E-y),T=(w-D)*(w-D)+(k-C)*(k-C))}return[w,k,T]},_getProjectionToLine(h,y,S){const E=e.Util.cloneObject(h);let D=Number.MAX_VALUE;return y.forEach(function(C,w){if(!S&&w===y.length-1)return;const k=y[(w+1)%y.length],T=e.Util._getProjectionToSegment(C.x,C.y,k.x,k.y,h.x,h.y),R=T[0],L=T[1],U=T[2];U<D&&(E.x=R,E.y=L,D=U)}),E},_prepareArrayForTween(h,y,S){const E=[],D=[];if(h.length>y.length){const w=y;y=h,h=w}for(let w=0;w<h.length;w+=2)E.push({x:h[w],y:h[w+1]});for(let w=0;w<y.length;w+=2)D.push({x:y[w],y:y[w+1]});const C=[];return D.forEach(function(w){const k=e.Util._getProjectionToLine(w,E,S);C.push(k.x),C.push(k.y)}),C},_prepareToStringify(h){let y;h.visitedByCircularReferenceRemoval=!0;for(const S in h)if(h.hasOwnProperty(S)&&h[S]&&typeof h[S]=="object"){if(y=Object.getOwnPropertyDescriptor(h,S),h[S].visitedByCircularReferenceRemoval||e.Util._isElement(h[S]))if(y.configurable)delete h[S];else return null;else if(e.Util._prepareToStringify(h[S])===null)if(y.configurable)delete h[S];else return null}return delete h.visitedByCircularReferenceRemoval,h},_assign(h,y){for(const S in y)h[S]=y[S];return h},_getFirstPointerId(h){return h.touches?h.changedTouches[0].identifier:h.pointerId||999},releaseCanvas(...h){t.Konva.releaseCanvasOnDestroy&&h.forEach(y=>{y.width=0,y.height=0})},drawRoundedRectPath(h,y,S,E){let D=0,C=0,w=0,k=0;typeof E=="number"?D=C=w=k=Math.min(E,y/2,S/2):(D=Math.min(E[0]||0,y/2,S/2),C=Math.min(E[1]||0,y/2,S/2),k=Math.min(E[2]||0,y/2,S/2),w=Math.min(E[3]||0,y/2,S/2)),h.moveTo(D,0),h.lineTo(y-C,0),h.arc(y-C,C,C,Math.PI*3/2,0,!1),h.lineTo(y,S-k),h.arc(y-k,S-k,k,0,Math.PI/2,!1),h.lineTo(w,S),h.arc(w,S-w,w,Math.PI/2,Math.PI,!1),h.lineTo(0,D),h.arc(D,D,D,Math.PI,Math.PI*3/2,!1)}}}(Xs)),Xs}var Li={},fn={},pn={},ru;function ou(){if(ru)return pn;ru=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.HitContext=pn.SceneContext=pn.Context=void 0;const e=et(),t=Pe();function n(x){const m=[],h=x.length,y=e.Util;for(let S=0;S<h;S++){let E=x[S];y._isNumber(E)?E=Math.round(E*1e3)/1e3:y._isString(E)||(E=E+""),m.push(E)}return m}const i=",",r="(",o=")",s="([",a="])",l=";",c="()",d="=",f=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],p=100;let u=class{constructor(m){this.canvas=m,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(m){m.fillEnabled()&&this._fill(m)}_fill(m){}strokeShape(m){m.hasStroke()&&this._stroke(m)}_stroke(m){}fillStrokeShape(m){m.attrs.fillAfterStrokeEnabled?(this.strokeShape(m),this.fillShape(m)):(this.fillShape(m),this.strokeShape(m))}getTrace(m,h){let y=this.traceArr,S=y.length,E="",D,C,w,k;for(D=0;D<S;D++)C=y[D],w=C.method,w?(k=C.args,E+=w,m?E+=c:e.Util._isArray(k[0])?E+=s+k.join(i)+a:(h&&(k=k.map(T=>typeof T=="number"?Math.floor(T):T)),E+=r+k.join(i)+o)):(E+=C.property,m||(E+=d+C.val)),E+=l;return E}clearTrace(){this.traceArr=[]}_trace(m){let h=this.traceArr,y;h.push(m),y=h.length,y>=p&&h.shift()}reset(){const m=this.getCanvas().getPixelRatio();this.setTransform(1*m,0,0,1*m,0,0)}getCanvas(){return this.canvas}clear(m){const h=this.getCanvas();m?this.clearRect(m.x||0,m.y||0,m.width||0,m.height||0):this.clearRect(0,0,h.getWidth()/h.pixelRatio,h.getHeight()/h.pixelRatio)}_applyLineCap(m){const h=m.attrs.lineCap;h&&this.setAttr("lineCap",h)}_applyOpacity(m){const h=m.getAbsoluteOpacity();h!==1&&this.setAttr("globalAlpha",h)}_applyLineJoin(m){const h=m.attrs.lineJoin;h&&this.setAttr("lineJoin",h)}setAttr(m,h){this._context[m]=h}arc(m,h,y,S,E,D){this._context.arc(m,h,y,S,E,D)}arcTo(m,h,y,S,E){this._context.arcTo(m,h,y,S,E)}beginPath(){this._context.beginPath()}bezierCurveTo(m,h,y,S,E,D){this._context.bezierCurveTo(m,h,y,S,E,D)}clearRect(m,h,y,S){this._context.clearRect(m,h,y,S)}clip(...m){this._context.clip.apply(this._context,m)}closePath(){this._context.closePath()}createImageData(m,h){const y=arguments;if(y.length===2)return this._context.createImageData(m,h);if(y.length===1)return this._context.createImageData(m)}createLinearGradient(m,h,y,S){return this._context.createLinearGradient(m,h,y,S)}createPattern(m,h){return this._context.createPattern(m,h)}createRadialGradient(m,h,y,S,E,D){return this._context.createRadialGradient(m,h,y,S,E,D)}drawImage(m,h,y,S,E,D,C,w,k){const T=arguments,R=this._context;T.length===3?R.drawImage(m,h,y):T.length===5?R.drawImage(m,h,y,S,E):T.length===9&&R.drawImage(m,h,y,S,E,D,C,w,k)}ellipse(m,h,y,S,E,D,C,w){this._context.ellipse(m,h,y,S,E,D,C,w)}isPointInPath(m,h,y,S){return y?this._context.isPointInPath(y,m,h,S):this._context.isPointInPath(m,h,S)}fill(...m){this._context.fill.apply(this._context,m)}fillRect(m,h,y,S){this._context.fillRect(m,h,y,S)}strokeRect(m,h,y,S){this._context.strokeRect(m,h,y,S)}fillText(m,h,y,S){S?this._context.fillText(m,h,y,S):this._context.fillText(m,h,y)}measureText(m){return this._context.measureText(m)}getImageData(m,h,y,S){return this._context.getImageData(m,h,y,S)}lineTo(m,h){this._context.lineTo(m,h)}moveTo(m,h){this._context.moveTo(m,h)}rect(m,h,y,S){this._context.rect(m,h,y,S)}roundRect(m,h,y,S,E){this._context.roundRect(m,h,y,S,E)}putImageData(m,h,y){this._context.putImageData(m,h,y)}quadraticCurveTo(m,h,y,S){this._context.quadraticCurveTo(m,h,y,S)}restore(){this._context.restore()}rotate(m){this._context.rotate(m)}save(){this._context.save()}scale(m,h){this._context.scale(m,h)}setLineDash(m){this._context.setLineDash?this._context.setLineDash(m):"mozDash"in this._context?this._context.mozDash=m:"webkitLineDash"in this._context&&(this._context.webkitLineDash=m)}getLineDash(){return this._context.getLineDash()}setTransform(m,h,y,S,E,D){this._context.setTransform(m,h,y,S,E,D)}stroke(m){m?this._context.stroke(m):this._context.stroke()}strokeText(m,h,y,S){this._context.strokeText(m,h,y,S)}transform(m,h,y,S,E,D){this._context.transform(m,h,y,S,E,D)}translate(m,h){this._context.translate(m,h)}_enableTrace(){let m=this,h=f.length,y=this.setAttr,S,E;const D=function(C){let w=m[C],k;m[C]=function(){return E=n(Array.prototype.slice.call(arguments,0)),k=w.apply(m,arguments),m._trace({method:C,args:E}),k}};for(S=0;S<h;S++)D(f[S]);m.setAttr=function(){y.apply(m,arguments);const C=arguments[0];let w=arguments[1];(C==="shadowOffsetX"||C==="shadowOffsetY"||C==="shadowBlur")&&(w=w/this.canvas.getPixelRatio()),m._trace({property:C,val:w})}}_applyGlobalCompositeOperation(m){const h=m.attrs.globalCompositeOperation;!h||h==="source-over"||this.setAttr("globalCompositeOperation",h)}};pn.Context=u,g.forEach(function(x){Object.defineProperty(u.prototype,x,{get(){return this._context[x]},set(m){this._context[x]=m}})});class v extends u{constructor(m,{willReadFrequently:h=!1}={}){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:h})}_fillColor(m){const h=m.fill();this.setAttr("fillStyle",h),m._fillFunc(this)}_fillPattern(m){this.setAttr("fillStyle",m._getFillPattern()),m._fillFunc(this)}_fillLinearGradient(m){const h=m._getLinearGradient();h&&(this.setAttr("fillStyle",h),m._fillFunc(this))}_fillRadialGradient(m){const h=m._getRadialGradient();h&&(this.setAttr("fillStyle",h),m._fillFunc(this))}_fill(m){const h=m.fill(),y=m.getFillPriority();if(h&&y==="color"){this._fillColor(m);return}const S=m.getFillPatternImage();if(S&&y==="pattern"){this._fillPattern(m);return}const E=m.getFillLinearGradientColorStops();if(E&&y==="linear-gradient"){this._fillLinearGradient(m);return}const D=m.getFillRadialGradientColorStops();if(D&&y==="radial-gradient"){this._fillRadialGradient(m);return}h?this._fillColor(m):S?this._fillPattern(m):E?this._fillLinearGradient(m):D&&this._fillRadialGradient(m)}_strokeLinearGradient(m){const h=m.getStrokeLinearGradientStartPoint(),y=m.getStrokeLinearGradientEndPoint(),S=m.getStrokeLinearGradientColorStops(),E=this.createLinearGradient(h.x,h.y,y.x,y.y);if(S){for(let D=0;D<S.length;D+=2)E.addColorStop(S[D],S[D+1]);this.setAttr("strokeStyle",E)}}_stroke(m){const h=m.dash(),y=m.getStrokeScaleEnabled();if(m.hasStroke()){if(!y){this.save();const E=this.getCanvas().getPixelRatio();this.setTransform(E,0,0,E,0,0)}this._applyLineCap(m),h&&m.dashEnabled()&&(this.setLineDash(h),this.setAttr("lineDashOffset",m.dashOffset())),this.setAttr("lineWidth",m.strokeWidth()),m.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),m.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(m):this.setAttr("strokeStyle",m.stroke()),m._strokeFunc(this),y||this.restore()}}_applyShadow(m){var h,y,S;const E=(h=m.getShadowRGBA())!==null&&h!==void 0?h:"black",D=(y=m.getShadowBlur())!==null&&y!==void 0?y:5,C=(S=m.getShadowOffset())!==null&&S!==void 0?S:{x:0,y:0},w=m.getAbsoluteScale(),k=this.canvas.getPixelRatio(),T=w.x*k,R=w.y*k;this.setAttr("shadowColor",E),this.setAttr("shadowBlur",D*Math.min(Math.abs(T),Math.abs(R))),this.setAttr("shadowOffsetX",C.x*T),this.setAttr("shadowOffsetY",C.y*R)}}pn.SceneContext=v;class b extends u{constructor(m){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:!0})}_fill(m){this.save(),this.setAttr("fillStyle",m.colorKey),m._fillFuncHit(this),this.restore()}strokeShape(m){m.hasHitStroke()&&this._stroke(m)}_stroke(m){if(m.hasHitStroke()){const h=m.getStrokeScaleEnabled();if(!h){this.save();const E=this.getCanvas().getPixelRatio();this.setTransform(E,0,0,E,0,0)}this._applyLineCap(m);const y=m.hitStrokeWidth(),S=y==="auto"?m.strokeWidth():y;this.setAttr("lineWidth",S),this.setAttr("strokeStyle",m.colorKey),m._strokeFuncHit(this),h||this.restore()}}}return pn.HitContext=b,pn}var su;function bo(){if(su)return fn;su=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.HitCanvas=fn.SceneCanvas=fn.Canvas=void 0;const e=et(),t=ou(),n=Pe();let i;function r(){if(i)return i;const l=e.Util.createCanvasElement(),c=l.getContext("2d");return i=function(){const d=n.Konva._global.devicePixelRatio||1,f=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;return d/f}(),e.Util.releaseCanvas(l),i}let o=class{constructor(c){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const f=(c||{}).pixelRatio||n.Konva.pixelRatio||r();this.pixelRatio=f,this._canvas=e.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(c){const d=this.pixelRatio;this.pixelRatio=c,this.setSize(this.getWidth()/d,this.getHeight()/d)}setWidth(c){this.width=this._canvas.width=c*this.pixelRatio,this._canvas.style.width=c+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}setHeight(c){this.height=this._canvas.height=c*this.pixelRatio,this._canvas.style.height=c+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}getWidth(){return this.width}getHeight(){return this.height}setSize(c,d){this.setWidth(c||0),this.setHeight(d||0)}toDataURL(c,d){try{return this._canvas.toDataURL(c,d)}catch{try{return this._canvas.toDataURL()}catch(g){return e.Util.error("Unable to get data URL. "+g.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};fn.Canvas=o;class s extends o{constructor(c={width:0,height:0,willReadFrequently:!1}){super(c),this.context=new t.SceneContext(this,{willReadFrequently:c.willReadFrequently}),this.setSize(c.width,c.height)}}fn.SceneCanvas=s;class a extends o{constructor(c={width:0,height:0}){super(c),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(c.width,c.height)}}return fn.HitCanvas=a,fn}var Js={},au;function Qs(){return au||(au=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=Pe(),n=et();e.DD={get isDragging(){let i=!1;return e.DD._dragElements.forEach(r=>{r.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return e.DD._dragElements.forEach(r=>{i=r.node}),i},_dragElements:new Map,_drag(i){const r=[];e.DD._dragElements.forEach((o,s)=>{const{node:a}=o,l=a.getStage();l.setPointersPositions(i),o.pointerId===void 0&&(o.pointerId=n.Util._getFirstPointerId(i));const c=l._changedPointerPositions.find(d=>d.id===o.pointerId);if(c){if(o.dragStatus!=="dragging"){const d=a.dragDistance();if(Math.max(Math.abs(c.x-o.startPointerPos.x),Math.abs(c.y-o.startPointerPos.y))<d||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,o),r.push(a)}}),r.forEach(o=>{o.fire("dragmove",{type:"dragmove",target:o,evt:i},!0)})},_endDragBefore(i){const r=[];e.DD._dragElements.forEach(o=>{const{node:s}=o,a=s.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(d=>d.id===o.pointerId))return;(o.dragStatus==="dragging"||o.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,o.dragStatus="stopped");const c=o.node.getLayer()||o.node instanceof t.Konva.Stage&&o.node;c&&r.indexOf(c)===-1&&r.push(c)}),r.forEach(o=>{o.draw()})},_endDragAfter(i){e.DD._dragElements.forEach((r,o)=>{r.dragStatus==="stopped"&&r.node.fire("dragend",{type:"dragend",target:r.node,evt:i},!0),r.dragStatus!=="dragging"&&e.DD._dragElements.delete(o)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))}(Js)),Js}var ea={},xt={},lu;function Ee(){if(lu)return xt;lu=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.RGBComponent=i,xt.alphaComponent=r,xt.getNumberValidator=o,xt.getNumberOrArrayOfNumbersValidator=s,xt.getNumberOrAutoValidator=a,xt.getStringValidator=l,xt.getStringOrGradientValidator=c,xt.getFunctionValidator=d,xt.getNumberArrayValidator=f,xt.getBooleanValidator=g,xt.getComponentValidator=p;const e=Pe(),t=et();function n(u){return t.Util._isString(u)?'"'+u+'"':Object.prototype.toString.call(u)==="[object Number]"||t.Util._isBoolean(u)?u:Object.prototype.toString.call(u)}function i(u){return u>255?255:u<0?0:Math.round(u)}function r(u){return u>1?1:u<1e-4?1e-4:u}function o(){if(e.Konva.isUnminified)return function(u,v){return t.Util._isNumber(u)||t.Util.warn(n(u)+' is a not valid value for "'+v+'" attribute. The value should be a number.'),u}}function s(u){if(e.Konva.isUnminified)return function(v,b){let x=t.Util._isNumber(v),m=t.Util._isArray(v)&&v.length==u;return!x&&!m&&t.Util.warn(n(v)+' is a not valid value for "'+b+'" attribute. The value should be a number or Array<number>('+u+")"),v}}function a(){if(e.Konva.isUnminified)return function(u,v){return t.Util._isNumber(u)||u==="auto"||t.Util.warn(n(u)+' is a not valid value for "'+v+'" attribute. The value should be a number or "auto".'),u}}function l(){if(e.Konva.isUnminified)return function(u,v){return t.Util._isString(u)||t.Util.warn(n(u)+' is a not valid value for "'+v+'" attribute. The value should be a string.'),u}}function c(){if(e.Konva.isUnminified)return function(u,v){const b=t.Util._isString(u),x=Object.prototype.toString.call(u)==="[object CanvasGradient]"||u&&u.addColorStop;return b||x||t.Util.warn(n(u)+' is a not valid value for "'+v+'" attribute. The value should be a string or a native gradient.'),u}}function d(){if(e.Konva.isUnminified)return function(u,v){return t.Util._isFunction(u)||t.Util.warn(n(u)+' is a not valid value for "'+v+'" attribute. The value should be a function.'),u}}function f(){if(e.Konva.isUnminified)return function(u,v){const b=Int8Array?Object.getPrototypeOf(Int8Array):null;return b&&u instanceof b||(t.Util._isArray(u)?u.forEach(function(x){t.Util._isNumber(x)||t.Util.warn('"'+v+'" attribute has non numeric element '+x+". Make sure that all elements are numbers.")}):t.Util.warn(n(u)+' is a not valid value for "'+v+'" attribute. The value should be a array of numbers.')),u}}function g(){if(e.Konva.isUnminified)return function(u,v){return u===!0||u===!1||t.Util.warn(n(u)+' is a not valid value for "'+v+'" attribute. The value should be a boolean.'),u}}function p(u){if(e.Konva.isUnminified)return function(v,b){return v==null||t.Util.isObject(v)||t.Util.warn(n(v)+' is a not valid value for "'+b+'" attribute. The value should be an object with properties '+u),v}}return xt}var cu;function Ae(){return cu||(cu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=et(),n=Ee(),i="get",r="set";e.Factory={addGetterSetter(o,s,a,l,c){e.Factory.addGetter(o,s,a),e.Factory.addSetter(o,s,l,c),e.Factory.addOverloadedGetterSetter(o,s)},addGetter(o,s,a){const l=i+t.Util._capitalize(s);o.prototype[l]=o.prototype[l]||function(){const c=this.attrs[s];return c===void 0?a:c}},addSetter(o,s,a,l){const c=r+t.Util._capitalize(s);o.prototype[c]||e.Factory.overWriteSetter(o,s,a,l)},overWriteSetter(o,s,a,l){const c=r+t.Util._capitalize(s);o.prototype[c]=function(d){return a&&d!==void 0&&d!==null&&(d=a.call(this,d,s)),this._setAttr(s,d),l&&l.call(this),this}},addComponentsGetterSetter(o,s,a,l,c){const d=a.length,f=t.Util._capitalize,g=i+f(s),p=r+f(s);o.prototype[g]=function(){const v={};for(let b=0;b<d;b++){const x=a[b];v[x]=this.getAttr(s+f(x))}return v};const u=(0,n.getComponentValidator)(a);o.prototype[p]=function(v){const b=this.attrs[s];l&&(v=l.call(this,v,s)),u&&u.call(this,v,s);for(const x in v)v.hasOwnProperty(x)&&this._setAttr(s+f(x),v[x]);return v||a.forEach(x=>{this._setAttr(s+f(x),void 0)}),this._fireChangeEvent(s,b,v),c&&c.call(this),this},e.Factory.addOverloadedGetterSetter(o,s)},addOverloadedGetterSetter(o,s){const a=t.Util._capitalize(s),l=r+a,c=i+a;o.prototype[s]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(o,s,a,l){t.Util.error("Adding deprecated "+s);const c=i+t.Util._capitalize(s),d=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[c]=function(){t.Util.error(d);const f=this.attrs[s];return f===void 0?a:f},e.Factory.addSetter(o,s,l,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(o,s)},backCompat(o,s){t.Util.each(s,function(a,l){const c=o.prototype[l],d=i+t.Util._capitalize(a),f=r+t.Util._capitalize(a);function g(){c.apply(this,arguments),t.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}o.prototype[a]=g,o.prototype[d]=g,o.prototype[f]=g})},afterSetFilter(){this._filterUpToDate=!1}}}(ea)),ea}var uu;function tt(){if(uu)return Li;uu=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.Node=void 0;const e=bo(),t=Qs(),n=Ae(),i=Pe(),r=et(),o=Ee(),s="absoluteOpacity",a="allEventListeners",l="absoluteTransform",c="absoluteScale",d="canvas",f="Change",g="children",p="konva",u="listening",v="mouseenter",b="mouseleave",x="pointerenter",m="pointerleave",h="touchenter",y="touchleave",S="set",E="Shape",D=" ",C="stage",w="transform",k="Stage",T="visible",R=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(D);let L=1,U=class Za{constructor(_){this._id=L++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(_),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(_){(_===w||_===l)&&this._cache.get(_)?this._cache.get(_).dirty=!0:_?this._cache.delete(_):this._cache.clear()}_getCache(_,P){let N=this._cache.get(_);return(N===void 0||(_===w||_===l)&&N.dirty===!0)&&(N=P.call(this),this._cache.set(_,N)),N}_calculate(_,P,N){if(!this._attachedDepsListeners.get(_)){const O=P.map(G=>G+"Change.konva").join(D);this.on(O,()=>{this._clearCache(_)}),this._attachedDepsListeners.set(_,!0)}return this._getCache(_,N)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(_){this._clearCache(_),_===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(d)){const{scene:_,filter:P,hit:N,buffer:O}=this._cache.get(d);r.Util.releaseCanvas(_,P,N,O),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(_){const P=_||{};let N={};(P.x===void 0||P.y===void 0||P.width===void 0||P.height===void 0)&&(N=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let O=Math.ceil(P.width||N.width),G=Math.ceil(P.height||N.height),H=P.pixelRatio,V=P.x===void 0?Math.floor(N.x):P.x,te=P.y===void 0?Math.floor(N.y):P.y,se=P.offset||0,F=P.drawBorder||!1,A=P.hitCanvasPixelRatio||1;if(!O||!G){r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const $=Math.abs(Math.round(N.x)-V)>.5?1:0,j=Math.abs(Math.round(N.y)-te)>.5?1:0;O+=se*2+$,G+=se*2+j,V-=se,te-=se;const ee=new e.SceneCanvas({pixelRatio:H,width:O,height:G}),fe=new e.SceneCanvas({pixelRatio:H,width:0,height:0,willReadFrequently:!0}),M=new e.HitCanvas({pixelRatio:A,width:O,height:G}),I=ee.getContext(),B=M.getContext(),W=new e.SceneCanvas({width:ee.width/ee.pixelRatio+Math.abs(V),height:ee.height/ee.pixelRatio+Math.abs(te),pixelRatio:ee.pixelRatio}),J=W.getContext();return M.isCache=!0,ee.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,P.imageSmoothingEnabled===!1&&(ee.getContext()._context.imageSmoothingEnabled=!1,fe.getContext()._context.imageSmoothingEnabled=!1),I.save(),B.save(),J.save(),I.translate(-V,-te),B.translate(-V,-te),J.translate(-V,-te),W.x=V,W.y=te,this._isUnderCache=!0,this._clearSelfAndDescendantCache(s),this._clearSelfAndDescendantCache(c),this.drawScene(ee,this,W),this.drawHit(M,this),this._isUnderCache=!1,I.restore(),B.restore(),F&&(I.save(),I.beginPath(),I.rect(0,0,O,G),I.closePath(),I.setAttr("strokeStyle","red"),I.setAttr("lineWidth",5),I.stroke(),I.restore()),this._cache.set(d,{scene:ee,filter:fe,hit:M,buffer:W,x:V,y:te}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(_){throw new Error('abstract "getClientRect" method call')}_transformedRect(_,P){const N=[{x:_.x,y:_.y},{x:_.x+_.width,y:_.y},{x:_.x+_.width,y:_.y+_.height},{x:_.x,y:_.y+_.height}];let O=1/0,G=1/0,H=-1/0,V=-1/0;const te=this.getAbsoluteTransform(P);return N.forEach(function(se){const F=te.point(se);O===void 0&&(O=H=F.x,G=V=F.y),O=Math.min(O,F.x),G=Math.min(G,F.y),H=Math.max(H,F.x),V=Math.max(V,F.y)}),{x:O,y:G,width:H-O,height:V-G}}_drawCachedSceneCanvas(_){_.save(),_._applyOpacity(this),_._applyGlobalCompositeOperation(this);const P=this._getCanvasCache();_.translate(P.x,P.y);const N=this._getCachedSceneCanvas(),O=N.pixelRatio;_.drawImage(N._canvas,0,0,N.width/O,N.height/O),_.restore()}_drawCachedHitCanvas(_){const P=this._getCanvasCache(),N=P.hit;_.save(),_.translate(P.x,P.y),_.drawImage(N._canvas,0,0,N.width/N.pixelRatio,N.height/N.pixelRatio),_.restore()}_getCachedSceneCanvas(){let _=this.filters(),P=this._getCanvasCache(),N=P.scene,O=P.filter,G=O.getContext(),H,V,te,se;if(_){if(!this._filterUpToDate){const F=N.pixelRatio;O.setSize(N.width/N.pixelRatio,N.height/N.pixelRatio);try{for(H=_.length,G.clear(),G.drawImage(N._canvas,0,0,N.getWidth()/F,N.getHeight()/F),V=G.getImageData(0,0,O.getWidth(),O.getHeight()),te=0;te<H;te++){if(se=_[te],typeof se!="function"){r.Util.error("Filter should be type of function, but got "+typeof se+" instead. Please check correct filters");continue}se.call(this,V),G.putImageData(V,0,0)}}catch(A){r.Util.error("Unable to apply filter. "+A.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return O}return N}on(_,P){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const N=_.split(D);for(let O=0;O<N.length;O++){const H=N[O].split("."),V=H[0],te=H[1]||"";this.eventListeners[V]||(this.eventListeners[V]=[]),this.eventListeners[V].push({name:te,handler:P})}return this}off(_,P){let N=(_||"").split(D),O=N.length,G,H,V,te,se,F;if(this._cache&&this._cache.delete(a),!_)for(H in this.eventListeners)this._off(H);for(G=0;G<O;G++)if(V=N[G],te=V.split("."),se=te[0],F=te[1],se)this.eventListeners[se]&&this._off(se,F,P);else for(H in this.eventListeners)this._off(H,F,P);return this}dispatchEvent(_){const P={target:this,type:_.type,evt:_};return this.fire(_.type,P),this}addEventListener(_,P){return this.on(_,function(N){P.call(this,N.evt)}),this}removeEventListener(_){return this.off(_),this}_delegate(_,P,N){const O=this;this.on(_,function(G){const H=G.target.findAncestors(P,!0,O);for(let V=0;V<H.length;V++)G=r.Util.cloneObject(G),G.currentTarget=H[V],N.call(H[V],G)})}remove(){return this.isDragging()&&this.stopDrag(),t.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(s),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(C),this._clearSelfAndDescendantCache(T),this._clearSelfAndDescendantCache(u)}_remove(){this._clearCaches();const _=this.getParent();_&&_.children&&(_.children.splice(this.index,1),_._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(_){const P="get"+r.Util._capitalize(_);return r.Util._isFunction(this[P])?this[P]():this.attrs[_]}getAncestors(){let _=this.getParent(),P=[];for(;_;)P.push(_),_=_.getParent();return P}getAttrs(){return this.attrs||{}}setAttrs(_){return this._batchTransformChanges(()=>{let P,N;if(!_)return this;for(P in _)P!==g&&(N=S+r.Util._capitalize(P),r.Util._isFunction(this[N])?this[N](_[P]):this._setAttr(P,_[P]))}),this}isListening(){return this._getCache(u,this._isListening)}_isListening(_){if(!this.listening())return!1;const N=this.getParent();return N&&N!==_&&this!==_?N._isListening(_):!0}isVisible(){return this._getCache(T,this._isVisible)}_isVisible(_){if(!this.visible())return!1;const N=this.getParent();return N&&N!==_&&this!==_?N._isVisible(_):!0}shouldDrawHit(_,P=!1){if(_)return this._isVisible(_)&&this._isListening(_);const N=this.getLayer();let O=!1;t.DD._dragElements.forEach(H=>{H.dragStatus==="dragging"&&(H.node.nodeType==="Stage"||H.node.getLayer()===N)&&(O=!0)});const G=!P&&!i.Konva.hitOnDragEnabled&&(O||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!G}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let _=this.getDepth(),P=this,N=0,O,G,H,V;function te(F){for(O=[],G=F.length,H=0;H<G;H++)V=F[H],N++,V.nodeType!==E&&(O=O.concat(V.getChildren().slice())),V._id===P._id&&(H=G);O.length>0&&O[0].getDepth()<=_&&te(O)}const se=this.getStage();return P.nodeType!==k&&se&&te(se.getChildren()),N}getDepth(){let _=0,P=this.parent;for(;P;)_++,P=P.parent;return _}_batchTransformChanges(_){this._batchingTransformChange=!0,_(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(w),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(_){return this._batchTransformChanges(()=>{this.x(_.x),this.y(_.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const _=this.getStage();if(!_)return null;const P=_.getPointerPosition();if(!P)return null;const N=this.getAbsoluteTransform().copy();return N.invert(),N.point(P)}getAbsolutePosition(_){let P=!1,N=this.parent;for(;N;){if(N.isCached()){P=!0;break}N=N.parent}P&&!_&&(_=!0);const O=this.getAbsoluteTransform(_).getMatrix(),G=new r.Transform,H=this.offset();return G.m=O.slice(),G.translate(H.x,H.y),G.getTranslation()}setAbsolutePosition(_){const{x:P,y:N,...O}=this._clearTransform();this.attrs.x=P,this.attrs.y=N,this._clearCache(w);const G=this._getAbsoluteTransform().copy();return G.invert(),G.translate(_.x,_.y),_={x:this.attrs.x+G.getTranslation().x,y:this.attrs.y+G.getTranslation().y},this._setTransform(O),this.setPosition({x:_.x,y:_.y}),this._clearCache(w),this._clearSelfAndDescendantCache(l),this}_setTransform(_){let P;for(P in _)this.attrs[P]=_[P]}_clearTransform(){const _={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,_}move(_){let P=_.x,N=_.y,O=this.x(),G=this.y();return P!==void 0&&(O+=P),N!==void 0&&(G+=N),this.setPosition({x:O,y:G}),this}_eachAncestorReverse(_,P){let N=[],O=this.getParent(),G,H;if(!(P&&P._id===this._id)){for(N.unshift(this);O&&(!P||O._id!==P._id);)N.unshift(O),O=O.parent;for(G=N.length,H=0;H<G;H++)_(N[H])}}rotate(_){return this.rotation(this.rotation()+_),this}moveToTop(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const _=this.index,P=this.parent.getChildren().length;return _<P-1?(this.parent.children.splice(_,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;const _=this.index,P=this.parent.getChildren().length;return _<P-1?(this.parent.children.splice(_,1),this.parent.children.splice(_+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;const _=this.index;return _>0?(this.parent.children.splice(_,1),this.parent.children.splice(_-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const _=this.index;return _>0?(this.parent.children.splice(_,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(_){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(_<0||_>=this.parent.children.length)&&r.Util.warn("Unexpected value "+_+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const P=this.index;return this.parent.children.splice(P,1),this.parent.children.splice(_,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(s,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let _=this.opacity();const P=this.getParent();return P&&!P._isUnderCache&&(_*=P.getAbsoluteOpacity()),_}moveTo(_){return this.getParent()!==_&&(this._remove(),_.add(this)),this}toObject(){let _=this.getAttrs(),P,N,O,G,H;const V={attrs:{},className:this.getClassName()};for(P in _)N=_[P],H=r.Util.isObject(N)&&!r.Util._isPlainObject(N)&&!r.Util._isArray(N),!H&&(O=typeof this[P]=="function"&&this[P],delete _[P],G=O?O.call(this):null,_[P]=N,G!==N&&(V.attrs[P]=N));return r.Util._prepareToStringify(V)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(_,P,N){const O=[];P&&this._isMatch(_)&&O.push(this);let G=this.parent;for(;G;){if(G===N)return O;G._isMatch(_)&&O.push(G),G=G.parent}return O}isAncestorOf(_){return!1}findAncestor(_,P,N){return this.findAncestors(_,P,N)[0]}_isMatch(_){if(!_)return!1;if(typeof _=="function")return _(this);let P=_.replace(/ /g,"").split(","),N=P.length,O,G;for(O=0;O<N;O++)if(G=P[O],r.Util.isValidSelector(G)||(r.Util.warn('Selector "'+G+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),G.charAt(0)==="#"){if(this.id()===G.slice(1))return!0}else if(G.charAt(0)==="."){if(this.hasName(G.slice(1)))return!0}else if(this.className===G||this.nodeType===G)return!0;return!1}getLayer(){const _=this.getParent();return _?_.getLayer():null}getStage(){return this._getCache(C,this._getStage)}_getStage(){const _=this.getParent();return _?_.getStage():null}fire(_,P={},N){return P.target=P.target||this,N?this._fireAndBubble(_,P):this._fire(_,P),this}getAbsoluteTransform(_){return _?this._getAbsoluteTransform(_):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(_){let P;if(_)return P=new r.Transform,this._eachAncestorReverse(function(N){const O=N.transformsEnabled();O==="all"?P.multiply(N.getTransform()):O==="position"&&P.translate(N.x()-N.offsetX(),N.y()-N.offsetY())},_),P;{P=this._cache.get(l)||new r.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(P):P.reset();const N=this.transformsEnabled();if(N==="all")P.multiply(this.getTransform());else if(N==="position"){const O=this.attrs.x||0,G=this.attrs.y||0,H=this.attrs.offsetX||0,V=this.attrs.offsetY||0;P.translate(O-H,G-V)}return P.dirty=!1,P}}getAbsoluteScale(_){let P=this;for(;P;)P._isUnderCache&&(_=P),P=P.getParent();const O=this.getAbsoluteTransform(_).decompose();return{x:O.scaleX,y:O.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(w,this._getTransform)}_getTransform(){var _,P;const N=this._cache.get(w)||new r.Transform;N.reset();const O=this.x(),G=this.y(),H=i.Konva.getAngle(this.rotation()),V=(_=this.attrs.scaleX)!==null&&_!==void 0?_:1,te=(P=this.attrs.scaleY)!==null&&P!==void 0?P:1,se=this.attrs.skewX||0,F=this.attrs.skewY||0,A=this.attrs.offsetX||0,$=this.attrs.offsetY||0;return(O!==0||G!==0)&&N.translate(O,G),H!==0&&N.rotate(H),(se!==0||F!==0)&&N.skew(se,F),(V!==1||te!==1)&&N.scale(V,te),(A!==0||$!==0)&&N.translate(-1*A,-1*$),N.dirty=!1,N}clone(_){let P=r.Util.cloneObject(this.attrs),N,O,G,H,V;for(N in _)P[N]=_[N];const te=new this.constructor(P);for(N in this.eventListeners)for(O=this.eventListeners[N],G=O.length,H=0;H<G;H++)V=O[H],V.name.indexOf(p)<0&&(te.eventListeners[N]||(te.eventListeners[N]=[]),te.eventListeners[N].push(V));return te}_toKonvaCanvas(_){_=_||{};const P=this.getClientRect(),N=this.getStage(),O=_.x!==void 0?_.x:Math.floor(P.x),G=_.y!==void 0?_.y:Math.floor(P.y),H=_.pixelRatio||1,V=new e.SceneCanvas({width:_.width||Math.ceil(P.width)||(N?N.width():0),height:_.height||Math.ceil(P.height)||(N?N.height():0),pixelRatio:H}),te=V.getContext(),se=new e.SceneCanvas({width:V.width/V.pixelRatio+Math.abs(O),height:V.height/V.pixelRatio+Math.abs(G),pixelRatio:V.pixelRatio});return _.imageSmoothingEnabled===!1&&(te._context.imageSmoothingEnabled=!1),te.save(),(O||G)&&te.translate(-1*O,-1*G),this.drawScene(V,void 0,se),te.restore(),V}toCanvas(_){return this._toKonvaCanvas(_)._canvas}toDataURL(_){_=_||{};const P=_.mimeType||null,N=_.quality||null,O=this._toKonvaCanvas(_).toDataURL(P,N);return _.callback&&_.callback(O),O}toImage(_){return new Promise((P,N)=>{try{const O=_?.callback;O&&delete _.callback,r.Util._urlToImage(this.toDataURL(_),function(G){P(G),O?.(G)})}catch(O){N(O)}})}toBlob(_){return new Promise((P,N)=>{try{const O=_?.callback;O&&delete _.callback,this.toCanvas(_).toBlob(G=>{P(G),O?.(G)},_?.mimeType,_?.quality)}catch(O){N(O)}})}setSize(_){return this.width(_.width),this.height(_.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(_,P,N){let O=this.eventListeners[_],G,H,V;for(G=0;G<O.length;G++)if(H=O[G].name,V=O[G].handler,(H!=="konva"||P==="konva")&&(!P||H===P)&&(!N||N===V)){if(O.splice(G,1),O.length===0){delete this.eventListeners[_];break}G--}}_fireChangeEvent(_,P,N){this._fire(_+f,{oldVal:P,newVal:N})}addName(_){if(!this.hasName(_)){const P=this.name(),N=P?P+" "+_:_;this.name(N)}return this}hasName(_){if(!_)return!1;const P=this.name();return P?(P||"").split(/\s/g).indexOf(_)!==-1:!1}removeName(_){const P=(this.name()||"").split(/\s/g),N=P.indexOf(_);return N!==-1&&(P.splice(N,1),this.name(P.join(" "))),this}setAttr(_,P){const N=this[S+r.Util._capitalize(_)];return r.Util._isFunction(N)?N.call(this,P):this._setAttr(_,P),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const _=this.getLayer()||this.getStage();_?.batchDraw()}}_setAttr(_,P){const N=this.attrs[_];N===P&&!r.Util.isObject(P)||(P==null?delete this.attrs[_]:this.attrs[_]=P,this._shouldFireChangeEvents&&this._fireChangeEvent(_,N,P),this._requestDraw())}_setComponentAttr(_,P,N){let O;N!==void 0&&(O=this.attrs[_],O||(this.attrs[_]=this.getAttr(_)),this.attrs[_][P]=N,this._fireChangeEvent(_,O,N))}_fireAndBubble(_,P,N){P&&this.nodeType===E&&(P.target=this);const O=[v,b,x,m,h,y];if(!(O.indexOf(_)!==-1&&(N&&(this===N||this.isAncestorOf&&this.isAncestorOf(N))||this.nodeType==="Stage"&&!N))){this._fire(_,P);const H=O.indexOf(_)!==-1&&N&&N.isAncestorOf&&N.isAncestorOf(this)&&!N.isAncestorOf(this.parent);(P&&!P.cancelBubble||!P)&&this.parent&&this.parent.isListening()&&!H&&(N&&N.parent?this._fireAndBubble.call(this.parent,_,P,N):this._fireAndBubble.call(this.parent,_,P))}}_getProtoListeners(_){var P,N,O;const G=(P=this._cache.get(a))!==null&&P!==void 0?P:{};let H=G?.[_];if(H===void 0){H=[];let V=Object.getPrototypeOf(this);for(;V;){const te=(O=(N=V.eventListeners)===null||N===void 0?void 0:N[_])!==null&&O!==void 0?O:[];H.push(...te),V=Object.getPrototypeOf(V)}G[_]=H,this._cache.set(a,G)}return H}_fire(_,P){P=P||{},P.currentTarget=this,P.type=_;const N=this._getProtoListeners(_);if(N)for(let G=0;G<N.length;G++)N[G].handler.call(this,P);const O=this.eventListeners[_];if(O)for(let G=0;G<O.length;G++)O[G].handler.call(this,P)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(_){const P=_?_.pointerId:void 0,N=this.getStage(),O=this.getAbsolutePosition();if(!N)return;const G=N._getPointerById(P)||N._changedPointerPositions[0]||O;t.DD._dragElements.set(this._id,{node:this,startPointerPos:G,offset:{x:G.x-O.x,y:G.y-O.y},dragStatus:"ready",pointerId:P})}startDrag(_,P=!0){t.DD._dragElements.has(this._id)||this._createDragElement(_);const N=t.DD._dragElements.get(this._id);N.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:_&&_.evt},P)}_setDragPosition(_,P){const N=this.getStage()._getPointerById(P.pointerId);if(!N)return;let O={x:N.x-P.offset.x,y:N.y-P.offset.y};const G=this.dragBoundFunc();if(G!==void 0){const H=G.call(this,O,_);H?O=H:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==O.x||this._lastPos.y!==O.y)&&(this.setAbsolutePosition(O),this._requestDraw()),this._lastPos=O}stopDrag(_){const P=t.DD._dragElements.get(this._id);P&&(P.dragStatus="stopped"),t.DD._endDragBefore(_),t.DD._endDragAfter(_)}setDraggable(_){this._setAttr("draggable",_),this._dragChange()}isDragging(){const _=t.DD._dragElements.get(this._id);return _?_.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(_){if(!(!(_.evt.button!==void 0)||i.Konva.dragButtons.indexOf(_.evt.button)>=0)||this.isDragging())return;let O=!1;t.DD._dragElements.forEach(G=>{this.isAncestorOf(G.node)&&(O=!0)}),O||this._createDragElement(_)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const P=t.DD._dragElements.get(this._id),N=P&&P.dragStatus==="dragging",O=P&&P.dragStatus==="ready";N?this.stopDrag():O&&t.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(_={x:0,y:0}){const P=this.getStage();if(!P)return!1;const N={x:-_.x,y:-_.y,width:P.width()+2*_.x,height:P.height()+2*_.y};return r.Util.haveIntersection(N,this.getClientRect())}static create(_,P){return r.Util._isString(_)&&(_=JSON.parse(_)),this._createNode(_,P)}static _createNode(_,P){let N=Za.prototype.getClassName.call(_),O=_.children,G,H,V;P&&(_.attrs.container=P),i.Konva[N]||(r.Util.warn('Can not find a node with class name "'+N+'". Fallback to "Shape".'),N="Shape");const te=i.Konva[N];if(G=new te(_.attrs),O)for(H=O.length,V=0;V<H;V++)G.add(Za._createNode(O[V]));return G}};Li.Node=U,U.prototype.nodeType="Node",U.prototype._attrsAffectingSize=[],U.prototype.eventListeners={},U.prototype.on.call(U.prototype,R,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(w),this._clearSelfAndDescendantCache(l)}),U.prototype.on.call(U.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(T)}),U.prototype.on.call(U.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(u)}),U.prototype.on.call(U.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(s)});const z=n.Factory.addGetterSetter;return z(U,"zIndex"),z(U,"absolutePosition"),z(U,"position"),z(U,"x",0,(0,o.getNumberValidator)()),z(U,"y",0,(0,o.getNumberValidator)()),z(U,"globalCompositeOperation","source-over",(0,o.getStringValidator)()),z(U,"opacity",1,(0,o.getNumberValidator)()),z(U,"name","",(0,o.getStringValidator)()),z(U,"id","",(0,o.getStringValidator)()),z(U,"rotation",0,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"scale",["x","y"]),z(U,"scaleX",1,(0,o.getNumberValidator)()),z(U,"scaleY",1,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"skew",["x","y"]),z(U,"skewX",0,(0,o.getNumberValidator)()),z(U,"skewY",0,(0,o.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"offset",["x","y"]),z(U,"offsetX",0,(0,o.getNumberValidator)()),z(U,"offsetY",0,(0,o.getNumberValidator)()),z(U,"dragDistance",void 0,(0,o.getNumberValidator)()),z(U,"width",0,(0,o.getNumberValidator)()),z(U,"height",0,(0,o.getNumberValidator)()),z(U,"listening",!0,(0,o.getBooleanValidator)()),z(U,"preventDefault",!0,(0,o.getBooleanValidator)()),z(U,"filters",void 0,function(Z){return this._filterUpToDate=!1,Z}),z(U,"visible",!0,(0,o.getBooleanValidator)()),z(U,"transformsEnabled","all",(0,o.getStringValidator)()),z(U,"size"),z(U,"dragBoundFunc"),z(U,"draggable",!1,(0,o.getBooleanValidator)()),n.Factory.backCompat(U,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Li}var Gi={},du;function So(){if(du)return Gi;du=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.Container=void 0;const e=Ae(),t=tt(),n=Ee();let i=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(o){const s=this.children||[];return o?s.filter(o):s}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(o=>{o.parent=null,o.index=0,o.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(o=>{o.parent=null,o.index=0,o.destroy()}),this.children=[],this._requestDraw(),this}add(...o){if(o.length===0)return this;if(o.length>1){for(let a=0;a<o.length;a++)this.add(o[a]);return this}const s=o[0];return s.getParent()?(s.moveTo(this),this):(this._validateAdd(s),s.index=this.getChildren().length,s.parent=this,s._clearCaches(),this.getChildren().push(s),this._fire("add",{child:s}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(o){return this._generalFind(o,!1)}findOne(o){const s=this._generalFind(o,!0);return s.length>0?s[0]:void 0}_generalFind(o,s){const a=[];return this._descendants(l=>{const c=l._isMatch(o);return c&&a.push(l),!!(c&&s)}),a}_descendants(o){let s=!1;const a=this.getChildren();for(const l of a){if(s=o(l),s)return!0;if(l.hasChildren()&&(s=l._descendants(o),s))return!0}return!1}toObject(){const o=t.Node.prototype.toObject.call(this);return o.children=[],this.getChildren().forEach(s=>{o.children.push(s.toObject())}),o}isAncestorOf(o){let s=o.getParent();for(;s;){if(s._id===this._id)return!0;s=s.getParent()}return!1}clone(o){const s=t.Node.prototype.clone.call(this,o);return this.getChildren().forEach(function(a){s.add(a.clone())}),s}getAllIntersections(o){const s=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(o)&&s.push(a)}),s}_clearSelfAndDescendantCache(o){var s;super._clearSelfAndDescendantCache(o),!this.isCached()&&((s=this.children)===null||s===void 0||s.forEach(function(a){a._clearSelfAndDescendantCache(o)}))}_setChildrenIndices(){var o;(o=this.children)===null||o===void 0||o.forEach(function(s,a){s.index=a}),this._requestDraw()}drawScene(o,s,a){const l=this.getLayer(),c=o||l&&l.getCanvas(),d=c&&c.getContext(),f=this._getCanvasCache(),g=f&&f.scene,p=c&&c.isCache;if(!this.isVisible()&&!p)return this;if(g){d.save();const u=this.getAbsoluteTransform(s).getMatrix();d.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedSceneCanvas(d),d.restore()}else this._drawChildren("drawScene",c,s,a);return this}drawHit(o,s){if(!this.shouldDrawHit(s))return this;const a=this.getLayer(),l=o||a&&a.hitCanvas,c=l&&l.getContext(),d=this._getCanvasCache();if(d&&d.hit){c.save();const g=this.getAbsoluteTransform(s).getMatrix();c.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",l,s);return this}_drawChildren(o,s,a,l){var c;const d=s&&s.getContext(),f=this.clipWidth(),g=this.clipHeight(),p=this.clipFunc(),u=typeof f=="number"&&typeof g=="number"||p,v=a===this;if(u){d.save();const x=this.getAbsoluteTransform(a);let m=x.getMatrix();d.transform(m[0],m[1],m[2],m[3],m[4],m[5]),d.beginPath();let h;if(p)h=p.call(this,d,this);else{const y=this.clipX(),S=this.clipY();d.rect(y||0,S||0,f,g)}d.clip.apply(d,h),m=x.copy().invert().getMatrix(),d.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const b=!v&&this.globalCompositeOperation()!=="source-over"&&o==="drawScene";b&&(d.save(),d._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(x){x[o](s,a,l)}),b&&d.restore(),u&&d.restore()}getClientRect(o={}){var s;const a=o.skipTransform,l=o.relativeTo;let c,d,f,g,p={x:1/0,y:1/0,width:0,height:0};const u=this;(s=this.children)===null||s===void 0||s.forEach(function(x){if(!x.visible())return;const m=x.getClientRect({relativeTo:u,skipShadow:o.skipShadow,skipStroke:o.skipStroke});m.width===0&&m.height===0||(c===void 0?(c=m.x,d=m.y,f=m.x+m.width,g=m.y+m.height):(c=Math.min(c,m.x),d=Math.min(d,m.y),f=Math.max(f,m.x+m.width),g=Math.max(g,m.y+m.height)))});const v=this.find("Shape");let b=!1;for(let x=0;x<v.length;x++)if(v[x]._isVisible(this)){b=!0;break}return b&&c!==void 0?p={x:c,y:d,width:f-c,height:g-d}:p={x:0,y:0,width:0,height:0},a?p:this._transformedRect(p,l)}};return Gi.Container=i,e.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),e.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"clipFunc"),Gi}var ta={},An={},hu;function fu(){if(hu)return An;hu=1,Object.defineProperty(An,"__esModule",{value:!0}),An.getCapturedShape=i,An.createEvent=r,An.hasPointerCapture=o,An.setPointerCapture=s,An.releaseCapture=a;const e=Pe(),t=new Map,n=e.Konva._global.PointerEvent!==void 0;function i(l){return t.get(l)}function r(l){return{evt:l,pointerId:l.pointerId}}function o(l,c){return t.get(l)===c}function s(l,c){a(l),c.getStage()&&(t.set(l,c),n&&c._fire("gotpointercapture",r(new PointerEvent("gotpointercapture"))))}function a(l,c){const d=t.get(l);if(!d)return;const f=d.getStage();f&&f.content,t.delete(l),n&&d._fire("lostpointercapture",r(new PointerEvent("lostpointercapture")))}return An}var pu;function eg(){return pu||(pu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=et(),n=Ae(),i=So(),r=Pe(),o=bo(),s=Qs(),a=Pe(),l=fu(),c="Stage",d="string",f="px",g="mouseout",p="mouseleave",u="mouseover",v="mouseenter",b="mousemove",x="mousedown",m="mouseup",h="pointermove",y="pointerdown",S="pointerup",E="pointercancel",D="lostpointercapture",C="pointerout",w="pointerleave",k="pointerover",T="pointerenter",R="contextmenu",L="touchstart",U="touchend",z="touchmove",Z="touchcancel",_="wheel",P=5,N=[[v,"_pointerenter"],[x,"_pointerdown"],[b,"_pointermove"],[m,"_pointerup"],[p,"_pointerleave"],[L,"_pointerdown"],[z,"_pointermove"],[U,"_pointerup"],[Z,"_pointercancel"],[u,"_pointerover"],[_,"_wheel"],[R,"_contextmenu"],[y,"_pointerdown"],[h,"_pointermove"],[S,"_pointerup"],[E,"_pointercancel"],[w,"_pointerleave"],[D,"_lostpointercapture"]],O={mouse:{[C]:g,[w]:p,[k]:u,[T]:v,[h]:b,[y]:x,[S]:m,[E]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[w]:"touchleave",[k]:"touchover",[T]:"touchenter",[h]:z,[y]:L,[S]:U,[E]:Z,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[w]:w,[k]:k,[T]:T,[h]:h,[y]:y,[S]:S,[E]:E,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},G=F=>F.indexOf("pointer")>=0?"pointer":F.indexOf("touch")>=0?"touch":"mouse",H=F=>{const A=G(F);if(A==="pointer")return r.Konva.pointerEventsEnabled&&O.pointer;if(A==="touch")return O.touch;if(A==="mouse")return O.mouse};function V(F={}){return(F.clipFunc||F.clipWidth||F.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),F}const te="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class se extends i.Container{constructor(A){super(V(A)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{V(this.attrs)}),this._checkVisibility()}_validateAdd(A){const $=A.getType()==="Layer",j=A.getType()==="FastLayer";$||j||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const A=this.visible()?"":"none";this.content.style.display=A}setContainer(A){if(typeof A===d){let $;if(A.charAt(0)==="."){const j=A.slice(1);A=document.getElementsByClassName(j)[0]}else A.charAt(0)!=="#"?$=A:$=A.slice(1),A=document.getElementById($);if(!A)throw"Can not find container in document with id "+$}return this._setAttr("container",A),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),A.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const A=this.children,$=A.length;for(let j=0;j<$;j++)A[j].clear();return this}clone(A){return A||(A={}),A.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,A)}destroy(){super.destroy();const A=this.content;A&&t.Util._isInDocument(A)&&this.container().removeChild(A);const $=e.stages.indexOf(this);return $>-1&&e.stages.splice($,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const A=this._pointerPositions[0]||this._changedPointerPositions[0];return A?{x:A.x,y:A.y}:(t.Util.warn(te),null)}_getPointerById(A){return this._pointerPositions.find($=>$.id===A)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(A){A=A||{},A.x=A.x||0,A.y=A.y||0,A.width=A.width||this.width(),A.height=A.height||this.height();const $=new o.SceneCanvas({width:A.width,height:A.height,pixelRatio:A.pixelRatio||1}),j=$.getContext()._context,ee=this.children;return(A.x||A.y)&&j.translate(-1*A.x,-1*A.y),ee.forEach(function(fe){if(!fe.isVisible())return;const M=fe._toKonvaCanvas(A);j.drawImage(M._canvas,A.x,A.y,M.getWidth()/M.getPixelRatio(),M.getHeight()/M.getPixelRatio())}),$}getIntersection(A){if(!A)return null;const $=this.children,j=$.length,ee=j-1;for(let fe=ee;fe>=0;fe--){const M=$[fe].getIntersection(A);if(M)return M}return null}_resizeDOM(){const A=this.width(),$=this.height();this.content&&(this.content.style.width=A+f,this.content.style.height=$+f),this.bufferCanvas.setSize(A,$),this.bufferHitCanvas.setSize(A,$),this.children.forEach(j=>{j.setSize({width:A,height:$}),j.draw()})}add(A,...$){if(arguments.length>1){for(let ee=0;ee<arguments.length;ee++)this.add(arguments[ee]);return this}super.add(A);const j=this.children.length;return j>P&&t.Util.warn("The stage has "+j+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),A.setSize({width:this.width(),height:this.height()}),A.draw(),r.Konva.isBrowser&&this.content.appendChild(A.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(A){return l.hasPointerCapture(A,this)}setPointerCapture(A){l.setPointerCapture(A,this)}releaseCapture(A){l.releaseCapture(A,this)}getLayers(){return this.children}_bindContentEvents(){r.Konva.isBrowser&&N.forEach(([A,$])=>{this.content.addEventListener(A,j=>{this[$](j)},{passive:!1})})}_pointerenter(A){this.setPointersPositions(A);const $=H(A.type);$&&this._fire($.pointerenter,{evt:A,target:this,currentTarget:this})}_pointerover(A){this.setPointersPositions(A);const $=H(A.type);$&&this._fire($.pointerover,{evt:A,target:this,currentTarget:this})}_getTargetShape(A){let $=this[A+"targetShape"];return $&&!$.getStage()&&($=null),$}_pointerleave(A){const $=H(A.type),j=G(A.type);if(!$)return;this.setPointersPositions(A);const ee=this._getTargetShape(j),fe=!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled;ee&&fe?(ee._fireAndBubble($.pointerout,{evt:A}),ee._fireAndBubble($.pointerleave,{evt:A}),this._fire($.pointerleave,{evt:A,target:this,currentTarget:this}),this[j+"targetShape"]=null):fe&&(this._fire($.pointerleave,{evt:A,target:this,currentTarget:this}),this._fire($.pointerout,{evt:A,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(A){const $=H(A.type),j=G(A.type);if(!$)return;this.setPointersPositions(A);let ee=!1;this._changedPointerPositions.forEach(fe=>{const M=this.getIntersection(fe);if(s.DD.justDragged=!1,r.Konva["_"+j+"ListenClick"]=!0,!M||!M.isListening()){this[j+"ClickStartShape"]=void 0;return}r.Konva.capturePointerEventsEnabled&&M.setPointerCapture(fe.id),this[j+"ClickStartShape"]=M,M._fireAndBubble($.pointerdown,{evt:A,pointerId:fe.id}),ee=!0;const I=A.type.indexOf("touch")>=0;M.preventDefault()&&A.cancelable&&I&&A.preventDefault()}),ee||this._fire($.pointerdown,{evt:A,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(A){const $=H(A.type),j=G(A.type);if(!$||(r.Konva.isDragging()&&s.DD.node.preventDefault()&&A.cancelable&&A.preventDefault(),this.setPointersPositions(A),!(!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled)))return;const fe={};let M=!1;const I=this._getTargetShape(j);this._changedPointerPositions.forEach(B=>{const W=l.getCapturedShape(B.id)||this.getIntersection(B),J=B.id,K={evt:A,pointerId:J},ie=I!==W;if(ie&&I&&(I._fireAndBubble($.pointerout,{...K},W),I._fireAndBubble($.pointerleave,{...K},W)),W){if(fe[W._id])return;fe[W._id]=!0}W&&W.isListening()?(M=!0,ie&&(W._fireAndBubble($.pointerover,{...K},I),W._fireAndBubble($.pointerenter,{...K},I),this[j+"targetShape"]=W),W._fireAndBubble($.pointermove,{...K})):I&&(this._fire($.pointerover,{evt:A,target:this,currentTarget:this,pointerId:J}),this[j+"targetShape"]=null)}),M||this._fire($.pointermove,{evt:A,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(A){const $=H(A.type),j=G(A.type);if(!$)return;this.setPointersPositions(A);const ee=this[j+"ClickStartShape"],fe=this[j+"ClickEndShape"],M={};let I=!1;this._changedPointerPositions.forEach(B=>{const W=l.getCapturedShape(B.id)||this.getIntersection(B);if(W){if(W.releaseCapture(B.id),M[W._id])return;M[W._id]=!0}const J=B.id,K={evt:A,pointerId:J};let ie=!1;r.Konva["_"+j+"InDblClickWindow"]?(ie=!0,clearTimeout(this[j+"DblTimeout"])):s.DD.justDragged||(r.Konva["_"+j+"InDblClickWindow"]=!0,clearTimeout(this[j+"DblTimeout"])),this[j+"DblTimeout"]=setTimeout(function(){r.Konva["_"+j+"InDblClickWindow"]=!1},r.Konva.dblClickWindow),W&&W.isListening()?(I=!0,this[j+"ClickEndShape"]=W,W._fireAndBubble($.pointerup,{...K}),r.Konva["_"+j+"ListenClick"]&&ee&&ee===W&&(W._fireAndBubble($.pointerclick,{...K}),ie&&fe&&fe===W&&W._fireAndBubble($.pointerdblclick,{...K}))):(this[j+"ClickEndShape"]=null,r.Konva["_"+j+"ListenClick"]&&this._fire($.pointerclick,{evt:A,target:this,currentTarget:this,pointerId:J}),ie&&this._fire($.pointerdblclick,{evt:A,target:this,currentTarget:this,pointerId:J}))}),I||this._fire($.pointerup,{evt:A,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),r.Konva["_"+j+"ListenClick"]=!1,A.cancelable&&j!=="touch"&&j!=="pointer"&&A.preventDefault()}_contextmenu(A){this.setPointersPositions(A);const $=this.getIntersection(this.getPointerPosition());$&&$.isListening()?$._fireAndBubble(R,{evt:A}):this._fire(R,{evt:A,target:this,currentTarget:this})}_wheel(A){this.setPointersPositions(A);const $=this.getIntersection(this.getPointerPosition());$&&$.isListening()?$._fireAndBubble(_,{evt:A}):this._fire(_,{evt:A,target:this,currentTarget:this})}_pointercancel(A){this.setPointersPositions(A);const $=l.getCapturedShape(A.pointerId)||this.getIntersection(this.getPointerPosition());$&&$._fireAndBubble(S,l.createEvent(A)),l.releaseCapture(A.pointerId)}_lostpointercapture(A){l.releaseCapture(A.pointerId)}setPointersPositions(A){const $=this._getContentPosition();let j=null,ee=null;A=A||window.event,A.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(A.touches,fe=>{this._pointerPositions.push({id:fe.identifier,x:(fe.clientX-$.left)/$.scaleX,y:(fe.clientY-$.top)/$.scaleY})}),Array.prototype.forEach.call(A.changedTouches||A.touches,fe=>{this._changedPointerPositions.push({id:fe.identifier,x:(fe.clientX-$.left)/$.scaleX,y:(fe.clientY-$.top)/$.scaleY})})):(j=(A.clientX-$.left)/$.scaleX,ee=(A.clientY-$.top)/$.scaleY,this.pointerPos={x:j,y:ee},this._pointerPositions=[{x:j,y:ee,id:t.Util._getFirstPointerId(A)}],this._changedPointerPositions=[{x:j,y:ee,id:t.Util._getFirstPointerId(A)}])}_setPointerPosition(A){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(A)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const A=this.content.getBoundingClientRect();return{top:A.top,left:A.left,scaleX:A.width/this.content.clientWidth||1,scaleY:A.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new o.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new o.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!r.Konva.isBrowser)return;const A=this.container();if(!A)throw"Stage has no container. A container is required.";A.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),A.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(A){A.batchDraw()}),this}}e.Stage=se,se.prototype.nodeType=c,(0,a._registerNode)(se),n.Factory.addGetterSetter(se,"container"),r.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(F=>{F.batchDraw()})})}(ta)),ta}var zi={},na={},gu;function lt(){return gu||(gu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=Pe(),n=et(),i=Ae(),r=tt(),o=Ee(),s=Pe(),a=fu(),l="hasShadow",c="shadowRGBA",d="patternImage",f="linearGradient",g="radialGradient";let p;function u(){return p||(p=n.Util.createCanvasElement().getContext("2d"),p)}e.shapes={};function v(w){const k=this.attrs.fillRule;k?w.fill(k):w.fill()}function b(w){w.stroke()}function x(w){const k=this.attrs.fillRule;k?w.fill(k):w.fill()}function m(w){w.stroke()}function h(){this._clearCache(l)}function y(){this._clearCache(c)}function S(){this._clearCache(d)}function E(){this._clearCache(f)}function D(){this._clearCache(g)}class C extends r.Node{constructor(k){super(k);let T;for(;T=n.Util.getRandomColor(),!(T&&!(T in e.shapes)););this.colorKey=T,e.shapes[T]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const T=u().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(T&&T.setTransform){const R=new n.Transform;R.translate(this.fillPatternX(),this.fillPatternY()),R.rotate(t.Konva.getAngle(this.fillPatternRotation())),R.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),R.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const L=R.getMatrix(),U=typeof DOMMatrix>"u"?{a:L[0],b:L[1],c:L[2],d:L[3],e:L[4],f:L[5]}:new DOMMatrix(L);T.setTransform(U)}return T}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){const k=this.fillLinearGradientColorStops();if(k){const T=u(),R=this.fillLinearGradientStartPoint(),L=this.fillLinearGradientEndPoint(),U=T.createLinearGradient(R.x,R.y,L.x,L.y);for(let z=0;z<k.length;z+=2)U.addColorStop(k[z],k[z+1]);return U}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const k=this.fillRadialGradientColorStops();if(k){const T=u(),R=this.fillRadialGradientStartPoint(),L=this.fillRadialGradientEndPoint(),U=T.createRadialGradient(R.x,R.y,this.fillRadialGradientStartRadius(),L.x,L.y,this.fillRadialGradientEndRadius());for(let z=0;z<k.length;z+=2)U.addColorStop(k[z],k[z+1]);return U}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const k=n.Util.colorToRGBA(this.shadowColor());if(k)return"rgba("+k.r+","+k.g+","+k.b+","+k.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const k=this.hitStrokeWidth();return k==="auto"?this.hasStroke():this.strokeEnabled()&&!!k}intersects(k){const T=this.getStage();if(!T)return!1;const R=T.bufferHitCanvas;return R.getContext().clear(),this.drawHit(R,void 0,!0),R.context.getImageData(Math.round(k.x),Math.round(k.y),1,1).data[3]>0}destroy(){return r.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(k){var T;if(!((T=this.attrs.perfectDrawEnabled)!==null&&T!==void 0?T:!0))return!1;const L=k||this.hasFill(),U=this.hasStroke(),z=this.getAbsoluteOpacity()!==1;if(L&&U&&z)return!0;const Z=this.hasShadow(),_=this.shadowForStrokeEnabled();return!!(L&&U&&Z&&_)}setStrokeHitEnabled(k){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),k?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const k=this.size();return{x:this._centroid?-k.width/2:0,y:this._centroid?-k.height/2:0,width:k.width,height:k.height}}getClientRect(k={}){let T=!1,R=this.getParent();for(;R;){if(R.isCached()){T=!0;break}R=R.getParent()}const L=k.skipTransform,U=k.relativeTo||T&&this.getStage()||void 0,z=this.getSelfRect(),_=!k.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,P=z.width+_,N=z.height+_,O=!k.skipShadow&&this.hasShadow(),G=O?this.shadowOffsetX():0,H=O?this.shadowOffsetY():0,V=P+Math.abs(G),te=N+Math.abs(H),se=O&&this.shadowBlur()||0,F=V+se*2,A=te+se*2,$={width:F,height:A,x:-(_/2+se)+Math.min(G,0)+z.x,y:-(_/2+se)+Math.min(H,0)+z.y};return L?$:this._transformedRect($,U)}drawScene(k,T,R){const L=this.getLayer(),U=k||L.getCanvas(),z=U.getContext(),Z=this._getCanvasCache(),_=this.getSceneFunc(),P=this.hasShadow();let N;const O=T===this;if(!this.isVisible()&&!O)return this;if(Z){z.save();const G=this.getAbsoluteTransform(T).getMatrix();return z.transform(G[0],G[1],G[2],G[3],G[4],G[5]),this._drawCachedSceneCanvas(z),z.restore(),this}if(!_)return this;if(z.save(),this._useBufferCanvas()){N=this.getStage();const G=R||N.bufferCanvas,H=G.getContext();H.clear(),H.save(),H._applyLineJoin(this);const V=this.getAbsoluteTransform(T).getMatrix();H.transform(V[0],V[1],V[2],V[3],V[4],V[5]),_.call(this,H,this),H.restore();const te=G.pixelRatio;P&&z._applyShadow(this),z._applyOpacity(this),z._applyGlobalCompositeOperation(this),z.drawImage(G._canvas,G.x||0,G.y||0,G.width/te,G.height/te)}else{if(z._applyLineJoin(this),!O){const G=this.getAbsoluteTransform(T).getMatrix();z.transform(G[0],G[1],G[2],G[3],G[4],G[5]),z._applyOpacity(this),z._applyGlobalCompositeOperation(this)}P&&z._applyShadow(this),_.call(this,z,this)}return z.restore(),this}drawHit(k,T,R=!1){if(!this.shouldDrawHit(T,R))return this;const L=this.getLayer(),U=k||L.hitCanvas,z=U&&U.getContext(),Z=this.hitFunc()||this.sceneFunc(),_=this._getCanvasCache(),P=_&&_.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),P){z.save();const O=this.getAbsoluteTransform(T).getMatrix();return z.transform(O[0],O[1],O[2],O[3],O[4],O[5]),this._drawCachedHitCanvas(z),z.restore(),this}if(!Z)return this;if(z.save(),z._applyLineJoin(this),!(this===T)){const O=this.getAbsoluteTransform(T).getMatrix();z.transform(O[0],O[1],O[2],O[3],O[4],O[5])}return Z.call(this,z,this),z.restore(),this}drawHitFromCache(k=0){const T=this._getCanvasCache(),R=this._getCachedSceneCanvas(),L=T.hit,U=L.getContext(),z=L.getWidth(),Z=L.getHeight();U.clear(),U.drawImage(R._canvas,0,0,z,Z);try{const _=U.getImageData(0,0,z,Z),P=_.data,N=P.length,O=n.Util._hexToRgb(this.colorKey);for(let G=0;G<N;G+=4)P[G+3]>k?(P[G]=O.r,P[G+1]=O.g,P[G+2]=O.b,P[G+3]=255):P[G+3]=0;U.putImageData(_,0,0)}catch(_){n.Util.error("Unable to draw hit graph from cached scene canvas. "+_.message)}return this}hasPointerCapture(k){return a.hasPointerCapture(k,this)}setPointerCapture(k){a.setPointerCapture(k,this)}releaseCapture(k){a.releaseCapture(k,this)}}e.Shape=C,C.prototype._fillFunc=v,C.prototype._strokeFunc=b,C.prototype._fillFuncHit=x,C.prototype._strokeFuncHit=m,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,s._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",h),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",S),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",E),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",D),i.Factory.addGetterSetter(C,"stroke",void 0,(0,o.getStringOrGradientValidator)()),i.Factory.addGetterSetter(C,"strokeWidth",2,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,o.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,o.getBooleanValidator)()),i.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,o.getBooleanValidator)()),i.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,o.getBooleanValidator)()),i.Factory.addGetterSetter(C,"lineJoin"),i.Factory.addGetterSetter(C,"lineCap"),i.Factory.addGetterSetter(C,"sceneFunc"),i.Factory.addGetterSetter(C,"hitFunc"),i.Factory.addGetterSetter(C,"dash"),i.Factory.addGetterSetter(C,"dashOffset",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowColor",void 0,(0,o.getStringValidator)()),i.Factory.addGetterSetter(C,"shadowBlur",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowOpacity",1,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternImage"),i.Factory.addGetterSetter(C,"fill",void 0,(0,o.getStringOrGradientValidator)()),i.Factory.addGetterSetter(C,"fillPatternX",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternY",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(C,"fillEnabled",!0),i.Factory.addGetterSetter(C,"strokeEnabled",!0),i.Factory.addGetterSetter(C,"shadowEnabled",!0),i.Factory.addGetterSetter(C,"dashEnabled",!0),i.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(C,"fillPriority","color"),i.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(C,"fillPatternRotation",0),i.Factory.addGetterSetter(C,"fillRule",void 0,(0,o.getStringValidator)()),i.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(na)),na}var mu;function yu(){if(mu)return zi;mu=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.Layer=void 0;const e=et(),t=So(),n=tt(),i=Ae(),r=bo(),o=Ee(),s=lt(),a=Pe(),l="#",c="beforeDraw",d="draw",f=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=f.length;let p=class extends t.Container{constructor(v){super(v),this.canvas=new r.SceneCanvas,this.hitCanvas=new r.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(v){return this.getContext().clear(v),this.getHitCanvas().getContext().clear(v),this}setZIndex(v){super.setZIndex(v);const b=this.getStage();return b&&b.content&&(b.content.removeChild(this.getNativeCanvasElement()),v<b.children.length-1?b.content.insertBefore(this.getNativeCanvasElement(),b.children[v+1].getCanvas()._canvas):b.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!n.Node.prototype.moveUp.call(this))return!1;const b=this.getStage();return!b||!b.content?!1:(b.content.removeChild(this.getNativeCanvasElement()),this.index<b.children.length-1?b.content.insertBefore(this.getNativeCanvasElement(),b.children[this.index+1].getCanvas()._canvas):b.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){const v=this.getStage();if(v){const b=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),b[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){const v=this.getStage();if(v){const b=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),b[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const v=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),v&&v.parentNode&&e.Util._isInDocument(v)&&v.parentNode.removeChild(v),this}getStage(){return this.parent}setSize({width:v,height:b}){return this.canvas.setSize(v,b),this.hitCanvas.setSize(v,b),this._setSmoothEnabled(),this}_validateAdd(v){const b=v.getType();b!=="Group"&&b!=="Shape"&&e.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(v){return v=v||{},v.width=v.width||this.getWidth(),v.height=v.height||this.getHeight(),v.x=v.x!==void 0?v.x:this.x(),v.y=v.y!==void 0?v.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,v)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){e.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){e.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,e.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(v){if(!this.isListening()||!this.isVisible())return null;let b=1,x=!1;for(;;){for(let m=0;m<g;m++){const h=f[m],y=this._getIntersection({x:v.x+h.x*b,y:v.y+h.y*b}),S=y.shape;if(S)return S;if(x=!!y.antialiased,!y.antialiased)break}if(x)b+=1;else return null}}_getIntersection(v){const b=this.hitCanvas.pixelRatio,x=this.hitCanvas.context.getImageData(Math.round(v.x*b),Math.round(v.y*b),1,1).data,m=x[3];if(m===255){const h=e.Util._rgbToHex(x[0],x[1],x[2]),y=s.shapes[l+h];return y?{shape:y}:{antialiased:!0}}else if(m>0)return{antialiased:!0};return{}}drawScene(v,b,x){const m=this.getLayer(),h=v||m&&m.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&h.getContext().clear(),t.Container.prototype.drawScene.call(this,h,b,x),this._fire(d,{node:this}),this}drawHit(v,b){const x=this.getLayer(),m=v||x&&x.hitCanvas;return x&&x.clearBeforeDraw()&&x.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,m,b),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(v){e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(v)}getHitGraphEnabled(v){return e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const v=this.parent;!!this.hitCanvas._canvas.parentNode?v.content.removeChild(this.hitCanvas._canvas):v.content.appendChild(this.hitCanvas._canvas)}destroy(){return e.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return zi.Layer=p,p.prototype.nodeType="Layer",(0,a._registerNode)(p),i.Factory.addGetterSetter(p,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(p,"clearBeforeDraw",!0),i.Factory.addGetterSetter(p,"hitGraphEnabled",!0,(0,o.getBooleanValidator)()),zi}var $i={},vu;function tg(){if(vu)return $i;vu=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.FastLayer=void 0;const e=et(),t=yu(),n=Pe();let i=class extends t.Layer{constructor(o){super(o),this.listening(!1),e.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return $i.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),$i}var Ui={},_u;function ia(){if(_u)return Ui;_u=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.Group=void 0;const e=et(),t=So(),n=Pe();let i=class extends t.Container{_validateAdd(o){const s=o.getType();s!=="Group"&&s!=="Shape"&&e.Util.throw("You may only add groups and shapes to groups.")}};return Ui.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),Ui}var Vi={},bu;function ra(){if(bu)return Vi;bu=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.Animation=void 0;const e=Pe(),t=et(),n=function(){return e.glob.performance&&e.glob.performance.now?function(){return e.glob.performance.now()}:function(){return new Date().getTime()}}();let i=class gi{constructor(o,s){this.id=gi.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=o,this.setLayers(s)}setLayers(o){let s=[];return o&&(s=Array.isArray(o)?o:[o]),this.layers=s,this}getLayers(){return this.layers}addLayer(o){const s=this.layers,a=s.length;for(let l=0;l<a;l++)if(s[l]._id===o._id)return!1;return this.layers.push(o),!0}isRunning(){const s=gi.animations,a=s.length;for(let l=0;l<a;l++)if(s[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),gi._addAnimation(this),this}stop(){return gi._removeAnimation(this),this}_updateFrameObject(o){this.frame.timeDiff=o-this.frame.lastTime,this.frame.lastTime=o,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(o){this.animations.push(o),this._handleAnimation()}static _removeAnimation(o){const s=o.id,a=this.animations,l=a.length;for(let c=0;c<l;c++)if(a[c].id===s){this.animations.splice(c,1);break}}static _runFrames(){const o={},s=this.animations;for(let a=0;a<s.length;a++){const l=s[a],c=l.layers,d=l.func;l._updateFrameObject(n());const f=c.length;let g;if(d?g=d.call(l,l.frame)!==!1:g=!0,!!g)for(let p=0;p<f;p++){const u=c[p];u._id!==void 0&&(o[u._id]=u)}}for(const a in o)o.hasOwnProperty(a)&&o[a].batchDraw()}static _animationLoop(){const o=gi;o.animations.length?(o._runFrames(),t.Util.requestAnimFrame(o._animationLoop)):o.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return Vi.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,Vi}var oa={},Su;function ng(){return Su||(Su=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=et(),n=ra(),i=tt(),r=Pe(),o={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,a=2,l=3,c=["fill","stroke","shadowColor"];let d=0;class f{constructor(u,v,b,x,m,h,y){this.prop=u,this.propFunc=v,this.begin=x,this._pos=x,this.duration=h,this._change=0,this.prevPos=0,this.yoyo=y,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=b,this._change=m-this.begin,this.pause()}fire(u){const v=this[u];v&&v()}setTime(u){u>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():u<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=u,this.update())}getTime(){return this._time}setPosition(u){this.prevPos=this._pos,this.propFunc(u),this._pos=u}getPosition(u){return u===void 0&&(u=this._time),this.func(u,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(u){this.pause(),this._time=u,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const u=this.getTimer()-this._startTime;this.state===a?this.setTime(u):this.state===l&&this.setTime(this.duration-u)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(u){const v=this,b=u.node,x=b._id,m=u.easing||e.Easings.Linear,h=!!u.yoyo;let y,S;typeof u.duration>"u"?y=.3:u.duration===0?y=.001:y=u.duration,this.node=b,this._id=d++;const E=b.getLayer()||(b instanceof r.Konva.Stage?b.getLayers():null);E||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){v.tween.onEnterFrame()},E),this.tween=new f(S,function(D){v._tweenFunc(D)},m,0,1,y*1e3,h),this._addListeners(),g.attrs[x]||(g.attrs[x]={}),g.attrs[x][this._id]||(g.attrs[x][this._id]={}),g.tweens[x]||(g.tweens[x]={});for(S in u)o[S]===void 0&&this._addAttr(S,u[S]);this.reset(),this.onFinish=u.onFinish,this.onReset=u.onReset,this.onUpdate=u.onUpdate}_addAttr(u,v){const b=this.node,x=b._id;let m,h,y,S,E;const D=g.tweens[x][u];D&&delete g.attrs[x][D][u];let C=b.getAttr(u);if(t.Util._isArray(v))if(m=[],h=Math.max(v.length,C.length),u==="points"&&v.length!==C.length&&(v.length>C.length?(S=C,C=t.Util._prepareArrayForTween(C,v,b.closed())):(y=v,v=t.Util._prepareArrayForTween(v,C,b.closed()))),u.indexOf("fill")===0)for(let w=0;w<h;w++)if(w%2===0)m.push(v[w]-C[w]);else{const k=t.Util.colorToRGBA(C[w]);E=t.Util.colorToRGBA(v[w]),C[w]=k,m.push({r:E.r-k.r,g:E.g-k.g,b:E.b-k.b,a:E.a-k.a})}else for(let w=0;w<h;w++)m.push(v[w]-C[w]);else c.indexOf(u)!==-1?(C=t.Util.colorToRGBA(C),E=t.Util.colorToRGBA(v),m={r:E.r-C.r,g:E.g-C.g,b:E.b-C.b,a:E.a-C.a}):m=v-C;g.attrs[x][this._id][u]={start:C,diff:m,end:v,trueEnd:y,trueStart:S},g.tweens[x][u]=this._id}_tweenFunc(u){const v=this.node,b=g.attrs[v._id][this._id];let x,m,h,y,S,E,D,C;for(x in b){if(m=b[x],h=m.start,y=m.diff,C=m.end,t.Util._isArray(h))if(S=[],D=Math.max(h.length,C.length),x.indexOf("fill")===0)for(E=0;E<D;E++)E%2===0?S.push((h[E]||0)+y[E]*u):S.push("rgba("+Math.round(h[E].r+y[E].r*u)+","+Math.round(h[E].g+y[E].g*u)+","+Math.round(h[E].b+y[E].b*u)+","+(h[E].a+y[E].a*u)+")");else for(E=0;E<D;E++)S.push((h[E]||0)+y[E]*u);else c.indexOf(x)!==-1?S="rgba("+Math.round(h.r+y.r*u)+","+Math.round(h.g+y.g*u)+","+Math.round(h.b+y.b*u)+","+(h.a+y.a*u)+")":S=h+y*u;v.setAttr(x,S)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const u=this.node,v=g.attrs[u._id][this._id];v.points&&v.points.trueEnd&&u.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const u=this.node,v=g.attrs[u._id][this._id];v.points&&v.points.trueStart&&u.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(u){return this.tween.seek(u*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const u=this.node._id,v=this._id,b=g.tweens[u];this.pause(),this.anim&&this.anim.stop();for(const x in b)delete g.tweens[u][x];delete g.attrs[u][v],Object.keys(g.tweens[u]).length===0&&delete g.tweens[u],Object.keys(g.attrs[u]).length===0&&delete g.attrs[u]}}e.Tween=g,g.attrs={},g.tweens={},i.Node.prototype.to=function(p){const u=p.onFinish;p.node=this,p.onFinish=function(){this.destroy(),u&&u()},new g(p).play()},e.Easings={BackEaseIn(p,u,v,b){return v*(p/=b)*p*(2.70158*p-1.70158)+u},BackEaseOut(p,u,v,b){return v*((p=p/b-1)*p*(2.70158*p+1.70158)+1)+u},BackEaseInOut(p,u,v,b){let x=1.70158;return(p/=b/2)<1?v/2*(p*p*(((x*=1.525)+1)*p-x))+u:v/2*((p-=2)*p*(((x*=1.525)+1)*p+x)+2)+u},ElasticEaseIn(p,u,v,b,x,m){let h=0;return p===0?u:(p/=b)===1?u+v:(m||(m=b*.3),!x||x<Math.abs(v)?(x=v,h=m/4):h=m/(2*Math.PI)*Math.asin(v/x),-(x*Math.pow(2,10*(p-=1))*Math.sin((p*b-h)*(2*Math.PI)/m))+u)},ElasticEaseOut(p,u,v,b,x,m){let h=0;return p===0?u:(p/=b)===1?u+v:(m||(m=b*.3),!x||x<Math.abs(v)?(x=v,h=m/4):h=m/(2*Math.PI)*Math.asin(v/x),x*Math.pow(2,-10*p)*Math.sin((p*b-h)*(2*Math.PI)/m)+v+u)},ElasticEaseInOut(p,u,v,b,x,m){let h=0;return p===0?u:(p/=b/2)===2?u+v:(m||(m=b*.44999999999999996),!x||x<Math.abs(v)?(x=v,h=m/4):h=m/(2*Math.PI)*Math.asin(v/x),p<1?-.5*(x*Math.pow(2,10*(p-=1))*Math.sin((p*b-h)*(2*Math.PI)/m))+u:x*Math.pow(2,-10*(p-=1))*Math.sin((p*b-h)*(2*Math.PI)/m)*.5+v+u)},BounceEaseOut(p,u,v,b){return(p/=b)<.36363636363636365?v*(7.5625*p*p)+u:p<.7272727272727273?v*(7.5625*(p-=.5454545454545454)*p+.75)+u:p<.9090909090909091?v*(7.5625*(p-=.8181818181818182)*p+.9375)+u:v*(7.5625*(p-=.9545454545454546)*p+.984375)+u},BounceEaseIn(p,u,v,b){return v-e.Easings.BounceEaseOut(b-p,0,v,b)+u},BounceEaseInOut(p,u,v,b){return p<b/2?e.Easings.BounceEaseIn(p*2,0,v,b)*.5+u:e.Easings.BounceEaseOut(p*2-b,0,v,b)*.5+v*.5+u},EaseIn(p,u,v,b){return v*(p/=b)*p+u},EaseOut(p,u,v,b){return-v*(p/=b)*(p-2)+u},EaseInOut(p,u,v,b){return(p/=b/2)<1?v/2*p*p+u:-v/2*(--p*(p-2)-1)+u},StrongEaseIn(p,u,v,b){return v*(p/=b)*p*p*p*p+u},StrongEaseOut(p,u,v,b){return v*((p=p/b-1)*p*p*p*p+1)+u},StrongEaseInOut(p,u,v,b){return(p/=b/2)<1?v/2*p*p*p*p*p+u:v/2*((p-=2)*p*p*p*p+2)+u},Linear(p,u,v,b){return v*p/b+u}}}(oa)),oa}var wu;function ig(){return wu||(wu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=Pe(),n=et(),i=tt(),r=So(),o=eg(),s=yu(),a=tg(),l=ia(),c=Qs(),d=lt(),f=ra(),g=ng(),p=ou(),u=bo();e.Konva=n.Util._assign(t.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:r.Container,Stage:o.Stage,stages:o.stages,Layer:s.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:c.DD,Shape:d.Shape,shapes:d.shapes,Animation:f.Animation,Tween:g.Tween,Easings:g.Easings,Context:p.Context,Canvas:u.Canvas}),e.default=e.Konva}(qs)),qs}var Bi={},xu;function rg(){if(xu)return Bi;xu=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.Arc=void 0;const e=Ae(),t=lt(),n=Pe(),i=Ee(),r=Pe();let o=class extends t.Shape{_sceneFunc(a){const l=n.Konva.getAngle(this.angle()),c=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,c),a.arc(0,0,this.innerRadius(),l,0,!c),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),c=this.clockwise(),d=n.Konva.getAngle(c?360-this.angle():this.angle()),f=Math.cos(Math.min(d,Math.PI)),g=1,p=Math.sin(Math.min(Math.max(Math.PI,d),3*Math.PI/2)),u=Math.sin(Math.min(d,Math.PI/2)),v=f*(f>0?a:l),b=g*l,x=p*(p>0?a:l),m=u*(u>0?l:a);return{x:v,y:c?-1*m:x,width:b-v,height:m-x}}};return Bi.Arc=o,o.prototype._centroid=!0,o.prototype.className="Arc",o.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,r._registerNode)(o),e.Factory.addGetterSetter(o,"innerRadius",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"outerRadius",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"angle",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"clockwise",!1,(0,i.getBooleanValidator)()),Bi}var Hi={},ji={},Cu;function ku(){if(Cu)return ji;Cu=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.Line=void 0;const e=Ae(),t=Pe(),n=lt(),i=Ee();function r(a,l,c,d,f,g,p){const u=Math.sqrt(Math.pow(c-a,2)+Math.pow(d-l,2)),v=Math.sqrt(Math.pow(f-c,2)+Math.pow(g-d,2)),b=p*u/(u+v),x=p*v/(u+v),m=c-b*(f-a),h=d-b*(g-l),y=c+x*(f-a),S=d+x*(g-l);return[m,h,y,S]}function o(a,l){const c=a.length,d=[];for(let f=2;f<c-2;f+=2){const g=r(a[f-2],a[f-1],a[f],a[f+1],a[f+2],a[f+3],l);isNaN(g[0])||(d.push(g[0]),d.push(g[1]),d.push(a[f]),d.push(a[f+1]),d.push(g[2]),d.push(g[3]))}return d}let s=class extends n.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const c=this.points(),d=c.length,f=this.tension(),g=this.closed(),p=this.bezier();if(!d)return;let u=0;if(l.beginPath(),l.moveTo(c[0],c[1]),f!==0&&d>4){const v=this.getTensionPoints(),b=v.length;for(u=g?0:4,g||l.quadraticCurveTo(v[0],v[1],v[2],v[3]);u<b-2;)l.bezierCurveTo(v[u++],v[u++],v[u++],v[u++],v[u++],v[u++]);g||l.quadraticCurveTo(v[b-2],v[b-1],c[d-2],c[d-1])}else if(p)for(u=2;u<d;)l.bezierCurveTo(c[u++],c[u++],c[u++],c[u++],c[u++],c[u++]);else for(u=2;u<d;u+=2)l.lineTo(c[u],c[u+1]);g?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():o(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),c=l.length,d=this.tension(),f=r(l[c-2],l[c-1],l[0],l[1],l[2],l[3],d),g=r(l[c-4],l[c-3],l[c-2],l[c-1],l[0],l[1],d),p=o(l,d);return[f[2],f[3]].concat(p).concat([g[0],g[1],l[c-2],l[c-1],g[2],g[3],f[0],f[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let c=l[0],d=l[0],f=l[1],g=l[1],p,u;for(let v=0;v<l.length/2;v++)p=l[v*2],u=l[v*2+1],c=Math.min(c,p),d=Math.max(d,p),f=Math.min(f,u),g=Math.max(g,u);return{x:c,y:f,width:d-c,height:g-f}}};return ji.Line=s,s.prototype.className="Line",s.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(s),e.Factory.addGetterSetter(s,"closed",!1),e.Factory.addGetterSetter(s,"bezier",!1),e.Factory.addGetterSetter(s,"tension",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(s,"points",[],(0,i.getNumberArrayValidator)()),ji}var Wi={},sa={},Pu;function og(){return Pu||(Pu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(s,a,l)=>{let c,d;const g=l/2;c=0;for(let p=0;p<20;p++)d=g*e.tValues[20][p]+g,c+=e.cValues[20][p]*i(s,a,d);return g*c};e.getCubicArcLength=t;const n=(s,a,l)=>{l===void 0&&(l=1);const c=s[0]-2*s[1]+s[2],d=a[0]-2*a[1]+a[2],f=2*s[1]-2*s[0],g=2*a[1]-2*a[0],p=4*(c*c+d*d),u=4*(c*f+d*g),v=f*f+g*g;if(p===0)return l*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(a[2]-a[0],2));const b=u/(2*p),x=v/p,m=l+b,h=x-b*b,y=m*m+h>0?Math.sqrt(m*m+h):0,S=b*b+h>0?Math.sqrt(b*b+h):0,E=b+Math.sqrt(b*b+h)!==0?h*Math.log(Math.abs((m+y)/(b+S))):0;return Math.sqrt(p)/2*(m*y-b*S+E)};e.getQuadraticArcLength=n;function i(s,a,l){const c=r(1,l,s),d=r(1,l,a),f=c*c+d*d;return Math.sqrt(f)}const r=(s,a,l)=>{const c=l.length-1;let d,f;if(c===0)return 0;if(s===0){f=0;for(let g=0;g<=c;g++)f+=e.binomialCoefficients[c][g]*Math.pow(1-a,c-g)*Math.pow(a,g)*l[g];return f}else{d=new Array(c);for(let g=0;g<c;g++)d[g]=c*(l[g+1]-l[g]);return r(s-1,a,d)}},o=(s,a,l)=>{let c=1,d=s/a,f=(s-l(d))/a,g=0;for(;c>.001;){const p=l(d+f),u=Math.abs(s-p)/a;if(u<c)c=u,d+=f;else{const v=l(d-f),b=Math.abs(s-v)/a;b<c?(c=b,d-=f):f/=2}if(g++,g>500)break}return d};e.t2length=o}(sa)),sa}var Tu;function aa(){if(Tu)return Wi;Tu=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.Path=void 0;const e=Ae(),t=Pe(),n=lt(),i=og();let r=class At extends n.Shape{constructor(s){super(s),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=At.parsePathData(this.data()),this.pathLength=At.getPathLength(this.dataArray)}_sceneFunc(s){const a=this.dataArray;s.beginPath();let l=!1;for(let c=0;c<a.length;c++){const d=a[c].command,f=a[c].points;switch(d){case"L":s.lineTo(f[0],f[1]);break;case"M":s.moveTo(f[0],f[1]);break;case"C":s.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":s.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":const g=f[0],p=f[1],u=f[2],v=f[3],b=f[4],x=f[5],m=f[6],h=f[7],y=u>v?u:v,S=u>v?1:u/v,E=u>v?v/u:1;s.translate(g,p),s.rotate(m),s.scale(S,E),s.arc(0,0,y,b,b+x,1-h),s.scale(1/S,1/E),s.rotate(-m),s.translate(-g,-p);break;case"z":l=!0,s.closePath();break}}!l&&!this.hasFill()?s.strokeShape(this):s.fillStrokeShape(this)}getSelfRect(){let s=[];this.dataArray.forEach(function(p){if(p.command==="A"){const u=p.points[4],v=p.points[5],b=p.points[4]+v;let x=Math.PI/180;if(Math.abs(u-b)<x&&(x=Math.abs(u-b)),v<0)for(let m=u-x;m>b;m-=x){const h=At.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],m,0);s.push(h.x,h.y)}else for(let m=u+x;m<b;m+=x){const h=At.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],m,0);s.push(h.x,h.y)}}else if(p.command==="C")for(let u=0;u<=1;u+=.01){const v=At.getPointOnCubicBezier(u,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3],p.points[4],p.points[5]);s.push(v.x,v.y)}else s=s.concat(p.points)});let a=s[0],l=s[0],c=s[1],d=s[1],f,g;for(let p=0;p<s.length/2;p++)f=s[p*2],g=s[p*2+1],isNaN(f)||(a=Math.min(a,f),l=Math.max(l,f)),isNaN(g)||(c=Math.min(c,g),d=Math.max(d,g));return{x:a,y:c,width:l-a,height:d-c}}getLength(){return this.pathLength}getPointAtLength(s){return At.getPointAtLengthOfDataArray(s,this.dataArray)}static getLineLength(s,a,l,c){return Math.sqrt((l-s)*(l-s)+(c-a)*(c-a))}static getPathLength(s){let a=0;for(let l=0;l<s.length;++l)a+=s[l].pathLength;return a}static getPointAtLengthOfDataArray(s,a){let l,c=0,d=a.length;if(!d)return null;for(;c<d&&s>a[c].pathLength;)s-=a[c].pathLength,++c;if(c===d)return l=a[c-1].points.slice(-2),{x:l[0],y:l[1]};if(s<.01)return a[c].command==="M"?(l=a[c].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[c].start.x,y:a[c].start.y};const f=a[c],g=f.points;switch(f.command){case"L":return At.getPointOnLine(s,f.start.x,f.start.y,g[0],g[1]);case"C":return At.getPointOnCubicBezier((0,i.t2length)(s,At.getPathLength(a),y=>(0,i.getCubicArcLength)([f.start.x,g[0],g[2],g[4]],[f.start.y,g[1],g[3],g[5]],y)),f.start.x,f.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return At.getPointOnQuadraticBezier((0,i.t2length)(s,At.getPathLength(a),y=>(0,i.getQuadraticArcLength)([f.start.x,g[0],g[2]],[f.start.y,g[1],g[3]],y)),f.start.x,f.start.y,g[0],g[1],g[2],g[3]);case"A":const p=g[0],u=g[1],v=g[2],b=g[3],x=g[5],m=g[6];let h=g[4];return h+=x*s/f.pathLength,At.getPointOnEllipticalArc(p,u,v,b,h,m)}return null}static getPointOnLine(s,a,l,c,d,f,g){f=f??a,g=g??l;const p=this.getLineLength(a,l,c,d);if(p<1e-10)return{x:a,y:l};if(c===a)return{x:f,y:g+(d>l?s:-s)};const u=(d-l)/(c-a),v=Math.sqrt(s*s/(1+u*u))*(c<a?-1:1),b=u*v;if(Math.abs(g-l-u*(f-a))<1e-10)return{x:f+v,y:g+b};const x=((f-a)*(c-a)+(g-l)*(d-l))/(p*p),m=a+x*(c-a),h=l+x*(d-l),y=this.getLineLength(f,g,m,h),S=Math.sqrt(s*s-y*y),E=Math.sqrt(S*S/(1+u*u))*(c<a?-1:1),D=u*E;return{x:m+E,y:h+D}}static getPointOnCubicBezier(s,a,l,c,d,f,g,p,u){function v(S){return S*S*S}function b(S){return 3*S*S*(1-S)}function x(S){return 3*S*(1-S)*(1-S)}function m(S){return(1-S)*(1-S)*(1-S)}const h=p*v(s)+f*b(s)+c*x(s)+a*m(s),y=u*v(s)+g*b(s)+d*x(s)+l*m(s);return{x:h,y}}static getPointOnQuadraticBezier(s,a,l,c,d,f,g){function p(m){return m*m}function u(m){return 2*m*(1-m)}function v(m){return(1-m)*(1-m)}const b=f*p(s)+c*u(s)+a*v(s),x=g*p(s)+d*u(s)+l*v(s);return{x:b,y:x}}static getPointOnEllipticalArc(s,a,l,c,d,f){const g=Math.cos(f),p=Math.sin(f),u={x:l*Math.cos(d),y:c*Math.sin(d)};return{x:s+(u.x*g-u.y*p),y:a+(u.x*p+u.y*g)}}static parsePathData(s){if(!s)return[];let a=s;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let b=0;b<l.length;b++)a=a.replace(new RegExp(l[b],"g"),"|"+l[b]);const c=a.split("|"),d=[],f=[];let g=0,p=0;const u=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let v;for(let b=1;b<c.length;b++){let x=c[b],m=x.charAt(0);for(x=x.slice(1),f.length=0;v=u.exec(x);)f.push(v[0]);const h=[];for(let y=0,S=f.length;y<S;y++){if(f[y]==="00"){h.push(0,0);continue}const E=parseFloat(f[y]);isNaN(E)?h.push(0):h.push(E)}for(;h.length>0&&!isNaN(h[0]);){let y="",S=[];const E=g,D=p;let C,w,k,T,R,L,U,z,Z,_;switch(m){case"l":g+=h.shift(),p+=h.shift(),y="L",S.push(g,p);break;case"L":g=h.shift(),p=h.shift(),S.push(g,p);break;case"m":const P=h.shift(),N=h.shift();if(g+=P,p+=N,y="M",d.length>2&&d[d.length-1].command==="z"){for(let O=d.length-2;O>=0;O--)if(d[O].command==="M"){g=d[O].points[0]+P,p=d[O].points[1]+N;break}}S.push(g,p),m="l";break;case"M":g=h.shift(),p=h.shift(),y="M",S.push(g,p),m="L";break;case"h":g+=h.shift(),y="L",S.push(g,p);break;case"H":g=h.shift(),y="L",S.push(g,p);break;case"v":p+=h.shift(),y="L",S.push(g,p);break;case"V":p=h.shift(),y="L",S.push(g,p);break;case"C":S.push(h.shift(),h.shift(),h.shift(),h.shift()),g=h.shift(),p=h.shift(),S.push(g,p);break;case"c":S.push(g+h.shift(),p+h.shift(),g+h.shift(),p+h.shift()),g+=h.shift(),p+=h.shift(),y="C",S.push(g,p);break;case"S":w=g,k=p,C=d[d.length-1],C.command==="C"&&(w=g+(g-C.points[2]),k=p+(p-C.points[3])),S.push(w,k,h.shift(),h.shift()),g=h.shift(),p=h.shift(),y="C",S.push(g,p);break;case"s":w=g,k=p,C=d[d.length-1],C.command==="C"&&(w=g+(g-C.points[2]),k=p+(p-C.points[3])),S.push(w,k,g+h.shift(),p+h.shift()),g+=h.shift(),p+=h.shift(),y="C",S.push(g,p);break;case"Q":S.push(h.shift(),h.shift()),g=h.shift(),p=h.shift(),S.push(g,p);break;case"q":S.push(g+h.shift(),p+h.shift()),g+=h.shift(),p+=h.shift(),y="Q",S.push(g,p);break;case"T":w=g,k=p,C=d[d.length-1],C.command==="Q"&&(w=g+(g-C.points[0]),k=p+(p-C.points[1])),g=h.shift(),p=h.shift(),y="Q",S.push(w,k,g,p);break;case"t":w=g,k=p,C=d[d.length-1],C.command==="Q"&&(w=g+(g-C.points[0]),k=p+(p-C.points[1])),g+=h.shift(),p+=h.shift(),y="Q",S.push(w,k,g,p);break;case"A":T=h.shift(),R=h.shift(),L=h.shift(),U=h.shift(),z=h.shift(),Z=g,_=p,g=h.shift(),p=h.shift(),y="A",S=this.convertEndpointToCenterParameterization(Z,_,g,p,U,z,T,R,L);break;case"a":T=h.shift(),R=h.shift(),L=h.shift(),U=h.shift(),z=h.shift(),Z=g,_=p,g+=h.shift(),p+=h.shift(),y="A",S=this.convertEndpointToCenterParameterization(Z,_,g,p,U,z,T,R,L);break}d.push({command:y||m,points:S,start:{x:E,y:D},pathLength:this.calcLength(E,D,y||m,S)})}(m==="z"||m==="Z")&&d.push({command:"z",points:[],start:void 0,pathLength:0})}return d}static calcLength(s,a,l,c){let d,f,g,p;const u=At;switch(l){case"L":return u.getLineLength(s,a,c[0],c[1]);case"C":return(0,i.getCubicArcLength)([s,c[0],c[2],c[4]],[a,c[1],c[3],c[5]],1);case"Q":return(0,i.getQuadraticArcLength)([s,c[0],c[2]],[a,c[1],c[3]],1);case"A":d=0;const v=c[4],b=c[5],x=c[4]+b;let m=Math.PI/180;if(Math.abs(v-x)<m&&(m=Math.abs(v-x)),f=u.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],v,0),b<0)for(p=v-m;p>x;p-=m)g=u.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],p,0),d+=u.getLineLength(f.x,f.y,g.x,g.y),f=g;else for(p=v+m;p<x;p+=m)g=u.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],p,0),d+=u.getLineLength(f.x,f.y,g.x,g.y),f=g;return g=u.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],x,0),d+=u.getLineLength(f.x,f.y,g.x,g.y),d}return 0}static convertEndpointToCenterParameterization(s,a,l,c,d,f,g,p,u){const v=u*(Math.PI/180),b=Math.cos(v)*(s-l)/2+Math.sin(v)*(a-c)/2,x=-1*Math.sin(v)*(s-l)/2+Math.cos(v)*(a-c)/2,m=b*b/(g*g)+x*x/(p*p);m>1&&(g*=Math.sqrt(m),p*=Math.sqrt(m));let h=Math.sqrt((g*g*(p*p)-g*g*(x*x)-p*p*(b*b))/(g*g*(x*x)+p*p*(b*b)));d===f&&(h*=-1),isNaN(h)&&(h=0);const y=h*g*x/p,S=h*-p*b/g,E=(s+l)/2+Math.cos(v)*y-Math.sin(v)*S,D=(a+c)/2+Math.sin(v)*y+Math.cos(v)*S,C=function(z){return Math.sqrt(z[0]*z[0]+z[1]*z[1])},w=function(z,Z){return(z[0]*Z[0]+z[1]*Z[1])/(C(z)*C(Z))},k=function(z,Z){return(z[0]*Z[1]<z[1]*Z[0]?-1:1)*Math.acos(w(z,Z))},T=k([1,0],[(b-y)/g,(x-S)/p]),R=[(b-y)/g,(x-S)/p],L=[(-1*b-y)/g,(-1*x-S)/p];let U=k(R,L);return w(R,L)<=-1&&(U=Math.PI),w(R,L)>=1&&(U=0),f===0&&U>0&&(U=U-2*Math.PI),f===1&&U<0&&(U=U+2*Math.PI),[E,D,g,p,T,U,v,f]}};return Wi.Path=r,r.prototype.className="Path",r.prototype._attrsAffectingSize=["data"],(0,t._registerNode)(r),e.Factory.addGetterSetter(r,"data"),Wi}var Au;function sg(){if(Au)return Hi;Au=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.Arrow=void 0;const e=Ae(),t=ku(),n=Ee(),i=Pe(),r=aa();let o=class extends t.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,c=this.points();let d=c;const f=this.tension()!==0&&c.length>4;f&&(d=this.getTensionPoints());const g=this.pointerLength(),p=c.length;let u,v;if(f){const m=[d[d.length-4],d[d.length-3],d[d.length-2],d[d.length-1],c[p-2],c[p-1]],h=r.Path.calcLength(d[d.length-4],d[d.length-3],"C",m),y=r.Path.getPointOnQuadraticBezier(Math.min(1,1-g/h),m[0],m[1],m[2],m[3],m[4],m[5]);u=c[p-2]-y.x,v=c[p-1]-y.y}else u=c[p-2]-c[p-4],v=c[p-1]-c[p-3];const b=(Math.atan2(v,u)+l)%l,x=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(c[p-2],c[p-1]),a.rotate(b),a.moveTo(0,0),a.lineTo(-g,x/2),a.lineTo(-g,-x/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(c[0],c[1]),f?(u=(d[0]+d[2])/2-c[0],v=(d[1]+d[3])/2-c[1]):(u=c[2]-c[0],v=c[3]-c[1]),a.rotate((Math.atan2(-v,-u)+l)%l),a.moveTo(0,0),a.lineTo(-g,x/2),a.lineTo(-g,-x/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return Hi.Arrow=o,o.prototype.className="Arrow",(0,i._registerNode)(o),e.Factory.addGetterSetter(o,"pointerLength",10,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(o,"pointerWidth",10,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(o,"pointerAtBeginning",!1),e.Factory.addGetterSetter(o,"pointerAtEnding",!0),Hi}var Zi={},Eu;function ag(){if(Eu)return Zi;Eu=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.Circle=void 0;const e=Ae(),t=lt(),n=Ee(),i=Pe();let r=class extends t.Shape{_sceneFunc(s){s.beginPath(),s.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),s.closePath(),s.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(s){this.radius()!==s/2&&this.radius(s/2)}setHeight(s){this.radius()!==s/2&&this.radius(s/2)}};return Zi.Circle=r,r.prototype._centroid=!0,r.prototype.className="Circle",r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),e.Factory.addGetterSetter(r,"radius",0,(0,n.getNumberValidator)()),Zi}var Ki={},Ru;function lg(){if(Ru)return Ki;Ru=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.Ellipse=void 0;const e=Ae(),t=lt(),n=Ee(),i=Pe();let r=class extends t.Shape{_sceneFunc(s){const a=this.radiusX(),l=this.radiusY();s.beginPath(),s.save(),a!==l&&s.scale(1,l/a),s.arc(0,0,a,0,Math.PI*2,!1),s.restore(),s.closePath(),s.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(s){this.radiusX(s/2)}setHeight(s){this.radiusY(s/2)}};return Ki.Ellipse=r,r.prototype.className="Ellipse",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(r),e.Factory.addComponentsGetterSetter(r,"radius",["x","y"]),e.Factory.addGetterSetter(r,"radiusX",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(r,"radiusY",0,(0,n.getNumberValidator)()),Ki}var qi={},Du;function cg(){if(Du)return qi;Du=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.Image=void 0;const e=et(),t=Ae(),n=lt(),i=Pe(),r=Ee();let o=class hf extends n.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),c=this.getHeight(),d=this.cornerRadius(),f=this.attrs.image;let g;if(f){const p=this.attrs.cropWidth,u=this.attrs.cropHeight;p&&u?g=[f,this.cropX(),this.cropY(),p,u,0,0,l,c]:g=[f,0,0,l,c]}(this.hasFill()||this.hasStroke()||d)&&(a.beginPath(),d?e.Util.drawRoundedRectPath(a,l,c,d):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)),f&&(d&&a.clip(),a.drawImage.apply(a,g))}_hitFunc(a){const l=this.width(),c=this.height(),d=this.cornerRadius();a.beginPath(),d?e.Util.drawRoundedRectPath(a,l,c,d):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,c=null){const d=e.Util.createImageElement();d.onload=function(){const f=new hf({image:d});l(f)},d.onerror=c,d.crossOrigin="Anonymous",d.src=a}};return qi.Image=o,o.prototype.className="Image",(0,i._registerNode)(o),t.Factory.addGetterSetter(o,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(o,"image"),t.Factory.addComponentsGetterSetter(o,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(o,"cropX",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(o,"cropY",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(o,"cropWidth",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(o,"cropHeight",0,(0,r.getNumberValidator)()),qi}var Hn={},Mu;function ug(){if(Mu)return Hn;Mu=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.Tag=Hn.Label=void 0;const e=Ae(),t=lt(),n=ia(),i=Ee(),r=Pe(),o=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],s="Change.konva",a="none",l="up",c="right",d="down",f="left",g=o.length;let p=class extends n.Group{constructor(b){super(b),this.on("add.konva",function(x){this._addListeners(x.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(b){let x=this,m;const h=function(){x._sync()};for(m=0;m<g;m++)b.on(o[m]+s,h)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let b=this.getText(),x=this.getTag(),m,h,y,S,E,D,C;if(b&&x){switch(m=b.width(),h=b.height(),y=x.pointerDirection(),S=x.pointerWidth(),C=x.pointerHeight(),E=0,D=0,y){case l:E=m/2,D=-1*C;break;case c:E=m+S,D=h/2;break;case d:E=m/2,D=h+C;break;case f:E=-1*S,D=h/2;break}x.setAttrs({x:-1*E,y:-1*D,width:m,height:h}),b.setAttrs({x:-1*E,y:-1*D})}}};Hn.Label=p,p.prototype.className="Label",(0,r._registerNode)(p);class u extends t.Shape{_sceneFunc(b){const x=this.width(),m=this.height(),h=this.pointerDirection(),y=this.pointerWidth(),S=this.pointerHeight(),E=this.cornerRadius();let D=0,C=0,w=0,k=0;typeof E=="number"?D=C=w=k=Math.min(E,x/2,m/2):(D=Math.min(E[0]||0,x/2,m/2),C=Math.min(E[1]||0,x/2,m/2),k=Math.min(E[2]||0,x/2,m/2),w=Math.min(E[3]||0,x/2,m/2)),b.beginPath(),b.moveTo(D,0),h===l&&(b.lineTo((x-y)/2,0),b.lineTo(x/2,-1*S),b.lineTo((x+y)/2,0)),b.lineTo(x-C,0),b.arc(x-C,C,C,Math.PI*3/2,0,!1),h===c&&(b.lineTo(x,(m-S)/2),b.lineTo(x+y,m/2),b.lineTo(x,(m+S)/2)),b.lineTo(x,m-k),b.arc(x-k,m-k,k,0,Math.PI/2,!1),h===d&&(b.lineTo((x+y)/2,m),b.lineTo(x/2,m+S),b.lineTo((x-y)/2,m)),b.lineTo(w,m),b.arc(w,m-w,w,Math.PI/2,Math.PI,!1),h===f&&(b.lineTo(0,(m+S)/2),b.lineTo(-1*y,m/2),b.lineTo(0,(m-S)/2)),b.lineTo(0,D),b.arc(D,D,D,Math.PI,Math.PI*3/2,!1),b.closePath(),b.fillStrokeShape(this)}getSelfRect(){let b=0,x=0,m=this.pointerWidth(),h=this.pointerHeight(),y=this.pointerDirection(),S=this.width(),E=this.height();return y===l?(x-=h,E+=h):y===d?E+=h:y===f?(b-=m*1.5,S+=m):y===c&&(S+=m*1.5),{x:b,y:x,width:S,height:E}}}return Hn.Tag=u,u.prototype.className="Tag",(0,r._registerNode)(u),e.Factory.addGetterSetter(u,"pointerDirection",a),e.Factory.addGetterSetter(u,"pointerWidth",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(u,"pointerHeight",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(u,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),Hn}var Yi={},Ou;function Nu(){if(Ou)return Yi;Ou=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.Rect=void 0;const e=Ae(),t=lt(),n=Pe(),i=et(),r=Ee();let o=class extends t.Shape{_sceneFunc(a){const l=this.cornerRadius(),c=this.width(),d=this.height();a.beginPath(),l?i.Util.drawRoundedRectPath(a,c,d,l):a.rect(0,0,c,d),a.closePath(),a.fillStrokeShape(this)}};return Yi.Rect=o,o.prototype.className="Rect",(0,n._registerNode)(o),e.Factory.addGetterSetter(o,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),Yi}var Xi={},Fu;function dg(){if(Fu)return Xi;Fu=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.RegularPolygon=void 0;const e=Ae(),t=lt(),n=Ee(),i=Pe();let r=class extends t.Shape{_sceneFunc(s){const a=this._getPoints();s.beginPath(),s.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)s.lineTo(a[l].x,a[l].y);s.closePath(),s.fillStrokeShape(this)}_getPoints(){const s=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let c=0;c<s;c++)l.push({x:a*Math.sin(c*2*Math.PI/s),y:-1*a*Math.cos(c*2*Math.PI/s)});return l}getSelfRect(){const s=this._getPoints();let a=s[0].x,l=s[0].y,c=s[0].x,d=s[0].y;return s.forEach(f=>{a=Math.min(a,f.x),l=Math.max(l,f.x),c=Math.min(c,f.y),d=Math.max(d,f.y)}),{x:a,y:c,width:l-a,height:d-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(s){this.radius(s/2)}setHeight(s){this.radius(s/2)}};return Xi.RegularPolygon=r,r.prototype.className="RegularPolygon",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),e.Factory.addGetterSetter(r,"radius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(r,"sides",0,(0,n.getNumberValidator)()),Xi}var Ji={},Iu;function hg(){if(Iu)return Ji;Iu=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.Ring=void 0;const e=Ae(),t=lt(),n=Ee(),i=Pe(),r=Math.PI*2;let o=class extends t.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,r,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),r,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return Ji.Ring=o,o.prototype.className="Ring",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(o),e.Factory.addGetterSetter(o,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(o,"outerRadius",0,(0,n.getNumberValidator)()),Ji}var Qi={},Lu;function fg(){if(Lu)return Qi;Lu=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.Sprite=void 0;const e=Ae(),t=lt(),n=ra(),i=Ee(),r=Pe();let o=class extends t.Shape{constructor(a){super(a),this._updated=!0,this.anim=new n.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),c=this.frameIndex(),d=c*4,f=this.animations()[l],g=this.frameOffsets(),p=f[d+0],u=f[d+1],v=f[d+2],b=f[d+3],x=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,v,b),a.closePath(),a.fillStrokeShape(this)),x)if(g){const m=g[l],h=c*2;a.drawImage(x,p,u,v,b,m[h+0],m[h+1],v,b)}else a.drawImage(x,p,u,v,b,0,0,v,b)}_hitFunc(a){const l=this.animation(),c=this.frameIndex(),d=c*4,f=this.animations()[l],g=this.frameOffsets(),p=f[d+2],u=f[d+3];if(a.beginPath(),g){const v=g[l],b=c*2;a.rect(v[b+0],v[b+1],p,u)}else a.rect(0,0,p,u);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),c=this.animations(),d=c[l],f=d.length/4;a<f-1?this.frameIndex(a+1):this.frameIndex(0)}};return Qi.Sprite=o,o.prototype.className="Sprite",(0,r._registerNode)(o),e.Factory.addGetterSetter(o,"animation"),e.Factory.addGetterSetter(o,"animations"),e.Factory.addGetterSetter(o,"frameOffsets"),e.Factory.addGetterSetter(o,"image"),e.Factory.addGetterSetter(o,"frameIndex",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"frameRate",17,(0,i.getNumberValidator)()),e.Factory.backCompat(o,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Qi}var er={},Gu;function pg(){if(Gu)return er;Gu=1,Object.defineProperty(er,"__esModule",{value:!0}),er.Star=void 0;const e=Ae(),t=lt(),n=Ee(),i=Pe();let r=class extends t.Shape{_sceneFunc(s){const a=this.innerRadius(),l=this.outerRadius(),c=this.numPoints();s.beginPath(),s.moveTo(0,0-l);for(let d=1;d<c*2;d++){const f=d%2===0?l:a,g=f*Math.sin(d*Math.PI/c),p=-1*f*Math.cos(d*Math.PI/c);s.lineTo(g,p)}s.closePath(),s.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(s){this.outerRadius(s/2)}setHeight(s){this.outerRadius(s/2)}};return er.Star=r,r.prototype.className="Star",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(r),e.Factory.addGetterSetter(r,"numPoints",5,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(r,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(r,"outerRadius",0,(0,n.getNumberValidator)()),er}var si={},zu;function $u(){if(zu)return si;zu=1,Object.defineProperty(si,"__esModule",{value:!0}),si.Text=void 0,si.stringToArray=s;const e=et(),t=Ae(),n=lt(),i=Pe(),r=Ee(),o=Pe();function s(H){return[...H].reduce((V,te,se,F)=>{if(/\p{Emoji}/u.test(te)){const A=F[se+1];A&&/\p{Emoji_Modifier}|\u200D/u.test(A)?(V.push(te+A),F[se+1]=""):V.push(te)}else/\p{Regional_Indicator}{2}/u.test(te+(F[se+1]||""))?V.push(te+F[se+1]):se>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(te)?V[V.length-1]+=te:te&&V.push(te);return V},[])}const a="auto",l="center",c="inherit",d="justify",f="Change.konva",g="2d",p="-",u="left",v="text",b="Text",x="top",m="bottom",h="middle",y="normal",S="px ",E=" ",D="right",C="rtl",w="word",k="char",T="none",R="",L=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],U=L.length;function z(H){return H.split(",").map(V=>{V=V.trim();const te=V.indexOf(" ")>=0,se=V.indexOf('"')>=0||V.indexOf("'")>=0;return te&&!se&&(V=`"${V}"`),V}).join(", ")}let Z;function _(){return Z||(Z=e.Util.createCanvasElement().getContext(g),Z)}function P(H){H.fillText(this._partialText,this._partialTextX,this._partialTextY)}function N(H){H.setAttr("miterLimit",2),H.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function O(H){return H=H||{},!H.fillLinearGradientColorStops&&!H.fillRadialGradientColorStops&&!H.fillPatternImage&&(H.fill=H.fill||"black"),H}let G=class extends n.Shape{constructor(V){super(O(V)),this._partialTextX=0,this._partialTextY=0;for(let te=0;te<U;te++)this.on(L[te]+f,this._setTextData);this._setTextData()}_sceneFunc(V){const te=this.textArr,se=te.length;if(!this.text())return;let F=this.padding(),A=this.fontSize(),$=this.lineHeight()*A,j=this.verticalAlign(),ee=this.direction(),fe=0,M=this.align(),I=this.getWidth(),B=this.letterSpacing(),W=this.fill(),J=this.textDecoration(),K=J.indexOf("underline")!==-1,ie=J.indexOf("line-through")!==-1,ae;ee=ee===c?V.direction:ee;let re=$/2,ne=h;if(i.Konva._fixTextRendering){const he=this.measureSize("M");ne="alphabetic",re=(he.fontBoundingBoxAscent-he.fontBoundingBoxDescent)/2+$/2}for(ee===C&&V.setAttr("direction",ee),V.setAttr("font",this._getContextFont()),V.setAttr("textBaseline",ne),V.setAttr("textAlign",u),j===h?fe=(this.getHeight()-se*$-F*2)/2:j===m&&(fe=this.getHeight()-se*$-F*2),V.translate(F,fe+F),ae=0;ae<se;ae++){let he=0,ce=0;const ge=te[ae],ve=ge.text,be=ge.width,ke=ge.lastInParagraph;if(V.save(),M===D?he+=I-be-F*2:M===l&&(he+=(I-be-F*2)/2),K){V.save(),V.beginPath();const xe=i.Konva._fixTextRendering?Math.round(A/4):Math.round(A/2),Ge=he,Me=re+ce+xe;V.moveTo(Ge,Me);const Ue=M===d&&!ke?I-F*2:be;V.lineTo(Ge+Math.round(Ue),Me),V.lineWidth=A/15;const He=this._getLinearGradient();V.strokeStyle=He||W,V.stroke(),V.restore()}if(ie){V.save(),V.beginPath();const xe=i.Konva._fixTextRendering?-Math.round(A/4):0;V.moveTo(he,re+ce+xe);const Ge=M===d&&!ke?I-F*2:be;V.lineTo(he+Math.round(Ge),re+ce+xe),V.lineWidth=A/15;const Me=this._getLinearGradient();V.strokeStyle=Me||W,V.stroke(),V.restore()}if(ee!==C&&(B!==0||M===d)){const xe=ve.split(" ").length-1,Ge=s(ve);for(let Me=0;Me<Ge.length;Me++){const Ue=Ge[Me];Ue===" "&&!ke&&M===d&&(he+=(I-F*2-be)/xe),this._partialTextX=he,this._partialTextY=re+ce,this._partialText=Ue,V.fillStrokeShape(this),he+=this.measureSize(Ue).width+B}}else B!==0&&V.setAttr("letterSpacing",`${B}px`),this._partialTextX=he,this._partialTextY=re+ce,this._partialText=ve,V.fillStrokeShape(this);V.restore(),se>1&&(re+=$)}}_hitFunc(V){const te=this.getWidth(),se=this.getHeight();V.beginPath(),V.rect(0,0,te,se),V.closePath(),V.fillStrokeShape(this)}setText(V){const te=e.Util._isString(V)?V:V==null?"":V+"";return this._setAttr(v,te),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(V){var te,se,F,A,$,j,ee,fe,M,I,B;let W=_(),J=this.fontSize(),K;W.save(),W.font=this._getContextFont(),K=W.measureText(V),W.restore();const ie=J/100;return{actualBoundingBoxAscent:(te=K.actualBoundingBoxAscent)!==null&&te!==void 0?te:71.58203125*ie,actualBoundingBoxDescent:(se=K.actualBoundingBoxDescent)!==null&&se!==void 0?se:0,actualBoundingBoxLeft:(F=K.actualBoundingBoxLeft)!==null&&F!==void 0?F:-7.421875*ie,actualBoundingBoxRight:(A=K.actualBoundingBoxRight)!==null&&A!==void 0?A:75.732421875*ie,alphabeticBaseline:($=K.alphabeticBaseline)!==null&&$!==void 0?$:0,emHeightAscent:(j=K.emHeightAscent)!==null&&j!==void 0?j:100*ie,emHeightDescent:(ee=K.emHeightDescent)!==null&&ee!==void 0?ee:-20*ie,fontBoundingBoxAscent:(fe=K.fontBoundingBoxAscent)!==null&&fe!==void 0?fe:91*ie,fontBoundingBoxDescent:(M=K.fontBoundingBoxDescent)!==null&&M!==void 0?M:21*ie,hangingBaseline:(I=K.hangingBaseline)!==null&&I!==void 0?I:72.80000305175781*ie,ideographicBaseline:(B=K.ideographicBaseline)!==null&&B!==void 0?B:-21*ie,width:K.width,height:J}}_getContextFont(){return this.fontStyle()+E+this.fontVariant()+E+(this.fontSize()+S)+z(this.fontFamily())}_addTextLine(V){this.align()===d&&(V=V.trim());const se=this._getTextWidth(V);return this.textArr.push({text:V,width:se,lastInParagraph:!1})}_getTextWidth(V){const te=this.letterSpacing(),se=V.length;return _().measureText(V).width+te*se}_setTextData(){let V=this.text().split(`
`),te=+this.fontSize(),se=0,F=this.lineHeight()*te,A=this.attrs.width,$=this.attrs.height,j=A!==a&&A!==void 0,ee=$!==a&&$!==void 0,fe=this.padding(),M=A-fe*2,I=$-fe*2,B=0,W=this.wrap(),J=W!==T,K=W!==k&&J,ie=this.ellipsis();this.textArr=[],_().font=this._getContextFont();const ae=ie?this._getTextWidth(R):0;for(let re=0,ne=V.length;re<ne;++re){let he=V[re],ce=this._getTextWidth(he);if(j&&ce>M)for(;he.length>0;){let ge=0,ve=s(he).length,be="",ke=0;for(;ge<ve;){const xe=ge+ve>>>1,Ge=s(he),Me=Ge.slice(0,xe+1).join(""),Ue=this._getTextWidth(Me);(ie&&ee&&B+F>I?Ue+ae:Ue)<=M?(ge=xe+1,be=Me,ke=Ue):ve=xe}if(be){if(K){const Me=s(he),Ue=s(be),He=Me[Ue.length],Ot=He===E||He===p;let Qt;if(Ot&&ke<=M)Qt=Ue.length;else{const ut=Ue.lastIndexOf(E),Tt=Ue.lastIndexOf(p);Qt=Math.max(ut,Tt)+1}Qt>0&&(ge=Qt,be=Me.slice(0,ge).join(""),ke=this._getTextWidth(be))}if(be=be.trimRight(),this._addTextLine(be),se=Math.max(se,ke),B+=F,this._shouldHandleEllipsis(B)){this._tryToAddEllipsisToLastLine();break}if(he=s(he).slice(ge).join("").trimLeft(),he.length>0&&(ce=this._getTextWidth(he),ce<=M)){this._addTextLine(he),B+=F,se=Math.max(se,ce);break}}else break}else this._addTextLine(he),B+=F,se=Math.max(se,ce),this._shouldHandleEllipsis(B)&&re<ne-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),ee&&B+F>I)break}this.textHeight=te,this.textWidth=se}_shouldHandleEllipsis(V){const te=+this.fontSize(),se=this.lineHeight()*te,F=this.attrs.height,A=F!==a&&F!==void 0,$=this.padding(),j=F-$*2;return!(this.wrap()!==T)||A&&V+se>j}_tryToAddEllipsisToLastLine(){const V=this.attrs.width,te=V!==a&&V!==void 0,se=this.padding(),F=V-se*2,A=this.ellipsis(),$=this.textArr[this.textArr.length-1];!$||!A||(te&&(this._getTextWidth($.text+R)<F||($.text=$.text.slice(0,$.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine($.text+R))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const V=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,te=this.hasShadow();return V&&te?!0:super._useBufferCanvas()}};return si.Text=G,G.prototype._fillFunc=P,G.prototype._strokeFunc=N,G.prototype.className=b,G.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,o._registerNode)(G),t.Factory.overWriteSetter(G,"width",(0,r.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(G,"height",(0,r.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(G,"direction",c),t.Factory.addGetterSetter(G,"fontFamily","Arial"),t.Factory.addGetterSetter(G,"fontSize",12,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(G,"fontStyle",y),t.Factory.addGetterSetter(G,"fontVariant",y),t.Factory.addGetterSetter(G,"padding",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(G,"align",u),t.Factory.addGetterSetter(G,"verticalAlign",x),t.Factory.addGetterSetter(G,"lineHeight",1,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(G,"wrap",w),t.Factory.addGetterSetter(G,"ellipsis",!1,(0,r.getBooleanValidator)()),t.Factory.addGetterSetter(G,"letterSpacing",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(G,"text","",(0,r.getStringValidator)()),t.Factory.addGetterSetter(G,"textDecoration",""),si}var tr={},Uu;function gg(){if(Uu)return tr;Uu=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.TextPath=void 0;const e=et(),t=Ae(),n=lt(),i=aa(),r=$u(),o=Ee(),s=Pe(),a="",l="normal";function c(g){g.fillText(this.partialText,0,0)}function d(g){g.strokeText(this.partialText,0,0)}let f=class extends n.Shape{constructor(p){super(p),this.dummyCanvas=e.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(p){if(!this.attrs.data)return null;const u=this.pathLength;return p-1>u?null:i.Path.getPointAtLengthOfDataArray(p,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(p){p.setAttr("font",this._getContextFont()),p.setAttr("textBaseline",this.textBaseline()),p.setAttr("textAlign","left"),p.save();const u=this.textDecoration(),v=this.fill(),b=this.fontSize(),x=this.glyphInfo;u==="underline"&&p.beginPath();for(let m=0;m<x.length;m++){p.save();const h=x[m].p0;p.translate(h.x,h.y),p.rotate(x[m].rotation),this.partialText=x[m].text,p.fillStrokeShape(this),u==="underline"&&(m===0&&p.moveTo(0,b/2+1),p.lineTo(b,b/2+1)),p.restore()}u==="underline"&&(p.strokeStyle=v,p.lineWidth=b/20,p.stroke()),p.restore()}_hitFunc(p){p.beginPath();const u=this.glyphInfo;if(u.length>=1){const v=u[0].p0;p.moveTo(v.x,v.y)}for(let v=0;v<u.length;v++){const b=u[v].p1;p.lineTo(b.x,b.y)}p.setAttr("lineWidth",this.fontSize()),p.setAttr("strokeStyle",this.colorKey),p.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(p){return r.Text.prototype.setText.call(this,p)}_getContextFont(){return r.Text.prototype._getContextFont.call(this)}_getTextSize(p){const v=this.dummyCanvas.getContext("2d");v.save(),v.font=this._getContextFont();const b=v.measureText(p);return v.restore(),{width:b.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:p,height:u}=this._getTextSize(this.attrs.text);if(this.textWidth=p,this.textHeight=u,this.glyphInfo=[],!this.attrs.data)return null;const v=this.letterSpacing(),b=this.align(),x=this.kerningFunc(),m=Math.max(this.textWidth+((this.attrs.text||"").length-1)*v,0);let h=0;b==="center"&&(h=Math.max(0,this.pathLength/2-m/2)),b==="right"&&(h=Math.max(0,this.pathLength-m));const y=(0,r.stringToArray)(this.text());let S=h;for(let E=0;E<y.length;E++){const D=this._getPointAtLength(S);if(!D)return;let C=this._getTextSize(y[E]).width+v;if(y[E]===" "&&b==="justify"){const U=this.text().split(" ").length-1;C+=(this.pathLength-m)/U}const w=this._getPointAtLength(S+C);if(!w)return;const k=i.Path.getLineLength(D.x,D.y,w.x,w.y);let T=0;if(x)try{T=x(y[E-1],y[E])*this.fontSize()}catch{T=0}D.x+=T,w.x+=T,this.textWidth+=T;const R=i.Path.getPointOnLine(T+k/2,D.x,D.y,w.x,w.y),L=Math.atan2(w.y-D.y,w.x-D.x);this.glyphInfo.push({transposeX:R.x,transposeY:R.y,text:y[E],rotation:L,p0:D,p1:w}),S+=C}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const p=[];this.glyphInfo.forEach(function(S){p.push(S.p0.x),p.push(S.p0.y),p.push(S.p1.x),p.push(S.p1.y)});let u=p[0]||0,v=p[0]||0,b=p[1]||0,x=p[1]||0,m,h;for(let S=0;S<p.length/2;S++)m=p[S*2],h=p[S*2+1],u=Math.min(u,m),v=Math.max(v,m),b=Math.min(b,h),x=Math.max(x,h);const y=this.fontSize();return{x:u-y/2,y:b-y/2,width:v-u+y,height:x-b+y}}destroy(){return e.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return tr.TextPath=f,f.prototype._fillFunc=c,f.prototype._strokeFunc=d,f.prototype._fillFuncHit=c,f.prototype._strokeFuncHit=d,f.prototype.className="TextPath",f.prototype._attrsAffectingSize=["text","fontSize","data"],(0,s._registerNode)(f),t.Factory.addGetterSetter(f,"data"),t.Factory.addGetterSetter(f,"fontFamily","Arial"),t.Factory.addGetterSetter(f,"fontSize",12,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(f,"fontStyle",l),t.Factory.addGetterSetter(f,"align","left"),t.Factory.addGetterSetter(f,"letterSpacing",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(f,"textBaseline","middle"),t.Factory.addGetterSetter(f,"fontVariant",l),t.Factory.addGetterSetter(f,"text",a),t.Factory.addGetterSetter(f,"textDecoration",""),t.Factory.addGetterSetter(f,"kerningFunc",void 0),tr}var nr={},Vu;function mg(){if(Vu)return nr;Vu=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.Transformer=void 0;const e=et(),t=Ae(),n=tt(),i=lt(),r=Nu(),o=ia(),s=Pe(),a=Ee(),l=Pe(),c="tr-konva",d=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(C=>C+`.${c}`).join(" "),f="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],p={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},u="ontouchstart"in s.Konva._global;function v(C,w,k){if(C==="rotater")return k;w+=e.Util.degToRad(p[C]||0);const T=(e.Util.radToDeg(w)%360+360)%360;return e.Util._inRange(T,337.5,360)||e.Util._inRange(T,0,22.5)?"ns-resize":e.Util._inRange(T,22.5,67.5)?"nesw-resize":e.Util._inRange(T,67.5,112.5)?"ew-resize":e.Util._inRange(T,112.5,157.5)?"nwse-resize":e.Util._inRange(T,157.5,202.5)?"ns-resize":e.Util._inRange(T,202.5,247.5)?"nesw-resize":e.Util._inRange(T,247.5,292.5)?"ew-resize":e.Util._inRange(T,292.5,337.5)?"nwse-resize":(e.Util.error("Transformer has unknown angle for cursor detection: "+T),"pointer")}const b=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function x(C){return{x:C.x+C.width/2*Math.cos(C.rotation)+C.height/2*Math.sin(-C.rotation),y:C.y+C.height/2*Math.cos(C.rotation)+C.width/2*Math.sin(C.rotation)}}function m(C,w,k){const T=k.x+(C.x-k.x)*Math.cos(w)-(C.y-k.y)*Math.sin(w),R=k.y+(C.x-k.x)*Math.sin(w)+(C.y-k.y)*Math.cos(w);return{...C,rotation:C.rotation+w,x:T,y:R}}function h(C,w){const k=x(C);return m(C,w,k)}function y(C,w,k){let T=w;for(let R=0;R<C.length;R++){const L=s.Konva.getAngle(C[R]),U=Math.abs(L-w)%(Math.PI*2);Math.min(U,Math.PI*2-U)<k&&(T=L)}return T}let S=0,E=class extends o.Group{constructor(w){super(w),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(w){return this.setNode(w),this}setNode(w){return e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([w])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(w=[]){this._nodes&&this._nodes.length&&this.detach();const k=w.filter(R=>R.isAncestorOf(this)?(e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=w=k,w.length===1&&this.useSingleNodeRotation()?this.rotation(w[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(R=>{const L=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(R._attrsAffectingSize.length){const U=R._attrsAffectingSize.map(z=>z+"Change."+this._getEventNamespace()).join(" ");R.on(U,L)}R.on(g.map(U=>U+`.${this._getEventNamespace()}`).join(" "),L),R.on(`absoluteTransformChange.${this._getEventNamespace()}`,L),this._proxyDrag(R)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(w){let k;w.on(`dragstart.${this._getEventNamespace()}`,T=>{k=w.getAbsolutePosition(),!this.isDragging()&&w!==this.findOne(".back")&&this.startDrag(T,!1)}),w.on(`dragmove.${this._getEventNamespace()}`,T=>{if(!k)return;const R=w.getAbsolutePosition(),L=R.x-k.x,U=R.y-k.y;this.nodes().forEach(z=>{if(z===w||z.isDragging())return;const Z=z.getAbsolutePosition();z.setAbsolutePosition({x:Z.x+L,y:Z.y+U}),z.startDrag(T)}),k=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(w=>{w.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(f),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(f,this.__getNodeRect)}__getNodeShape(w,k=this.rotation(),T){const R=w.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),L=w.getAbsoluteScale(T),U=w.getAbsolutePosition(T),z=R.x*L.x-w.offsetX()*L.x,Z=R.y*L.y-w.offsetY()*L.y,_=(s.Konva.getAngle(w.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),P={x:U.x+z*Math.cos(_)+Z*Math.sin(-_),y:U.y+Z*Math.cos(_)+z*Math.sin(_),width:R.width*L.x,height:R.height*L.y,rotation:_};return m(P,-s.Konva.getAngle(k),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const k=[];this.nodes().map(_=>{const P=_.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),N=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}],O=_.getAbsoluteTransform();N.forEach(function(G){const H=O.point(G);k.push(H)})});const T=new e.Transform;T.rotate(-s.Konva.getAngle(this.rotation()));let R=1/0,L=1/0,U=-1/0,z=-1/0;k.forEach(function(_){const P=T.point(_);R===void 0&&(R=U=P.x,L=z=P.y),R=Math.min(R,P.x),L=Math.min(L,P.y),U=Math.max(U,P.x),z=Math.max(z,P.y)}),T.invert();const Z=T.point({x:R,y:L});return{x:Z.x,y:Z.y,width:U-R,height:z-L,rotation:s.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),b.forEach(w=>{this._createAnchor(w)}),this._createAnchor("rotater")}_createAnchor(w){const k=new r.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:w+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:u?10:"auto"}),T=this;k.on("mousedown touchstart",function(R){T._handleMouseDown(R)}),k.on("dragstart",R=>{k.stopDrag(),R.cancelBubble=!0}),k.on("dragend",R=>{R.cancelBubble=!0}),k.on("mouseenter",()=>{const R=s.Konva.getAngle(this.rotation()),L=this.rotateAnchorCursor(),U=v(w,R,L);k.getStage().content&&(k.getStage().content.style.cursor=U),this._cursorChange=!0}),k.on("mouseout",()=>{k.getStage().content&&(k.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(k)}_createBack(){const w=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(k,T){const R=T.getParent(),L=R.padding();k.beginPath(),k.rect(-L,-L,T.width()+L*2,T.height()+L*2),k.moveTo(T.width()/2,-L),R.rotateEnabled()&&R.rotateLineVisible()&&k.lineTo(T.width()/2,-R.rotateAnchorOffset()*e.Util._sign(T.height())-L),k.fillStrokeShape(T)},hitFunc:(k,T)=>{if(!this.shouldOverdrawWholeArea())return;const R=this.padding();k.beginPath(),k.rect(-R,-R,T.width()+R*2,T.height()+R*2),k.fillStrokeShape(T)}});this.add(w),this._proxyDrag(w),w.on("dragstart",k=>{k.cancelBubble=!0}),w.on("dragmove",k=>{k.cancelBubble=!0}),w.on("dragend",k=>{k.cancelBubble=!0}),this.on("dragmove",k=>{this.update()})}_handleMouseDown(w){if(this._transforming)return;this._movingAnchorName=w.target.name().split(" ")[0];const k=this._getNodeRect(),T=k.width,R=k.height,L=Math.sqrt(Math.pow(T,2)+Math.pow(R,2));this.sin=Math.abs(R/L),this.cos=Math.abs(T/L),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const U=w.target.getAbsolutePosition(),z=w.target.getStage().getPointerPosition();this._anchorDragOffset={x:z.x-U.x,y:z.y-U.y},S++,this._fire("transformstart",{evt:w.evt,target:this.getNode()}),this._nodes.forEach(Z=>{Z._fire("transformstart",{evt:w.evt,target:Z})})}_handleMouseMove(w){let k,T,R;const L=this.findOne("."+this._movingAnchorName),U=L.getStage();U.setPointersPositions(w);const z=U.getPointerPosition();let Z={x:z.x-this._anchorDragOffset.x,y:z.y-this._anchorDragOffset.y};const _=L.getAbsolutePosition();this.anchorDragBoundFunc()&&(Z=this.anchorDragBoundFunc()(_,Z,w)),L.setAbsolutePosition(Z);const P=L.getAbsolutePosition();if(_.x===P.x&&_.y===P.y)return;if(this._movingAnchorName==="rotater"){const F=this._getNodeRect();k=L.x()-F.width/2,T=-L.y()+F.height/2;let A=Math.atan2(-T,k)+Math.PI/2;F.height<0&&(A-=Math.PI);const j=s.Konva.getAngle(this.rotation())+A,ee=s.Konva.getAngle(this.rotationSnapTolerance()),M=y(this.rotationSnaps(),j,ee)-F.rotation,I=h(F,M);this._fitNodesInto(I,w);return}const N=this.shiftBehavior();let O;N==="inverted"?O=this.keepRatio()&&!w.shiftKey:N==="none"?O=this.keepRatio():O=this.keepRatio()||w.shiftKey;let G=this.centeredScaling()||w.altKey;if(this._movingAnchorName==="top-left"){if(O){const F=G?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};R=Math.sqrt(Math.pow(F.x-L.x(),2)+Math.pow(F.y-L.y(),2));const A=this.findOne(".top-left").x()>F.x?-1:1,$=this.findOne(".top-left").y()>F.y?-1:1;k=R*this.cos*A,T=R*this.sin*$,this.findOne(".top-left").x(F.x-k),this.findOne(".top-left").y(F.y-T)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(L.y());else if(this._movingAnchorName==="top-right"){if(O){const F=G?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};R=Math.sqrt(Math.pow(L.x()-F.x,2)+Math.pow(F.y-L.y(),2));const A=this.findOne(".top-right").x()<F.x?-1:1,$=this.findOne(".top-right").y()>F.y?-1:1;k=R*this.cos*A,T=R*this.sin*$,this.findOne(".top-right").x(F.x+k),this.findOne(".top-right").y(F.y-T)}var H=L.position();this.findOne(".top-left").y(H.y),this.findOne(".bottom-right").x(H.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(L.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(L.x());else if(this._movingAnchorName==="bottom-left"){if(O){const F=G?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};R=Math.sqrt(Math.pow(F.x-L.x(),2)+Math.pow(L.y()-F.y,2));const A=F.x<L.x()?-1:1,$=L.y()<F.y?-1:1;k=R*this.cos*A,T=R*this.sin*$,L.x(F.x-k),L.y(F.y+T)}H=L.position(),this.findOne(".top-left").x(H.x),this.findOne(".bottom-right").y(H.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(L.y());else if(this._movingAnchorName==="bottom-right"){if(O){const F=G?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};R=Math.sqrt(Math.pow(L.x()-F.x,2)+Math.pow(L.y()-F.y,2));const A=this.findOne(".bottom-right").x()<F.x?-1:1,$=this.findOne(".bottom-right").y()<F.y?-1:1;k=R*this.cos*A,T=R*this.sin*$,this.findOne(".bottom-right").x(F.x+k),this.findOne(".bottom-right").y(F.y+T)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(G=this.centeredScaling()||w.altKey,G){const F=this.findOne(".top-left"),A=this.findOne(".bottom-right"),$=F.x(),j=F.y(),ee=this.getWidth()-A.x(),fe=this.getHeight()-A.y();A.move({x:-$,y:-j}),F.move({x:ee,y:fe})}const V=this.findOne(".top-left").getAbsolutePosition();k=V.x,T=V.y;const te=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),se=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:k,y:T,width:te,height:se,rotation:s.Konva.getAngle(this.rotation())},w)}_handleMouseUp(w){this._removeEvents(w)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(w){var k;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const T=this.getNode();S--,this._fire("transformend",{evt:w,target:T}),(k=this.getLayer())===null||k===void 0||k.batchDraw(),T&&this._nodes.forEach(R=>{var L;R._fire("transformend",{evt:w,target:R}),(L=R.getLayer())===null||L===void 0||L.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(w,k){const T=this._getNodeRect(),R=1;if(e.Util._inRange(w.width,-this.padding()*2-R,R)){this.update();return}if(e.Util._inRange(w.height,-this.padding()*2-R,R)){this.update();return}const L=new e.Transform;if(L.rotate(s.Konva.getAngle(this.rotation())),this._movingAnchorName&&w.width<0&&this._movingAnchorName.indexOf("left")>=0){const O=L.point({x:-this.padding()*2,y:0});w.x+=O.x,w.y+=O.y,w.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y}else if(this._movingAnchorName&&w.width<0&&this._movingAnchorName.indexOf("right")>=0){const O=L.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y,w.width+=this.padding()*2}if(this._movingAnchorName&&w.height<0&&this._movingAnchorName.indexOf("top")>=0){const O=L.point({x:0,y:-this.padding()*2});w.x+=O.x,w.y+=O.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y,w.height+=this.padding()*2}else if(this._movingAnchorName&&w.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const O=L.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=O.x,this._anchorDragOffset.y-=O.y,w.height+=this.padding()*2}if(this.boundBoxFunc()){const O=this.boundBoxFunc()(T,w);O?w=O:e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const U=1e7,z=new e.Transform;z.translate(T.x,T.y),z.rotate(T.rotation),z.scale(T.width/U,T.height/U);const Z=new e.Transform,_=w.width/U,P=w.height/U;this.flipEnabled()===!1?(Z.translate(w.x,w.y),Z.rotate(w.rotation),Z.translate(w.width<0?w.width:0,w.height<0?w.height:0),Z.scale(Math.abs(_),Math.abs(P))):(Z.translate(w.x,w.y),Z.rotate(w.rotation),Z.scale(_,P));const N=Z.multiply(z.invert());this._nodes.forEach(O=>{var G;const H=O.getParent().getAbsoluteTransform(),V=O.getTransform().copy();V.translate(O.offsetX(),O.offsetY());const te=new e.Transform;te.multiply(H.copy().invert()).multiply(N).multiply(H).multiply(V);const se=te.decompose();O.setAttrs(se),(G=O.getLayer())===null||G===void 0||G.batchDraw()}),this.rotation(e.Util._getRotation(w.rotation)),this._nodes.forEach(O=>{this._fire("transform",{evt:k,target:O}),O._fire("transform",{evt:k,target:O})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(w,k){this.findOne(w).setAttrs(k)}update(){var w;const k=this._getNodeRect();this.rotation(e.Util._getRotation(k.rotation));const T=k.width,R=k.height,L=this.enabledAnchors(),U=this.resizeEnabled(),z=this.padding(),Z=this.anchorSize(),_=this.find("._anchor");_.forEach(N=>{N.setAttrs({width:Z,height:Z,offsetX:Z/2,offsetY:Z/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:Z/2+z,offsetY:Z/2+z,visible:U&&L.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:T/2,y:0,offsetY:Z/2+z,visible:U&&L.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:T,y:0,offsetX:Z/2-z,offsetY:Z/2+z,visible:U&&L.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:R/2,offsetX:Z/2+z,visible:U&&L.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:T,y:R/2,offsetX:Z/2-z,visible:U&&L.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:R,offsetX:Z/2+z,offsetY:Z/2-z,visible:U&&L.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:T/2,y:R,offsetY:Z/2-z,visible:U&&L.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:T,y:R,offsetX:Z/2-z,offsetY:Z/2-z,visible:U&&L.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:T/2,y:-this.rotateAnchorOffset()*e.Util._sign(R)-z,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:T,height:R,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const P=this.anchorStyleFunc();P&&_.forEach(N=>{P(N)}),(w=this.getLayer())===null||w===void 0||w.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const w=this.findOne("."+this._movingAnchorName);w&&w.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),o.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(w){return n.Node.prototype.clone.call(this,w)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};nr.Transformer=E,E.isTransforming=()=>S>0;function D(C){return C instanceof Array||e.Util.warn("enabledAnchors value should be an array"),C instanceof Array&&C.forEach(function(w){b.indexOf(w)===-1&&e.Util.warn("Unknown anchor name: "+w+". Available names are: "+b.join(", "))}),C||[]}return E.prototype.className="Transformer",(0,l._registerNode)(E),t.Factory.addGetterSetter(E,"enabledAnchors",b,D),t.Factory.addGetterSetter(E,"flipEnabled",!0,(0,a.getBooleanValidator)()),t.Factory.addGetterSetter(E,"resizeEnabled",!0),t.Factory.addGetterSetter(E,"anchorSize",10,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(E,"rotateEnabled",!0),t.Factory.addGetterSetter(E,"rotateLineVisible",!0),t.Factory.addGetterSetter(E,"rotationSnaps",[]),t.Factory.addGetterSetter(E,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(E,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(E,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(E,"borderEnabled",!0),t.Factory.addGetterSetter(E,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(E,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(E,"anchorFill","white"),t.Factory.addGetterSetter(E,"anchorCornerRadius",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(E,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(E,"borderStrokeWidth",1,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(E,"borderDash"),t.Factory.addGetterSetter(E,"keepRatio",!0),t.Factory.addGetterSetter(E,"shiftBehavior","default"),t.Factory.addGetterSetter(E,"centeredScaling",!1),t.Factory.addGetterSetter(E,"ignoreStroke",!1),t.Factory.addGetterSetter(E,"padding",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(E,"nodes"),t.Factory.addGetterSetter(E,"node"),t.Factory.addGetterSetter(E,"boundBoxFunc"),t.Factory.addGetterSetter(E,"anchorDragBoundFunc"),t.Factory.addGetterSetter(E,"anchorStyleFunc"),t.Factory.addGetterSetter(E,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(E,"useSingleNodeRotation",!0),t.Factory.backCompat(E,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),nr}var ir={},Bu;function yg(){if(Bu)return ir;Bu=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.Wedge=void 0;const e=Ae(),t=lt(),n=Pe(),i=Ee(),r=Pe();let o=class extends t.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return ir.Wedge=o,o.prototype.className="Wedge",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["radius"],(0,r._registerNode)(o),e.Factory.addGetterSetter(o,"radius",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"angle",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(o,"clockwise",!1),e.Factory.backCompat(o,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),ir}var rr={},Hu;function vg(){if(Hu)return rr;Hu=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.Blur=void 0;const e=Ae(),t=tt(),n=Ee();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const r=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],o=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function s(l,c){const d=l.data,f=l.width,g=l.height;let p,u,v,b,x,m,h,y,S,E,D,C,w,k,T,R,L,U,z,Z;const _=c+c+1,P=f-1,N=g-1,O=c+1,G=O*(O+1)/2,H=new i,V=r[c],te=o[c];let se=null,F=H,A=null,$=null;for(let j=1;j<_;j++)F=F.next=new i,j===O&&(se=F);F.next=H,v=u=0;for(let j=0;j<g;j++){C=w=k=T=b=x=m=h=0,y=O*(R=d[u]),S=O*(L=d[u+1]),E=O*(U=d[u+2]),D=O*(z=d[u+3]),b+=G*R,x+=G*L,m+=G*U,h+=G*z,F=H;for(let ee=0;ee<O;ee++)F.r=R,F.g=L,F.b=U,F.a=z,F=F.next;for(let ee=1;ee<O;ee++)p=u+((P<ee?P:ee)<<2),b+=(F.r=R=d[p])*(Z=O-ee),x+=(F.g=L=d[p+1])*Z,m+=(F.b=U=d[p+2])*Z,h+=(F.a=z=d[p+3])*Z,C+=R,w+=L,k+=U,T+=z,F=F.next;A=H,$=se;for(let ee=0;ee<f;ee++)d[u+3]=z=h*V>>te,z!==0?(z=255/z,d[u]=(b*V>>te)*z,d[u+1]=(x*V>>te)*z,d[u+2]=(m*V>>te)*z):d[u]=d[u+1]=d[u+2]=0,b-=y,x-=S,m-=E,h-=D,y-=A.r,S-=A.g,E-=A.b,D-=A.a,p=v+((p=ee+c+1)<P?p:P)<<2,C+=A.r=d[p],w+=A.g=d[p+1],k+=A.b=d[p+2],T+=A.a=d[p+3],b+=C,x+=w,m+=k,h+=T,A=A.next,y+=R=$.r,S+=L=$.g,E+=U=$.b,D+=z=$.a,C-=R,w-=L,k-=U,T-=z,$=$.next,u+=4;v+=f}for(let j=0;j<f;j++){w=k=T=C=x=m=h=b=0,u=j<<2,y=O*(R=d[u]),S=O*(L=d[u+1]),E=O*(U=d[u+2]),D=O*(z=d[u+3]),b+=G*R,x+=G*L,m+=G*U,h+=G*z,F=H;for(let fe=0;fe<O;fe++)F.r=R,F.g=L,F.b=U,F.a=z,F=F.next;let ee=f;for(let fe=1;fe<=c;fe++)u=ee+j<<2,b+=(F.r=R=d[u])*(Z=O-fe),x+=(F.g=L=d[u+1])*Z,m+=(F.b=U=d[u+2])*Z,h+=(F.a=z=d[u+3])*Z,C+=R,w+=L,k+=U,T+=z,F=F.next,fe<N&&(ee+=f);u=j,A=H,$=se;for(let fe=0;fe<g;fe++)p=u<<2,d[p+3]=z=h*V>>te,z>0?(z=255/z,d[p]=(b*V>>te)*z,d[p+1]=(x*V>>te)*z,d[p+2]=(m*V>>te)*z):d[p]=d[p+1]=d[p+2]=0,b-=y,x-=S,m-=E,h-=D,y-=A.r,S-=A.g,E-=A.b,D-=A.a,p=j+((p=fe+O)<N?p:N)*f<<2,b+=C+=A.r=d[p],x+=w+=A.g=d[p+1],m+=k+=A.b=d[p+2],h+=T+=A.a=d[p+3],A=A.next,y+=R=$.r,S+=L=$.g,E+=U=$.b,D+=z=$.a,C-=R,w-=L,k-=U,T-=z,$=$.next,u+=f}}const a=function(c){const d=Math.round(this.blurRadius());d>0&&s(c,d)};return rr.Blur=a,e.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),rr}var or={},ju;function _g(){if(ju)return or;ju=1,Object.defineProperty(or,"__esModule",{value:!0}),or.Brighten=void 0;const e=Ae(),t=tt(),n=Ee(),i=function(r){const o=this.brightness()*255,s=r.data,a=s.length;for(let l=0;l<a;l+=4)s[l]+=o,s[l+1]+=o,s[l+2]+=o};return or.Brighten=i,e.Factory.addGetterSetter(t.Node,"brightness",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),or}var sr={},Wu;function bg(){if(Wu)return sr;Wu=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.Contrast=void 0;const e=Ae(),t=tt(),n=Ee(),i=function(r){const o=Math.pow((this.contrast()+100)/100,2),s=r.data,a=s.length;let l=150,c=150,d=150;for(let f=0;f<a;f+=4)l=s[f],c=s[f+1],d=s[f+2],l/=255,l-=.5,l*=o,l+=.5,l*=255,c/=255,c-=.5,c*=o,c+=.5,c*=255,d/=255,d-=.5,d*=o,d+=.5,d*=255,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,d=d<0?0:d>255?255:d,s[f]=l,s[f+1]=c,s[f+2]=d};return sr.Contrast=i,e.Factory.addGetterSetter(t.Node,"contrast",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),sr}var ar={},Zu;function Sg(){if(Zu)return ar;Zu=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.Emboss=void 0;const e=Ae(),t=tt(),n=et(),i=Ee(),r=function(o){const s=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),c=this.embossBlend(),d=o.data,f=o.width,g=o.height,p=f*4;let u=0,v=0,b=g;switch(l){case"top-left":u=-1,v=-1;break;case"top":u=-1,v=0;break;case"top-right":u=-1,v=1;break;case"right":u=0,v=1;break;case"bottom-right":u=1,v=1;break;case"bottom":u=1,v=0;break;case"bottom-left":u=1,v=-1;break;case"left":u=0,v=-1;break;default:n.Util.error("Unknown emboss direction: "+l)}do{const x=(b-1)*p;let m=u;b+m<1&&(m=0),b+m>g&&(m=0);const h=(b-1+m)*f*4;let y=f;do{const S=x+(y-1)*4;let E=v;y+E<1&&(E=0),y+E>f&&(E=0);const D=h+(y-1+E)*4,C=d[S]-d[D],w=d[S+1]-d[D+1],k=d[S+2]-d[D+2];let T=C;const R=T>0?T:-T,L=w>0?w:-w,U=k>0?k:-k;if(L>R&&(T=w),U>R&&(T=k),T*=s,c){const z=d[S]+T,Z=d[S+1]+T,_=d[S+2]+T;d[S]=z>255?255:z<0?0:z,d[S+1]=Z>255?255:Z<0?0:Z,d[S+2]=_>255?255:_<0?0:_}else{let z=a-T;z<0?z=0:z>255&&(z=255),d[S]=d[S+1]=d[S+2]=z}}while(--y)}while(--b)};return ar.Emboss=r,e.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,i.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,e.Factory.afterSetFilter),ar}var lr={},Ku;function wg(){if(Ku)return lr;Ku=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.Enhance=void 0;const e=Ae(),t=tt(),n=Ee();function i(o,s,a,l,c){const d=a-s,f=c-l;if(d===0)return l+f/2;if(f===0)return l;let g=(o-s)/d;return g=f*g+l,g}const r=function(o){const s=o.data,a=s.length;let l=s[0],c=l,d,f=s[1],g=f,p,u=s[2],v=u,b;const x=this.enhance();if(x===0)return;for(let C=0;C<a;C+=4)d=s[C+0],d<l?l=d:d>c&&(c=d),p=s[C+1],p<f?f=p:p>g&&(g=p),b=s[C+2],b<u?u=b:b>v&&(v=b);c===l&&(c=255,l=0),g===f&&(g=255,f=0),v===u&&(v=255,u=0);let m,h,y,S,E,D;if(x>0)m=c+x*(255-c),h=l-x*(l-0),y=g+x*(255-g),S=f-x*(f-0),E=v+x*(255-v),D=u-x*(u-0);else{const C=(c+l)*.5;m=c+x*(c-C),h=l+x*(l-C);const w=(g+f)*.5;y=g+x*(g-w),S=f+x*(f-w);const k=(v+u)*.5;E=v+x*(v-k),D=u+x*(u-k)}for(let C=0;C<a;C+=4)s[C+0]=i(s[C+0],l,c,h,m),s[C+1]=i(s[C+1],f,g,S,y),s[C+2]=i(s[C+2],u,v,D,E)};return lr.Enhance=r,e.Factory.addGetterSetter(t.Node,"enhance",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),lr}var cr={},qu;function xg(){if(qu)return cr;qu=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.Grayscale=void 0;const e=function(t){const n=t.data,i=n.length;for(let r=0;r<i;r+=4){const o=.34*n[r]+.5*n[r+1]+.16*n[r+2];n[r]=o,n[r+1]=o,n[r+2]=o}};return cr.Grayscale=e,cr}var ur={},Yu;function Cg(){if(Yu)return ur;Yu=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.HSL=void 0;const e=Ae(),t=tt(),n=Ee();e.Factory.addGetterSetter(t.Node,"hue",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"luminance",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter);const i=function(r){const o=r.data,s=o.length,a=1,l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,d=this.luminance()*127,f=a*l*Math.cos(c*Math.PI/180),g=a*l*Math.sin(c*Math.PI/180),p=.299*a+.701*f+.167*g,u=.587*a-.587*f+.33*g,v=.114*a-.114*f-.497*g,b=.299*a-.299*f-.328*g,x=.587*a+.413*f+.035*g,m=.114*a-.114*f+.293*g,h=.299*a-.3*f+1.25*g,y=.587*a-.586*f-1.05*g,S=.114*a+.886*f-.2*g;let E,D,C,w;for(let k=0;k<s;k+=4)E=o[k+0],D=o[k+1],C=o[k+2],w=o[k+3],o[k+0]=p*E+u*D+v*C+d,o[k+1]=b*E+x*D+m*C+d,o[k+2]=h*E+y*D+S*C+d,o[k+3]=w};return ur.HSL=i,ur}var dr={},Xu;function kg(){if(Xu)return dr;Xu=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.HSV=void 0;const e=Ae(),t=tt(),n=Ee(),i=function(r){const o=r.data,s=o.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,d=a*l*Math.cos(c*Math.PI/180),f=a*l*Math.sin(c*Math.PI/180),g=.299*a+.701*d+.167*f,p=.587*a-.587*d+.33*f,u=.114*a-.114*d-.497*f,v=.299*a-.299*d-.328*f,b=.587*a+.413*d+.035*f,x=.114*a-.114*d+.293*f,m=.299*a-.3*d+1.25*f,h=.587*a-.586*d-1.05*f,y=.114*a+.886*d-.2*f;for(let S=0;S<s;S+=4){const E=o[S+0],D=o[S+1],C=o[S+2],w=o[S+3];o[S+0]=g*E+p*D+u*C,o[S+1]=v*E+b*D+x*C,o[S+2]=m*E+h*D+y*C,o[S+3]=w}};return dr.HSV=i,e.Factory.addGetterSetter(t.Node,"hue",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"value",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),dr}var hr={},Ju;function Pg(){if(Ju)return hr;Ju=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.Invert=void 0;const e=function(t){const n=t.data,i=n.length;for(let r=0;r<i;r+=4)n[r]=255-n[r],n[r+1]=255-n[r+1],n[r+2]=255-n[r+2]};return hr.Invert=e,hr}var fr={},Qu;function Tg(){if(Qu)return fr;Qu=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.Kaleidoscope=void 0;const e=Ae(),t=tt(),n=et(),i=Ee(),r=function(a,l,c){const d=a.data,f=l.data,g=a.width,p=a.height,u=c.polarCenterX||g/2,v=c.polarCenterY||p/2;let b=Math.sqrt(u*u+v*v),x=g-u,m=p-v;const h=Math.sqrt(x*x+m*m);b=h>b?h:b;const y=p,S=g,E=360/S*Math.PI/180;for(let D=0;D<S;D+=1){const C=Math.sin(D*E),w=Math.cos(D*E);for(let k=0;k<y;k+=1){x=Math.floor(u+b*k/y*w),m=Math.floor(v+b*k/y*C);let T=(m*g+x)*4;const R=d[T+0],L=d[T+1],U=d[T+2],z=d[T+3];T=(D+k*g)*4,f[T+0]=R,f[T+1]=L,f[T+2]=U,f[T+3]=z}}},o=function(a,l,c){const d=a.data,f=l.data,g=a.width,p=a.height,u=c.polarCenterX||g/2,v=c.polarCenterY||p/2;let b=Math.sqrt(u*u+v*v),x=g-u,m=p-v;const h=Math.sqrt(x*x+m*m);b=h>b?h:b;const y=p,S=g,E=0;let D,C;for(x=0;x<g;x+=1)for(m=0;m<p;m+=1){const w=x-u,k=m-v,T=Math.sqrt(w*w+k*k)*y/b;let R=(Math.atan2(k,w)*180/Math.PI+360+E)%360;R=R*S/360,D=Math.floor(R),C=Math.floor(T);let L=(C*g+D)*4;const U=d[L+0],z=d[L+1],Z=d[L+2],_=d[L+3];L=(m*g+x)*4,f[L+0]=U,f[L+1]=z,f[L+2]=Z,f[L+3]=_}},s=function(a){const l=a.width,c=a.height;let d,f,g,p,u,v,b,x,m,h,y=Math.round(this.kaleidoscopePower());const S=Math.round(this.kaleidoscopeAngle()),E=Math.floor(l*(S%360)/360);if(y<1)return;const D=n.Util.createCanvasElement();D.width=l,D.height=c;const C=D.getContext("2d").getImageData(0,0,l,c);n.Util.releaseCanvas(D),r(a,C,{polarCenterX:l/2,polarCenterY:c/2});let w=l/Math.pow(2,y);for(;w<=8;)w=w*2,y-=1;w=Math.ceil(w);let k=w,T=0,R=k,L=1;for(E+w>l&&(T=k,R=0,L=-1),f=0;f<c;f+=1)for(d=T;d!==R;d+=L)g=Math.round(d+E)%l,m=(l*f+g)*4,u=C.data[m+0],v=C.data[m+1],b=C.data[m+2],x=C.data[m+3],h=(l*f+d)*4,C.data[h+0]=u,C.data[h+1]=v,C.data[h+2]=b,C.data[h+3]=x;for(f=0;f<c;f+=1)for(k=Math.floor(w),p=0;p<y;p+=1){for(d=0;d<k+1;d+=1)m=(l*f+d)*4,u=C.data[m+0],v=C.data[m+1],b=C.data[m+2],x=C.data[m+3],h=(l*f+k*2-d-1)*4,C.data[h+0]=u,C.data[h+1]=v,C.data[h+2]=b,C.data[h+3]=x;k*=2}o(C,a,{})};return fr.Kaleidoscope=s,e.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),e.Factory.afterSetFilter),fr}var pr={},ed;function Ag(){if(ed)return pr;ed=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.Mask=void 0;const e=Ae(),t=tt(),n=Ee();function i(g,p,u){let v=(u*g.width+p)*4;const b=[];return b.push(g.data[v++],g.data[v++],g.data[v++],g.data[v++]),b}function r(g,p){return Math.sqrt(Math.pow(g[0]-p[0],2)+Math.pow(g[1]-p[1],2)+Math.pow(g[2]-p[2],2))}function o(g){const p=[0,0,0];for(let u=0;u<g.length;u++)p[0]+=g[u][0],p[1]+=g[u][1],p[2]+=g[u][2];return p[0]/=g.length,p[1]/=g.length,p[2]/=g.length,p}function s(g,p){const u=i(g,0,0),v=i(g,g.width-1,0),b=i(g,0,g.height-1),x=i(g,g.width-1,g.height-1),m=p||10;if(r(u,v)<m&&r(v,x)<m&&r(x,b)<m&&r(b,u)<m){const h=o([v,u,x,b]),y=[];for(let S=0;S<g.width*g.height;S++){const E=r(h,[g.data[S*4],g.data[S*4+1],g.data[S*4+2]]);y[S]=E<m?0:255}return y}}function a(g,p){for(let u=0;u<g.width*g.height;u++)g.data[4*u+3]=p[u]}function l(g,p,u){const v=[1,1,1,1,0,1,1,1,1],b=Math.round(Math.sqrt(v.length)),x=Math.floor(b/2),m=[];for(let h=0;h<u;h++)for(let y=0;y<p;y++){const S=h*p+y;let E=0;for(let D=0;D<b;D++)for(let C=0;C<b;C++){const w=h+D-x,k=y+C-x;if(w>=0&&w<u&&k>=0&&k<p){const T=w*p+k,R=v[D*b+C];E+=g[T]*R}}m[S]=E===2040?255:0}return m}function c(g,p,u){const v=[1,1,1,1,1,1,1,1,1],b=Math.round(Math.sqrt(v.length)),x=Math.floor(b/2),m=[];for(let h=0;h<u;h++)for(let y=0;y<p;y++){const S=h*p+y;let E=0;for(let D=0;D<b;D++)for(let C=0;C<b;C++){const w=h+D-x,k=y+C-x;if(w>=0&&w<u&&k>=0&&k<p){const T=w*p+k,R=v[D*b+C];E+=g[T]*R}}m[S]=E>=1020?255:0}return m}function d(g,p,u){const v=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],b=Math.round(Math.sqrt(v.length)),x=Math.floor(b/2),m=[];for(let h=0;h<u;h++)for(let y=0;y<p;y++){const S=h*p+y;let E=0;for(let D=0;D<b;D++)for(let C=0;C<b;C++){const w=h+D-x,k=y+C-x;if(w>=0&&w<u&&k>=0&&k<p){const T=w*p+k,R=v[D*b+C];E+=g[T]*R}}m[S]=E}return m}const f=function(g){const p=this.threshold();let u=s(g,p);return u&&(u=l(u,g.width,g.height),u=c(u,g.width,g.height),u=d(u,g.width,g.height),a(g,u)),g};return pr.Mask=f,e.Factory.addGetterSetter(t.Node,"threshold",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),pr}var gr={},td;function Eg(){if(td)return gr;td=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.Noise=void 0;const e=Ae(),t=tt(),n=Ee(),i=function(r){const o=this.noise()*255,s=r.data,a=s.length,l=o/2;for(let c=0;c<a;c+=4)s[c+0]+=l-2*l*Math.random(),s[c+1]+=l-2*l*Math.random(),s[c+2]+=l-2*l*Math.random()};return gr.Noise=i,e.Factory.addGetterSetter(t.Node,"noise",.2,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),gr}var mr={},nd;function Rg(){if(nd)return mr;nd=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.Pixelate=void 0;const e=Ae(),t=et(),n=tt(),i=Ee(),r=function(o){let s=Math.ceil(this.pixelSize()),a=o.width,l=o.height,c=Math.ceil(a/s),d=Math.ceil(l/s),f=o.data;if(s<=0){t.Util.error("pixelSize value can not be <= 0");return}for(let g=0;g<c;g+=1)for(let p=0;p<d;p+=1){let u=0,v=0,b=0,x=0;const m=g*s,h=m+s,y=p*s,S=y+s;let E=0;for(let D=m;D<h;D+=1)if(!(D>=a))for(let C=y;C<S;C+=1){if(C>=l)continue;const w=(a*C+D)*4;u+=f[w+0],v+=f[w+1],b+=f[w+2],x+=f[w+3],E+=1}u=u/E,v=v/E,b=b/E,x=x/E;for(let D=m;D<h;D+=1)if(!(D>=a))for(let C=y;C<S;C+=1){if(C>=l)continue;const w=(a*C+D)*4;f[w+0]=u,f[w+1]=v,f[w+2]=b,f[w+3]=x}}};return mr.Pixelate=r,e.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),e.Factory.afterSetFilter),mr}var yr={},id;function Dg(){if(id)return yr;id=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.Posterize=void 0;const e=Ae(),t=tt(),n=Ee(),i=function(r){const o=Math.round(this.levels()*254)+1,s=r.data,a=s.length,l=255/o;for(let c=0;c<a;c+=1)s[c]=Math.floor(s[c]/l)*l};return yr.Posterize=i,e.Factory.addGetterSetter(t.Node,"levels",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),yr}var vr={},rd;function Mg(){if(rd)return vr;rd=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.RGB=void 0;const e=Ae(),t=tt(),n=Ee(),i=function(r){const o=r.data,s=o.length,a=this.red(),l=this.green(),c=this.blue();for(let d=0;d<s;d+=4){const f=(.34*o[d]+.5*o[d+1]+.16*o[d+2])/255;o[d]=f*a,o[d+1]=f*l,o[d+2]=f*c,o[d+3]=o[d+3]}};return vr.RGB=i,e.Factory.addGetterSetter(t.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),e.Factory.addGetterSetter(t.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),e.Factory.addGetterSetter(t.Node,"blue",0,n.RGBComponent,e.Factory.afterSetFilter),vr}var _r={},od;function Og(){if(od)return _r;od=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.RGBA=void 0;const e=Ae(),t=tt(),n=Ee(),i=function(r){const o=r.data,s=o.length,a=this.red(),l=this.green(),c=this.blue(),d=this.alpha();for(let f=0;f<s;f+=4){const g=1-d;o[f]=a*d+o[f]*g,o[f+1]=l*d+o[f+1]*g,o[f+2]=c*d+o[f+2]*g}};return _r.RGBA=i,e.Factory.addGetterSetter(t.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),e.Factory.addGetterSetter(t.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),e.Factory.addGetterSetter(t.Node,"blue",0,n.RGBComponent,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r}),_r}var br={},sd;function Ng(){if(sd)return br;sd=1,Object.defineProperty(br,"__esModule",{value:!0}),br.Sepia=void 0;const e=function(t){const n=t.data,i=n.length;for(let r=0;r<i;r+=4){const o=n[r+0],s=n[r+1],a=n[r+2];n[r+0]=Math.min(255,o*.393+s*.769+a*.189),n[r+1]=Math.min(255,o*.349+s*.686+a*.168),n[r+2]=Math.min(255,o*.272+s*.534+a*.131)}};return br.Sepia=e,br}var Sr={},ad;function Fg(){if(ad)return Sr;ad=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.Solarize=void 0;const e=function(t){const n=t.data,i=t.width,r=t.height,o=i*4;let s=r;do{const a=(s-1)*o;let l=i;do{const c=a+(l-1)*4;let d=n[c],f=n[c+1],g=n[c+2];d>127&&(d=255-d),f>127&&(f=255-f),g>127&&(g=255-g),n[c]=d,n[c+1]=f,n[c+2]=g}while(--l)}while(--s)};return Sr.Solarize=e,Sr}var wr={},ld;function Ig(){if(ld)return wr;ld=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.Threshold=void 0;const e=Ae(),t=tt(),n=Ee(),i=function(r){const o=this.threshold()*255,s=r.data,a=s.length;for(let l=0;l<a;l+=1)s[l]=s[l]<o?0:255};return wr.Threshold=i,e.Factory.addGetterSetter(t.Node,"threshold",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),wr}var cd;function Lg(){if(cd)return Ii;cd=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.Konva=void 0;const e=ig(),t=rg(),n=sg(),i=ag(),r=lg(),o=cg(),s=ug(),a=ku(),l=aa(),c=Nu(),d=dg(),f=hg(),g=fg(),p=pg(),u=$u(),v=gg(),b=mg(),x=yg(),m=vg(),h=_g(),y=bg(),S=Sg(),E=wg(),D=xg(),C=Cg(),w=kg(),k=Pg(),T=Tg(),R=Ag(),L=Eg(),U=Rg(),z=Dg(),Z=Mg(),_=Og(),P=Ng(),N=Fg(),O=Ig();return Ii.Konva=e.Konva.Util._assign(e.Konva,{Arc:t.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:r.Ellipse,Image:o.Image,Label:s.Label,Tag:s.Tag,Line:a.Line,Path:l.Path,Rect:c.Rect,RegularPolygon:d.RegularPolygon,Ring:f.Ring,Sprite:g.Sprite,Star:p.Star,Text:u.Text,TextPath:v.TextPath,Transformer:b.Transformer,Wedge:x.Wedge,Filters:{Blur:m.Blur,Brighten:h.Brighten,Contrast:y.Contrast,Emboss:S.Emboss,Enhance:E.Enhance,Grayscale:D.Grayscale,HSL:C.HSL,HSV:w.HSV,Invert:k.Invert,Kaleidoscope:T.Kaleidoscope,Mask:R.Mask,Noise:L.Noise,Pixelate:U.Pixelate,Posterize:z.Posterize,RGB:Z.RGB,RGBA:_.RGBA,Sepia:P.Sepia,Solarize:N.Solarize,Threshold:O.Threshold}}),Ii}var Gg=_o.exports,ud;function zg(){if(ud)return _o.exports;ud=1,Object.defineProperty(Gg,"__esModule",{value:!0});const e=Lg();return _o.exports=e.Konva,_o.exports}var $g=zg();const X=Q0($g);class Ug{constructor(t,n,i){this.captureState=t,this.restoreState=n,this.onStateChange=i}history=[];historyIndex=-1;inUndoRedo=!1;maxHistorySize=50;executeCommand(t,n){if(this.inUndoRedo){n();return}const i=this.captureState();if(!i)return;n();const r=this.captureState();if(!r||i===r)return;const o={name:t,beforeState:i,afterState:r};this.history.splice(this.historyIndex+1),this.history.push(o),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${t}" added to history. Index: ${this.historyIndex}`)}pushCommand(t,n,i){if(!n||!i||n===i)return;const r={name:t,beforeState:n,afterState:i};this.history.splice(this.historyIndex+1),this.history.push(r),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${t}" pushed. Index: ${this.historyIndex}`)}undo(){if(this.historyIndex<0)return;this.inUndoRedo=!0;const t=this.history[this.historyIndex];console.log(`Undoing command: ${t.name}`),this.restoreState(t.beforeState),this.historyIndex--,this.onStateChange?.(),this.inUndoRedo=!1}redo(){if(this.historyIndex>=this.history.length-1)return;this.inUndoRedo=!0,this.historyIndex++;const t=this.history[this.historyIndex];console.log(`Redoing command: ${t.name}`),this.restoreState(t.afterState),this.onStateChange?.(),this.inUndoRedo=!1}canUndo(){return this.historyIndex>=0}canRedo(){return this.historyIndex<this.history.length-1}}const Vg=()=>{const e=kl(new Set),t=new Map,n=Se(()=>Array.from(e,i=>i.konvaNode));return{stage:void 0,konvaContainer:void 0,activeTool:ye("select"),metadataSchemas:[],layers:{grid:void 0,drawing:void 0,overlay:void 0,transformer:void 0},groups:{freehandShape:void 0,freehandDrawing:void 0,polygonShapes:void 0,polygonPreview:void 0,polygonControls:void 0,polygonSelection:void 0,ancillaryViz:void 0,metadataHighlight:void 0,selectionOverlay:void 0},grid:{visible:ye(!1),size:20},canvasItems:new Map,notification:{message:ye(""),visible:ye(!1)},callbacks:{},keyboardDisposables:[],freehand:{strokes:new Map,strokeGroups:new Map,dragSelectionState:ye({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,isDrawing:!1,currentPoints:[],currentTimestamps:[],drawingStartTime:0,selectedStrokesForTimeline:ye(new Set),timelineDuration:ye(0),currentPlaybackTime:ye(0),freehandDrawMode:ye(!0),useRealTiming:ye(!1),maxInterStrokeDelay:300,isAnimating:ye(!1),freehandDragStartState:null,serializedState:"",bakedRenderData:[],bakedGroupMap:{}},polygon:{shapes:new Map,groups:new Map,isDrawing:ye(!1),currentPoints:ye([]),mode:ye("draw"),dragStartState:null,proximityThreshold:10,serializedState:"",bakedRenderData:[]},circle:{shapes:new Map,isDrawing:ye(!1),currentCenter:ye(null),currentRadius:ye(0),dragStartState:null,serializedState:"",bakedRenderData:[],bakedGroupMap:{}},selection:{items:e,originalStyles:t,selectedKonvaNodes:n,dragSelectionState:ye({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,selectionDragState:{isDragging:!1,startPos:{x:0,y:0},startNodePositions:new Map,beforeState:""},transformStartState:""},command:{},metadata:{activeNode:ye(null),metadataText:ye(""),showEditor:ye(!0),highlight:{}},ancillary:{activeVisualizations:ye(new Set),nodeVisualizations:new Map,listenersAttached:!1,rafToken:null,activeWatchStop:void 0},snapshots:{showPanel:ye(!1),items:ye([]),selectedId:ye(null)}}},Ct=e=>e.freehand.strokes,la=e=>e.freehand.strokeGroups,Lt=e=>e.polygon.shapes,ca=e=>e.circle.shapes;let wo=null;const Bg=(e,t,n=2e3)=>{e.notification.message.value=t,e.notification.visible.value=!0,wo&&clearTimeout(wo),wo=setTimeout(()=>{e.notification.visible.value=!1,wo=null},n)};function dd(e,t){const n=new Set(t);return e.filter(i=>!n.has(i))}function Hg(e,t){const n=new Set(t);return e.filter(i=>n.has(i))}function jg(e,t){const n={};for(const i of e)n[String(t(i))]=i;return n}function Wg(e,t,n={}){let{embeddedObjKeys:i}=n;const{keysToSkip:r,treatTypeChangeAsReplace:o}=n;return i instanceof Map?i=new Map(Array.from(i.entries()).map(([s,a])=>[s instanceof RegExp?s:s.replace(/^\./,""),a])):i&&(i=Object.fromEntries(Object.entries(i).map(([s,a])=>[s.replace(/^\./,""),a]))),hd(e,t,[],[],{embeddedObjKeys:i,keysToSkip:r??[],treatTypeChangeAsReplace:o??!0})}var ua=e=>typeof e>"u"?"undefined":e===null?null:Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1],Bt=e=>{const t=e[e.length-1];return t??"$root"},hd=(e,t,n,i,r)=>{let o=[];const s=i.join(".");if(r.keysToSkip?.some(c=>{if(s===c)return!0;if(c.includes(".")&&c.startsWith(s+"."))return!1;if(c.includes(".")){const d=c.split("."),f=s.split(".");if(f.length>=d.length){for(let g=0;g<d.length;g++)if(d[g]!==f[g])return!1;return!0}}return!1}))return o;const a=ua(e),l=ua(t);if(r.treatTypeChangeAsReplace&&a!==l)return a!=="undefined"&&o.push({type:"REMOVE",key:Bt(n),value:e}),l!=="undefined"&&o.push({type:"ADD",key:Bt(n),value:t}),o;if(l==="undefined"&&a!=="undefined")return o.push({type:"REMOVE",key:Bt(n),value:e}),o;if(l==="Object"&&a==="Array")return o.push({type:"UPDATE",key:Bt(n),value:t,oldValue:e}),o;if(l===null)return a!==null&&o.push({type:"UPDATE",key:Bt(n),value:t,oldValue:e}),o;switch(a){case"Date":l==="Date"?o=o.concat(da(e.getTime(),t.getTime(),n).map(c=>({...c,value:new Date(c.value),oldValue:new Date(c.oldValue)}))):o=o.concat(da(e,t,n));break;case"Object":{const c=fd(e,t,n,i,!1,r);c.length&&(n.length?o.push({type:"UPDATE",key:Bt(n),changes:c}):o=o.concat(c));break}case"Array":o=o.concat(Zg(e,t,n,i,r));break;case"Function":break;default:o=o.concat(da(e,t,n))}return o},fd=(e,t,n,i,r=!1,o={})=>{let s,a,l;r==null&&(r=!1);let c=[];const d=Object.keys(e),f=Object.keys(t),g=Hg(d,f);for(s of g){l=n.concat([s]),a=r?i:i.concat([s]);const v=hd(e[s],t[s],l,a,o);v.length&&(c=c.concat(v))}const p=dd(f,d);for(s of p){l=n.concat([s]),a=r?i:i.concat([s]);const v=a.join(".");o.keysToSkip?.some(b=>v===b||v.startsWith(b+"."))||c.push({type:"ADD",key:Bt(l),value:t[s]})}const u=dd(d,f);for(s of u){l=n.concat([s]),a=r?i:i.concat([s]);const v=a.join(".");o.keysToSkip?.some(b=>v===b||v.startsWith(b+"."))||c.push({type:"REMOVE",key:Bt(l),value:e[s]})}return c},Zg=(e,t,n,i,r)=>{if(ua(t)!=="Array")return[{type:"UPDATE",key:Bt(n),value:t,oldValue:e}];const o=Kg(r.embeddedObjKeys,i),s=o??"$index",a=pd(e,s),l=pd(t,s),c=fd(a,l,n,i,!0,r);return c.length?[{type:"UPDATE",key:Bt(n),embeddedKey:typeof s=="function"&&s.length===2?s(t[0],!0):s,changes:c}]:[]},Kg=(e,t)=>{if(e!=null){const n=t.join(".");if(e instanceof Map){for(const[r,o]of e.entries())if(r instanceof RegExp){if(n.match(r))return o}else if(n===r)return o}const i=e[n];if(i!=null)return i}},pd=(e,t)=>{let n={};if(t==="$value")e.forEach(i=>{n[i]=i});else if(t!=="$index")n=jg(e,typeof t=="string"?r=>r[t]:t);else for(let i=0;i<e.length;i++){const r=e[i];n[i]=r}return n},da=(e,t,n)=>{const i=[];return e!==t&&i.push({type:"UPDATE",key:Bt(n),value:t,oldValue:e}),i};const gn=(e,t,n)=>{if(!e.command.executeCommand){console.warn("executeCommand called before setup - falling back to direct execution"),n();return}e.command.executeCommand(t,n)},xo=(e,t,n,i)=>{if(!e.command.pushCommand){console.warn("pushCommandWithStates called before setup - ignoring");return}e.command.pushCommand(t,n,i)};function qg(e,t,n=!1){n||ha(e),e.selection.items.add(t),pa(e),ko(e)}function Yg(e,t,n=!1){e.selection.items.has(t)?e.selection.items.delete(t):(n||ha(e),e.selection.items.add(t)),pa(e),ko(e)}function ha(e){fa(e),e.selection.items.clear(),ko(e)}function Xg(e,t){return e.selection.items.has(t)}function Jg(e){return e.selection.items.size===0}function Qg(e){return e.selection.items.size}function e1(e){return e.selection.items.size===1?[...e.selection.items][0].konvaNode:null}function fa(e){e.selection.originalStyles.forEach(t=>{const n=t.node;n&&(n instanceof X.Path||n instanceof X.Line)&&(n.stroke(t.stroke),n.strokeWidth(t.strokeWidth))}),e.selection.originalStyles.clear(),ga(e)}function pa(e){fa(e);for(const t of e.selection.items){const n=t.konvaNode;(n instanceof X.Path||n instanceof X.Line)&&(e.selection.originalStyles.set(t.id,{node:n,stroke:n.stroke(),strokeWidth:n.strokeWidth()}),n.stroke("#ff6b35"),n.strokeWidth(4))}ga(e)}function ga(e){const t=new Set;for(const n of e.selection.items){let i=n.konvaNode.getParent();for(;i&&!(i instanceof X.Layer);)i=i.getParent();i instanceof X.Layer&&t.add(i)}e.selection.originalStyles.forEach(n=>{let i=n.node.getParent();for(;i&&!(i instanceof X.Layer);)i=i.getParent();i instanceof X.Layer&&t.add(i)}),t.forEach(n=>n.batchDraw())}const Co=(e,t)=>{const n=e.selection.originalStyles.size>0;n&&fa(e);try{return t()}finally{e.selection.items.size>0?pa(e):n&&ga(e)}};function ko(e){e.callbacks.syncAppState?.(e),e.callbacks.refreshAncillaryViz?.()}function t1(e,t,n){gn(e,"Edit Metadata",()=>{t.setMetadata(n),ko(e)})}function Po(e,t,n=!1){qg(e,t,n)}function n1(e,t,n=!1){Yg(e,t,n)}function kt(e){ha(e)}function gd(e,t){return Xg(e,t)}function md(e){return Jg(e)}function To(e){return Qg(e)}const yd=e=>e1(e);function i1(e,t,n){t1(e,t,n)}const mn=(e="id_")=>`${e}${crypto.randomUUID()}`,Ao=e=>{let t=1/0,n=-1/0,i=1/0,r=-1/0;for(let o=0;o<e.length;o+=2)t=Math.min(t,e[o]),n=Math.max(n,e[o]),i=Math.min(i,e[o+1]),r=Math.max(r,e[o+1]);return{minX:t,maxX:n,minY:i,maxY:r}},r1=e=>{for(let t=0;t<e.length;t++)for(let n=t+1;n<e.length;n++)if(e[t].isAncestorOf(e[n])||e[n].isAncestorOf(e[t]))return!0;return!1},Eo=(e,t)=>{if(e.metadataSchemas.length>0&&!t.getAttr("metadata")){const n=Object.fromEntries(e.metadataSchemas.map(i=>[i.name,i.schema.parse({})]));t.setAttr("metadata",n)}},vd=(e,t,n)=>{t.id()||t.id(mn("stroke_")),Eo(e,t);const i={id:t.id(),type:"stroke",konvaNode:t,getBounds(){const r=t.getClientRect();return{minX:r.x,maxX:r.x+r.width,minY:r.y,maxY:r.y+r.height}},getMetadata(){return t.getAttr("metadata")},setMetadata(r){r===void 0||Object.keys(r).length===0?t.setAttr("metadata",void 0):t.setAttr("metadata",r)}};return e.canvasItems.set(i.id,i),i},Ro=(e,t)=>{t.id()||t.id(mn("group_")),Eo(e,t);const n={id:t.id(),type:"strokeGroup",konvaNode:t,getBounds(){const i=t.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return t.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?t.setAttr("metadata",void 0):t.setAttr("metadata",i)}};return e.canvasItems.set(n.id,n),n},ma=(e,t)=>{t.id()||t.id(mn("poly_")),Eo(e,t);const n={id:t.id(),type:"polygon",konvaNode:t,getBounds(){const i=t.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return t.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?t.setAttr("metadata",void 0):t.setAttr("metadata",i)}};return e.canvasItems.set(n.id,n),n},ya=(e,t)=>{t.id()||t.id(mn("circle_")),Eo(e,t);const n={id:t.id(),type:"circle",konvaNode:t,getBounds(){const i=t.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return t.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?t.setAttr("metadata",void 0):t.setAttr("metadata",i)}};return e.canvasItems.set(n.id,n),n},o1=(e,t)=>e.canvasItems.get(t.id()),s1=(e,t)=>{e.canvasItems.delete(t)},xr=(e,t)=>o1(e,t),_d=(e,t)=>{s1(e,t)};function Y(e,t,n){function i(a,l){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:l,constr:s,traits:new Set},enumerable:!1}),a._zod.traits.has(e))return;a._zod.traits.add(e),t(a,l);const c=s.prototype,d=Object.keys(c);for(let f=0;f<d.length;f++){const g=d[f];g in a||(a[g]=c[g].bind(a))}}const r=n?.Parent??Object;class o extends r{}Object.defineProperty(o,"name",{value:e});function s(a){var l;const c=n?.Parent?new o:this;i(c,a),(l=c._zod).deferred??(l.deferred=[]);for(const d of c._zod.deferred)d();return c}return Object.defineProperty(s,"init",{value:i}),Object.defineProperty(s,Symbol.hasInstance,{value:a=>n?.Parent&&a instanceof n.Parent?!0:a?._zod?.traits?.has(e)}),Object.defineProperty(s,"name",{value:e}),s}class ai extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class bd extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const Sd={};function En(e){return Sd}function a1(e){const t=Object.values(e).filter(i=>typeof i=="number");return Object.entries(e).filter(([i,r])=>t.indexOf(+i)===-1).map(([i,r])=>r)}function va(e,t){return typeof t=="bigint"?t.toString():t}function Do(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function _a(e){return e==null}function ba(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function l1(e,t){const n=(e.toString().split(".")[1]||"").length,i=t.toString();let r=(i.split(".")[1]||"").length;if(r===0&&/\d?e-\d?/.test(i)){const l=i.match(/\d?e-(\d?)/);l?.[1]&&(r=Number.parseInt(l[1]))}const o=n>r?n:r,s=Number.parseInt(e.toFixed(o).replace(".","")),a=Number.parseInt(t.toFixed(o).replace(".",""));return s%a/10**o}const wd=Symbol("evaluating");function Ne(e,t,n){let i;Object.defineProperty(e,t,{get(){if(i!==wd)return i===void 0&&(i=wd,i=n()),i},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function jn(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function Wn(...e){const t={};for(const n of e){const i=Object.getOwnPropertyDescriptors(n);Object.assign(t,i)}return Object.defineProperties({},t)}function xd(e){return JSON.stringify(e)}function c1(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const Cd="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function Cr(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const u1=Do(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function li(e){if(Cr(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const n=t.prototype;return!(Cr(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function kd(e){return li(e)?{...e}:Array.isArray(e)?[...e]:e}const d1=new Set(["string","number","symbol"]);function ci(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Rn(e,t,n){const i=new e._zod.constr(t??e._zod.def);return(!t||n?.parent)&&(i._zod.parent=e),i}function me(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function h1(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const f1={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function p1(e,t){const n=e._zod.def,i=Wn(e._zod.def,{get shape(){const r={};for(const o in t){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&(r[o]=n.shape[o])}return jn(this,"shape",r),r},checks:[]});return Rn(e,i)}function g1(e,t){const n=e._zod.def,i=Wn(e._zod.def,{get shape(){const r={...e._zod.def.shape};for(const o in t){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&delete r[o]}return jn(this,"shape",r),r},checks:[]});return Rn(e,i)}function m1(e,t){if(!li(t))throw new Error("Invalid input to extend: expected a plain object");const n=e._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const r=Wn(e._zod.def,{get shape(){const o={...e._zod.def.shape,...t};return jn(this,"shape",o),o},checks:[]});return Rn(e,r)}function y1(e,t){if(!li(t))throw new Error("Invalid input to safeExtend: expected a plain object");const n={...e._zod.def,get shape(){const i={...e._zod.def.shape,...t};return jn(this,"shape",i),i},checks:e._zod.def.checks};return Rn(e,n)}function v1(e,t){const n=Wn(e._zod.def,{get shape(){const i={...e._zod.def.shape,...t._zod.def.shape};return jn(this,"shape",i),i},get catchall(){return t._zod.def.catchall},checks:[]});return Rn(e,n)}function _1(e,t,n){const i=Wn(t._zod.def,{get shape(){const r=t._zod.def.shape,o={...r};if(n)for(const s in n){if(!(s in r))throw new Error(`Unrecognized key: "${s}"`);n[s]&&(o[s]=e?new e({type:"optional",innerType:r[s]}):r[s])}else for(const s in r)o[s]=e?new e({type:"optional",innerType:r[s]}):r[s];return jn(this,"shape",o),o},checks:[]});return Rn(t,i)}function b1(e,t,n){const i=Wn(t._zod.def,{get shape(){const r=t._zod.def.shape,o={...r};if(n)for(const s in n){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);n[s]&&(o[s]=new e({type:"nonoptional",innerType:r[s]}))}else for(const s in r)o[s]=new e({type:"nonoptional",innerType:r[s]});return jn(this,"shape",o),o},checks:[]});return Rn(t,i)}function ui(e,t=0){if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(e.issues[n]?.continue!==!0)return!0;return!1}function di(e,t){return t.map(n=>{var i;return(i=n).path??(i.path=[]),n.path.unshift(e),n})}function Mo(e){return typeof e=="string"?e:e?.message}function Dn(e,t,n){const i={...e,path:e.path??[]};if(!e.message){const r=Mo(e.inst?._zod.def?.error?.(e))??Mo(t?.error?.(e))??Mo(n.customError?.(e))??Mo(n.localeError?.(e))??"Invalid input";i.message=r}return delete i.inst,delete i.continue,t?.reportInput||delete i.input,i}function Sa(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function kr(...e){const[t,n,i]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:i}:{...t}}const Pd=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,va,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Td=Y("$ZodError",Pd),Ad=Y("$ZodError",Pd,{Parent:Error});function S1(e,t=n=>n.message){const n={},i=[];for(const r of e.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(t(r))):i.push(t(r));return{formErrors:i,fieldErrors:n}}function w1(e,t=n=>n.message){const n={_errors:[]},i=r=>{for(const o of r.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(s=>i({issues:s}));else if(o.code==="invalid_key")i({issues:o.issues});else if(o.code==="invalid_element")i({issues:o.issues});else if(o.path.length===0)n._errors.push(t(o));else{let s=n,a=0;for(;a<o.path.length;){const l=o.path[a];a===o.path.length-1?(s[l]=s[l]||{_errors:[]},s[l]._errors.push(t(o))):s[l]=s[l]||{_errors:[]},s=s[l],a++}}};return i(e),n}const wa=e=>(t,n,i,r)=>{const o=i?Object.assign(i,{async:!1}):{async:!1},s=t._zod.run({value:n,issues:[]},o);if(s instanceof Promise)throw new ai;if(s.issues.length){const a=new(r?.Err??e)(s.issues.map(l=>Dn(l,o,En())));throw Cd(a,r?.callee),a}return s.value},xa=e=>async(t,n,i,r)=>{const o=i?Object.assign(i,{async:!0}):{async:!0};let s=t._zod.run({value:n,issues:[]},o);if(s instanceof Promise&&(s=await s),s.issues.length){const a=new(r?.Err??e)(s.issues.map(l=>Dn(l,o,En())));throw Cd(a,r?.callee),a}return s.value},Oo=e=>(t,n,i)=>{const r=i?{...i,async:!1}:{async:!1},o=t._zod.run({value:n,issues:[]},r);if(o instanceof Promise)throw new ai;return o.issues.length?{success:!1,error:new(e??Td)(o.issues.map(s=>Dn(s,r,En())))}:{success:!0,data:o.value}},x1=Oo(Ad),No=e=>async(t,n,i)=>{const r=i?Object.assign(i,{async:!0}):{async:!0};let o=t._zod.run({value:n,issues:[]},r);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(s=>Dn(s,r,En())))}:{success:!0,data:o.value}},C1=No(Ad),k1=e=>(t,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return wa(e)(t,n,r)},P1=e=>(t,n,i)=>wa(e)(t,n,i),T1=e=>async(t,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return xa(e)(t,n,r)},A1=e=>async(t,n,i)=>xa(e)(t,n,i),E1=e=>(t,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Oo(e)(t,n,r)},R1=e=>(t,n,i)=>Oo(e)(t,n,i),D1=e=>async(t,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return No(e)(t,n,r)},M1=e=>async(t,n,i)=>No(e)(t,n,i),O1=/^[cC][^\s-]{8,}$/,N1=/^[0-9a-z]+$/,F1=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,I1=/^[0-9a-vA-V]{20}$/,L1=/^[A-Za-z0-9]{27}$/,G1=/^[a-zA-Z0-9_-]{21}$/,z1=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,$1=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Ed=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,U1=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,V1="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function B1(){return new RegExp(V1,"u")}const H1=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,j1=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,W1=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Z1=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,K1=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Rd=/^[A-Za-z0-9_-]*$/,q1=/^\+(?:[0-9]){6,14}[0-9]$/,Dd="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Y1=new RegExp(`^${Dd}$`);function Md(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function X1(e){return new RegExp(`^${Md(e)}$`)}function J1(e){const t=Md({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const i=`${t}(?:${n.join("|")})`;return new RegExp(`^${Dd}T(?:${i})$`)}const Q1=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},em=/^-?\d+$/,tm=/^-?\d+(?:\.\d+)?/,nm=/^(?:true|false)$/i,im=/^[^A-Z]*$/,rm=/^[^a-z]*$/,Pt=Y("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),Od={number:"number",bigint:"bigint",object:"date"},Nd=Y("$ZodCheckLessThan",(e,t)=>{Pt.init(e,t);const n=Od[typeof t.value];e._zod.onattach.push(i=>{const r=i._zod.bag,o=(t.inclusive?r.maximum:r.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<o&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=i=>{(t.inclusive?i.value<=t.value:i.value<t.value)||i.issues.push({origin:n,code:"too_big",maximum:t.value,input:i.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Fd=Y("$ZodCheckGreaterThan",(e,t)=>{Pt.init(e,t);const n=Od[typeof t.value];e._zod.onattach.push(i=>{const r=i._zod.bag,o=(t.inclusive?r.minimum:r.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>o&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=i=>{(t.inclusive?i.value>=t.value:i.value>t.value)||i.issues.push({origin:n,code:"too_small",minimum:t.value,input:i.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),om=Y("$ZodCheckMultipleOf",(e,t)=>{Pt.init(e,t),e._zod.onattach.push(n=>{var i;(i=n._zod.bag).multipleOf??(i.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%t.value===BigInt(0):l1(n.value,t.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),sm=Y("$ZodCheckNumberFormat",(e,t)=>{Pt.init(e,t),t.format=t.format||"float64";const n=t.format?.includes("int"),i=n?"int":"number",[r,o]=f1[t.format];e._zod.onattach.push(s=>{const a=s._zod.bag;a.format=t.format,a.minimum=r,a.maximum=o,n&&(a.pattern=em)}),e._zod.check=s=>{const a=s.value;if(n){if(!Number.isInteger(a)){s.issues.push({expected:i,format:t.format,code:"invalid_type",continue:!1,input:a,inst:e});return}if(!Number.isSafeInteger(a)){a>0?s.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,continue:!t.abort}):s.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,continue:!t.abort});return}}a<r&&s.issues.push({origin:"number",input:a,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),a>o&&s.issues.push({origin:"number",input:a,code:"too_big",maximum:o,inst:e})}}),am=Y("$ZodCheckMaxLength",(e,t)=>{var n;Pt.init(e,t),(n=e._zod.def).when??(n.when=i=>{const r=i.value;return!_a(r)&&r.length!==void 0}),e._zod.onattach.push(i=>{const r=i._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<r&&(i._zod.bag.maximum=t.maximum)}),e._zod.check=i=>{const r=i.value;if(r.length<=t.maximum)return;const s=Sa(r);i.issues.push({origin:s,code:"too_big",maximum:t.maximum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),lm=Y("$ZodCheckMinLength",(e,t)=>{var n;Pt.init(e,t),(n=e._zod.def).when??(n.when=i=>{const r=i.value;return!_a(r)&&r.length!==void 0}),e._zod.onattach.push(i=>{const r=i._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>r&&(i._zod.bag.minimum=t.minimum)}),e._zod.check=i=>{const r=i.value;if(r.length>=t.minimum)return;const s=Sa(r);i.issues.push({origin:s,code:"too_small",minimum:t.minimum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),cm=Y("$ZodCheckLengthEquals",(e,t)=>{var n;Pt.init(e,t),(n=e._zod.def).when??(n.when=i=>{const r=i.value;return!_a(r)&&r.length!==void 0}),e._zod.onattach.push(i=>{const r=i._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=i=>{const r=i.value,o=r.length;if(o===t.length)return;const s=Sa(r),a=o>t.length;i.issues.push({origin:s,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:i.value,inst:e,continue:!t.abort})}}),Fo=Y("$ZodCheckStringFormat",(e,t)=>{var n,i;Pt.init(e,t),e._zod.onattach.push(r=>{const o=r._zod.bag;o.format=t.format,t.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(i=e._zod).check??(i.check=()=>{})}),um=Y("$ZodCheckRegex",(e,t)=>{Fo.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),dm=Y("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=im),Fo.init(e,t)}),hm=Y("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=rm),Fo.init(e,t)}),fm=Y("$ZodCheckIncludes",(e,t)=>{Pt.init(e,t);const n=ci(t.includes),i=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=i,e._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(i)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),pm=Y("$ZodCheckStartsWith",(e,t)=>{Pt.init(e,t);const n=new RegExp(`^${ci(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(i=>{const r=i._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),e._zod.check=i=>{i.value.startsWith(t.prefix)||i.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:i.value,inst:e,continue:!t.abort})}}),gm=Y("$ZodCheckEndsWith",(e,t)=>{Pt.init(e,t);const n=new RegExp(`.*${ci(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(i=>{const r=i._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),e._zod.check=i=>{i.value.endsWith(t.suffix)||i.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:i.value,inst:e,continue:!t.abort})}}),mm=Y("$ZodCheckOverwrite",(e,t)=>{Pt.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class ym{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const i=t.split(`
`).filter(s=>s),r=Math.min(...i.map(s=>s.length-s.trimStart().length)),o=i.map(s=>s.slice(r)).map(s=>" ".repeat(this.indent*2)+s);for(const s of o)this.content.push(s)}compile(){const t=Function,n=this?.args,r=[...(this?.content??[""]).map(o=>`  ${o}`)];return new t(...n,r.join(`
`))}}const vm={major:4,minor:1,patch:13},We=Y("$ZodType",(e,t)=>{var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=vm;const i=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&i.unshift(e);for(const r of i)for(const o of r._zod.onattach)o(e);if(i.length===0)(n=e._zod).deferred??(n.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const r=(s,a,l)=>{let c=ui(s),d;for(const f of a){if(f._zod.def.when){if(!f._zod.def.when(s))continue}else if(c)continue;const g=s.issues.length,p=f._zod.check(s);if(p instanceof Promise&&l?.async===!1)throw new ai;if(d||p instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await p,s.issues.length!==g&&(c||(c=ui(s,g)))});else{if(s.issues.length===g)continue;c||(c=ui(s,g))}}return d?d.then(()=>s):s},o=(s,a,l)=>{if(ui(s))return s.aborted=!0,s;const c=r(a,i,l);if(c instanceof Promise){if(l.async===!1)throw new ai;return c.then(d=>e._zod.parse(d,l))}return e._zod.parse(c,l)};e._zod.run=(s,a)=>{if(a.skipChecks)return e._zod.parse(s,a);if(a.direction==="backward"){const c=e._zod.parse({value:s.value,issues:[]},{...a,skipChecks:!0});return c instanceof Promise?c.then(d=>o(d,s,a)):o(c,s,a)}const l=e._zod.parse(s,a);if(l instanceof Promise){if(a.async===!1)throw new ai;return l.then(c=>r(c,i,a))}return r(l,i,a)}}e["~standard"]={validate:r=>{try{const o=x1(e,r);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return C1(e,r).then(s=>s.success?{value:s.data}:{issues:s.error?.issues})}},vendor:"zod",version:1}}),Ca=Y("$ZodString",(e,t)=>{We.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??Q1(e._zod.bag),e._zod.parse=(n,i)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),Ze=Y("$ZodStringFormat",(e,t)=>{Fo.init(e,t),Ca.init(e,t)}),_m=Y("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=$1),Ze.init(e,t)}),bm=Y("$ZodUUID",(e,t)=>{if(t.version){const i={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(i===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Ed(i))}else t.pattern??(t.pattern=Ed());Ze.init(e,t)}),Sm=Y("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=U1),Ze.init(e,t)}),wm=Y("$ZodURL",(e,t)=>{Ze.init(e,t),e._zod.check=n=>{try{const i=n.value.trim(),r=new URL(i);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(r.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(r.protocol.endsWith(":")?r.protocol.slice(0,-1):r.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),t.normalize?n.value=r.href:n.value=i;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),xm=Y("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=B1()),Ze.init(e,t)}),Cm=Y("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=G1),Ze.init(e,t)}),km=Y("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=O1),Ze.init(e,t)}),Pm=Y("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=N1),Ze.init(e,t)}),Tm=Y("$ZodULID",(e,t)=>{t.pattern??(t.pattern=F1),Ze.init(e,t)}),Am=Y("$ZodXID",(e,t)=>{t.pattern??(t.pattern=I1),Ze.init(e,t)}),Em=Y("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=L1),Ze.init(e,t)}),Rm=Y("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=J1(t)),Ze.init(e,t)}),Dm=Y("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Y1),Ze.init(e,t)}),Mm=Y("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=X1(t)),Ze.init(e,t)}),Om=Y("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=z1),Ze.init(e,t)}),Nm=Y("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=H1),Ze.init(e,t),e._zod.bag.format="ipv4"}),Fm=Y("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=j1),Ze.init(e,t),e._zod.bag.format="ipv6",e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),Im=Y("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=W1),Ze.init(e,t)}),Lm=Y("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Z1),Ze.init(e,t),e._zod.check=n=>{const i=n.value.split("/");try{if(i.length!==2)throw new Error;const[r,o]=i;if(!o)throw new Error;const s=Number(o);if(`${s}`!==o)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function Id(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Gm=Y("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=K1),Ze.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=n=>{Id(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function zm(e){if(!Rd.test(e))return!1;const t=e.replace(/[-_]/g,i=>i==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return Id(n)}const $m=Y("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Rd),Ze.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=n=>{zm(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),Um=Y("$ZodE164",(e,t)=>{t.pattern??(t.pattern=q1),Ze.init(e,t)});function Vm(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[i]=n;if(!i)return!1;const r=JSON.parse(atob(i));return!("typ"in r&&r?.typ!=="JWT"||!r.alg||t&&(!("alg"in r)||r.alg!==t))}catch{return!1}}const Bm=Y("$ZodJWT",(e,t)=>{Ze.init(e,t),e._zod.check=n=>{Vm(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),Ld=Y("$ZodNumber",(e,t)=>{We.init(e,t),e._zod.pattern=e._zod.bag.pattern??tm,e._zod.parse=(n,i)=>{if(t.coerce)try{n.value=Number(n.value)}catch{}const r=n.value;if(typeof r=="number"&&!Number.isNaN(r)&&Number.isFinite(r))return n;const o=typeof r=="number"?Number.isNaN(r)?"NaN":Number.isFinite(r)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:r,inst:e,...o?{received:o}:{}}),n}}),Hm=Y("$ZodNumberFormat",(e,t)=>{sm.init(e,t),Ld.init(e,t)}),jm=Y("$ZodBoolean",(e,t)=>{We.init(e,t),e._zod.pattern=nm,e._zod.parse=(n,i)=>{if(t.coerce)try{n.value=!!n.value}catch{}const r=n.value;return typeof r=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:r,inst:e}),n}}),Wm=Y("$ZodUnknown",(e,t)=>{We.init(e,t),e._zod.parse=n=>n}),Zm=Y("$ZodNever",(e,t)=>{We.init(e,t),e._zod.parse=(n,i)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)});function Gd(e,t,n){e.issues.length&&t.issues.push(...di(n,e.issues)),t.value[n]=e.value}const Km=Y("$ZodArray",(e,t)=>{We.init(e,t),e._zod.parse=(n,i)=>{const r=n.value;if(!Array.isArray(r))return n.issues.push({expected:"array",code:"invalid_type",input:r,inst:e}),n;n.value=Array(r.length);const o=[];for(let s=0;s<r.length;s++){const a=r[s],l=t.element._zod.run({value:a,issues:[]},i);l instanceof Promise?o.push(l.then(c=>Gd(c,n,s))):Gd(l,n,s)}return o.length?Promise.all(o).then(()=>n):n}});function Io(e,t,n,i){e.issues.length&&t.issues.push(...di(n,e.issues)),e.value===void 0?n in i&&(t.value[n]=void 0):t.value[n]=e.value}function zd(e){const t=Object.keys(e.shape);for(const i of t)if(!e.shape?.[i]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${i}": expected a Zod schema`);const n=h1(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(n)}}function $d(e,t,n,i,r,o){const s=[],a=r.keySet,l=r.catchall._zod,c=l.def.type;for(const d in t){if(a.has(d))continue;if(c==="never"){s.push(d);continue}const f=l.run({value:t[d],issues:[]},i);f instanceof Promise?e.push(f.then(g=>Io(g,n,d,t))):Io(f,n,d,t)}return s.length&&n.issues.push({code:"unrecognized_keys",keys:s,input:t,inst:o}),e.length?Promise.all(e).then(()=>n):n}const qm=Y("$ZodObject",(e,t)=>{if(We.init(e,t),!Object.getOwnPropertyDescriptor(t,"shape")?.get){const a=t.shape;Object.defineProperty(t,"shape",{get:()=>{const l={...a};return Object.defineProperty(t,"shape",{value:l}),l}})}const i=Do(()=>zd(t));Ne(e._zod,"propValues",()=>{const a=t.shape,l={};for(const c in a){const d=a[c]._zod;if(d.values){l[c]??(l[c]=new Set);for(const f of d.values)l[c].add(f)}}return l});const r=Cr,o=t.catchall;let s;e._zod.parse=(a,l)=>{s??(s=i.value);const c=a.value;if(!r(c))return a.issues.push({expected:"object",code:"invalid_type",input:c,inst:e}),a;a.value={};const d=[],f=s.shape;for(const g of s.keys){const u=f[g]._zod.run({value:c[g],issues:[]},l);u instanceof Promise?d.push(u.then(v=>Io(v,a,g,c))):Io(u,a,g,c)}return o?$d(d,c,a,l,i.value,e):d.length?Promise.all(d).then(()=>a):a}}),Ym=Y("$ZodObjectJIT",(e,t)=>{qm.init(e,t);const n=e._zod.parse,i=Do(()=>zd(t)),r=g=>{const p=new ym(["shape","payload","ctx"]),u=i.value,v=h=>{const y=xd(h);return`shape[${y}]._zod.run({ value: input[${y}], issues: [] }, ctx)`};p.write("const input = payload.value;");const b=Object.create(null);let x=0;for(const h of u.keys)b[h]=`key_${x++}`;p.write("const newResult = {};");for(const h of u.keys){const y=b[h],S=xd(h);p.write(`const ${y} = ${v(h)};`),p.write(`
        if (${y}.issues.length) {
          payload.issues = payload.issues.concat(${y}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${S}, ...iss.path] : [${S}]
          })));
        }
        
        
        if (${y}.value === undefined) {
          if (${S} in input) {
            newResult[${S}] = undefined;
          }
        } else {
          newResult[${S}] = ${y}.value;
        }
        
      `)}p.write("payload.value = newResult;"),p.write("return payload;");const m=p.compile();return(h,y)=>m(g,h,y)};let o;const s=Cr,a=!Sd.jitless,c=a&&u1.value,d=t.catchall;let f;e._zod.parse=(g,p)=>{f??(f=i.value);const u=g.value;return s(u)?a&&c&&p?.async===!1&&p.jitless!==!0?(o||(o=r(t.shape)),g=o(g,p),d?$d([],u,g,p,f,e):g):n(g,p):(g.issues.push({expected:"object",code:"invalid_type",input:u,inst:e}),g)}});function Ud(e,t,n,i){for(const o of e)if(o.issues.length===0)return t.value=o.value,t;const r=e.filter(o=>!ui(o));return r.length===1?(t.value=r[0].value,r[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(o=>o.issues.map(s=>Dn(s,i,En())))}),t)}const Vd=Y("$ZodUnion",(e,t)=>{We.init(e,t),Ne(e._zod,"optin",()=>t.options.some(r=>r._zod.optin==="optional")?"optional":void 0),Ne(e._zod,"optout",()=>t.options.some(r=>r._zod.optout==="optional")?"optional":void 0),Ne(e._zod,"values",()=>{if(t.options.every(r=>r._zod.values))return new Set(t.options.flatMap(r=>Array.from(r._zod.values)))}),Ne(e._zod,"pattern",()=>{if(t.options.every(r=>r._zod.pattern)){const r=t.options.map(o=>o._zod.pattern);return new RegExp(`^(${r.map(o=>ba(o.source)).join("|")})$`)}});const n=t.options.length===1,i=t.options[0]._zod.run;e._zod.parse=(r,o)=>{if(n)return i(r,o);let s=!1;const a=[];for(const l of t.options){const c=l._zod.run({value:r.value,issues:[]},o);if(c instanceof Promise)a.push(c),s=!0;else{if(c.issues.length===0)return c;a.push(c)}}return s?Promise.all(a).then(l=>Ud(l,r,e,o)):Ud(a,r,e,o)}}),Xm=Y("$ZodDiscriminatedUnion",(e,t)=>{Vd.init(e,t);const n=e._zod.parse;Ne(e._zod,"propValues",()=>{const r={};for(const o of t.options){const s=o._zod.propValues;if(!s||Object.keys(s).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(o)}"`);for(const[a,l]of Object.entries(s)){r[a]||(r[a]=new Set);for(const c of l)r[a].add(c)}}return r});const i=Do(()=>{const r=t.options,o=new Map;for(const s of r){const a=s._zod.propValues?.[t.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(s)}"`);for(const l of a){if(o.has(l))throw new Error(`Duplicate discriminator value "${String(l)}"`);o.set(l,s)}}return o});e._zod.parse=(r,o)=>{const s=r.value;if(!Cr(s))return r.issues.push({code:"invalid_type",expected:"object",input:s,inst:e}),r;const a=i.value.get(s?.[t.discriminator]);return a?a._zod.run(r,o):t.unionFallback?n(r,o):(r.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:s,path:[t.discriminator],inst:e}),r)}}),Jm=Y("$ZodIntersection",(e,t)=>{We.init(e,t),e._zod.parse=(n,i)=>{const r=n.value,o=t.left._zod.run({value:r,issues:[]},i),s=t.right._zod.run({value:r,issues:[]},i);return o instanceof Promise||s instanceof Promise?Promise.all([o,s]).then(([l,c])=>Bd(n,l,c)):Bd(n,o,s)}});function ka(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(li(e)&&li(t)){const n=Object.keys(t),i=Object.keys(e).filter(o=>n.indexOf(o)!==-1),r={...e,...t};for(const o of i){const s=ka(e[o],t[o]);if(!s.valid)return{valid:!1,mergeErrorPath:[o,...s.mergeErrorPath]};r[o]=s.data}return{valid:!0,data:r}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let i=0;i<e.length;i++){const r=e[i],o=t[i],s=ka(r,o);if(!s.valid)return{valid:!1,mergeErrorPath:[i,...s.mergeErrorPath]};n.push(s.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function Bd(e,t,n){if(t.issues.length&&e.issues.push(...t.issues),n.issues.length&&e.issues.push(...n.issues),ui(e))return e;const i=ka(t.value,n.value);if(!i.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(i.mergeErrorPath)}`);return e.value=i.data,e}const Qm=Y("$ZodRecord",(e,t)=>{We.init(e,t),e._zod.parse=(n,i)=>{const r=n.value;if(!li(r))return n.issues.push({expected:"record",code:"invalid_type",input:r,inst:e}),n;const o=[],s=t.keyType._zod.values;if(s){n.value={};const a=new Set;for(const c of s)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){a.add(typeof c=="number"?c.toString():c);const d=t.valueType._zod.run({value:r[c],issues:[]},i);d instanceof Promise?o.push(d.then(f=>{f.issues.length&&n.issues.push(...di(c,f.issues)),n.value[c]=f.value})):(d.issues.length&&n.issues.push(...di(c,d.issues)),n.value[c]=d.value)}let l;for(const c in r)a.has(c)||(l=l??[],l.push(c));l&&l.length>0&&n.issues.push({code:"unrecognized_keys",input:r,inst:e,keys:l})}else{n.value={};for(const a of Reflect.ownKeys(r)){if(a==="__proto__")continue;const l=t.keyType._zod.run({value:a,issues:[]},i);if(l instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(l.issues.length){n.issues.push({code:"invalid_key",origin:"record",issues:l.issues.map(d=>Dn(d,i,En())),input:a,path:[a],inst:e}),n.value[l.value]=l.value;continue}const c=t.valueType._zod.run({value:r[a],issues:[]},i);c instanceof Promise?o.push(c.then(d=>{d.issues.length&&n.issues.push(...di(a,d.issues)),n.value[l.value]=d.value})):(c.issues.length&&n.issues.push(...di(a,c.issues)),n.value[l.value]=c.value)}}return o.length?Promise.all(o).then(()=>n):n}}),e2=Y("$ZodEnum",(e,t)=>{We.init(e,t);const n=a1(t.entries),i=new Set(n);e._zod.values=i,e._zod.pattern=new RegExp(`^(${n.filter(r=>d1.has(typeof r)).map(r=>typeof r=="string"?ci(r):r.toString()).join("|")})$`),e._zod.parse=(r,o)=>{const s=r.value;return i.has(s)||r.issues.push({code:"invalid_value",values:n,input:s,inst:e}),r}}),t2=Y("$ZodLiteral",(e,t)=>{if(We.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");const n=new Set(t.values);e._zod.values=n,e._zod.pattern=new RegExp(`^(${t.values.map(i=>typeof i=="string"?ci(i):i?ci(i.toString()):String(i)).join("|")})$`),e._zod.parse=(i,r)=>{const o=i.value;return n.has(o)||i.issues.push({code:"invalid_value",values:t.values,input:o,inst:e}),i}}),n2=Y("$ZodTransform",(e,t)=>{We.init(e,t),e._zod.parse=(n,i)=>{if(i.direction==="backward")throw new bd(e.constructor.name);const r=t.transform(n.value,n);if(i.async)return(r instanceof Promise?r:Promise.resolve(r)).then(s=>(n.value=s,n));if(r instanceof Promise)throw new ai;return n.value=r,n}});function Hd(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const i2=Y("$ZodOptional",(e,t)=>{We.init(e,t),e._zod.optin="optional",e._zod.optout="optional",Ne(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),Ne(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${ba(n.source)})?$`):void 0}),e._zod.parse=(n,i)=>{if(t.innerType._zod.optin==="optional"){const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(o=>Hd(o,n.value)):Hd(r,n.value)}return n.value===void 0?n:t.innerType._zod.run(n,i)}}),r2=Y("$ZodNullable",(e,t)=>{We.init(e,t),Ne(e._zod,"optin",()=>t.innerType._zod.optin),Ne(e._zod,"optout",()=>t.innerType._zod.optout),Ne(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${ba(n.source)}|null)$`):void 0}),Ne(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,i)=>n.value===null?n:t.innerType._zod.run(n,i)}),o2=Y("$ZodDefault",(e,t)=>{We.init(e,t),e._zod.optin="optional",Ne(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,i)=>{if(i.direction==="backward")return t.innerType._zod.run(n,i);if(n.value===void 0)return n.value=t.defaultValue,n;const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(o=>jd(o,t)):jd(r,t)}});function jd(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const s2=Y("$ZodPrefault",(e,t)=>{We.init(e,t),e._zod.optin="optional",Ne(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,i)=>(i.direction==="backward"||n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,i))}),a2=Y("$ZodNonOptional",(e,t)=>{We.init(e,t),Ne(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(i=>i!==void 0)):void 0}),e._zod.parse=(n,i)=>{const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(o=>Wd(o,e)):Wd(r,e)}});function Wd(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const l2=Y("$ZodCatch",(e,t)=>{We.init(e,t),Ne(e._zod,"optin",()=>t.innerType._zod.optin),Ne(e._zod,"optout",()=>t.innerType._zod.optout),Ne(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,i)=>{if(i.direction==="backward")return t.innerType._zod.run(n,i);const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(o=>(n.value=o.value,o.issues.length&&(n.value=t.catchValue({...n,error:{issues:o.issues.map(s=>Dn(s,i,En()))},input:n.value}),n.issues=[]),n)):(n.value=r.value,r.issues.length&&(n.value=t.catchValue({...n,error:{issues:r.issues.map(o=>Dn(o,i,En()))},input:n.value}),n.issues=[]),n)}}),c2=Y("$ZodPipe",(e,t)=>{We.init(e,t),Ne(e._zod,"values",()=>t.in._zod.values),Ne(e._zod,"optin",()=>t.in._zod.optin),Ne(e._zod,"optout",()=>t.out._zod.optout),Ne(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,i)=>{if(i.direction==="backward"){const o=t.out._zod.run(n,i);return o instanceof Promise?o.then(s=>Lo(s,t.in,i)):Lo(o,t.in,i)}const r=t.in._zod.run(n,i);return r instanceof Promise?r.then(o=>Lo(o,t.out,i)):Lo(r,t.out,i)}});function Lo(e,t,n){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},n)}const u2=Y("$ZodReadonly",(e,t)=>{We.init(e,t),Ne(e._zod,"propValues",()=>t.innerType._zod.propValues),Ne(e._zod,"values",()=>t.innerType._zod.values),Ne(e._zod,"optin",()=>t.innerType?._zod?.optin),Ne(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(n,i)=>{if(i.direction==="backward")return t.innerType._zod.run(n,i);const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(Zd):Zd(r)}});function Zd(e){return e.value=Object.freeze(e.value),e}const d2=Y("$ZodLazy",(e,t)=>{We.init(e,t),Ne(e._zod,"innerType",()=>t.getter()),Ne(e._zod,"pattern",()=>e._zod.innerType?._zod?.pattern),Ne(e._zod,"propValues",()=>e._zod.innerType?._zod?.propValues),Ne(e._zod,"optin",()=>e._zod.innerType?._zod?.optin??void 0),Ne(e._zod,"optout",()=>e._zod.innerType?._zod?.optout??void 0),e._zod.parse=(n,i)=>e._zod.innerType._zod.run(n,i)}),h2=Y("$ZodCustom",(e,t)=>{Pt.init(e,t),We.init(e,t),e._zod.parse=(n,i)=>n,e._zod.check=n=>{const i=n.value,r=t.fn(i);if(r instanceof Promise)return r.then(o=>Kd(o,n,i,e));Kd(r,n,i,e)}});function Kd(e,t,n,i){if(!e){const r={code:"custom",input:n,inst:i,path:[...i._zod.def.path??[]],continue:!i._zod.def.abort};i._zod.def.params&&(r.params=i._zod.def.params),t.issues.push(kr(r))}}var qd;class f2{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...n){const i=n[0];if(this._map.set(t,i),i&&typeof i=="object"&&"id"in i){if(this._idmap.has(i.id))throw new Error(`ID ${i.id} already exists in the registry`);this._idmap.set(i.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const i={...this.get(n)??{}};delete i.id;const r={...i,...this._map.get(t)};return Object.keys(r).length?r:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function p2(){return new f2}(qd=globalThis).__zod_globalRegistry??(qd.__zod_globalRegistry=p2());const Go=globalThis.__zod_globalRegistry;function g2(e,t){return new e({type:"string",...me(t)})}function m2(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...me(t)})}function Yd(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...me(t)})}function y2(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...me(t)})}function v2(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...me(t)})}function _2(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...me(t)})}function b2(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...me(t)})}function S2(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...me(t)})}function w2(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...me(t)})}function x2(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...me(t)})}function C2(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...me(t)})}function k2(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...me(t)})}function P2(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...me(t)})}function T2(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...me(t)})}function A2(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...me(t)})}function E2(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...me(t)})}function R2(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...me(t)})}function D2(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...me(t)})}function M2(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...me(t)})}function O2(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...me(t)})}function N2(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...me(t)})}function F2(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...me(t)})}function I2(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...me(t)})}function L2(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...me(t)})}function G2(e,t){return new e({type:"string",format:"date",check:"string_format",...me(t)})}function z2(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...me(t)})}function $2(e,t){return new e({type:"string",format:"duration",check:"string_format",...me(t)})}function U2(e,t){return new e({type:"number",checks:[],...me(t)})}function V2(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...me(t)})}function B2(e,t){return new e({type:"boolean",...me(t)})}function H2(e){return new e({type:"unknown"})}function j2(e,t){return new e({type:"never",...me(t)})}function Xd(e,t){return new Nd({check:"less_than",...me(t),value:e,inclusive:!1})}function Pa(e,t){return new Nd({check:"less_than",...me(t),value:e,inclusive:!0})}function Jd(e,t){return new Fd({check:"greater_than",...me(t),value:e,inclusive:!1})}function Ta(e,t){return new Fd({check:"greater_than",...me(t),value:e,inclusive:!0})}function Qd(e,t){return new om({check:"multiple_of",...me(t),value:e})}function eh(e,t){return new am({check:"max_length",...me(t),maximum:e})}function zo(e,t){return new lm({check:"min_length",...me(t),minimum:e})}function th(e,t){return new cm({check:"length_equals",...me(t),length:e})}function W2(e,t){return new um({check:"string_format",format:"regex",...me(t),pattern:e})}function Z2(e){return new dm({check:"string_format",format:"lowercase",...me(e)})}function K2(e){return new hm({check:"string_format",format:"uppercase",...me(e)})}function q2(e,t){return new fm({check:"string_format",format:"includes",...me(t),includes:e})}function Y2(e,t){return new pm({check:"string_format",format:"starts_with",...me(t),prefix:e})}function X2(e,t){return new gm({check:"string_format",format:"ends_with",...me(t),suffix:e})}function hi(e){return new mm({check:"overwrite",tx:e})}function J2(e){return hi(t=>t.normalize(e))}function Q2(){return hi(e=>e.trim())}function ey(){return hi(e=>e.toLowerCase())}function ty(){return hi(e=>e.toUpperCase())}function ny(){return hi(e=>c1(e))}function iy(e,t,n){return new e({type:"array",element:t,...me(n)})}function ry(e,t,n){return new e({type:"custom",check:"custom",fn:t,...me(n)})}function oy(e){const t=sy(n=>(n.addIssue=i=>{if(typeof i=="string")n.issues.push(kr(i,n.value,t._zod.def));else{const r=i;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=t),r.continue??(r.continue=!t._zod.def.abort),n.issues.push(kr(r))}},e(n.value,n)));return t}function sy(e,t){const n=new Pt({check:"custom",...me(t)});return n._zod.check=e,n}const ay=Y("ZodISODateTime",(e,t)=>{Rm.init(e,t),Ye.init(e,t)});function ly(e){return L2(ay,e)}const cy=Y("ZodISODate",(e,t)=>{Dm.init(e,t),Ye.init(e,t)});function uy(e){return G2(cy,e)}const dy=Y("ZodISOTime",(e,t)=>{Mm.init(e,t),Ye.init(e,t)});function hy(e){return z2(dy,e)}const fy=Y("ZodISODuration",(e,t)=>{Om.init(e,t),Ye.init(e,t)});function py(e){return $2(fy,e)}const Gt=Y("ZodError",(e,t)=>{Td.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>w1(e,n)},flatten:{value:n=>S1(e,n)},addIssue:{value:n=>{e.issues.push(n),e.message=JSON.stringify(e.issues,va,2)}},addIssues:{value:n=>{e.issues.push(...n),e.message=JSON.stringify(e.issues,va,2)}},isEmpty:{get(){return e.issues.length===0}}})},{Parent:Error}),gy=wa(Gt),my=xa(Gt),yy=Oo(Gt),vy=No(Gt),_y=k1(Gt),by=P1(Gt),Sy=T1(Gt),wy=A1(Gt),xy=E1(Gt),Cy=R1(Gt),ky=D1(Gt),Py=M1(Gt),qe=Y("ZodType",(e,t)=>(We.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone(Wn(t,{checks:[...t.checks??[],...n.map(i=>typeof i=="function"?{_zod:{check:i,def:{check:"custom"},onattach:[]}}:i)]})),e.clone=(n,i)=>Rn(e,n,i),e.brand=()=>e,e.register=(n,i)=>(n.add(e,i),e),e.parse=(n,i)=>gy(e,n,i,{callee:e.parse}),e.safeParse=(n,i)=>yy(e,n,i),e.parseAsync=async(n,i)=>my(e,n,i,{callee:e.parseAsync}),e.safeParseAsync=async(n,i)=>vy(e,n,i),e.spa=e.safeParseAsync,e.encode=(n,i)=>_y(e,n,i),e.decode=(n,i)=>by(e,n,i),e.encodeAsync=async(n,i)=>Sy(e,n,i),e.decodeAsync=async(n,i)=>wy(e,n,i),e.safeEncode=(n,i)=>xy(e,n,i),e.safeDecode=(n,i)=>Cy(e,n,i),e.safeEncodeAsync=async(n,i)=>ky(e,n,i),e.safeDecodeAsync=async(n,i)=>Py(e,n,i),e.refine=(n,i)=>e.check(vv(n,i)),e.superRefine=n=>e.check(_v(n)),e.overwrite=n=>e.check(hi(n)),e.optional=()=>uh(e),e.nullable=()=>dh(e),e.nullish=()=>uh(dh(e)),e.nonoptional=n=>cv(e,n),e.array=()=>yn(e),e.or=n=>Vo([e,n]),e.and=n=>Qy(e,n),e.transform=n=>fh(e,iv(n)),e.default=n=>sv(e,n),e.prefault=n=>lv(e,n),e.catch=n=>dv(e,n),e.pipe=n=>fh(e,n),e.readonly=()=>pv(e),e.describe=n=>{const i=e.clone();return Go.add(i,{description:n}),i},Object.defineProperty(e,"description",{get(){return Go.get(e)?.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return Go.get(e);const i=e.clone();return Go.add(i,n[0]),i},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),nh=Y("_ZodString",(e,t)=>{Ca.init(e,t),qe.init(e,t);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...i)=>e.check(W2(...i)),e.includes=(...i)=>e.check(q2(...i)),e.startsWith=(...i)=>e.check(Y2(...i)),e.endsWith=(...i)=>e.check(X2(...i)),e.min=(...i)=>e.check(zo(...i)),e.max=(...i)=>e.check(eh(...i)),e.length=(...i)=>e.check(th(...i)),e.nonempty=(...i)=>e.check(zo(1,...i)),e.lowercase=i=>e.check(Z2(i)),e.uppercase=i=>e.check(K2(i)),e.trim=()=>e.check(Q2()),e.normalize=(...i)=>e.check(J2(...i)),e.toLowerCase=()=>e.check(ey()),e.toUpperCase=()=>e.check(ty()),e.slugify=()=>e.check(ny())}),Ty=Y("ZodString",(e,t)=>{Ca.init(e,t),nh.init(e,t),e.email=n=>e.check(m2(Ay,n)),e.url=n=>e.check(S2(Ey,n)),e.jwt=n=>e.check(I2(Hy,n)),e.emoji=n=>e.check(w2(Ry,n)),e.guid=n=>e.check(Yd(ih,n)),e.uuid=n=>e.check(y2($o,n)),e.uuidv4=n=>e.check(v2($o,n)),e.uuidv6=n=>e.check(_2($o,n)),e.uuidv7=n=>e.check(b2($o,n)),e.nanoid=n=>e.check(x2(Dy,n)),e.guid=n=>e.check(Yd(ih,n)),e.cuid=n=>e.check(C2(My,n)),e.cuid2=n=>e.check(k2(Oy,n)),e.ulid=n=>e.check(P2(Ny,n)),e.base64=n=>e.check(O2(Uy,n)),e.base64url=n=>e.check(N2(Vy,n)),e.xid=n=>e.check(T2(Fy,n)),e.ksuid=n=>e.check(A2(Iy,n)),e.ipv4=n=>e.check(E2(Ly,n)),e.ipv6=n=>e.check(R2(Gy,n)),e.cidrv4=n=>e.check(D2(zy,n)),e.cidrv6=n=>e.check(M2($y,n)),e.e164=n=>e.check(F2(By,n)),e.datetime=n=>e.check(ly(n)),e.date=n=>e.check(uy(n)),e.time=n=>e.check(hy(n)),e.duration=n=>e.check(py(n))});function ct(e){return g2(Ty,e)}const Ye=Y("ZodStringFormat",(e,t)=>{Ze.init(e,t),nh.init(e,t)}),Ay=Y("ZodEmail",(e,t)=>{Sm.init(e,t),Ye.init(e,t)}),ih=Y("ZodGUID",(e,t)=>{_m.init(e,t),Ye.init(e,t)}),$o=Y("ZodUUID",(e,t)=>{bm.init(e,t),Ye.init(e,t)}),Ey=Y("ZodURL",(e,t)=>{wm.init(e,t),Ye.init(e,t)}),Ry=Y("ZodEmoji",(e,t)=>{xm.init(e,t),Ye.init(e,t)}),Dy=Y("ZodNanoID",(e,t)=>{Cm.init(e,t),Ye.init(e,t)}),My=Y("ZodCUID",(e,t)=>{km.init(e,t),Ye.init(e,t)}),Oy=Y("ZodCUID2",(e,t)=>{Pm.init(e,t),Ye.init(e,t)}),Ny=Y("ZodULID",(e,t)=>{Tm.init(e,t),Ye.init(e,t)}),Fy=Y("ZodXID",(e,t)=>{Am.init(e,t),Ye.init(e,t)}),Iy=Y("ZodKSUID",(e,t)=>{Em.init(e,t),Ye.init(e,t)}),Ly=Y("ZodIPv4",(e,t)=>{Nm.init(e,t),Ye.init(e,t)}),Gy=Y("ZodIPv6",(e,t)=>{Fm.init(e,t),Ye.init(e,t)}),zy=Y("ZodCIDRv4",(e,t)=>{Im.init(e,t),Ye.init(e,t)}),$y=Y("ZodCIDRv6",(e,t)=>{Lm.init(e,t),Ye.init(e,t)}),Uy=Y("ZodBase64",(e,t)=>{Gm.init(e,t),Ye.init(e,t)}),Vy=Y("ZodBase64URL",(e,t)=>{$m.init(e,t),Ye.init(e,t)}),By=Y("ZodE164",(e,t)=>{Um.init(e,t),Ye.init(e,t)}),Hy=Y("ZodJWT",(e,t)=>{Bm.init(e,t),Ye.init(e,t)}),rh=Y("ZodNumber",(e,t)=>{Ld.init(e,t),qe.init(e,t),e.gt=(i,r)=>e.check(Jd(i,r)),e.gte=(i,r)=>e.check(Ta(i,r)),e.min=(i,r)=>e.check(Ta(i,r)),e.lt=(i,r)=>e.check(Xd(i,r)),e.lte=(i,r)=>e.check(Pa(i,r)),e.max=(i,r)=>e.check(Pa(i,r)),e.int=i=>e.check(oh(i)),e.safe=i=>e.check(oh(i)),e.positive=i=>e.check(Jd(0,i)),e.nonnegative=i=>e.check(Ta(0,i)),e.negative=i=>e.check(Xd(0,i)),e.nonpositive=i=>e.check(Pa(0,i)),e.multipleOf=(i,r)=>e.check(Qd(i,r)),e.step=(i,r)=>e.check(Qd(i,r)),e.finite=()=>e;const n=e._zod.bag;e.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null});function Mt(e){return U2(rh,e)}const jy=Y("ZodNumberFormat",(e,t)=>{Hm.init(e,t),rh.init(e,t)});function oh(e){return V2(jy,e)}const Wy=Y("ZodBoolean",(e,t)=>{jm.init(e,t),qe.init(e,t)});function Uo(e){return B2(Wy,e)}const Zy=Y("ZodUnknown",(e,t)=>{Wm.init(e,t),qe.init(e,t)});function Aa(){return H2(Zy)}const Ky=Y("ZodNever",(e,t)=>{Zm.init(e,t),qe.init(e,t)});function qy(e){return j2(Ky,e)}const Yy=Y("ZodArray",(e,t)=>{Km.init(e,t),qe.init(e,t),e.element=t.element,e.min=(n,i)=>e.check(zo(n,i)),e.nonempty=n=>e.check(zo(1,n)),e.max=(n,i)=>e.check(eh(n,i)),e.length=(n,i)=>e.check(th(n,i)),e.unwrap=()=>e.element});function yn(e,t){return iy(Yy,e,t)}const Pr=Y("ZodObject",(e,t)=>{Ym.init(e,t),qe.init(e,t),Ne(e,"shape",()=>t.shape),e.keyof=()=>lh(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Aa()}),e.loose=()=>e.clone({...e._zod.def,catchall:Aa()}),e.strict=()=>e.clone({...e._zod.def,catchall:qy()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>m1(e,n),e.safeExtend=n=>y1(e,n),e.merge=n=>v1(e,n),e.pick=n=>p1(e,n),e.omit=n=>g1(e,n),e.partial=(...n)=>_1(ch,e,n[0]),e.required=(...n)=>b1(hh,e,n[0])});function nt(e,t){const n={type:"object",shape:e??{},...me(t)};return new Pr(n)}const sh=Y("ZodUnion",(e,t)=>{Vd.init(e,t),qe.init(e,t),e.options=t.options});function Vo(e,t){return new sh({type:"union",options:e,...me(t)})}const Xy=Y("ZodDiscriminatedUnion",(e,t)=>{sh.init(e,t),Xm.init(e,t)});function ah(e,t,n){return new Xy({type:"union",options:t,discriminator:e,...me(n)})}const Jy=Y("ZodIntersection",(e,t)=>{Jm.init(e,t),qe.init(e,t)});function Qy(e,t){return new Jy({type:"intersection",left:e,right:t})}const ev=Y("ZodRecord",(e,t)=>{Qm.init(e,t),qe.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function Ea(e,t,n){return new ev({type:"record",keyType:e,valueType:t,...me(n)})}const Bo=Y("ZodEnum",(e,t)=>{e2.init(e,t),qe.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(i,r)=>{const o={};for(const s of i)if(n.has(s))o[s]=t.entries[s];else throw new Error(`Key ${s} not found in enum`);return new Bo({...t,checks:[],...me(r),entries:o})},e.exclude=(i,r)=>{const o={...t.entries};for(const s of i)if(n.has(s))delete o[s];else throw new Error(`Key ${s} not found in enum`);return new Bo({...t,checks:[],...me(r),entries:o})}});function lh(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(i=>[i,i])):e;return new Bo({type:"enum",entries:n,...me(t)})}const tv=Y("ZodLiteral",(e,t)=>{t2.init(e,t),qe.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function wt(e,t){return new tv({type:"literal",values:Array.isArray(e)?e:[e],...me(t)})}const nv=Y("ZodTransform",(e,t)=>{n2.init(e,t),qe.init(e,t),e._zod.parse=(n,i)=>{if(i.direction==="backward")throw new bd(e.constructor.name);n.addIssue=o=>{if(typeof o=="string")n.issues.push(kr(o,n.value,t));else{const s=o;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=n.value),s.inst??(s.inst=e),n.issues.push(kr(s))}};const r=t.transform(n.value,n);return r instanceof Promise?r.then(o=>(n.value=o,n)):(n.value=r,n)}});function iv(e){return new nv({type:"transform",transform:e})}const ch=Y("ZodOptional",(e,t)=>{i2.init(e,t),qe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function uh(e){return new ch({type:"optional",innerType:e})}const rv=Y("ZodNullable",(e,t)=>{r2.init(e,t),qe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function dh(e){return new rv({type:"nullable",innerType:e})}const ov=Y("ZodDefault",(e,t)=>{o2.init(e,t),qe.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function sv(e,t){return new ov({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():kd(t)}})}const av=Y("ZodPrefault",(e,t)=>{s2.init(e,t),qe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function lv(e,t){return new av({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():kd(t)}})}const hh=Y("ZodNonOptional",(e,t)=>{a2.init(e,t),qe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function cv(e,t){return new hh({type:"nonoptional",innerType:e,...me(t)})}const uv=Y("ZodCatch",(e,t)=>{l2.init(e,t),qe.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function dv(e,t){return new uv({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const hv=Y("ZodPipe",(e,t)=>{c2.init(e,t),qe.init(e,t),e.in=t.in,e.out=t.out});function fh(e,t){return new hv({type:"pipe",in:e,out:t})}const fv=Y("ZodReadonly",(e,t)=>{u2.init(e,t),qe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function pv(e){return new fv({type:"readonly",innerType:e})}const gv=Y("ZodLazy",(e,t)=>{d2.init(e,t),qe.init(e,t),e.unwrap=()=>e._zod.def.getter()});function mv(e){return new gv({type:"lazy",getter:e})}const yv=Y("ZodCustom",(e,t)=>{h2.init(e,t),qe.init(e,t)});function vv(e,t={}){return ry(yv,e,t)}function _v(e){return oy(e)}const Ho=Ea(ct(),Aa()).optional(),ph=nt({x:Mt(),y:Mt()}),bv=nt({x:Mt(),y:Mt(),ts:Mt()}),Sv=nt({type:wt("stroke"),id:ct(),points:yn(bv),metadata:Ho}),gh=nt({type:wt("strokeGroup"),id:ct(),children:mv(()=>yn(Vo([Sv,gh]))),metadata:Ho}),wv=yn(gh),xv=nt({type:wt("polygon"),id:ct(),points:yn(ph),metadata:Ho}),Cv=yn(xv),kv=nt({type:wt("circle"),id:ct(),center:ph,r:Mt().optional(),rx:Mt(),ry:Mt(),rotation:Mt(),metadata:Ho}),Pv=yn(kv),jo=nt({freehand:nt({serializedState:ct(),bakedRenderData:wv,bakedGroupMap:Ea(ct(),yn(Mt()))}),polygon:nt({serializedState:ct(),bakedRenderData:Cv}),circle:nt({serializedState:ct(),bakedRenderData:Pv,bakedGroupMap:Ea(ct(),yn(Mt()))})}),Tv=jo.extend({added:jo,deleted:jo,changed:jo}),Av=nt({type:wt("setCanvasState"),state:ct()}),Ev=nt({type:wt("setFreehandState"),state:ct()}),Rv=nt({type:wt("setPolygonState"),state:ct()}),Dv=nt({type:wt("undo")}),Mv=nt({type:wt("redo")}),Ov=nt({type:wt("getCanvasState"),requestId:ct().optional()}),Nv=nt({type:wt("setConfig"),width:Vo([Mt(),ct()]).optional(),height:Vo([Mt(),ct()]).optional(),showTimeline:Uo().optional(),showVisualizations:Uo().optional(),showSnapshots:Uo().optional(),showRescale:Uo().optional()}),Fv=nt({type:wt("setTool"),tool:lh(["select","freehand","polygon","circle"])}),Iv=ah("type",[Av,Ev,Rv,Dv,Mv,Ov,Nv,Fv]),Lv=nt({type:wt("stateUpdate"),snapshot:Tv}),Gv=nt({type:wt("canvasStateResponse"),state:ct(),requestId:ct().optional()}),zv=nt({type:wt("connectionReady")}),$v=ah("type",[Lv,Gv,zv]);class Uv{ws=null;reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;reconnectTimer=null;address;handlers={};constructor(t){this.address=t}setHandlers(t){this.handlers=t}connect(){if(this.ws?.readyState!==WebSocket.OPEN)try{this.ws=new WebSocket(this.address),this.ws.onopen=()=>{this.reconnectAttempts=0,this.send({type:"connectionReady"})},this.ws.onmessage=t=>{this.handleMessage(t.data)},this.ws.onclose=()=>{this.scheduleReconnect()},this.ws.onerror=()=>{}}catch{this.scheduleReconnect()}}scheduleReconnect(){this.reconnectAttempts>=this.maxReconnectAttempts||(this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.reconnectAttempts++,this.connect()},this.reconnectDelay*Math.pow(2,this.reconnectAttempts)))}handleMessage(t){let n;try{n=JSON.parse(t)}catch{console.warn("[CanvasWS] Invalid JSON received:",t);return}const i=Iv.safeParse(n);if(!i.success){console.warn("[CanvasWS] Invalid message format:",i.error.format());return}const r=i.data;switch(r.type){case"setCanvasState":this.handlers.onSetCanvasState?.(r.state);break;case"setFreehandState":this.handlers.onSetFreehandState?.(r.state);break;case"setPolygonState":this.handlers.onSetPolygonState?.(r.state);break;case"undo":this.handlers.onUndo?.();break;case"redo":this.handlers.onRedo?.();break;case"getCanvasState":this.handlers.onGetCanvasState?.(r.requestId);break;case"setConfig":this.handlers.onSetConfig?.({width:r.width,height:r.height,showTimeline:r.showTimeline,showVisualizations:r.showVisualizations,showSnapshots:r.showSnapshots,showRescale:r.showRescale});break;case"setTool":this.handlers.onSetTool?.(r.tool);break}}send(t){if(this.ws?.readyState!==WebSocket.OPEN)return;const n=$v.safeParse(t);if(!n.success){console.warn("[CanvasWS] Invalid outgoing message:",n.error.format());return}this.ws.send(JSON.stringify(t))}sendStateUpdate(t){this.send({type:"stateUpdate",snapshot:t})}sendCanvasStateResponse(t,n){this.send({type:"canvasStateResponse",state:t,requestId:n})}disconnect(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.onclose=null,this.ws.close(),this.ws=null)}get isConnected(){return this.ws?.readyState===WebSocket.OPEN}}function Vv(e,t,n,i=document.body){const r=s=>{s.key===t&&n(s)};i.addEventListener("keydown",r);const o=()=>{i.removeEventListener("keydown",r);const s=e.keyboardDisposables.indexOf(o);s!==-1&&e.keyboardDisposables.splice(s,1)};return e.keyboardDisposables.push(o),o}const Bv=()=>({canceled:!1}),mh=e=>{e.token.canceled||(e.token.canceled=!0,e.frameId!==null&&(cancelAnimationFrame(e.frameId),e.frameId=null))},Hv=e=>{const t={frameId:null,token:Bv()},n=i=>{if(t.token.canceled)return;t.frameId=null;const r=e(i,t.token);if(t.token.canceled||r===!1){mh(t);return}t.frameId=requestAnimationFrame(n)};return t.frameId=requestAnimationFrame(n),{token:t.token,cancel:()=>mh(t)}},jv={class:"timeline-container"},Wv={class:"timeline-controls"},Zv=["disabled"],Kv=["disabled"],qv={class:"time-display"},Yv=cn({__name:"Timeline",props:{strokes:{type:Map},selectedStrokes:{type:Set},useRealTiming:{type:Boolean},maxInterStrokeDelay:{type:Number},overrideDuration:{type:Number},lockWhileAnimating:{type:Function}},emits:["timeUpdate"],setup(e,{emit:t}){const n=e,i=t,r=ye(0),o=ye(0),s=ye(!1),a=ye(null);let l,c=0,d=null;const f=()=>{if(n.overrideDuration!==void 0)o.value=n.overrideDuration;else{let D=0;const C=[];if(n.selectedStrokes.size>0)n.selectedStrokes.forEach(w=>{const k=n.strokes.get(w);k&&C.push(k)}),C.sort((w,k)=>{const T=parseInt(w.id.split("-")[1]||"0"),R=parseInt(k.id.split("-")[1]||"0");return T-R}),C.forEach((w,k)=>{if(w.timestamps&&w.timestamps.length>0){const T=w.timestamps[w.timestamps.length-1]||0;D+=T,k<C.length-1&&(D+=100)}});else{const w=Array.from(n.strokes.values());w.sort((T,R)=>{const L=parseInt(T.id.split("-")[1]||"0"),U=parseInt(R.id.split("-")[1]||"0");return L-U});let k=0;w.forEach((T,R)=>{if(T.timestamps&&T.timestamps.length>0){const L=T.creationTime||parseInt(T.id.split("-")[1]||"0"),U=T.timestamps[T.timestamps.length-1]||0;if(R===0)D=U,k=L+U;else{let z=Math.max(0,L-k);!n.useRealTiming&&z>n.maxInterStrokeDelay&&(z=n.maxInterStrokeDelay),D+=z+U,k=L+U}}})}o.value=D}o.value>0&&r.value>o.value&&(r.value=0,i("timeUpdate",0))};Ke([()=>n.strokes,()=>n.selectedStrokes,()=>n.useRealTiming,()=>n.maxInterStrokeDelay,()=>n.overrideDuration],()=>{f()},{immediate:!0,deep:!0});const g=Se(()=>o.value===0?0:r.value/o.value*100),p=D=>{const C=Math.floor(D/1e3),w=Math.floor(D%1e3/10);return`${C}.${w.toString().padStart(2,"0")}s`},u=()=>{s.value||o.value===0||(s.value=!0,n.lockWhileAnimating?.(!0),c=performance.now()-r.value,l=Hv(()=>s.value?(r.value=performance.now()-c,r.value>=o.value?(r.value=0,s.value=!1,n.lockWhileAnimating?.(!1),i("timeUpdate",0),l=void 0,!1):(i("timeUpdate",r.value),!0)):(l=void 0,!1)))},v=()=>{s.value=!1;const D=r.value===0;n.lockWhileAnimating?.(!D),l?.cancel(),l=void 0},b=()=>{s.value=!1,x.value=!1,n.lockWhileAnimating?.(!1),r.value=0,l?.cancel(),l=void 0,i("timeUpdate",0)},x=ye(!1),m=D=>{if(!d)return;const C=Math.max(0,Math.min(D.clientX-d.left,d.width)),w=d.width>0?C/d.width:0;r.value=w*o.value,i("timeUpdate",r.value)},h=D=>{x.value&&m(D)},y=()=>{if(!x.value)return;x.value=!1;const D=r.value===0;n.lockWhileAnimating?.(!D),d=null,window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",y)},S=D=>{D.preventDefault();const C=a.value;C&&(x.value=!0,n.lockWhileAnimating?.(!0),d=C.getBoundingClientRect(),window.addEventListener("mousemove",h),window.addEventListener("mouseup",y),m(D))},E=D=>{if(!x.value){const w=D.currentTarget.getBoundingClientRect(),T=Math.max(0,Math.min(D.clientX-w.left,w.width))/w.width;r.value=T*o.value;const R=r.value===0;n.lockWhileAnimating?.(!R),s.value&&(c=performance.now()-r.value),i("timeUpdate",r.value)}};return Ti(()=>{l?.cancel(),l=void 0,x.value&&(x.value=!1,n.lockWhileAnimating?.(!1)),d=null,window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",y)}),(D,C)=>(le(),ue("div",jv,[Q("div",Wv,[Q("button",{onClick:u,disabled:s.value},"",8,Zv),Q("button",{onClick:v,disabled:!s.value},"",8,Kv),Q("button",{onClick:b},""),Q("span",qv,Le(p(r.value))+" / "+Le(p(o.value)),1)]),Q("div",{ref_key:"timelineTrackRef",ref:a,class:"timeline-track",onClick:E,onMousedown:S},[Q("div",{class:"timeline-progress",style:Nn({width:g.value+"%"})},null,4),Q("div",{class:"timeline-playhead",style:Nn({left:g.value+"%"}),onMousedown:Ks(S,["stop"])},null,36)],544)]))}}),Xv=".timeline-container[data-v-bbee97de]{width:600px;background:#fff;border:1px solid #ccc;border-radius:8px;padding:15px;box-shadow:0 2px 10px #0000001a;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.timeline-controls[data-v-bbee97de]{display:flex;align-items:center;gap:10px;margin-bottom:10px}.timeline-controls button[data-v-bbee97de]{background:none;border:1px solid #ccc;border-radius:4px;padding:5px 10px;cursor:pointer;font-size:16px}.timeline-controls button[data-v-bbee97de]:hover:not(:disabled){background:#f0f0f0}.timeline-controls button[data-v-bbee97de]:disabled{opacity:.5;cursor:not-allowed}.time-display[data-v-bbee97de]{margin-left:auto;font-family:monospace;font-size:14px;color:#666}.timeline-track[data-v-bbee97de]{position:relative;height:40px;background:#f0f0f0;border-radius:4px;cursor:pointer}.timeline-progress[data-v-bbee97de]{position:absolute;top:0;left:0;height:100%;background:#06f;border-radius:4px}.timeline-playhead[data-v-bbee97de]{position:absolute;top:-5px;width:10px;height:50px;background:#06f;border-radius:2px;transform:translate(-50%);cursor:grab;z-index:10}.timeline-playhead[data-v-bbee97de]:hover{background:#0052cc}.timeline-playhead[data-v-bbee97de]:active{cursor:grabbing}",Mn=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n},Jv=Mn(Yv,[["styles",[Xv]],["__scopeId","data-v-bbee97de"]]);function Qv(e){return typeof e=="object"&&e!==null&&"_switchMeta"in e&&e._switchMeta!==null}function e_(e,t){const n=e.variants[t];return n?Object.keys(n):[]}function t_(e){return Object.keys(e.baseShape).filter(t=>t!==e.switchKey)}const n_={class:"zod-editor"},i_={key:0,class:"field-row"},r_=["value","disabled"],o_=["disabled"],s_={key:1,class:"field-row"},a_=["value","disabled"],l_=["disabled"],c_={key:2,class:"field-row"},u_=["value","disabled"],d_=["value"],h_=["disabled"],f_={key:3,class:"field-row boolean-row"},p_={class:"checkbox"},g_=["checked","disabled"],m_=["disabled"],y_={class:"object-grid"},v_={class:"field-label"},__=["value","disabled","onInput"],b_=["value","disabled","onInput"],S_=["value","disabled","onChange"],w_=["value"],x_={class:"checkbox"},C_=["checked","disabled","onChange"],k_=["disabled","onClick"],P_=["disabled","onClick"],T_={class:"field-row"},A_=["disabled"],E_={key:5,class:"unsupported"},R_={key:6,class:"issues"},D_=Mn(cn({name:"ZodDataEditor",__name:"ZodDataEditor",props:{schema:{type:null},modelValue:{type:null},disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,i=t,r=Se(()=>N(n.schema)),o=Se(()=>G(r.value)),s=ye([]),a=ye(""),l=ye(""),c=ye(void 0),d=ye(void 0),f=ye({}),g=Se(()=>H(r.value)),p=ye(!1),u=Se(()=>Qv(n.schema)?n.schema._switchMeta:null),v=Se(()=>u.value?f.value[u.value.switchKey]??"":""),b=Se(()=>!u.value||!v.value?new Set:new Set(e_(u.value,v.value))),x=Se(()=>u.value?new Set(t_(u.value)):new Set),m=F=>!u.value||F===u.value.switchKey||x.value.has(F)?!0:b.value.has(F);Ke(()=>n.modelValue,F=>{if(p.value){p.value=!1;return}h(F)},{immediate:!0,deep:!0,flush:"sync"}),Ke([o,r],()=>{h(n.modelValue)});function h(F){switch(s.value=[],o.value){case"string":a.value=typeof F=="string"?F:"";break;case"number":l.value=typeof F=="number"?`${F}`:typeof F=="string"?F:"";break;case"enum":c.value=typeof F=="string"?F:void 0;break;case"boolean":d.value=typeof F=="boolean"?F:void 0;break;case"object":f.value=_(F);break}}const y=Se(()=>O(n.schema)),S=Se(()=>s.value.length>0),E=Se(()=>{if(!(r.value instanceof Pr))return[];const F=r.value.shape;return Object.entries(F).filter(([A,$])=>G(N($))==="unsupported"?!1:m(A)).map(([A,$])=>({key:A,schema:$,kind:G(N($)),isSwitchKey:u.value?.switchKey===A}))}),D=F=>{a.value=F;const A=y.value&&F.trim()==="";Z(A?void 0:F)},C=F=>{l.value=F;const A=F.trim();if(!A){Z(void 0);return}if(se(A)){s.value=[];return}const $=Number(A);Z(Number.isFinite($)?$:A)},w=F=>{c.value=F||void 0,Z(F||void 0)},k=F=>{d.value=F,Z(F)},T=()=>{d.value=void 0,Z(void 0)},R=()=>{switch(o.value){case"string":a.value="",Z(void 0);break;case"number":l.value="",Z(void 0);break;case"enum":c.value=void 0,Z(void 0);break;case"boolean":T();break;case"object":f.value=_(void 0),s.value=[],p.value=!0,i("update:modelValue",void 0);break}},L=(F,A)=>{f.value={...f.value,[F]:A},z()},U=(F,A)=>{f.value={...f.value,[F]:A};const $=A.trim();if(!$){z();return}if(se($)){s.value=[];return}z()};function z(){if(!(r.value instanceof Pr))return;const F=P();if(y.value&&te(F)){s.value=[],p.value=!0,i("update:modelValue",void 0);return}const A=n.schema.safeParse(F);s.value=A.success?[]:A.error.issues.map(V),p.value=!0,i("update:modelValue",A.success?A.data:F)}function Z(F){const A=n.schema.safeParse(F);s.value=A.success?[]:A.error.issues.map(V),p.value=!0,i("update:modelValue",A.success?A.data:F)}function _(F){if(!(r.value instanceof Pr))return{};const A=r.value.shape,$={};return Object.entries(A).forEach(([j,ee])=>{const fe=N(ee),M=G(fe),I=F?.[j];M==="string"?$[j]=typeof I=="string"?I:"":M==="number"?$[j]=typeof I=="number"?`${I}`:typeof I=="string"?I:"":M==="enum"?$[j]=typeof I=="string"?I:"":M==="boolean"?$[j]=typeof I=="boolean"?I:void 0:M==="object"&&($[j]=I)}),$}function P(){if(!(r.value instanceof Pr))return{};const F=r.value.shape,A={};return Object.entries(F).forEach(([$,j])=>{if(!m($))return;const ee=N(j),fe=G(ee),M=f.value[$];if(fe==="string"){if(M===""&&O(j))return;M!==void 0&&(A[$]=M)}else if(fe==="number"){if(M===""||M===void 0||typeof M=="string"&&se(M.trim()))return;if(typeof M=="number"){A[$]=M;return}const I=Number(M);if(Number.isFinite(I)){A[$]=I;return}A[$]=M}else if(fe==="enum"){if(M===""||M===void 0)return;A[$]=M}else if(fe==="boolean")M!==void 0&&(A[$]=!!M);else if(fe==="object"){if(te(M)&&O(j))return;M!==void 0&&(A[$]=M)}}),A}function N(F){const A=F._def?.type;if(A==="optional"||A==="nullable"||A==="default"||A==="readonly"){const $=F._def?.innerType;return $?N($):F}if(A==="pipe"){const $=F._def?.out??F._def?.innerType??F._def?.schema;return $?N($):F}return F}function O(F){const A=F._def?.type;if(A==="optional"||A==="nullable")return!0;if(A==="default"||A==="readonly"){const $=F._def?.innerType;return $?O($):!1}if(A==="pipe"){const $=F._def?.out??F._def?.innerType??F._def?.schema;return $?O($):!1}return!1}function G(F){const A=F._def?.type;return A==="string"?"string":A==="number"?"number":A==="boolean"?"boolean":A==="enum"?"enum":A==="object"?"object":"unsupported"}function H(F){const A=N(F);if(!(A instanceof Bo))return[];const $=A._def?.values??A._def?.entries??[];return(Array.isArray($)?$:Object.values($)).filter(ee=>typeof ee=="string")}function V(F){const A=F.path.map($=>$?.toString?.()??String($)).join(".");return A?`${A}: ${F.message}`:F.message}function te(F){return F!==null&&typeof F=="object"&&!Array.isArray(F)&&Object.keys(F).length===0}function se(F){return!!(F===""||F==="-"||F==="+"||F==="."||/^[-+]?\d*\.$/.test(F))}return(F,A)=>{const $=xp("ZodDataEditor",!0);return le(),ue("div",n_,[o.value==="string"?(le(),ue("div",i_,[Q("input",{class:"input",type:"text",value:a.value,disabled:F.disabled,onInput:A[0]||(A[0]=j=>D(j.target.value))},null,40,r_),Q("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!y.value&&a.value==="",onClick:R}," Clear ",8,o_)])):o.value==="number"?(le(),ue("div",s_,[Q("input",{class:"input",type:"text",value:l.value,disabled:F.disabled,onInput:A[1]||(A[1]=j=>C(j.target.value))},null,40,a_),Q("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!y.value&&l.value==="",onClick:R}," Clear ",8,l_)])):o.value==="enum"?(le(),ue("div",c_,[Q("select",{class:"input",value:c.value??"",disabled:F.disabled,onChange:A[2]||(A[2]=j=>w(j.target.value))},[A[4]||(A[4]=Q("option",{value:""},"-- select --",-1)),(le(!0),ue(De,null,dn(g.value,j=>(le(),ue("option",{key:j,value:j},Le(j),9,d_))),128))],40,u_),Q("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!y.value,onClick:R}," Clear ",8,h_)])):o.value==="boolean"?(le(),ue("div",f_,[Q("label",p_,[Q("input",{type:"checkbox",checked:!!d.value,disabled:F.disabled,onChange:A[3]||(A[3]=j=>k(j.target.checked))},null,40,g_),Q("span",null,Le(d.value===void 0?"Unset":d.value?"True":"False"),1)]),Q("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!y.value,onClick:T}," Clear ",8,m_)])):o.value==="object"?(le(),ue(De,{key:4},[Q("div",y_,[(le(!0),ue(De,null,dn(E.value,j=>(le(),ue("div",{key:j.key,class:"object-row"},[Q("label",v_,Le(j.key),1),j.kind==="string"?(le(),ue("input",{key:0,class:"input",type:"text",value:f.value[j.key]??"",disabled:F.disabled,onInput:ee=>L(j.key,ee.target.value)},null,40,__)):j.kind==="number"?(le(),ue("input",{key:1,class:"input",type:"text",value:f.value[j.key]??"",disabled:F.disabled,onInput:ee=>U(j.key,ee.target.value)},null,40,b_)):j.kind==="enum"?(le(),ue("select",{key:2,class:"input",value:f.value[j.key]??"",disabled:F.disabled,onChange:ee=>L(j.key,ee.target.value)},[A[5]||(A[5]=Q("option",{value:""},"-- select --",-1)),(le(!0),ue(De,null,dn(H(j.schema),ee=>(le(),ue("option",{key:ee,value:ee},Le(ee),9,w_))),128))],40,S_)):j.kind==="boolean"?(le(),ue(De,{key:3},[Q("label",x_,[Q("input",{type:"checkbox",checked:!!f.value[j.key],disabled:F.disabled,onChange:ee=>L(j.key,ee.target.checked)},null,40,C_),Q("span",null,Le(f.value[j.key]===void 0?"Unset":f.value[j.key]?"True":"False"),1)]),Q("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!O(j.schema),onClick:ee=>L(j.key,void 0)}," Clear ",8,k_)],64)):j.kind==="object"?(le(),ue(De,{key:4},[Qe($,{schema:j.schema,"model-value":f.value[j.key],disabled:F.disabled,"onUpdate:modelValue":ee=>L(j.key,ee)},null,8,["schema","model-value","disabled","onUpdate:modelValue"]),Q("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!O(j.schema),onClick:ee=>L(j.key,void 0)}," Clear ",8,P_)],64)):Oe("",!0)]))),128))]),Q("div",T_,[Q("button",{class:"tiny-btn",type:"button",disabled:F.disabled||!y.value&&!Object.keys(f.value).length,onClick:R}," Clear object ",8,A_)])],64)):(le(),ue("p",E_,"Unsupported schema type for this editor.")),S.value?(le(),ue("div",R_,[(le(!0),ue(De,null,dn(s.value,j=>(le(),ue("div",{key:j}," "+Le(j),1))),128))])):Oe("",!0)])}}}),[["styles",[".zod-editor[data-v-b99ee620]{display:flex;flex-direction:column;gap:6px;font-size:13px}.field-row[data-v-b99ee620]{display:flex;align-items:center;gap:6px}.object-grid[data-v-b99ee620]{display:flex;flex-direction:column;gap:6px;border:1px solid #e5e5e5;padding:6px;border-radius:4px;background:#fafafa}.object-row[data-v-b99ee620]{display:grid;grid-template-columns:90px 1fr auto;align-items:center;gap:6px}.field-label[data-v-b99ee620]{font-weight:600;color:#444}.input[data-v-b99ee620]{flex:1;border:1px solid #ccc;border-radius:4px;padding:4px 6px;font-size:13px}.input[data-v-b99ee620]:disabled{background:#f5f5f5;color:#777}.tiny-btn[data-v-b99ee620]{padding:4px 6px;border:1px solid #bbb;border-radius:4px;background:#f7f7f7;font-size:12px;cursor:pointer}.tiny-btn[data-v-b99ee620]:disabled{opacity:.6;cursor:not-allowed}.issues[data-v-b99ee620]{color:#c0392b;font-size:12px;border-left:3px solid #c0392b;padding-left:8px}.boolean-row[data-v-b99ee620]{justify-content:space-between}.checkbox[data-v-b99ee620]{display:flex;align-items:center;gap:6px;font-weight:600;color:#333}.unsupported[data-v-b99ee620]{margin:0;color:#c0392b;font-weight:600}"]],["__scopeId","data-v-b99ee620"]]),M_={key:0,class:"metadata-editor"},O_={class:"header"},N_={class:"mode-switcher"},F_=["value","disabled"],I_=["value"],L_={class:"status"},G_={key:0,class:"unsaved-indicator"},z_={key:1,class:"pill error"},$_={key:2,class:"pill warn"},U_={key:0,class:"inline-error"},V_={key:1,class:"body"},B_={key:0,class:"inline-error"},H_={key:1,class:"inline-error"},j_={class:"schema-header"},W_={class:"schema-title"},Z_={key:0,class:"inline-error"},K_={key:2,class:"warning"},q_={key:3,class:"buttons"},Y_=["disabled"],X_=["disabled"],yh=Mn(cn({__name:"MetadataEditor",props:{metadata:{type:null},visible:{type:Boolean},canEdit:{type:Boolean},schemaOptions:{default:()=>[],type:Array}},emits:["apply","cancel"],setup(e,{emit:t}){const n=e,i=t,r=ye(""),o=ye(""),s=ye(null),a=ye({}),l=ye({}),c=ye("raw"),d=ye(null),f=Se(()=>n.schemaOptions??[]),g=Se(()=>new Set(f.value.map(T=>T.name))),p=Se(()=>r.value!==o.value),u=Se(()=>Object.entries(a.value).filter(([,T])=>!!T)),v=Se(()=>u.value.length>0),b=Se(()=>f.value.find(T=>T.name===c.value)),x=Se(()=>b.value?.name??""),m=Se(()=>b.value?l.value?.[b.value.name]:void 0),h=Se(()=>!s.value),y=Se(()=>n.canEdit&&p.value&&!s.value&&!v.value);function S(T){const R=T.path.join(".");return R?`${R}: ${T.message}`:T.message}function E(T){const R={};f.value.forEach(({name:L,schema:U})=>{if(!Object.prototype.hasOwnProperty.call(T,L)){R[L]=null;return}const z=U.safeParse(T[L]);R[L]=z.success?null:z.error.issues.map(S).join("; ")}),a.value=R}Ke([()=>n.metadata,()=>n.canEdit],([T,R])=>{if(R){const L=JSON.stringify(T??{},null,2);r.value=L,o.value=L,s.value=null,l.value=T??{},E(l.value),d.value=null,g.value.has(c.value)||(c.value=f.value[0]?.name??"raw")}else r.value="",o.value="",s.value=null,l.value={},a.value={},d.value=null,c.value="raw"},{immediate:!0,deep:!0}),Ke(r,T=>{if(n.canEdit)try{const R=JSON.parse(T&&T.trim()?T:"{}");s.value=null,d.value=null,l.value=R??{},E(R??{})}catch(R){s.value=R instanceof Error?R.message:"Invalid JSON",a.value={}}},{immediate:!0});const D=T=>{if(T!=="raw"&&!h.value){d.value="Fix the JSON to use structured editors.",c.value="raw";return}if(d.value=null,T==="raw"){c.value="raw";return}c.value=g.value.has(T)?T:"raw"},C=(T,R)=>{if(!h.value){d.value="Fix the JSON to use structured editors.",c.value="raw";return}const L=l.value??{},U=JSON.parse(JSON.stringify(L??{}));R===void 0?delete U[T]:U[T]=R,r.value=JSON.stringify(U,null,2)},w=()=>{if(!(!n.canEdit||s.value))try{const T=JSON.parse(r.value&&r.value.trim()?r.value:"{}");if(E(T??{}),Object.values(a.value).some(R=>!!R))return;i("apply",T),o.value=r.value}catch{s.value="Invalid JSON format"}},k=()=>{r.value=o.value,s.value=null,d.value=null;const T=JSON.parse(o.value&&o.value.trim()?o.value:"{}");l.value=T??{},E(T??{})};return(T,R)=>T.visible?(le(),ue("div",M_,[Q("div",O_,[Q("div",N_,[R[4]||(R[4]=Q("label",{class:"mode-label"},"Editor",-1)),Q("select",{class:"mode-select",value:c.value,disabled:!T.canEdit,onChange:R[0]||(R[0]=L=>D(L.target.value))},[(le(!0),ue(De,null,dn(f.value,L=>(le(),ue("option",{key:L.name,value:L.name},Le(L.name),9,I_))),128)),R[3]||(R[3]=Q("option",{value:"raw"},"Raw JSON",-1))],40,F_)]),Q("div",L_,[p.value?(le(),ue("div",G_,R[5]||(R[5]=[Q("span",{class:"dot"},null,-1),ho(" Unsaved ")]))):Oe("",!0),s.value?(le(),ue("div",z_,"Invalid JSON")):v.value?(le(),ue("div",$_,"Schema issues")):Oe("",!0)])]),d.value?(le(),ue("p",U_,Le(d.value),1)):Oe("",!0),T.canEdit?(le(),ue("div",V_,[c.value==="raw"?(le(),ue(De,{key:0},[R[6]||(R[6]=Q("p",{class:"help"},"Edit the metadata as JSON:",-1)),As(Q("textarea",{"onUpdate:modelValue":R[1]||(R[1]=L=>r.value=L),class:"textarea",placeholder:"{}"},null,512),[[Yc,r.value]]),s.value?(le(),ue("p",B_,Le(s.value),1)):Oe("",!0),u.value.length?(le(),ue("div",H_,[(le(!0),ue(De,null,dn(u.value,([L,U])=>(le(),ue("div",{key:L},Le(L)+": "+Le(U),1))),128))])):Oe("",!0)],64)):b.value?(le(),ue(De,{key:1},[Q("div",j_,[Q("div",W_,[R[7]||(R[7]=Q("span",{class:"key-label"},"Key",-1)),Q("code",null,Le(x.value),1)]),R[8]||(R[8]=Q("span",{class:"schema-note"},"Stored on the top-level metadata object",-1))]),Qe(D_,{schema:b.value.schema,"model-value":m.value,disabled:!T.canEdit,"onUpdate:modelValue":R[2]||(R[2]=L=>C(x.value,L))},null,8,["schema","model-value","disabled"]),a.value[x.value]?(le(),ue("p",Z_,Le(a.value[x.value]),1)):Oe("",!0)],64)):Oe("",!0)])):(le(),ue("div",K_,R[9]||(R[9]=[Q("p",null,"Select multiple items to edit metadata (single selection only)",-1)]))),T.canEdit?(le(),ue("div",q_,[Q("button",{onClick:w,class:"btn save",disabled:!y.value}," Save ",8,Y_),Q("button",{onClick:k,class:"btn cancel",disabled:!p.value}," Cancel ",8,X_)])):Oe("",!0)])):Oe("",!0)}}),[["styles",[".metadata-editor[data-v-ea30a7a8]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:8px 14px;margin-top:8px;box-shadow:0 1px 4px #0000001a;max-width:720px;font-size:14px}.header[data-v-ea30a7a8]{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:6px}.mode-switcher[data-v-ea30a7a8]{display:flex;align-items:center;gap:8px}.mode-label[data-v-ea30a7a8]{font-weight:600;color:#333}.mode-select[data-v-ea30a7a8]{border:1px solid #ccc;border-radius:4px;padding:4px 8px;font-size:13px}.status[data-v-ea30a7a8]{display:flex;align-items:center;gap:8px}.unsaved-indicator[data-v-ea30a7a8]{display:flex;align-items:center;gap:6px;font-size:13px;color:#f39c12;font-weight:600}.dot[data-v-ea30a7a8]{width:6px;height:6px;background:#f39c12;border-radius:50%;animation:pulse-ea30a7a8 1.5s infinite}@keyframes pulse-ea30a7a8{0%,to{opacity:1}50%{opacity:.5}}.pill[data-v-ea30a7a8]{padding:2px 8px;border-radius:12px;font-size:12px;font-weight:600}.pill.error[data-v-ea30a7a8]{background:#fdecea;color:#c0392b;border:1px solid #e6b8b4}.pill.warn[data-v-ea30a7a8]{background:#fff4e5;color:#d35400;border:1px solid #f0cba8}.body[data-v-ea30a7a8]{display:flex;flex-direction:column;gap:6px}.help[data-v-ea30a7a8]{margin:0;color:#555;font-size:13px}.textarea[data-v-ea30a7a8]{width:100%;min-height:140px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:13px;line-height:1.35;resize:vertical}.textarea[data-v-ea30a7a8]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 2px #0066ff1f}.schema-header[data-v-ea30a7a8]{display:flex;justify-content:space-between;align-items:center}.schema-title[data-v-ea30a7a8]{display:flex;align-items:center;gap:6px;font-weight:700;color:#333}.key-label[data-v-ea30a7a8]{font-size:12px;text-transform:uppercase;letter-spacing:.04em;color:#777}.schema-note[data-v-ea30a7a8]{font-size:12px;color:#666}.inline-error[data-v-ea30a7a8]{margin:0;color:#c0392b;font-size:12px}.buttons[data-v-ea30a7a8]{display:flex;gap:8px;margin-top:8px}.btn[data-v-ea30a7a8]{padding:5px 12px;border:1px solid;border-radius:4px;cursor:pointer;font-size:13px;transition:all .15s}.btn[data-v-ea30a7a8]:disabled{opacity:.5;cursor:not-allowed}.save[data-v-ea30a7a8]{background:#28a745;color:#fff;border-color:#28a745}.save[data-v-ea30a7a8]:hover:not(:disabled){background:#218838}.cancel[data-v-ea30a7a8]{background:#6c757d;color:#fff;border-color:#6c757d}.cancel[data-v-ea30a7a8]:hover:not(:disabled){background:#5a6268}.warning[data-v-ea30a7a8]{text-align:center;color:#e67e22;padding:8px}.warning p[data-v-ea30a7a8]{margin:0;font-size:15px}"]],["__scopeId","data-v-ea30a7a8"]]),J_={class:"smart-metadata-editor"},Q_={key:0,class:"single-node-header"},e5={class:"node-id"},t5={key:1,class:"hierarchical-editor"},n5={class:"header"},i5={key:0},r5={key:1,class:"multi-selection-header"},o5={class:"help"},s5={key:0,class:"tree-view"},a5=["onClick","onMouseenter"],l5={class:"label"},c5={key:0,class:"metadata-indicator"},u5={key:1,class:"empty-state"},d5={key:3,class:"selection-hint"},h5={key:2,class:"empty-state"},f5=Mn(cn({__name:"HierarchicalMetadataEditor",props:{selectedNodes:{type:Array},singleNode:{type:[Object,null]},multiSelected:{type:Boolean},groupSelected:{type:Boolean},collectHierarchyFromRoot:{type:Function},updateMetadataHighlight:{type:Function},updateHoverHighlight:{type:Function},onApplyMetadata:{type:Function},schemaOptions:{default:()=>[],type:Array}},setup(e){const t=e,n=Se(()=>t.selectedNodes),i=Se(()=>t.singleNode),r=Se(()=>t.multiSelected),o=Se(()=>t.groupSelected),s=Se(()=>r.value||o.value?"hierarchical":i.value?"simple":"none"),a=Se(()=>{if(r.value)return t.collectHierarchyFromRoot(n.value);if(o.value){const m=n.value[0];return m?t.collectHierarchyFromRoot([m]):[]}return[]}),l=Tl(null),c=Se(()=>{const m=i.value;return m?m.getAttr("metadata")??{}:null}),d=Se(()=>{const m=l.value;return m?m.getAttr("metadata")??{}:null});Ke([s,o,n],([m,h])=>{if(m==="hierarchical"&&h){const y=n.value[0];y&&(l.value=y,t.updateMetadataHighlight(y))}else m==="simple"&&i.value?(l.value=i.value,t.updateMetadataHighlight(i.value)):(m==="hierarchical"&&r.value||m==="none")&&(l.value=null,t.updateMetadataHighlight(void 0))},{immediate:!0}),Ke(i,m=>{s.value==="simple"&&(l.value=m,t.updateMetadataHighlight(m))}),Ke(l,m=>{t.updateMetadataHighlight(m)}),Ke(s,m=>{m==="none"&&(l.value=null,t.updateMetadataHighlight(void 0))}),Ti(()=>{t.updateMetadataHighlight(void 0),t.updateHoverHighlight(void 0)});const f=m=>{l.value=m},g=m=>{i.value&&t.onApplyMetadata(i.value,m)},p=m=>{l.value&&t.onApplyMetadata(l.value,m)},u=m=>{const h=m,y=h.id()||`#${h._id}`;if(h instanceof X.Group){const S=h.getChildren().length;return`Group ${y} (${S} ${S===1?"child":"children"})`}else return h instanceof X.Path?`Stroke ${y}`:h instanceof X.Line?`Polygon ${y}`:`${h.constructor.name} ${y}`},v=m=>{const y=m.getAttr("metadata");return y&&Object.keys(y).length>0},b=m=>{t.updateHoverHighlight(m)},x=()=>{t.updateHoverHighlight(void 0)};return(m,h)=>(le(),ue("div",J_,[s.value==="simple"?(le(),ue(De,{key:0},[i.value?(le(),ue("div",Q_,[Q("span",e5,Le(u(i.value)),1)])):Oe("",!0),Qe(yh,{metadata:c.value,visible:!0,"can-edit":!!i.value,"schema-options":t.schemaOptions,onApply:g},null,8,["metadata","can-edit","schema-options"])],64)):s.value==="hierarchical"?(le(),ue("div",t5,[Q("div",n5,[o.value?(le(),ue("h3",i5,"Group: "+Le(u(n.value[0])),1)):r.value?(le(),ue("h3",r5,Le(n.value.length)+" items selected  single-item editing only ",1)):Oe("",!0),Q("p",o5,Le(r.value?"Pick one below to edit its metadata:":"Select a node to edit its metadata:"),1)]),a.value.length>0?(le(),ue("div",s5,[(le(!0),ue(De,null,dn(a.value,y=>(le(),ue("div",{key:y.indexPath,class:$t(["tree-row",{active:y.node===l.value}]),style:Nn({paddingLeft:y.depth*50+"px"}),onClick:S=>f(y.node),onMouseenter:S=>b(y.node),onMouseleave:x},[Q("span",l5,Le(u(y.node)),1),v(y.node)?(le(),ue("span",c5,"")):Oe("",!0)],46,a5))),128))])):(le(),ue("div",u5,h[0]||(h[0]=[Q("p",null,"No shapes or groups available",-1)]))),l.value?(le(),ri(yh,{key:2,metadata:d.value,visible:!0,"can-edit":!0,"schema-options":t.schemaOptions,onApply:p},null,8,["metadata","schema-options"])):r.value?(le(),ue("div",d5,h[1]||(h[1]=[Q("p",null," Click a row above to edit its metadata",-1)]))):Oe("",!0)])):(le(),ue("div",h5,h[2]||(h[2]=[Q("p",null,"Select something to edit its metadata",-1)])))]))}}),[["styles",[".smart-metadata-editor[data-v-3d029686]{margin-top:8px}.single-node-header[data-v-3d029686]{background:#fff;border:1px solid #ddd;border-bottom:none;border-radius:6px 6px 0 0;padding:8px 16px;font-family:Monaco,Consolas,monospace;font-size:13px;color:#333}.node-id[data-v-3d029686]{font-weight:500}.hierarchical-editor[data-v-3d029686]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:8px 16px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-3d029686]{margin-bottom:8px}.header h3[data-v-3d029686]{margin:0 0 4px;font-size:17px;color:#333}.multi-selection-header[data-v-3d029686]{color:#e67e22!important;font-weight:700}.help[data-v-3d029686]{margin:0;color:#666;font-size:14px}.tree-view[data-v-3d029686]{max-height:300px;overflow-y:auto;border:1px solid #eee;border-radius:4px;margin-bottom:8px}.tree-row[data-v-3d029686]{display:flex;align-items:center;justify-content:space-between;padding:4px 8px;cursor:pointer;user-select:none;border-bottom:1px solid #f5f5f5;transition:background-color .15s}.tree-row[data-v-3d029686]:last-child{border-bottom:none}.tree-row[data-v-3d029686]:hover{background-color:#f8f9fa}.tree-row.active[data-v-3d029686]{background-color:#fff2f2;border-left:3px solid #dc3545}.label[data-v-3d029686]{font-family:Monaco,Consolas,monospace;font-size:13px;color:#333}.metadata-indicator[data-v-3d029686]{color:#28a745;font-size:12px;font-weight:700}.empty-state[data-v-3d029686]{text-align:center;color:#666;padding:20px;font-style:italic}.empty-state p[data-v-3d029686]{margin:0}.selection-hint[data-v-3d029686]{text-align:center;color:#666;padding:15px;font-style:italic;border:2px dashed #ddd;border-radius:6px;margin-top:10px}.selection-hint p[data-v-3d029686]{margin:0}"]],["__scopeId","data-v-3d029686"]]),vh=e=>{const t=[],n=(i,r=0,o="")=>{t.push({node:i,depth:r,indexPath:o}),i instanceof X.Group&&i.getChildren().forEach((s,a)=>n(s,r+1,o?`${o}/${a}`:`${a}`))};return e.forEach((i,r)=>n(i,0,`${r}`)),t},p5=e=>e?vh(e.getChildren()):[],Wo=new Map,_h=e=>Wo.set(e.key,e),bh=()=>Array.from(Wo.values()),g5=e=>e.ancillary.nodeVisualizations,Sh=e=>{const t=e.layers.overlay;if(t){if(!e.groups.ancillaryViz){const n=new X.Group({listening:!1,name:"ancillary-vis"});e.groups.ancillaryViz=n,t.add(n)}return e.groups.ancillaryViz}},m5=e=>{e.stage&&e.ancillary.rafToken===null&&(e.ancillary.rafToken=requestAnimationFrame(()=>{e.ancillary.rafToken=null,Zn(e)}))},y5=e=>{const t=e.stage;if(!t||e.ancillary.listenersAttached)return;const n=()=>m5(e);t.on("dragmove.av transform.av",n),t.on("destroy.av",n),t.on("dragend.av transformend.av",()=>Zn(e)),e.ancillary.listenersAttached=!0},v5=e=>{e.ancillary.activeWatchStop||(e.ancillary.activeWatchStop=Ke(()=>e.ancillary.activeVisualizations.value,()=>Zn(e),{deep:!0}))},wh=e=>{e.stage&&(Sh(e),y5(e),v5(e),Zn(e))},Zn=e=>{const t=e.stage,n=Sh(e);if(!t||!n)return;const r=p5(e.groups.freehandShape).filter(l=>l.depth===0).map(l=>l.node),o=new Map,s=e.ancillary.activeVisualizations.value;r.forEach(l=>{const c=l.getAttr("metadata")??{},d=l.getClientRect({relativeTo:t}),f={node:l,metadata:c,bbox:d};s.forEach(g=>{const p=Wo.get(g);p&&p.validate(f)&&o.set(`${g}|${l.id()}`,{ctx:f,def:p})})});const a=g5(e);a.forEach((l,c)=>{o.has(c)||(Wo.get(l.key)?.destroy?.(l.nodes),(Array.isArray(l.nodes)?l.nodes:[l.nodes]).forEach(g=>g.destroy()),a.delete(c))}),o.forEach((l,c)=>{const d=a.get(c);if(d)l.def.update?.(l.ctx,d.nodes);else{const f=l.def.create(l.ctx);(Array.isArray(f)?f:[f]).forEach(p=>{p instanceof X.Group||p instanceof X.Shape?n.add(p):console.warn("Ancillary visualization produced unsupported node type",p)}),a.set(c,{key:l.def.key,nodes:f})}}),n.getLayer()?.batchDraw()},_5=Object.freeze(Object.defineProperty({__proto__:null,getRegisteredAVs:bh,initAVLayer:wh,refreshAnciliaryViz:Zn,registerAV:_h},Symbol.toStringTag,{value:"Module"}));_h({key:"typo-guides",displayName:"Typography Guidelines",validate:({metadata:e})=>["lowLine","midLine","capHeight","ascender","descender","baseline"].some(t=>t in e&&typeof e[t]=="number"),create:e=>xh(e),update:(e,t)=>xh(e,t)});function xh({bbox:e,metadata:t},n){const i=[4,4],o=[{key:"baseline",fraction:t.baseline,color:"#333"},{key:"lowLine",fraction:t.lowLine,color:"#888"},{key:"midLine",fraction:t.midLine,color:"#0a0"},{key:"capHeight",fraction:t.capHeight,color:"#f80"},{key:"ascender",fraction:t.ascender,color:"#00f"},{key:"descender",fraction:t.descender,color:"#f00"}].filter(s=>s.fraction!==void 0&&typeof s.fraction=="number"&&s.fraction>=0&&s.fraction<=1).map(s=>{const a=e.y+e.height*s.fraction;return new X.Line({points:[e.x,a,e.x+e.width,a],stroke:s.color,strokeWidth:5,dash:i,listening:!1,name:`typo-guide-${s.key}`})});return n?(n.forEach((s,a)=>{if(a<o.length){const l=o[a];s.points(l.points()),s.stroke(l.stroke())}}),n.length>o.length&&(n.slice(o.length).forEach(s=>s.destroy()),n.splice(o.length)),o.length>n.length&&n.push(...o.slice(n.length)),n):o}const b5={key:0,class:"av-toggle-pane"},S5={class:"toggles-grid"},w5=["checked","onChange"],x5=Mn(cn({__name:"VisualizationToggles",props:{canvasState:{type:Object}},setup(e){const t=e,n=Se(()=>bh()),i=Se(()=>t.canvasState.ancillary.activeVisualizations.value),r=(s,a)=>{const l=new Set(i.value);a?l.add(s):l.delete(s),t.canvasState.ancillary.activeVisualizations.value=l},o=(s,a)=>{const l=a.target.checked;r(s,l)};return(s,a)=>n.value.length>0?(le(),ue("div",b5,[a[0]||(a[0]=Q("h4",null,"Visualizations",-1)),Q("div",S5,[(le(!0),ue(De,null,dn(n.value,l=>(le(),ue("label",{key:l.key,class:"toggle-item"},[Q("input",{type:"checkbox",checked:i.value.has(l.key),onChange:c=>o(l.key,c)},null,40,w5),Q("span",null,Le(l.displayName),1)]))),128))])])):Oe("",!0)}}),[["styles",[".av-toggle-pane[data-v-641f8251]{background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px;font-size:13px}.av-toggle-pane h4[data-v-641f8251]{margin:0 0 8px;font-size:14px;color:#333;font-weight:600}.toggles-grid[data-v-641f8251]{display:flex;flex-direction:column;gap:6px}.toggle-item[data-v-641f8251]{display:flex;align-items:center;gap:8px;cursor:pointer;transition:background-color .2s;padding:4px 6px;border-radius:4px}.toggle-item[data-v-641f8251]:hover{background-color:#f0f0f0}.toggle-item input[type=checkbox][data-v-641f8251]{margin:0;cursor:pointer}.toggle-item span[data-v-641f8251]{color:#555;font-size:13px;user-select:none}.toggle-item input[type=checkbox]:checked+span[data-v-641f8251]{color:#333;font-weight:500}"]],["__scopeId","data-v-641f8251"]]),C5={class:"snapshots-panel"},k5={class:"panel-header"},P5={class:"header-buttons"},T5=["disabled"],A5={key:0,class:"snapshots-list"},E5=["onClick","onDblclick"],R5={class:"snapshot-name"},D5=["onClick"],M5={key:1,class:"empty-state"},O5=Mn(cn({__name:"SnapshotsPanel",props:{snapshots:{type:Array},selectedId:{type:[String,null]},onSaveSnapshot:{type:Function},onRestoreSnapshot:{type:Function},executeCommand:{type:Function}},emits:["update:snapshots","update:selectedId"],setup(e,{emit:t}){const n=e,i=t,r=ye(null),o=ye(""),s=ye(null),a=Se(()=>n.snapshots.find(b=>b.id===n.selectedId)),l=()=>crypto.randomUUID(),c=()=>{const b=n.onSaveSnapshot(),x=l(),m=x.slice(0,8),h={id:x,name:m,data:b};i("update:snapshots",[...n.snapshots,h]),i("update:selectedId",x)},d=()=>{if(!a.value)return;const b=a.value.data;n.executeCommand("Restore Snapshot",()=>{n.onRestoreSnapshot(b)})},f=b=>{i("update:selectedId",b)},g=b=>{r.value=b.id,o.value=b.name,Ci(()=>{s.value?.focus(),s.value?.select()})},p=()=>{if(!r.value)return;const b=o.value.trim();if(b){const x=n.snapshots.map(m=>m.id===r.value?{...m,name:b}:m);i("update:snapshots",x)}r.value=null,o.value=""},u=b=>{b.key==="Enter"?p():b.key==="Escape"&&(r.value=null,o.value="")},v=b=>{const x=n.snapshots.filter(m=>m.id!==b);i("update:snapshots",x),n.selectedId===b&&i("update:selectedId",null)};return(b,x)=>(le(),ue("div",C5,[Q("div",k5,[x[2]||(x[2]=Q("span",{class:"panel-title"},"Snapshots",-1)),Q("div",P5,[Q("button",{onClick:c,class:"panel-btn save-btn",title:"Save current state as snapshot"}," Save "),Q("button",{onClick:d,disabled:!a.value,class:"panel-btn restore-btn",title:"Restore selected snapshot"}," Restore ",8,T5)])]),b.snapshots.length>0?(le(),ue("div",A5,[(le(!0),ue(De,null,dn(b.snapshots,m=>(le(),ue("div",{key:m.id,class:$t(["snapshot-row",{selected:m.id===b.selectedId}]),onClick:h=>f(m.id),onDblclick:h=>g(m)},[r.value===m.id?As((le(),ue("input",{key:0,ref_for:!0,ref_key:"editInput",ref:s,"onUpdate:modelValue":x[0]||(x[0]=h=>o.value=h),class:"name-input",onBlur:p,onKeydown:u,onClick:x[1]||(x[1]=Ks(()=>{},["stop"]))},null,544)),[[Yc,o.value]]):(le(),ue(De,{key:1},[Q("span",R5,Le(m.name),1),Q("button",{class:"delete-btn",onClick:Ks(h=>v(m.id),["stop"]),title:"Delete snapshot"}," x ",8,D5)],64))],42,E5))),128))])):(le(),ue("div",M5," No snapshots yet "))]))}}),[["styles",[".snapshots-panel[data-v-20847978]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:8px;font-size:13px;width:280px}.panel-header[data-v-20847978]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;padding-bottom:6px;border-bottom:1px solid #eee}.panel-title[data-v-20847978]{font-weight:600;color:#333;font-size:14px}.header-buttons[data-v-20847978]{display:flex;gap:4px}.panel-btn[data-v-20847978]{border:1px solid;border-radius:4px;padding:4px 10px;font-size:12px;cursor:pointer;transition:all .15s;font-weight:500}.panel-btn[data-v-20847978]:disabled{opacity:.5;cursor:not-allowed}.save-btn[data-v-20847978]{background:#28a745;color:#fff;border-color:#28a745}.save-btn[data-v-20847978]:hover:not(:disabled){background:#218838}.restore-btn[data-v-20847978]{background:#f0f0f0;border-color:#ccc;color:#333}.restore-btn[data-v-20847978]:hover:not(:disabled){background:#e0e0e0;border-color:#999}.snapshots-list[data-v-20847978]{max-height:200px;overflow-y:auto;border:1px solid #eee;border-radius:4px}.snapshot-row[data-v-20847978]{display:flex;align-items:center;gap:8px;padding:4px 8px;cursor:pointer;border-bottom:1px solid #f5f5f5;transition:background-color .1s}.snapshot-row[data-v-20847978]:last-child{border-bottom:none}.snapshot-row[data-v-20847978]:hover{background-color:#f8f9fa}.snapshot-row.selected[data-v-20847978]{background-color:#e8f0fe;border-left:2px solid #0066ff}.snapshot-name[data-v-20847978]{font-family:Monaco,Consolas,monospace;font-size:12px;color:#333;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.name-input[data-v-20847978]{flex:1;font-family:Monaco,Consolas,monospace;font-size:12px;padding:2px 4px;border:1px solid #0066ff;border-radius:2px;outline:none}.delete-btn[data-v-20847978]{background:none;border:none;color:#999;cursor:pointer;padding:0 4px;font-size:14px;line-height:1;opacity:0;transition:opacity .15s,color .15s}.snapshot-row:hover .delete-btn[data-v-20847978]{opacity:1}.delete-btn[data-v-20847978]:hover{color:#dc3545}.empty-state[data-v-20847978]{text-align:center;color:#999;padding:16px 8px;font-style:italic;font-size:12px}"]],["__scopeId","data-v-20847978"]]),N5={class:"popout-wrapper"},F5={class:"popout-toolbar"},I5=Mn(cn({__name:"PopoutWindow",props:{title:{type:String,default:"Popout"},modelValue:{type:Boolean,default:!1},width:{type:Number,default:1280},height:{type:Number,default:720},left:{type:Number,default:void 0},top:{type:Number,default:void 0},features:{type:String,default:""},copyStyles:{type:Boolean,default:!0},fullscreenTarget:{type:[String,Function],default:""},fill:{type:Boolean,default:!0}},emits:["update:modelValue","beforePopOut","beforePopIn","opened","closed"],setup(e,{expose:t,emit:n}){const i=e,r=n,o=ye(null),s=ye(null),a=ye(null);let l=null,c=null;const d=Se({get:()=>i.modelValue,set:D=>r("update:modelValue",D)});function f(){if(i.features)return i.features;const D=[];return D.push(`width=${i.width}`),D.push(`height=${i.height}`),i.left!=null&&D.push(`left=${i.left}`),i.top!=null&&D.push(`top=${i.top}`),D.join(",")}function g(D,C){try{D.adoptedStyleSheets?.length&&"adoptedStyleSheets"in C&&(C.adoptedStyleSheets=D.adoptedStyleSheets)}catch{}Array.from(D.querySelectorAll('link[rel="stylesheet"], style')).forEach(w=>{const k=w.cloneNode(!0);C.head.appendChild(k)})}function p(D){return typeof i.fullscreenTarget=="function"?i.fullscreenTarget(D)??D:typeof i.fullscreenTarget=="string"&&i.fullscreenTarget?D.querySelector(i.fullscreenTarget)??D:D}function u(D,C){const w=D.createElement("button");w.textContent="Fullscreen",Object.assign(w.style,{position:"fixed",top:"8px",right:"8px",zIndex:"999999",padding:"8px 16px",backgroundColor:"#333",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"});const k=p(C),T=()=>{const R=!!D.fullscreenElement;w.style.display=R?"none":"inline-block"};return w.addEventListener("click",()=>{k.requestFullscreen?.()}),D.addEventListener("fullscreenchange",T),c=T,T(),D.body.appendChild(w),w}function v(D){const C=s.value,w=D.document,k=w.adoptNode(C);i.fill&&(Object.assign(k.style,{width:"100vw",height:"100vh"}),Object.assign(w.documentElement.style,{height:"100%"}),Object.assign(w.body.style,{margin:"0",height:"100%"})),w.body.appendChild(k)}function b(){const D=s.value;D&&o.value&&(document.adoptNode(D),D.style.removeProperty("width"),D.style.removeProperty("height"),o.value.appendChild(D))}function x(){if(l!=null&&(clearInterval(l),l=null),a.value&&c)try{a.value.document.removeEventListener("fullscreenchange",c),c=null}catch{}if(a.value)try{a.value.removeEventListener("beforeunload",m),a.value.removeEventListener("unload",m)}catch{}}function m(){d.value&&(r("beforePopIn"),b(),d.value=!1,r("closed")),h()}function h(){x();try{a.value?.close()}catch{}a.value=null}function y(){if(a.value&&!a.value.closed)return;r("beforePopOut");const D=window.open("","_blank",f());D&&(a.value=D,D.document.title=i.title,D.document.body.style.background="black",i.copyStyles&&g(document,D.document),D.document.documentElement.className=document.documentElement.className,D.document.body.className=document.body.className,v(D),u(D.document,s.value),D.addEventListener("beforeunload",m),D.addEventListener("unload",m),l=window.setInterval(()=>{(!a.value||a.value.closed)&&m()},1e3),r("opened",D),d.value=!0)}function S(){r("beforePopIn"),b(),d.value=!1,r("closed"),h()}function E(){d.value?S():y()}return Ke(()=>i.modelValue,async D=>{await Ci(),D?y():S()}),oo(()=>{i.modelValue&&y()}),Ms(()=>{if(d.value)try{S()}catch{}}),t({openPopup:y,closePopup:S,toggle:E,isPopped:d}),(D,C)=>(le(),ue("div",N5,[Q("div",F5,[Zl(D.$slots,"controls",{popped:d.value,popOut:y,popIn:S},()=>[d.value?(le(),ue("button",{key:1,onClick:S},"Pop in")):(le(),ue("button",{key:0,onClick:y},"Pop out"))])]),Q("div",{ref_key:"anchor",ref:o,class:"popout-anchor"},[Q("div",{ref_key:"contentRoot",ref:s},[Zl(D.$slots,"default",{},void 0)],512)],512)]))}}),[["styles",[".popout-wrapper[data-v-77babdfc]{display:flex;flex-direction:column;gap:.5rem}.popout-toolbar[data-v-77babdfc]{display:flex;gap:.5rem;align-items:center}.popout-anchor[data-v-77babdfc]{display:block}"]],["__scopeId","data-v-77babdfc"]]);function Ch(e,t,n,i=r=>r){return e*i(.5-t*(.5-n))}function L5(e){return[-e[0],-e[1]]}function Ht(e,t){return[e[0]+t[0],e[1]+t[1]]}function zt(e,t){return[e[0]-t[0],e[1]-t[1]]}function jt(e,t){return[e[0]*t,e[1]*t]}function G5(e,t){return[e[0]/t,e[1]/t]}function Tr(e){return[e[1],-e[0]]}function kh(e,t){return e[0]*t[0]+e[1]*t[1]}function z5(e,t){return e[0]===t[0]&&e[1]===t[1]}function $5(e){return Math.hypot(e[0],e[1])}function U5(e){return e[0]*e[0]+e[1]*e[1]}function Ph(e,t){return U5(zt(e,t))}function Th(e){return G5(e,$5(e))}function V5(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function Ar(e,t,n){let i=Math.sin(n),r=Math.cos(n),o=e[0]-t[0],s=e[1]-t[1],a=o*r-s*i,l=o*i+s*r;return[a+t[0],l+t[1]]}function Ra(e,t,n){return Ht(e,jt(zt(t,e),n))}function Ah(e,t,n){return Ht(e,jt(t,n))}var{min:fi,PI:B5}=Math,Eh=.275,Er=B5+1e-4;function H5(e,t={}){let{size:n=16,smoothing:i=.5,thinning:r=.5,simulatePressure:o=!0,easing:s=_=>_,start:a={},end:l={},last:c=!1}=t,{cap:d=!0,easing:f=_=>_*(2-_)}=a,{cap:g=!0,easing:p=_=>--_*_*_+1}=l;if(e.length===0||n<=0)return[];let u=e[e.length-1].runningLength,v=a.taper===!1?0:a.taper===!0?Math.max(n,u):a.taper,b=l.taper===!1?0:l.taper===!0?Math.max(n,u):l.taper,x=Math.pow(n*i,2),m=[],h=[],y=e.slice(0,10).reduce((_,P)=>{let N=P.pressure;if(o){let O=fi(1,P.distance/n),G=fi(1,1-O);N=fi(1,_+(G-_)*(O*Eh))}return(_+N)/2},e[0].pressure),S=Ch(n,r,e[e.length-1].pressure,s),E,D=e[0].vector,C=e[0].point,w=C,k=C,T=w,R=!1;for(let _=0;_<e.length;_++){let{pressure:P}=e[_],{point:N,vector:O,distance:G,runningLength:H}=e[_];if(_<e.length-1&&u-H<3)continue;if(r){if(o){let ee=fi(1,G/n),fe=fi(1,1-ee);P=fi(1,y+(fe-y)*(ee*Eh))}S=Ch(n,r,P,s)}else S=n/2;E===void 0&&(E=S);let V=H<v?f(H/v):1,te=u-H<b?p((u-H)/b):1;S=Math.max(.01,S*Math.min(V,te));let se=(_<e.length-1?e[_+1]:e[_]).vector,F=_<e.length-1?kh(O,se):1,A=kh(O,D)<0&&!R,$=F!==null&&F<0;if(A||$){let ee=jt(Tr(D),S);for(let fe=.07692307692307693,M=0;M<=1;M+=fe)k=Ar(zt(N,ee),N,Er*M),m.push(k),T=Ar(Ht(N,ee),N,Er*-M),h.push(T);C=k,w=T,$&&(R=!0);continue}if(R=!1,_===e.length-1){let ee=jt(Tr(O),S);m.push(zt(N,ee)),h.push(Ht(N,ee));continue}let j=jt(Tr(Ra(se,O,F)),S);k=zt(N,j),(_<=1||Ph(C,k)>x)&&(m.push(k),C=k),T=Ht(N,j),(_<=1||Ph(w,T)>x)&&(h.push(T),w=T),y=P,D=O}let L=e[0].point.slice(0,2),U=e.length>1?e[e.length-1].point.slice(0,2):Ht(e[0].point,[1,1]),z=[],Z=[];if(e.length===1){if(!(v||b)||c){let _=Ah(L,Th(Tr(zt(L,U))),-(E||S)),P=[];for(let N=.07692307692307693,O=N;O<=1;O+=N)P.push(Ar(_,L,Er*2*O));return P}}else{if(!(v||b&&e.length===1))if(d)for(let P=.07692307692307693,N=P;N<=1;N+=P){let O=Ar(h[0],L,Er*N);z.push(O)}else{let P=zt(m[0],h[0]),N=jt(P,.5),O=jt(P,.51);z.push(zt(L,N),zt(L,O),Ht(L,O),Ht(L,N))}let _=Tr(L5(e[e.length-1].vector));if(b||v&&e.length===1)Z.push(U);else if(g){let P=Ah(U,_,S);for(let N=.034482758620689655,O=N;O<1;O+=N)Z.push(Ar(P,U,Er*3*O))}else Z.push(Ht(U,jt(_,S)),Ht(U,jt(_,S*.99)),zt(U,jt(_,S*.99)),zt(U,jt(_,S)))}return m.concat(Z,h.reverse(),z)}function j5(e,t={}){var n;let{streamline:i=.5,size:r=16,last:o=!1}=t;if(e.length===0)return[];let s=.15+(1-i)*.85,a=Array.isArray(e[0])?e:e.map(({x:p,y:u,pressure:v=.5})=>[p,u,v]);if(a.length===2){let p=a[1];a=a.slice(0,-1);for(let u=1;u<5;u++)a.push(Ra(a[0],p,u/4))}a.length===1&&(a=[...a,[...Ht(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,d=0,f=l[0],g=a.length-1;for(let p=1;p<a.length;p++){let u=o&&p===g?a[p].slice(0,2):Ra(f.point,a[p],s);if(z5(f.point,u))continue;let v=V5(u,f.point);if(d+=v,p<g&&!c){if(d<r)continue;c=!0}f={point:u,pressure:a[p][2]>=0?a[p][2]:.5,vector:Th(zt(f.point,u)),distance:v,runningLength:d},l.push(f)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function W5(e,t={}){return H5(j5(e,t),t)}var Z5=W5;const Da=e=>e.metadata.highlight.layer,K5=e=>e.metadata.highlight.metadataRect,q5=e=>e.metadata.highlight.hoverRect,Rh=(e,t)=>{const n=Da(e);if(n)return n;const i=new X.Group({listening:!1,name:"metadata-highlight"}),r=new X.Rect({stroke:"red",strokeWidth:2,dash:[4,4],listening:!1,visible:!1}),o=new X.Rect({stroke:"green",strokeWidth:2,dash:[4,4],listening:!1,visible:!1});i.add(r),i.add(o);const s=e.layers.overlay;if(s)s.add(i);else{const a=new X.Layer({listening:!1,name:"metadata-highlight-layer"});a.add(i),t.add(a),a.moveToTop()}return e.metadata.highlight.layer=i,e.metadata.highlight.metadataRect=r,e.metadata.highlight.hoverRect=o,e.groups.metadataHighlight=i,i},Rr=(e,t)=>{const n=K5(e),i=Da(e);if(!n||!i)return;if(!t){n.visible(!1),n.rotation(0),i.getLayer()?.batchDraw();return}const r=t.getClientRect({skipTransform:!0}),o=t.getAbsoluteScale(),s=Math.abs(o.x),a=Math.abs(o.y),l=r.width*s,c=r.height*a,d=t.getAbsoluteTransform().point({x:r.x+r.width/2,y:r.y+r.height/2});n.setAttrs({x:d.x,y:d.y,width:l,height:c,offsetX:l/2,offsetY:c/2,rotation:t.getAbsoluteRotation(),visible:!0}),i.getLayer()?.batchDraw()},Y5=(e,t)=>{const n=q5(e),i=Da(e);if(!n||!i)return;if(!t){n.visible(!1),n.rotation(0),i.getLayer()?.batchDraw();return}const r=t.getClientRect({skipTransform:!0}),o=t.getAbsoluteScale(),s=Math.abs(o.x),a=Math.abs(o.y),l=r.width*s,c=r.height*a,d=t.getAbsoluteTransform().point({x:r.x+r.width/2,y:r.y+r.height/2});n.setAttrs({x:d.x,y:d.y,width:l,height:c,offsetX:l/2,offsetY:c/2,rotation:t.getAbsoluteRotation(),visible:!0}),i.getLayer()?.batchDraw()},X5=e=>({setNodeMetadata:(t,n)=>{n===void 0||Object.keys(n).length===0?t.setAttr("metadata",void 0):t.setAttr("metadata",n)},collectHierarchyFromRoot:vh,updateMetadataHighlight:t=>Rr(e,t),updateHoverHighlight:t=>Y5(e,t)}),Ma=(e,t)=>{t instanceof X.Path?vd(e,t):t instanceof X.Group&&(Ro(e,t),t.getChildren().forEach(n=>Ma(e,n)))},Zo=(e,t)=>{(t instanceof X.Path||t instanceof X.Group)&&(t instanceof X.Path,t.draggable(!0),t.off("click.freehand"),t.off("dragstart.freehand"),t.off("dragend.freehand"),t.on("dragstart.freehand",()=>{Na(e)}),t.on("dragend.freehand",()=>{Fa(e,t.constructor.name),e.groups.freehandShape?.getLayer()?.batchDraw()}),t instanceof X.Group&&t.getChildren().forEach(n=>{Zo(e,n)}))},Dh=(e,t,n=0,i=0)=>{const r=t.clone({x:t.x()+n,y:t.y()+i}),o=(s,a)=>{const l=mn();if(s.id(l),s instanceof X.Path){const c=Array.from(Ct(e).values()).find(d=>d.shape===a);if(c){const d={...c,id:l,shape:s};Ct(e).set(l,d),console.log("Created stroke data for cloned Path:",l)}}else if(s instanceof X.Group){const c=a,d=s;d.getChildren().forEach((g,p)=>{const u=c.getChildren()[p];o(g,u)});const f=d.find("Path").map(g=>g.id());f.length>0&&(la(e).set(l,{id:l,strokeIds:f,group:d}),console.log("Created group data for cloned Group:",l,"with strokes:",f))}};return o(r,t),Zo(e,r),Ma(e,r),console.log("Successfully cloned",t.className,"with new ID:",r.id()),r},Mh=(e,t)=>{const n=e.layers.drawing;if(!n){console.warn("Cannot initialize freehand groups without drawing layer");return}if(!e.groups.freehandShape){const i=new X.Group({name:"freehand-shapes"});e.groups.freehandShape=i,n.add(i)}if(!e.groups.freehandDrawing){const i=new X.Group({name:"freehand-drawing"});e.groups.freehandDrawing=i,n.add(i)}},Oh=e=>{const t=[],n=new Set;return e.selection.selectedKonvaNodes.value.forEach(i=>{if(i instanceof X.Group){const r=o=>{o.getChildren().forEach(s=>{s instanceof X.Group?r(s):s instanceof X.Path&&Array.from(Ct(e).values()).forEach(a=>{a.shape===s&&!n.has(a.id)&&(t.push(a),n.add(a.id))})})};r(i)}else i instanceof X.Path&&Array.from(Ct(e).values()).forEach(r=>{r.shape===i&&!n.has(r.id)&&(t.push(r),n.add(r.id))})}),t},Oa=e=>{e.freehand.timelineDuration.value;let t=0;if(md(e))e.freehand.selectedStrokesForTimeline.value=new Set,e.freehand.timelineDuration.value=0;else{const n=Oh(e).filter(r=>r.isFreehand),i=new Set(n.map(r=>r.id));if(e.freehand.selectedStrokesForTimeline.value=i,n.length>0){const r=n.sort((s,a)=>s.creationTime-a.creationTime);let o=0;r.forEach((s,a)=>{const l=s.timestamps[s.timestamps.length-1]||0;o+=l,a<r.length-1&&(o+=100)}),t=o,e.freehand.timelineDuration.value=o}else e.freehand.timelineDuration.value=0}t>0&&e.freehand.currentPlaybackTime.value>t&&(e.freehand.currentPlaybackTime.value=0,La(e,0))},Nh=e=>{e.freehand.strokes.clear(),e.freehand.strokeGroups.clear()},Fh=(e,t,n)=>{const i={id:n.id,points:n.points,timestamps:n.timestamps,shape:n.shape,selected:n.selected,originalPath:n.originalPath,creationTime:n.creationTime,isFreehand:n.isFreehand};e.freehand.strokes.set(t,i)},Ih=(e,t,n)=>{const i={id:n.id,strokeIds:n.strokeIds,group:n.group};e.freehand.strokeGroups.set(t,i)},Ko=300,Lh=e=>Co(e,()=>{const t=e.groups.freehandShape;if(!e.stage||!t)return null;try{const i=t.toObject(),r=Array.from(e.freehand.strokes.entries()),o=Array.from(e.freehand.strokeGroups.entries());return{layer:i,strokes:r,strokeGroups:o}}catch(i){return console.warn("Failed to get current state:",i),null}}),On=e=>{const t=Lh(e);return JSON.stringify(t)},Gh=(e,t,n={})=>{if(t)try{const i=e.freehand.currentPlaybackTime.value>0;e.freehand.currentPlaybackTime.value=0,e.freehand.isAnimating.value=!1,qo(e,t),i&&n.handleTimeUpdate?.(0)}catch(i){console.warn("Failed to restore state:",i)}},Na=e=>{e.freehand.freehandDragStartState=On(e)},Fa=(e,t)=>{if(!e.freehand.freehandDragStartState)return;const n=On(e);e.freehand.freehandDragStartState!==n&&(xo(e,`Transform ${t}`,e.freehand.freehandDragStartState,n),console.log("Transform command added to global history"),Wt(e)),e.freehand.freehandDragStartState=null},Ia=e=>{const t=e.stage;t&&Ct(e).forEach((n,i)=>{const r=t.findOne(`#${i}`);r&&r!==n.shape&&(console.log("Updating stroke connection for:",i),n.shape=r)})},zh=e=>{const t=e.groups.freehandShape;if(!(!e.stage||!t))try{const i=Lh(e);if(!i)return;e.freehand.serializedState=JSON.stringify(i),e.callbacks.syncAppState?.(e),console.log("Serialized canvas state:",{layerChildren:i.layer?.children?.length||0,strokes:i.strokes.length,strokeGroups:i.strokeGroups.length})}catch(i){console.warn("Failed to serialize Konva state:",i)}},qo=(e,t)=>{const n=e.groups.freehandShape,i=e.stage;if(!(!t||!i||!n))try{const r=JSON.parse(t);console.log("Deserializing canvas state:",{layerChildren:r.layer?.children?.length||0,strokes:r.strokes?.length||0,strokeGroups:r.strokeGroups?.length||0}),n.destroyChildren(),Nh(e),kt(e);const o=r.layer;o&&o.children&&(console.log("Restoring",o.children.length,"children"),o.children.forEach((s,a)=>{console.log("Creating node",a,"of type",s.className);const l=X.Node.create(JSON.stringify(s));n.add(l),console.log("Added node to layer:",l.id(),l.isVisible()),Zo(e,l),Ma(e,l)})),r.strokes&&r.strokes.forEach(([s,a])=>{const l=i.findOne(`#${s}`);console.log("Restoring stroke:",s,"found shape:",!!l);const c={id:a.id,points:a.points,timestamps:a.timestamps,originalPath:a.originalPath,creationTime:a.creationTime,isFreehand:a.isFreehand,shape:l};Fh(e,s,c)}),r.strokeGroups&&r.strokeGroups.forEach(([s,a])=>{const l={id:a.id,strokeIds:a.strokeIds,group:i.findOne(`#${s}`)};Ih(e,s,l)}),Ia(e),Yo(e),n.getLayer()?.batchDraw(),console.log("Konva canvas state restored from hotreload"),e.freehand.serializedState=t,setTimeout(()=>{n.getLayer()?.batchDraw(),Wt(e)},30)}catch(r){console.warn("Failed to deserialize Konva state:",r)}},Yo=e=>{const t=e.groups.freehandShape;Ct(e).forEach(n=>{n.shape&&n.shape.draggable(!1)}),t&&t.getChildren().forEach(n=>{n instanceof X.Group&&n.draggable(!1)})},Dr=(e,t=!1)=>{if(e.length<4)return"";const n=[];for(let s=0;s<e.length;s+=2)n.push([e[s],e[s+1]]);const i=Z5(n,{size:8,thinning:.5,smoothing:.5,streamline:.5,simulatePressure:!0});if(i.length===0)return"";let r=i;if(t){let s=1/0,a=1/0;i.forEach(([l,c])=>{s=Math.min(s,l),a=Math.min(a,c)}),r=i.map(([l,c])=>[l-s,c-a])}return`${r.reduce((s,[a,l],c,d)=>{const[f,g]=d[(c+1)%d.length];return`${s} ${a},${l} ${f},${g}`},`M ${r[0][0]},${r[0][1]} L`)} Z`},$h=(e,t,n)=>{const i=e.groups.freehandShape,r=Ao(t),o=[];for(let a=0;a<t.length;a+=2)o.push(t[a]-r.minX),o.push(t[a+1]-r.minY);const s=new X.Path({data:Dr(o),fill:"black",strokeWidth:0,id:n,x:r.minX,y:r.minY,draggable:!0});return s.on("dragstart",()=>{Na(e)}),s.on("dragend",()=>{Fa(e,"Stroke"),i?.getLayer()?.batchDraw()}),vd(e,s),s},La=(e,t)=>{const n=e.groups.freehandShape;e.freehand.currentPlaybackTime.value=t;let i=[];const r=!md(e);if(r?i=Oh(e).filter(c=>c.isFreehand):i=Array.from(Ct(e).values()).filter(l=>l.isFreehand),i.sort((l,c)=>l.creationTime-c.creationTime),t===0){if(r){const l=new Set;i.forEach(c=>{if(c.shape&&c.originalPath){c.shape.show(),c.shape.data(c.originalPath);let d=c.shape.getParent();for(;d&&d!==n;)d instanceof X.Group&&l.add(d),d=d.getParent()}}),l.forEach(c=>c.show())}else Ct(e).forEach(l=>{l.shape&&l.originalPath&&l.isFreehand&&(l.shape.show(),l.shape.data(l.originalPath))}),n&&n.getChildren().forEach(l=>{l instanceof X.Group&&l.show()});n?.getLayer()?.batchDraw();return}r?i.forEach(l=>{l.shape&&l.shape.hide()}):(Ct(e).forEach(l=>{l.shape&&l.isFreehand&&l.shape.hide()}),n&&n.getChildren().forEach(l=>{l instanceof X.Group&&l.hide()}));let o=0;const s=[];if(r)i.forEach((l,c)=>{const d=l.timestamps[l.timestamps.length-1]||0;s.push({stroke:l,startTime:o,endTime:o+d}),o+=d+(c<i.length-1?100:0)});else{let l=0;i.forEach((c,d)=>{const f=c.timestamps[c.timestamps.length-1]||0;if(d===0)s.push({stroke:c,startTime:0,endTime:f}),l=c.creationTime+f,o=f;else{let g=Math.max(0,c.creationTime-l);!e.freehand.useRealTiming.value&&g>Ko&&(g=Ko);const p=o+g;s.push({stroke:c,startTime:p,endTime:p+f}),o=p+f,l=c.creationTime+f}})}const a=new Set;s.forEach(({stroke:l,startTime:c,endTime:d})=>{if(!(!l.shape||!l.timestamps)){if(t>=c&&t<=d){const f=t-c;let g=-1;for(let p=0;p<l.timestamps.length&&l.timestamps[p]<=f;p++)g=p;if(g>=0){const p=l.points.slice(0,(g+1)*2);if(p.length>=4){const u=Ao(l.points),v=[];for(let x=0;x<p.length;x+=2)v.push(p[x]-u.minX),v.push(p[x+1]-u.minY);l.shape.show(),l.shape.data(Dr(v));let b=l.shape.getParent();for(;b&&b!==n;)b instanceof X.Group&&a.add(b),b=b.getParent()}}}else if(t>d){l.shape.show(),l.shape.data(l.originalPath);let f=l.shape.getParent();for(;f&&f!==n;)f instanceof X.Group&&a.add(f),f=f.getParent()}}}),a.forEach(l=>l.show()),n?.getLayer()?.batchDraw()},J5=e=>{const t=e.groups.freehandShape;if(!t)return{data:[],groupMap:{}};const n=(a,l)=>{const c=Ao(a),d=[];for(let p=0;p<a.length;p+=2)d.push(a[p]-c.minX),d.push(a[p+1]-c.minY);const f=l.getAbsoluteTransform(),g=[];for(let p=0;p<d.length;p+=2){const u=f.point({x:d[p],y:d[p+1]});g.push({x:u.x,y:u.y})}return g};let i=0;const r={},o=a=>{if(a instanceof X.Path){const l=Array.from(e.freehand.strokes.values()).find(g=>g.shape===a);if(!l)return null;const d=n(l.points,a).map((g,p)=>({x:g.x,y:g.y,ts:l.timestamps[Math.floor(p/2)]||0})),f=a.getAttr("metadata");return f&&f.name&&typeof f.name=="string"&&(r[f.name]||(r[f.name]=[]),r[f.name].push(i)),i++,{type:"stroke",id:l.id,points:d,...f&&{metadata:f}}}else if(a instanceof X.Group){const l=i,c=[];if(a.getChildren().forEach(p=>{const u=o(p);u&&c.push(u)}),c.length===0)return null;const d=a.getAttr("metadata"),f=[];for(let p=l;p<i;p++)f.push(p);const g=d&&d.name&&typeof d.name=="string"?d.name:a.id();return g&&(r[g]=f),{type:"strokeGroup",id:a.id(),children:c,...d&&{metadata:d}}}return null},s=[];return t.getChildren().forEach(a=>{const l=o(a);l&&(l.type==="stroke"?s.push({type:"strokeGroup",id:l.id,children:[l]}):s.push(l))}),{data:s,groupMap:r}},Wt=e=>{const t=J5(e);e.freehand.bakedRenderData=t.data,e.freehand.bakedGroupMap=t.groupMap,e.callbacks.syncAppState?.(e)},Uh=Object.freeze(Object.defineProperty({__proto__:null,attachHandlersRecursively:Zo,clearStrokesInState:Nh,createStrokeShape:$h,deepCloneWithNewIds:Dh,deserializeFreehandState:qo,finishFreehandDragTracking:Fa,getCurrentFreehandStateString:On,getStrokePath:Dr,handleTimeUpdate:La,initFreehandLayers:Mh,maxInterStrokeDelay:Ko,refreshStrokeConnections:Ia,restoreFreehandState:Gh,serializeFreehandState:zh,setStrokeGroupInState:Ih,setStrokeInState:Fh,startFreehandDragTracking:Na,updateBakedFreehandData:Wt,updateFreehandDraggableStates:Yo,updateTimelineState:Oa},Symbol.toStringTag,{value:"Module"})),Q5=(e,t,n)=>{const i=t.x-e.x,r=t.y-e.y,o=n.x-e.x,s=n.y-e.y,a=i*o+r*s;if(a<=0)return Math.hypot(o,s);const l=i*i+r*r;if(l<=a)return Math.hypot(n.x-t.x,n.y-t.y);const c=a/l,d=e.x+c*i,f=e.y+c*r;return Math.hypot(n.x-d,n.y-f)};function Vh(e,t){let n=-1,i=-1,r=1/0;for(let o=0;o<e.length;o++){const s=e[o];for(let a=0;a<s.points.length;a++){const l=s.points[a],c=s.points[(a+1)%s.points.length],d=Q5(l,c,t);d<r&&(r=d,n=o,i=a)}}return{polygonIndex:n,lineIndex:i,distance:r}}const Bh=(e,t)=>{const n=e.layers.drawing,i=e.layers.overlay;if(!n||!i){console.warn("Cannot initialize polygon groups without required layers");return}if(!e.groups.polygonShapes){const r=new X.Group({name:"polygon-shapes"});e.groups.polygonShapes=r,n.add(r)}if(!e.groups.polygonPreview){const r=new X.Group({name:"polygon-preview"});e.groups.polygonPreview=r,i.add(r)}if(!e.groups.polygonControls){const r=new X.Group({name:"polygon-controls"});e.groups.polygonControls=r,i.add(r)}if(!e.groups.polygonSelection){const r=new X.Group({name:"polygon-selection"});e.groups.polygonSelection=r,i.add(r)}},Ga=e=>{kt(e)},Hh=e=>{const t=e.groups.polygonShapes;if(!t)return[];const n=[],i=(r,o)=>{const s=[],a=o.getAbsoluteTransform();for(let l=0;l<r.length;l+=2){const c=a.point({x:r[l],y:r[l+1]});s.push({x:c.x,y:c.y})}return s};return t.getChildren().forEach(r=>{if(r instanceof X.Line){const o=r.points(),s=i(o,r),a=r.getAttr("metadata"),c=Array.from(e.polygon.shapes.values()).find(d=>d.konvaShape===r)?.id||r.id();n.push({type:"polygon",id:c,points:s,...a&&{metadata:a}})}}),n},Zt=e=>{e.polygon.bakedRenderData=Hh(e),e.callbacks.syncAppState?.(e)},za=e=>Co(e,()=>{const t=e.groups.polygonShapes;if(!e.stage||!t)return null;try{const i=t.toObject(),r=Array.from(e.polygon.shapes.entries()),o=Array.from(e.polygon.groups.entries());return{layer:i,polygons:r,polygonGroups:o}}catch(i){return console.warn("Failed to get current polygon state:",i),null}}),pi=e=>{const t=za(e);return JSON.stringify(t)},jh=(e,t)=>{if(t)try{Jo(e,t)}catch(n){console.warn("Failed to restore polygon state:",n)}},$a=e=>{const t=JSON.stringify({freehand:On(e),polygon:pi(e)});e.polygon.dragStartState=t},Ua=(e,t)=>{if(!e.polygon.dragStartState)return;const n=JSON.stringify({freehand:On(e),polygon:pi(e)});e.polygon.dragStartState!==n&&(xo(e,`Transform ${t}`,e.polygon.dragStartState,n),Zt(e)),e.polygon.dragStartState=null},vn=e=>{const t=e.groups.polygonShapes;if(!(!e.stage||!t))try{const i=za(e);if(!i)return;e.polygon.serializedState=JSON.stringify(i),e.callbacks.syncAppState?.(e),console.log("Serialized polygon state:",{layerChildren:i.layer?.children?.length||0,polygons:i.polygons.length,polygonGroups:i.polygonGroups.length})}catch(i){console.warn("Failed to serialize polygon state:",i)}},Xo=(e,t)=>{console.log("Attaching polygon handlers to:",t.id()),t.draggable(!1),t.on("dragstart",()=>$a(e)),t.on("dragend",()=>{Ua(e,"Polygon Drag"),vn(e)})},Jo=(e,t)=>{const n=e.groups.polygonShapes,i=e.groups.polygonControls,r=e.stage;if(!(!t||!r||!n))try{const o=JSON.parse(t);console.log("Deserializing polygon state:",{layerChildren:o.layer?.children?.length||0,polygons:o.polygons?.length||0,polygonGroups:o.polygonGroups?.length||0}),n.destroyChildren(),e.polygon.shapes.clear(),e.polygon.groups.clear(),kt(e);const s=o.layer;s&&s.children&&(console.log("Restoring",s.children.length,"polygon shapes"),s.children.forEach((a,l)=>{console.log("Creating polygon node",l,"of type",a.className);const c=X.Node.create(JSON.stringify(a));n.add(c),console.log("Added polygon node to layer:",c.id(),c.isVisible()),c instanceof X.Line?(Xo(e,c),ma(e,c)):c instanceof X.Group&&Ro(e,c)})),o.polygons&&o.polygons.forEach(([a,l])=>{const c=r.findOne(`#${a}`);console.log("Restoring polygon:",a,"found shape:",!!c);const d={id:l.id,points:l.points,closed:l.closed,creationTime:l.creationTime,konvaShape:c,controlPoints:[]};e.polygon.shapes.set(a,d)}),o.polygonGroups&&o.polygonGroups.forEach(([a,l])=>{const c={id:l.id,polygonIds:l.polygonIds,group:r.findOne(`#${a}`)};e.polygon.groups.set(a,c)}),i?.destroyChildren(),e.activeTool.value==="polygon"&&e.polygon.mode.value==="edit"&&Kn(e),n.getLayer()?.batchDraw(),e.polygon.serializedState=t,Zt(e),console.log("Polygon state restored from hotreload")}catch(o){console.warn("Failed to deserialize polygon state:",o)}},Wh=(e,t)=>{const n=e.groups.polygonShapes;if(n){if(e.polygon.mode.value==="draw"){if(!e.polygon.isDrawing.value)e.polygon.isDrawing.value=!0,e.polygon.currentPoints.value=[t.x,t.y];else{const i=e.polygon.currentPoints.value[0],r=e.polygon.currentPoints.value[1];Math.sqrt((t.x-i)**2+(t.y-r)**2)<e.polygon.proximityThreshold&&e.polygon.currentPoints.value.length>=6?Va(e):(e.polygon.currentPoints.value.push(t.x,t.y),Qo(e))}Qo(e)}else if(e.polygon.mode.value==="edit"){const i=Array.from(Lt(e).values()).map(r=>{const o=r.konvaShape,s=o?o.getAbsoluteTransform():null,a=[];for(let l=0;l<r.points.length;l+=2)if(s){const c=s.point({x:r.points[l],y:r.points[l+1]});a.push({x:c.x,y:c.y})}else a.push({x:r.points[l],y:r.points[l+1]});return{points:a}});if(i.length>0){const r=Vh(i,t);if(r.polygonIndex>=0&&r.distance<e.polygon.proximityThreshold*2){const o=Array.from(Lt(e).keys())[r.polygonIndex],s=Lt(e).get(o);s&&s.konvaShape&&gn(e,"Add Polygon Point",()=>{const a=s.points,l=(r.lineIndex+1)*2,c=a[r.lineIndex*2],d=a[r.lineIndex*2+1],f=a[(r.lineIndex+1)*2%a.length],g=a[((r.lineIndex+1)*2+1)%a.length],p=(c+f)/2,u=(d+g)/2;s.points.splice(l,0,p,u),s.konvaShape.points(s.points),Kn(e),vn(e),n?.getLayer()?.batchDraw(),Zt(e)})}}}}},Zh=e=>{!e.polygon.isDrawing.value||e.polygon.mode.value!=="draw"||Qo(e)},Kh=e=>{const t=e.groups.polygonPreview,n=e.groups.polygonControls,i=e.stage;if(!t||!i||Lt(e).size===0)return;const r=i.getPointerPosition();if(!r)return;const o=i.getIntersection(r);if(o&&o.getParent()===n){t.destroyChildren(),t.getLayer()?.batchDraw();return}const s=Array.from(Lt(e).values()).map(a=>{const l=a.konvaShape,c=l?l.getAbsoluteTransform():null,d=[];for(let f=0;f<a.points.length;f+=2)if(c){const g=c.point({x:a.points[f],y:a.points[f+1]});d.push({x:g.x,y:g.y})}else d.push({x:a.points[f],y:a.points[f+1]});return{points:d}});if(s.length>0){const a=Vh(s,r);if(t.destroyChildren(),a.polygonIndex>=0&&a.distance<20){const l=Array.from(Lt(e).values())[a.polygonIndex],c=l.points,d=l.konvaShape,f=d?d.getAbsoluteTransform():null,g=c[a.lineIndex*2],p=c[a.lineIndex*2+1],u=c[(a.lineIndex+1)*2%c.length],v=c[((a.lineIndex+1)*2+1)%c.length],b=f?f.point({x:g,y:p}):{x:g,y:p},x=f?f.point({x:u,y:v}):{x:u,y:v},m=(b.x+x.x)/2,h=(b.y+x.y)/2,y=new X.Line({points:[b.x,b.y,x.x,x.y],stroke:"#00ff00",strokeWidth:4,opacity:.8});t.add(y);const S=new X.Circle({x:m,y:h,radius:5,fill:"#00ff00",stroke:"#00aa00",strokeWidth:2,opacity:.9});t.add(S)}t.getLayer()?.batchDraw()}},Qo=e=>{const t=e.groups.polygonPreview,n=e.stage;if(!t||!n)return;if(t.destroyChildren(),e.polygon.currentPoints.value.length<4){if(e.polygon.currentPoints.value.length===2){const s=new X.Circle({x:e.polygon.currentPoints.value[0],y:e.polygon.currentPoints.value[1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});t.add(s)}t.getLayer()?.batchDraw();return}const i=n.getPointerPosition();if(!i)return;for(let s=0;s<e.polygon.currentPoints.value.length;s+=2){const a=new X.Circle({x:e.polygon.currentPoints.value[s],y:e.polygon.currentPoints.value[s+1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});t.add(a)}const r=[...e.polygon.currentPoints.value,i.x,i.y],o=new X.Line({points:r,stroke:"#999",strokeWidth:2,fill:"rgba(153, 153, 153, 0.1)",closed:!1,dash:[5,5],listening:!1});if(t.add(o),e.polygon.currentPoints.value.length>=6){const s=e.polygon.currentPoints.value[0],a=e.polygon.currentPoints.value[1],l=Math.sqrt((i.x-s)**2+(i.y-a)**2),c=new X.Circle({x:s,y:a,radius:e.polygon.proximityThreshold,stroke:l<e.polygon.proximityThreshold?"#00ff00":"#ff0000",strokeWidth:2,fill:"transparent",listening:!1});t.add(c)}t.getLayer()?.batchDraw()},Va=e=>{const t=e.groups.polygonShapes,n=e.groups.polygonPreview;e.polygon.currentPoints.value.length<6||gn(e,"Create Polygon",()=>{const i=`polygon-${Date.now()}`,r={id:i,points:[...e.polygon.currentPoints.value],closed:!0,creationTime:Date.now()},o=new X.Line({points:r.points,stroke:"#000",strokeWidth:2,fill:"rgba(0, 100, 255, 0.1)",closed:!0,draggable:!1,id:i});Xo(e,o),r.konvaShape=o,Lt(e).set(i,r),t?.add(o),ma(e,o),e.polygon.isDrawing.value=!1,e.polygon.currentPoints.value=[],n?.destroyChildren(),Kn(e),vn(e),t?.getLayer()?.batchDraw(),n?.getLayer()?.batchDraw(),Zt(e)})},qh=e=>{const t=e.groups.polygonPreview;e.polygon.isDrawing.value=!1,e.polygon.currentPoints.value=[],t?.destroyChildren(),t?.getLayer()?.batchDraw()},Kn=e=>{const t=e.groups.polygonControls,n=e.groups.polygonShapes;t&&(t.destroyChildren(),e.polygon.mode.value==="edit"&&Lt(e).forEach(i=>{i.controlPoints=[];for(let r=0;r<i.points.length;r+=2){const o=r,s=i.points[o],a=i.points[o+1];let l=s,c=a;if(i.konvaShape){const g=i.konvaShape.getAbsoluteTransform().point({x:s,y:a});l=g.x,c=g.y}const d=new X.Circle({x:l,y:c,radius:6,fill:"#ff6600",stroke:"#ff4400",strokeWidth:2,draggable:!0,id:`${i.id}-control-${o/2}`});d.on("mouseenter",()=>{d.fill("#ffaa00"),d.radius(8),t?.getLayer()?.batchDraw()}),d.on("mouseleave",()=>{d.fill("#ff6600"),d.radius(6),t?.getLayer()?.batchDraw()}),d.on("contextmenu",f=>{f.evt.preventDefault()}),d.on("mousedown",f=>{const g=f.evt;if(g.button===0&&(g.ctrlKey||g.metaKey)){if(g.preventDefault(),i.points.length<=6){Bg(e,"Cannot delete point: polygon must have at least 3 points");return}gn(e,"Delete Polygon Point",()=>{i.points.splice(o,2),i.konvaShape&&(i.konvaShape.points(i.points),n?.getLayer()?.batchDraw()),Kn(e),vn(e),Zt(e)}),f.cancelBubble=!0}}),d.on("dragstart",()=>{$a(e)}),d.on("dragmove",()=>{const f={x:d.x(),y:d.y()};if(i.konvaShape){const g=i.konvaShape.getAbsoluteTransform().copy();g.invert();const p=g.point(f);i.points[o]=p.x,i.points[o+1]=p.y}else i.points[o]=f.x,i.points[o+1]=f.y;i.konvaShape&&(i.konvaShape.points(i.points),n?.getLayer()?.batchDraw())}),d.on("dragend",()=>{Ua(e,"Polygon Control Point"),vn(e)}),i.controlPoints.push(d),t.add(d)}}),t.getLayer()?.batchDraw())},Yh=e=>Ke(()=>e.polygon.mode.value,t=>{const n=e.groups.polygonControls,i=e.groups.polygonPreview;if(e.activeTool.value!=="polygon"){n?.destroyChildren(),n?.getLayer()?.batchDraw();return}Ga(e),t==="draw"?(e.polygon.isDrawing.value=!1,e.polygon.currentPoints.value=[],i?.destroyChildren(),i?.getLayer()?.batchDraw(),Lt(e).forEach(r=>{r.konvaShape?.draggable(!1)})):t==="edit"&&(i?.destroyChildren(),i?.getLayer()?.batchDraw(),Lt(e).forEach(r=>{r.konvaShape?.draggable(!1)})),Kn(e),Ga(e)}),Xh=Object.freeze(Object.defineProperty({__proto__:null,attachPolygonHandlers:Xo,clearCurrentPolygon:qh,clearPolygonSelection:Ga,deserializePolygonState:Jo,finishPolygon:Va,finishPolygonDragTracking:Ua,generateBakedPolygonData:Hh,getCurrentPolygonState:za,getCurrentPolygonStateString:pi,handlePolygonClick:Wh,handlePolygonEditMouseMove:Kh,handlePolygonMouseMove:Zh,initPolygonLayers:Bh,restorePolygonState:jh,serializePolygonState:vn,setupPolygonModeWatcher:Yh,startPolygonDragTracking:$a,updateBakedPolygonData:Zt,updatePolygonControlPoints:Kn,updatePolygonPreview:Qo},Symbol.toStringTag,{value:"Module"})),e4=(e,t)=>{const n=e.layers.drawing,i=e.layers.overlay;if(!n||!i){console.warn("Cannot initialize circle groups without required layers");return}if(!e.groups.circleShapes){const r=new X.Group({name:"circle-shapes"});e.groups.circleShapes=r,n.add(r)}if(!e.groups.circlePreview){const r=new X.Group({name:"circle-preview"});e.groups.circlePreview=r,i.add(r)}},Ba=(e,t)=>{console.log("Attaching circle handlers to:",t.id()),t.draggable(!1)},Jh=e=>Co(e,()=>{const t=e.groups.circleShapes;if(!e.stage||!t)return null;try{const i=t.toObject(),r=Array.from(e.circle.shapes.entries()).map(([s,a])=>[s,{id:a.id,x:a.shape?.x()??a.x,y:a.shape?.y()??a.y,r:a.shape?.radius()??a.r,creationTime:a.creationTime}]);return{layer:i,circles:r}}catch(i){return console.warn("Failed to get current circle state:",i),null}}),Ha=e=>{const t=Jh(e);return JSON.stringify(t)},t4=(e,t)=>{if(t)try{n4(e,t)}catch(n){console.warn("Failed to restore circle state:",n)}},es=e=>{const t=e.groups.circleShapes;if(!(!e.stage||!t))try{const i=Jh(e);if(!i)return;e.circle.serializedState=JSON.stringify(i),e.callbacks.syncAppState?.(e),console.log("Serialized circle state:",{layerChildren:i.layer?.children?.length||0,circles:i.circles.length})}catch(i){console.warn("Failed to serialize circle state:",i)}},n4=(e,t)=>{const n=e.groups.circleShapes,i=e.stage;if(!(!t||!i||!n))try{const r=JSON.parse(t);console.log("Deserializing circle state:",{layerChildren:r.layer?.children?.length||0,circles:r.circles?.length||0}),n.destroyChildren(),e.circle.shapes.clear(),kt(e);const o=r.layer;o&&o.children&&(console.log("Restoring",o.children.length,"circle shapes"),o.children.forEach((a,l)=>{console.log("Creating circle node",l,"of type",a.className);const c=X.Node.create(a);n.add(c),console.log("Added circle node to layer:",c.id(),c.isVisible()),c instanceof X.Group&&Ro(e,c)}));const s=n.find("Circle");e.circle.shapes.clear(),s.forEach(a=>{a.id()||a.id(mn("circle_"));const l={id:a.id(),x:a.x(),y:a.y(),r:a.radius(),creationTime:a.getAttr("creationTime")??Date.now(),shape:a};e.circle.shapes.set(l.id,l),Ba(e,a),ya(e,a)}),n.getLayer()?.batchDraw(),e.circle.serializedState=t,Mr(e),console.log("Circle state restored from hotreload")}catch(r){console.warn("Failed to deserialize circle state:",r)}},i4=(e,t)=>{const n=e.groups.circlePreview;n&&(e.circle.isDrawing.value=!0,e.circle.currentCenter.value=t,e.circle.currentRadius.value=0,n.destroyChildren(),n.getLayer()?.batchDraw())},r4=e=>{const t=e.groups.circlePreview,n=e.stage;if(!e.circle.isDrawing.value||!t||!n)return;const i=n.getPointerPosition();if(!i||!e.circle.currentCenter.value)return;const r=e.circle.currentCenter.value,o=Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2));e.circle.currentRadius.value=o,t.destroyChildren();const s=new X.Circle({x:r.x,y:r.y,radius:o,stroke:"#999",strokeWidth:2,dash:[5,5],listening:!1});t.add(s),t.getLayer()?.batchDraw()},o4=e=>{const t=e.groups.circleShapes,n=e.groups.circlePreview;if(!e.circle.isDrawing.value)return;const i=e.circle.currentCenter.value,r=e.circle.currentRadius.value;e.circle.isDrawing.value=!1,n?.destroyChildren(),n?.getLayer()?.batchDraw(),!(!i||r<2)&&gn(e,"Create Circle",()=>{const o=mn("circle_"),s=Date.now(),a={id:o,x:i.x,y:i.y,r,creationTime:s},l=new X.Circle({x:i.x,y:i.y,radius:r,stroke:"#000",strokeWidth:2,fill:"rgba(0, 100, 255, 0.1)",draggable:!1,id:o});l.setAttr("creationTime",s),Ba(e,l),a.shape=l,ca(e).set(o,a),t?.add(l),ya(e,l),e.circle.currentCenter.value=null,e.circle.currentRadius.value=0,es(e),t?.getLayer()?.batchDraw(),Mr(e)})},s4=e=>{const t=e.groups.circleShapes;if(!t)return{data:[],groupMap:{}};let n=0;const i={},r=s=>{if(s instanceof X.Circle){const a=s.radius(),l=s.getAbsoluteTransform(),c=l.point({x:0,y:0}),d=l.point({x:a,y:0}),f=l.point({x:0,y:a}),g=Math.hypot(d.x-c.x,d.y-c.y),p=Math.hypot(f.x-c.x,f.y-c.y),u=Math.atan2(d.y-c.y,d.x-c.x),v=s.getAttr("metadata"),x=Array.from(e.circle.shapes.values()).find(m=>m.shape===s)?.id||s.id();return v&&v.name&&typeof v.name=="string"&&(i[v.name]||(i[v.name]=[]),i[v.name].push(n)),n++,{type:"circle",id:x,center:{x:c.x,y:c.y},r:Math.abs(g-p)<.001?g:void 0,rx:g,ry:p,rotation:u,...v&&{metadata:v}}}else if(s instanceof X.Group){const a=n;s.getChildren().forEach(f=>{r(f)});const l=s.getAttr("metadata"),c=[];for(let f=a;f<n;f++)c.push(f);const d=l&&l.name&&typeof l.name=="string"?l.name:s.id();return d&&(i[d]=c),null}return null},o=[];return t.getChildren().forEach(s=>{const a=r(s);a&&o.push(a)}),{data:o,groupMap:i}},Mr=e=>{const t=s4(e);e.circle.bakedRenderData=t.data,e.circle.bakedGroupMap=t.groupMap,e.callbacks.syncAppState?.(e)},a4=(e,t)=>{const n=new X.Transformer({rotateEnabled:!0,keepRatio:!1,padding:6});e.layers.transformer=n,n.on("transformstart",()=>{u4(e)});const i=()=>{const r=e.selection.selectedKonvaNodes.value;r.length===1&&Rr(e,r[0])};return n.on("transformend",()=>{d4(e,"Transform"),i()}),n.on("transform",i),n.on("dragmove",i),t.add(n),Ke(e.selection.selectedKonvaNodes,r=>{c4(e,r)},{immediate:!0}),n};function l4(e,t){a4(e,t)}function c4(e,t){const n=e.layers.transformer;if(!n)return;const i=t.filter(r=>!(r instanceof X.Line&&e.polygon.mode.value==="edit"&&e.activeTool.value==="polygon"));n.nodes(i),e.layers.overlay?.batchDraw()}function u4(e){Promise.resolve().then(()=>Uh).then(({getCurrentFreehandStateString:t})=>{Promise.resolve().then(()=>Xh).then(({getCurrentPolygonStateString:n})=>{const i=JSON.stringify({freehand:t(e),polygon:n(e)});e.selection.transformStartState=i})})}function d4(e,t){const n=e.selection.transformStartState;n&&Promise.resolve().then(()=>Uh).then(({getCurrentFreehandStateString:i})=>{Promise.resolve().then(()=>Xh).then(({getCurrentPolygonStateString:r})=>{const o=JSON.stringify({freehand:i(e),polygon:r(e)});n!==o&&xo(e,t,n,o),e.selection.transformStartState=""})})}function h4(e,t){e.groups.selectionOverlay=t;const n=e.stage??t.getStage();if(!e.layers.grid&&n){const i=new X.Layer({listening:!1,name:"grid-layer"});n.add(i),i.moveToBottom(),e.layers.grid=i}e.selection.selectionRect=new X.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),t.add(e.selection.selectionRect)}function f4(e,t,n){const i=t.getPointerPosition();if(!i)return;const r=o=>{let s=o;for(;s&&!(s instanceof X.Stage);){if(s instanceof X.Transformer)return!0;s=s.getParent()}return!1};if(!(n.target&&r(n.target))){if(n.target!==t){let o=n.target,s=xr(e,o);for(;o&&!(o instanceof X.Stage)&&(o=o.getParent(),!(!o||o instanceof X.Stage));){const a=xr(e,o);a&&(s=a)}if(s){const a=gd(e,s);n.evt.shiftKey?n1(e,s,!0):a||(kt(e),Po(e,s,!0)),gd(e,s)&&_4(e,t);return}}(n.target===t||n.target instanceof X.Layer)&&(e.selection.dragSelectionState.value={isSelecting:!0,startPos:{x:i.x,y:i.y},currentPos:{x:i.x,y:i.y},isShiftHeld:n.evt.shiftKey},m4(e,i.x,i.y))}}function p4(e,t,n){if(e.selection.selectionDragState.isDragging){b4(e,t);return}if(!e.selection.dragSelectionState.value.isSelecting)return;const i=t.getPointerPosition();i&&(e.selection.dragSelectionState.value.currentPos={x:i.x,y:i.y},y4(e))}function g4(e,t,n){if(e.selection.selectionDragState.isDragging){S4(e);return}e.selection.dragSelectionState.value.isSelecting&&(v4(e,e.selection.dragSelectionState.value.isShiftHeld),e.selection.dragSelectionState.value.isSelecting=!1)}function m4(e,t,n){e.selection.selectionRect&&e.selection.selectionRect.setAttrs({x:t,y:n,width:0,height:0,visible:!1})}function y4(e){if(!e.selection.selectionRect||!e.selection.dragSelectionState.value.isSelecting)return;const{startPos:t,currentPos:n}=e.selection.dragSelectionState.value,i=Math.min(t.x,n.x),r=Math.min(t.y,n.y),o=Math.abs(n.x-t.x),s=Math.abs(n.y-t.y);e.selection.selectionRect.setAttrs({x:i,y:r,width:o,height:s,visible:o>5||s>5}),e.groups.selectionOverlay?.getLayer()?.batchDraw()}function v4(e,t=!1){if(!e.selection.selectionRect)return;const{startPos:n,currentPos:i}=e.selection.dragSelectionState.value,r=Math.abs(i.x-n.x),o=Math.abs(i.y-n.y);if(!(r>=5||o>=5)){t||kt(e),e.selection.selectionRect.visible(!1),e.groups.selectionOverlay?.getLayer()?.batchDraw();return}const a=[],l=e.selection.selectionRect.getClientRect(),c=u=>u instanceof X.Transformer?!1:u instanceof X.Path||u instanceof X.Line||u instanceof X.Circle||u instanceof X.Group,d=[],f=e.groups.selectionOverlay?.getStage();f&&(e.groups.freehandShape&&d.push(e.groups.freehandShape),e.groups.polygonShapes&&d.push(e.groups.polygonShapes),e.groups.circleShapes&&d.push(e.groups.circleShapes),d.length===0&&f.getLayers().forEach(u=>{u.getChildren().some(b=>c(b))&&d.push(u)}));const g=u=>{const v=u.getClientRect();return!(l.x+l.width<v.x||v.x+v.width<l.x||l.y+l.height<v.y||v.y+v.height<l.y)},p=u=>{if(!c(u)){u instanceof X.Container&&u.getChildren().forEach(b=>p(b));return}const v=xr(e,u);if(v){g(u)&&a.push(v);return}u instanceof X.Container&&u.getChildren().forEach(b=>p(b))};d.forEach(u=>{u.getChildren().forEach(v=>{p(v)})}),t||(kt(e),Oa(e)),a.forEach(u=>Po(e,u,!0)),e.selection.selectionRect.setAttrs({x:0,y:0,width:0,height:0,visible:!1}),e.groups.selectionOverlay?.getLayer()?.batchDraw()}function _4(e,t){const n=t.getPointerPosition();if(!n)return;e.selection.selectionDragState.isDragging=!0,e.selection.selectionDragState.startPos={x:n.x,y:n.y},e.selection.selectionDragState.startNodePositions.clear(),e.selection.selectionDragState.beforeState=JSON.stringify({freehand:On(e),polygon:pi(e),circle:Ha(e)}),e.selection.selectedKonvaNodes.value.forEach(r=>{const o=r.getAbsolutePosition();e.selection.selectionDragState.startNodePositions.set(r,{x:o.x,y:o.y})})}function b4(e,t){const n=t.getPointerPosition();if(!n)return;const i=n.x-e.selection.selectionDragState.startPos.x,r=n.y-e.selection.selectionDragState.startPos.y;e.selection.selectionDragState.startNodePositions.forEach((a,l)=>{l.absolutePosition({x:a.x+i,y:a.y+r})});const o=new Set;e.selection.selectionDragState.startNodePositions.forEach((a,l)=>{let c=l.getParent();for(;c&&!(c instanceof X.Layer);)c=c.getParent();c instanceof X.Layer&&o.add(c)}),o.forEach(a=>a.batchDraw());const s=e.selection.selectedKonvaNodes.value;s.length===1&&Rr(e,s[0])}function S4(e){const t=JSON.stringify({freehand:On(e),polygon:pi(e),circle:Ha(e)});e.selection.selectionDragState.beforeState!==t&&xo(e,"Move Selection",e.selection.selectionDragState.beforeState,t),e.selection.selectionDragState.isDragging=!1,e.selection.selectionDragState.startNodePositions.clear();const n=e.selection.selectedKonvaNodes.value;n.length===1?Rr(e,n[0]):Rr(e,void 0)}function Qh(e){return e.selection.selectedKonvaNodes.value}function ef(e){let t=e;for(;t&&!(t instanceof X.Layer);)t=t.getParent();return t instanceof X.Layer?t:null}function tf(e,t){const n=e.getAbsoluteTransform().copy();e.moveTo(t);const i=t.getAbsoluteTransform().copy();i.invert();const o=i.multiply(n).decompose();e.setAttrs({x:o.x,y:o.y,scaleX:o.scaleX,scaleY:o.scaleY,rotation:o.rotation,skewX:o.skewX,skewY:o.skewY})}function nf(e){const t=Qh(e);if(t.length<1||t.some(r=>r instanceof X.Line)||new Set(t.map(r=>ef(r))).size!==1)return!1;const i=t.filter(r=>r instanceof X.Path||r instanceof X.Circle||r instanceof X.Group);return!(i.length<1||r1(i))}function w4(e){if(!nf(e))return;const t=e.selection.selectedKonvaNodes.value.filter(n=>n instanceof X.Path||n instanceof X.Circle||n instanceof X.Group);t.length<1||gn(e,"Group Selection",()=>{const n=t.filter(a=>!t.some(l=>l!==a&&l.isAncestorOf(a))),i=ef(n[0]);if(!i)return;let r=n[0].getParent();n.every(a=>a.getParent()===r)||(r=i);const o=new X.Group({draggable:!1});r.add(o),n.forEach(a=>{tf(a,o)});const s=Ro(e,o);kt(e),Po(e,s),o.getLayer()?.batchDraw(),Wt(e)})}function rf(e){const t=Qh(e);return t.length!==1||t[0]instanceof X.Line?!1:t[0]instanceof X.Group}function x4(e){if(!rf(e))return;const t=e.selection.selectedKonvaNodes.value[0],n=t.getParent();n&&gn(e,"Ungroup Selection",()=>{[...t.getChildren()].forEach(o=>{tf(o,n),o.draggable(!1)});const r=t.id();t.destroy(),_d(e,r),kt(e),n.getLayer()?.batchDraw();try{Ia(e)}catch{console.error("refreshStrokeConnections failed")}Wt(e)})}function of(e){const t=e.selection.selectedKonvaNodes.value;return t.filter(n=>!t.some(i=>i!==n&&i.isAncestorOf(n)))}function C4(e){const t=e.groups.freehandShape;e.selection.selectedKonvaNodes.value.length!==0&&gn(e,"Duplicate",()=>{Co(e,()=>{const i=of(e),r=[];i.forEach(o=>{if(o instanceof X.Path||o instanceof X.Group){const s=Dh(e,o,50,50),a=o.getParent();a&&a.add(s),r.push(s)}else if(o instanceof X.Line){const s=o.clone({x:o.x()+50,y:o.y()+50}),a=mn("poly_");s.id(a);const l=o.getParent();l&&l.add(s),ma(e,s),Xo(e,s),Lt(e).set(a,{id:a,points:[...s.points()],closed:!!s.closed(),creationTime:Date.now(),konvaShape:s}),r.push(s)}else if(o instanceof X.Circle){const s=o.clone({x:o.x()+50,y:o.y()+50}),a=mn("circle_"),l=Date.now();s.id(a),s.setAttr("creationTime",l);const c=o.getParent();c&&c.add(s),ya(e,s),Ba(e,s),ca(e).set(a,{id:a,x:s.x(),y:s.y(),r:s.radius(),creationTime:l,shape:s}),r.push(s)}}),kt(e),r.forEach(o=>{const s=xr(e,o);s&&Po(e,s,!0)}),Yo(e),t?.getLayer()?.batchDraw(),e.groups.polygonShapes?.getLayer()?.batchDraw(),e.groups.circleShapes?.getLayer()?.batchDraw(),Wt(e),Zt(e),Mr(e),vn(e),es(e)})})}function k4(e){const t=e.groups.freehandShape;e.selection.selectedKonvaNodes.value.length!==0&&gn(e,"Delete Selected",()=>{of(e).forEach(r=>{const o=[],s=a=>{o.push(a),a instanceof X.Container&&a.getChildren().forEach(l=>s(l))};s(r),o.forEach(a=>{a instanceof X.Path&&(Ct(e).delete(a.id()),Array.from(Ct(e).entries()).forEach(([l,c])=>{c.shape===a&&Ct(e).delete(l)}),Array.from(la(e).values()).forEach(l=>{l.strokeIds=l.strokeIds.filter(c=>c!==a.id())})),a instanceof X.Group&&la(e).delete(a.id()),a instanceof X.Line&&Lt(e).delete(a.id()),a instanceof X.Circle&&ca(e).delete(a.id()),_d(e,a.id())}),r.destroy()}),kt(e),t?.getLayer()?.batchDraw(),e.groups.polygonShapes?.getLayer()?.batchDraw(),e.groups.circleShapes?.getLayer()?.batchDraw(),Wt(e),Zt(e),Mr(e),vn(e),es(e),Promise.resolve().then(()=>_5).then(({refreshAnciliaryViz:r})=>r(e)).catch(()=>{})})}const ja=e=>{if(!e)return null;try{return JSON.parse(e)}catch(t){return console.warn("Failed to parse state string:",t),null}},P4=e=>{if(!e||typeof e!="object")return{};if("freehand"in e||"polygon"in e||"circle"in e){const t={};return e.freehand!==void 0&&(t.freehand=typeof e.freehand=="string"?e.freehand:JSON.stringify(e.freehand)),e.polygon!==void 0&&(t.polygon=typeof e.polygon=="string"?e.polygon:JSON.stringify(e.polygon)),e.circle!==void 0&&(t.circle=typeof e.circle=="string"?e.circle:JSON.stringify(e.circle)),t}return"layer"in e&&(e.strokes||e.strokeGroups)?{freehand:JSON.stringify(e)}:"layer"in e&&(e.polygons||e.polygonGroups)?{polygon:JSON.stringify(e)}:"layer"in e&&e.circles?{circle:JSON.stringify(e)}:{}},sf=e=>{const t=On(e),n=pi(e),i=Ha(e),r=ja(t),o=ja(n),s=ja(i);return JSON.stringify({version:1,freehand:r,polygon:o,circle:s})},af=(e,t,n={})=>{if(!t)return!1;let i;try{i=JSON.parse(t)}catch(a){return console.warn("Failed to parse canvas state JSON:",a),!1}const{freehand:r,polygon:o,circle:s}=P4(i);return!r&&!o&&!s?(console.warn("Canvas state payload missing freehand, polygon, and circle data"),!1):(r&&Gh(e,r,{handleTimeUpdate:n.handleTimeUpdate}),o&&jh(e,o),s&&t4(e,s),!0)},T4=(e,t)=>{const n=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i)},A4=e=>{const t=sf(e);if(!t){console.warn("No canvas state available to download");return}let n=t;try{n=JSON.stringify(JSON.parse(t),null,2)}catch(r){console.warn("Failed to pretty-print canvas state JSON:",r)}const i=new Date().toISOString().slice(0,16).replace(/:/g,"-");T4(n,`canvas_state_${i}.json`)},E4=(e,t={})=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=async i=>{const r=i.target.files?.[0];if(r)try{const o=await r.text();if(!af(e,o,t)){alert("Invalid canvas state file. Please upload a valid JSON export.");return}console.log("Canvas state restored from file:",r.name)}catch(o){console.error("Failed to restore canvas state from file:",o),alert("Failed to load canvas state. Please check the console for details.")}},n.click()},R4={class:"canvas-root"},D4={class:"control-panel"},M4=["disabled"],O4={class:"button-group vertical"},N4=["disabled"],F4=["disabled"],I4=["disabled"],L4={class:"button-group vertical"},G4=["disabled"],z4=["disabled"],$4={class:"button-group vertical"},U4=["disabled"],V4=["disabled"],B4={class:"button-group vertical"},H4=["disabled"],j4=["disabled"],W4=["disabled"],Z4=["disabled"],K4=["disabled"],q4={class:"radio-button-group"},Y4=["disabled"],X4=["disabled"],J4={class:"button-group vertical"},Q4=["disabled"],e3=["disabled"],t3={key:0,class:"info"},n3={key:0,class:"info"},i3={class:"info"},r3={class:"canvas-wrapper"},o3={key:0,class:"panels-container"},s3={key:1,class:"metadata-suite"},a3={key:0,class:"animation-lock-warning"},l3={key:0,class:"notification-toast"},c3=20,u3=Mn(cn({__name:"CanvasRoot",props:{syncState:{type:Function},initialFreehandState:{default:"",type:String},initialPolygonState:{default:"",type:String},width:{default:1e3,type:[Number,String]},height:{default:500,type:[Number,String]},showTimeline:{type:Boolean,default:!1},showVisualizations:{type:Boolean,default:!1},showSnapshots:{type:Boolean,default:!1},showRescale:{type:Boolean,default:!1},metadataSchemas:{default:()=>[],type:Array},wsAddress:{type:String}},emits:["state-update"],setup(e,{expose:t,emit:n}){const i=e,r=qr({width:void 0,height:void 0,showTimeline:void 0,showVisualizations:void 0,showSnapshots:void 0,showRescale:void 0}),o=Se(()=>r.width??i.width),s=Se(()=>r.height??i.height),a=Se(()=>r.showTimeline??i.showTimeline),l=Se(()=>r.showVisualizations??i.showVisualizations),c=Se(()=>r.showSnapshots??i.showSnapshots),d=Se(()=>r.showRescale??i.showRescale),f=Tl(null),g=n,p=Se(()=>{const oe=Number(o.value),q=Number(s.value);return{width:Number.isFinite(oe)?oe:1e3,height:Number.isFinite(q)?q:500}}),u=Vg();u.metadataSchemas=i.metadataSchemas;const v=X5(u);let b;const x=u.activeTool,m=u.metadata.showEditor,h=u.snapshots.showPanel,y=u.snapshots.items,S=u.snapshots.selectedId,E=ye(!1),D=oe=>oe==null?oe:typeof structuredClone=="function"?structuredClone(oe):JSON.parse(JSON.stringify(oe)),C=oe=>oe?D(Te(oe))??[]:[],w=oe=>oe?D(Te(oe))??[]:[],k=oe=>oe?D(Te(oe))??{}:{},T=ye(null),R=()=>({freehand:{serializedState:"",bakedRenderData:[],bakedGroupMap:{}},polygon:{serializedState:"",bakedRenderData:[]},circle:{serializedState:"",bakedRenderData:[],bakedGroupMap:{}}}),L=oe=>{const q=C(oe.freehand.bakedRenderData),Ce=k(oe.freehand.bakedGroupMap),Xe=w(oe.polygon.bakedRenderData),Ie=D(Te(oe.circle.bakedRenderData))??[],ft=k(oe.circle.bakedGroupMap);return{freehand:{serializedState:oe.freehand.serializedState??"",bakedRenderData:q??[],bakedGroupMap:Ce??{}},polygon:{serializedState:oe.polygon.serializedState??"",bakedRenderData:Xe??[]},circle:{serializedState:oe.circle.serializedState??"",bakedRenderData:Ie??[],bakedGroupMap:ft??{}}}},U=(oe,q)=>{const Ce=R(),Xe=R(),Ie=R(),ft=["freehand.bakedRenderData","polygon.bakedRenderData","circle.bakedRenderData"],dt=(je,pt,de)=>{pt==="freehand.bakedRenderData"?je.freehand.bakedRenderData.push(de):pt==="polygon.bakedRenderData"?je.polygon.bakedRenderData.push(de):pt==="circle.bakedRenderData"&&je.circle.bakedRenderData.push(de)},ot=je=>je==="freehand.bakedRenderData"?q.freehand.bakedRenderData:je==="polygon.bakedRenderData"?q.polygon.bakedRenderData:q.circle.bakedRenderData,en=(je,pt="")=>{const de=pt?`${pt}.${je.key}`:je.key;if(ft.includes(de)&&je.changes){const Re=de,it=ot(Re);for(const Ve of je.changes)if(Ve.type==="ADD"){const yt=Ve.value??Ve.oldValue;yt&&dt(Ce,Re,yt)}else if(Ve.type==="REMOVE"){const yt=Ve.value??Ve.oldValue;yt&&dt(Xe,Re,yt)}else if(Ve.type==="UPDATE"){const yt=Ve.key,tn=it.find(nn=>nn.id===yt);tn&&dt(Ie,Re,tn)}}else if(je.changes)for(const Re of je.changes)en(Re,de)};for(const je of oe)en(je);return{added:Ce,deleted:Xe,changed:Ie}},z=oe=>{const q=L(oe),Ce={embeddedObjKeys:{"freehand.bakedRenderData":"id","freehand.bakedRenderData.children":"id","polygon.bakedRenderData":"id","circle.bakedRenderData":"id"}},Xe=T.value,Ie=Xe?Wg(Xe,q,Ce):[],{added:ft,deleted:dt,changed:ot}=Xe?U(Ie,q):{added:R(),deleted:R(),changed:R()};return T.value=D(q),{...q,added:ft,deleted:dt,changed:ot}},Z=oe=>{const q=z(oe);i.syncState?.(q),g("state-update",q),f.value?.isConnected&&f.value.sendStateUpdate(q)};u.callbacks.syncAppState=Z,Ke(()=>i.syncState,()=>{Z(u)},{immediate:!0});const _=oe=>h4(u,oe),P=(oe,q)=>f4(u,oe,q),N=(oe,q)=>p4(u,oe),O=(oe,q)=>g4(u),G=()=>w4(u),H=()=>x4(u),V=()=>C4(u),te=()=>k4(u),se=Se(()=>nf(u)),F=Se(()=>rf(u)),A=(oe,q)=>$h(u,oe,q),$=()=>Yo(u),j=()=>Oa(u),ee=oe=>La(u,oe),fe=()=>A4(u),M=()=>E4(u,{handleTimeUpdate:ee}),I=()=>Kn(u),B=oe=>Wh(u,oe),W=()=>Zh(u),J=()=>Kh(u),K=()=>Va(u),ie=()=>qh(u),ae=()=>Yh(u),re=oe=>i4(u,oe),ne=()=>r4(u),he=()=>o4(u),ce=u.selection.selectedKonvaNodes,ge=Se(()=>yd(u)),ve=Se(()=>To(u)>1),be=Se(()=>{const oe=ce.value;return oe.length===1&&oe[0]instanceof X.Group});u.callbacks.refreshAncillaryViz=()=>Zn(u);const ke=()=>sf(u),xe=oe=>{if(!oe)return;af(u,oe,{handleTimeUpdate:ee})||console.warn("Failed to restore canvas state: invalid payload")},Ge=ye(!1),Me=ye(!1),Ue=()=>{Wt(u),Zt(u),Mr(u),Zn(u),Ge.value=He.canUndo(),Me.value=He.canRedo()},He=new Ug(ke,xe,Ue);u.command.stack=He,Ge.value=He.canUndo(),Me.value=He.canRedo();const Ot=(oe,q)=>He.executeCommand(oe,q),Qt=()=>He.undo(),ut=()=>He.redo();u.command.executeCommand=Ot,u.command.pushCommand=(oe,q,Ce)=>{He.pushCommand(oe,q,Ce)};const Tt=()=>{const oe=u.stage;if(!oe)return;const q=1920/1280,Ce=1080/720,Xe=Ie=>{Ie&&(Ie.x(Ie.x()*q),Ie.y(Ie.y()*Ce),Ie.scaleX(Ie.scaleX()*q),Ie.scaleY(Ie.scaleY()*Ce))};Ot("Rescale 720p  1080p",()=>{Xe(u.groups.freehandShape),Xe(u.groups.polygonShapes),Xe(u.groups.circleShapes),u.layers.transformer?.forceUpdate(),v.updateMetadataHighlight(yd(u)??void 0),oe.batchDraw()})},ts=oe=>{u.freehand.isAnimating.value=oe;const q=u.stage;q&&(oe?q.listening(!1):q.listening(!0))};t({canvasState:u});const ns=()=>{const oe=u.stage,q=u.layers.grid;if(!oe||!q)return;const Ce=!!u.grid.visible.value;if(q.visible(Ce),q.destroyChildren(),!Ce){q.batchDraw();return}const Xe=u.grid.size,Ie=Number.isFinite(Xe)&&Xe>0?Xe:c3,ft=5,dt=oe.width(),ot=oe.height(),en=Math.ceil(dt/Ie),je=Math.ceil(ot/Ie),pt=(de,Re)=>{q.add(new X.Line({points:de,stroke:Re?"rgba(0, 0, 0, 0.2)":"rgba(0, 0, 0, 0.08)",strokeWidth:Re?1:.5,listening:!1}))};for(let de=0;de<=en;de++){const Re=Math.min(de*Ie,dt),it=de%ft===0;pt([Re,0,Re,ot],it)}for(let de=0;de<=je;de++){const Re=Math.min(de*Ie,ot),it=de%ft===0;pt([0,Re,dt,Re],it)}q.batchDraw()},_n=ye(),Wa=(oe,q)=>{const Ce=oe.groups.freehandShape,Xe=oe.groups.freehandDrawing,Ie=oe.groups.selectionOverlay,ft=oe.groups.polygonShapes,dt=oe.groups.polygonPreview,ot=oe.groups.polygonControls,en=oe.groups.polygonSelection,je=oe.groups.circleShapes,pt=oe.groups.circlePreview,de=oe.stage;kt(oe),q==="select"?(Ce?.listening(!0),ft?.listening(!0),je?.listening(!0),Xe?.listening(!1),dt?.listening(!1),ot?.listening(!1),pt?.listening(!1),Ie?.listening(!0),en?.listening(!0),oe.layers.overlay?.moveToTop(),de&&Rh(u,de).moveToTop()):q==="freehand"?(Ce?.listening(!0),Xe?.listening(!0),Ie?.listening(!0),ft?.listening(!1),dt?.listening(!1),ot?.listening(!1),en?.listening(!1),je?.listening(!1),pt?.listening(!1)):q==="polygon"?(ft?.listening(!0),dt?.listening(!0),ot?.listening(!0),en?.listening(!0),Ce?.listening(!1),Xe?.listening(!1),Ie?.listening(!1),je?.listening(!1),pt?.listening(!1)):q==="circle"&&(je?.listening(!0),pt?.listening(!0),Ce?.listening(!1),Xe?.listening(!1),Ie?.listening(!1),ft?.listening(!1),dt?.listening(!1),ot?.listening(!1),en?.listening(!1)),q==="polygon"&&oe.polygon.mode.value==="edit"?I():(ot?.destroyChildren(),ot?.getLayer()?.batchDraw()),(it=>{Ce?.getChildren().forEach(Ve=>{(Ve instanceof X.Path||Ve instanceof X.Group)&&Ve.draggable(it)}),ft?.getChildren().forEach(Ve=>{(Ve instanceof X.Line||Ve instanceof X.Group)&&Ve.draggable(it)})})(!1),de?.batchDraw()};Ke(x,oe=>{Wa(u,oe)},{immediate:!0});const d3=(oe,q)=>{try{const Ce=xr(u,oe);Ce?i1(u,Ce,q):(oe.setAttr("metadata",q===void 0||Object.keys(q).length===0?void 0:q),Wt(u),Zt(u))}catch{oe.setAttr("metadata",q===void 0||Object.keys(q).length===0?void 0:q),Wt(u),Zt(u)}};return oo(async()=>{try{if(!_n.value){console.error("Konva container ref not found");return}const oe=p.value,q=new X.Stage({container:_n.value,width:oe.width,height:oe.height});u.stage=q,u.konvaContainer=_n.value;const Ce=q.getPointerPosition.bind(q);q.getPointerPosition=function(){const de=Ce();if(!de)return null;const Re=this.container(),it=Re.clientWidth,Ve=Re.clientHeight,yt=this.width(),tn=this.height();return{x:de.x*(yt/it),y:de.y*(tn/Ve)}},_n.value.addEventListener("contextmenu",de=>{(de.ctrlKey||de.metaKey)&&de.preventDefault()});const Xe=()=>{_n.value&&(_n.value.style.cursor=x.value==="freehand"?"crosshair":"default")};u.callbacks.updateCursor=Xe,u.callbacks.updateCursor?.();const Ie=new X.Layer({listening:!1,name:"grid-layer"}),ft=new X.Layer({name:"drawing-layer"}),dt=new X.Layer({name:"overlay-layer"});q.add(Ie),q.add(ft),q.add(dt),Ie.moveToBottom(),u.layers.grid=Ie,u.layers.drawing=ft,u.layers.overlay=dt,Mh(u,q),Bh(u,q),e4(u,q);const ot=new X.Group({name:"selection-overlay"});dt.add(ot),_(ot),l4(u,ot),ns(),Rh(u,q).moveToTop(),wh(u),Wa(u,x.value),x.value==="polygon"&&u.polygon.mode.value==="edit"&&I(),u.callbacks.updateCursor?.();const je=de=>{!de||de===u.freehand.serializedState||qo(u,de)},pt=de=>{!de||de===u.polygon.serializedState||Jo(u,de)};je(i.initialFreehandState),pt(i.initialPolygonState),Ke(()=>i.initialFreehandState,de=>{je(de)}),Ke(()=>i.initialPolygonState,de=>{pt(de)}),Ke(()=>u.grid.visible.value,()=>{ns()},{immediate:!0}),Ke(()=>u.layers.grid,()=>{ns()},{immediate:!0}),Ke(()=>[o.value,s.value],([de,Re])=>{const it=Number(de),Ve=Number(Re),yt=Number.isFinite(it)?it:p.value.width,tn=Number.isFinite(Ve)?Ve:p.value.height,nn=u.stage;nn&&(nn.width(yt),nn.height(tn),nn.batchDraw()),u.konvaContainer&&(u.konvaContainer.style.width=`${yt}px`,u.konvaContainer.style.height=`${tn}px`),ns()},{immediate:!0}),Wa(u,x.value),Z(u),q.on("mousedown touchstart",de=>{const Re=q.getPointerPosition();Re&&(x.value==="select"?P(q,de):x.value==="freehand"?(u.freehand.isDrawing=!0,u.freehand.currentPoints=[Re.x,Re.y],u.freehand.drawingStartTime=performance.now(),u.freehand.currentTimestamps=[0],kt(u)):x.value==="polygon"?de.target.getParent?.()===u.groups.polygonControls||B(Re):x.value==="circle"&&(re(Re),kt(u)))}),q.on("mousemove touchmove",de=>{const Re=u.groups.freehandDrawing;if(x.value==="select")N(q,de);else if(x.value==="freehand"){if(u.freehand.isDrawing){const it=q.getPointerPosition();if(!it)return;u.freehand.currentPoints.push(it.x,it.y),u.freehand.currentTimestamps.push(performance.now()-u.freehand.drawingStartTime),Re?.destroyChildren();const Ve=new X.Path({data:Dr(u.freehand.currentPoints),fill:"#666",strokeWidth:0});Re?.add(Ve),Re?.getLayer()?.batchDraw()}}else x.value==="polygon"?u.polygon.mode.value==="draw"&&u.polygon.isDrawing.value?W():u.polygon.mode.value==="edit"&&J():x.value==="circle"&&u.circle.isDrawing.value&&ne()}),q.on("mouseup touchend",de=>{const Re=u.groups.freehandDrawing;x.value==="freehand"&&u.freehand.isDrawing?(u.freehand.isDrawing=!1,Re?.destroyChildren(),u.freehand.currentPoints.length>2&&Ot("Draw Stroke",()=>{const it=u.groups.freehandShape,Ve=Date.now(),yt=`stroke-${Ve}`,tn=Ao(u.freehand.currentPoints),nn=[];for(let is=0;is<u.freehand.currentPoints.length;is+=2)nn.push(u.freehand.currentPoints[is]-tn.minX),nn.push(u.freehand.currentPoints[is+1]-tn.minY);const h3=Dr(nn),uf={id:yt,points:u.freehand.currentPoints,timestamps:u.freehand.currentTimestamps,originalPath:h3,creationTime:Ve,isFreehand:!0},df=A(u.freehand.currentPoints,yt);uf.shape=df,Ct(u).set(yt,uf),it?.add(df),$(),j(),it?.getLayer()?.batchDraw(),Wt(u)}),u.freehand.currentPoints=[],u.freehand.currentTimestamps=[]):x.value==="circle"&&u.circle.isDrawing.value?he():O(q,de)}),ae(),_n.value?.focus(),b=Vv(u,"c",()=>{x.value==="polygon"&&u.polygon.isDrawing.value&&(u.polygon.currentPoints.value.length>=6?K():ie())},_n.value),i.wsAddress&&(f.value=new Uv(i.wsAddress),f.value.setHandlers({onSetCanvasState:de=>{xe(de)},onSetFreehandState:de=>{de&&de!==u.freehand.serializedState&&qo(u,de)},onSetPolygonState:de=>{de&&de!==u.polygon.serializedState&&Jo(u,de)},onUndo:()=>Qt(),onRedo:()=>ut(),onGetCanvasState:de=>{const Re=ke();f.value?.sendCanvasStateResponse(Re,de)},onSetConfig:de=>{de.width!==void 0&&(r.width=de.width),de.height!==void 0&&(r.height=de.height),de.showTimeline!==void 0&&(r.showTimeline=de.showTimeline),de.showVisualizations!==void 0&&(r.showVisualizations=de.showVisualizations),de.showSnapshots!==void 0&&(r.showSnapshots=de.showSnapshots),de.showRescale!==void 0&&(r.showRescale=de.showRescale)},onSetTool:de=>{x.value=de}}),f.value.connect())}catch(oe){console.warn(oe)}}),Ti(()=>{console.log("disposing livecoded resources"),zh(u),vn(u),es(u),b?.(),b=void 0,u.keyboardDisposables.splice(0).forEach(oe=>oe()),f.value?.disconnect(),u.stage?.destroy()}),(oe,q)=>(le(),ue("div",R4,[Q("div",D4,[As(Q("select",{"onUpdate:modelValue":q[0]||(q[0]=Ce=>st(x)?x.value=Ce:null),disabled:pe(u).freehand.isAnimating.value,class:"tool-dropdown"},q[10]||(q[10]=[Q("option",{value:"select"}," Select",-1),Q("option",{value:"freehand"}," Freehand",-1),Q("option",{value:"polygon"}," Polygon",-1),Q("option",{value:"circle"}," Circle",-1)]),8,M4),[[W0,pe(x)]]),q[18]||(q[18]=Q("span",{class:"separator"},"|",-1)),Q("div",O4,[Q("button",{onClick:Qt,disabled:!Ge.value||pe(u).freehand.isAnimating.value,title:"Undo (Ctrl/Cmd+Z)"},"  Undo ",8,N4),Q("button",{onClick:ut,disabled:!Me.value||pe(u).freehand.isAnimating.value,title:"Redo (Ctrl/Cmd+Shift+Z)"},"  Redo ",8,F4)]),q[19]||(q[19]=Q("span",{class:"separator"},"|",-1)),Q("button",{onClick:q[1]||(q[1]=Ce=>pe(u).grid.visible.value=!pe(u).grid.visible.value),class:$t({active:pe(u).grid.visible.value}),disabled:pe(u).freehand.isAnimating.value},Le(pe(u).grid.visible.value?" Grid On":" Grid Off"),11,I4),q[20]||(q[20]=Q("span",{class:"separator"},"|",-1)),Q("div",L4,[Q("button",{onClick:fe,disabled:pe(u).freehand.isAnimating.value},"  Download ",8,G4),Q("button",{onClick:M,disabled:pe(u).freehand.isAnimating.value},"  Upload ",8,z4)]),q[21]||(q[21]=Q("span",{class:"separator"},"|",-1)),q[22]||(q[22]=Q("span",{class:"flex-break","aria-hidden":"true"},null,-1)),pe(x)==="select"?(le(),ue(De,{key:0},[Q("div",$4,[Q("button",{onClick:G,disabled:!se.value||pe(u).freehand.isAnimating.value}," Group ",8,U4),Q("button",{onClick:H,disabled:!F.value||pe(u).freehand.isAnimating.value}," Ungroup ",8,V4)]),q[11]||(q[11]=Q("span",{class:"separator"},"|",-1)),Q("div",B4,[Q("button",{onClick:V,disabled:To(pe(u))===0||pe(u).freehand.isAnimating.value},"  Duplicate ",8,H4),Q("button",{onClick:te,disabled:To(pe(u))===0||pe(u).freehand.isAnimating.value},"  Delete ",8,j4)]),q[12]||(q[12]=Q("span",{class:"separator"},"|",-1)),Q("button",{onClick:q[2]||(q[2]=Ce=>m.value=!pe(m)),class:$t({active:pe(m)}),disabled:pe(u).freehand.isAnimating.value},"  Metadata ",10,W4),d.value?(le(),ue("button",{key:0,onClick:Tt,disabled:pe(u).freehand.isAnimating.value},"  7201080 ",8,Z4)):Oe("",!0),c.value?(le(),ue("button",{key:1,onClick:q[3]||(q[3]=Ce=>h.value=!pe(h)),class:$t({active:pe(h)}),disabled:pe(u).freehand.isAnimating.value},"  Snapshots ",10,K4)):Oe("",!0),q[13]||(q[13]=Q("span",{class:"separator"},"|",-1))],64)):Oe("",!0),pe(x)==="freehand"?(le(),ue(De,{key:1},[a.value?(le(),ue("button",{key:0,onClick:q[4]||(q[4]=Ce=>pe(u).freehand.useRealTiming.value=!pe(u).freehand.useRealTiming.value),class:$t({active:pe(u).freehand.useRealTiming.value})},Le(pe(u).freehand.useRealTiming.value?" Real Time":" Max 0.3s"),3)):Oe("",!0)],64)):Oe("",!0),pe(x)==="polygon"?(le(),ue(De,{key:2},[Q("div",q4,[Q("button",{onClick:q[5]||(q[5]=Ce=>pe(u).polygon.mode.value="draw"),class:$t([{active:pe(u).polygon.mode.value==="draw"},"radio-button"]),disabled:pe(u).freehand.isAnimating.value},q[14]||(q[14]=[Q("span",{class:"radio-indicator"},null,-1),ho("  New Shape ")]),10,Y4),Q("button",{onClick:q[6]||(q[6]=Ce=>pe(u).polygon.mode.value="edit"),class:$t([{active:pe(u).polygon.mode.value==="edit"},"radio-button"]),disabled:pe(u).freehand.isAnimating.value},q[15]||(q[15]=[Q("span",{class:"radio-indicator"},null,-1),ho("  Edit Shape ")]),10,X4)]),q[16]||(q[16]=Q("span",{class:"separator"},"|",-1)),Q("div",J4,[Q("button",{onClick:K,disabled:!pe(u).polygon.isDrawing.value||pe(u).freehand.isAnimating.value},"  End Shape (c) ",8,Q4),Q("button",{onClick:ie,disabled:!pe(u).polygon.isDrawing.value||pe(u).freehand.isAnimating.value},"  Cancel Shape ",8,e3)]),q[17]||(q[17]=Q("span",{class:"separator"},"|",-1)),pe(u).polygon.isDrawing.value?(le(),ue("span",t3,"Drawing: "+Le(pe(u).polygon.currentPoints.value.length/2)+" points",1)):Oe("",!0)],64)):Oe("",!0),pe(x)==="circle"?(le(),ue(De,{key:3},[pe(u).circle.isDrawing.value?(le(),ue("span",n3,"Radius: "+Le(Math.round(pe(u).circle.currentRadius.value))+"px",1)):Oe("",!0)],64)):Oe("",!0),q[23]||(q[23]=Q("span",{class:"separator"},"|",-1)),Q("span",i3,Le(To(pe(u)))+" selected",1)]),Q("div",r3,[Qe(I5,{modelValue:E.value,"onUpdate:modelValue":q[7]||(q[7]=Ce=>E.value=Ce),title:"Canvas",width:p.value.width,height:p.value.height},{default:Ts(()=>[Q("div",{ref_key:"konvaContainer",ref:_n,class:"konva-container",tabindex:"0",style:Nn({width:E.value?"100%":p.value.width+"px",height:E.value?"100%":p.value.height+"px"})},null,4)]),_:1},8,["modelValue","width","height"]),pe(m)||pe(h)?(le(),ue("div",o3,[pe(h)?(le(),ri(O5,{key:0,snapshots:pe(y),"selected-id":pe(S),"on-save-snapshot":ke,"on-restore-snapshot":xe,"execute-command":Ot,"onUpdate:snapshots":q[8]||(q[8]=Ce=>y.value=Ce),"onUpdate:selectedId":q[9]||(q[9]=Ce=>S.value=Ce)},null,8,["snapshots","selected-id"])):Oe("",!0),pe(m)?(le(),ue("div",s3,[l.value?(le(),ri(x5,{key:0,"canvas-state":pe(u)},null,8,["canvas-state"])):Oe("",!0),Qe(f5,{"selected-nodes":pe(ce),"single-node":ge.value,"multi-selected":ve.value,"group-selected":be.value,"collect-hierarchy-from-root":pe(v).collectHierarchyFromRoot,"update-metadata-highlight":pe(v).updateMetadataHighlight,"update-hover-highlight":pe(v).updateHoverHighlight,"on-apply-metadata":d3,"schema-options":i.metadataSchemas},null,8,["selected-nodes","single-node","multi-selected","group-selected","collect-hierarchy-from-root","update-metadata-highlight","update-hover-highlight","schema-options"])])):Oe("",!0)])):Oe("",!0),a.value?(le(),ue(De,{key:1},[Qe(Jv,{strokes:pe(Ct)(pe(u)),selectedStrokes:pe(u).freehand.selectedStrokesForTimeline.value,useRealTiming:pe(u).freehand.useRealTiming.value,maxInterStrokeDelay:pe(Ko),overrideDuration:pe(u).freehand.timelineDuration.value>0?pe(u).freehand.timelineDuration.value:void 0,lockWhileAnimating:ts,onTimeUpdate:ee},null,8,["strokes","selectedStrokes","useRealTiming","maxInterStrokeDelay","overrideDuration"]),pe(u).freehand.isAnimating.value?(le(),ue("div",a3,"  Timeline has modified elements - press Stop to unlock ")):Oe("",!0)],64)):Oe("",!0)]),Qe(w0,{name:"notification"},{default:Ts(()=>[pe(u).notification.visible.value?(le(),ue("div",l3,Le(pe(u).notification.message.value),1)):Oe("",!0)]),_:1})]))}}),[["styles",['.canvas-root[data-v-1a156704]{position:relative;display:flex;flex-direction:column;align-items:center;gap:20px;padding:20px}.notification-toast[data-v-1a156704]{position:fixed;bottom:30px;left:50%;transform:translate(-50%);background:#333;color:#fff;padding:12px 24px;border-radius:6px;font-size:14px;box-shadow:0 4px 12px #0000004d;z-index:10000;max-width:500px;text-align:center}.notification-enter-active[data-v-1a156704],.notification-leave-active[data-v-1a156704]{transition:all .3s ease}.notification-enter-from[data-v-1a156704]{opacity:0;transform:translate(-50%) translateY(20px)}.notification-leave-to[data-v-1a156704]{opacity:0;transform:translate(-50%) translateY(-20px)}.control-panel[data-v-1a156704]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:10px 15px;display:flex;flex-wrap:wrap;align-items:center;gap:10px;box-shadow:0 2px 10px #0000001a}.canvas-wrapper[data-v-1a156704]{display:flex;flex-direction:column;align-items:center;gap:20px}.control-panel button[data-v-1a156704]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 15px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-1a156704]:hover:not(:disabled){background:#e0e0e0}.control-panel button.active[data-v-1a156704]{background:#06f;color:#fff;border-color:#06f}.control-panel button[data-v-1a156704]:disabled{opacity:.5;cursor:not-allowed}.button-group.vertical[data-v-1a156704]{display:flex;flex-direction:column;gap:2px}.button-group.vertical button[data-v-1a156704]{margin:0;padding:3px 10px;font-size:12px}.radio-button-group[data-v-1a156704]{display:flex;flex-direction:column;gap:4px}.radio-button[data-v-1a156704]{display:flex;align-items:center;gap:6px;padding:4px 10px!important;font-size:13px!important;background:#fff!important;border:1px solid #ccc!important;text-align:left}.radio-button[data-v-1a156704]:hover:not(:disabled){background:#f5f5f5!important;border-color:#999!important}.radio-button.active[data-v-1a156704]{background:#e8f0fe!important;border-color:#06f!important;color:inherit!important}.radio-button.active .radio-indicator[data-v-1a156704]{border-color:#06f;background:#06f}.radio-button.active .radio-indicator[data-v-1a156704]:after{opacity:1}.radio-indicator[data-v-1a156704]{display:inline-block;width:14px;height:14px;border:2px solid #999;border-radius:50%;background:#fff;position:relative;flex-shrink:0;transition:all .2s}.radio-indicator[data-v-1a156704]:after{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:6px;height:6px;border-radius:50%;background:#fff;opacity:0;transition:opacity .2s}.tool-dropdown[data-v-1a156704]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 10px;font-size:14px;cursor:pointer;transition:all .2s}.tool-dropdown[data-v-1a156704]:hover{background:#e0e0e0}.tool-dropdown[data-v-1a156704]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-1a156704]{color:#ccc}.flex-break[data-v-1a156704]{display:none;flex-basis:100%;height:0}@media (max-width: 1100px){.control-panel .flex-break[data-v-1a156704]{display:block}}.info[data-v-1a156704]{color:#666;font-size:14px}.animation-lock-warning[data-v-1a156704]{color:#e67e22;font-size:14px;font-weight:700;text-align:center;background:#fef5e7;border:1px solid #f39c12;border-radius:4px;padding:8px 15px;animation:pulse-1a156704 2s infinite}@keyframes pulse-1a156704{0%,to{opacity:1}50%{opacity:.6}}.konva-container[data-v-1a156704]{background-color:#fff;border:1px solid black}.konva-container[data-v-1a156704] .konvajs-content,.konva-container[data-v-1a156704] canvas{width:100%!important;height:100%!important}.panels-container[data-v-1a156704]{display:flex;flex-direction:row;gap:12px;align-items:flex-start}.metadata-suite[data-v-1a156704]{display:flex;flex-direction:column;gap:8px;max-width:600px;width:500px}']],["__scopeId","data-v-1a156704"]]),lf="handwriting-canvas",cf=B0(u3);return customElements.get(lf)||customElements.define(lf,cf),rs.CanvasElement=cf,Object.defineProperty(rs,Symbol.toStringTag,{value:"Module"}),rs}({});
