var HandwritingCanvas=function(Ci){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function _r(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Pt={},Xe=[],pe=()=>{},jc=()=>!1,Pi=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),vr=t=>t.startsWith("onUpdate:"),Ot=Object.assign,br=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},qc=Object.prototype.hasOwnProperty,St=(t,e)=>qc.call(t,e),ut=Array.isArray,Je=t=>gn(t)==="[object Map]",Ti=t=>gn(t)==="[object Set]",zs=t=>gn(t)==="[object Date]",gt=t=>typeof t=="function",Et=t=>typeof t=="string",me=t=>typeof t=="symbol",Rt=t=>t!==null&&typeof t=="object",Ws=t=>(Rt(t)||gt(t))&&gt(t.then)&&gt(t.catch),$s=Object.prototype.toString,gn=t=>$s.call(t),Kc=t=>gn(t).slice(8,-1),ki=t=>gn(t)==="[object Object]",Sr=t=>Et(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,pn=_r(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ai=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Yc=/-(\w)/g,ce=Ai(t=>t.replace(Yc,(e,n)=>n?n.toUpperCase():"")),Xc=/\B([A-Z])/g,ee=Ai(t=>t.replace(Xc,"-$1").toLowerCase()),js=Ai(t=>t.charAt(0).toUpperCase()+t.slice(1)),xr=Ai(t=>t?`on${js(t)}`:""),Fe=(t,e)=>!Object.is(t,e),Ri=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},qs=(t,e,n,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:n})},Ei=t=>{const e=parseFloat(t);return isNaN(e)?t:e},Ks=t=>{const e=Et(t)?Number(t):NaN;return isNaN(e)?t:e};let Ys;const Xs=()=>Ys||(Ys=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ie(t){if(ut(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],s=Et(i)?th(i):Ie(i);if(s)for(const r in s)e[r]=s[r]}return e}else if(Et(t)||Rt(t))return t}const Jc=/;(?![^(]*\))/g,Qc=/:([^]+)/,Zc=/\/\*[^]*?\*\//g;function th(t){const e={};return t.replace(Zc,"").split(Jc).forEach(n=>{if(n){const i=n.split(Qc);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function he(t){let e="";if(Et(t))e=t;else if(ut(t))for(let n=0;n<t.length;n++){const i=he(t[n]);i&&(e+=i+" ")}else if(Rt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const eh=_r("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Js(t){return!!t||t===""}function nh(t,e){if(t.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<t.length;i++)n=Mi(t[i],e[i]);return n}function Mi(t,e){if(t===e)return!0;let n=zs(t),i=zs(e);if(n||i)return n&&i?t.getTime()===e.getTime():!1;if(n=me(t),i=me(e),n||i)return t===e;if(n=ut(t),i=ut(e),n||i)return n&&i?nh(t,e):!1;if(n=Rt(t),i=Rt(e),n||i){if(!n||!i)return!1;const s=Object.keys(t).length,r=Object.keys(e).length;if(s!==r)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Mi(t[o],e[o]))return!1}}return String(t)===String(e)}function ih(t,e){return t.findIndex(n=>Mi(n,e))}const Qs=t=>!!(t&&t.__v_isRef===!0),Yt=t=>Et(t)?t:t==null?"":ut(t)||Rt(t)&&(t.toString===$s||!gt(t.toString))?Qs(t)?Yt(t.value):JSON.stringify(t,Zs,2):String(t),Zs=(t,e)=>Qs(e)?Zs(t,e.value):Je(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,s],r)=>(n[wr(i,r)+" =>"]=s,n),{})}:Ti(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>wr(n))}:me(e)?wr(e):Rt(e)&&!ut(e)&&!ki(e)?String(e):e,wr=(t,e="")=>{var n;return me(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Xt;class rh{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Xt,!e&&Xt&&(this.index=(Xt.scopes||(Xt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Xt;try{return Xt=this,e()}finally{Xt=n}}}on(){Xt=this}off(){Xt=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function sh(){return Xt}let kt;const Cr=new WeakSet;class to{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Xt&&Xt.active&&Xt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Cr.has(this)&&(Cr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||no(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ao(this),io(this);const e=kt,n=de;kt=this,de=!0;try{return this.fn()}finally{ro(this),kt=e,de=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Ar(e);this.deps=this.depsTail=void 0,ao(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Cr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){kr(this)&&this.run()}get dirty(){return kr(this)}}let eo=0,mn,yn;function no(t,e=!1){if(t.flags|=8,e){t.next=yn,yn=t;return}t.next=mn,mn=t}function Pr(){eo++}function Tr(){if(--eo>0)return;if(yn){let e=yn;for(yn=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;mn;){let e=mn;for(mn=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){t||(t=i)}e=n}}if(t)throw t}function io(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function ro(t){let e,n=t.depsTail,i=n;for(;i;){const s=i.prevDep;i.version===-1?(i===n&&(n=s),Ar(i),oh(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}t.deps=e,t.depsTail=n}function kr(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(so(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function so(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===_n))return;t.globalVersion=_n;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!kr(t)){t.flags&=-3;return}const n=kt,i=de;kt=t,de=!0;try{io(t);const s=t.fn(t._value);(e.version===0||Fe(s,t._value))&&(t._value=s,e.version++)}catch(s){throw e.version++,s}finally{kt=n,de=i,ro(t),t.flags&=-3}}function Ar(t,e=!1){const{dep:n,prevSub:i,nextSub:s}=t;if(i&&(i.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=i,t.nextSub=void 0),n.subs===t&&(n.subs=i),!n.subs&&n.computed){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)Ar(r,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function oh(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let de=!0;const oo=[];function xe(){oo.push(de),de=!1}function we(){const t=oo.pop();de=t===void 0?!0:t}function ao(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=kt;kt=void 0;try{e()}finally{kt=n}}}let _n=0;class ah{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Rr{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!kt||!de||kt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==kt)n=this.activeLink=new ah(kt,this),kt.deps?(n.prevDep=kt.depsTail,kt.depsTail.nextDep=n,kt.depsTail=n):kt.deps=kt.depsTail=n,lo(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=kt.depsTail,n.nextDep=void 0,kt.depsTail.nextDep=n,kt.depsTail=n,kt.deps===n&&(kt.deps=i)}return n}trigger(e){this.version++,_n++,this.notify(e)}notify(e){Pr();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Tr()}}}function lo(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)lo(i)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Er=new WeakMap,Ue=Symbol(""),Mr=Symbol(""),vn=Symbol("");function Ut(t,e,n){if(de&&kt){let i=Er.get(t);i||Er.set(t,i=new Map);let s=i.get(n);s||(i.set(n,s=new Rr),s.map=i,s.key=n),s.track()}}function Ce(t,e,n,i,s,r){const o=Er.get(t);if(!o){_n++;return}const a=l=>{l&&l.trigger()};if(Pr(),e==="clear")o.forEach(a);else{const l=ut(t),c=l&&Sr(n);if(l&&n==="length"){const h=Number(i);o.forEach((p,f)=>{(f==="length"||f===vn||!me(f)&&f>=h)&&a(p)})}else switch(n!==void 0&&a(o.get(n)),c&&a(o.get(vn)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Ue)),Je(t)&&a(o.get(Mr)));break;case"delete":l||(a(o.get(Ue)),Je(t)&&a(o.get(Mr)));break;case"set":Je(t)&&a(o.get(Ue));break}}Tr()}function Qe(t){const e=bt(t);return e===t?e:(Ut(e,"iterate",vn),ne(t)?e:e.map(Bt))}function Fi(t){return Ut(t=bt(t),"iterate",vn),t}const lh={__proto__:null,[Symbol.iterator](){return Fr(this,Symbol.iterator,Bt)},concat(...t){return Qe(this).concat(...t.map(e=>ut(e)?Qe(e):e))},entries(){return Fr(this,"entries",t=>(t[1]=Bt(t[1]),t))},every(t,e){return Pe(this,"every",t,e,void 0,arguments)},filter(t,e){return Pe(this,"filter",t,e,n=>n.map(Bt),arguments)},find(t,e){return Pe(this,"find",t,e,Bt,arguments)},findIndex(t,e){return Pe(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Pe(this,"findLast",t,e,Bt,arguments)},findLastIndex(t,e){return Pe(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Pe(this,"forEach",t,e,void 0,arguments)},includes(...t){return Dr(this,"includes",t)},indexOf(...t){return Dr(this,"indexOf",t)},join(t){return Qe(this).join(t)},lastIndexOf(...t){return Dr(this,"lastIndexOf",t)},map(t,e){return Pe(this,"map",t,e,void 0,arguments)},pop(){return bn(this,"pop")},push(...t){return bn(this,"push",t)},reduce(t,...e){return co(this,"reduce",t,e)},reduceRight(t,...e){return co(this,"reduceRight",t,e)},shift(){return bn(this,"shift")},some(t,e){return Pe(this,"some",t,e,void 0,arguments)},splice(...t){return bn(this,"splice",t)},toReversed(){return Qe(this).toReversed()},toSorted(t){return Qe(this).toSorted(t)},toSpliced(...t){return Qe(this).toSpliced(...t)},unshift(...t){return bn(this,"unshift",t)},values(){return Fr(this,"values",Bt)}};function Fr(t,e,n){const i=Fi(t),s=i[e]();return i!==t&&!ne(t)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.value&&(r.value=n(r.value)),r}),s}const ch=Array.prototype;function Pe(t,e,n,i,s,r){const o=Fi(t),a=o!==t&&!ne(t),l=o[e];if(l!==ch[e]){const p=l.apply(t,r);return a?Bt(p):p}let c=n;o!==t&&(a?c=function(p,f){return n.call(this,Bt(p),f,t)}:n.length>2&&(c=function(p,f){return n.call(this,p,f,t)}));const h=l.call(o,c,i);return a&&s?s(h):h}function co(t,e,n,i){const s=Fi(t);let r=n;return s!==t&&(ne(t)?n.length>3&&(r=function(o,a,l){return n.call(this,o,a,l,t)}):r=function(o,a,l){return n.call(this,o,Bt(a),l,t)}),s[e](r,...i)}function Dr(t,e,n){const i=bt(t);Ut(i,"iterate",vn);const s=i[e](...n);return(s===-1||s===!1)&&Lr(n[0])?(n[0]=bt(n[0]),i[e](...n)):s}function bn(t,e,n=[]){xe(),Pr();const i=bt(t)[e].apply(t,n);return Tr(),we(),i}const hh=_r("__proto__,__v_isRef,__isVue"),ho=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(me));function dh(t){me(t)||(t=String(t));const e=bt(this);return Ut(e,"has",t),e.hasOwnProperty(t)}class uo{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,i){const s=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return r;if(n==="__v_raw")return i===(s?r?xo:So:r?bo:vo).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=ut(e);if(!s){let l;if(o&&(l=lh[n]))return l;if(n==="hasOwnProperty")return dh}const a=Reflect.get(e,n,Lt(e)?e:i);return(me(n)?ho.has(n):hh(n))||(s||Ut(e,"get",n),r)?a:Lt(a)?o&&Sr(n)?a:a.value:Rt(a)?s?Co(a):Or(a):a}}class fo extends uo{constructor(e=!1){super(!1,e)}set(e,n,i,s){let r=e[n];if(!this._isShallow){const l=Be(r);if(!ne(i)&&!Be(i)&&(r=bt(r),i=bt(i)),!ut(e)&&Lt(r)&&!Lt(i))return l?!1:(r.value=i,!0)}const o=ut(e)&&Sr(n)?Number(n)<e.length:St(e,n),a=Reflect.set(e,n,i,Lt(e)?e:s);return e===bt(s)&&(o?Fe(i,r)&&Ce(e,"set",n,i):Ce(e,"add",n,i)),a}deleteProperty(e,n){const i=St(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&i&&Ce(e,"delete",n,void 0),s}has(e,n){const i=Reflect.has(e,n);return(!me(n)||!ho.has(n))&&Ut(e,"has",n),i}ownKeys(e){return Ut(e,"iterate",ut(e)?"length":Ue),Reflect.ownKeys(e)}}class go extends uo{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const uh=new fo,fh=new go,gh=new fo(!0),ph=new go(!0),Nr=t=>t,Di=t=>Reflect.getPrototypeOf(t);function Ni(t,e,n=!1,i=!1){t=t.__v_raw;const s=bt(t),r=bt(e);n||(Fe(e,r)&&Ut(s,"get",e),Ut(s,"get",r));const{has:o}=Di(s),a=i?Nr:n?Gr:Bt;if(o.call(s,e))return a(t.get(e));if(o.call(s,r))return a(t.get(r));t!==s&&t.get(e)}function Oi(t,e=!1){const n=this.__v_raw,i=bt(n),s=bt(t);return e||(Fe(t,s)&&Ut(i,"has",t),Ut(i,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function Li(t,e=!1){return t=t.__v_raw,!e&&Ut(bt(t),"iterate",Ue),Reflect.get(t,"size",t)}function po(t,e=!1){!e&&!ne(t)&&!Be(t)&&(t=bt(t));const n=bt(this);return Di(n).has.call(n,t)||(n.add(t),Ce(n,"add",t,t)),this}function mo(t,e,n=!1){!n&&!ne(e)&&!Be(e)&&(e=bt(e));const i=bt(this),{has:s,get:r}=Di(i);let o=s.call(i,t);o||(t=bt(t),o=s.call(i,t));const a=r.call(i,t);return i.set(t,e),o?Fe(e,a)&&Ce(i,"set",t,e):Ce(i,"add",t,e),this}function yo(t){const e=bt(this),{has:n,get:i}=Di(e);let s=n.call(e,t);s||(t=bt(t),s=n.call(e,t)),i&&i.call(e,t);const r=e.delete(t);return s&&Ce(e,"delete",t,void 0),r}function _o(){const t=bt(this),e=t.size!==0,n=t.clear();return e&&Ce(t,"clear",void 0,void 0),n}function Gi(t,e){return function(i,s){const r=this,o=r.__v_raw,a=bt(o),l=e?Nr:t?Gr:Bt;return!t&&Ut(a,"iterate",Ue),o.forEach((c,h)=>i.call(s,l(c),l(h),r))}}function Ii(t,e,n){return function(...i){const s=this.__v_raw,r=bt(s),o=Je(r),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=s[t](...i),h=n?Nr:e?Gr:Bt;return!e&&Ut(r,"iterate",l?Mr:Ue),{next(){const{value:p,done:f}=c.next();return f?{value:p,done:f}:{value:a?[h(p[0]),h(p[1])]:h(p),done:f}},[Symbol.iterator](){return this}}}}function De(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function mh(){const t={get(r){return Ni(this,r)},get size(){return Li(this)},has:Oi,add:po,set:mo,delete:yo,clear:_o,forEach:Gi(!1,!1)},e={get(r){return Ni(this,r,!1,!0)},get size(){return Li(this)},has:Oi,add(r){return po.call(this,r,!0)},set(r,o){return mo.call(this,r,o,!0)},delete:yo,clear:_o,forEach:Gi(!1,!0)},n={get(r){return Ni(this,r,!0)},get size(){return Li(this,!0)},has(r){return Oi.call(this,r,!0)},add:De("add"),set:De("set"),delete:De("delete"),clear:De("clear"),forEach:Gi(!0,!1)},i={get(r){return Ni(this,r,!0,!0)},get size(){return Li(this,!0)},has(r){return Oi.call(this,r,!0)},add:De("add"),set:De("set"),delete:De("delete"),clear:De("clear"),forEach:Gi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=Ii(r,!1,!1),n[r]=Ii(r,!0,!1),e[r]=Ii(r,!1,!0),i[r]=Ii(r,!0,!0)}),[t,n,e,i]}const[yh,_h,vh,bh]=mh();function Ui(t,e){const n=e?t?bh:vh:t?_h:yh;return(i,s,r)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?i:Reflect.get(St(n,s)&&s in i?n:i,s,r)}const Sh={get:Ui(!1,!1)},xh={get:Ui(!1,!0)},wh={get:Ui(!0,!1)},Ch={get:Ui(!0,!0)},vo=new WeakMap,bo=new WeakMap,So=new WeakMap,xo=new WeakMap;function Ph(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Th(t){return t.__v_skip||!Object.isExtensible(t)?0:Ph(Kc(t))}function Or(t){return Be(t)?t:Bi(t,!1,uh,Sh,vo)}function wo(t){return Bi(t,!1,gh,xh,bo)}function Co(t){return Bi(t,!0,fh,wh,So)}function Ng(t){return Bi(t,!0,ph,Ch,xo)}function Bi(t,e,n,i,s){if(!Rt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=s.get(t);if(r)return r;const o=Th(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return s.set(t,a),a}function Ze(t){return Be(t)?Ze(t.__v_raw):!!(t&&t.__v_isReactive)}function Be(t){return!!(t&&t.__v_isReadonly)}function ne(t){return!!(t&&t.__v_isShallow)}function Lr(t){return t?!!t.__v_raw:!1}function bt(t){const e=t&&t.__v_raw;return e?bt(e):t}function kh(t){return!St(t,"__v_skip")&&Object.isExtensible(t)&&qs(t,"__v_skip",!0),t}const Bt=t=>Rt(t)?Or(t):t,Gr=t=>Rt(t)?Co(t):t;function Lt(t){return t?t.__v_isRef===!0:!1}function Tt(t){return Po(t,!1)}function Ah(t){return Po(t,!0)}function Po(t,e){return Lt(t)?t:new Rh(t,e)}class Rh{constructor(e,n){this.dep=new Rr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:bt(e),this._value=n?e:Bt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,i=this.__v_isShallow||ne(e)||Be(e);e=i?e:bt(e),Fe(e,n)&&(this._rawValue=e,this._value=i?e:Bt(e),this.dep.trigger())}}function lt(t){return Lt(t)?t.value:t}const Eh={get:(t,e,n)=>e==="__v_raw"?t:lt(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const s=t[e];return Lt(s)&&!Lt(n)?(s.value=n,!0):Reflect.set(t,e,n,i)}};function To(t){return Ze(t)?t:new Proxy(t,Eh)}class Mh{constructor(e,n,i){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Rr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=_n-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&kt!==this)return no(this,!0),!0}get value(){const e=this.dep.track();return so(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Fh(t,e,n=!1){let i,s;return gt(t)?i=t:(i=t.get,s=t.set),new Mh(i,s,n)}const Hi={},Vi=new WeakMap;let He;function Dh(t,e=!1,n=He){if(n){let i=Vi.get(n);i||Vi.set(n,i=[]),i.push(t)}}function Nh(t,e,n=Pt){const{immediate:i,deep:s,once:r,scheduler:o,augmentJob:a,call:l}=n,c=y=>s?y:ne(y)||s===!1||s===0?Te(y,1):Te(y);let h,p,f,u,m=!1,_=!1;if(Lt(t)?(p=()=>t.value,m=ne(t)):Ze(t)?(p=()=>c(t),m=!0):ut(t)?(_=!0,m=t.some(y=>Ze(y)||ne(y)),p=()=>t.map(y=>{if(Lt(y))return y.value;if(Ze(y))return c(y);if(gt(y))return l?l(y,2):y()})):gt(t)?e?p=l?()=>l(t,2):t:p=()=>{if(f){xe();try{f()}finally{we()}}const y=He;He=h;try{return l?l(t,3,[u]):t(u)}finally{He=y}}:p=pe,e&&s){const y=p,b=s===!0?1/0:s;p=()=>Te(y(),b)}const S=sh(),C=()=>{h.stop(),S&&br(S.effects,h)};if(r&&e){const y=e;e=(...b)=>{y(...b),C()}}let g=_?new Array(t.length).fill(Hi):Hi;const d=y=>{if(!(!(h.flags&1)||!h.dirty&&!y))if(e){const b=h.run();if(s||m||(_?b.some((k,D)=>Fe(k,g[D])):Fe(b,g))){f&&f();const k=He;He=h;try{const D=[b,g===Hi?void 0:_&&g[0]===Hi?[]:g,u];l?l(e,3,D):e(...D),g=b}finally{He=k}}}else h.run()};return a&&a(d),h=new to(p),h.scheduler=o?()=>o(d,!1):d,u=y=>Dh(y,!1,h),f=h.onStop=()=>{const y=Vi.get(h);if(y){if(l)l(y,4);else for(const b of y)b();Vi.delete(h)}},e?i?d(!0):g=h.run():o?o(d.bind(null,!0),!0):h.run(),C.pause=h.pause.bind(h),C.resume=h.resume.bind(h),C.stop=C,C}function Te(t,e=1/0,n){if(e<=0||!Rt(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,Lt(t))Te(t.value,e,n);else if(ut(t))for(let i=0;i<t.length;i++)Te(t[i],e,n);else if(Ti(t)||Je(t))t.forEach(i=>{Te(i,e,n)});else if(ki(t)){for(const i in t)Te(t[i],e,n);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&Te(t[i],e,n)}return t}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Sn=[];let Ir=!1;function Og(t,...e){if(Ir)return;Ir=!0,xe();const n=Sn.length?Sn[Sn.length-1].component:null,i=n&&n.appContext.config.warnHandler,s=Oh();if(i)tn(i,n,11,[t+e.map(r=>{var o,a;return(a=(o=r.toString)==null?void 0:o.call(r))!=null?a:JSON.stringify(r)}).join(""),n&&n.proxy,s.map(({vnode:r})=>`at <${Sa(n,r.type)}>`).join(`
`),s]);else{const r=[`[Vue warn]: ${t}`,...e];s.length&&r.push(`
`,...Lh(s)),console.warn(...r)}we(),Ir=!1}function Oh(){let t=Sn[Sn.length-1];if(!t)return[];const e=[];for(;t;){const n=e[0];n&&n.vnode===t?n.recurseCount++:e.push({vnode:t,recurseCount:0});const i=t.component&&t.component.parent;t=i&&i.vnode}return e}function Lh(t){const e=[];return t.forEach((n,i)=>{e.push(...i===0?[]:[`
`],...Gh(n))}),e}function Gh({vnode:t,recurseCount:e}){const n=e>0?`... (${e} recursive calls)`:"",i=t.component?t.component.parent==null:!1,s=` at <${Sa(t.component,t.type,i)}`,r=">"+n;return t.props?[s,...Ih(t.props),r]:[s+r]}function Ih(t){const e=[],n=Object.keys(t);return n.slice(0,3).forEach(i=>{e.push(...ko(i,t[i]))}),n.length>3&&e.push(" ..."),e}function ko(t,e,n){return Et(e)?(e=JSON.stringify(e),n?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?n?e:[`${t}=${e}`]:Lt(e)?(e=ko(t,bt(e.value),!0),n?e:[`${t}=Ref<`,e,">"]):gt(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=bt(e),n?e:[`${t}=`,e])}function tn(t,e,n,i){try{return i?t(...i):t()}catch(s){zi(s,e,n)}}function ye(t,e,n,i){if(gt(t)){const s=tn(t,e,n,i);return s&&Ws(s)&&s.catch(r=>{zi(r,e,n)}),s}if(ut(t)){const s=[];for(let r=0;r<t.length;r++)s.push(ye(t[r],e,n,i));return s}}function zi(t,e,n,i=!0){const s=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Pt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let p=0;p<h.length;p++)if(h[p](t,l,c)===!1)return}a=a.parent}if(r){xe(),tn(r,null,10,[t,l,c]),we();return}}Uh(t,n,s,i,o)}function Uh(t,e,n,i=!0,s=!1){if(s)throw t;console.error(t)}const Ht=[];let _e=-1;const en=[];let Ne=null,nn=0;const Ao=Promise.resolve();let Wi=null;function Ur(t){const e=Wi||Ao;return t?e.then(this?t.bind(this):t):e}function Bh(t){let e=_e+1,n=Ht.length;for(;e<n;){const i=e+n>>>1,s=Ht[i],r=xn(s);r<t||r===t&&s.flags&2?e=i+1:n=i}return e}function Br(t){if(!(t.flags&1)){const e=xn(t),n=Ht[Ht.length-1];!n||!(t.flags&2)&&e>=xn(n)?Ht.push(t):Ht.splice(Bh(e),0,t),t.flags|=1,Ro()}}function Ro(){Wi||(Wi=Ao.then(Fo))}function Hh(t){ut(t)?en.push(...t):Ne&&t.id===-1?Ne.splice(nn+1,0,t):t.flags&1||(en.push(t),t.flags|=1),Ro()}function Eo(t,e,n=_e+1){for(;n<Ht.length;n++){const i=Ht[n];if(i&&i.flags&2){if(t&&i.id!==t.uid)continue;Ht.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Mo(t){if(en.length){const e=[...new Set(en)].sort((n,i)=>xn(n)-xn(i));if(en.length=0,Ne){Ne.push(...e);return}for(Ne=e,nn=0;nn<Ne.length;nn++){const n=Ne[nn];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Ne=null,nn=0}}const xn=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Fo(t){try{for(_e=0;_e<Ht.length;_e++){const e=Ht[_e];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),tn(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;_e<Ht.length;_e++){const e=Ht[_e];e&&(e.flags&=-2)}_e=-1,Ht.length=0,Mo(),Wi=null,(Ht.length||en.length)&&Fo()}}let ie=null,Do=null;function $i(t){const e=ie;return ie=t,Do=t&&t.type.__scopeId||null,e}function Vh(t,e=ie,n){if(!e||t._n)return t;const i=(...s)=>{i._d&&ua(-1);const r=$i(e);let o;try{o=t(...s)}finally{$i(r),i._d&&ua(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function No(t,e){if(ie===null)return t;const n=tr(ie),i=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[r,o,a,l=Pt]=e[s];r&&(gt(r)&&(r={mounted:r,updated:r}),r.deep&&Te(o),i.push({dir:r,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function Ve(t,e,n,i){const s=t.dirs,r=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];r&&(a.oldValue=r[o].value);let l=a.dir[i];l&&(xe(),ye(l,n,8,[t.el,a,t,e]),we())}}const zh=Symbol("_vte"),Wh=t=>t.__isTeleport;function Hr(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Hr(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function rn(t,e){return gt(t)?Ot({name:t.name},e,{setup:t}):t}function Oo(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Vr(t,e,n,i,s=!1){if(ut(t)){t.forEach((m,_)=>Vr(m,e&&(ut(e)?e[_]:e),n,i,s));return}if(wn(i)&&!s)return;const r=i.shapeFlag&4?tr(i.component):i.el,o=s?null:r,{i:a,r:l}=t,c=e&&e.r,h=a.refs===Pt?a.refs={}:a.refs,p=a.setupState,f=bt(p),u=p===Pt?()=>!1:m=>St(f,m);if(c!=null&&c!==l&&(Et(c)?(h[c]=null,u(c)&&(p[c]=null)):Lt(c)&&(c.value=null)),gt(l))tn(l,a,12,[o,h]);else{const m=Et(l),_=Lt(l);if(m||_){const S=()=>{if(t.f){const C=m?u(l)?p[l]:h[l]:l.value;s?ut(C)&&br(C,r):ut(C)?C.includes(r)||C.push(r):m?(h[l]=[r],u(l)&&(p[l]=h[l])):(l.value=[r],t.k&&(h[t.k]=l.value))}else m?(h[l]=o,u(l)&&(p[l]=o)):_&&(l.value=o,t.k&&(h[t.k]=o))};o?(S.id=-1,Jt(S,n)):S()}}}const wn=t=>!!t.type.__asyncLoader,Lo=t=>t.type.__isKeepAlive;function $h(t,e){Go(t,"a",e)}function jh(t,e){Go(t,"da",e)}function Go(t,e,n=zt){const i=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(ji(e,i,n),n){let s=n.parent;for(;s&&s.parent;)Lo(s.parent.vnode)&&qh(i,e,n,s),s=s.parent}}function qh(t,e,n,i){const s=ji(e,t,i,!0);Cn(()=>{br(i[e],s)},n)}function ji(t,e,n=zt,i=!1){if(n){const s=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{xe();const a=En(n),l=ye(e,n,t,o);return a(),we(),l});return i?s.unshift(r):s.push(r),r}}const ke=t=>(e,n=zt)=>{(!Zi||t==="sp")&&ji(t,(...i)=>e(...i),n)},Kh=ke("bm"),Io=ke("m"),Yh=ke("bu"),Xh=ke("u"),Jh=ke("bum"),Cn=ke("um"),Qh=ke("sp"),Zh=ke("rtg"),td=ke("rtc");function ed(t,e=zt){ji("ec",t,e)}const nd=Symbol.for("v-ndc");function Uo(t,e,n,i){let s;const r=n,o=ut(t);if(o||Et(t)){const a=o&&Ze(t);let l=!1;a&&(l=!ne(t),t=Fi(t)),s=new Array(t.length);for(let c=0,h=t.length;c<h;c++)s[c]=e(l?Bt(t[c]):t[c],c,void 0,r)}else if(typeof t=="number"){s=new Array(t);for(let a=0;a<t;a++)s[a]=e(a+1,a,void 0,r)}else if(Rt(t))if(t[Symbol.iterator])s=Array.from(t,(a,l)=>e(a,l,void 0,r));else{const a=Object.keys(t);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];s[l]=e(t[h],h,l,r)}}else s=[];return s}const zr=t=>t?_a(t)?tr(t):zr(t.parent):null,Pn=Ot(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>zr(t.parent),$root:t=>zr(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>zo(t),$forceUpdate:t=>t.f||(t.f=()=>{Br(t.update)}),$nextTick:t=>t.n||(t.n=Ur.bind(t.proxy)),$watch:t=>Cd.bind(t)}),Wr=(t,e)=>t!==Pt&&!t.__isScriptSetup&&St(t,e),id={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:i,data:s,props:r,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const u=o[e];if(u!==void 0)switch(u){case 1:return i[e];case 2:return s[e];case 4:return n[e];case 3:return r[e]}else{if(Wr(i,e))return o[e]=1,i[e];if(s!==Pt&&St(s,e))return o[e]=2,s[e];if((c=t.propsOptions[0])&&St(c,e))return o[e]=3,r[e];if(n!==Pt&&St(n,e))return o[e]=4,n[e];$r&&(o[e]=0)}}const h=Pn[e];let p,f;if(h)return e==="$attrs"&&Ut(t.attrs,"get",""),h(t);if((p=a.__cssModules)&&(p=p[e]))return p;if(n!==Pt&&St(n,e))return o[e]=4,n[e];if(f=l.config.globalProperties,St(f,e))return f[e]},set({_:t},e,n){const{data:i,setupState:s,ctx:r}=t;return Wr(s,e)?(s[e]=n,!0):i!==Pt&&St(i,e)?(i[e]=n,!0):St(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:s,propsOptions:r}},o){let a;return!!n[o]||t!==Pt&&St(t,o)||Wr(e,o)||(a=r[0])&&St(a,o)||St(i,o)||St(Pn,o)||St(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:St(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Bo(t){return ut(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let $r=!0;function rd(t){const e=zo(t),n=t.proxy,i=t.ctx;$r=!1,e.beforeCreate&&Ho(e.beforeCreate,t,"bc");const{data:s,computed:r,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:p,mounted:f,beforeUpdate:u,updated:m,activated:_,deactivated:S,beforeDestroy:C,beforeUnmount:g,destroyed:d,unmounted:y,render:b,renderTracked:k,renderTriggered:D,errorCaptured:x,serverPrefetch:w,expose:T,inheritAttrs:M,components:L,directives:B,filters:V}=e;if(c&&sd(c,i,null),o)for(const v in o){const P=o[v];gt(P)&&(i[v]=P.bind(n))}if(s){const v=s.call(n,n);Rt(v)&&(t.data=Or(v))}if($r=!0,r)for(const v in r){const P=r[v],E=gt(P)?P.bind(n,n):gt(P.get)?P.get.bind(n,n):pe,A=!gt(P)&&gt(P.set)?P.set.bind(n):pe,O=Dt({get:E,set:A});Object.defineProperty(i,v,{enumerable:!0,configurable:!0,get:()=>O.value,set:j=>O.value=j})}if(a)for(const v in a)Vo(a[v],i,n,v);if(l){const v=gt(l)?l.call(n):l;Reflect.ownKeys(v).forEach(P=>{dd(P,v[P])})}h&&Ho(h,t,"c");function K(v,P){ut(P)?P.forEach(E=>v(E.bind(n))):P&&v(P.bind(n))}if(K(Kh,p),K(Io,f),K(Yh,u),K(Xh,m),K($h,_),K(jh,S),K(ed,x),K(td,k),K(Zh,D),K(Jh,g),K(Cn,y),K(Qh,w),ut(T))if(T.length){const v=t.exposed||(t.exposed={});T.forEach(P=>{Object.defineProperty(v,P,{get:()=>n[P],set:E=>n[P]=E})})}else t.exposed||(t.exposed={});b&&t.render===pe&&(t.render=b),M!=null&&(t.inheritAttrs=M),L&&(t.components=L),B&&(t.directives=B),w&&Oo(t)}function sd(t,e,n=pe){ut(t)&&(t=jr(t));for(const i in t){const s=t[i];let r;Rt(s)?"default"in s?r=Ki(s.from||i,s.default,!0):r=Ki(s.from||i):r=Ki(s),Lt(r)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[i]=r}}function Ho(t,e,n){ye(ut(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function Vo(t,e,n,i){let s=i.includes(".")?aa(n,i):()=>n[i];if(Et(t)){const r=e[t];gt(r)&&It(s,r)}else if(gt(t))It(s,t.bind(n));else if(Rt(t))if(ut(t))t.forEach(r=>Vo(r,e,n,i));else{const r=gt(t.handler)?t.handler.bind(n):e[t.handler];gt(r)&&It(s,r,t)}}function zo(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,a=r.get(e);let l;return a?l=a:!s.length&&!n&&!i?l=e:(l={},s.length&&s.forEach(c=>qi(l,c,o,!0)),qi(l,e,o)),Rt(e)&&r.set(e,l),l}function qi(t,e,n,i=!1){const{mixins:s,extends:r}=e;r&&qi(t,r,n,!0),s&&s.forEach(o=>qi(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=od[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const od={data:Wo,props:$o,emits:$o,methods:Tn,computed:Tn,beforeCreate:Vt,created:Vt,beforeMount:Vt,mounted:Vt,beforeUpdate:Vt,updated:Vt,beforeDestroy:Vt,beforeUnmount:Vt,destroyed:Vt,unmounted:Vt,activated:Vt,deactivated:Vt,errorCaptured:Vt,serverPrefetch:Vt,components:Tn,directives:Tn,watch:ld,provide:Wo,inject:ad};function Wo(t,e){return e?t?function(){return Ot(gt(t)?t.call(this,this):t,gt(e)?e.call(this,this):e)}:e:t}function ad(t,e){return Tn(jr(t),jr(e))}function jr(t){if(ut(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Vt(t,e){return t?[...new Set([].concat(t,e))]:e}function Tn(t,e){return t?Ot(Object.create(null),t,e):e}function $o(t,e){return t?ut(t)&&ut(e)?[...new Set([...t,...e])]:Ot(Object.create(null),Bo(t),Bo(e??{})):e}function ld(t,e){if(!t)return e;if(!e)return t;const n=Ot(Object.create(null),t);for(const i in e)n[i]=Vt(t[i],e[i]);return n}function jo(){return{app:null,config:{isNativeTag:jc,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let cd=0;function hd(t,e){return function(i,s=null){gt(i)||(i=Ot({},i)),s!=null&&!Rt(s)&&(s=null);const r=jo(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:cd++,_component:i,_props:s,_container:null,_context:r,_instance:null,version:qd,get config(){return r.config},set config(h){},use(h,...p){return o.has(h)||(h&&gt(h.install)?(o.add(h),h.install(c,...p)):gt(h)&&(o.add(h),h(c,...p))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,p){return p?(r.components[h]=p,c):r.components[h]},directive(h,p){return p?(r.directives[h]=p,c):r.directives[h]},mount(h,p,f){if(!l){const u=c._ceVNode||Zt(i,s);return u.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),t(u,h,f),l=!0,c._container=h,h.__vue_app__=c,tr(u.component)}},onUnmount(h){a.push(h)},unmount(){l&&(ye(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(h,p){return r.provides[h]=p,c},runWithContext(h){const p=sn;sn=c;try{return h()}finally{sn=p}}};return c}}let sn=null;function dd(t,e){if(zt){let n=zt.provides;const i=zt.parent&&zt.parent.provides;i===n&&(n=zt.provides=Object.create(i)),n[t]=e}}function Ki(t,e,n=!1){const i=zt||ie;if(i||sn){const s=sn?sn._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return n&&gt(e)?e.call(i&&i.proxy):e}}const qo={},Ko=()=>Object.create(qo),Yo=t=>Object.getPrototypeOf(t)===qo;function ud(t,e,n,i=!1){const s={},r=Ko();t.propsDefaults=Object.create(null),Xo(t,e,s,r);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=i?s:wo(s):t.type.props?t.props=s:t.props=r,t.attrs=r}function fd(t,e,n,i){const{props:s,attrs:r,vnode:{patchFlag:o}}=t,a=bt(s),[l]=t.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let p=0;p<h.length;p++){let f=h[p];if(Yi(t.emitsOptions,f))continue;const u=e[f];if(l)if(St(r,f))u!==r[f]&&(r[f]=u,c=!0);else{const m=ce(f);s[m]=qr(l,a,m,u,t,!1)}else u!==r[f]&&(r[f]=u,c=!0)}}}else{Xo(t,e,s,r)&&(c=!0);let h;for(const p in a)(!e||!St(e,p)&&((h=ee(p))===p||!St(e,h)))&&(l?n&&(n[p]!==void 0||n[h]!==void 0)&&(s[p]=qr(l,a,p,void 0,t,!0)):delete s[p]);if(r!==a)for(const p in r)(!e||!St(e,p))&&(delete r[p],c=!0)}c&&Ce(t.attrs,"set","")}function Xo(t,e,n,i){const[s,r]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(pn(l))continue;const c=e[l];let h;s&&St(s,h=ce(l))?!r||!r.includes(h)?n[h]=c:(a||(a={}))[h]=c:Yi(t.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(r){const l=bt(n),c=a||Pt;for(let h=0;h<r.length;h++){const p=r[h];n[p]=qr(s,l,p,c[p],t,!St(c,p))}}return o}function qr(t,e,n,i,s,r){const o=t[n];if(o!=null){const a=St(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&gt(l)){const{propsDefaults:c}=s;if(n in c)i=c[n];else{const h=En(s);i=c[n]=l.call(null,e),h()}}else i=l;s.ce&&s.ce._setProp(n,i)}o[0]&&(r&&!a?i=!1:o[1]&&(i===""||i===ee(n))&&(i=!0))}return i}const gd=new WeakMap;function Jo(t,e,n=!1){const i=n?gd:e.propsCache,s=i.get(t);if(s)return s;const r=t.props,o={},a=[];let l=!1;if(!gt(t)){const h=p=>{l=!0;const[f,u]=Jo(p,e,!0);Ot(o,f),u&&a.push(...u)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!r&&!l)return Rt(t)&&i.set(t,Xe),Xe;if(ut(r))for(let h=0;h<r.length;h++){const p=ce(r[h]);Qo(p)&&(o[p]=Pt)}else if(r)for(const h in r){const p=ce(h);if(Qo(p)){const f=r[h],u=o[p]=ut(f)||gt(f)?{type:f}:Ot({},f),m=u.type;let _=!1,S=!0;if(ut(m))for(let C=0;C<m.length;++C){const g=m[C],d=gt(g)&&g.name;if(d==="Boolean"){_=!0;break}else d==="String"&&(S=!1)}else _=gt(m)&&m.name==="Boolean";u[0]=_,u[1]=S,(_||St(u,"default"))&&a.push(p)}}const c=[o,a];return Rt(t)&&i.set(t,c),c}function Qo(t){return t[0]!=="$"&&!pn(t)}const Zo=t=>t[0]==="_"||t==="$stable",Kr=t=>ut(t)?t.map(ve):[ve(t)],pd=(t,e,n)=>{if(e._n)return e;const i=Vh((...s)=>Kr(e(...s)),n);return i._c=!1,i},ta=(t,e,n)=>{const i=t._ctx;for(const s in t){if(Zo(s))continue;const r=t[s];if(gt(r))e[s]=pd(s,r,i);else if(r!=null){const o=Kr(r);e[s]=()=>o}}},ea=(t,e)=>{const n=Kr(e);t.slots.default=()=>n},na=(t,e,n)=>{for(const i in e)(n||i!=="_")&&(t[i]=e[i])},md=(t,e,n)=>{const i=t.slots=Ko();if(t.vnode.shapeFlag&32){const s=e._;s?(na(i,e,n),n&&qs(i,"_",s,!0)):ta(e,i)}else e&&ea(t,e)},yd=(t,e,n)=>{const{vnode:i,slots:s}=t;let r=!0,o=Pt;if(i.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:na(s,e,n):(r=!e.$stable,ta(e,s)),o=e}else e&&(ea(t,e),o={default:1});if(r)for(const a in s)!Zo(a)&&o[a]==null&&delete s[a]},Jt=Md;function _d(t){return vd(t)}function vd(t,e){const n=Xs();n.__VUE__=!0;const{insert:i,remove:s,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:p,nextSibling:f,setScopeId:u=pe,insertStaticContent:m}=t,_=(R,N,W,G=null,I=null,q=null,J=void 0,nt=null,Z=!!N.dynamicChildren)=>{if(R===N)return;R&&!Rn(R,N)&&(G=F(R),j(R,I,q,!0),R=null),N.patchFlag===-2&&(Z=!1,N.dynamicChildren=null);const{type:Q,ref:st,shapeFlag:Y}=N;switch(Q){case Xi:S(R,N,W,G);break;case We:C(R,N,W,G);break;case Xr:R==null&&g(N,W,G,J);break;case $t:L(R,N,W,G,I,q,J,nt,Z);break;default:Y&1?b(R,N,W,G,I,q,J,nt,Z):Y&6?B(R,N,W,G,I,q,J,nt,Z):(Y&64||Y&128)&&Q.process(R,N,W,G,I,q,J,nt,Z,it)}st!=null&&I&&Vr(st,R&&R.ref,q,N||R,!N)},S=(R,N,W,G)=>{if(R==null)i(N.el=a(N.children),W,G);else{const I=N.el=R.el;N.children!==R.children&&c(I,N.children)}},C=(R,N,W,G)=>{R==null?i(N.el=l(N.children||""),W,G):N.el=R.el},g=(R,N,W,G)=>{[R.el,R.anchor]=m(R.children,N,W,G,R.el,R.anchor)},d=({el:R,anchor:N},W,G)=>{let I;for(;R&&R!==N;)I=f(R),i(R,W,G),R=I;i(N,W,G)},y=({el:R,anchor:N})=>{let W;for(;R&&R!==N;)W=f(R),s(R),R=W;s(N)},b=(R,N,W,G,I,q,J,nt,Z)=>{N.type==="svg"?J="svg":N.type==="math"&&(J="mathml"),R==null?k(N,W,G,I,q,J,nt,Z):w(R,N,I,q,J,nt,Z)},k=(R,N,W,G,I,q,J,nt)=>{let Z,Q;const{props:st,shapeFlag:Y,transition:ot,dirs:ht}=R;if(Z=R.el=o(R.type,q,st&&st.is,st),Y&8?h(Z,R.children):Y&16&&x(R.children,Z,null,G,I,Yr(R,q),J,nt),ht&&Ve(R,null,G,"created"),D(Z,R,R.scopeId,J,G),st){for(const pt in st)pt!=="value"&&!pn(pt)&&r(Z,pt,null,st[pt],q,G);"value"in st&&r(Z,"value",null,st.value,q),(Q=st.onVnodeBeforeMount)&&be(Q,G,R)}ht&&Ve(R,null,G,"beforeMount");const dt=bd(I,ot);dt&&ot.beforeEnter(Z),i(Z,N,W),((Q=st&&st.onVnodeMounted)||dt||ht)&&Jt(()=>{Q&&be(Q,G,R),dt&&ot.enter(Z),ht&&Ve(R,null,G,"mounted")},I)},D=(R,N,W,G,I)=>{if(W&&u(R,W),G)for(let q=0;q<G.length;q++)u(R,G[q]);if(I){let q=I.subTree;if(N===q||da(q.type)&&(q.ssContent===N||q.ssFallback===N)){const J=I.vnode;D(R,J,J.scopeId,J.slotScopeIds,I.parent)}}},x=(R,N,W,G,I,q,J,nt,Z=0)=>{for(let Q=Z;Q<R.length;Q++){const st=R[Q]=nt?Oe(R[Q]):ve(R[Q]);_(null,st,N,W,G,I,q,J,nt)}},w=(R,N,W,G,I,q,J)=>{const nt=N.el=R.el;let{patchFlag:Z,dynamicChildren:Q,dirs:st}=N;Z|=R.patchFlag&16;const Y=R.props||Pt,ot=N.props||Pt;let ht;if(W&&ze(W,!1),(ht=ot.onVnodeBeforeUpdate)&&be(ht,W,N,R),st&&Ve(N,R,W,"beforeUpdate"),W&&ze(W,!0),(Y.innerHTML&&ot.innerHTML==null||Y.textContent&&ot.textContent==null)&&h(nt,""),Q?T(R.dynamicChildren,Q,nt,W,G,Yr(N,I),q):J||P(R,N,nt,null,W,G,Yr(N,I),q,!1),Z>0){if(Z&16)M(nt,Y,ot,W,I);else if(Z&2&&Y.class!==ot.class&&r(nt,"class",null,ot.class,I),Z&4&&r(nt,"style",Y.style,ot.style,I),Z&8){const dt=N.dynamicProps;for(let pt=0;pt<dt.length;pt++){const ft=dt[pt],vt=Y[ft],xt=ot[ft];(xt!==vt||ft==="value")&&r(nt,ft,vt,xt,I,W)}}Z&1&&R.children!==N.children&&h(nt,N.children)}else!J&&Q==null&&M(nt,Y,ot,W,I);((ht=ot.onVnodeUpdated)||st)&&Jt(()=>{ht&&be(ht,W,N,R),st&&Ve(N,R,W,"updated")},G)},T=(R,N,W,G,I,q,J)=>{for(let nt=0;nt<N.length;nt++){const Z=R[nt],Q=N[nt],st=Z.el&&(Z.type===$t||!Rn(Z,Q)||Z.shapeFlag&70)?p(Z.el):W;_(Z,Q,st,null,G,I,q,J,!0)}},M=(R,N,W,G,I)=>{if(N!==W){if(N!==Pt)for(const q in N)!pn(q)&&!(q in W)&&r(R,q,N[q],null,I,G);for(const q in W){if(pn(q))continue;const J=W[q],nt=N[q];J!==nt&&q!=="value"&&r(R,q,nt,J,I,G)}"value"in W&&r(R,"value",N.value,W.value,I)}},L=(R,N,W,G,I,q,J,nt,Z)=>{const Q=N.el=R?R.el:a(""),st=N.anchor=R?R.anchor:a("");let{patchFlag:Y,dynamicChildren:ot,slotScopeIds:ht}=N;ht&&(nt=nt?nt.concat(ht):ht),R==null?(i(Q,W,G),i(st,W,G),x(N.children||[],W,st,I,q,J,nt,Z)):Y>0&&Y&64&&ot&&R.dynamicChildren?(T(R.dynamicChildren,ot,W,I,q,J,nt),(N.key!=null||I&&N===I.subTree)&&ia(R,N,!0)):P(R,N,W,st,I,q,J,nt,Z)},B=(R,N,W,G,I,q,J,nt,Z)=>{N.slotScopeIds=nt,R==null?N.shapeFlag&512?I.ctx.activate(N,W,G,J,Z):V(N,W,G,I,q,J,Z):U(R,N,Z)},V=(R,N,W,G,I,q,J)=>{const nt=R.component=Id(R,G,I);if(Lo(R)&&(nt.ctx.renderer=it),Ud(nt,!1,J),nt.asyncDep){if(I&&I.registerDep(nt,K,J),!R.el){const Z=nt.subTree=Zt(We);C(null,Z,N,W)}}else K(nt,R,N,W,I,q,J)},U=(R,N,W)=>{const G=N.component=R.component;if(Rd(R,N,W))if(G.asyncDep&&!G.asyncResolved){v(G,N,W);return}else G.next=N,G.update();else N.el=R.el,G.vnode=N},K=(R,N,W,G,I,q,J)=>{const nt=()=>{if(R.isMounted){let{next:Y,bu:ot,u:ht,parent:dt,vnode:pt}=R;{const Nt=ra(R);if(Nt){Y&&(Y.el=pt.el,v(R,Y,J)),Nt.asyncDep.then(()=>{R.isUnmounted||nt()});return}}let ft=Y,vt;ze(R,!1),Y?(Y.el=pt.el,v(R,Y,J)):Y=pt,ot&&Ri(ot),(vt=Y.props&&Y.props.onVnodeBeforeUpdate)&&be(vt,dt,Y,pt),ze(R,!0);const xt=ca(R),Ct=R.subTree;R.subTree=xt,_(Ct,xt,p(Ct.el),F(Ct),R,I,q),Y.el=xt.el,ft===null&&Ed(R,xt.el),ht&&Jt(ht,I),(vt=Y.props&&Y.props.onVnodeUpdated)&&Jt(()=>be(vt,dt,Y,pt),I)}else{let Y;const{el:ot,props:ht}=N,{bm:dt,m:pt,parent:ft,root:vt,type:xt}=R,Ct=wn(N);ze(R,!1),dt&&Ri(dt),!Ct&&(Y=ht&&ht.onVnodeBeforeMount)&&be(Y,ft,N),ze(R,!0);{vt.ce&&vt.ce._injectChildStyle(xt);const Nt=R.subTree=ca(R);_(null,Nt,W,G,R,I,q),N.el=Nt.el}if(pt&&Jt(pt,I),!Ct&&(Y=ht&&ht.onVnodeMounted)){const Nt=N;Jt(()=>be(Y,ft,Nt),I)}(N.shapeFlag&256||ft&&wn(ft.vnode)&&ft.vnode.shapeFlag&256)&&R.a&&Jt(R.a,I),R.isMounted=!0,N=W=G=null}};R.scope.on();const Z=R.effect=new to(nt);R.scope.off();const Q=R.update=Z.run.bind(Z),st=R.job=Z.runIfDirty.bind(Z);st.i=R,st.id=R.uid,Z.scheduler=()=>Br(st),ze(R,!0),Q()},v=(R,N,W)=>{N.component=R;const G=R.vnode.props;R.vnode=N,R.next=null,fd(R,N.props,G,W),yd(R,N.children,W),xe(),Eo(R),we()},P=(R,N,W,G,I,q,J,nt,Z=!1)=>{const Q=R&&R.children,st=R?R.shapeFlag:0,Y=N.children,{patchFlag:ot,shapeFlag:ht}=N;if(ot>0){if(ot&128){A(Q,Y,W,G,I,q,J,nt,Z);return}else if(ot&256){E(Q,Y,W,G,I,q,J,nt,Z);return}}ht&8?(st&16&&$(Q,I,q),Y!==Q&&h(W,Y)):st&16?ht&16?A(Q,Y,W,G,I,q,J,nt,Z):$(Q,I,q,!0):(st&8&&h(W,""),ht&16&&x(Y,W,G,I,q,J,nt,Z))},E=(R,N,W,G,I,q,J,nt,Z)=>{R=R||Xe,N=N||Xe;const Q=R.length,st=N.length,Y=Math.min(Q,st);let ot;for(ot=0;ot<Y;ot++){const ht=N[ot]=Z?Oe(N[ot]):ve(N[ot]);_(R[ot],ht,W,null,I,q,J,nt,Z)}Q>st?$(R,I,q,!0,!1,Y):x(N,W,G,I,q,J,nt,Z,Y)},A=(R,N,W,G,I,q,J,nt,Z)=>{let Q=0;const st=N.length;let Y=R.length-1,ot=st-1;for(;Q<=Y&&Q<=ot;){const ht=R[Q],dt=N[Q]=Z?Oe(N[Q]):ve(N[Q]);if(Rn(ht,dt))_(ht,dt,W,null,I,q,J,nt,Z);else break;Q++}for(;Q<=Y&&Q<=ot;){const ht=R[Y],dt=N[ot]=Z?Oe(N[ot]):ve(N[ot]);if(Rn(ht,dt))_(ht,dt,W,null,I,q,J,nt,Z);else break;Y--,ot--}if(Q>Y){if(Q<=ot){const ht=ot+1,dt=ht<st?N[ht].el:G;for(;Q<=ot;)_(null,N[Q]=Z?Oe(N[Q]):ve(N[Q]),W,dt,I,q,J,nt,Z),Q++}}else if(Q>ot)for(;Q<=Y;)j(R[Q],I,q,!0),Q++;else{const ht=Q,dt=Q,pt=new Map;for(Q=dt;Q<=ot;Q++){const Wt=N[Q]=Z?Oe(N[Q]):ve(N[Q]);Wt.key!=null&&pt.set(Wt.key,Q)}let ft,vt=0;const xt=ot-dt+1;let Ct=!1,Nt=0;const te=new Array(xt);for(Q=0;Q<xt;Q++)te[Q]=0;for(Q=ht;Q<=Y;Q++){const Wt=R[Q];if(vt>=xt){j(Wt,I,q,!0);continue}let le;if(Wt.key!=null)le=pt.get(Wt.key);else for(ft=dt;ft<=ot;ft++)if(te[ft-dt]===0&&Rn(Wt,N[ft])){le=ft;break}le===void 0?j(Wt,I,q,!0):(te[le-dt]=Q+1,le>=Nt?Nt=le:Ct=!0,_(Wt,N[le],W,null,I,q,J,nt,Z),vt++)}const Ye=Ct?Sd(te):Xe;for(ft=Ye.length-1,Q=xt-1;Q>=0;Q--){const Wt=dt+Q,le=N[Wt],Wc=Wt+1<st?N[Wt+1].el:G;te[Q]===0?_(null,le,W,Wc,I,q,J,nt,Z):Ct&&(ft<0||Q!==Ye[ft]?O(le,W,Wc,2):ft--)}}},O=(R,N,W,G,I=null)=>{const{el:q,type:J,transition:nt,children:Z,shapeFlag:Q}=R;if(Q&6){O(R.component.subTree,N,W,G);return}if(Q&128){R.suspense.move(N,W,G);return}if(Q&64){J.move(R,N,W,it);return}if(J===$t){i(q,N,W);for(let Y=0;Y<Z.length;Y++)O(Z[Y],N,W,G);i(R.anchor,N,W);return}if(J===Xr){d(R,N,W);return}if(G!==2&&Q&1&&nt)if(G===0)nt.beforeEnter(q),i(q,N,W),Jt(()=>nt.enter(q),I);else{const{leave:Y,delayLeave:ot,afterLeave:ht}=nt,dt=()=>i(q,N,W),pt=()=>{Y(q,()=>{dt(),ht&&ht()})};ot?ot(q,dt,pt):pt()}else i(q,N,W)},j=(R,N,W,G=!1,I=!1)=>{const{type:q,props:J,ref:nt,children:Z,dynamicChildren:Q,shapeFlag:st,patchFlag:Y,dirs:ot,cacheIndex:ht}=R;if(Y===-2&&(I=!1),nt!=null&&Vr(nt,null,W,R,!0),ht!=null&&(N.renderCache[ht]=void 0),st&256){N.ctx.deactivate(R);return}const dt=st&1&&ot,pt=!wn(R);let ft;if(pt&&(ft=J&&J.onVnodeBeforeUnmount)&&be(ft,N,R),st&6)rt(R.component,W,G);else{if(st&128){R.suspense.unmount(W,G);return}dt&&Ve(R,null,N,"beforeUnmount"),st&64?R.type.remove(R,N,W,it,G):Q&&!Q.hasOnce&&(q!==$t||Y>0&&Y&64)?$(Q,N,W,!1,!0):(q===$t&&Y&384||!I&&st&16)&&$(Z,N,W),G&&H(R)}(pt&&(ft=J&&J.onVnodeUnmounted)||dt)&&Jt(()=>{ft&&be(ft,N,R),dt&&Ve(R,null,N,"unmounted")},W)},H=R=>{const{type:N,el:W,anchor:G,transition:I}=R;if(N===$t){X(W,G);return}if(N===Xr){y(R);return}const q=()=>{s(W),I&&!I.persisted&&I.afterLeave&&I.afterLeave()};if(R.shapeFlag&1&&I&&!I.persisted){const{leave:J,delayLeave:nt}=I,Z=()=>J(W,q);nt?nt(R.el,q,Z):Z()}else q()},X=(R,N)=>{let W;for(;R!==N;)W=f(R),s(R),R=W;s(N)},rt=(R,N,W)=>{const{bum:G,scope:I,job:q,subTree:J,um:nt,m:Z,a:Q}=R;sa(Z),sa(Q),G&&Ri(G),I.stop(),q&&(q.flags|=8,j(J,R,N,W)),nt&&Jt(nt,N),Jt(()=>{R.isUnmounted=!0},N),N&&N.pendingBranch&&!N.isUnmounted&&R.asyncDep&&!R.asyncResolved&&R.suspenseId===N.pendingId&&(N.deps--,N.deps===0&&N.resolve())},$=(R,N,W,G=!1,I=!1,q=0)=>{for(let J=q;J<R.length;J++)j(R[J],N,W,G,I)},F=R=>{if(R.shapeFlag&6)return F(R.component.subTree);if(R.shapeFlag&128)return R.suspense.next();const N=f(R.anchor||R.el),W=N&&N[zh];return W?f(W):N};let z=!1;const et=(R,N,W)=>{R==null?N._vnode&&j(N._vnode,null,null,!0):_(N._vnode||null,R,N,null,null,null,W),N._vnode=R,z||(z=!0,Eo(),Mo(),z=!1)},it={p:_,um:j,m:O,r:H,mt:V,mc:x,pc:P,pbc:T,n:F,o:t};return{render:et,hydrate:void 0,createApp:hd(et)}}function Yr({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function ze({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function bd(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function ia(t,e,n=!1){const i=t.children,s=e.children;if(ut(i)&&ut(s))for(let r=0;r<i.length;r++){const o=i[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=Oe(s[r]),a.el=o.el),!n&&a.patchFlag!==-2&&ia(o,a)),a.type===Xi&&(a.el=o.el)}}function Sd(t){const e=t.slice(),n=[0];let i,s,r,o,a;const l=t.length;for(i=0;i<l;i++){const c=t[i];if(c!==0){if(s=n[n.length-1],t[s]<c){e[i]=s,n.push(i);continue}for(r=0,o=n.length-1;r<o;)a=r+o>>1,t[n[a]]<c?r=a+1:o=a;c<t[n[r]]&&(r>0&&(e[i]=n[r-1]),n[r]=i)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}function ra(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:ra(e)}function sa(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const xd=Symbol.for("v-scx"),wd=()=>Ki(xd);function It(t,e,n){return oa(t,e,n)}function oa(t,e,n=Pt){const{immediate:i,deep:s,flush:r,once:o}=n,a=Ot({},n);let l;if(Zi)if(r==="sync"){const f=wd();l=f.__watcherHandles||(f.__watcherHandles=[])}else if(!e||i)a.once=!0;else{const f=()=>{};return f.stop=pe,f.resume=pe,f.pause=pe,f}const c=zt;a.call=(f,u,m)=>ye(f,c,u,m);let h=!1;r==="post"?a.scheduler=f=>{Jt(f,c&&c.suspense)}:r!=="sync"&&(h=!0,a.scheduler=(f,u)=>{u?f():Br(f)}),a.augmentJob=f=>{e&&(f.flags|=4),h&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const p=Nh(t,e,a);return l&&l.push(p),p}function Cd(t,e,n){const i=this.proxy,s=Et(t)?t.includes(".")?aa(i,t):()=>i[t]:t.bind(i,i);let r;gt(e)?r=e:(r=e.handler,n=e);const o=En(this),a=oa(s,r.bind(i),n);return o(),a}function aa(t,e){const n=e.split(".");return()=>{let i=t;for(let s=0;s<n.length&&i;s++)i=i[n[s]];return i}}const Pd=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${ce(e)}Modifiers`]||t[`${ee(e)}Modifiers`];function Td(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||Pt;let s=n;const r=e.startsWith("update:"),o=r&&Pd(i,e.slice(7));o&&(o.trim&&(s=n.map(h=>Et(h)?h.trim():h)),o.number&&(s=n.map(Ei)));let a,l=i[a=xr(e)]||i[a=xr(ce(e))];!l&&r&&(l=i[a=xr(ee(e))]),l&&ye(l,t,6,s);const c=i[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,ye(c,t,6,s)}}function la(t,e,n=!1){const i=e.emitsCache,s=i.get(t);if(s!==void 0)return s;const r=t.emits;let o={},a=!1;if(!gt(t)){const l=c=>{const h=la(c,e,!0);h&&(a=!0,Ot(o,h))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(Rt(t)&&i.set(t,null),null):(ut(r)?r.forEach(l=>o[l]=null):Ot(o,r),Rt(t)&&i.set(t,o),o)}function Yi(t,e){return!t||!Pi(e)?!1:(e=e.slice(2).replace(/Once$/,""),St(t,e[0].toLowerCase()+e.slice(1))||St(t,ee(e))||St(t,e))}function Lg(){}function ca(t){const{type:e,vnode:n,proxy:i,withProxy:s,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:p,data:f,setupState:u,ctx:m,inheritAttrs:_}=t,S=$i(t);let C,g;try{if(n.shapeFlag&4){const y=s||i,b=y;C=ve(c.call(b,y,h,p,u,f,m)),g=a}else{const y=e;C=ve(y.length>1?y(p,{attrs:a,slots:o,emit:l}):y(p,null)),g=e.props?a:kd(a)}}catch(y){kn.length=0,zi(y,t,1),C=Zt(We)}let d=C;if(g&&_!==!1){const y=Object.keys(g),{shapeFlag:b}=d;y.length&&b&7&&(r&&y.some(vr)&&(g=Ad(g,r)),d=on(d,g,!1,!0))}return n.dirs&&(d=on(d,null,!1,!0),d.dirs=d.dirs?d.dirs.concat(n.dirs):n.dirs),n.transition&&Hr(d,n.transition),C=d,$i(S),C}const kd=t=>{let e;for(const n in t)(n==="class"||n==="style"||Pi(n))&&((e||(e={}))[n]=t[n]);return e},Ad=(t,e)=>{const n={};for(const i in t)(!vr(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function Rd(t,e,n){const{props:i,children:s,component:r}=t,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?ha(i,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let p=0;p<h.length;p++){const f=h[p];if(o[f]!==i[f]&&!Yi(c,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?ha(i,o,c):!0:!!o;return!1}function ha(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let s=0;s<i.length;s++){const r=i[s];if(e[r]!==t[r]&&!Yi(n,r))return!0}return!1}function Ed({vnode:t,parent:e},n){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=n,e=e.parent;else break}}const da=t=>t.__isSuspense;function Md(t,e){e&&e.pendingBranch?ut(t)?e.effects.push(...t):e.effects.push(t):Hh(t)}const $t=Symbol.for("v-fgt"),Xi=Symbol.for("v-txt"),We=Symbol.for("v-cmt"),Xr=Symbol.for("v-stc"),kn=[];let Qt=null;function wt(t=!1){kn.push(Qt=t?null:[])}function Fd(){kn.pop(),Qt=kn[kn.length-1]||null}let An=1;function ua(t){An+=t,t<0&&Qt&&(Qt.hasOnce=!0)}function fa(t){return t.dynamicChildren=An>0?Qt||Xe:null,Fd(),An>0&&Qt&&Qt.push(t),t}function At(t,e,n,i,s,r){return fa(at(t,e,n,i,s,r,!0))}function Jr(t,e,n,i,s){return fa(Zt(t,e,n,i,s,!0))}function ga(t){return t?t.__v_isVNode===!0:!1}function Rn(t,e){return t.type===e.type&&t.key===e.key}const pa=({key:t})=>t??null,Ji=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Et(t)||Lt(t)||gt(t)?{i:ie,r:t,k:e,f:!!n}:t:null);function at(t,e=null,n=null,i=0,s=null,r=t===$t?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&pa(e),ref:e&&Ji(e),scopeId:Do,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ie};return a?(Qr(l,n),r&128&&t.normalize(l)):n&&(l.shapeFlag|=Et(n)?8:16),An>0&&!o&&Qt&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&Qt.push(l),l}const Zt=Dd;function Dd(t,e=null,n=null,i=0,s=null,r=!1){if((!t||t===nd)&&(t=We),ga(t)){const a=on(t,e,!0);return n&&Qr(a,n),An>0&&!r&&Qt&&(a.shapeFlag&6?Qt[Qt.indexOf(t)]=a:Qt.push(a)),a.patchFlag=-2,a}if(jd(t)&&(t=t.__vccOpts),e){e=Nd(e);let{class:a,style:l}=e;a&&!Et(a)&&(e.class=he(a)),Rt(l)&&(Lr(l)&&!ut(l)&&(l=Ot({},l)),e.style=Ie(l))}const o=Et(t)?1:da(t)?128:Wh(t)?64:Rt(t)?4:gt(t)?2:0;return at(t,e,n,i,s,o,r,!0)}function Nd(t){return t?Lr(t)||Yo(t)?Ot({},t):t:null}function on(t,e,n=!1,i=!1){const{props:s,ref:r,patchFlag:o,children:a,transition:l}=t,c=e?Od(s||{},e):s,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&pa(c),ref:e&&e.ref?n&&r?ut(r)?r.concat(Ji(e)):[r,Ji(e)]:Ji(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==$t?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&on(t.ssContent),ssFallback:t.ssFallback&&on(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&i&&Hr(h,l.clone(h)),h}function ma(t=" ",e=0){return Zt(Xi,null,t,e)}function re(t="",e=!1){return e?(wt(),Jr(We,null,t)):Zt(We,null,t)}function ve(t){return t==null||typeof t=="boolean"?Zt(We):ut(t)?Zt($t,null,t.slice()):ga(t)?Oe(t):Zt(Xi,null,String(t))}function Oe(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:on(t)}function Qr(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(ut(e))n=16;else if(typeof e=="object")if(i&65){const s=e.default;s&&(s._c&&(s._d=!1),Qr(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!Yo(e)?e._ctx=ie:s===3&&ie&&(ie.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else gt(e)?(e={default:e,_ctx:ie},n=32):(e=String(e),i&64?(n=16,e=[ma(e)]):n=8);t.children=e,t.shapeFlag|=n}function Od(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const s in i)if(s==="class")e.class!==i.class&&(e.class=he([e.class,i.class]));else if(s==="style")e.style=Ie([e.style,i.style]);else if(Pi(s)){const r=e[s],o=i[s];o&&r!==o&&!(ut(r)&&r.includes(o))&&(e[s]=r?[].concat(r,o):o)}else s!==""&&(e[s]=i[s])}return e}function be(t,e,n,i=null){ye(t,e,7,[n,i])}const Ld=jo();let Gd=0;function Id(t,e,n){const i=t.type,s=(e?e.appContext:t.appContext)||Ld,r={uid:Gd++,vnode:t,type:i,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new rh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Jo(i,s),emitsOptions:la(i,s),emit:null,emitted:null,propsDefaults:Pt,inheritAttrs:i.inheritAttrs,ctx:Pt,data:Pt,props:Pt,attrs:Pt,slots:Pt,refs:Pt,setupState:Pt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=Td.bind(null,r),t.ce&&t.ce(r),r}let zt=null,Qi,Zr;{const t=Xs(),e=(n,i)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(i),r=>{s.length>1?s.forEach(o=>o(r)):s[0](r)}};Qi=e("__VUE_INSTANCE_SETTERS__",n=>zt=n),Zr=e("__VUE_SSR_SETTERS__",n=>Zi=n)}const En=t=>{const e=zt;return Qi(t),t.scope.on(),()=>{t.scope.off(),Qi(e)}},ya=()=>{zt&&zt.scope.off(),Qi(null)};function _a(t){return t.vnode.shapeFlag&4}let Zi=!1;function Ud(t,e=!1,n=!1){e&&Zr(e);const{props:i,children:s}=t.vnode,r=_a(t);ud(t,i,r,e),md(t,s,n);const o=r?Bd(t,e):void 0;return e&&Zr(!1),o}function Bd(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,id);const{setup:i}=n;if(i){const s=t.setupContext=i.length>1?Vd(t):null,r=En(t);xe();const o=tn(i,t,0,[t.props,s]);if(we(),r(),Ws(o)){if(wn(t)||Oo(t),o.then(ya,ya),e)return o.then(a=>{va(t,a)}).catch(a=>{zi(a,t,0)});t.asyncDep=o}else va(t,o)}else ba(t)}function va(t,e,n){gt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Rt(e)&&(t.setupState=To(e)),ba(t)}function ba(t,e,n){const i=t.type;t.render||(t.render=i.render||pe);{const s=En(t);xe();try{rd(t)}finally{we(),s()}}}const Hd={get(t,e){return Ut(t,"get",""),t[e]}};function Vd(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Hd),slots:t.slots,emit:t.emit,expose:e}}function tr(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(To(kh(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Pn)return Pn[n](t)},has(e,n){return n in e||n in Pn}})):t.proxy}const zd=/(?:^|[-_])(\w)/g,Wd=t=>t.replace(zd,e=>e.toUpperCase()).replace(/[-_]/g,"");function $d(t,e=!0){return gt(t)?t.displayName||t.name:t.name||e&&t.__name}function Sa(t,e,n=!1){let i=$d(e);if(!i&&e.__file){const s=e.__file.match(/([^/\\]+)\.\w+$/);s&&(i=s[1])}if(!i&&t&&t.parent){const s=r=>{for(const o in r)if(r[o]===e)return o};i=s(t.components||t.parent.type.components)||s(t.appContext.components)}return i?Wd(i):n?"App":"Anonymous"}function jd(t){return gt(t)&&"__vccOpts"in t}const Dt=(t,e)=>Fh(t,e,Zi),qd="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ts;const xa=typeof window<"u"&&window.trustedTypes;if(xa)try{ts=xa.createPolicy("vue",{createHTML:t=>t})}catch{}const wa=ts?t=>ts.createHTML(t):t=>t,Kd="http://www.w3.org/2000/svg",Yd="http://www.w3.org/1998/Math/MathML",Ae=typeof document<"u"?document:null,Ca=Ae&&Ae.createElement("template"),Xd={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const s=e==="svg"?Ae.createElementNS(Kd,t):e==="mathml"?Ae.createElementNS(Yd,t):n?Ae.createElement(t,{is:n}):Ae.createElement(t);return t==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:t=>Ae.createTextNode(t),createComment:t=>Ae.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ae.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,s,r){const o=n?n.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===r||!(s=s.nextSibling)););else{Ca.innerHTML=wa(i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t);const a=Ca.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},Jd=Symbol("_vtc");function Qd(t,e,n){const i=t[Jd];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Pa=Symbol("_vod"),Zd=Symbol("_vsh"),tu=Symbol(""),eu=/(^|;)\s*display\s*:/;function nu(t,e,n){const i=t.style,s=Et(n);let r=!1;if(n&&!s){if(e)if(Et(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&er(i,a,"")}else for(const o in e)n[o]==null&&er(i,o,"");for(const o in n)o==="display"&&(r=!0),er(i,o,n[o])}else if(s){if(e!==n){const o=i[tu];o&&(n+=";"+o),i.cssText=n,r=eu.test(n)}}else e&&t.removeAttribute("style");Pa in t&&(t[Pa]=r?i.display:"",t[Zd]&&(i.display="none"))}const Ta=/\s*!important$/;function er(t,e,n){if(ut(n))n.forEach(i=>er(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=iu(t,e);Ta.test(n)?t.setProperty(ee(i),n.replace(Ta,""),"important"):t[i]=n}}const ka=["Webkit","Moz","ms"],es={};function iu(t,e){const n=es[e];if(n)return n;let i=ce(e);if(i!=="filter"&&i in t)return es[e]=i;i=js(i);for(let s=0;s<ka.length;s++){const r=ka[s]+i;if(r in t)return es[e]=r}return e}const Aa="http://www.w3.org/1999/xlink";function Ra(t,e,n,i,s,r=eh(e)){i&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Aa,e.slice(6,e.length)):t.setAttributeNS(Aa,e,n):n==null||r&&!Js(n)?t.removeAttribute(e):t.setAttribute(e,r?"":me(n)?String(n):n)}function Ea(t,e,n,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?wa(n):n);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,a=n==null?t.type==="checkbox"?"on":"":String(n);(o!==a||!("_value"in t))&&(t.value=a),n==null&&t.removeAttribute(e),t._value=n;return}let r=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=Js(n):n==null&&o==="string"?(n="",r=!0):o==="number"&&(n=0,r=!0)}try{t[e]=n}catch{}r&&t.removeAttribute(e)}function $e(t,e,n,i){t.addEventListener(e,n,i)}function ru(t,e,n,i){t.removeEventListener(e,n,i)}const Ma=Symbol("_vei");function su(t,e,n,i,s=null){const r=t[Ma]||(t[Ma]={}),o=r[e];if(i&&o)o.value=i;else{const[a,l]=ou(e);if(i){const c=r[e]=cu(i,s);$e(t,a,c,l)}else o&&(ru(t,a,o,l),r[e]=void 0)}}const Fa=/(?:Once|Passive|Capture)$/;function ou(t){let e;if(Fa.test(t)){e={};let i;for(;i=t.match(Fa);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ee(t.slice(2)),e]}let ns=0;const au=Promise.resolve(),lu=()=>ns||(au.then(()=>ns=0),ns=Date.now());function cu(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;ye(hu(i,n.value),e,5,[i])};return n.value=t,n.attached=lu(),n}function hu(t,e){if(ut(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>s=>!s._stopped&&i&&i(s))}else return e}const Da=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,du=(t,e,n,i,s,r)=>{const o=s==="svg";e==="class"?Qd(t,i,o):e==="style"?nu(t,n,i):Pi(e)?vr(e)||su(t,e,n,i,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):uu(t,e,i,o))?(Ea(t,e,i),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ra(t,e,i,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Et(i))?Ea(t,ce(e),i):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),Ra(t,e,i,o))};function uu(t,e,n,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&Da(e)&&gt(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Da(e)&&Et(n)?!1:e in t}const Na={};/*! #__NO_SIDE_EFFECTS__ */function fu(t,e,n){const i=rn(t,e);ki(i)&&Ot(i,e);class s extends is{constructor(o){super(i,o,n)}}return s.def=i,s}const gu=typeof HTMLElement<"u"?HTMLElement:class{};class is extends gu{constructor(e,n={},i=Ua){super(),this._def=e,this._props=n,this._createApp=i,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&i!==Ua?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof is){this._parent=e;break}this._instance||(this._resolved?(this._setParent(),this._update()):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._instance.provides=e._instance.provides)}disconnectedCallback(){this._connected=!1,Ur(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const s of i)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(i,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:r,styles:o}=i;let a;if(r&&!ut(r))for(const l in r){const c=r[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=Ks(this._props[l])),(a||(a=Object.create(null)))[ce(l)]=!0)}this._numberProps=a,s&&this._resolveProps(i),this.shadowRoot&&this._applyStyles(o),this._mount(i)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(i=>e(this._def=i,!0)):e(this._def)}_mount(e){this._app=this._createApp(e),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const i in n)St(this,i)||Object.defineProperty(this,i,{get:()=>lt(n[i])})}_resolveProps(e){const{props:n}=e,i=ut(n)?n:Object.keys(n||{});for(const s of Object.keys(this))s[0]!=="_"&&i.includes(s)&&this._setProp(s,this[s]);for(const s of i.map(ce))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(r){this._setProp(s,r,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const n=this.hasAttribute(e);let i=n?this.getAttribute(e):Na;const s=ce(e);n&&this._numberProps&&this._numberProps[s]&&(i=Ks(i)),this._setProp(s,i,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,n,i=!0,s=!1){n!==this._props[e]&&(n===Na?delete this._props[e]:(this._props[e]=n,e==="key"&&this._app&&(this._app._ceVNode.key=n)),s&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(ee(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(ee(e),n+""):n||this.removeAttribute(ee(e))))}_update(){xu(this._createVNode(),this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const n=Zt(this._def,Ot(e,this._props));return this._instance||(n.ce=i=>{this._instance=i,i.ce=this,i.isCE=!0;const s=(r,o)=>{this.dispatchEvent(new CustomEvent(r,ki(o[0])?Ot({detail:o},o[0]):{detail:o}))};i.emit=(r,...o)=>{s(r,o),ee(r)!==r&&s(ee(r),o)},this._setParent()}),n}_applyStyles(e,n){if(!e)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const i=this._nonce;for(let s=e.length-1;s>=0;s--){const r=document.createElement("style");i&&r.setAttribute("nonce",i),r.textContent=e[s],this.shadowRoot.prepend(r)}}_parseSlots(){const e=this._slots={};let n;for(;n=this.firstChild;){const i=n.nodeType===1&&n.getAttribute("slot")||"default";(e[i]||(e[i]=[])).push(n),this.removeChild(n)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let i=0;i<e.length;i++){const s=e[i],r=s.getAttribute("name")||"default",o=this._slots[r],a=s.parentNode;if(o)for(const l of o){if(n&&l.nodeType===1){const c=n+"-s",h=document.createTreeWalker(l,1);l.setAttribute(c,"");let p;for(;p=h.nextNode();)p.setAttribute(c,"")}a.insertBefore(l,s)}else for(;s.firstChild;)a.insertBefore(s.firstChild,s);a.removeChild(s)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}const nr=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ut(e)?n=>Ri(e,n):e};function pu(t){t.target.composing=!0}function Oa(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const an=Symbol("_assign"),mu={created(t,{modifiers:{lazy:e,trim:n,number:i}},s){t[an]=nr(s);const r=i||s.props&&s.props.type==="number";$e(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),r&&(a=Ei(a)),t[an](a)}),n&&$e(t,"change",()=>{t.value=t.value.trim()}),e||($e(t,"compositionstart",pu),$e(t,"compositionend",Oa),$e(t,"change",Oa))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:i,trim:s,number:r}},o){if(t[an]=nr(o),t.composing)return;const a=(r||t.type==="number")&&!/^0\d/.test(t.value)?Ei(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(i&&e===n||s&&t.value.trim()===l)||(t.value=l))}},yu={deep:!0,created(t,{value:e,modifiers:{number:n}},i){const s=Ti(e);$e(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Ei(ir(o)):ir(o));t[an](t.multiple?s?new Set(r):r:r[0]),t._assigning=!0,Ur(()=>{t._assigning=!1})}),t[an]=nr(i)},mounted(t,{value:e}){La(t,e)},beforeUpdate(t,e,n){t[an]=nr(n)},updated(t,{value:e}){t._assigning||La(t,e)}};function La(t,e){const n=t.multiple,i=ut(e);if(!(n&&!i&&!Ti(e))){for(let s=0,r=t.options.length;s<r;s++){const o=t.options[s],a=ir(o);if(n)if(i){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=ih(e,a)>-1}else o.selected=e.has(a);else if(Mi(ir(o),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function ir(t){return"_value"in t?t._value:t.value}const _u=["ctrl","shift","alt","meta"],vu={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>_u.some(n=>t[`${n}Key`]&&!e.includes(n))},bu=(t,e)=>{const n=t._withMods||(t._withMods={}),i=e.join(".");return n[i]||(n[i]=(s,...r)=>{for(let o=0;o<e.length;o++){const a=vu[e[o]];if(a&&a(s,e))return}return t(s,...r)})},Su=Ot({patchProp:du},Xd);let Ga;function Ia(){return Ga||(Ga=_d(Su))}const xu=(...t)=>{Ia().render(...t)},Ua=(...t)=>{const e=Ia().createApp(...t),{mount:n}=e;return e.mount=i=>{const s=Cu(i);if(!s)return;const r=e._component;!gt(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=n(s,!1,wu(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function wu(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Cu(t){return Et(t)?document.querySelector(t):t}var Ba=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rr={exports:{}},Mn={},rs={},ss={},Ha;function mt(){return Ha||(Ha=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Ba<"u"?Ba:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.21",isBrowser:n(),isUnminified:/param/.test(function(s){}.toString()),dblClickWindow:400,getAngle(s){return t.Konva.angleDeg?s*e:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var s;return(s=t.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(s){t.glob.Konva=s}};const i=s=>{t.Konva[s.prototype.getClassName()]=s};t._registerNode=i,t.Konva._injectGlobal(t.Konva)}(ss)),ss}var os={},Va;function Mt(){return Va||(Va=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=mt();class n{constructor(y=[1,0,0,1,0,0]){this.dirty=!1,this.m=y&&y.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(y){y.m[0]=this.m[0],y.m[1]=this.m[1],y.m[2]=this.m[2],y.m[3]=this.m[3],y.m[4]=this.m[4],y.m[5]=this.m[5]}point(y){const b=this.m;return{x:b[0]*y.x+b[2]*y.y+b[4],y:b[1]*y.x+b[3]*y.y+b[5]}}translate(y,b){return this.m[4]+=this.m[0]*y+this.m[2]*b,this.m[5]+=this.m[1]*y+this.m[3]*b,this}scale(y,b){return this.m[0]*=y,this.m[1]*=y,this.m[2]*=b,this.m[3]*=b,this}rotate(y){const b=Math.cos(y),k=Math.sin(y),D=this.m[0]*b+this.m[2]*k,x=this.m[1]*b+this.m[3]*k,w=this.m[0]*-k+this.m[2]*b,T=this.m[1]*-k+this.m[3]*b;return this.m[0]=D,this.m[1]=x,this.m[2]=w,this.m[3]=T,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(y,b){const k=this.m[0]+this.m[2]*b,D=this.m[1]+this.m[3]*b,x=this.m[2]+this.m[0]*y,w=this.m[3]+this.m[1]*y;return this.m[0]=k,this.m[1]=D,this.m[2]=x,this.m[3]=w,this}multiply(y){const b=this.m[0]*y.m[0]+this.m[2]*y.m[1],k=this.m[1]*y.m[0]+this.m[3]*y.m[1],D=this.m[0]*y.m[2]+this.m[2]*y.m[3],x=this.m[1]*y.m[2]+this.m[3]*y.m[3],w=this.m[0]*y.m[4]+this.m[2]*y.m[5]+this.m[4],T=this.m[1]*y.m[4]+this.m[3]*y.m[5]+this.m[5];return this.m[0]=b,this.m[1]=k,this.m[2]=D,this.m[3]=x,this.m[4]=w,this.m[5]=T,this}invert(){const y=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),b=this.m[3]*y,k=-this.m[1]*y,D=-this.m[2]*y,x=this.m[0]*y,w=y*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),T=y*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=b,this.m[1]=k,this.m[2]=D,this.m[3]=x,this.m[4]=w,this.m[5]=T,this}getMatrix(){return this.m}decompose(){const y=this.m[0],b=this.m[1],k=this.m[2],D=this.m[3],x=this.m[4],w=this.m[5],T=y*D-b*k,M={x,y:w,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(y!=0||b!=0){const L=Math.sqrt(y*y+b*b);M.rotation=b>0?Math.acos(y/L):-Math.acos(y/L),M.scaleX=L,M.scaleY=T/L,M.skewX=(y*k+b*D)/T,M.skewY=0}else if(k!=0||D!=0){const L=Math.sqrt(k*k+D*D);M.rotation=Math.PI/2-(D>0?Math.acos(-k/L):-Math.acos(k/L)),M.scaleX=T/L,M.scaleY=L,M.skewX=0,M.skewY=(y*k+b*D)/T}return M.rotation=t.Util._getRotation(M.rotation),M}}t.Transform=n;const i="[object Array]",s="[object Number]",r="[object String]",o="[object Boolean]",a=Math.PI/180,l=180/Math.PI,c="#",h="",p="0",f="Konva warning: ",u="Konva error: ",m="rgb(",_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const g=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(d){setTimeout(d,60)};t.Util={_isElement(d){return!!(d&&d.nodeType==1)},_isFunction(d){return!!(d&&d.constructor&&d.call&&d.apply)},_isPlainObject(d){return!!d&&d.constructor===Object},_isArray(d){return Object.prototype.toString.call(d)===i},_isNumber(d){return Object.prototype.toString.call(d)===s&&!isNaN(d)&&isFinite(d)},_isString(d){return Object.prototype.toString.call(d)===r},_isBoolean(d){return Object.prototype.toString.call(d)===o},isObject(d){return d instanceof Object},isValidSelector(d){if(typeof d!="string")return!1;const y=d[0];return y==="#"||y==="."||y===y.toUpperCase()},_sign(d){return d===0||d>0?1:-1},requestAnimFrame(d){C.push(d),C.length===1&&g(function(){const y=C;C=[],y.forEach(function(b){b()})})},createCanvasElement(){const d=document.createElement("canvas");try{d.style=d.style||{}}catch{}return d},createImageElement(){return document.createElement("img")},_isInDocument(d){for(;d=d.parentNode;)if(d==document)return!0;return!1},_urlToImage(d,y){const b=t.Util.createImageElement();b.onload=function(){y(b)},b.src=d},_rgbToHex(d,y,b){return(16777216+(d<<16)+(y<<8)+b).toString(16).slice(1)},_hexToRgb(d){d=d.replace(c,h);const y=parseInt(d,16);return{r:y>>16&255,g:y>>8&255,b:y&255}},getRandomColor(){let d=(Math.random()*16777215<<0).toString(16);for(;d.length<6;)d=p+d;return c+d},getRGB(d){let y;return d in _?(y=_[d],{r:y[0],g:y[1],b:y[2]}):d[0]===c?this._hexToRgb(d.substring(1)):d.substr(0,4)===m?(y=S.exec(d.replace(/ /g,"")),{r:parseInt(y[1],10),g:parseInt(y[2],10),b:parseInt(y[3],10)}):{r:0,g:0,b:0}},colorToRGBA(d){return d=d||"black",t.Util._namedColorToRBA(d)||t.Util._hex3ColorToRGBA(d)||t.Util._hex4ColorToRGBA(d)||t.Util._hex6ColorToRGBA(d)||t.Util._hex8ColorToRGBA(d)||t.Util._rgbColorToRGBA(d)||t.Util._rgbaColorToRGBA(d)||t.Util._hslColorToRGBA(d)},_namedColorToRBA(d){const y=_[d.toLowerCase()];return y?{r:y[0],g:y[1],b:y[2],a:1}:null},_rgbColorToRGBA(d){if(d.indexOf("rgb(")===0){d=d.match(/rgb\(([^)]+)\)/)[1];const y=d.split(/ *, */).map(Number);return{r:y[0],g:y[1],b:y[2],a:1}}},_rgbaColorToRGBA(d){if(d.indexOf("rgba(")===0){d=d.match(/rgba\(([^)]+)\)/)[1];const y=d.split(/ *, */).map((b,k)=>b.slice(-1)==="%"?k===3?parseInt(b)/100:parseInt(b)/100*255:Number(b));return{r:y[0],g:y[1],b:y[2],a:y[3]}}},_hex8ColorToRGBA(d){if(d[0]==="#"&&d.length===9)return{r:parseInt(d.slice(1,3),16),g:parseInt(d.slice(3,5),16),b:parseInt(d.slice(5,7),16),a:parseInt(d.slice(7,9),16)/255}},_hex6ColorToRGBA(d){if(d[0]==="#"&&d.length===7)return{r:parseInt(d.slice(1,3),16),g:parseInt(d.slice(3,5),16),b:parseInt(d.slice(5,7),16),a:1}},_hex4ColorToRGBA(d){if(d[0]==="#"&&d.length===5)return{r:parseInt(d[1]+d[1],16),g:parseInt(d[2]+d[2],16),b:parseInt(d[3]+d[3],16),a:parseInt(d[4]+d[4],16)/255}},_hex3ColorToRGBA(d){if(d[0]==="#"&&d.length===4)return{r:parseInt(d[1]+d[1],16),g:parseInt(d[2]+d[2],16),b:parseInt(d[3]+d[3],16),a:1}},_hslColorToRGBA(d){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(d)){const[y,...b]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(d),k=Number(b[0])/360,D=Number(b[1])/100,x=Number(b[2])/100;let w,T,M;if(D===0)return M=x*255,{r:Math.round(M),g:Math.round(M),b:Math.round(M),a:1};x<.5?w=x*(1+D):w=x+D-x*D;const L=2*x-w,B=[0,0,0];for(let V=0;V<3;V++)T=k+.3333333333333333*-(V-1),T<0&&T++,T>1&&T--,6*T<1?M=L+(w-L)*6*T:2*T<1?M=w:3*T<2?M=L+(w-L)*(.6666666666666666-T)*6:M=L,B[V]=M*255;return{r:Math.round(B[0]),g:Math.round(B[1]),b:Math.round(B[2]),a:1}}},haveIntersection(d,y){return!(y.x>d.x+d.width||y.x+y.width<d.x||y.y>d.y+d.height||y.y+y.height<d.y)},cloneObject(d){const y={};for(const b in d)this._isPlainObject(d[b])?y[b]=this.cloneObject(d[b]):this._isArray(d[b])?y[b]=this.cloneArray(d[b]):y[b]=d[b];return y},cloneArray(d){return d.slice(0)},degToRad(d){return d*a},radToDeg(d){return d*l},_degToRad(d){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(d)},_radToDeg(d){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(d)},_getRotation(d){return e.Konva.angleDeg?t.Util.radToDeg(d):d},_capitalize(d){return d.charAt(0).toUpperCase()+d.slice(1)},throw(d){throw new Error(u+d)},error(d){console.error(u+d)},warn(d){e.Konva.showWarnings&&console.warn(f+d)},each(d,y){for(const b in d)y(b,d[b])},_inRange(d,y,b){return y<=d&&d<b},_getProjectionToSegment(d,y,b,k,D,x){let w,T,M;const L=(d-b)*(d-b)+(y-k)*(y-k);if(L==0)w=d,T=y,M=(D-b)*(D-b)+(x-k)*(x-k);else{const B=((D-d)*(b-d)+(x-y)*(k-y))/L;B<0?(w=d,T=y,M=(d-D)*(d-D)+(y-x)*(y-x)):B>1?(w=b,T=k,M=(b-D)*(b-D)+(k-x)*(k-x)):(w=d+B*(b-d),T=y+B*(k-y),M=(w-D)*(w-D)+(T-x)*(T-x))}return[w,T,M]},_getProjectionToLine(d,y,b){const k=t.Util.cloneObject(d);let D=Number.MAX_VALUE;return y.forEach(function(x,w){if(!b&&w===y.length-1)return;const T=y[(w+1)%y.length],M=t.Util._getProjectionToSegment(x.x,x.y,T.x,T.y,d.x,d.y),L=M[0],B=M[1],V=M[2];V<D&&(k.x=L,k.y=B,D=V)}),k},_prepareArrayForTween(d,y,b){const k=[],D=[];if(d.length>y.length){const w=y;y=d,d=w}for(let w=0;w<d.length;w+=2)k.push({x:d[w],y:d[w+1]});for(let w=0;w<y.length;w+=2)D.push({x:y[w],y:y[w+1]});const x=[];return D.forEach(function(w){const T=t.Util._getProjectionToLine(w,k,b);x.push(T.x),x.push(T.y)}),x},_prepareToStringify(d){let y;d.visitedByCircularReferenceRemoval=!0;for(const b in d)if(d.hasOwnProperty(b)&&d[b]&&typeof d[b]=="object"){if(y=Object.getOwnPropertyDescriptor(d,b),d[b].visitedByCircularReferenceRemoval||t.Util._isElement(d[b]))if(y.configurable)delete d[b];else return null;else if(t.Util._prepareToStringify(d[b])===null)if(y.configurable)delete d[b];else return null}return delete d.visitedByCircularReferenceRemoval,d},_assign(d,y){for(const b in y)d[b]=y[b];return d},_getFirstPointerId(d){return d.touches?d.changedTouches[0].identifier:d.pointerId||999},releaseCanvas(...d){e.Konva.releaseCanvasOnDestroy&&d.forEach(y=>{y.width=0,y.height=0})},drawRoundedRectPath(d,y,b,k){let D=0,x=0,w=0,T=0;typeof k=="number"?D=x=w=T=Math.min(k,y/2,b/2):(D=Math.min(k[0]||0,y/2,b/2),x=Math.min(k[1]||0,y/2,b/2),T=Math.min(k[2]||0,y/2,b/2),w=Math.min(k[3]||0,y/2,b/2)),d.moveTo(D,0),d.lineTo(y-x,0),d.arc(y-x,x,x,Math.PI*3/2,0,!1),d.lineTo(y,b-T),d.arc(y-T,b-T,T,0,Math.PI/2,!1),d.lineTo(w,b),d.arc(w,b-w,w,Math.PI/2,Math.PI,!1),d.lineTo(0,D),d.arc(D,D,D,Math.PI,Math.PI*3/2,!1)}}}(os)),os}var Fn={},Re={},Ee={},za;function Wa(){if(za)return Ee;za=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.HitContext=Ee.SceneContext=Ee.Context=void 0;const t=Mt(),e=mt();function n(C){const g=[],d=C.length,y=t.Util;for(let b=0;b<d;b++){let k=C[b];y._isNumber(k)?k=Math.round(k*1e3)/1e3:y._isString(k)||(k=k+""),g.push(k)}return g}const i=",",s="(",r=")",o="([",a="])",l=";",c="()",h="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],f=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],u=100;let m=class{constructor(g){this.canvas=g,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(g){g.fillEnabled()&&this._fill(g)}_fill(g){}strokeShape(g){g.hasStroke()&&this._stroke(g)}_stroke(g){}fillStrokeShape(g){g.attrs.fillAfterStrokeEnabled?(this.strokeShape(g),this.fillShape(g)):(this.fillShape(g),this.strokeShape(g))}getTrace(g,d){let y=this.traceArr,b=y.length,k="",D,x,w,T;for(D=0;D<b;D++)x=y[D],w=x.method,w?(T=x.args,k+=w,g?k+=c:t.Util._isArray(T[0])?k+=o+T.join(i)+a:(d&&(T=T.map(M=>typeof M=="number"?Math.floor(M):M)),k+=s+T.join(i)+r)):(k+=x.property,g||(k+=h+x.val)),k+=l;return k}clearTrace(){this.traceArr=[]}_trace(g){let d=this.traceArr,y;d.push(g),y=d.length,y>=u&&d.shift()}reset(){const g=this.getCanvas().getPixelRatio();this.setTransform(1*g,0,0,1*g,0,0)}getCanvas(){return this.canvas}clear(g){const d=this.getCanvas();g?this.clearRect(g.x||0,g.y||0,g.width||0,g.height||0):this.clearRect(0,0,d.getWidth()/d.pixelRatio,d.getHeight()/d.pixelRatio)}_applyLineCap(g){const d=g.attrs.lineCap;d&&this.setAttr("lineCap",d)}_applyOpacity(g){const d=g.getAbsoluteOpacity();d!==1&&this.setAttr("globalAlpha",d)}_applyLineJoin(g){const d=g.attrs.lineJoin;d&&this.setAttr("lineJoin",d)}setAttr(g,d){this._context[g]=d}arc(g,d,y,b,k,D){this._context.arc(g,d,y,b,k,D)}arcTo(g,d,y,b,k){this._context.arcTo(g,d,y,b,k)}beginPath(){this._context.beginPath()}bezierCurveTo(g,d,y,b,k,D){this._context.bezierCurveTo(g,d,y,b,k,D)}clearRect(g,d,y,b){this._context.clearRect(g,d,y,b)}clip(...g){this._context.clip.apply(this._context,g)}closePath(){this._context.closePath()}createImageData(g,d){const y=arguments;if(y.length===2)return this._context.createImageData(g,d);if(y.length===1)return this._context.createImageData(g)}createLinearGradient(g,d,y,b){return this._context.createLinearGradient(g,d,y,b)}createPattern(g,d){return this._context.createPattern(g,d)}createRadialGradient(g,d,y,b,k,D){return this._context.createRadialGradient(g,d,y,b,k,D)}drawImage(g,d,y,b,k,D,x,w,T){const M=arguments,L=this._context;M.length===3?L.drawImage(g,d,y):M.length===5?L.drawImage(g,d,y,b,k):M.length===9&&L.drawImage(g,d,y,b,k,D,x,w,T)}ellipse(g,d,y,b,k,D,x,w){this._context.ellipse(g,d,y,b,k,D,x,w)}isPointInPath(g,d,y,b){return y?this._context.isPointInPath(y,g,d,b):this._context.isPointInPath(g,d,b)}fill(...g){this._context.fill.apply(this._context,g)}fillRect(g,d,y,b){this._context.fillRect(g,d,y,b)}strokeRect(g,d,y,b){this._context.strokeRect(g,d,y,b)}fillText(g,d,y,b){b?this._context.fillText(g,d,y,b):this._context.fillText(g,d,y)}measureText(g){return this._context.measureText(g)}getImageData(g,d,y,b){return this._context.getImageData(g,d,y,b)}lineTo(g,d){this._context.lineTo(g,d)}moveTo(g,d){this._context.moveTo(g,d)}rect(g,d,y,b){this._context.rect(g,d,y,b)}roundRect(g,d,y,b,k){this._context.roundRect(g,d,y,b,k)}putImageData(g,d,y){this._context.putImageData(g,d,y)}quadraticCurveTo(g,d,y,b){this._context.quadraticCurveTo(g,d,y,b)}restore(){this._context.restore()}rotate(g){this._context.rotate(g)}save(){this._context.save()}scale(g,d){this._context.scale(g,d)}setLineDash(g){this._context.setLineDash?this._context.setLineDash(g):"mozDash"in this._context?this._context.mozDash=g:"webkitLineDash"in this._context&&(this._context.webkitLineDash=g)}getLineDash(){return this._context.getLineDash()}setTransform(g,d,y,b,k,D){this._context.setTransform(g,d,y,b,k,D)}stroke(g){g?this._context.stroke(g):this._context.stroke()}strokeText(g,d,y,b){this._context.strokeText(g,d,y,b)}transform(g,d,y,b,k,D){this._context.transform(g,d,y,b,k,D)}translate(g,d){this._context.translate(g,d)}_enableTrace(){let g=this,d=p.length,y=this.setAttr,b,k;const D=function(x){let w=g[x],T;g[x]=function(){return k=n(Array.prototype.slice.call(arguments,0)),T=w.apply(g,arguments),g._trace({method:x,args:k}),T}};for(b=0;b<d;b++)D(p[b]);g.setAttr=function(){y.apply(g,arguments);const x=arguments[0];let w=arguments[1];(x==="shadowOffsetX"||x==="shadowOffsetY"||x==="shadowBlur")&&(w=w/this.canvas.getPixelRatio()),g._trace({property:x,val:w})}}_applyGlobalCompositeOperation(g){const d=g.attrs.globalCompositeOperation;!d||d==="source-over"||this.setAttr("globalCompositeOperation",d)}};Ee.Context=m,f.forEach(function(C){Object.defineProperty(m.prototype,C,{get(){return this._context[C]},set(g){this._context[C]=g}})});class _ extends m{constructor(g,{willReadFrequently:d=!1}={}){super(g),this._context=g._canvas.getContext("2d",{willReadFrequently:d})}_fillColor(g){const d=g.fill();this.setAttr("fillStyle",d),g._fillFunc(this)}_fillPattern(g){this.setAttr("fillStyle",g._getFillPattern()),g._fillFunc(this)}_fillLinearGradient(g){const d=g._getLinearGradient();d&&(this.setAttr("fillStyle",d),g._fillFunc(this))}_fillRadialGradient(g){const d=g._getRadialGradient();d&&(this.setAttr("fillStyle",d),g._fillFunc(this))}_fill(g){const d=g.fill(),y=g.getFillPriority();if(d&&y==="color"){this._fillColor(g);return}const b=g.getFillPatternImage();if(b&&y==="pattern"){this._fillPattern(g);return}const k=g.getFillLinearGradientColorStops();if(k&&y==="linear-gradient"){this._fillLinearGradient(g);return}const D=g.getFillRadialGradientColorStops();if(D&&y==="radial-gradient"){this._fillRadialGradient(g);return}d?this._fillColor(g):b?this._fillPattern(g):k?this._fillLinearGradient(g):D&&this._fillRadialGradient(g)}_strokeLinearGradient(g){const d=g.getStrokeLinearGradientStartPoint(),y=g.getStrokeLinearGradientEndPoint(),b=g.getStrokeLinearGradientColorStops(),k=this.createLinearGradient(d.x,d.y,y.x,y.y);if(b){for(let D=0;D<b.length;D+=2)k.addColorStop(b[D],b[D+1]);this.setAttr("strokeStyle",k)}}_stroke(g){const d=g.dash(),y=g.getStrokeScaleEnabled();if(g.hasStroke()){if(!y){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(g),d&&g.dashEnabled()&&(this.setLineDash(d),this.setAttr("lineDashOffset",g.dashOffset())),this.setAttr("lineWidth",g.strokeWidth()),g.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),g.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(g):this.setAttr("strokeStyle",g.stroke()),g._strokeFunc(this),y||this.restore()}}_applyShadow(g){var d,y,b;const k=(d=g.getShadowRGBA())!==null&&d!==void 0?d:"black",D=(y=g.getShadowBlur())!==null&&y!==void 0?y:5,x=(b=g.getShadowOffset())!==null&&b!==void 0?b:{x:0,y:0},w=g.getAbsoluteScale(),T=this.canvas.getPixelRatio(),M=w.x*T,L=w.y*T;this.setAttr("shadowColor",k),this.setAttr("shadowBlur",D*Math.min(Math.abs(M),Math.abs(L))),this.setAttr("shadowOffsetX",x.x*M),this.setAttr("shadowOffsetY",x.y*L)}}Ee.SceneContext=_;class S extends m{constructor(g){super(g),this._context=g._canvas.getContext("2d",{willReadFrequently:!0})}_fill(g){this.save(),this.setAttr("fillStyle",g.colorKey),g._fillFuncHit(this),this.restore()}strokeShape(g){g.hasHitStroke()&&this._stroke(g)}_stroke(g){if(g.hasHitStroke()){const d=g.getStrokeScaleEnabled();if(!d){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(g);const y=g.hitStrokeWidth(),b=y==="auto"?g.strokeWidth():y;this.setAttr("lineWidth",b),this.setAttr("strokeStyle",g.colorKey),g._strokeFuncHit(this),d||this.restore()}}}return Ee.HitContext=S,Ee}var $a;function sr(){if($a)return Re;$a=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.HitCanvas=Re.SceneCanvas=Re.Canvas=void 0;const t=Mt(),e=Wa(),n=mt();let i;function s(){if(i)return i;const l=t.Util.createCanvasElement(),c=l.getContext("2d");return i=function(){const h=n.Konva._global.devicePixelRatio||1,p=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;return h/p}(),t.Util.releaseCanvas(l),i}let r=class{constructor(c){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const p=(c||{}).pixelRatio||n.Konva.pixelRatio||s();this.pixelRatio=p,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(c){const h=this.pixelRatio;this.pixelRatio=c,this.setSize(this.getWidth()/h,this.getHeight()/h)}setWidth(c){this.width=this._canvas.width=c*this.pixelRatio,this._canvas.style.width=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}setHeight(c){this.height=this._canvas.height=c*this.pixelRatio,this._canvas.style.height=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}getWidth(){return this.width}getHeight(){return this.height}setSize(c,h){this.setWidth(c||0),this.setHeight(h||0)}toDataURL(c,h){try{return this._canvas.toDataURL(c,h)}catch{try{return this._canvas.toDataURL()}catch(f){return t.Util.error("Unable to get data URL. "+f.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Re.Canvas=r;class o extends r{constructor(c={width:0,height:0,willReadFrequently:!1}){super(c),this.context=new e.SceneContext(this,{willReadFrequently:c.willReadFrequently}),this.setSize(c.width,c.height)}}Re.SceneCanvas=o;class a extends r{constructor(c={width:0,height:0}){super(c),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(c.width,c.height)}}return Re.HitCanvas=a,Re}var as={},ja;function ls(){return ja||(ja=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=mt(),n=Mt();t.DD={get isDragging(){let i=!1;return t.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return t.DD._dragElements.forEach(s=>{i=s.node}),i},_dragElements:new Map,_drag(i){const s=[];t.DD._dragElements.forEach((r,o)=>{const{node:a}=r,l=a.getStage();l.setPointersPositions(i),r.pointerId===void 0&&(r.pointerId=n.Util._getFirstPointerId(i));const c=l._changedPointerPositions.find(h=>h.id===r.pointerId);if(c){if(r.dragStatus!=="dragging"){const h=a.dragDistance();if(Math.max(Math.abs(c.x-r.startPointerPos.x),Math.abs(c.y-r.startPointerPos.y))<h||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,r),s.push(a)}}),s.forEach(r=>{r.fire("dragmove",{type:"dragmove",target:r,evt:i},!0)})},_endDragBefore(i){const s=[];t.DD._dragElements.forEach(r=>{const{node:o}=r,a=o.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(h=>h.id===r.pointerId))return;(r.dragStatus==="dragging"||r.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,r.dragStatus="stopped");const c=r.node.getLayer()||r.node instanceof e.Konva.Stage&&r.node;c&&s.indexOf(c)===-1&&s.push(c)}),s.forEach(r=>{r.draw()})},_endDragAfter(i){t.DD._dragElements.forEach((s,r)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:i},!0),s.dragStatus!=="dragging"&&t.DD._dragElements.delete(r)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))}(as)),as}var cs={},jt={},qa;function _t(){if(qa)return jt;qa=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.RGBComponent=i,jt.alphaComponent=s,jt.getNumberValidator=r,jt.getNumberOrArrayOfNumbersValidator=o,jt.getNumberOrAutoValidator=a,jt.getStringValidator=l,jt.getStringOrGradientValidator=c,jt.getFunctionValidator=h,jt.getNumberArrayValidator=p,jt.getBooleanValidator=f,jt.getComponentValidator=u;const t=mt(),e=Mt();function n(m){return e.Util._isString(m)?'"'+m+'"':Object.prototype.toString.call(m)==="[object Number]"||e.Util._isBoolean(m)?m:Object.prototype.toString.call(m)}function i(m){return m>255?255:m<0?0:Math.round(m)}function s(m){return m>1?1:m<1e-4?1e-4:m}function r(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isNumber(m)||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a number.'),m}}function o(m){if(t.Konva.isUnminified)return function(_,S){let C=e.Util._isNumber(_),g=e.Util._isArray(_)&&_.length==m;return!C&&!g&&e.Util.warn(n(_)+' is a not valid value for "'+S+'" attribute. The value should be a number or Array<number>('+m+")"),_}}function a(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isNumber(m)||m==="auto"||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a number or "auto".'),m}}function l(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isString(m)||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a string.'),m}}function c(){if(t.Konva.isUnminified)return function(m,_){const S=e.Util._isString(m),C=Object.prototype.toString.call(m)==="[object CanvasGradient]"||m&&m.addColorStop;return S||C||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a string or a native gradient.'),m}}function h(){if(t.Konva.isUnminified)return function(m,_){return e.Util._isFunction(m)||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a function.'),m}}function p(){if(t.Konva.isUnminified)return function(m,_){const S=Int8Array?Object.getPrototypeOf(Int8Array):null;return S&&m instanceof S||(e.Util._isArray(m)?m.forEach(function(C){e.Util._isNumber(C)||e.Util.warn('"'+_+'" attribute has non numeric element '+C+". Make sure that all elements are numbers.")}):e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a array of numbers.')),m}}function f(){if(t.Konva.isUnminified)return function(m,_){return m===!0||m===!1||e.Util.warn(n(m)+' is a not valid value for "'+_+'" attribute. The value should be a boolean.'),m}}function u(m){if(t.Konva.isUnminified)return function(_,S){return _==null||e.Util.isObject(_)||e.Util.warn(n(_)+' is a not valid value for "'+S+'" attribute. The value should be an object with properties '+m),_}}return jt}var Ka;function yt(){return Ka||(Ka=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Mt(),n=_t(),i="get",s="set";t.Factory={addGetterSetter(r,o,a,l,c){t.Factory.addGetter(r,o,a),t.Factory.addSetter(r,o,l,c),t.Factory.addOverloadedGetterSetter(r,o)},addGetter(r,o,a){const l=i+e.Util._capitalize(o);r.prototype[l]=r.prototype[l]||function(){const c=this.attrs[o];return c===void 0?a:c}},addSetter(r,o,a,l){const c=s+e.Util._capitalize(o);r.prototype[c]||t.Factory.overWriteSetter(r,o,a,l)},overWriteSetter(r,o,a,l){const c=s+e.Util._capitalize(o);r.prototype[c]=function(h){return a&&h!==void 0&&h!==null&&(h=a.call(this,h,o)),this._setAttr(o,h),l&&l.call(this),this}},addComponentsGetterSetter(r,o,a,l,c){const h=a.length,p=e.Util._capitalize,f=i+p(o),u=s+p(o);r.prototype[f]=function(){const _={};for(let S=0;S<h;S++){const C=a[S];_[C]=this.getAttr(o+p(C))}return _};const m=(0,n.getComponentValidator)(a);r.prototype[u]=function(_){const S=this.attrs[o];l&&(_=l.call(this,_,o)),m&&m.call(this,_,o);for(const C in _)_.hasOwnProperty(C)&&this._setAttr(o+p(C),_[C]);return _||a.forEach(C=>{this._setAttr(o+p(C),void 0)}),this._fireChangeEvent(o,S,_),c&&c.call(this),this},t.Factory.addOverloadedGetterSetter(r,o)},addOverloadedGetterSetter(r,o){const a=e.Util._capitalize(o),l=s+a,c=i+a;r.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(r,o,a,l){e.Util.error("Adding deprecated "+o);const c=i+e.Util._capitalize(o),h=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";r.prototype[c]=function(){e.Util.error(h);const p=this.attrs[o];return p===void 0?a:p},t.Factory.addSetter(r,o,l,function(){e.Util.error(h)}),t.Factory.addOverloadedGetterSetter(r,o)},backCompat(r,o){e.Util.each(o,function(a,l){const c=r.prototype[l],h=i+e.Util._capitalize(a),p=s+e.Util._capitalize(a);function f(){c.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}r.prototype[a]=f,r.prototype[h]=f,r.prototype[p]=f})},afterSetFilter(){this._filterUpToDate=!1}}}(cs)),cs}var Ya;function Ft(){if(Ya)return Fn;Ya=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.Node=void 0;const t=sr(),e=ls(),n=yt(),i=mt(),s=Mt(),r=_t(),o="absoluteOpacity",a="allEventListeners",l="absoluteTransform",c="absoluteScale",h="canvas",p="Change",f="children",u="konva",m="listening",_="mouseenter",S="mouseleave",C="pointerenter",g="pointerleave",d="touchenter",y="touchleave",b="set",k="Shape",D=" ",x="stage",w="transform",T="Stage",M="visible",L=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(D);let B=1,V=class Vs{constructor(v){this._id=B++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(v),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(v){(v===w||v===l)&&this._cache.get(v)?this._cache.get(v).dirty=!0:v?this._cache.delete(v):this._cache.clear()}_getCache(v,P){let E=this._cache.get(v);return(E===void 0||(v===w||v===l)&&E.dirty===!0)&&(E=P.call(this),this._cache.set(v,E)),E}_calculate(v,P,E){if(!this._attachedDepsListeners.get(v)){const A=P.map(O=>O+"Change.konva").join(D);this.on(A,()=>{this._clearCache(v)}),this._attachedDepsListeners.set(v,!0)}return this._getCache(v,E)}_getCanvasCache(){return this._cache.get(h)}_clearSelfAndDescendantCache(v){this._clearCache(v),v===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(h)){const{scene:v,filter:P,hit:E,buffer:A}=this._cache.get(h);s.Util.releaseCanvas(v,P,E,A),this._cache.delete(h)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(v){const P=v||{};let E={};(P.x===void 0||P.y===void 0||P.width===void 0||P.height===void 0)&&(E=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let A=Math.ceil(P.width||E.width),O=Math.ceil(P.height||E.height),j=P.pixelRatio,H=P.x===void 0?Math.floor(E.x):P.x,X=P.y===void 0?Math.floor(E.y):P.y,rt=P.offset||0,$=P.drawBorder||!1,F=P.hitCanvasPixelRatio||1;if(!A||!O){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const z=Math.abs(Math.round(E.x)-H)>.5?1:0,et=Math.abs(Math.round(E.y)-X)>.5?1:0;A+=rt*2+z,O+=rt*2+et,H-=rt,X-=rt;const it=new t.SceneCanvas({pixelRatio:j,width:A,height:O}),ct=new t.SceneCanvas({pixelRatio:j,width:0,height:0,willReadFrequently:!0}),R=new t.HitCanvas({pixelRatio:F,width:A,height:O}),N=it.getContext(),W=R.getContext(),G=new t.SceneCanvas({width:it.width/it.pixelRatio+Math.abs(H),height:it.height/it.pixelRatio+Math.abs(X),pixelRatio:it.pixelRatio}),I=G.getContext();return R.isCache=!0,it.isCache=!0,this._cache.delete(h),this._filterUpToDate=!1,P.imageSmoothingEnabled===!1&&(it.getContext()._context.imageSmoothingEnabled=!1,ct.getContext()._context.imageSmoothingEnabled=!1),N.save(),W.save(),I.save(),N.translate(-H,-X),W.translate(-H,-X),I.translate(-H,-X),G.x=H,G.y=X,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this.drawScene(it,this,G),this.drawHit(R,this),this._isUnderCache=!1,N.restore(),W.restore(),$&&(N.save(),N.beginPath(),N.rect(0,0,A,O),N.closePath(),N.setAttr("strokeStyle","red"),N.setAttr("lineWidth",5),N.stroke(),N.restore()),this._cache.set(h,{scene:it,filter:ct,hit:R,buffer:G,x:H,y:X}),this._requestDraw(),this}isCached(){return this._cache.has(h)}getClientRect(v){throw new Error('abstract "getClientRect" method call')}_transformedRect(v,P){const E=[{x:v.x,y:v.y},{x:v.x+v.width,y:v.y},{x:v.x+v.width,y:v.y+v.height},{x:v.x,y:v.y+v.height}];let A=1/0,O=1/0,j=-1/0,H=-1/0;const X=this.getAbsoluteTransform(P);return E.forEach(function(rt){const $=X.point(rt);A===void 0&&(A=j=$.x,O=H=$.y),A=Math.min(A,$.x),O=Math.min(O,$.y),j=Math.max(j,$.x),H=Math.max(H,$.y)}),{x:A,y:O,width:j-A,height:H-O}}_drawCachedSceneCanvas(v){v.save(),v._applyOpacity(this),v._applyGlobalCompositeOperation(this);const P=this._getCanvasCache();v.translate(P.x,P.y);const E=this._getCachedSceneCanvas(),A=E.pixelRatio;v.drawImage(E._canvas,0,0,E.width/A,E.height/A),v.restore()}_drawCachedHitCanvas(v){const P=this._getCanvasCache(),E=P.hit;v.save(),v.translate(P.x,P.y),v.drawImage(E._canvas,0,0,E.width/E.pixelRatio,E.height/E.pixelRatio),v.restore()}_getCachedSceneCanvas(){let v=this.filters(),P=this._getCanvasCache(),E=P.scene,A=P.filter,O=A.getContext(),j,H,X,rt;if(v){if(!this._filterUpToDate){const $=E.pixelRatio;A.setSize(E.width/E.pixelRatio,E.height/E.pixelRatio);try{for(j=v.length,O.clear(),O.drawImage(E._canvas,0,0,E.getWidth()/$,E.getHeight()/$),H=O.getImageData(0,0,A.getWidth(),A.getHeight()),X=0;X<j;X++){if(rt=v[X],typeof rt!="function"){s.Util.error("Filter should be type of function, but got "+typeof rt+" instead. Please check correct filters");continue}rt.call(this,H),O.putImageData(H,0,0)}}catch(F){s.Util.error("Unable to apply filter. "+F.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return A}return E}on(v,P){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const E=v.split(D);for(let A=0;A<E.length;A++){const j=E[A].split("."),H=j[0],X=j[1]||"";this.eventListeners[H]||(this.eventListeners[H]=[]),this.eventListeners[H].push({name:X,handler:P})}return this}off(v,P){let E=(v||"").split(D),A=E.length,O,j,H,X,rt,$;if(this._cache&&this._cache.delete(a),!v)for(j in this.eventListeners)this._off(j);for(O=0;O<A;O++)if(H=E[O],X=H.split("."),rt=X[0],$=X[1],rt)this.eventListeners[rt]&&this._off(rt,$,P);else for(j in this.eventListeners)this._off(j,$,P);return this}dispatchEvent(v){const P={target:this,type:v.type,evt:v};return this.fire(v.type,P),this}addEventListener(v,P){return this.on(v,function(E){P.call(this,E.evt)}),this}removeEventListener(v){return this.off(v),this}_delegate(v,P,E){const A=this;this.on(v,function(O){const j=O.target.findAncestors(P,!0,A);for(let H=0;H<j.length;H++)O=s.Util.cloneObject(O),O.currentTarget=j[H],E.call(j[H],O)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(x),this._clearSelfAndDescendantCache(M),this._clearSelfAndDescendantCache(m)}_remove(){this._clearCaches();const v=this.getParent();v&&v.children&&(v.children.splice(this.index,1),v._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(v){const P="get"+s.Util._capitalize(v);return s.Util._isFunction(this[P])?this[P]():this.attrs[v]}getAncestors(){let v=this.getParent(),P=[];for(;v;)P.push(v),v=v.getParent();return P}getAttrs(){return this.attrs||{}}setAttrs(v){return this._batchTransformChanges(()=>{let P,E;if(!v)return this;for(P in v)P!==f&&(E=b+s.Util._capitalize(P),s.Util._isFunction(this[E])?this[E](v[P]):this._setAttr(P,v[P]))}),this}isListening(){return this._getCache(m,this._isListening)}_isListening(v){if(!this.listening())return!1;const E=this.getParent();return E&&E!==v&&this!==v?E._isListening(v):!0}isVisible(){return this._getCache(M,this._isVisible)}_isVisible(v){if(!this.visible())return!1;const E=this.getParent();return E&&E!==v&&this!==v?E._isVisible(v):!0}shouldDrawHit(v,P=!1){if(v)return this._isVisible(v)&&this._isListening(v);const E=this.getLayer();let A=!1;e.DD._dragElements.forEach(j=>{j.dragStatus==="dragging"&&(j.node.nodeType==="Stage"||j.node.getLayer()===E)&&(A=!0)});const O=!P&&!i.Konva.hitOnDragEnabled&&(A||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!O}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let v=this.getDepth(),P=this,E=0,A,O,j,H;function X($){for(A=[],O=$.length,j=0;j<O;j++)H=$[j],E++,H.nodeType!==k&&(A=A.concat(H.getChildren().slice())),H._id===P._id&&(j=O);A.length>0&&A[0].getDepth()<=v&&X(A)}const rt=this.getStage();return P.nodeType!==T&&rt&&X(rt.getChildren()),E}getDepth(){let v=0,P=this.parent;for(;P;)v++,P=P.parent;return v}_batchTransformChanges(v){this._batchingTransformChange=!0,v(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(w),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(v){return this._batchTransformChanges(()=>{this.x(v.x),this.y(v.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const v=this.getStage();if(!v)return null;const P=v.getPointerPosition();if(!P)return null;const E=this.getAbsoluteTransform().copy();return E.invert(),E.point(P)}getAbsolutePosition(v){let P=!1,E=this.parent;for(;E;){if(E.isCached()){P=!0;break}E=E.parent}P&&!v&&(v=!0);const A=this.getAbsoluteTransform(v).getMatrix(),O=new s.Transform,j=this.offset();return O.m=A.slice(),O.translate(j.x,j.y),O.getTranslation()}setAbsolutePosition(v){const{x:P,y:E,...A}=this._clearTransform();this.attrs.x=P,this.attrs.y=E,this._clearCache(w);const O=this._getAbsoluteTransform().copy();return O.invert(),O.translate(v.x,v.y),v={x:this.attrs.x+O.getTranslation().x,y:this.attrs.y+O.getTranslation().y},this._setTransform(A),this.setPosition({x:v.x,y:v.y}),this._clearCache(w),this._clearSelfAndDescendantCache(l),this}_setTransform(v){let P;for(P in v)this.attrs[P]=v[P]}_clearTransform(){const v={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,v}move(v){let P=v.x,E=v.y,A=this.x(),O=this.y();return P!==void 0&&(A+=P),E!==void 0&&(O+=E),this.setPosition({x:A,y:O}),this}_eachAncestorReverse(v,P){let E=[],A=this.getParent(),O,j;if(!(P&&P._id===this._id)){for(E.unshift(this);A&&(!P||A._id!==P._id);)E.unshift(A),A=A.parent;for(O=E.length,j=0;j<O;j++)v(E[j])}}rotate(v){return this.rotation(this.rotation()+v),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const v=this.index,P=this.parent.getChildren().length;return v<P-1?(this.parent.children.splice(v,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const v=this.index,P=this.parent.getChildren().length;return v<P-1?(this.parent.children.splice(v,1),this.parent.children.splice(v+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const v=this.index;return v>0?(this.parent.children.splice(v,1),this.parent.children.splice(v-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const v=this.index;return v>0?(this.parent.children.splice(v,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(v){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(v<0||v>=this.parent.children.length)&&s.Util.warn("Unexpected value "+v+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const P=this.index;return this.parent.children.splice(P,1),this.parent.children.splice(v,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let v=this.opacity();const P=this.getParent();return P&&!P._isUnderCache&&(v*=P.getAbsoluteOpacity()),v}moveTo(v){return this.getParent()!==v&&(this._remove(),v.add(this)),this}toObject(){let v=this.getAttrs(),P,E,A,O,j;const H={attrs:{},className:this.getClassName()};for(P in v)E=v[P],j=s.Util.isObject(E)&&!s.Util._isPlainObject(E)&&!s.Util._isArray(E),!j&&(A=typeof this[P]=="function"&&this[P],delete v[P],O=A?A.call(this):null,v[P]=E,O!==E&&(H.attrs[P]=E));return s.Util._prepareToStringify(H)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(v,P,E){const A=[];P&&this._isMatch(v)&&A.push(this);let O=this.parent;for(;O;){if(O===E)return A;O._isMatch(v)&&A.push(O),O=O.parent}return A}isAncestorOf(v){return!1}findAncestor(v,P,E){return this.findAncestors(v,P,E)[0]}_isMatch(v){if(!v)return!1;if(typeof v=="function")return v(this);let P=v.replace(/ /g,"").split(","),E=P.length,A,O;for(A=0;A<E;A++)if(O=P[A],s.Util.isValidSelector(O)||(s.Util.warn('Selector "'+O+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),O.charAt(0)==="#"){if(this.id()===O.slice(1))return!0}else if(O.charAt(0)==="."){if(this.hasName(O.slice(1)))return!0}else if(this.className===O||this.nodeType===O)return!0;return!1}getLayer(){const v=this.getParent();return v?v.getLayer():null}getStage(){return this._getCache(x,this._getStage)}_getStage(){const v=this.getParent();return v?v.getStage():null}fire(v,P={},E){return P.target=P.target||this,E?this._fireAndBubble(v,P):this._fire(v,P),this}getAbsoluteTransform(v){return v?this._getAbsoluteTransform(v):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(v){let P;if(v)return P=new s.Transform,this._eachAncestorReverse(function(E){const A=E.transformsEnabled();A==="all"?P.multiply(E.getTransform()):A==="position"&&P.translate(E.x()-E.offsetX(),E.y()-E.offsetY())},v),P;{P=this._cache.get(l)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(P):P.reset();const E=this.transformsEnabled();if(E==="all")P.multiply(this.getTransform());else if(E==="position"){const A=this.attrs.x||0,O=this.attrs.y||0,j=this.attrs.offsetX||0,H=this.attrs.offsetY||0;P.translate(A-j,O-H)}return P.dirty=!1,P}}getAbsoluteScale(v){let P=this;for(;P;)P._isUnderCache&&(v=P),P=P.getParent();const A=this.getAbsoluteTransform(v).decompose();return{x:A.scaleX,y:A.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(w,this._getTransform)}_getTransform(){var v,P;const E=this._cache.get(w)||new s.Transform;E.reset();const A=this.x(),O=this.y(),j=i.Konva.getAngle(this.rotation()),H=(v=this.attrs.scaleX)!==null&&v!==void 0?v:1,X=(P=this.attrs.scaleY)!==null&&P!==void 0?P:1,rt=this.attrs.skewX||0,$=this.attrs.skewY||0,F=this.attrs.offsetX||0,z=this.attrs.offsetY||0;return(A!==0||O!==0)&&E.translate(A,O),j!==0&&E.rotate(j),(rt!==0||$!==0)&&E.skew(rt,$),(H!==1||X!==1)&&E.scale(H,X),(F!==0||z!==0)&&E.translate(-1*F,-1*z),E.dirty=!1,E}clone(v){let P=s.Util.cloneObject(this.attrs),E,A,O,j,H;for(E in v)P[E]=v[E];const X=new this.constructor(P);for(E in this.eventListeners)for(A=this.eventListeners[E],O=A.length,j=0;j<O;j++)H=A[j],H.name.indexOf(u)<0&&(X.eventListeners[E]||(X.eventListeners[E]=[]),X.eventListeners[E].push(H));return X}_toKonvaCanvas(v){v=v||{};const P=this.getClientRect(),E=this.getStage(),A=v.x!==void 0?v.x:Math.floor(P.x),O=v.y!==void 0?v.y:Math.floor(P.y),j=v.pixelRatio||1,H=new t.SceneCanvas({width:v.width||Math.ceil(P.width)||(E?E.width():0),height:v.height||Math.ceil(P.height)||(E?E.height():0),pixelRatio:j}),X=H.getContext(),rt=new t.SceneCanvas({width:H.width/H.pixelRatio+Math.abs(A),height:H.height/H.pixelRatio+Math.abs(O),pixelRatio:H.pixelRatio});return v.imageSmoothingEnabled===!1&&(X._context.imageSmoothingEnabled=!1),X.save(),(A||O)&&X.translate(-1*A,-1*O),this.drawScene(H,void 0,rt),X.restore(),H}toCanvas(v){return this._toKonvaCanvas(v)._canvas}toDataURL(v){v=v||{};const P=v.mimeType||null,E=v.quality||null,A=this._toKonvaCanvas(v).toDataURL(P,E);return v.callback&&v.callback(A),A}toImage(v){return new Promise((P,E)=>{try{const A=v?.callback;A&&delete v.callback,s.Util._urlToImage(this.toDataURL(v),function(O){P(O),A?.(O)})}catch(A){E(A)}})}toBlob(v){return new Promise((P,E)=>{try{const A=v?.callback;A&&delete v.callback,this.toCanvas(v).toBlob(O=>{P(O),A?.(O)},v?.mimeType,v?.quality)}catch(A){E(A)}})}setSize(v){return this.width(v.width),this.height(v.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(v,P,E){let A=this.eventListeners[v],O,j,H;for(O=0;O<A.length;O++)if(j=A[O].name,H=A[O].handler,(j!=="konva"||P==="konva")&&(!P||j===P)&&(!E||E===H)){if(A.splice(O,1),A.length===0){delete this.eventListeners[v];break}O--}}_fireChangeEvent(v,P,E){this._fire(v+p,{oldVal:P,newVal:E})}addName(v){if(!this.hasName(v)){const P=this.name(),E=P?P+" "+v:v;this.name(E)}return this}hasName(v){if(!v)return!1;const P=this.name();return P?(P||"").split(/\s/g).indexOf(v)!==-1:!1}removeName(v){const P=(this.name()||"").split(/\s/g),E=P.indexOf(v);return E!==-1&&(P.splice(E,1),this.name(P.join(" "))),this}setAttr(v,P){const E=this[b+s.Util._capitalize(v)];return s.Util._isFunction(E)?E.call(this,P):this._setAttr(v,P),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const v=this.getLayer()||this.getStage();v?.batchDraw()}}_setAttr(v,P){const E=this.attrs[v];E===P&&!s.Util.isObject(P)||(P==null?delete this.attrs[v]:this.attrs[v]=P,this._shouldFireChangeEvents&&this._fireChangeEvent(v,E,P),this._requestDraw())}_setComponentAttr(v,P,E){let A;E!==void 0&&(A=this.attrs[v],A||(this.attrs[v]=this.getAttr(v)),this.attrs[v][P]=E,this._fireChangeEvent(v,A,E))}_fireAndBubble(v,P,E){P&&this.nodeType===k&&(P.target=this);const A=[_,S,C,g,d,y];if(!(A.indexOf(v)!==-1&&(E&&(this===E||this.isAncestorOf&&this.isAncestorOf(E))||this.nodeType==="Stage"&&!E))){this._fire(v,P);const j=A.indexOf(v)!==-1&&E&&E.isAncestorOf&&E.isAncestorOf(this)&&!E.isAncestorOf(this.parent);(P&&!P.cancelBubble||!P)&&this.parent&&this.parent.isListening()&&!j&&(E&&E.parent?this._fireAndBubble.call(this.parent,v,P,E):this._fireAndBubble.call(this.parent,v,P))}}_getProtoListeners(v){var P,E,A;const O=(P=this._cache.get(a))!==null&&P!==void 0?P:{};let j=O?.[v];if(j===void 0){j=[];let H=Object.getPrototypeOf(this);for(;H;){const X=(A=(E=H.eventListeners)===null||E===void 0?void 0:E[v])!==null&&A!==void 0?A:[];j.push(...X),H=Object.getPrototypeOf(H)}O[v]=j,this._cache.set(a,O)}return j}_fire(v,P){P=P||{},P.currentTarget=this,P.type=v;const E=this._getProtoListeners(v);if(E)for(let O=0;O<E.length;O++)E[O].handler.call(this,P);const A=this.eventListeners[v];if(A)for(let O=0;O<A.length;O++)A[O].handler.call(this,P)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(v){const P=v?v.pointerId:void 0,E=this.getStage(),A=this.getAbsolutePosition();if(!E)return;const O=E._getPointerById(P)||E._changedPointerPositions[0]||A;e.DD._dragElements.set(this._id,{node:this,startPointerPos:O,offset:{x:O.x-A.x,y:O.y-A.y},dragStatus:"ready",pointerId:P})}startDrag(v,P=!0){e.DD._dragElements.has(this._id)||this._createDragElement(v);const E=e.DD._dragElements.get(this._id);E.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:v&&v.evt},P)}_setDragPosition(v,P){const E=this.getStage()._getPointerById(P.pointerId);if(!E)return;let A={x:E.x-P.offset.x,y:E.y-P.offset.y};const O=this.dragBoundFunc();if(O!==void 0){const j=O.call(this,A,v);j?A=j:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==A.x||this._lastPos.y!==A.y)&&(this.setAbsolutePosition(A),this._requestDraw()),this._lastPos=A}stopDrag(v){const P=e.DD._dragElements.get(this._id);P&&(P.dragStatus="stopped"),e.DD._endDragBefore(v),e.DD._endDragAfter(v)}setDraggable(v){this._setAttr("draggable",v),this._dragChange()}isDragging(){const v=e.DD._dragElements.get(this._id);return v?v.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(v){if(!(!(v.evt.button!==void 0)||i.Konva.dragButtons.indexOf(v.evt.button)>=0)||this.isDragging())return;let A=!1;e.DD._dragElements.forEach(O=>{this.isAncestorOf(O.node)&&(A=!0)}),A||this._createDragElement(v)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const P=e.DD._dragElements.get(this._id),E=P&&P.dragStatus==="dragging",A=P&&P.dragStatus==="ready";E?this.stopDrag():A&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(v={x:0,y:0}){const P=this.getStage();if(!P)return!1;const E={x:-v.x,y:-v.y,width:P.width()+2*v.x,height:P.height()+2*v.y};return s.Util.haveIntersection(E,this.getClientRect())}static create(v,P){return s.Util._isString(v)&&(v=JSON.parse(v)),this._createNode(v,P)}static _createNode(v,P){let E=Vs.prototype.getClassName.call(v),A=v.children,O,j,H;P&&(v.attrs.container=P),i.Konva[E]||(s.Util.warn('Can not find a node with class name "'+E+'". Fallback to "Shape".'),E="Shape");const X=i.Konva[E];if(O=new X(v.attrs),A)for(j=A.length,H=0;H<j;H++)O.add(Vs._createNode(A[H]));return O}};Fn.Node=V,V.prototype.nodeType="Node",V.prototype._attrsAffectingSize=[],V.prototype.eventListeners={},V.prototype.on.call(V.prototype,L,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(w),this._clearSelfAndDescendantCache(l)}),V.prototype.on.call(V.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(M)}),V.prototype.on.call(V.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(m)}),V.prototype.on.call(V.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const U=n.Factory.addGetterSetter;return U(V,"zIndex"),U(V,"absolutePosition"),U(V,"position"),U(V,"x",0,(0,r.getNumberValidator)()),U(V,"y",0,(0,r.getNumberValidator)()),U(V,"globalCompositeOperation","source-over",(0,r.getStringValidator)()),U(V,"opacity",1,(0,r.getNumberValidator)()),U(V,"name","",(0,r.getStringValidator)()),U(V,"id","",(0,r.getStringValidator)()),U(V,"rotation",0,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(V,"scale",["x","y"]),U(V,"scaleX",1,(0,r.getNumberValidator)()),U(V,"scaleY",1,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(V,"skew",["x","y"]),U(V,"skewX",0,(0,r.getNumberValidator)()),U(V,"skewY",0,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(V,"offset",["x","y"]),U(V,"offsetX",0,(0,r.getNumberValidator)()),U(V,"offsetY",0,(0,r.getNumberValidator)()),U(V,"dragDistance",void 0,(0,r.getNumberValidator)()),U(V,"width",0,(0,r.getNumberValidator)()),U(V,"height",0,(0,r.getNumberValidator)()),U(V,"listening",!0,(0,r.getBooleanValidator)()),U(V,"preventDefault",!0,(0,r.getBooleanValidator)()),U(V,"filters",void 0,function(K){return this._filterUpToDate=!1,K}),U(V,"visible",!0,(0,r.getBooleanValidator)()),U(V,"transformsEnabled","all",(0,r.getStringValidator)()),U(V,"size"),U(V,"dragBoundFunc"),U(V,"draggable",!1,(0,r.getBooleanValidator)()),n.Factory.backCompat(V,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Fn}var Dn={},Xa;function or(){if(Xa)return Dn;Xa=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.Container=void 0;const t=yt(),e=Ft(),n=_t();let i=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(r){const o=this.children||[];return r?o.filter(r):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(r=>{r.parent=null,r.index=0,r.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(r=>{r.parent=null,r.index=0,r.destroy()}),this.children=[],this._requestDraw(),this}add(...r){if(r.length===0)return this;if(r.length>1){for(let a=0;a<r.length;a++)this.add(r[a]);return this}const o=r[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(r){return this._generalFind(r,!1)}findOne(r){const o=this._generalFind(r,!0);return o.length>0?o[0]:void 0}_generalFind(r,o){const a=[];return this._descendants(l=>{const c=l._isMatch(r);return c&&a.push(l),!!(c&&o)}),a}_descendants(r){let o=!1;const a=this.getChildren();for(const l of a){if(o=r(l),o)return!0;if(l.hasChildren()&&(o=l._descendants(r),o))return!0}return!1}toObject(){const r=e.Node.prototype.toObject.call(this);return r.children=[],this.getChildren().forEach(o=>{r.children.push(o.toObject())}),r}isAncestorOf(r){let o=r.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(r){const o=e.Node.prototype.clone.call(this,r);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(r){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(r)&&o.push(a)}),o}_clearSelfAndDescendantCache(r){var o;super._clearSelfAndDescendantCache(r),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(r)}))}_setChildrenIndices(){var r;(r=this.children)===null||r===void 0||r.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(r,o,a){const l=this.getLayer(),c=r||l&&l.getCanvas(),h=c&&c.getContext(),p=this._getCanvasCache(),f=p&&p.scene,u=c&&c.isCache;if(!this.isVisible()&&!u)return this;if(f){h.save();const m=this.getAbsoluteTransform(o).getMatrix();h.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedSceneCanvas(h),h.restore()}else this._drawChildren("drawScene",c,o,a);return this}drawHit(r,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),l=r||a&&a.hitCanvas,c=l&&l.getContext(),h=this._getCanvasCache();if(h&&h.hit){c.save();const f=this.getAbsoluteTransform(o).getMatrix();c.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",l,o);return this}_drawChildren(r,o,a,l){var c;const h=o&&o.getContext(),p=this.clipWidth(),f=this.clipHeight(),u=this.clipFunc(),m=typeof p=="number"&&typeof f=="number"||u,_=a===this;if(m){h.save();const C=this.getAbsoluteTransform(a);let g=C.getMatrix();h.transform(g[0],g[1],g[2],g[3],g[4],g[5]),h.beginPath();let d;if(u)d=u.call(this,h,this);else{const y=this.clipX(),b=this.clipY();h.rect(y||0,b||0,p,f)}h.clip.apply(h,d),g=C.copy().invert().getMatrix(),h.transform(g[0],g[1],g[2],g[3],g[4],g[5])}const S=!_&&this.globalCompositeOperation()!=="source-over"&&r==="drawScene";S&&(h.save(),h._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(C){C[r](o,a,l)}),S&&h.restore(),m&&h.restore()}getClientRect(r={}){var o;const a=r.skipTransform,l=r.relativeTo;let c,h,p,f,u={x:1/0,y:1/0,width:0,height:0};const m=this;(o=this.children)===null||o===void 0||o.forEach(function(C){if(!C.visible())return;const g=C.getClientRect({relativeTo:m,skipShadow:r.skipShadow,skipStroke:r.skipStroke});g.width===0&&g.height===0||(c===void 0?(c=g.x,h=g.y,p=g.x+g.width,f=g.y+g.height):(c=Math.min(c,g.x),h=Math.min(h,g.y),p=Math.max(p,g.x+g.width),f=Math.max(f,g.y+g.height)))});const _=this.find("Shape");let S=!1;for(let C=0;C<_.length;C++)if(_[C]._isVisible(this)){S=!0;break}return S&&c!==void 0?u={x:c,y:h,width:p-c,height:f-h}:u={x:0,y:0,width:0,height:0},a?u:this._transformedRect(u,l)}};return Dn.Container=i,t.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipFunc"),Dn}var hs={},Le={},Ja;function Qa(){if(Ja)return Le;Ja=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.getCapturedShape=i,Le.createEvent=s,Le.hasPointerCapture=r,Le.setPointerCapture=o,Le.releaseCapture=a;const t=mt(),e=new Map,n=t.Konva._global.PointerEvent!==void 0;function i(l){return e.get(l)}function s(l){return{evt:l,pointerId:l.pointerId}}function r(l,c){return e.get(l)===c}function o(l,c){a(l),c.getStage()&&(e.set(l,c),n&&c._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function a(l,c){const h=e.get(l);if(!h)return;const p=h.getStage();p&&p.content,e.delete(l),n&&h._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return Le}var Za;function Tu(){return Za||(Za=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Mt(),n=yt(),i=or(),s=mt(),r=sr(),o=ls(),a=mt(),l=Qa(),c="Stage",h="string",p="px",f="mouseout",u="mouseleave",m="mouseover",_="mouseenter",S="mousemove",C="mousedown",g="mouseup",d="pointermove",y="pointerdown",b="pointerup",k="pointercancel",D="lostpointercapture",x="pointerout",w="pointerleave",T="pointerover",M="pointerenter",L="contextmenu",B="touchstart",V="touchend",U="touchmove",K="touchcancel",v="wheel",P=5,E=[[_,"_pointerenter"],[C,"_pointerdown"],[S,"_pointermove"],[g,"_pointerup"],[u,"_pointerleave"],[B,"_pointerdown"],[U,"_pointermove"],[V,"_pointerup"],[K,"_pointercancel"],[m,"_pointerover"],[v,"_wheel"],[L,"_contextmenu"],[y,"_pointerdown"],[d,"_pointermove"],[b,"_pointerup"],[k,"_pointercancel"],[w,"_pointerleave"],[D,"_lostpointercapture"]],A={mouse:{[x]:f,[w]:u,[T]:m,[M]:_,[d]:S,[y]:C,[b]:g,[k]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[x]:"touchout",[w]:"touchleave",[T]:"touchover",[M]:"touchenter",[d]:U,[y]:B,[b]:V,[k]:K,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[x]:x,[w]:w,[T]:T,[M]:M,[d]:d,[y]:y,[b]:b,[k]:k,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},O=$=>$.indexOf("pointer")>=0?"pointer":$.indexOf("touch")>=0?"touch":"mouse",j=$=>{const F=O($);if(F==="pointer")return s.Konva.pointerEventsEnabled&&A.pointer;if(F==="touch")return A.touch;if(F==="mouse")return A.mouse};function H($={}){return($.clipFunc||$.clipWidth||$.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),$}const X="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class rt extends i.Container{constructor(F){super(H(F)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{H(this.attrs)}),this._checkVisibility()}_validateAdd(F){const z=F.getType()==="Layer",et=F.getType()==="FastLayer";z||et||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const F=this.visible()?"":"none";this.content.style.display=F}setContainer(F){if(typeof F===h){let z;if(F.charAt(0)==="."){const et=F.slice(1);F=document.getElementsByClassName(et)[0]}else F.charAt(0)!=="#"?z=F:z=F.slice(1),F=document.getElementById(z);if(!F)throw"Can not find container in document with id "+z}return this._setAttr("container",F),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),F.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const F=this.children,z=F.length;for(let et=0;et<z;et++)F[et].clear();return this}clone(F){return F||(F={}),F.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,F)}destroy(){super.destroy();const F=this.content;F&&e.Util._isInDocument(F)&&this.container().removeChild(F);const z=t.stages.indexOf(this);return z>-1&&t.stages.splice(z,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const F=this._pointerPositions[0]||this._changedPointerPositions[0];return F?{x:F.x,y:F.y}:(e.Util.warn(X),null)}_getPointerById(F){return this._pointerPositions.find(z=>z.id===F)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(F){F=F||{},F.x=F.x||0,F.y=F.y||0,F.width=F.width||this.width(),F.height=F.height||this.height();const z=new r.SceneCanvas({width:F.width,height:F.height,pixelRatio:F.pixelRatio||1}),et=z.getContext()._context,it=this.children;return(F.x||F.y)&&et.translate(-1*F.x,-1*F.y),it.forEach(function(ct){if(!ct.isVisible())return;const R=ct._toKonvaCanvas(F);et.drawImage(R._canvas,F.x,F.y,R.getWidth()/R.getPixelRatio(),R.getHeight()/R.getPixelRatio())}),z}getIntersection(F){if(!F)return null;const z=this.children,et=z.length,it=et-1;for(let ct=it;ct>=0;ct--){const R=z[ct].getIntersection(F);if(R)return R}return null}_resizeDOM(){const F=this.width(),z=this.height();this.content&&(this.content.style.width=F+p,this.content.style.height=z+p),this.bufferCanvas.setSize(F,z),this.bufferHitCanvas.setSize(F,z),this.children.forEach(et=>{et.setSize({width:F,height:z}),et.draw()})}add(F,...z){if(arguments.length>1){for(let it=0;it<arguments.length;it++)this.add(arguments[it]);return this}super.add(F);const et=this.children.length;return et>P&&e.Util.warn("The stage has "+et+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),F.setSize({width:this.width(),height:this.height()}),F.draw(),s.Konva.isBrowser&&this.content.appendChild(F.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(F){return l.hasPointerCapture(F,this)}setPointerCapture(F){l.setPointerCapture(F,this)}releaseCapture(F){l.releaseCapture(F,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&E.forEach(([F,z])=>{this.content.addEventListener(F,et=>{this[z](et)},{passive:!1})})}_pointerenter(F){this.setPointersPositions(F);const z=j(F.type);z&&this._fire(z.pointerenter,{evt:F,target:this,currentTarget:this})}_pointerover(F){this.setPointersPositions(F);const z=j(F.type);z&&this._fire(z.pointerover,{evt:F,target:this,currentTarget:this})}_getTargetShape(F){let z=this[F+"targetShape"];return z&&!z.getStage()&&(z=null),z}_pointerleave(F){const z=j(F.type),et=O(F.type);if(!z)return;this.setPointersPositions(F);const it=this._getTargetShape(et),ct=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;it&&ct?(it._fireAndBubble(z.pointerout,{evt:F}),it._fireAndBubble(z.pointerleave,{evt:F}),this._fire(z.pointerleave,{evt:F,target:this,currentTarget:this}),this[et+"targetShape"]=null):ct&&(this._fire(z.pointerleave,{evt:F,target:this,currentTarget:this}),this._fire(z.pointerout,{evt:F,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(F){const z=j(F.type),et=O(F.type);if(!z)return;this.setPointersPositions(F);let it=!1;this._changedPointerPositions.forEach(ct=>{const R=this.getIntersection(ct);if(o.DD.justDragged=!1,s.Konva["_"+et+"ListenClick"]=!0,!R||!R.isListening()){this[et+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&R.setPointerCapture(ct.id),this[et+"ClickStartShape"]=R,R._fireAndBubble(z.pointerdown,{evt:F,pointerId:ct.id}),it=!0;const N=F.type.indexOf("touch")>=0;R.preventDefault()&&F.cancelable&&N&&F.preventDefault()}),it||this._fire(z.pointerdown,{evt:F,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(F){const z=j(F.type),et=O(F.type);if(!z||(s.Konva.isDragging()&&o.DD.node.preventDefault()&&F.cancelable&&F.preventDefault(),this.setPointersPositions(F),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const ct={};let R=!1;const N=this._getTargetShape(et);this._changedPointerPositions.forEach(W=>{const G=l.getCapturedShape(W.id)||this.getIntersection(W),I=W.id,q={evt:F,pointerId:I},J=N!==G;if(J&&N&&(N._fireAndBubble(z.pointerout,{...q},G),N._fireAndBubble(z.pointerleave,{...q},G)),G){if(ct[G._id])return;ct[G._id]=!0}G&&G.isListening()?(R=!0,J&&(G._fireAndBubble(z.pointerover,{...q},N),G._fireAndBubble(z.pointerenter,{...q},N),this[et+"targetShape"]=G),G._fireAndBubble(z.pointermove,{...q})):N&&(this._fire(z.pointerover,{evt:F,target:this,currentTarget:this,pointerId:I}),this[et+"targetShape"]=null)}),R||this._fire(z.pointermove,{evt:F,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(F){const z=j(F.type),et=O(F.type);if(!z)return;this.setPointersPositions(F);const it=this[et+"ClickStartShape"],ct=this[et+"ClickEndShape"],R={};let N=!1;this._changedPointerPositions.forEach(W=>{const G=l.getCapturedShape(W.id)||this.getIntersection(W);if(G){if(G.releaseCapture(W.id),R[G._id])return;R[G._id]=!0}const I=W.id,q={evt:F,pointerId:I};let J=!1;s.Konva["_"+et+"InDblClickWindow"]?(J=!0,clearTimeout(this[et+"DblTimeout"])):o.DD.justDragged||(s.Konva["_"+et+"InDblClickWindow"]=!0,clearTimeout(this[et+"DblTimeout"])),this[et+"DblTimeout"]=setTimeout(function(){s.Konva["_"+et+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),G&&G.isListening()?(N=!0,this[et+"ClickEndShape"]=G,G._fireAndBubble(z.pointerup,{...q}),s.Konva["_"+et+"ListenClick"]&&it&&it===G&&(G._fireAndBubble(z.pointerclick,{...q}),J&&ct&&ct===G&&G._fireAndBubble(z.pointerdblclick,{...q}))):(this[et+"ClickEndShape"]=null,s.Konva["_"+et+"ListenClick"]&&this._fire(z.pointerclick,{evt:F,target:this,currentTarget:this,pointerId:I}),J&&this._fire(z.pointerdblclick,{evt:F,target:this,currentTarget:this,pointerId:I}))}),N||this._fire(z.pointerup,{evt:F,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+et+"ListenClick"]=!1,F.cancelable&&et!=="touch"&&et!=="pointer"&&F.preventDefault()}_contextmenu(F){this.setPointersPositions(F);const z=this.getIntersection(this.getPointerPosition());z&&z.isListening()?z._fireAndBubble(L,{evt:F}):this._fire(L,{evt:F,target:this,currentTarget:this})}_wheel(F){this.setPointersPositions(F);const z=this.getIntersection(this.getPointerPosition());z&&z.isListening()?z._fireAndBubble(v,{evt:F}):this._fire(v,{evt:F,target:this,currentTarget:this})}_pointercancel(F){this.setPointersPositions(F);const z=l.getCapturedShape(F.pointerId)||this.getIntersection(this.getPointerPosition());z&&z._fireAndBubble(b,l.createEvent(F)),l.releaseCapture(F.pointerId)}_lostpointercapture(F){l.releaseCapture(F.pointerId)}setPointersPositions(F){const z=this._getContentPosition();let et=null,it=null;F=F||window.event,F.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(F.touches,ct=>{this._pointerPositions.push({id:ct.identifier,x:(ct.clientX-z.left)/z.scaleX,y:(ct.clientY-z.top)/z.scaleY})}),Array.prototype.forEach.call(F.changedTouches||F.touches,ct=>{this._changedPointerPositions.push({id:ct.identifier,x:(ct.clientX-z.left)/z.scaleX,y:(ct.clientY-z.top)/z.scaleY})})):(et=(F.clientX-z.left)/z.scaleX,it=(F.clientY-z.top)/z.scaleY,this.pointerPos={x:et,y:it},this._pointerPositions=[{x:et,y:it,id:e.Util._getFirstPointerId(F)}],this._changedPointerPositions=[{x:et,y:it,id:e.Util._getFirstPointerId(F)}])}_setPointerPosition(F){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(F)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const F=this.content.getBoundingClientRect();return{top:F.top,left:F.left,scaleX:F.width/this.content.clientWidth||1,scaleY:F.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new r.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new r.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const F=this.container();if(!F)throw"Stage has no container. A container is required.";F.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),F.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(F){F.batchDraw()}),this}}t.Stage=rt,rt.prototype.nodeType=c,(0,a._registerNode)(rt),n.Factory.addGetterSetter(rt,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach($=>{$.batchDraw()})})}(hs)),hs}var Nn={},ds={},tl;function Gt(){return tl||(tl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=mt(),n=Mt(),i=yt(),s=Ft(),r=_t(),o=mt(),a=Qa(),l="hasShadow",c="shadowRGBA",h="patternImage",p="linearGradient",f="radialGradient";let u;function m(){return u||(u=n.Util.createCanvasElement().getContext("2d"),u)}t.shapes={};function _(w){const T=this.attrs.fillRule;T?w.fill(T):w.fill()}function S(w){w.stroke()}function C(w){const T=this.attrs.fillRule;T?w.fill(T):w.fill()}function g(w){w.stroke()}function d(){this._clearCache(l)}function y(){this._clearCache(c)}function b(){this._clearCache(h)}function k(){this._clearCache(p)}function D(){this._clearCache(f)}class x extends s.Node{constructor(T){super(T);let M;for(;M=n.Util.getRandomColor(),!(M&&!(M in t.shapes)););this.colorKey=M,t.shapes[M]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const M=m().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(M&&M.setTransform){const L=new n.Transform;L.translate(this.fillPatternX(),this.fillPatternY()),L.rotate(e.Konva.getAngle(this.fillPatternRotation())),L.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),L.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const B=L.getMatrix(),V=typeof DOMMatrix>"u"?{a:B[0],b:B[1],c:B[2],d:B[3],e:B[4],f:B[5]}:new DOMMatrix(B);M.setTransform(V)}return M}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const T=this.fillLinearGradientColorStops();if(T){const M=m(),L=this.fillLinearGradientStartPoint(),B=this.fillLinearGradientEndPoint(),V=M.createLinearGradient(L.x,L.y,B.x,B.y);for(let U=0;U<T.length;U+=2)V.addColorStop(T[U],T[U+1]);return V}}_getRadialGradient(){return this._getCache(f,this.__getRadialGradient)}__getRadialGradient(){const T=this.fillRadialGradientColorStops();if(T){const M=m(),L=this.fillRadialGradientStartPoint(),B=this.fillRadialGradientEndPoint(),V=M.createRadialGradient(L.x,L.y,this.fillRadialGradientStartRadius(),B.x,B.y,this.fillRadialGradientEndRadius());for(let U=0;U<T.length;U+=2)V.addColorStop(T[U],T[U+1]);return V}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const T=n.Util.colorToRGBA(this.shadowColor());if(T)return"rgba("+T.r+","+T.g+","+T.b+","+T.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const T=this.hitStrokeWidth();return T==="auto"?this.hasStroke():this.strokeEnabled()&&!!T}intersects(T){const M=this.getStage();if(!M)return!1;const L=M.bufferHitCanvas;return L.getContext().clear(),this.drawHit(L,void 0,!0),L.context.getImageData(Math.round(T.x),Math.round(T.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(T){var M;if(!((M=this.attrs.perfectDrawEnabled)!==null&&M!==void 0?M:!0))return!1;const B=T||this.hasFill(),V=this.hasStroke(),U=this.getAbsoluteOpacity()!==1;if(B&&V&&U)return!0;const K=this.hasShadow(),v=this.shadowForStrokeEnabled();return!!(B&&V&&K&&v)}setStrokeHitEnabled(T){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),T?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const T=this.size();return{x:this._centroid?-T.width/2:0,y:this._centroid?-T.height/2:0,width:T.width,height:T.height}}getClientRect(T={}){let M=!1,L=this.getParent();for(;L;){if(L.isCached()){M=!0;break}L=L.getParent()}const B=T.skipTransform,V=T.relativeTo||M&&this.getStage()||void 0,U=this.getSelfRect(),v=!T.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,P=U.width+v,E=U.height+v,A=!T.skipShadow&&this.hasShadow(),O=A?this.shadowOffsetX():0,j=A?this.shadowOffsetY():0,H=P+Math.abs(O),X=E+Math.abs(j),rt=A&&this.shadowBlur()||0,$=H+rt*2,F=X+rt*2,z={width:$,height:F,x:-(v/2+rt)+Math.min(O,0)+U.x,y:-(v/2+rt)+Math.min(j,0)+U.y};return B?z:this._transformedRect(z,V)}drawScene(T,M,L){const B=this.getLayer(),V=T||B.getCanvas(),U=V.getContext(),K=this._getCanvasCache(),v=this.getSceneFunc(),P=this.hasShadow();let E;const A=M===this;if(!this.isVisible()&&!A)return this;if(K){U.save();const O=this.getAbsoluteTransform(M).getMatrix();return U.transform(O[0],O[1],O[2],O[3],O[4],O[5]),this._drawCachedSceneCanvas(U),U.restore(),this}if(!v)return this;if(U.save(),this._useBufferCanvas()){E=this.getStage();const O=L||E.bufferCanvas,j=O.getContext();j.clear(),j.save(),j._applyLineJoin(this);const H=this.getAbsoluteTransform(M).getMatrix();j.transform(H[0],H[1],H[2],H[3],H[4],H[5]),v.call(this,j,this),j.restore();const X=O.pixelRatio;P&&U._applyShadow(this),U._applyOpacity(this),U._applyGlobalCompositeOperation(this),U.drawImage(O._canvas,O.x||0,O.y||0,O.width/X,O.height/X)}else{if(U._applyLineJoin(this),!A){const O=this.getAbsoluteTransform(M).getMatrix();U.transform(O[0],O[1],O[2],O[3],O[4],O[5]),U._applyOpacity(this),U._applyGlobalCompositeOperation(this)}P&&U._applyShadow(this),v.call(this,U,this)}return U.restore(),this}drawHit(T,M,L=!1){if(!this.shouldDrawHit(M,L))return this;const B=this.getLayer(),V=T||B.hitCanvas,U=V&&V.getContext(),K=this.hitFunc()||this.sceneFunc(),v=this._getCanvasCache(),P=v&&v.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),P){U.save();const A=this.getAbsoluteTransform(M).getMatrix();return U.transform(A[0],A[1],A[2],A[3],A[4],A[5]),this._drawCachedHitCanvas(U),U.restore(),this}if(!K)return this;if(U.save(),U._applyLineJoin(this),!(this===M)){const A=this.getAbsoluteTransform(M).getMatrix();U.transform(A[0],A[1],A[2],A[3],A[4],A[5])}return K.call(this,U,this),U.restore(),this}drawHitFromCache(T=0){const M=this._getCanvasCache(),L=this._getCachedSceneCanvas(),B=M.hit,V=B.getContext(),U=B.getWidth(),K=B.getHeight();V.clear(),V.drawImage(L._canvas,0,0,U,K);try{const v=V.getImageData(0,0,U,K),P=v.data,E=P.length,A=n.Util._hexToRgb(this.colorKey);for(let O=0;O<E;O+=4)P[O+3]>T?(P[O]=A.r,P[O+1]=A.g,P[O+2]=A.b,P[O+3]=255):P[O+3]=0;V.putImageData(v,0,0)}catch(v){n.Util.error("Unable to draw hit graph from cached scene canvas. "+v.message)}return this}hasPointerCapture(T){return a.hasPointerCapture(T,this)}setPointerCapture(T){a.setPointerCapture(T,this)}releaseCapture(T){a.releaseCapture(T,this)}}t.Shape=x,x.prototype._fillFunc=_,x.prototype._strokeFunc=S,x.prototype._fillFuncHit=C,x.prototype._strokeFuncHit=g,x.prototype._centroid=!1,x.prototype.nodeType="Shape",(0,o._registerNode)(x),x.prototype.eventListeners={},x.prototype.on.call(x.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",d),x.prototype.on.call(x.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",b),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",k),x.prototype.on.call(x.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",D),i.Factory.addGetterSetter(x,"stroke",void 0,(0,r.getStringOrGradientValidator)()),i.Factory.addGetterSetter(x,"strokeWidth",2,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(x,"hitStrokeWidth","auto",(0,r.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(x,"strokeHitEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"perfectDrawEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"shadowForStrokeEnabled",!0,(0,r.getBooleanValidator)()),i.Factory.addGetterSetter(x,"lineJoin"),i.Factory.addGetterSetter(x,"lineCap"),i.Factory.addGetterSetter(x,"sceneFunc"),i.Factory.addGetterSetter(x,"hitFunc"),i.Factory.addGetterSetter(x,"dash"),i.Factory.addGetterSetter(x,"dashOffset",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowColor",void 0,(0,r.getStringValidator)()),i.Factory.addGetterSetter(x,"shadowBlur",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowOpacity",1,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(x,"shadowOffsetX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"shadowOffsetY",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternImage"),i.Factory.addGetterSetter(x,"fill",void 0,(0,r.getStringOrGradientValidator)()),i.Factory.addGetterSetter(x,"fillPatternX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternY",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(x,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(x,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(x,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(x,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(x,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(x,"fillEnabled",!0),i.Factory.addGetterSetter(x,"strokeEnabled",!0),i.Factory.addGetterSetter(x,"shadowEnabled",!0),i.Factory.addGetterSetter(x,"dashEnabled",!0),i.Factory.addGetterSetter(x,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(x,"fillPriority","color"),i.Factory.addComponentsGetterSetter(x,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(x,"fillPatternOffsetX",0,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternOffsetY",0,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(x,"fillPatternScaleX",1,(0,r.getNumberValidator)()),i.Factory.addGetterSetter(x,"fillPatternScaleY",1,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(x,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(x,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(x,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(x,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(x,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(x,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(x,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(x,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(x,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(x,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(x,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(x,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(x,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(x,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(x,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(x,"fillPatternRotation",0),i.Factory.addGetterSetter(x,"fillRule",void 0,(0,r.getStringValidator)()),i.Factory.backCompat(x,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(ds)),ds}var el;function nl(){if(el)return Nn;el=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.Layer=void 0;const t=Mt(),e=or(),n=Ft(),i=yt(),s=sr(),r=_t(),o=Gt(),a=mt(),l="#",c="beforeDraw",h="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],f=p.length;let u=class extends e.Container{constructor(_){super(_),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(_){return this.getContext().clear(_),this.getHitCanvas().getContext().clear(_),this}setZIndex(_){super.setZIndex(_);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),_<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[_+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);const _=this.getStage();return _&&_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!n.Node.prototype.moveUp.call(this))return!1;const S=this.getStage();return!S||!S.content?!1:(S.content.removeChild(this.getNativeCanvasElement()),this.index<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[this.index+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){const _=this.getStage();if(_){const S=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),S[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){const _=this.getStage();if(_){const S=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),S[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const _=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),_&&_.parentNode&&t.Util._isInDocument(_)&&_.parentNode.removeChild(_),this}getStage(){return this.parent}setSize({width:_,height:S}){return this.canvas.setSize(_,S),this.hitCanvas.setSize(_,S),this._setSmoothEnabled(),this}_validateAdd(_){const S=_.getType();S!=="Group"&&S!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(_){return _=_||{},_.width=_.width||this.getWidth(),_.height=_.height||this.getHeight(),_.x=_.x!==void 0?_.x:this.x(),_.y=_.y!==void 0?_.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,_)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(_){if(!this.isListening()||!this.isVisible())return null;let S=1,C=!1;for(;;){for(let g=0;g<f;g++){const d=p[g],y=this._getIntersection({x:_.x+d.x*S,y:_.y+d.y*S}),b=y.shape;if(b)return b;if(C=!!y.antialiased,!y.antialiased)break}if(C)S+=1;else return null}}_getIntersection(_){const S=this.hitCanvas.pixelRatio,C=this.hitCanvas.context.getImageData(Math.round(_.x*S),Math.round(_.y*S),1,1).data,g=C[3];if(g===255){const d=t.Util._rgbToHex(C[0],C[1],C[2]),y=o.shapes[l+d];return y?{shape:y}:{antialiased:!0}}else if(g>0)return{antialiased:!0};return{}}drawScene(_,S,C){const g=this.getLayer(),d=_||g&&g.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&d.getContext().clear(),e.Container.prototype.drawScene.call(this,d,S,C),this._fire(h,{node:this}),this}drawHit(_,S){const C=this.getLayer(),g=_||C&&C.hitCanvas;return C&&C.clearBeforeDraw()&&C.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,g,S),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(_){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(_)}getHitGraphEnabled(_){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const _=this.parent;!!this.hitCanvas._canvas.parentNode?_.content.removeChild(this.hitCanvas._canvas):_.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return Nn.Layer=u,u.prototype.nodeType="Layer",(0,a._registerNode)(u),i.Factory.addGetterSetter(u,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(u,"clearBeforeDraw",!0),i.Factory.addGetterSetter(u,"hitGraphEnabled",!0,(0,r.getBooleanValidator)()),Nn}var On={},il;function ku(){if(il)return On;il=1,Object.defineProperty(On,"__esModule",{value:!0}),On.FastLayer=void 0;const t=Mt(),e=nl(),n=mt();let i=class extends e.Layer{constructor(r){super(r),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return On.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),On}var Ln={},rl;function us(){if(rl)return Ln;rl=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.Group=void 0;const t=Mt(),e=or(),n=mt();let i=class extends e.Container{_validateAdd(r){const o=r.getType();o!=="Group"&&o!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return Ln.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),Ln}var Gn={},sl;function fs(){if(sl)return Gn;sl=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.Animation=void 0;const t=mt(),e=Mt(),n=function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}}();let i=class fn{constructor(r,o){this.id=fn.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=r,this.setLayers(o)}setLayers(r){let o=[];return r&&(o=Array.isArray(r)?r:[r]),this.layers=o,this}getLayers(){return this.layers}addLayer(r){const o=this.layers,a=o.length;for(let l=0;l<a;l++)if(o[l]._id===r._id)return!1;return this.layers.push(r),!0}isRunning(){const o=fn.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),fn._addAnimation(this),this}stop(){return fn._removeAnimation(this),this}_updateFrameObject(r){this.frame.timeDiff=r-this.frame.lastTime,this.frame.lastTime=r,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(r){this.animations.push(r),this._handleAnimation()}static _removeAnimation(r){const o=r.id,a=this.animations,l=a.length;for(let c=0;c<l;c++)if(a[c].id===o){this.animations.splice(c,1);break}}static _runFrames(){const r={},o=this.animations;for(let a=0;a<o.length;a++){const l=o[a],c=l.layers,h=l.func;l._updateFrameObject(n());const p=c.length;let f;if(h?f=h.call(l,l.frame)!==!1:f=!0,!!f)for(let u=0;u<p;u++){const m=c[u];m._id!==void 0&&(r[m._id]=m)}}for(const a in r)r.hasOwnProperty(a)&&r[a].batchDraw()}static _animationLoop(){const r=fn;r.animations.length?(r._runFrames(),e.Util.requestAnimFrame(r._animationLoop)):r.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return Gn.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,Gn}var gs={},ol;function Au(){return ol||(ol=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Mt(),n=fs(),i=Ft(),s=mt(),r={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,l=3,c=["fill","stroke","shadowColor"];let h=0;class p{constructor(m,_,S,C,g,d,y){this.prop=m,this.propFunc=_,this.begin=C,this._pos=C,this.duration=d,this._change=0,this.prevPos=0,this.yoyo=y,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=S,this._change=g-this.begin,this.pause()}fire(m){const _=this[m];_&&_()}setTime(m){m>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():m<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=m,this.update())}getTime(){return this._time}setPosition(m){this.prevPos=this._pos,this.propFunc(m),this._pos=m}getPosition(m){return m===void 0&&(m=this._time),this.func(m,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(m){this.pause(),this._time=m,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const m=this.getTimer()-this._startTime;this.state===a?this.setTime(m):this.state===l&&this.setTime(this.duration-m)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class f{constructor(m){const _=this,S=m.node,C=S._id,g=m.easing||t.Easings.Linear,d=!!m.yoyo;let y,b;typeof m.duration>"u"?y=.3:m.duration===0?y=.001:y=m.duration,this.node=S,this._id=h++;const k=S.getLayer()||(S instanceof s.Konva.Stage?S.getLayers():null);k||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){_.tween.onEnterFrame()},k),this.tween=new p(b,function(D){_._tweenFunc(D)},g,0,1,y*1e3,d),this._addListeners(),f.attrs[C]||(f.attrs[C]={}),f.attrs[C][this._id]||(f.attrs[C][this._id]={}),f.tweens[C]||(f.tweens[C]={});for(b in m)r[b]===void 0&&this._addAttr(b,m[b]);this.reset(),this.onFinish=m.onFinish,this.onReset=m.onReset,this.onUpdate=m.onUpdate}_addAttr(m,_){const S=this.node,C=S._id;let g,d,y,b,k;const D=f.tweens[C][m];D&&delete f.attrs[C][D][m];let x=S.getAttr(m);if(e.Util._isArray(_))if(g=[],d=Math.max(_.length,x.length),m==="points"&&_.length!==x.length&&(_.length>x.length?(b=x,x=e.Util._prepareArrayForTween(x,_,S.closed())):(y=_,_=e.Util._prepareArrayForTween(_,x,S.closed()))),m.indexOf("fill")===0)for(let w=0;w<d;w++)if(w%2===0)g.push(_[w]-x[w]);else{const T=e.Util.colorToRGBA(x[w]);k=e.Util.colorToRGBA(_[w]),x[w]=T,g.push({r:k.r-T.r,g:k.g-T.g,b:k.b-T.b,a:k.a-T.a})}else for(let w=0;w<d;w++)g.push(_[w]-x[w]);else c.indexOf(m)!==-1?(x=e.Util.colorToRGBA(x),k=e.Util.colorToRGBA(_),g={r:k.r-x.r,g:k.g-x.g,b:k.b-x.b,a:k.a-x.a}):g=_-x;f.attrs[C][this._id][m]={start:x,diff:g,end:_,trueEnd:y,trueStart:b},f.tweens[C][m]=this._id}_tweenFunc(m){const _=this.node,S=f.attrs[_._id][this._id];let C,g,d,y,b,k,D,x;for(C in S){if(g=S[C],d=g.start,y=g.diff,x=g.end,e.Util._isArray(d))if(b=[],D=Math.max(d.length,x.length),C.indexOf("fill")===0)for(k=0;k<D;k++)k%2===0?b.push((d[k]||0)+y[k]*m):b.push("rgba("+Math.round(d[k].r+y[k].r*m)+","+Math.round(d[k].g+y[k].g*m)+","+Math.round(d[k].b+y[k].b*m)+","+(d[k].a+y[k].a*m)+")");else for(k=0;k<D;k++)b.push((d[k]||0)+y[k]*m);else c.indexOf(C)!==-1?b="rgba("+Math.round(d.r+y.r*m)+","+Math.round(d.g+y.g*m)+","+Math.round(d.b+y.b*m)+","+(d.a+y.a*m)+")":b=d+y*m;_.setAttr(C,b)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const m=this.node,_=f.attrs[m._id][this._id];_.points&&_.points.trueEnd&&m.setAttr("points",_.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const m=this.node,_=f.attrs[m._id][this._id];_.points&&_.points.trueStart&&m.points(_.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(m){return this.tween.seek(m*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const m=this.node._id,_=this._id,S=f.tweens[m];this.pause(),this.anim&&this.anim.stop();for(const C in S)delete f.tweens[m][C];delete f.attrs[m][_],Object.keys(f.tweens[m]).length===0&&delete f.tweens[m],Object.keys(f.attrs[m]).length===0&&delete f.attrs[m]}}t.Tween=f,f.attrs={},f.tweens={},i.Node.prototype.to=function(u){const m=u.onFinish;u.node=this,u.onFinish=function(){this.destroy(),m&&m()},new f(u).play()},t.Easings={BackEaseIn(u,m,_,S){return _*(u/=S)*u*(2.70158*u-1.70158)+m},BackEaseOut(u,m,_,S){return _*((u=u/S-1)*u*(2.70158*u+1.70158)+1)+m},BackEaseInOut(u,m,_,S){let C=1.70158;return(u/=S/2)<1?_/2*(u*u*(((C*=1.525)+1)*u-C))+m:_/2*((u-=2)*u*(((C*=1.525)+1)*u+C)+2)+m},ElasticEaseIn(u,m,_,S,C,g){let d=0;return u===0?m:(u/=S)===1?m+_:(g||(g=S*.3),!C||C<Math.abs(_)?(C=_,d=g/4):d=g/(2*Math.PI)*Math.asin(_/C),-(C*Math.pow(2,10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/g))+m)},ElasticEaseOut(u,m,_,S,C,g){let d=0;return u===0?m:(u/=S)===1?m+_:(g||(g=S*.3),!C||C<Math.abs(_)?(C=_,d=g/4):d=g/(2*Math.PI)*Math.asin(_/C),C*Math.pow(2,-10*u)*Math.sin((u*S-d)*(2*Math.PI)/g)+_+m)},ElasticEaseInOut(u,m,_,S,C,g){let d=0;return u===0?m:(u/=S/2)===2?m+_:(g||(g=S*.44999999999999996),!C||C<Math.abs(_)?(C=_,d=g/4):d=g/(2*Math.PI)*Math.asin(_/C),u<1?-.5*(C*Math.pow(2,10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/g))+m:C*Math.pow(2,-10*(u-=1))*Math.sin((u*S-d)*(2*Math.PI)/g)*.5+_+m)},BounceEaseOut(u,m,_,S){return(u/=S)<.36363636363636365?_*(7.5625*u*u)+m:u<.7272727272727273?_*(7.5625*(u-=.5454545454545454)*u+.75)+m:u<.9090909090909091?_*(7.5625*(u-=.8181818181818182)*u+.9375)+m:_*(7.5625*(u-=.9545454545454546)*u+.984375)+m},BounceEaseIn(u,m,_,S){return _-t.Easings.BounceEaseOut(S-u,0,_,S)+m},BounceEaseInOut(u,m,_,S){return u<S/2?t.Easings.BounceEaseIn(u*2,0,_,S)*.5+m:t.Easings.BounceEaseOut(u*2-S,0,_,S)*.5+_*.5+m},EaseIn(u,m,_,S){return _*(u/=S)*u+m},EaseOut(u,m,_,S){return-_*(u/=S)*(u-2)+m},EaseInOut(u,m,_,S){return(u/=S/2)<1?_/2*u*u+m:-_/2*(--u*(u-2)-1)+m},StrongEaseIn(u,m,_,S){return _*(u/=S)*u*u*u*u+m},StrongEaseOut(u,m,_,S){return _*((u=u/S-1)*u*u*u*u+1)+m},StrongEaseInOut(u,m,_,S){return(u/=S/2)<1?_/2*u*u*u*u*u+m:_/2*((u-=2)*u*u*u*u+2)+m},Linear(u,m,_,S){return _*u/S+m}}}(gs)),gs}var al;function Ru(){return al||(al=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=mt(),n=Mt(),i=Ft(),s=or(),r=Tu(),o=nl(),a=ku(),l=us(),c=ls(),h=Gt(),p=fs(),f=Au(),u=Wa(),m=sr();t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:s.Container,Stage:r.Stage,stages:r.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:c.DD,Shape:h.Shape,shapes:h.shapes,Animation:p.Animation,Tween:f.Tween,Easings:f.Easings,Context:u.Context,Canvas:m.Canvas}),t.default=t.Konva}(rs)),rs}var In={},ll;function Eu(){if(ll)return In;ll=1,Object.defineProperty(In,"__esModule",{value:!0}),In.Arc=void 0;const t=yt(),e=Gt(),n=mt(),i=_t(),s=mt();let r=class extends e.Shape{_sceneFunc(a){const l=n.Konva.getAngle(this.angle()),c=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,c),a.arc(0,0,this.innerRadius(),l,0,!c),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),c=this.clockwise(),h=n.Konva.getAngle(c?360-this.angle():this.angle()),p=Math.cos(Math.min(h,Math.PI)),f=1,u=Math.sin(Math.min(Math.max(Math.PI,h),3*Math.PI/2)),m=Math.sin(Math.min(h,Math.PI/2)),_=p*(p>0?a:l),S=f*l,C=u*(u>0?a:l),g=m*(m>0?l:a);return{x:_,y:c?-1*g:C,width:S-_,height:g-C}}};return In.Arc=r,r.prototype._centroid=!0,r.prototype.className="Arc",r.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clockwise",!1,(0,i.getBooleanValidator)()),In}var Un={},Bn={},cl;function hl(){if(cl)return Bn;cl=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.Line=void 0;const t=yt(),e=mt(),n=Gt(),i=_t();function s(a,l,c,h,p,f,u){const m=Math.sqrt(Math.pow(c-a,2)+Math.pow(h-l,2)),_=Math.sqrt(Math.pow(p-c,2)+Math.pow(f-h,2)),S=u*m/(m+_),C=u*_/(m+_),g=c-S*(p-a),d=h-S*(f-l),y=c+C*(p-a),b=h+C*(f-l);return[g,d,y,b]}function r(a,l){const c=a.length,h=[];for(let p=2;p<c-2;p+=2){const f=s(a[p-2],a[p-1],a[p],a[p+1],a[p+2],a[p+3],l);isNaN(f[0])||(h.push(f[0]),h.push(f[1]),h.push(a[p]),h.push(a[p+1]),h.push(f[2]),h.push(f[3]))}return h}let o=class extends n.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const c=this.points(),h=c.length,p=this.tension(),f=this.closed(),u=this.bezier();if(!h)return;let m=0;if(l.beginPath(),l.moveTo(c[0],c[1]),p!==0&&h>4){const _=this.getTensionPoints(),S=_.length;for(m=f?0:4,f||l.quadraticCurveTo(_[0],_[1],_[2],_[3]);m<S-2;)l.bezierCurveTo(_[m++],_[m++],_[m++],_[m++],_[m++],_[m++]);f||l.quadraticCurveTo(_[S-2],_[S-1],c[h-2],c[h-1])}else if(u)for(m=2;m<h;)l.bezierCurveTo(c[m++],c[m++],c[m++],c[m++],c[m++],c[m++]);else for(m=2;m<h;m+=2)l.lineTo(c[m],c[m+1]);f?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():r(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),c=l.length,h=this.tension(),p=s(l[c-2],l[c-1],l[0],l[1],l[2],l[3],h),f=s(l[c-4],l[c-3],l[c-2],l[c-1],l[0],l[1],h),u=r(l,h);return[p[2],p[3]].concat(u).concat([f[0],f[1],l[c-2],l[c-1],f[2],f[3],p[0],p[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let c=l[0],h=l[0],p=l[1],f=l[1],u,m;for(let _=0;_<l.length/2;_++)u=l[_*2],m=l[_*2+1],c=Math.min(c,u),h=Math.max(h,u),p=Math.min(p,m),f=Math.max(f,m);return{x:c,y:p,width:h-c,height:f-p}}};return Bn.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),t.Factory.addGetterSetter(o,"closed",!1),t.Factory.addGetterSetter(o,"bezier",!1),t.Factory.addGetterSetter(o,"tension",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,"points",[],(0,i.getNumberArrayValidator)()),Bn}var Hn={},ps={},dl;function Mu(){return dl||(dl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,l)=>{let c,h;const f=l/2;c=0;for(let u=0;u<20;u++)h=f*t.tValues[20][u]+f,c+=t.cValues[20][u]*i(o,a,h);return f*c};t.getCubicArcLength=e;const n=(o,a,l)=>{l===void 0&&(l=1);const c=o[0]-2*o[1]+o[2],h=a[0]-2*a[1]+a[2],p=2*o[1]-2*o[0],f=2*a[1]-2*a[0],u=4*(c*c+h*h),m=4*(c*p+h*f),_=p*p+f*f;if(u===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const S=m/(2*u),C=_/u,g=l+S,d=C-S*S,y=g*g+d>0?Math.sqrt(g*g+d):0,b=S*S+d>0?Math.sqrt(S*S+d):0,k=S+Math.sqrt(S*S+d)!==0?d*Math.log(Math.abs((g+y)/(S+b))):0;return Math.sqrt(u)/2*(g*y-S*b+k)};t.getQuadraticArcLength=n;function i(o,a,l){const c=s(1,l,o),h=s(1,l,a),p=c*c+h*h;return Math.sqrt(p)}const s=(o,a,l)=>{const c=l.length-1;let h,p;if(c===0)return 0;if(o===0){p=0;for(let f=0;f<=c;f++)p+=t.binomialCoefficients[c][f]*Math.pow(1-a,c-f)*Math.pow(a,f)*l[f];return p}else{h=new Array(c);for(let f=0;f<c;f++)h[f]=c*(l[f+1]-l[f]);return s(o-1,a,h)}},r=(o,a,l)=>{let c=1,h=o/a,p=(o-l(h))/a,f=0;for(;c>.001;){const u=l(h+p),m=Math.abs(o-u)/a;if(m<c)c=m,h+=p;else{const _=l(h-p),S=Math.abs(o-_)/a;S<c?(c=S,h-=p):p/=2}if(f++,f>500)break}return h};t.t2length=r}(ps)),ps}var ul;function ms(){if(ul)return Hn;ul=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.Path=void 0;const t=yt(),e=mt(),n=Gt(),i=Mu();let s=class Kt extends n.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Kt.parsePathData(this.data()),this.pathLength=Kt.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let l=!1;for(let c=0;c<a.length;c++){const h=a[c].command,p=a[c].points;switch(h){case"L":o.lineTo(p[0],p[1]);break;case"M":o.moveTo(p[0],p[1]);break;case"C":o.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":o.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":const f=p[0],u=p[1],m=p[2],_=p[3],S=p[4],C=p[5],g=p[6],d=p[7],y=m>_?m:_,b=m>_?1:m/_,k=m>_?_/m:1;o.translate(f,u),o.rotate(g),o.scale(b,k),o.arc(0,0,y,S,S+C,1-d),o.scale(1/b,1/k),o.rotate(-g),o.translate(-f,-u);break;case"z":l=!0,o.closePath();break}}!l&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(u){if(u.command==="A"){const m=u.points[4],_=u.points[5],S=u.points[4]+_;let C=Math.PI/180;if(Math.abs(m-S)<C&&(C=Math.abs(m-S)),_<0)for(let g=m-C;g>S;g-=C){const d=Kt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);o.push(d.x,d.y)}else for(let g=m+C;g<S;g+=C){const d=Kt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);o.push(d.x,d.y)}}else if(u.command==="C")for(let m=0;m<=1;m+=.01){const _=Kt.getPointOnCubicBezier(m,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);o.push(_.x,_.y)}else o=o.concat(u.points)});let a=o[0],l=o[0],c=o[1],h=o[1],p,f;for(let u=0;u<o.length/2;u++)p=o[u*2],f=o[u*2+1],isNaN(p)||(a=Math.min(a,p),l=Math.max(l,p)),isNaN(f)||(c=Math.min(c,f),h=Math.max(h,f));return{x:a,y:c,width:l-a,height:h-c}}getLength(){return this.pathLength}getPointAtLength(o){return Kt.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,l,c){return Math.sqrt((l-o)*(l-o)+(c-a)*(c-a))}static getPathLength(o){let a=0;for(let l=0;l<o.length;++l)a+=o[l].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let l,c=0,h=a.length;if(!h)return null;for(;c<h&&o>a[c].pathLength;)o-=a[c].pathLength,++c;if(c===h)return l=a[c-1].points.slice(-2),{x:l[0],y:l[1]};if(o<.01)return a[c].command==="M"?(l=a[c].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[c].start.x,y:a[c].start.y};const p=a[c],f=p.points;switch(p.command){case"L":return Kt.getPointOnLine(o,p.start.x,p.start.y,f[0],f[1]);case"C":return Kt.getPointOnCubicBezier((0,i.t2length)(o,Kt.getPathLength(a),y=>(0,i.getCubicArcLength)([p.start.x,f[0],f[2],f[4]],[p.start.y,f[1],f[3],f[5]],y)),p.start.x,p.start.y,f[0],f[1],f[2],f[3],f[4],f[5]);case"Q":return Kt.getPointOnQuadraticBezier((0,i.t2length)(o,Kt.getPathLength(a),y=>(0,i.getQuadraticArcLength)([p.start.x,f[0],f[2]],[p.start.y,f[1],f[3]],y)),p.start.x,p.start.y,f[0],f[1],f[2],f[3]);case"A":const u=f[0],m=f[1],_=f[2],S=f[3],C=f[5],g=f[6];let d=f[4];return d+=C*o/p.pathLength,Kt.getPointOnEllipticalArc(u,m,_,S,d,g)}return null}static getPointOnLine(o,a,l,c,h,p,f){p=p??a,f=f??l;const u=this.getLineLength(a,l,c,h);if(u<1e-10)return{x:a,y:l};if(c===a)return{x:p,y:f+(h>l?o:-o)};const m=(h-l)/(c-a),_=Math.sqrt(o*o/(1+m*m))*(c<a?-1:1),S=m*_;if(Math.abs(f-l-m*(p-a))<1e-10)return{x:p+_,y:f+S};const C=((p-a)*(c-a)+(f-l)*(h-l))/(u*u),g=a+C*(c-a),d=l+C*(h-l),y=this.getLineLength(p,f,g,d),b=Math.sqrt(o*o-y*y),k=Math.sqrt(b*b/(1+m*m))*(c<a?-1:1),D=m*k;return{x:g+k,y:d+D}}static getPointOnCubicBezier(o,a,l,c,h,p,f,u,m){function _(b){return b*b*b}function S(b){return 3*b*b*(1-b)}function C(b){return 3*b*(1-b)*(1-b)}function g(b){return(1-b)*(1-b)*(1-b)}const d=u*_(o)+p*S(o)+c*C(o)+a*g(o),y=m*_(o)+f*S(o)+h*C(o)+l*g(o);return{x:d,y}}static getPointOnQuadraticBezier(o,a,l,c,h,p,f){function u(g){return g*g}function m(g){return 2*g*(1-g)}function _(g){return(1-g)*(1-g)}const S=p*u(o)+c*m(o)+a*_(o),C=f*u(o)+h*m(o)+l*_(o);return{x:S,y:C}}static getPointOnEllipticalArc(o,a,l,c,h,p){const f=Math.cos(p),u=Math.sin(p),m={x:l*Math.cos(h),y:c*Math.sin(h)};return{x:o+(m.x*f-m.y*u),y:a+(m.x*u+m.y*f)}}static parsePathData(o){if(!o)return[];let a=o;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let S=0;S<l.length;S++)a=a.replace(new RegExp(l[S],"g"),"|"+l[S]);const c=a.split("|"),h=[],p=[];let f=0,u=0;const m=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let S=1;S<c.length;S++){let C=c[S],g=C.charAt(0);for(C=C.slice(1),p.length=0;_=m.exec(C);)p.push(_[0]);const d=[];for(let y=0,b=p.length;y<b;y++){if(p[y]==="00"){d.push(0,0);continue}const k=parseFloat(p[y]);isNaN(k)?d.push(0):d.push(k)}for(;d.length>0&&!isNaN(d[0]);){let y="",b=[];const k=f,D=u;let x,w,T,M,L,B,V,U,K,v;switch(g){case"l":f+=d.shift(),u+=d.shift(),y="L",b.push(f,u);break;case"L":f=d.shift(),u=d.shift(),b.push(f,u);break;case"m":const P=d.shift(),E=d.shift();if(f+=P,u+=E,y="M",h.length>2&&h[h.length-1].command==="z"){for(let A=h.length-2;A>=0;A--)if(h[A].command==="M"){f=h[A].points[0]+P,u=h[A].points[1]+E;break}}b.push(f,u),g="l";break;case"M":f=d.shift(),u=d.shift(),y="M",b.push(f,u),g="L";break;case"h":f+=d.shift(),y="L",b.push(f,u);break;case"H":f=d.shift(),y="L",b.push(f,u);break;case"v":u+=d.shift(),y="L",b.push(f,u);break;case"V":u=d.shift(),y="L",b.push(f,u);break;case"C":b.push(d.shift(),d.shift(),d.shift(),d.shift()),f=d.shift(),u=d.shift(),b.push(f,u);break;case"c":b.push(f+d.shift(),u+d.shift(),f+d.shift(),u+d.shift()),f+=d.shift(),u+=d.shift(),y="C",b.push(f,u);break;case"S":w=f,T=u,x=h[h.length-1],x.command==="C"&&(w=f+(f-x.points[2]),T=u+(u-x.points[3])),b.push(w,T,d.shift(),d.shift()),f=d.shift(),u=d.shift(),y="C",b.push(f,u);break;case"s":w=f,T=u,x=h[h.length-1],x.command==="C"&&(w=f+(f-x.points[2]),T=u+(u-x.points[3])),b.push(w,T,f+d.shift(),u+d.shift()),f+=d.shift(),u+=d.shift(),y="C",b.push(f,u);break;case"Q":b.push(d.shift(),d.shift()),f=d.shift(),u=d.shift(),b.push(f,u);break;case"q":b.push(f+d.shift(),u+d.shift()),f+=d.shift(),u+=d.shift(),y="Q",b.push(f,u);break;case"T":w=f,T=u,x=h[h.length-1],x.command==="Q"&&(w=f+(f-x.points[0]),T=u+(u-x.points[1])),f=d.shift(),u=d.shift(),y="Q",b.push(w,T,f,u);break;case"t":w=f,T=u,x=h[h.length-1],x.command==="Q"&&(w=f+(f-x.points[0]),T=u+(u-x.points[1])),f+=d.shift(),u+=d.shift(),y="Q",b.push(w,T,f,u);break;case"A":M=d.shift(),L=d.shift(),B=d.shift(),V=d.shift(),U=d.shift(),K=f,v=u,f=d.shift(),u=d.shift(),y="A",b=this.convertEndpointToCenterParameterization(K,v,f,u,V,U,M,L,B);break;case"a":M=d.shift(),L=d.shift(),B=d.shift(),V=d.shift(),U=d.shift(),K=f,v=u,f+=d.shift(),u+=d.shift(),y="A",b=this.convertEndpointToCenterParameterization(K,v,f,u,V,U,M,L,B);break}h.push({command:y||g,points:b,start:{x:k,y:D},pathLength:this.calcLength(k,D,y||g,b)})}(g==="z"||g==="Z")&&h.push({command:"z",points:[],start:void 0,pathLength:0})}return h}static calcLength(o,a,l,c){let h,p,f,u;const m=Kt;switch(l){case"L":return m.getLineLength(o,a,c[0],c[1]);case"C":return(0,i.getCubicArcLength)([o,c[0],c[2],c[4]],[a,c[1],c[3],c[5]],1);case"Q":return(0,i.getQuadraticArcLength)([o,c[0],c[2]],[a,c[1],c[3]],1);case"A":h=0;const _=c[4],S=c[5],C=c[4]+S;let g=Math.PI/180;if(Math.abs(_-C)<g&&(g=Math.abs(_-C)),p=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],_,0),S<0)for(u=_-g;u>C;u-=g)f=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],u,0),h+=m.getLineLength(p.x,p.y,f.x,f.y),p=f;else for(u=_+g;u<C;u+=g)f=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],u,0),h+=m.getLineLength(p.x,p.y,f.x,f.y),p=f;return f=m.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],C,0),h+=m.getLineLength(p.x,p.y,f.x,f.y),h}return 0}static convertEndpointToCenterParameterization(o,a,l,c,h,p,f,u,m){const _=m*(Math.PI/180),S=Math.cos(_)*(o-l)/2+Math.sin(_)*(a-c)/2,C=-1*Math.sin(_)*(o-l)/2+Math.cos(_)*(a-c)/2,g=S*S/(f*f)+C*C/(u*u);g>1&&(f*=Math.sqrt(g),u*=Math.sqrt(g));let d=Math.sqrt((f*f*(u*u)-f*f*(C*C)-u*u*(S*S))/(f*f*(C*C)+u*u*(S*S)));h===p&&(d*=-1),isNaN(d)&&(d=0);const y=d*f*C/u,b=d*-u*S/f,k=(o+l)/2+Math.cos(_)*y-Math.sin(_)*b,D=(a+c)/2+Math.sin(_)*y+Math.cos(_)*b,x=function(U){return Math.sqrt(U[0]*U[0]+U[1]*U[1])},w=function(U,K){return(U[0]*K[0]+U[1]*K[1])/(x(U)*x(K))},T=function(U,K){return(U[0]*K[1]<U[1]*K[0]?-1:1)*Math.acos(w(U,K))},M=T([1,0],[(S-y)/f,(C-b)/u]),L=[(S-y)/f,(C-b)/u],B=[(-1*S-y)/f,(-1*C-b)/u];let V=T(L,B);return w(L,B)<=-1&&(V=Math.PI),w(L,B)>=1&&(V=0),p===0&&V>0&&(V=V-2*Math.PI),p===1&&V<0&&(V=V+2*Math.PI),[k,D,f,u,M,V,_,p]}};return Hn.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(s),t.Factory.addGetterSetter(s,"data"),Hn}var fl;function Fu(){if(fl)return Un;fl=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.Arrow=void 0;const t=yt(),e=hl(),n=_t(),i=mt(),s=ms();let r=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,c=this.points();let h=c;const p=this.tension()!==0&&c.length>4;p&&(h=this.getTensionPoints());const f=this.pointerLength(),u=c.length;let m,_;if(p){const g=[h[h.length-4],h[h.length-3],h[h.length-2],h[h.length-1],c[u-2],c[u-1]],d=s.Path.calcLength(h[h.length-4],h[h.length-3],"C",g),y=s.Path.getPointOnQuadraticBezier(Math.min(1,1-f/d),g[0],g[1],g[2],g[3],g[4],g[5]);m=c[u-2]-y.x,_=c[u-1]-y.y}else m=c[u-2]-c[u-4],_=c[u-1]-c[u-3];const S=(Math.atan2(_,m)+l)%l,C=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(c[u-2],c[u-1]),a.rotate(S),a.moveTo(0,0),a.lineTo(-f,C/2),a.lineTo(-f,-C/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(c[0],c[1]),p?(m=(h[0]+h[2])/2-c[0],_=(h[1]+h[3])/2-c[1]):(m=c[2]-c[0],_=c[3]-c[1]),a.rotate((Math.atan2(-_,-m)+l)%l),a.moveTo(0,0),a.lineTo(-f,C/2),a.lineTo(-f,-C/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return Un.Arrow=r,r.prototype.className="Arrow",(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"pointerLength",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"pointerWidth",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"pointerAtBeginning",!1),t.Factory.addGetterSetter(r,"pointerAtEnding",!0),Un}var Vn={},gl;function Du(){if(gl)return Vn;gl=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.Circle=void 0;const t=yt(),e=Gt(),n=_t(),i=mt();let s=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}};return Vn.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),Vn}var zn={},pl;function Nu(){if(pl)return zn;pl=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.Ellipse=void 0;const t=yt(),e=Gt(),n=_t(),i=mt();let s=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),l=this.radiusY();o.beginPath(),o.save(),a!==l&&o.scale(1,l/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return zn.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(s),t.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),t.Factory.addGetterSetter(s,"radiusX",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"radiusY",0,(0,n.getNumberValidator)()),zn}var Wn={},ml;function Ou(){if(ml)return Wn;ml=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.Image=void 0;const t=Mt(),e=yt(),n=Gt(),i=mt(),s=_t();let r=class $c extends n.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),c=this.getHeight(),h=this.cornerRadius(),p=this.attrs.image;let f;if(p){const u=this.attrs.cropWidth,m=this.attrs.cropHeight;u&&m?f=[p,this.cropX(),this.cropY(),u,m,0,0,l,c]:f=[p,0,0,l,c]}(this.hasFill()||this.hasStroke()||h)&&(a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)),p&&(h&&a.clip(),a.drawImage.apply(a,f))}_hitFunc(a){const l=this.width(),c=this.height(),h=this.cornerRadius();a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,c=null){const h=t.Util.createImageElement();h.onload=function(){const p=new $c({image:h});l(p)},h.onerror=c,h.crossOrigin="Anonymous",h.src=a}};return Wn.Image=r,r.prototype.className="Image",(0,i._registerNode)(r),e.Factory.addGetterSetter(r,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(r,"image"),e.Factory.addComponentsGetterSetter(r,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(r,"cropX",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropY",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropWidth",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropHeight",0,(0,s.getNumberValidator)()),Wn}var je={},yl;function Lu(){if(yl)return je;yl=1,Object.defineProperty(je,"__esModule",{value:!0}),je.Tag=je.Label=void 0;const t=yt(),e=Gt(),n=us(),i=_t(),s=mt(),r=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",l="up",c="right",h="down",p="left",f=r.length;let u=class extends n.Group{constructor(S){super(S),this.on("add.konva",function(C){this._addListeners(C.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(S){let C=this,g;const d=function(){C._sync()};for(g=0;g<f;g++)S.on(r[g]+o,d)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let S=this.getText(),C=this.getTag(),g,d,y,b,k,D,x;if(S&&C){switch(g=S.width(),d=S.height(),y=C.pointerDirection(),b=C.pointerWidth(),x=C.pointerHeight(),k=0,D=0,y){case l:k=g/2,D=-1*x;break;case c:k=g+b,D=d/2;break;case h:k=g/2,D=d+x;break;case p:k=-1*b,D=d/2;break}C.setAttrs({x:-1*k,y:-1*D,width:g,height:d}),S.setAttrs({x:-1*k,y:-1*D})}}};je.Label=u,u.prototype.className="Label",(0,s._registerNode)(u);class m extends e.Shape{_sceneFunc(S){const C=this.width(),g=this.height(),d=this.pointerDirection(),y=this.pointerWidth(),b=this.pointerHeight(),k=this.cornerRadius();let D=0,x=0,w=0,T=0;typeof k=="number"?D=x=w=T=Math.min(k,C/2,g/2):(D=Math.min(k[0]||0,C/2,g/2),x=Math.min(k[1]||0,C/2,g/2),T=Math.min(k[2]||0,C/2,g/2),w=Math.min(k[3]||0,C/2,g/2)),S.beginPath(),S.moveTo(D,0),d===l&&(S.lineTo((C-y)/2,0),S.lineTo(C/2,-1*b),S.lineTo((C+y)/2,0)),S.lineTo(C-x,0),S.arc(C-x,x,x,Math.PI*3/2,0,!1),d===c&&(S.lineTo(C,(g-b)/2),S.lineTo(C+y,g/2),S.lineTo(C,(g+b)/2)),S.lineTo(C,g-T),S.arc(C-T,g-T,T,0,Math.PI/2,!1),d===h&&(S.lineTo((C+y)/2,g),S.lineTo(C/2,g+b),S.lineTo((C-y)/2,g)),S.lineTo(w,g),S.arc(w,g-w,w,Math.PI/2,Math.PI,!1),d===p&&(S.lineTo(0,(g+b)/2),S.lineTo(-1*y,g/2),S.lineTo(0,(g-b)/2)),S.lineTo(0,D),S.arc(D,D,D,Math.PI,Math.PI*3/2,!1),S.closePath(),S.fillStrokeShape(this)}getSelfRect(){let S=0,C=0,g=this.pointerWidth(),d=this.pointerHeight(),y=this.pointerDirection(),b=this.width(),k=this.height();return y===l?(C-=d,k+=d):y===h?k+=d:y===p?(S-=g*1.5,b+=g):y===c&&(b+=g*1.5),{x:S,y:C,width:b,height:k}}}return je.Tag=m,m.prototype.className="Tag",(0,s._registerNode)(m),t.Factory.addGetterSetter(m,"pointerDirection",a),t.Factory.addGetterSetter(m,"pointerWidth",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(m,"pointerHeight",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(m,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),je}var $n={},_l;function vl(){if(_l)return $n;_l=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.Rect=void 0;const t=yt(),e=Gt(),n=mt(),i=Mt(),s=_t();let r=class extends e.Shape{_sceneFunc(a){const l=this.cornerRadius(),c=this.width(),h=this.height();a.beginPath(),l?i.Util.drawRoundedRectPath(a,c,h,l):a.rect(0,0,c,h),a.closePath(),a.fillStrokeShape(this)}};return $n.Rect=r,r.prototype.className="Rect",(0,n._registerNode)(r),t.Factory.addGetterSetter(r,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),$n}var jn={},bl;function Gu(){if(bl)return jn;bl=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.RegularPolygon=void 0;const t=yt(),e=Gt(),n=_t(),i=mt();let s=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)o.lineTo(a[l].x,a[l].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let c=0;c<o;c++)l.push({x:a*Math.sin(c*2*Math.PI/o),y:-1*a*Math.cos(c*2*Math.PI/o)});return l}getSelfRect(){const o=this._getPoints();let a=o[0].x,l=o[0].y,c=o[0].x,h=o[0].y;return o.forEach(p=>{a=Math.min(a,p.x),l=Math.max(l,p.x),c=Math.min(c,p.y),h=Math.max(h,p.y)}),{x:a,y:c,width:l-a,height:h-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return jn.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"sides",0,(0,n.getNumberValidator)()),jn}var qn={},Sl;function Iu(){if(Sl)return qn;Sl=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.Ring=void 0;const t=yt(),e=Gt(),n=_t(),i=mt(),s=Math.PI*2;let r=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,s,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),s,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return qn.Ring=r,r.prototype.className="Ring",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,n.getNumberValidator)()),qn}var Kn={},xl;function Uu(){if(xl)return Kn;xl=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.Sprite=void 0;const t=yt(),e=Gt(),n=fs(),i=_t(),s=mt();let r=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new n.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,p=this.animations()[l],f=this.frameOffsets(),u=p[h+0],m=p[h+1],_=p[h+2],S=p[h+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,_,S),a.closePath(),a.fillStrokeShape(this)),C)if(f){const g=f[l],d=c*2;a.drawImage(C,u,m,_,S,g[d+0],g[d+1],_,S)}else a.drawImage(C,u,m,_,S,0,0,_,S)}_hitFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,p=this.animations()[l],f=this.frameOffsets(),u=p[h+2],m=p[h+3];if(a.beginPath(),f){const _=f[l],S=c*2;a.rect(_[S+0],_[S+1],u,m)}else a.rect(0,0,u,m);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),c=this.animations(),h=c[l],p=h.length/4;a<p-1?this.frameIndex(a+1):this.frameIndex(0)}};return Kn.Sprite=r,r.prototype.className="Sprite",(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"animation"),t.Factory.addGetterSetter(r,"animations"),t.Factory.addGetterSetter(r,"frameOffsets"),t.Factory.addGetterSetter(r,"image"),t.Factory.addGetterSetter(r,"frameIndex",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"frameRate",17,(0,i.getNumberValidator)()),t.Factory.backCompat(r,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Kn}var Yn={},wl;function Bu(){if(wl)return Yn;wl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.Star=void 0;const t=yt(),e=Gt(),n=_t(),i=mt();let s=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),l=this.outerRadius(),c=this.numPoints();o.beginPath(),o.moveTo(0,0-l);for(let h=1;h<c*2;h++){const p=h%2===0?l:a,f=p*Math.sin(h*Math.PI/c),u=-1*p*Math.cos(h*Math.PI/c);o.lineTo(f,u)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return Yn.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"numPoints",5,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,n.getNumberValidator)()),Yn}var ln={},Cl;function Pl(){if(Cl)return ln;Cl=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.Text=void 0,ln.stringToArray=o;const t=Mt(),e=yt(),n=Gt(),i=mt(),s=_t(),r=mt();function o(j){return[...j].reduce((H,X,rt,$)=>{if(/\p{Emoji}/u.test(X)){const F=$[rt+1];F&&/\p{Emoji_Modifier}|\u200D/u.test(F)?(H.push(X+F),$[rt+1]=""):H.push(X)}else/\p{Regional_Indicator}{2}/u.test(X+($[rt+1]||""))?H.push(X+$[rt+1]):rt>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(X)?H[H.length-1]+=X:X&&H.push(X);return H},[])}const a="auto",l="center",c="inherit",h="justify",p="Change.konva",f="2d",u="-",m="left",_="text",S="Text",C="top",g="bottom",d="middle",y="normal",b="px ",k=" ",D="right",x="rtl",w="word",T="char",M="none",L="",B=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],V=B.length;function U(j){return j.split(",").map(H=>{H=H.trim();const X=H.indexOf(" ")>=0,rt=H.indexOf('"')>=0||H.indexOf("'")>=0;return X&&!rt&&(H=`"${H}"`),H}).join(", ")}let K;function v(){return K||(K=t.Util.createCanvasElement().getContext(f),K)}function P(j){j.fillText(this._partialText,this._partialTextX,this._partialTextY)}function E(j){j.setAttr("miterLimit",2),j.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function A(j){return j=j||{},!j.fillLinearGradientColorStops&&!j.fillRadialGradientColorStops&&!j.fillPatternImage&&(j.fill=j.fill||"black"),j}let O=class extends n.Shape{constructor(H){super(A(H)),this._partialTextX=0,this._partialTextY=0;for(let X=0;X<V;X++)this.on(B[X]+p,this._setTextData);this._setTextData()}_sceneFunc(H){const X=this.textArr,rt=X.length;if(!this.text())return;let $=this.padding(),F=this.fontSize(),z=this.lineHeight()*F,et=this.verticalAlign(),it=this.direction(),ct=0,R=this.align(),N=this.getWidth(),W=this.letterSpacing(),G=this.fill(),I=this.textDecoration(),q=I.indexOf("underline")!==-1,J=I.indexOf("line-through")!==-1,nt;it=it===c?H.direction:it;let Z=z/2,Q=d;if(i.Konva._fixTextRendering){const st=this.measureSize("M");Q="alphabetic",Z=(st.fontBoundingBoxAscent-st.fontBoundingBoxDescent)/2+z/2}for(it===x&&H.setAttr("direction",it),H.setAttr("font",this._getContextFont()),H.setAttr("textBaseline",Q),H.setAttr("textAlign",m),et===d?ct=(this.getHeight()-rt*z-$*2)/2:et===g&&(ct=this.getHeight()-rt*z-$*2),H.translate($,ct+$),nt=0;nt<rt;nt++){let st=0,Y=0;const ot=X[nt],ht=ot.text,dt=ot.width,pt=ot.lastInParagraph;if(H.save(),R===D?st+=N-dt-$*2:R===l&&(st+=(N-dt-$*2)/2),q){H.save(),H.beginPath();const ft=i.Konva._fixTextRendering?Math.round(F/4):Math.round(F/2),vt=st,xt=Z+Y+ft;H.moveTo(vt,xt);const Ct=R===h&&!pt?N-$*2:dt;H.lineTo(vt+Math.round(Ct),xt),H.lineWidth=F/15;const Nt=this._getLinearGradient();H.strokeStyle=Nt||G,H.stroke(),H.restore()}if(J){H.save(),H.beginPath();const ft=i.Konva._fixTextRendering?-Math.round(F/4):0;H.moveTo(st,Z+Y+ft);const vt=R===h&&!pt?N-$*2:dt;H.lineTo(st+Math.round(vt),Z+Y+ft),H.lineWidth=F/15;const xt=this._getLinearGradient();H.strokeStyle=xt||G,H.stroke(),H.restore()}if(it!==x&&(W!==0||R===h)){const ft=ht.split(" ").length-1,vt=o(ht);for(let xt=0;xt<vt.length;xt++){const Ct=vt[xt];Ct===" "&&!pt&&R===h&&(st+=(N-$*2-dt)/ft),this._partialTextX=st,this._partialTextY=Z+Y,this._partialText=Ct,H.fillStrokeShape(this),st+=this.measureSize(Ct).width+W}}else W!==0&&H.setAttr("letterSpacing",`${W}px`),this._partialTextX=st,this._partialTextY=Z+Y,this._partialText=ht,H.fillStrokeShape(this);H.restore(),rt>1&&(Z+=z)}}_hitFunc(H){const X=this.getWidth(),rt=this.getHeight();H.beginPath(),H.rect(0,0,X,rt),H.closePath(),H.fillStrokeShape(this)}setText(H){const X=t.Util._isString(H)?H:H==null?"":H+"";return this._setAttr(_,X),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(H){var X,rt,$,F,z,et,it,ct,R,N,W;let G=v(),I=this.fontSize(),q;G.save(),G.font=this._getContextFont(),q=G.measureText(H),G.restore();const J=I/100;return{actualBoundingBoxAscent:(X=q.actualBoundingBoxAscent)!==null&&X!==void 0?X:71.58203125*J,actualBoundingBoxDescent:(rt=q.actualBoundingBoxDescent)!==null&&rt!==void 0?rt:0,actualBoundingBoxLeft:($=q.actualBoundingBoxLeft)!==null&&$!==void 0?$:-7.421875*J,actualBoundingBoxRight:(F=q.actualBoundingBoxRight)!==null&&F!==void 0?F:75.732421875*J,alphabeticBaseline:(z=q.alphabeticBaseline)!==null&&z!==void 0?z:0,emHeightAscent:(et=q.emHeightAscent)!==null&&et!==void 0?et:100*J,emHeightDescent:(it=q.emHeightDescent)!==null&&it!==void 0?it:-20*J,fontBoundingBoxAscent:(ct=q.fontBoundingBoxAscent)!==null&&ct!==void 0?ct:91*J,fontBoundingBoxDescent:(R=q.fontBoundingBoxDescent)!==null&&R!==void 0?R:21*J,hangingBaseline:(N=q.hangingBaseline)!==null&&N!==void 0?N:72.80000305175781*J,ideographicBaseline:(W=q.ideographicBaseline)!==null&&W!==void 0?W:-21*J,width:q.width,height:I}}_getContextFont(){return this.fontStyle()+k+this.fontVariant()+k+(this.fontSize()+b)+U(this.fontFamily())}_addTextLine(H){this.align()===h&&(H=H.trim());const rt=this._getTextWidth(H);return this.textArr.push({text:H,width:rt,lastInParagraph:!1})}_getTextWidth(H){const X=this.letterSpacing(),rt=H.length;return v().measureText(H).width+X*rt}_setTextData(){let H=this.text().split(`
`),X=+this.fontSize(),rt=0,$=this.lineHeight()*X,F=this.attrs.width,z=this.attrs.height,et=F!==a&&F!==void 0,it=z!==a&&z!==void 0,ct=this.padding(),R=F-ct*2,N=z-ct*2,W=0,G=this.wrap(),I=G!==M,q=G!==T&&I,J=this.ellipsis();this.textArr=[],v().font=this._getContextFont();const nt=J?this._getTextWidth(L):0;for(let Z=0,Q=H.length;Z<Q;++Z){let st=H[Z],Y=this._getTextWidth(st);if(et&&Y>R)for(;st.length>0;){let ot=0,ht=o(st).length,dt="",pt=0;for(;ot<ht;){const ft=ot+ht>>>1,vt=o(st),xt=vt.slice(0,ft+1).join(""),Ct=this._getTextWidth(xt);(J&&it&&W+$>N?Ct+nt:Ct)<=R?(ot=ft+1,dt=xt,pt=Ct):ht=ft}if(dt){if(q){const xt=o(st),Ct=o(dt),Nt=xt[Ct.length],te=Nt===k||Nt===u;let Ye;if(te&&pt<=R)Ye=Ct.length;else{const Wt=Ct.lastIndexOf(k),le=Ct.lastIndexOf(u);Ye=Math.max(Wt,le)+1}Ye>0&&(ot=Ye,dt=xt.slice(0,ot).join(""),pt=this._getTextWidth(dt))}if(dt=dt.trimRight(),this._addTextLine(dt),rt=Math.max(rt,pt),W+=$,this._shouldHandleEllipsis(W)){this._tryToAddEllipsisToLastLine();break}if(st=o(st).slice(ot).join("").trimLeft(),st.length>0&&(Y=this._getTextWidth(st),Y<=R)){this._addTextLine(st),W+=$,rt=Math.max(rt,Y);break}}else break}else this._addTextLine(st),W+=$,rt=Math.max(rt,Y),this._shouldHandleEllipsis(W)&&Z<Q-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),it&&W+$>N)break}this.textHeight=X,this.textWidth=rt}_shouldHandleEllipsis(H){const X=+this.fontSize(),rt=this.lineHeight()*X,$=this.attrs.height,F=$!==a&&$!==void 0,z=this.padding(),et=$-z*2;return!(this.wrap()!==M)||F&&H+rt>et}_tryToAddEllipsisToLastLine(){const H=this.attrs.width,X=H!==a&&H!==void 0,rt=this.padding(),$=H-rt*2,F=this.ellipsis(),z=this.textArr[this.textArr.length-1];!z||!F||(X&&(this._getTextWidth(z.text+L)<$||(z.text=z.text.slice(0,z.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(z.text+L))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const H=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,X=this.hasShadow();return H&&X?!0:super._useBufferCanvas()}};return ln.Text=O,O.prototype._fillFunc=P,O.prototype._strokeFunc=E,O.prototype.className=S,O.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,r._registerNode)(O),e.Factory.overWriteSetter(O,"width",(0,s.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(O,"height",(0,s.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(O,"direction",c),e.Factory.addGetterSetter(O,"fontFamily","Arial"),e.Factory.addGetterSetter(O,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"fontStyle",y),e.Factory.addGetterSetter(O,"fontVariant",y),e.Factory.addGetterSetter(O,"padding",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"align",m),e.Factory.addGetterSetter(O,"verticalAlign",C),e.Factory.addGetterSetter(O,"lineHeight",1,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"wrap",w),e.Factory.addGetterSetter(O,"ellipsis",!1,(0,s.getBooleanValidator)()),e.Factory.addGetterSetter(O,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"text","",(0,s.getStringValidator)()),e.Factory.addGetterSetter(O,"textDecoration",""),ln}var Xn={},Tl;function Hu(){if(Tl)return Xn;Tl=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.TextPath=void 0;const t=Mt(),e=yt(),n=Gt(),i=ms(),s=Pl(),r=_t(),o=mt(),a="",l="normal";function c(f){f.fillText(this.partialText,0,0)}function h(f){f.strokeText(this.partialText,0,0)}let p=class extends n.Shape{constructor(u){super(u),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(u){if(!this.attrs.data)return null;const m=this.pathLength;return u-1>m?null:i.Path.getPointAtLengthOfDataArray(u,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(u){u.setAttr("font",this._getContextFont()),u.setAttr("textBaseline",this.textBaseline()),u.setAttr("textAlign","left"),u.save();const m=this.textDecoration(),_=this.fill(),S=this.fontSize(),C=this.glyphInfo;m==="underline"&&u.beginPath();for(let g=0;g<C.length;g++){u.save();const d=C[g].p0;u.translate(d.x,d.y),u.rotate(C[g].rotation),this.partialText=C[g].text,u.fillStrokeShape(this),m==="underline"&&(g===0&&u.moveTo(0,S/2+1),u.lineTo(S,S/2+1)),u.restore()}m==="underline"&&(u.strokeStyle=_,u.lineWidth=S/20,u.stroke()),u.restore()}_hitFunc(u){u.beginPath();const m=this.glyphInfo;if(m.length>=1){const _=m[0].p0;u.moveTo(_.x,_.y)}for(let _=0;_<m.length;_++){const S=m[_].p1;u.lineTo(S.x,S.y)}u.setAttr("lineWidth",this.fontSize()),u.setAttr("strokeStyle",this.colorKey),u.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(u){return s.Text.prototype.setText.call(this,u)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(u){const _=this.dummyCanvas.getContext("2d");_.save(),_.font=this._getContextFont();const S=_.measureText(u);return _.restore(),{width:S.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:u,height:m}=this._getTextSize(this.attrs.text);if(this.textWidth=u,this.textHeight=m,this.glyphInfo=[],!this.attrs.data)return null;const _=this.letterSpacing(),S=this.align(),C=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*_,0);let d=0;S==="center"&&(d=Math.max(0,this.pathLength/2-g/2)),S==="right"&&(d=Math.max(0,this.pathLength-g));const y=(0,s.stringToArray)(this.text());let b=d;for(let k=0;k<y.length;k++){const D=this._getPointAtLength(b);if(!D)return;let x=this._getTextSize(y[k]).width+_;if(y[k]===" "&&S==="justify"){const V=this.text().split(" ").length-1;x+=(this.pathLength-g)/V}const w=this._getPointAtLength(b+x);if(!w)return;const T=i.Path.getLineLength(D.x,D.y,w.x,w.y);let M=0;if(C)try{M=C(y[k-1],y[k])*this.fontSize()}catch{M=0}D.x+=M,w.x+=M,this.textWidth+=M;const L=i.Path.getPointOnLine(M+T/2,D.x,D.y,w.x,w.y),B=Math.atan2(w.y-D.y,w.x-D.x);this.glyphInfo.push({transposeX:L.x,transposeY:L.y,text:y[k],rotation:B,p0:D,p1:w}),b+=x}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const u=[];this.glyphInfo.forEach(function(b){u.push(b.p0.x),u.push(b.p0.y),u.push(b.p1.x),u.push(b.p1.y)});let m=u[0]||0,_=u[0]||0,S=u[1]||0,C=u[1]||0,g,d;for(let b=0;b<u.length/2;b++)g=u[b*2],d=u[b*2+1],m=Math.min(m,g),_=Math.max(_,g),S=Math.min(S,d),C=Math.max(C,d);const y=this.fontSize();return{x:m-y/2,y:S-y/2,width:_-m+y,height:C-S+y}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Xn.TextPath=p,p.prototype._fillFunc=c,p.prototype._strokeFunc=h,p.prototype._fillFuncHit=c,p.prototype._strokeFuncHit=h,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(p),e.Factory.addGetterSetter(p,"data"),e.Factory.addGetterSetter(p,"fontFamily","Arial"),e.Factory.addGetterSetter(p,"fontSize",12,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(p,"fontStyle",l),e.Factory.addGetterSetter(p,"align","left"),e.Factory.addGetterSetter(p,"letterSpacing",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(p,"textBaseline","middle"),e.Factory.addGetterSetter(p,"fontVariant",l),e.Factory.addGetterSetter(p,"text",a),e.Factory.addGetterSetter(p,"textDecoration",""),e.Factory.addGetterSetter(p,"kerningFunc",void 0),Xn}var Jn={},kl;function Vu(){if(kl)return Jn;kl=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.Transformer=void 0;const t=Mt(),e=yt(),n=Ft(),i=Gt(),s=vl(),r=us(),o=mt(),a=_t(),l=mt(),c="tr-konva",h=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(x=>x+`.${c}`).join(" "),p="nodesRect",f=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],u={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},m="ontouchstart"in o.Konva._global;function _(x,w,T){if(x==="rotater")return T;w+=t.Util.degToRad(u[x]||0);const M=(t.Util.radToDeg(w)%360+360)%360;return t.Util._inRange(M,337.5,360)||t.Util._inRange(M,0,22.5)?"ns-resize":t.Util._inRange(M,22.5,67.5)?"nesw-resize":t.Util._inRange(M,67.5,112.5)?"ew-resize":t.Util._inRange(M,112.5,157.5)?"nwse-resize":t.Util._inRange(M,157.5,202.5)?"ns-resize":t.Util._inRange(M,202.5,247.5)?"nesw-resize":t.Util._inRange(M,247.5,292.5)?"ew-resize":t.Util._inRange(M,292.5,337.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+M),"pointer")}const S=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function C(x){return{x:x.x+x.width/2*Math.cos(x.rotation)+x.height/2*Math.sin(-x.rotation),y:x.y+x.height/2*Math.cos(x.rotation)+x.width/2*Math.sin(x.rotation)}}function g(x,w,T){const M=T.x+(x.x-T.x)*Math.cos(w)-(x.y-T.y)*Math.sin(w),L=T.y+(x.x-T.x)*Math.sin(w)+(x.y-T.y)*Math.cos(w);return{...x,rotation:x.rotation+w,x:M,y:L}}function d(x,w){const T=C(x);return g(x,w,T)}function y(x,w,T){let M=w;for(let L=0;L<x.length;L++){const B=o.Konva.getAngle(x[L]),V=Math.abs(B-w)%(Math.PI*2);Math.min(V,Math.PI*2-V)<T&&(M=B)}return M}let b=0,k=class extends r.Group{constructor(w){super(w),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(h,this.update),this.getNode()&&this.update()}attachTo(w){return this.setNode(w),this}setNode(w){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([w])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(w=[]){this._nodes&&this._nodes.length&&this.detach();const T=w.filter(L=>L.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=w=T,w.length===1&&this.useSingleNodeRotation()?this.rotation(w[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(L=>{const B=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(L._attrsAffectingSize.length){const V=L._attrsAffectingSize.map(U=>U+"Change."+this._getEventNamespace()).join(" ");L.on(V,B)}L.on(f.map(V=>V+`.${this._getEventNamespace()}`).join(" "),B),L.on(`absoluteTransformChange.${this._getEventNamespace()}`,B),this._proxyDrag(L)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(w){let T;w.on(`dragstart.${this._getEventNamespace()}`,M=>{T=w.getAbsolutePosition(),!this.isDragging()&&w!==this.findOne(".back")&&this.startDrag(M,!1)}),w.on(`dragmove.${this._getEventNamespace()}`,M=>{if(!T)return;const L=w.getAbsolutePosition(),B=L.x-T.x,V=L.y-T.y;this.nodes().forEach(U=>{if(U===w||U.isDragging())return;const K=U.getAbsolutePosition();U.setAbsolutePosition({x:K.x+B,y:K.y+V}),U.startDrag(M)}),T=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(w=>{w.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(w,T=this.rotation(),M){const L=w.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),B=w.getAbsoluteScale(M),V=w.getAbsolutePosition(M),U=L.x*B.x-w.offsetX()*B.x,K=L.y*B.y-w.offsetY()*B.y,v=(o.Konva.getAngle(w.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),P={x:V.x+U*Math.cos(v)+K*Math.sin(-v),y:V.y+K*Math.cos(v)+U*Math.sin(v),width:L.width*B.x,height:L.height*B.y,rotation:v};return g(P,-o.Konva.getAngle(T),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const T=[];this.nodes().map(v=>{const P=v.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),E=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}],A=v.getAbsoluteTransform();E.forEach(function(O){const j=A.point(O);T.push(j)})});const M=new t.Transform;M.rotate(-o.Konva.getAngle(this.rotation()));let L=1/0,B=1/0,V=-1/0,U=-1/0;T.forEach(function(v){const P=M.point(v);L===void 0&&(L=V=P.x,B=U=P.y),L=Math.min(L,P.x),B=Math.min(B,P.y),V=Math.max(V,P.x),U=Math.max(U,P.y)}),M.invert();const K=M.point({x:L,y:B});return{x:K.x,y:K.y,width:V-L,height:U-B,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S.forEach(w=>{this._createAnchor(w)}),this._createAnchor("rotater")}_createAnchor(w){const T=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:w+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:m?10:"auto"}),M=this;T.on("mousedown touchstart",function(L){M._handleMouseDown(L)}),T.on("dragstart",L=>{T.stopDrag(),L.cancelBubble=!0}),T.on("dragend",L=>{L.cancelBubble=!0}),T.on("mouseenter",()=>{const L=o.Konva.getAngle(this.rotation()),B=this.rotateAnchorCursor(),V=_(w,L,B);T.getStage().content&&(T.getStage().content.style.cursor=V),this._cursorChange=!0}),T.on("mouseout",()=>{T.getStage().content&&(T.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(T)}_createBack(){const w=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(T,M){const L=M.getParent(),B=L.padding();T.beginPath(),T.rect(-B,-B,M.width()+B*2,M.height()+B*2),T.moveTo(M.width()/2,-B),L.rotateEnabled()&&L.rotateLineVisible()&&T.lineTo(M.width()/2,-L.rotateAnchorOffset()*t.Util._sign(M.height())-B),T.fillStrokeShape(M)},hitFunc:(T,M)=>{if(!this.shouldOverdrawWholeArea())return;const L=this.padding();T.beginPath(),T.rect(-L,-L,M.width()+L*2,M.height()+L*2),T.fillStrokeShape(M)}});this.add(w),this._proxyDrag(w),w.on("dragstart",T=>{T.cancelBubble=!0}),w.on("dragmove",T=>{T.cancelBubble=!0}),w.on("dragend",T=>{T.cancelBubble=!0}),this.on("dragmove",T=>{this.update()})}_handleMouseDown(w){if(this._transforming)return;this._movingAnchorName=w.target.name().split(" ")[0];const T=this._getNodeRect(),M=T.width,L=T.height,B=Math.sqrt(Math.pow(M,2)+Math.pow(L,2));this.sin=Math.abs(L/B),this.cos=Math.abs(M/B),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const V=w.target.getAbsolutePosition(),U=w.target.getStage().getPointerPosition();this._anchorDragOffset={x:U.x-V.x,y:U.y-V.y},b++,this._fire("transformstart",{evt:w.evt,target:this.getNode()}),this._nodes.forEach(K=>{K._fire("transformstart",{evt:w.evt,target:K})})}_handleMouseMove(w){let T,M,L;const B=this.findOne("."+this._movingAnchorName),V=B.getStage();V.setPointersPositions(w);const U=V.getPointerPosition();let K={x:U.x-this._anchorDragOffset.x,y:U.y-this._anchorDragOffset.y};const v=B.getAbsolutePosition();this.anchorDragBoundFunc()&&(K=this.anchorDragBoundFunc()(v,K,w)),B.setAbsolutePosition(K);const P=B.getAbsolutePosition();if(v.x===P.x&&v.y===P.y)return;if(this._movingAnchorName==="rotater"){const $=this._getNodeRect();T=B.x()-$.width/2,M=-B.y()+$.height/2;let F=Math.atan2(-M,T)+Math.PI/2;$.height<0&&(F-=Math.PI);const et=o.Konva.getAngle(this.rotation())+F,it=o.Konva.getAngle(this.rotationSnapTolerance()),R=y(this.rotationSnaps(),et,it)-$.rotation,N=d($,R);this._fitNodesInto(N,w);return}const E=this.shiftBehavior();let A;E==="inverted"?A=this.keepRatio()&&!w.shiftKey:E==="none"?A=this.keepRatio():A=this.keepRatio()||w.shiftKey;let O=this.centeredScaling()||w.altKey;if(this._movingAnchorName==="top-left"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};L=Math.sqrt(Math.pow($.x-B.x(),2)+Math.pow($.y-B.y(),2));const F=this.findOne(".top-left").x()>$.x?-1:1,z=this.findOne(".top-left").y()>$.y?-1:1;T=L*this.cos*F,M=L*this.sin*z,this.findOne(".top-left").x($.x-T),this.findOne(".top-left").y($.y-M)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(B.y());else if(this._movingAnchorName==="top-right"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};L=Math.sqrt(Math.pow(B.x()-$.x,2)+Math.pow($.y-B.y(),2));const F=this.findOne(".top-right").x()<$.x?-1:1,z=this.findOne(".top-right").y()>$.y?-1:1;T=L*this.cos*F,M=L*this.sin*z,this.findOne(".top-right").x($.x+T),this.findOne(".top-right").y($.y-M)}var j=B.position();this.findOne(".top-left").y(j.y),this.findOne(".bottom-right").x(j.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(B.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(B.x());else if(this._movingAnchorName==="bottom-left"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};L=Math.sqrt(Math.pow($.x-B.x(),2)+Math.pow(B.y()-$.y,2));const F=$.x<B.x()?-1:1,z=B.y()<$.y?-1:1;T=L*this.cos*F,M=L*this.sin*z,B.x($.x-T),B.y($.y+M)}j=B.position(),this.findOne(".top-left").x(j.x),this.findOne(".bottom-right").y(j.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(B.y());else if(this._movingAnchorName==="bottom-right"){if(A){const $=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};L=Math.sqrt(Math.pow(B.x()-$.x,2)+Math.pow(B.y()-$.y,2));const F=this.findOne(".bottom-right").x()<$.x?-1:1,z=this.findOne(".bottom-right").y()<$.y?-1:1;T=L*this.cos*F,M=L*this.sin*z,this.findOne(".bottom-right").x($.x+T),this.findOne(".bottom-right").y($.y+M)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(O=this.centeredScaling()||w.altKey,O){const $=this.findOne(".top-left"),F=this.findOne(".bottom-right"),z=$.x(),et=$.y(),it=this.getWidth()-F.x(),ct=this.getHeight()-F.y();F.move({x:-z,y:-et}),$.move({x:it,y:ct})}const H=this.findOne(".top-left").getAbsolutePosition();T=H.x,M=H.y;const X=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),rt=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:T,y:M,width:X,height:rt,rotation:o.Konva.getAngle(this.rotation())},w)}_handleMouseUp(w){this._removeEvents(w)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(w){var T;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const M=this.getNode();b--,this._fire("transformend",{evt:w,target:M}),(T=this.getLayer())===null||T===void 0||T.batchDraw(),M&&this._nodes.forEach(L=>{var B;L._fire("transformend",{evt:w,target:L}),(B=L.getLayer())===null||B===void 0||B.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(w,T){const M=this._getNodeRect(),L=1;if(t.Util._inRange(w.width,-this.padding()*2-L,L)){this.update();return}if(t.Util._inRange(w.height,-this.padding()*2-L,L)){this.update();return}const B=new t.Transform;if(B.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&w.width<0&&this._movingAnchorName.indexOf("left")>=0){const A=B.point({x:-this.padding()*2,y:0});w.x+=A.x,w.y+=A.y,w.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y}else if(this._movingAnchorName&&w.width<0&&this._movingAnchorName.indexOf("right")>=0){const A=B.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,w.width+=this.padding()*2}if(this._movingAnchorName&&w.height<0&&this._movingAnchorName.indexOf("top")>=0){const A=B.point({x:0,y:-this.padding()*2});w.x+=A.x,w.y+=A.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,w.height+=this.padding()*2}else if(this._movingAnchorName&&w.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const A=B.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,w.height+=this.padding()*2}if(this.boundBoxFunc()){const A=this.boundBoxFunc()(M,w);A?w=A:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const V=1e7,U=new t.Transform;U.translate(M.x,M.y),U.rotate(M.rotation),U.scale(M.width/V,M.height/V);const K=new t.Transform,v=w.width/V,P=w.height/V;this.flipEnabled()===!1?(K.translate(w.x,w.y),K.rotate(w.rotation),K.translate(w.width<0?w.width:0,w.height<0?w.height:0),K.scale(Math.abs(v),Math.abs(P))):(K.translate(w.x,w.y),K.rotate(w.rotation),K.scale(v,P));const E=K.multiply(U.invert());this._nodes.forEach(A=>{var O;const j=A.getParent().getAbsoluteTransform(),H=A.getTransform().copy();H.translate(A.offsetX(),A.offsetY());const X=new t.Transform;X.multiply(j.copy().invert()).multiply(E).multiply(j).multiply(H);const rt=X.decompose();A.setAttrs(rt),(O=A.getLayer())===null||O===void 0||O.batchDraw()}),this.rotation(t.Util._getRotation(w.rotation)),this._nodes.forEach(A=>{this._fire("transform",{evt:T,target:A}),A._fire("transform",{evt:T,target:A})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(w,T){this.findOne(w).setAttrs(T)}update(){var w;const T=this._getNodeRect();this.rotation(t.Util._getRotation(T.rotation));const M=T.width,L=T.height,B=this.enabledAnchors(),V=this.resizeEnabled(),U=this.padding(),K=this.anchorSize(),v=this.find("._anchor");v.forEach(E=>{E.setAttrs({width:K,height:K,offsetX:K/2,offsetY:K/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:K/2+U,offsetY:K/2+U,visible:V&&B.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:M/2,y:0,offsetY:K/2+U,visible:V&&B.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:M,y:0,offsetX:K/2-U,offsetY:K/2+U,visible:V&&B.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:L/2,offsetX:K/2+U,visible:V&&B.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:M,y:L/2,offsetX:K/2-U,visible:V&&B.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:L,offsetX:K/2+U,offsetY:K/2-U,visible:V&&B.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:M/2,y:L,offsetY:K/2-U,visible:V&&B.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:M,y:L,offsetX:K/2-U,offsetY:K/2-U,visible:V&&B.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:M/2,y:-this.rotateAnchorOffset()*t.Util._sign(L)-U,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:M,height:L,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const P=this.anchorStyleFunc();P&&v.forEach(E=>{P(E)}),(w=this.getLayer())===null||w===void 0||w.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const w=this.findOne("."+this._movingAnchorName);w&&w.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),r.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(w){return n.Node.prototype.clone.call(this,w)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Jn.Transformer=k,k.isTransforming=()=>b>0;function D(x){return x instanceof Array||t.Util.warn("enabledAnchors value should be an array"),x instanceof Array&&x.forEach(function(w){S.indexOf(w)===-1&&t.Util.warn("Unknown anchor name: "+w+". Available names are: "+S.join(", "))}),x||[]}return k.prototype.className="Transformer",(0,l._registerNode)(k),e.Factory.addGetterSetter(k,"enabledAnchors",S,D),e.Factory.addGetterSetter(k,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(k,"resizeEnabled",!0),e.Factory.addGetterSetter(k,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateEnabled",!0),e.Factory.addGetterSetter(k,"rotateLineVisible",!0),e.Factory.addGetterSetter(k,"rotationSnaps",[]),e.Factory.addGetterSetter(k,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(k,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderEnabled",!0),e.Factory.addGetterSetter(k,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"anchorFill","white"),e.Factory.addGetterSetter(k,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderDash"),e.Factory.addGetterSetter(k,"keepRatio",!0),e.Factory.addGetterSetter(k,"shiftBehavior","default"),e.Factory.addGetterSetter(k,"centeredScaling",!1),e.Factory.addGetterSetter(k,"ignoreStroke",!1),e.Factory.addGetterSetter(k,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"nodes"),e.Factory.addGetterSetter(k,"node"),e.Factory.addGetterSetter(k,"boundBoxFunc"),e.Factory.addGetterSetter(k,"anchorDragBoundFunc"),e.Factory.addGetterSetter(k,"anchorStyleFunc"),e.Factory.addGetterSetter(k,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(k,"useSingleNodeRotation",!0),e.Factory.backCompat(k,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Jn}var Qn={},Al;function zu(){if(Al)return Qn;Al=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.Wedge=void 0;const t=yt(),e=Gt(),n=mt(),i=_t(),s=mt();let r=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return Qn.Wedge=r,r.prototype.className="Wedge",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clockwise",!1),t.Factory.backCompat(r,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Qn}var Zn={},Rl;function Wu(){if(Rl)return Zn;Rl=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.Blur=void 0;const t=yt(),e=Ft(),n=_t();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],r=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(l,c){const h=l.data,p=l.width,f=l.height;let u,m,_,S,C,g,d,y,b,k,D,x,w,T,M,L,B,V,U,K;const v=c+c+1,P=p-1,E=f-1,A=c+1,O=A*(A+1)/2,j=new i,H=s[c],X=r[c];let rt=null,$=j,F=null,z=null;for(let et=1;et<v;et++)$=$.next=new i,et===A&&(rt=$);$.next=j,_=m=0;for(let et=0;et<f;et++){x=w=T=M=S=C=g=d=0,y=A*(L=h[m]),b=A*(B=h[m+1]),k=A*(V=h[m+2]),D=A*(U=h[m+3]),S+=O*L,C+=O*B,g+=O*V,d+=O*U,$=j;for(let it=0;it<A;it++)$.r=L,$.g=B,$.b=V,$.a=U,$=$.next;for(let it=1;it<A;it++)u=m+((P<it?P:it)<<2),S+=($.r=L=h[u])*(K=A-it),C+=($.g=B=h[u+1])*K,g+=($.b=V=h[u+2])*K,d+=($.a=U=h[u+3])*K,x+=L,w+=B,T+=V,M+=U,$=$.next;F=j,z=rt;for(let it=0;it<p;it++)h[m+3]=U=d*H>>X,U!==0?(U=255/U,h[m]=(S*H>>X)*U,h[m+1]=(C*H>>X)*U,h[m+2]=(g*H>>X)*U):h[m]=h[m+1]=h[m+2]=0,S-=y,C-=b,g-=k,d-=D,y-=F.r,b-=F.g,k-=F.b,D-=F.a,u=_+((u=it+c+1)<P?u:P)<<2,x+=F.r=h[u],w+=F.g=h[u+1],T+=F.b=h[u+2],M+=F.a=h[u+3],S+=x,C+=w,g+=T,d+=M,F=F.next,y+=L=z.r,b+=B=z.g,k+=V=z.b,D+=U=z.a,x-=L,w-=B,T-=V,M-=U,z=z.next,m+=4;_+=p}for(let et=0;et<p;et++){w=T=M=x=C=g=d=S=0,m=et<<2,y=A*(L=h[m]),b=A*(B=h[m+1]),k=A*(V=h[m+2]),D=A*(U=h[m+3]),S+=O*L,C+=O*B,g+=O*V,d+=O*U,$=j;for(let ct=0;ct<A;ct++)$.r=L,$.g=B,$.b=V,$.a=U,$=$.next;let it=p;for(let ct=1;ct<=c;ct++)m=it+et<<2,S+=($.r=L=h[m])*(K=A-ct),C+=($.g=B=h[m+1])*K,g+=($.b=V=h[m+2])*K,d+=($.a=U=h[m+3])*K,x+=L,w+=B,T+=V,M+=U,$=$.next,ct<E&&(it+=p);m=et,F=j,z=rt;for(let ct=0;ct<f;ct++)u=m<<2,h[u+3]=U=d*H>>X,U>0?(U=255/U,h[u]=(S*H>>X)*U,h[u+1]=(C*H>>X)*U,h[u+2]=(g*H>>X)*U):h[u]=h[u+1]=h[u+2]=0,S-=y,C-=b,g-=k,d-=D,y-=F.r,b-=F.g,k-=F.b,D-=F.a,u=et+((u=ct+A)<E?u:E)*p<<2,S+=x+=F.r=h[u],C+=w+=F.g=h[u+1],g+=T+=F.b=h[u+2],d+=M+=F.a=h[u+3],F=F.next,y+=L=z.r,b+=B=z.g,k+=V=z.b,D+=U=z.a,x-=L,w-=B,T-=V,M-=U,z=z.next,m+=p}}const a=function(c){const h=Math.round(this.blurRadius());h>0&&o(c,h)};return Zn.Blur=a,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Zn}var ti={},El;function $u(){if(El)return ti;El=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.Brighten=void 0;const t=yt(),e=Ft(),n=_t(),i=function(s){const r=this.brightness()*255,o=s.data,a=o.length;for(let l=0;l<a;l+=4)o[l]+=r,o[l+1]+=r,o[l+2]+=r};return ti.Brighten=i,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ti}var ei={},Ml;function ju(){if(Ml)return ei;Ml=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.Contrast=void 0;const t=yt(),e=Ft(),n=_t(),i=function(s){const r=Math.pow((this.contrast()+100)/100,2),o=s.data,a=o.length;let l=150,c=150,h=150;for(let p=0;p<a;p+=4)l=o[p],c=o[p+1],h=o[p+2],l/=255,l-=.5,l*=r,l+=.5,l*=255,c/=255,c-=.5,c*=r,c+=.5,c*=255,h/=255,h-=.5,h*=r,h+=.5,h*=255,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,h=h<0?0:h>255?255:h,o[p]=l,o[p+1]=c,o[p+2]=h};return ei.Contrast=i,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ei}var ni={},Fl;function qu(){if(Fl)return ni;Fl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.Emboss=void 0;const t=yt(),e=Ft(),n=Mt(),i=_t(),s=function(r){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),c=this.embossBlend(),h=r.data,p=r.width,f=r.height,u=p*4;let m=0,_=0,S=f;switch(l){case"top-left":m=-1,_=-1;break;case"top":m=-1,_=0;break;case"top-right":m=-1,_=1;break;case"right":m=0,_=1;break;case"bottom-right":m=1,_=1;break;case"bottom":m=1,_=0;break;case"bottom-left":m=1,_=-1;break;case"left":m=0,_=-1;break;default:n.Util.error("Unknown emboss direction: "+l)}do{const C=(S-1)*u;let g=m;S+g<1&&(g=0),S+g>f&&(g=0);const d=(S-1+g)*p*4;let y=p;do{const b=C+(y-1)*4;let k=_;y+k<1&&(k=0),y+k>p&&(k=0);const D=d+(y-1+k)*4,x=h[b]-h[D],w=h[b+1]-h[D+1],T=h[b+2]-h[D+2];let M=x;const L=M>0?M:-M,B=w>0?w:-w,V=T>0?T:-T;if(B>L&&(M=w),V>L&&(M=T),M*=o,c){const U=h[b]+M,K=h[b+1]+M,v=h[b+2]+M;h[b]=U>255?255:U<0?0:U,h[b+1]=K>255?255:K<0?0:K,h[b+2]=v>255?255:v<0?0:v}else{let U=a-M;U<0?U=0:U>255&&(U=255),h[b]=h[b+1]=h[b+2]=U}}while(--y)}while(--S)};return ni.Emboss=s,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),ni}var ii={},Dl;function Ku(){if(Dl)return ii;Dl=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.Enhance=void 0;const t=yt(),e=Ft(),n=_t();function i(r,o,a,l,c){const h=a-o,p=c-l;if(h===0)return l+p/2;if(p===0)return l;let f=(r-o)/h;return f=p*f+l,f}const s=function(r){const o=r.data,a=o.length;let l=o[0],c=l,h,p=o[1],f=p,u,m=o[2],_=m,S;const C=this.enhance();if(C===0)return;for(let x=0;x<a;x+=4)h=o[x+0],h<l?l=h:h>c&&(c=h),u=o[x+1],u<p?p=u:u>f&&(f=u),S=o[x+2],S<m?m=S:S>_&&(_=S);c===l&&(c=255,l=0),f===p&&(f=255,p=0),_===m&&(_=255,m=0);let g,d,y,b,k,D;if(C>0)g=c+C*(255-c),d=l-C*(l-0),y=f+C*(255-f),b=p-C*(p-0),k=_+C*(255-_),D=m-C*(m-0);else{const x=(c+l)*.5;g=c+C*(c-x),d=l+C*(l-x);const w=(f+p)*.5;y=f+C*(f-w),b=p+C*(p-w);const T=(_+m)*.5;k=_+C*(_-T),D=m+C*(m-T)}for(let x=0;x<a;x+=4)o[x+0]=i(o[x+0],l,c,d,g),o[x+1]=i(o[x+1],p,f,b,y),o[x+2]=i(o[x+2],m,_,D,k)};return ii.Enhance=s,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ii}var ri={},Nl;function Yu(){if(Nl)return ri;Nl=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.Grayscale=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4){const r=.34*n[s]+.5*n[s+1]+.16*n[s+2];n[s]=r,n[s+1]=r,n[s+2]=r}};return ri.Grayscale=t,ri}var si={},Ol;function Xu(){if(Ol)return si;Ol=1,Object.defineProperty(si,"__esModule",{value:!0}),si.HSL=void 0;const t=yt(),e=Ft(),n=_t();t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter);const i=function(s){const r=s.data,o=r.length,a=1,l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=this.luminance()*127,p=a*l*Math.cos(c*Math.PI/180),f=a*l*Math.sin(c*Math.PI/180),u=.299*a+.701*p+.167*f,m=.587*a-.587*p+.33*f,_=.114*a-.114*p-.497*f,S=.299*a-.299*p-.328*f,C=.587*a+.413*p+.035*f,g=.114*a-.114*p+.293*f,d=.299*a-.3*p+1.25*f,y=.587*a-.586*p-1.05*f,b=.114*a+.886*p-.2*f;let k,D,x,w;for(let T=0;T<o;T+=4)k=r[T+0],D=r[T+1],x=r[T+2],w=r[T+3],r[T+0]=u*k+m*D+_*x+h,r[T+1]=S*k+C*D+g*x+h,r[T+2]=d*k+y*D+b*x+h,r[T+3]=w};return si.HSL=i,si}var oi={},Ll;function Ju(){if(Ll)return oi;Ll=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.HSV=void 0;const t=yt(),e=Ft(),n=_t(),i=function(s){const r=s.data,o=r.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=a*l*Math.cos(c*Math.PI/180),p=a*l*Math.sin(c*Math.PI/180),f=.299*a+.701*h+.167*p,u=.587*a-.587*h+.33*p,m=.114*a-.114*h-.497*p,_=.299*a-.299*h-.328*p,S=.587*a+.413*h+.035*p,C=.114*a-.114*h+.293*p,g=.299*a-.3*h+1.25*p,d=.587*a-.586*h-1.05*p,y=.114*a+.886*h-.2*p;for(let b=0;b<o;b+=4){const k=r[b+0],D=r[b+1],x=r[b+2],w=r[b+3];r[b+0]=f*k+u*D+m*x,r[b+1]=_*k+S*D+C*x,r[b+2]=g*k+d*D+y*x,r[b+3]=w}};return oi.HSV=i,t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),oi}var ai={},Gl;function Qu(){if(Gl)return ai;Gl=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.Invert=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4)n[s]=255-n[s],n[s+1]=255-n[s+1],n[s+2]=255-n[s+2]};return ai.Invert=t,ai}var li={},Il;function Zu(){if(Il)return li;Il=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Kaleidoscope=void 0;const t=yt(),e=Ft(),n=Mt(),i=_t(),s=function(a,l,c){const h=a.data,p=l.data,f=a.width,u=a.height,m=c.polarCenterX||f/2,_=c.polarCenterY||u/2;let S=Math.sqrt(m*m+_*_),C=f-m,g=u-_;const d=Math.sqrt(C*C+g*g);S=d>S?d:S;const y=u,b=f,k=360/b*Math.PI/180;for(let D=0;D<b;D+=1){const x=Math.sin(D*k),w=Math.cos(D*k);for(let T=0;T<y;T+=1){C=Math.floor(m+S*T/y*w),g=Math.floor(_+S*T/y*x);let M=(g*f+C)*4;const L=h[M+0],B=h[M+1],V=h[M+2],U=h[M+3];M=(D+T*f)*4,p[M+0]=L,p[M+1]=B,p[M+2]=V,p[M+3]=U}}},r=function(a,l,c){const h=a.data,p=l.data,f=a.width,u=a.height,m=c.polarCenterX||f/2,_=c.polarCenterY||u/2;let S=Math.sqrt(m*m+_*_),C=f-m,g=u-_;const d=Math.sqrt(C*C+g*g);S=d>S?d:S;const y=u,b=f,k=0;let D,x;for(C=0;C<f;C+=1)for(g=0;g<u;g+=1){const w=C-m,T=g-_,M=Math.sqrt(w*w+T*T)*y/S;let L=(Math.atan2(T,w)*180/Math.PI+360+k)%360;L=L*b/360,D=Math.floor(L),x=Math.floor(M);let B=(x*f+D)*4;const V=h[B+0],U=h[B+1],K=h[B+2],v=h[B+3];B=(g*f+C)*4,p[B+0]=V,p[B+1]=U,p[B+2]=K,p[B+3]=v}},o=function(a){const l=a.width,c=a.height;let h,p,f,u,m,_,S,C,g,d,y=Math.round(this.kaleidoscopePower());const b=Math.round(this.kaleidoscopeAngle()),k=Math.floor(l*(b%360)/360);if(y<1)return;const D=n.Util.createCanvasElement();D.width=l,D.height=c;const x=D.getContext("2d").getImageData(0,0,l,c);n.Util.releaseCanvas(D),s(a,x,{polarCenterX:l/2,polarCenterY:c/2});let w=l/Math.pow(2,y);for(;w<=8;)w=w*2,y-=1;w=Math.ceil(w);let T=w,M=0,L=T,B=1;for(k+w>l&&(M=T,L=0,B=-1),p=0;p<c;p+=1)for(h=M;h!==L;h+=B)f=Math.round(h+k)%l,g=(l*p+f)*4,m=x.data[g+0],_=x.data[g+1],S=x.data[g+2],C=x.data[g+3],d=(l*p+h)*4,x.data[d+0]=m,x.data[d+1]=_,x.data[d+2]=S,x.data[d+3]=C;for(p=0;p<c;p+=1)for(T=Math.floor(w),u=0;u<y;u+=1){for(h=0;h<T+1;h+=1)g=(l*p+h)*4,m=x.data[g+0],_=x.data[g+1],S=x.data[g+2],C=x.data[g+3],d=(l*p+T*2-h-1)*4,x.data[d+0]=m,x.data[d+1]=_,x.data[d+2]=S,x.data[d+3]=C;T*=2}r(x,a,{})};return li.Kaleidoscope=o,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),li}var ci={},Ul;function tf(){if(Ul)return ci;Ul=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.Mask=void 0;const t=yt(),e=Ft(),n=_t();function i(f,u,m){let _=(m*f.width+u)*4;const S=[];return S.push(f.data[_++],f.data[_++],f.data[_++],f.data[_++]),S}function s(f,u){return Math.sqrt(Math.pow(f[0]-u[0],2)+Math.pow(f[1]-u[1],2)+Math.pow(f[2]-u[2],2))}function r(f){const u=[0,0,0];for(let m=0;m<f.length;m++)u[0]+=f[m][0],u[1]+=f[m][1],u[2]+=f[m][2];return u[0]/=f.length,u[1]/=f.length,u[2]/=f.length,u}function o(f,u){const m=i(f,0,0),_=i(f,f.width-1,0),S=i(f,0,f.height-1),C=i(f,f.width-1,f.height-1),g=u||10;if(s(m,_)<g&&s(_,C)<g&&s(C,S)<g&&s(S,m)<g){const d=r([_,m,C,S]),y=[];for(let b=0;b<f.width*f.height;b++){const k=s(d,[f.data[b*4],f.data[b*4+1],f.data[b*4+2]]);y[b]=k<g?0:255}return y}}function a(f,u){for(let m=0;m<f.width*f.height;m++)f.data[4*m+3]=u[m]}function l(f,u,m){const _=[1,1,1,1,0,1,1,1,1],S=Math.round(Math.sqrt(_.length)),C=Math.floor(S/2),g=[];for(let d=0;d<m;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const w=d+D-C,T=y+x-C;if(w>=0&&w<m&&T>=0&&T<u){const M=w*u+T,L=_[D*S+x];k+=f[M]*L}}g[b]=k===2040?255:0}return g}function c(f,u,m){const _=[1,1,1,1,1,1,1,1,1],S=Math.round(Math.sqrt(_.length)),C=Math.floor(S/2),g=[];for(let d=0;d<m;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const w=d+D-C,T=y+x-C;if(w>=0&&w<m&&T>=0&&T<u){const M=w*u+T,L=_[D*S+x];k+=f[M]*L}}g[b]=k>=1020?255:0}return g}function h(f,u,m){const _=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],S=Math.round(Math.sqrt(_.length)),C=Math.floor(S/2),g=[];for(let d=0;d<m;d++)for(let y=0;y<u;y++){const b=d*u+y;let k=0;for(let D=0;D<S;D++)for(let x=0;x<S;x++){const w=d+D-C,T=y+x-C;if(w>=0&&w<m&&T>=0&&T<u){const M=w*u+T,L=_[D*S+x];k+=f[M]*L}}g[b]=k}return g}const p=function(f){const u=this.threshold();let m=o(f,u);return m&&(m=l(m,f.width,f.height),m=c(m,f.width,f.height),m=h(m,f.width,f.height),a(f,m)),f};return ci.Mask=p,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ci}var hi={},Bl;function ef(){if(Bl)return hi;Bl=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Noise=void 0;const t=yt(),e=Ft(),n=_t(),i=function(s){const r=this.noise()*255,o=s.data,a=o.length,l=r/2;for(let c=0;c<a;c+=4)o[c+0]+=l-2*l*Math.random(),o[c+1]+=l-2*l*Math.random(),o[c+2]+=l-2*l*Math.random()};return hi.Noise=i,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),hi}var di={},Hl;function nf(){if(Hl)return di;Hl=1,Object.defineProperty(di,"__esModule",{value:!0}),di.Pixelate=void 0;const t=yt(),e=Mt(),n=Ft(),i=_t(),s=function(r){let o=Math.ceil(this.pixelSize()),a=r.width,l=r.height,c=Math.ceil(a/o),h=Math.ceil(l/o),p=r.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let f=0;f<c;f+=1)for(let u=0;u<h;u+=1){let m=0,_=0,S=0,C=0;const g=f*o,d=g+o,y=u*o,b=y+o;let k=0;for(let D=g;D<d;D+=1)if(!(D>=a))for(let x=y;x<b;x+=1){if(x>=l)continue;const w=(a*x+D)*4;m+=p[w+0],_+=p[w+1],S+=p[w+2],C+=p[w+3],k+=1}m=m/k,_=_/k,S=S/k,C=C/k;for(let D=g;D<d;D+=1)if(!(D>=a))for(let x=y;x<b;x+=1){if(x>=l)continue;const w=(a*x+D)*4;p[w+0]=m,p[w+1]=_,p[w+2]=S,p[w+3]=C}}};return di.Pixelate=s,t.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),di}var ui={},Vl;function rf(){if(Vl)return ui;Vl=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Posterize=void 0;const t=yt(),e=Ft(),n=_t(),i=function(s){const r=Math.round(this.levels()*254)+1,o=s.data,a=o.length,l=255/r;for(let c=0;c<a;c+=1)o[c]=Math.floor(o[c]/l)*l};return ui.Posterize=i,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ui}var fi={},zl;function sf(){if(zl)return fi;zl=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.RGB=void 0;const t=yt(),e=Ft(),n=_t(),i=function(s){const r=s.data,o=r.length,a=this.red(),l=this.green(),c=this.blue();for(let h=0;h<o;h+=4){const p=(.34*r[h]+.5*r[h+1]+.16*r[h+2])/255;r[h]=p*a,r[h+1]=p*l,r[h+2]=p*c,r[h+3]=r[h+3]}};return fi.RGB=i,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),fi}var gi={},Wl;function of(){if(Wl)return gi;Wl=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.RGBA=void 0;const t=yt(),e=Ft(),n=_t(),i=function(s){const r=s.data,o=r.length,a=this.red(),l=this.green(),c=this.blue(),h=this.alpha();for(let p=0;p<o;p+=4){const f=1-h;r[p]=a*h+r[p]*f,r[p+1]=l*h+r[p+1]*f,r[p+2]=c*h+r[p+2]*f}};return gi.RGBA=i,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),gi}var pi={},$l;function af(){if($l)return pi;$l=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Sepia=void 0;const t=function(e){const n=e.data,i=n.length;for(let s=0;s<i;s+=4){const r=n[s+0],o=n[s+1],a=n[s+2];n[s+0]=Math.min(255,r*.393+o*.769+a*.189),n[s+1]=Math.min(255,r*.349+o*.686+a*.168),n[s+2]=Math.min(255,r*.272+o*.534+a*.131)}};return pi.Sepia=t,pi}var mi={},jl;function lf(){if(jl)return mi;jl=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.Solarize=void 0;const t=function(e){const n=e.data,i=e.width,s=e.height,r=i*4;let o=s;do{const a=(o-1)*r;let l=i;do{const c=a+(l-1)*4;let h=n[c],p=n[c+1],f=n[c+2];h>127&&(h=255-h),p>127&&(p=255-p),f>127&&(f=255-f),n[c]=h,n[c+1]=p,n[c+2]=f}while(--l)}while(--o)};return mi.Solarize=t,mi}var yi={},ql;function cf(){if(ql)return yi;ql=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.Threshold=void 0;const t=yt(),e=Ft(),n=_t(),i=function(s){const r=this.threshold()*255,o=s.data,a=o.length;for(let l=0;l<a;l+=1)o[l]=o[l]<r?0:255};return yi.Threshold=i,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),yi}var Kl;function hf(){if(Kl)return Mn;Kl=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.Konva=void 0;const t=Ru(),e=Eu(),n=Fu(),i=Du(),s=Nu(),r=Ou(),o=Lu(),a=hl(),l=ms(),c=vl(),h=Gu(),p=Iu(),f=Uu(),u=Bu(),m=Pl(),_=Hu(),S=Vu(),C=zu(),g=Wu(),d=$u(),y=ju(),b=qu(),k=Ku(),D=Yu(),x=Xu(),w=Ju(),T=Qu(),M=Zu(),L=tf(),B=ef(),V=nf(),U=rf(),K=sf(),v=of(),P=af(),E=lf(),A=cf();return Mn.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:s.Ellipse,Image:r.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:l.Path,Rect:c.Rect,RegularPolygon:h.RegularPolygon,Ring:p.Ring,Sprite:f.Sprite,Star:u.Star,Text:m.Text,TextPath:_.TextPath,Transformer:S.Transformer,Wedge:C.Wedge,Filters:{Blur:g.Blur,Brighten:d.Brighten,Contrast:y.Contrast,Emboss:b.Emboss,Enhance:k.Enhance,Grayscale:D.Grayscale,HSL:x.HSL,HSV:w.HSV,Invert:T.Invert,Kaleidoscope:M.Kaleidoscope,Mask:L.Mask,Noise:B.Noise,Pixelate:V.Pixelate,Posterize:U.Posterize,RGB:K.RGB,RGBA:v.RGBA,Sepia:P.Sepia,Solarize:E.Solarize,Threshold:A.Threshold}}),Mn}var df=rr.exports,Yl;function uf(){if(Yl)return rr.exports;Yl=1,Object.defineProperty(df,"__esModule",{value:!0});const t=hf();return rr.exports=t.Konva,rr.exports}var ff=uf();const tt=Pu(ff);class gf{constructor(e,n,i){this.captureState=e,this.restoreState=n,this.onStateChange=i}history=[];historyIndex=-1;inUndoRedo=!1;maxHistorySize=50;executeCommand(e,n){if(this.inUndoRedo){n();return}const i=this.captureState();if(!i)return;n();const s=this.captureState();if(!s||i===s)return;const r={name:e,beforeState:i,afterState:s};this.history.splice(this.historyIndex+1),this.history.push(r),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${e}" added to history. Index: ${this.historyIndex}`)}pushCommand(e,n,i){if(!n||!i||n===i)return;const s={name:e,beforeState:n,afterState:i};this.history.splice(this.historyIndex+1),this.history.push(s),this.historyIndex=this.history.length-1,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex=this.history.length-1),this.onStateChange?.(),console.log(`Command "${e}" pushed. Index: ${this.historyIndex}`)}undo(){if(this.historyIndex<0)return;this.inUndoRedo=!0;const e=this.history[this.historyIndex];console.log(`Undoing command: ${e.name}`),this.restoreState(e.beforeState),this.historyIndex--,this.onStateChange?.(),this.inUndoRedo=!1}redo(){if(this.historyIndex>=this.history.length-1)return;this.inUndoRedo=!0,this.historyIndex++;const e=this.history[this.historyIndex];console.log(`Redoing command: ${e.name}`),this.restoreState(e.afterState),this.onStateChange?.(),this.inUndoRedo=!1}canUndo(){return this.historyIndex>=0}canRedo(){return this.historyIndex<this.history.length-1}}const pf=()=>{const t=wo(new Set),e=new Map,n=Dt(()=>[...t].map(i=>i.konvaNode));return{stage:void 0,konvaContainer:void 0,activeTool:Tt("select"),layers:{selectionOverlay:void 0,transformer:void 0,transformerLayer:void 0},canvasItems:new Map,callbacks:{},keyboardDisposables:[],freehand:{strokes:new Map,strokeGroups:new Map,dragSelectionState:Tt({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,isDrawing:!1,currentPoints:[],currentTimestamps:[],drawingStartTime:0,showGrid:Tt(!1),gridSize:20,selectedStrokesForTimeline:Tt(new Set),timelineDuration:Tt(0),currentPlaybackTime:Tt(0),freehandDrawMode:Tt(!0),useRealTiming:Tt(!1),maxInterStrokeDelay:300,isAnimating:Tt(!1),freehandDragStartState:null,serializedState:"",bakedRenderData:[],bakedGroupMap:{}},polygon:{shapes:new Map,groups:new Map,isDrawing:Tt(!1),currentPoints:Tt([]),mode:Tt("draw"),dragStartState:null,proximityThreshold:10,serializedState:"",bakedRenderData:[]},selection:{items:t,originalStyles:e,selectedKonvaNodes:n,dragSelectionState:Tt({isSelecting:!1,startPos:{x:0,y:0},currentPos:{x:0,y:0},isShiftHeld:!1}),selectionRect:void 0,selectionDragState:{isDragging:!1,startPos:{x:0,y:0},startNodePositions:new Map,beforeState:""},transformStartState:""},command:{},metadata:{activeNode:Tt(null),metadataText:Tt(""),showEditor:Tt(!1),highlight:{}},ancillary:{activeVisualizations:Tt(new Set),nodeVisualizations:new Map,listenersAttached:!1,rafToken:null,activeWatchStop:void 0}}},qt=t=>t.freehand.strokes,ys=t=>t.freehand.strokeGroups,se=t=>t.polygon.shapes,qe=(t,e,n)=>{if(!t.command.executeCommand){console.warn("executeCommand called before setup - falling back to direct execution"),n();return}t.command.executeCommand(e,n)},ar=(t,e,n,i)=>{if(!t.command.pushCommand){console.warn("pushCommandWithStates called before setup - ignoring");return}t.command.pushCommand(e,n,i)};function mf(t,e,n=!1){n||_s(t),t.selection.items.add(e),bs(t),lr(t)}function yf(t,e,n=!1){t.selection.items.has(e)?t.selection.items.delete(e):(n||_s(t),t.selection.items.add(e)),bs(t),lr(t)}function _s(t){vs(t),t.selection.items.clear(),lr(t)}function _f(t,e){return t.selection.items.has(e)}function vf(t){return t.selection.items.size===0}function bf(t){return t.selection.items.size}function Sf(t){return t.selection.items.size===1?[...t.selection.items][0].konvaNode:null}function vs(t){t.selection.originalStyles.forEach(e=>{const n=e.node;n&&(n instanceof tt.Path||n instanceof tt.Line)&&(n.stroke(e.stroke),n.strokeWidth(e.strokeWidth))}),t.selection.originalStyles.clear(),Ss(t)}function bs(t){vs(t);for(const e of t.selection.items){const n=e.konvaNode;(n instanceof tt.Path||n instanceof tt.Line)&&(t.selection.originalStyles.set(e.id,{node:n,stroke:n.stroke(),strokeWidth:n.strokeWidth()}),n.stroke("#ff6b35"),n.strokeWidth(4))}Ss(t)}function Ss(t){const e=new Set;for(const n of t.selection.items){let i=n.konvaNode.getParent();for(;i&&!(i instanceof tt.Layer);)i=i.getParent();i instanceof tt.Layer&&e.add(i)}t.selection.originalStyles.forEach(n=>{let i=n.node.getParent();for(;i&&!(i instanceof tt.Layer);)i=i.getParent();i instanceof tt.Layer&&e.add(i)}),e.forEach(n=>n.batchDraw())}const xs=(t,e)=>{const n=t.selection.originalStyles.size>0;n&&vs(t);try{return e()}finally{t.selection.items.size>0?bs(t):n&&Ss(t)}};function lr(t){t.callbacks.syncAppState?.(t),t.callbacks.refreshAncillaryViz?.()}function xf(t,e,n){qe(t,"Edit Metadata",()=>{e.setMetadata(n),lr(t)})}function cr(t,e,n=!1){mf(t,e,n)}function wf(t,e,n=!1){yf(t,e,n)}function oe(t){_s(t)}function Xl(t,e){return _f(t,e)}function ws(t){return vf(t)}function cn(t){return bf(t)}const Cf=t=>Sf(t);function Pf(t,e,n){xf(t,e,n)}const _i=(t="id_")=>`${t}${crypto.randomUUID()}`,hr=t=>{let e=1/0,n=-1/0,i=1/0,s=-1/0;for(let r=0;r<t.length;r+=2)e=Math.min(e,t[r]),n=Math.max(n,t[r]),i=Math.min(i,t[r+1]),s=Math.max(s,t[r+1]);return{minX:e,maxX:n,minY:i,maxY:s}},Tf=t=>{for(let e=0;e<t.length;e++)for(let n=e+1;n<t.length;n++)if(t[e].isAncestorOf(t[n])||t[n].isAncestorOf(t[e]))return!0;return!1},Jl=(t,e,n)=>{e.id()||e.id(_i("stroke_"));const i={id:e.id(),type:"stroke",konvaNode:e,getBounds(){const s=e.getClientRect();return{minX:s.x,maxX:s.x+s.width,minY:s.y,maxY:s.y+s.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(s){s===void 0||Object.keys(s).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",s)}};return t.canvasItems.set(i.id,i),i},Cs=(t,e)=>{e.id()||e.id(_i("group_"));const n={id:e.id(),type:"strokeGroup",konvaNode:e,getBounds(){const i=e.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",i)}};return t.canvasItems.set(n.id,n),n},Ps=(t,e)=>{e.id()||e.id(_i("poly_"));const n={id:e.id(),type:"polygon",konvaNode:e,getBounds(){const i=e.getClientRect();return{minX:i.x,maxX:i.x+i.width,minY:i.y,maxY:i.y+i.height}},getMetadata(){return e.getAttr("metadata")},setMetadata(i){i===void 0||Object.keys(i).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",i)}};return t.canvasItems.set(n.id,n),n},kf=(t,e)=>t.canvasItems.get(e.id()),Af=(t,e)=>{t.canvasItems.delete(e)},dr=(t,e)=>kf(t,e),Ql=(t,e)=>{Af(t,e)};function Rf(t,e,n,i=document.body){const s=o=>{o.key===e&&n(o)};i.addEventListener("keydown",s);const r=()=>{i.removeEventListener("keydown",s);const o=t.keyboardDisposables.indexOf(r);o!==-1&&t.keyboardDisposables.splice(o,1)};return t.keyboardDisposables.push(r),r}const Ef=()=>({canceled:!1}),Zl=t=>{t.token.canceled||(t.token.canceled=!0,t.frameId!==null&&(cancelAnimationFrame(t.frameId),t.frameId=null))},Mf=t=>{const e={frameId:null,token:Ef()},n=i=>{if(e.token.canceled)return;e.frameId=null;const s=t(i,e.token);if(e.token.canceled||s===!1){Zl(e);return}e.frameId=requestAnimationFrame(n)};return e.frameId=requestAnimationFrame(n),{token:e.token,cancel:()=>Zl(e)}},Ff={class:"timeline-container"},Df={class:"timeline-controls"},Nf=["disabled"],Of=["disabled"],Lf={class:"time-display"},Gf=rn({__name:"Timeline",props:{strokes:{type:Map},selectedStrokes:{type:Set},useRealTiming:{type:Boolean},maxInterStrokeDelay:{type:Number},overrideDuration:{type:Number},lockWhileAnimating:{type:Function}},emits:["timeUpdate"],setup(t,{emit:e}){const n=t,i=e,s=Tt(0),r=Tt(0),o=Tt(!1),a=Tt(null);let l,c=0,h=null;const p=()=>{if(n.overrideDuration!==void 0)r.value=n.overrideDuration;else{let D=0;const x=[];if(n.selectedStrokes.size>0)n.selectedStrokes.forEach(w=>{const T=n.strokes.get(w);T&&x.push(T)}),x.sort((w,T)=>{const M=parseInt(w.id.split("-")[1]||"0"),L=parseInt(T.id.split("-")[1]||"0");return M-L}),x.forEach((w,T)=>{if(w.timestamps&&w.timestamps.length>0){const M=w.timestamps[w.timestamps.length-1]||0;D+=M,T<x.length-1&&(D+=100)}});else{const w=Array.from(n.strokes.values());w.sort((M,L)=>{const B=parseInt(M.id.split("-")[1]||"0"),V=parseInt(L.id.split("-")[1]||"0");return B-V});let T=0;w.forEach((M,L)=>{if(M.timestamps&&M.timestamps.length>0){const B=M.creationTime||parseInt(M.id.split("-")[1]||"0"),V=M.timestamps[M.timestamps.length-1]||0;if(L===0)D=V,T=B+V;else{let U=Math.max(0,B-T);!n.useRealTiming&&U>n.maxInterStrokeDelay&&(U=n.maxInterStrokeDelay),D+=U+V,T=B+V}}})}r.value=D}r.value>0&&s.value>r.value&&(s.value=0,i("timeUpdate",0))};It([()=>n.strokes,()=>n.selectedStrokes,()=>n.useRealTiming,()=>n.maxInterStrokeDelay,()=>n.overrideDuration],()=>{p()},{immediate:!0,deep:!0});const f=Dt(()=>r.value===0?0:s.value/r.value*100),u=D=>{const x=Math.floor(D/1e3),w=Math.floor(D%1e3/10);return`${x}.${w.toString().padStart(2,"0")}s`},m=()=>{o.value||r.value===0||(o.value=!0,n.lockWhileAnimating?.(!0),c=performance.now()-s.value,l=Mf(()=>o.value?(s.value=performance.now()-c,s.value>=r.value?(s.value=0,o.value=!1,n.lockWhileAnimating?.(!1),i("timeUpdate",0),l=void 0,!1):(i("timeUpdate",s.value),!0)):(l=void 0,!1)))},_=()=>{o.value=!1;const D=s.value===0;n.lockWhileAnimating?.(!D),l?.cancel(),l=void 0},S=()=>{o.value=!1,C.value=!1,n.lockWhileAnimating?.(!1),s.value=0,l?.cancel(),l=void 0,i("timeUpdate",0)},C=Tt(!1),g=D=>{if(!h)return;const x=Math.max(0,Math.min(D.clientX-h.left,h.width)),w=h.width>0?x/h.width:0;s.value=w*r.value,i("timeUpdate",s.value)},d=D=>{C.value&&g(D)},y=()=>{if(!C.value)return;C.value=!1;const D=s.value===0;n.lockWhileAnimating?.(!D),h=null,window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",y)},b=D=>{D.preventDefault();const x=a.value;x&&(C.value=!0,n.lockWhileAnimating?.(!0),h=x.getBoundingClientRect(),window.addEventListener("mousemove",d),window.addEventListener("mouseup",y),g(D))},k=D=>{if(!C.value){const w=D.currentTarget.getBoundingClientRect(),M=Math.max(0,Math.min(D.clientX-w.left,w.width))/w.width;s.value=M*r.value;const L=s.value===0;n.lockWhileAnimating?.(!L),o.value&&(c=performance.now()-s.value),i("timeUpdate",s.value)}};return Cn(()=>{l?.cancel(),l=void 0,C.value&&(C.value=!1,n.lockWhileAnimating?.(!1)),h=null,window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",y)}),(D,x)=>(wt(),At("div",Ff,[at("div",Df,[at("button",{onClick:m,disabled:o.value},"",8,Nf),at("button",{onClick:_,disabled:!o.value},"",8,Of),at("button",{onClick:S},""),at("span",Lf,Yt(u(s.value))+" / "+Yt(u(r.value)),1)]),at("div",{ref_key:"timelineTrackRef",ref:a,class:"timeline-track",onClick:k,onMousedown:b},[at("div",{class:"timeline-progress",style:Ie({width:f.value+"%"})},null,4),at("div",{class:"timeline-playhead",style:Ie({left:f.value+"%"}),onMousedown:bu(b,["stop"])},null,36)],544)]))}}),If=".timeline-container[data-v-bbee97de]{width:600px;background:#fff;border:1px solid #ccc;border-radius:8px;padding:15px;box-shadow:0 2px 10px #0000001a;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.timeline-controls[data-v-bbee97de]{display:flex;align-items:center;gap:10px;margin-bottom:10px}.timeline-controls button[data-v-bbee97de]{background:none;border:1px solid #ccc;border-radius:4px;padding:5px 10px;cursor:pointer;font-size:16px}.timeline-controls button[data-v-bbee97de]:hover:not(:disabled){background:#f0f0f0}.timeline-controls button[data-v-bbee97de]:disabled{opacity:.5;cursor:not-allowed}.time-display[data-v-bbee97de]{margin-left:auto;font-family:monospace;font-size:14px;color:#666}.timeline-track[data-v-bbee97de]{position:relative;height:40px;background:#f0f0f0;border-radius:4px;cursor:pointer}.timeline-progress[data-v-bbee97de]{position:absolute;top:0;left:0;height:100%;background:#06f;border-radius:4px}.timeline-playhead[data-v-bbee97de]{position:absolute;top:-5px;width:10px;height:50px;background:#06f;border-radius:2px;transform:translate(-50%);cursor:grab;z-index:10}.timeline-playhead[data-v-bbee97de]:hover{background:#0052cc}.timeline-playhead[data-v-bbee97de]:active{cursor:grabbing}",vi=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n},Uf=vi(Gf,[["styles",[If]],["__scopeId","data-v-bbee97de"]]),Bf={key:0,class:"metadata-editor"},Hf={class:"header"},Vf={key:0,class:"unsaved-indicator"},zf={key:0},Wf={class:"buttons"},$f=["disabled"],jf=["disabled"],qf={key:1,class:"warning"},tc=vi(rn({__name:"MetadataEditor",props:{metadata:{type:null},visible:{type:Boolean},canEdit:{type:Boolean}},emits:["apply","cancel"],setup(t,{emit:e}){const n=t,i=e,s=Tt(""),r=Tt(""),o=Dt(()=>s.value!==r.value);It(()=>[n.metadata,n.canEdit],([c,h])=>{if(h){const p=JSON.stringify(c??{},null,2);s.value=p,r.value=p}else s.value="",r.value=""},{immediate:!0,deep:!0});const a=()=>{try{const c=JSON.parse(s.value||"{}");i("apply",c),r.value=s.value}catch{alert("Invalid JSON format")}},l=()=>{s.value=r.value};return(c,h)=>c.visible?(wt(),At("div",Bf,[at("div",Hf,[o.value?(wt(),At("div",Vf,h[1]||(h[1]=[at("span",{class:"dot"},null,-1),ma(" Unsaved changes ")]))):re("",!0)]),c.canEdit?(wt(),At("div",zf,[h[2]||(h[2]=at("p",{class:"help"},"Edit the metadata as JSON:",-1)),No(at("textarea",{"onUpdate:modelValue":h[0]||(h[0]=p=>s.value=p),class:"textarea",placeholder:"{}"},null,512),[[mu,s.value]]),at("div",Wf,[at("button",{onClick:a,class:"btn save",disabled:!o.value}," Save ",8,$f),at("button",{onClick:l,class:"btn cancel",disabled:!o.value}," Cancel ",8,jf)])])):(wt(),At("div",qf,h[3]||(h[3]=[at("p",null,"Select multiple items to edit metadata (single selection only)",-1)])))])):re("",!0)}}),[["styles",[".metadata-editor[data-v-894edfb8]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:6px 16px;margin-top:8px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-894edfb8]{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}.header h3[data-v-894edfb8]{margin:0;font-size:17px;color:#333}.unsaved-indicator[data-v-894edfb8]{display:flex;align-items:center;gap:6px;font-size:13px;color:#f39c12;font-weight:500}.dot[data-v-894edfb8]{width:6px;height:6px;background:#f39c12;border-radius:50%;animation:pulse-894edfb8 1.5s infinite}@keyframes pulse-894edfb8{0%,to{opacity:1}50%{opacity:.5}}.help[data-v-894edfb8]{margin:0 0 4px;color:#666;font-size:14px}.textarea[data-v-894edfb8]{width:100%;min-height:120px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:14px;line-height:1.3;resize:vertical;margin-bottom:4px}.textarea[data-v-894edfb8]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 2px #0066ff26}.buttons[data-v-894edfb8]{display:flex;gap:8px}.btn[data-v-894edfb8]{padding:4px 12px;border:1px solid;border-radius:4px;cursor:pointer;font-size:14px;transition:all .2s}.btn[data-v-894edfb8]:disabled{opacity:.5;cursor:not-allowed}.save[data-v-894edfb8]{background:#28a745;color:#fff;border-color:#28a745}.save[data-v-894edfb8]:hover:not(:disabled){background:#218838}.cancel[data-v-894edfb8]{background:#6c757d;color:#fff;border-color:#6c757d}.cancel[data-v-894edfb8]:hover:not(:disabled){background:#5a6268}.warning[data-v-894edfb8]{text-align:center;color:#e67e22;padding:8px}.warning p[data-v-894edfb8]{margin:0;font-size:15px}"]],["__scopeId","data-v-894edfb8"]]),Kf={class:"smart-metadata-editor"},Yf={key:1,class:"hierarchical-editor"},Xf={class:"header"},Jf={key:0},Qf={key:1,class:"multi-selection-header"},Zf={class:"help"},t0={key:0,class:"tree-view"},e0=["onClick","onMouseenter"],n0={class:"label"},i0={key:0,class:"metadata-indicator"},r0={key:1,class:"empty-state"},s0={key:3,class:"selection-hint"},o0={key:2,class:"empty-state"},a0=vi(rn({__name:"HierarchicalMetadataEditor",props:{selectedNodes:{type:Array},singleNode:{type:[Object,null]},multiSelected:{type:Boolean},groupSelected:{type:Boolean},collectHierarchyFromRoot:{type:Function},updateMetadataHighlight:{type:Function},updateHoverHighlight:{type:Function},onApplyMetadata:{type:Function}},setup(t){const e=t,n=Dt(()=>e.selectedNodes),i=Dt(()=>e.singleNode),s=Dt(()=>e.multiSelected),r=Dt(()=>e.groupSelected),o=Dt(()=>s.value||r.value?"hierarchical":i.value?"simple":"none"),a=Dt(()=>{if(s.value)return e.collectHierarchyFromRoot(n.value);if(r.value){const g=n.value[0];return g?e.collectHierarchyFromRoot([g]):[]}return[]}),l=Ah(null),c=Dt(()=>{const g=i.value;return g?g.getAttr("metadata")??{}:null}),h=Dt(()=>{const g=l.value;return g?g.getAttr("metadata")??{}:null});It([o,r,n],([g,d])=>{if(g==="hierarchical"&&d){const y=n.value[0];y&&(l.value=y,e.updateMetadataHighlight(y))}else g==="simple"&&i.value?(l.value=i.value,e.updateMetadataHighlight(i.value)):(g==="hierarchical"&&s.value||g==="none")&&(l.value=null,e.updateMetadataHighlight(void 0))},{immediate:!0}),It(i,g=>{o.value==="simple"&&(l.value=g,e.updateMetadataHighlight(g))}),It(l,g=>{e.updateMetadataHighlight(g)}),It(o,g=>{g==="none"&&(l.value=null,e.updateMetadataHighlight(void 0))}),Cn(()=>{e.updateMetadataHighlight(void 0),e.updateHoverHighlight(void 0)});const p=g=>{l.value=g},f=g=>{i.value&&e.onApplyMetadata(i.value,g)},u=g=>{l.value&&e.onApplyMetadata(l.value,g)},m=g=>{const d=g,y=d.id()||`#${d._id}`;if(d instanceof tt.Group){const b=d.getChildren().length;return`Group ${y} (${b} ${b===1?"child":"children"})`}else return d instanceof tt.Path?`Stroke ${y}`:d instanceof tt.Line?`Polygon ${y}`:`${d.constructor.name} ${y}`},_=g=>{const y=g.getAttr("metadata");return y&&Object.keys(y).length>0},S=g=>{e.updateHoverHighlight(g)},C=()=>{e.updateHoverHighlight(void 0)};return(g,d)=>(wt(),At("div",Kf,[o.value==="simple"?(wt(),Jr(tc,{key:0,metadata:c.value,visible:!0,"can-edit":!!i.value,onApply:f},null,8,["metadata","can-edit"])):o.value==="hierarchical"?(wt(),At("div",Yf,[at("div",Xf,[r.value?(wt(),At("h3",Jf,"Group: "+Yt(m(n.value[0])),1)):s.value?(wt(),At("h3",Qf,Yt(n.value.length)+" items selected  single-item editing only ",1)):re("",!0),at("p",Zf,Yt(s.value?"Pick one below to edit its metadata:":"Select a node to edit its metadata:"),1)]),a.value.length>0?(wt(),At("div",t0,[(wt(!0),At($t,null,Uo(a.value,y=>(wt(),At("div",{key:y.indexPath,class:he(["tree-row",{active:y.node===l.value}]),style:Ie({paddingLeft:y.depth*50+"px"}),onClick:b=>p(y.node),onMouseenter:b=>S(y.node),onMouseleave:C},[at("span",n0,Yt(m(y.node)),1),_(y.node)?(wt(),At("span",i0,"")):re("",!0)],46,e0))),128))])):(wt(),At("div",r0,d[0]||(d[0]=[at("p",null,"No shapes or groups available",-1)]))),l.value?(wt(),Jr(tc,{key:2,metadata:h.value,visible:!0,"can-edit":!0,onApply:u},null,8,["metadata"])):s.value?(wt(),At("div",s0,d[1]||(d[1]=[at("p",null," Click a row above to edit its metadata",-1)]))):re("",!0)])):(wt(),At("div",o0,d[2]||(d[2]=[at("p",null,"Select something to edit its metadata",-1)])))]))}}),[["styles",[".smart-metadata-editor[data-v-cb312d1a]{margin-top:8px}.hierarchical-editor[data-v-cb312d1a]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:8px 16px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-cb312d1a]{margin-bottom:8px}.header h3[data-v-cb312d1a]{margin:0 0 4px;font-size:17px;color:#333}.multi-selection-header[data-v-cb312d1a]{color:#e67e22!important;font-weight:700}.help[data-v-cb312d1a]{margin:0;color:#666;font-size:14px}.tree-view[data-v-cb312d1a]{max-height:300px;overflow-y:auto;border:1px solid #eee;border-radius:4px;margin-bottom:8px}.tree-row[data-v-cb312d1a]{display:flex;align-items:center;justify-content:space-between;padding:4px 8px;cursor:pointer;user-select:none;border-bottom:1px solid #f5f5f5;transition:background-color .15s}.tree-row[data-v-cb312d1a]:last-child{border-bottom:none}.tree-row[data-v-cb312d1a]:hover{background-color:#f8f9fa}.tree-row.active[data-v-cb312d1a]{background-color:#fff2f2;border-left:3px solid #dc3545}.label[data-v-cb312d1a]{font-family:Monaco,Consolas,monospace;font-size:13px;color:#333}.metadata-indicator[data-v-cb312d1a]{color:#28a745;font-size:12px;font-weight:700}.empty-state[data-v-cb312d1a]{text-align:center;color:#666;padding:20px;font-style:italic}.empty-state p[data-v-cb312d1a]{margin:0}.selection-hint[data-v-cb312d1a]{text-align:center;color:#666;padding:15px;font-style:italic;border:2px dashed #ddd;border-radius:6px;margin-top:10px}.selection-hint p[data-v-cb312d1a]{margin:0}"]],["__scopeId","data-v-cb312d1a"]]),ec=t=>{const e=[],n=(i,s=0,r="")=>{e.push({node:i,depth:s,indexPath:r}),i instanceof tt.Group&&i.getChildren().forEach((o,a)=>n(o,s+1,r?`${r}/${a}`:`${a}`))};return t.forEach((i,s)=>n(i,0,`${s}`)),e},l0=t=>t?ec(t.getChildren()):[],ur=new Map,nc=t=>ur.set(t.key,t),ic=()=>Array.from(ur.values()),c0=t=>t.ancillary.nodeVisualizations,rc=t=>{const e=t.stage;if(e){if(!t.layers.ancillaryViz){const n=new tt.Layer({listening:!1,name:"ancillary-vis"});t.layers.ancillaryViz=n,e.add(n)}return t.layers.ancillaryViz}},h0=t=>{t.stage&&t.ancillary.rafToken===null&&(t.ancillary.rafToken=requestAnimationFrame(()=>{t.ancillary.rafToken=null,Ke(t)}))},d0=t=>{const e=t.stage;if(!e||t.ancillary.listenersAttached)return;const n=()=>h0(t);e.on("dragmove.av transform.av",n),e.on("destroy.av",n),e.on("dragend.av transformend.av",()=>Ke(t)),t.ancillary.listenersAttached=!0},u0=t=>{t.ancillary.activeWatchStop||(t.ancillary.activeWatchStop=It(()=>t.ancillary.activeVisualizations.value,()=>Ke(t),{deep:!0}))},sc=t=>{t.stage&&(rc(t),d0(t),u0(t),Ke(t))},Ke=t=>{const e=t.stage,n=rc(t);if(!e||!n)return;const s=l0(t.layers.freehandShape).filter(l=>l.depth===0).map(l=>l.node),r=new Map,o=t.ancillary.activeVisualizations.value;s.forEach(l=>{const c=l.getAttr("metadata")??{},h=l.getClientRect({relativeTo:e}),p={node:l,metadata:c,bbox:h};o.forEach(f=>{const u=ur.get(f);u&&u.validate(p)&&r.set(`${f}|${l.id()}`,{ctx:p,def:u})})});const a=c0(t);a.forEach((l,c)=>{r.has(c)||(ur.get(l.key)?.destroy?.(l.nodes),(Array.isArray(l.nodes)?l.nodes:[l.nodes]).forEach(f=>f.destroy()),a.delete(c))}),r.forEach((l,c)=>{const h=a.get(c);if(h)l.def.update?.(l.ctx,h.nodes);else{const p=l.def.create(l.ctx);(Array.isArray(p)?p:[p]).forEach(u=>n.add(u)),a.set(c,{key:l.def.key,nodes:p})}}),n.batchDraw()},f0=Object.freeze(Object.defineProperty({__proto__:null,getRegisteredAVs:ic,initAVLayer:sc,refreshAnciliaryViz:Ke,registerAV:nc},Symbol.toStringTag,{value:"Module"}));nc({key:"typo-guides",displayName:"Typography Guidelines",validate:({metadata:t})=>["lowLine","midLine","capHeight","ascender","descender","baseline"].some(e=>e in t&&typeof t[e]=="number"),create:t=>oc(t),update:(t,e)=>oc(t,e)});function oc({bbox:t,metadata:e},n){const i=[4,4],r=[{key:"baseline",fraction:e.baseline,color:"#333"},{key:"lowLine",fraction:e.lowLine,color:"#888"},{key:"midLine",fraction:e.midLine,color:"#f80"},{key:"capHeight",fraction:e.capHeight,color:"#0a0"},{key:"ascender",fraction:e.ascender,color:"#00f"},{key:"descender",fraction:e.descender,color:"#f00"}].filter(o=>o.fraction!==void 0&&typeof o.fraction=="number"&&o.fraction>=0&&o.fraction<=1).map(o=>{const a=t.y+t.height*o.fraction;return new tt.Line({points:[t.x,a,t.x+t.width,a],stroke:o.color,strokeWidth:1,dash:i,listening:!1,name:`typo-guide-${o.key}`})});return n?(n.forEach((o,a)=>{if(a<r.length){const l=r[a];o.points(l.points()),o.stroke(l.stroke())}}),n.length>r.length&&(n.slice(r.length).forEach(o=>o.destroy()),n.splice(r.length)),r.length>n.length&&n.push(...r.slice(n.length)),n):r}const g0={key:0,class:"av-toggle-pane"},p0={class:"toggles-grid"},m0=["checked","onChange"],y0=vi(rn({__name:"VisualizationToggles",props:{canvasState:{type:Object}},setup(t){const e=t,n=Dt(()=>ic()),i=Dt(()=>e.canvasState.ancillary.activeVisualizations.value),s=(o,a)=>{const l=new Set(i.value);a?l.add(o):l.delete(o),e.canvasState.ancillary.activeVisualizations.value=l},r=(o,a)=>{const l=a.target.checked;s(o,l)};return(o,a)=>n.value.length>0?(wt(),At("div",g0,[a[0]||(a[0]=at("h4",null,"Visualizations",-1)),at("div",p0,[(wt(!0),At($t,null,Uo(n.value,l=>(wt(),At("label",{key:l.key,class:"toggle-item"},[at("input",{type:"checkbox",checked:i.value.has(l.key),onChange:c=>r(l.key,c)},null,40,m0),at("span",null,Yt(l.displayName),1)]))),128))])])):re("",!0)}}),[["styles",[".av-toggle-pane[data-v-641f8251]{background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px;font-size:13px}.av-toggle-pane h4[data-v-641f8251]{margin:0 0 8px;font-size:14px;color:#333;font-weight:600}.toggles-grid[data-v-641f8251]{display:flex;flex-direction:column;gap:6px}.toggle-item[data-v-641f8251]{display:flex;align-items:center;gap:8px;cursor:pointer;transition:background-color .2s;padding:4px 6px;border-radius:4px}.toggle-item[data-v-641f8251]:hover{background-color:#f0f0f0}.toggle-item input[type=checkbox][data-v-641f8251]{margin:0;cursor:pointer}.toggle-item span[data-v-641f8251]{color:#555;font-size:13px;user-select:none}.toggle-item input[type=checkbox]:checked+span[data-v-641f8251]{color:#333;font-weight:500}"]],["__scopeId","data-v-641f8251"]]);function ac(t,e,n,i=s=>s){return t*i(.5-e*(.5-n))}function _0(t){return[-t[0],-t[1]]}function ue(t,e){return[t[0]+e[0],t[1]+e[1]]}function ae(t,e){return[t[0]-e[0],t[1]-e[1]]}function fe(t,e){return[t[0]*e,t[1]*e]}function v0(t,e){return[t[0]/e,t[1]/e]}function bi(t){return[t[1],-t[0]]}function lc(t,e){return t[0]*e[0]+t[1]*e[1]}function b0(t,e){return t[0]===e[0]&&t[1]===e[1]}function S0(t){return Math.hypot(t[0],t[1])}function x0(t){return t[0]*t[0]+t[1]*t[1]}function cc(t,e){return x0(ae(t,e))}function hc(t){return v0(t,S0(t))}function w0(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function Si(t,e,n){let i=Math.sin(n),s=Math.cos(n),r=t[0]-e[0],o=t[1]-e[1],a=r*s-o*i,l=r*i+o*s;return[a+e[0],l+e[1]]}function Ts(t,e,n){return ue(t,fe(ae(e,t),n))}function dc(t,e,n){return ue(t,fe(e,n))}var{min:hn,PI:C0}=Math,uc=.275,xi=C0+1e-4;function P0(t,e={}){let{size:n=16,smoothing:i=.5,thinning:s=.5,simulatePressure:r=!0,easing:o=v=>v,start:a={},end:l={},last:c=!1}=e,{cap:h=!0,easing:p=v=>v*(2-v)}=a,{cap:f=!0,easing:u=v=>--v*v*v+1}=l;if(t.length===0||n<=0)return[];let m=t[t.length-1].runningLength,_=a.taper===!1?0:a.taper===!0?Math.max(n,m):a.taper,S=l.taper===!1?0:l.taper===!0?Math.max(n,m):l.taper,C=Math.pow(n*i,2),g=[],d=[],y=t.slice(0,10).reduce((v,P)=>{let E=P.pressure;if(r){let A=hn(1,P.distance/n),O=hn(1,1-A);E=hn(1,v+(O-v)*(A*uc))}return(v+E)/2},t[0].pressure),b=ac(n,s,t[t.length-1].pressure,o),k,D=t[0].vector,x=t[0].point,w=x,T=x,M=w,L=!1;for(let v=0;v<t.length;v++){let{pressure:P}=t[v],{point:E,vector:A,distance:O,runningLength:j}=t[v];if(v<t.length-1&&m-j<3)continue;if(s){if(r){let it=hn(1,O/n),ct=hn(1,1-it);P=hn(1,y+(ct-y)*(it*uc))}b=ac(n,s,P,o)}else b=n/2;k===void 0&&(k=b);let H=j<_?p(j/_):1,X=m-j<S?u((m-j)/S):1;b=Math.max(.01,b*Math.min(H,X));let rt=(v<t.length-1?t[v+1]:t[v]).vector,$=v<t.length-1?lc(A,rt):1,F=lc(A,D)<0&&!L,z=$!==null&&$<0;if(F||z){let it=fe(bi(D),b);for(let ct=.07692307692307693,R=0;R<=1;R+=ct)T=Si(ae(E,it),E,xi*R),g.push(T),M=Si(ue(E,it),E,xi*-R),d.push(M);x=T,w=M,z&&(L=!0);continue}if(L=!1,v===t.length-1){let it=fe(bi(A),b);g.push(ae(E,it)),d.push(ue(E,it));continue}let et=fe(bi(Ts(rt,A,$)),b);T=ae(E,et),(v<=1||cc(x,T)>C)&&(g.push(T),x=T),M=ue(E,et),(v<=1||cc(w,M)>C)&&(d.push(M),w=M),y=P,D=A}let B=t[0].point.slice(0,2),V=t.length>1?t[t.length-1].point.slice(0,2):ue(t[0].point,[1,1]),U=[],K=[];if(t.length===1){if(!(_||S)||c){let v=dc(B,hc(bi(ae(B,V))),-(k||b)),P=[];for(let E=.07692307692307693,A=E;A<=1;A+=E)P.push(Si(v,B,xi*2*A));return P}}else{if(!(_||S&&t.length===1))if(h)for(let P=.07692307692307693,E=P;E<=1;E+=P){let A=Si(d[0],B,xi*E);U.push(A)}else{let P=ae(g[0],d[0]),E=fe(P,.5),A=fe(P,.51);U.push(ae(B,E),ae(B,A),ue(B,A),ue(B,E))}let v=bi(_0(t[t.length-1].vector));if(S||_&&t.length===1)K.push(V);else if(f){let P=dc(V,v,b);for(let E=.034482758620689655,A=E;A<1;A+=E)K.push(Si(P,V,xi*3*A))}else K.push(ue(V,fe(v,b)),ue(V,fe(v,b*.99)),ae(V,fe(v,b*.99)),ae(V,fe(v,b)))}return g.concat(K,d.reverse(),U)}function T0(t,e={}){var n;let{streamline:i=.5,size:s=16,last:r=!1}=e;if(t.length===0)return[];let o=.15+(1-i)*.85,a=Array.isArray(t[0])?t:t.map(({x:u,y:m,pressure:_=.5})=>[u,m,_]);if(a.length===2){let u=a[1];a=a.slice(0,-1);for(let m=1;m<5;m++)a.push(Ts(a[0],u,m/4))}a.length===1&&(a=[...a,[...ue(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,h=0,p=l[0],f=a.length-1;for(let u=1;u<a.length;u++){let m=r&&u===f?a[u].slice(0,2):Ts(p.point,a[u],o);if(b0(p.point,m))continue;let _=w0(m,p.point);if(h+=_,u<f&&!c){if(h<s)continue;c=!0}p={point:m,pressure:a[u][2]>=0?a[u][2]:.5,vector:hc(ae(p.point,m)),distance:_,runningLength:h},l.push(p)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function k0(t,e={}){return P0(T0(t,e),e)}var A0=k0;const ks=t=>t.metadata.highlight.layer,R0=t=>t.metadata.highlight.metadataRect,E0=t=>t.metadata.highlight.hoverRect,fc=(t,e)=>{const n=ks(t);if(n)return n;const i=new tt.Layer({listening:!1}),s=new tt.Rect({stroke:"red",strokeWidth:2,dash:[4,4],listening:!1,visible:!1}),r=new tt.Rect({stroke:"green",strokeWidth:2,dash:[4,4],listening:!1,visible:!1});return i.add(s),i.add(r),e.add(i),t.metadata.highlight.layer=i,t.metadata.highlight.metadataRect=s,t.metadata.highlight.hoverRect=r,t.layers.metadataHighlight=i,i},M0=(t,e)=>{const n=R0(t),i=ks(t);if(!n||!i)return;if(!e){n.visible(!1),i.batchDraw();return}const s=e.getClientRect({relativeTo:e.getStage()});n.setAttrs({x:s.x,y:s.y,width:s.width,height:s.height,visible:!0}),i.batchDraw()},F0=(t,e)=>{const n=E0(t),i=ks(t);if(!n||!i)return;if(!e){n.visible(!1),i.batchDraw();return}const s=e.getClientRect({relativeTo:e.getStage()});n.setAttrs({x:s.x,y:s.y,width:s.width,height:s.height,visible:!0}),i.batchDraw()},D0=t=>({setNodeMetadata:(e,n)=>{n===void 0||Object.keys(n).length===0?e.setAttr("metadata",void 0):e.setAttr("metadata",n)},collectHierarchyFromRoot:ec,updateMetadataHighlight:e=>M0(t,e),updateHoverHighlight:e=>F0(t,e)}),As=(t,e)=>{e instanceof tt.Path?Jl(t,e):e instanceof tt.Group&&(Cs(t,e),e.getChildren().forEach(n=>As(t,n)))},fr=(t,e)=>{(e instanceof tt.Path||e instanceof tt.Group)&&(e instanceof tt.Path,e.draggable(!0),e.off("click.freehand"),e.off("dragstart.freehand"),e.off("dragend.freehand"),e.on("dragstart.freehand",()=>{Es(t)}),e.on("dragend.freehand",()=>{Ms(t,e.constructor.name),t.layers.freehandShape?.batchDraw()}),e instanceof tt.Group&&e.getChildren().forEach(n=>{fr(t,n)}))},gc=(t,e,n=0,i=0)=>{const s=e.clone({x:e.x()+n,y:e.y()+i}),r=(o,a)=>{const l=_i();if(o.id(l),o instanceof tt.Path){const c=Array.from(qt(t).values()).find(h=>h.shape===a);if(c){const h={...c,id:l,shape:o};qt(t).set(l,h),console.log("Created stroke data for cloned Path:",l)}}else if(o instanceof tt.Group){const c=a,h=o;h.getChildren().forEach((f,u)=>{const m=c.getChildren()[u];r(f,m)});const p=h.find("Path").map(f=>f.id());p.length>0&&(ys(t).set(l,{id:l,strokeIds:p,group:h}),console.log("Created group data for cloned Group:",l,"with strokes:",p))}};return r(s,e),fr(t,s),As(t,s),console.log("Successfully cloned",e.className,"with new ID:",s.id()),s},pc=(t,e)=>{t.layers.freehandShape=new tt.Layer,t.layers.freehandDrawing=new tt.Layer,t.layers.freehandSelection=new tt.Layer,e.add(t.layers.freehandShape),e.add(t.layers.freehandDrawing),e.add(t.layers.freehandSelection)},mc=t=>{const e=[],n=new Set;return t.selection.selectedKonvaNodes.value.forEach(i=>{if(i instanceof tt.Group){const s=r=>{r.getChildren().forEach(o=>{o instanceof tt.Group?s(o):o instanceof tt.Path&&Array.from(qt(t).values()).forEach(a=>{a.shape===o&&!n.has(a.id)&&(e.push(a),n.add(a.id))})})};s(i)}else i instanceof tt.Path&&Array.from(qt(t).values()).forEach(s=>{s.shape===i&&!n.has(s.id)&&(e.push(s),n.add(s.id))})}),e},Rs=t=>{t.freehand.timelineDuration.value;let e=0;if(ws(t))t.freehand.selectedStrokesForTimeline.value=new Set,t.freehand.timelineDuration.value=0;else{const n=mc(t).filter(s=>s.isFreehand),i=new Set(n.map(s=>s.id));if(t.freehand.selectedStrokesForTimeline.value=i,n.length>0){const s=n.sort((o,a)=>o.creationTime-a.creationTime);let r=0;s.forEach((o,a)=>{const l=o.timestamps[o.timestamps.length-1]||0;r+=l,a<s.length-1&&(r+=100)}),e=r,t.freehand.timelineDuration.value=r}else t.freehand.timelineDuration.value=0}e>0&&t.freehand.currentPlaybackTime.value>e&&(t.freehand.currentPlaybackTime.value=0,Ns(t,0))},yc=t=>{t.freehand.strokes.clear(),t.freehand.strokeGroups.clear()},_c=(t,e,n)=>{const i={id:n.id,points:n.points,timestamps:n.timestamps,shape:n.shape,selected:n.selected,originalPath:n.originalPath,creationTime:n.creationTime,isFreehand:n.isFreehand};t.freehand.strokes.set(e,i)},vc=(t,e,n)=>{const i={id:n.id,strokeIds:n.strokeIds,group:n.group};t.freehand.strokeGroups.set(e,i)},gr=300,bc=t=>xs(t,()=>{const e=t.layers.freehandShape;if(!t.stage||!e)return null;try{const i=e.toObject(),s=Array.from(t.freehand.strokes.entries()),r=Array.from(t.freehand.strokeGroups.entries());return{layer:i,strokes:s,strokeGroups:r}}catch(i){return console.warn("Failed to get current state:",i),null}}),Me=t=>{const e=bc(t);return JSON.stringify(e)},Sc=(t,e,n={})=>{if(e)try{const i=t.freehand.currentPlaybackTime.value>0;t.freehand.currentPlaybackTime.value=0,t.freehand.isAnimating.value=!1,pr(t,e),i&&n.handleTimeUpdate?.(0)}catch(i){console.warn("Failed to restore state:",i)}},Es=t=>{t.freehand.freehandDragStartState=Me(t)},Ms=(t,e)=>{if(!t.freehand.freehandDragStartState)return;const n=Me(t);t.freehand.freehandDragStartState!==n&&(ar(t,`Transform ${e}`,t.freehand.freehandDragStartState,n),console.log("Transform command added to global history"),ge(t)),t.freehand.freehandDragStartState=null},Fs=t=>{const e=t.stage;e&&qt(t).forEach((n,i)=>{const s=e.findOne(`#${i}`);s&&s!==n.shape&&(console.log("Updating stroke connection for:",i),n.shape=s)})},xc=t=>{const e=t.layers.freehandShape;if(!(!t.stage||!e))try{const i=bc(t);if(!i)return;t.freehand.serializedState=JSON.stringify(i),t.callbacks.syncAppState?.(t),console.log("Serialized canvas state:",{layerChildren:i.layer?.children?.length||0,strokes:i.strokes.length,strokeGroups:i.strokeGroups.length})}catch(i){console.warn("Failed to serialize Konva state:",i)}},wc=t=>{const e=Me(t);if(!e){console.warn("No drawing data to download");return}const n=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=`freehand_drawing_${new Date().toISOString().slice(0,16).replace(/:/g,"-")}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)},Cc=t=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=n=>{const i=n.target.files?.[0];if(!i)return;const s=new FileReader;s.onload=r=>{try{const o=r.target?.result;JSON.parse(o),pr(t,o),console.log("Successfully loaded drawing from file:",i.name)}catch(o){console.error("Failed to parse uploaded file:",o),alert("Invalid JSON file. Please upload a valid freehand drawing file.")}},s.readAsText(i)},e.click()},pr=(t,e)=>{const n=t.layers.freehandShape,i=t.stage;if(!(!e||!i||!n))try{const s=JSON.parse(e);console.log("Deserializing canvas state:",{layerChildren:s.layer?.children?.length||0,strokes:s.strokes?.length||0,strokeGroups:s.strokeGroups?.length||0}),n.destroyChildren(),yc(t),oe(t);const r=s.layer;r&&r.children&&(console.log("Restoring",r.children.length,"children"),r.children.forEach((o,a)=>{console.log("Creating node",a,"of type",o.className);const l=tt.Node.create(JSON.stringify(o));n.add(l),console.log("Added node to layer:",l.id(),l.isVisible()),fr(t,l),As(t,l)})),s.strokes&&s.strokes.forEach(([o,a])=>{const l=i.findOne(`#${o}`);console.log("Restoring stroke:",o,"found shape:",!!l);const c={id:a.id,points:a.points,timestamps:a.timestamps,originalPath:a.originalPath,creationTime:a.creationTime,isFreehand:a.isFreehand,shape:l};_c(t,o,c)}),s.strokeGroups&&s.strokeGroups.forEach(([o,a])=>{const l={id:a.id,strokeIds:a.strokeIds,group:i.findOne(`#${o}`)};vc(t,o,l)}),Fs(t),Ds(t),n.batchDraw(),console.log("Konva canvas state restored from hotreload"),t.freehand.serializedState=e,setTimeout(()=>{n.batchDraw(),ge(t)},30)}catch(s){console.warn("Failed to deserialize Konva state:",s)}},Ds=t=>{const e=t.layers.freehandShape;qt(t).forEach(n=>{n.shape&&n.shape.draggable(!1)}),e&&e.getChildren().forEach(n=>{n instanceof tt.Group&&n.draggable(!1)})},wi=(t,e=!1)=>{if(t.length<4)return"";const n=[];for(let o=0;o<t.length;o+=2)n.push([t[o],t[o+1]]);const i=A0(n,{size:8,thinning:.5,smoothing:.5,streamline:.5,simulatePressure:!0});if(i.length===0)return"";let s=i;if(e){let o=1/0,a=1/0;i.forEach(([l,c])=>{o=Math.min(o,l),a=Math.min(a,c)}),s=i.map(([l,c])=>[l-o,c-a])}return`${s.reduce((o,[a,l],c,h)=>{const[p,f]=h[(c+1)%h.length];return`${o} ${a},${l} ${p},${f}`},`M ${s[0][0]},${s[0][1]} L`)} Z`},Pc=(t,e,n)=>{const i=t.layers.freehandShape,s=hr(e),r=[];for(let a=0;a<e.length;a+=2)r.push(e[a]-s.minX),r.push(e[a+1]-s.minY);const o=new tt.Path({data:wi(r),fill:"black",strokeWidth:0,id:n,x:s.minX,y:s.minY,draggable:!0});return o.on("dragstart",()=>{Es(t)}),o.on("dragend",()=>{Ms(t,"Stroke"),i?.batchDraw()}),Jl(t,o),o},Ns=(t,e)=>{const n=t.layers.freehandShape;t.freehand.currentPlaybackTime.value=e;let i=[];const s=!ws(t);if(s?i=mc(t).filter(c=>c.isFreehand):i=Array.from(qt(t).values()).filter(l=>l.isFreehand),i.sort((l,c)=>l.creationTime-c.creationTime),e===0){if(s){const l=new Set;i.forEach(c=>{if(c.shape&&c.originalPath){c.shape.show(),c.shape.data(c.originalPath);let h=c.shape.getParent();for(;h&&h!==n;)h instanceof tt.Group&&l.add(h),h=h.getParent()}}),l.forEach(c=>c.show())}else qt(t).forEach(l=>{l.shape&&l.originalPath&&l.isFreehand&&(l.shape.show(),l.shape.data(l.originalPath))}),n&&n.getChildren().forEach(l=>{l instanceof tt.Group&&l.show()});n?.batchDraw();return}s?i.forEach(l=>{l.shape&&l.shape.hide()}):(qt(t).forEach(l=>{l.shape&&l.isFreehand&&l.shape.hide()}),n&&n.getChildren().forEach(l=>{l instanceof tt.Group&&l.hide()}));let r=0;const o=[];if(s)i.forEach((l,c)=>{const h=l.timestamps[l.timestamps.length-1]||0;o.push({stroke:l,startTime:r,endTime:r+h}),r+=h+(c<i.length-1?100:0)});else{let l=0;i.forEach((c,h)=>{const p=c.timestamps[c.timestamps.length-1]||0;if(h===0)o.push({stroke:c,startTime:0,endTime:p}),l=c.creationTime+p,r=p;else{let f=Math.max(0,c.creationTime-l);!t.freehand.useRealTiming.value&&f>gr&&(f=gr);const u=r+f;o.push({stroke:c,startTime:u,endTime:u+p}),r=u+p,l=c.creationTime+p}})}const a=new Set;o.forEach(({stroke:l,startTime:c,endTime:h})=>{if(!(!l.shape||!l.timestamps)){if(e>=c&&e<=h){const p=e-c;let f=-1;for(let u=0;u<l.timestamps.length&&l.timestamps[u]<=p;u++)f=u;if(f>=0){const u=l.points.slice(0,(f+1)*2);if(u.length>=4){const m=hr(l.points),_=[];for(let C=0;C<u.length;C+=2)_.push(u[C]-m.minX),_.push(u[C+1]-m.minY);l.shape.show(),l.shape.data(wi(_));let S=l.shape.getParent();for(;S&&S!==n;)S instanceof tt.Group&&a.add(S),S=S.getParent()}}}else if(e>h){l.shape.show(),l.shape.data(l.originalPath);let p=l.shape.getParent();for(;p&&p!==n;)p instanceof tt.Group&&a.add(p),p=p.getParent()}}}),a.forEach(l=>l.show()),n?.batchDraw()},N0=t=>{const e=t.layers.freehandShape;if(!e)return{data:[],groupMap:{}};const n=(a,l)=>{const c=hr(a),h=[];for(let u=0;u<a.length;u+=2)h.push(a[u]-c.minX),h.push(a[u+1]-c.minY);const p=l.getAbsoluteTransform(),f=[];for(let u=0;u<h.length;u+=2){const m=p.point({x:h[u],y:h[u+1]});f.push({x:m.x,y:m.y})}return f};let i=0;const s={},r=a=>{if(a instanceof tt.Path){const l=Array.from(t.freehand.strokes.values()).find(f=>f.shape===a);if(!l)return null;const h=n(l.points,a).map((f,u)=>({x:f.x,y:f.y,ts:l.timestamps[Math.floor(u/2)]||0})),p=a.getAttr("metadata");return p&&p.name&&typeof p.name=="string"&&(s[p.name]||(s[p.name]=[]),s[p.name].push(i)),i++,{points:h,...p&&{metadata:p}}}else if(a instanceof tt.Group){const l=i,c=[];if(a.getChildren().forEach(p=>{const f=r(p);f&&c.push(f)}),c.length===0)return null;const h=a.getAttr("metadata");if(h&&h.name&&typeof h.name=="string"){const p=[];for(let f=l;f<i;f++)p.push(f);s[h.name]=p}return{children:c,...h&&{metadata:h}}}return null},o=[];return e.getChildren().forEach(a=>{const l=r(a);l&&("points"in l?o.push({children:[l]}):o.push(l))}),{data:o,groupMap:s}},ge=t=>{const e=N0(t);t.freehand.bakedRenderData=e.data,t.freehand.bakedGroupMap=e.groupMap,t.callbacks.syncAppState?.(t)},Tc=Object.freeze(Object.defineProperty({__proto__:null,attachHandlersRecursively:fr,clearStrokesInState:yc,createStrokeShape:Pc,deepCloneWithNewIds:gc,deserializeFreehandState:pr,downloadFreehandDrawing:wc,finishFreehandDragTracking:Ms,getCurrentFreehandStateString:Me,getStrokePath:wi,handleTimeUpdate:Ns,initFreehandLayers:pc,maxInterStrokeDelay:gr,refreshStrokeConnections:Fs,restoreFreehandState:Sc,serializeFreehandState:xc,setStrokeGroupInState:vc,setStrokeInState:_c,startFreehandDragTracking:Es,updateBakedFreehandData:ge,updateFreehandDraggableStates:Ds,updateTimelineState:Rs,uploadFreehandDrawing:Cc},Symbol.toStringTag,{value:"Module"})),O0=(t,e,n)=>{const i=e.x-t.x,s=e.y-t.y,r=n.x-t.x,o=n.y-t.y,a=i*r+s*o;if(a<=0)return Math.hypot(r,o);const l=i*i+s*s;if(l<=a)return Math.hypot(n.x-e.x,n.y-e.y);const c=a/l,h=t.x+c*i,p=t.y+c*s;return Math.hypot(n.x-h,n.y-p)};function kc(t,e){let n=-1,i=-1,s=1/0;for(let r=0;r<t.length;r++){const o=t[r];for(let a=0;a<o.points.length;a++){const l=o.points[a],c=o.points[(a+1)%o.points.length],h=O0(l,c,e);h<s&&(s=h,n=r,i=a)}}return{polygonIndex:n,lineIndex:i,distance:s}}const Ac=(t,e)=>{t.layers.polygonShapes=new tt.Layer,t.layers.polygonPreview=new tt.Layer,t.layers.polygonControls=new tt.Layer,t.layers.polygonSelection=new tt.Layer,e.add(t.layers.polygonShapes),e.add(t.layers.polygonPreview),e.add(t.layers.polygonControls),e.add(t.layers.polygonSelection)},Os=t=>{oe(t)},Rc=t=>{const e=t.layers.polygonShapes;if(!e)return[];const n=[],i=(s,r)=>{const o=[],a=r.getAbsoluteTransform();for(let l=0;l<s.length;l+=2){const c=a.point({x:s[l],y:s[l+1]});o.push({x:c.x,y:c.y})}return o};return e.getChildren().forEach(s=>{if(s instanceof tt.Line){const r=s.points(),o=i(r,s),a=s.getAttr("metadata");n.push({points:o,...a&&{metadata:a}})}}),n},Se=t=>{t.polygon.bakedRenderData=Rc(t),t.callbacks.syncAppState?.(t)},Ls=t=>xs(t,()=>{const e=t.layers.polygonShapes;if(!t.stage||!e)return null;try{const i=e.toObject(),s=Array.from(t.polygon.shapes.entries()),r=Array.from(t.polygon.groups.entries());return{layer:i,polygons:s,polygonGroups:r}}catch(i){return console.warn("Failed to get current polygon state:",i),null}}),dn=t=>{const e=Ls(t);return JSON.stringify(e)},Ec=(t,e)=>{if(e)try{Us(t,e)}catch(n){console.warn("Failed to restore polygon state:",n)}},Gs=t=>{const e=JSON.stringify({freehand:Me(t),polygon:dn(t)});t.polygon.dragStartState=e},Is=(t,e)=>{if(!t.polygon.dragStartState)return;const n=JSON.stringify({freehand:Me(t),polygon:dn(t)});t.polygon.dragStartState!==n&&(ar(t,`Transform ${e}`,t.polygon.dragStartState,n),Se(t)),t.polygon.dragStartState=null},Ge=t=>{const e=t.layers.polygonShapes;if(!(!t.stage||!e))try{const i=Ls(t);if(!i)return;t.polygon.serializedState=JSON.stringify(i),t.callbacks.syncAppState?.(t),console.log("Serialized polygon state:",{layerChildren:i.layer?.children?.length||0,polygons:i.polygons.length,polygonGroups:i.polygonGroups.length})}catch(i){console.warn("Failed to serialize polygon state:",i)}},mr=(t,e)=>{console.log("Attaching polygon handlers to:",e.id()),e.draggable(!1),e.on("dragstart",()=>Gs(t)),e.on("dragend",()=>{Is(t,"Polygon Drag"),Ge(t)})},Us=(t,e)=>{const n=t.layers.polygonShapes,i=t.layers.polygonControls,s=t.stage;if(!(!e||!s||!n))try{const r=JSON.parse(e);console.log("Deserializing polygon state:",{layerChildren:r.layer?.children?.length||0,polygons:r.polygons?.length||0,polygonGroups:r.polygonGroups?.length||0}),n.destroyChildren(),t.polygon.shapes.clear(),t.polygon.groups.clear(),oe(t);const o=r.layer;o&&o.children&&(console.log("Restoring",o.children.length,"polygon shapes"),o.children.forEach((a,l)=>{console.log("Creating polygon node",l,"of type",a.className);const c=tt.Node.create(JSON.stringify(a));n.add(c),console.log("Added polygon node to layer:",c.id(),c.isVisible()),c instanceof tt.Line?(mr(t,c),Ps(t,c)):c instanceof tt.Group&&Cs(t,c)})),r.polygons&&r.polygons.forEach(([a,l])=>{const c=s.findOne(`#${a}`);console.log("Restoring polygon:",a,"found shape:",!!c);const h={id:l.id,points:l.points,closed:l.closed,creationTime:l.creationTime,konvaShape:c,controlPoints:[]};t.polygon.shapes.set(a,h)}),r.polygonGroups&&r.polygonGroups.forEach(([a,l])=>{const c={id:l.id,polygonIds:l.polygonIds,group:s.findOne(`#${a}`)};t.polygon.groups.set(a,c)}),i?.destroyChildren(),t.activeTool.value==="polygon"&&t.polygon.mode.value==="edit"&&un(t),n.batchDraw(),t.polygon.serializedState=e,Se(t),console.log("Polygon state restored from hotreload")}catch(r){console.warn("Failed to deserialize polygon state:",r)}},Mc=(t,e)=>{const n=t.layers.polygonShapes;if(n){if(t.polygon.mode.value==="draw"){if(!t.polygon.isDrawing.value)t.polygon.isDrawing.value=!0,t.polygon.currentPoints.value=[e.x,e.y];else{const i=t.polygon.currentPoints.value[0],s=t.polygon.currentPoints.value[1];Math.sqrt((e.x-i)**2+(e.y-s)**2)<t.polygon.proximityThreshold&&t.polygon.currentPoints.value.length>=6?Bs(t):(t.polygon.currentPoints.value.push(e.x,e.y),yr(t))}yr(t)}else if(t.polygon.mode.value==="edit"){const i=Array.from(se(t).values()).map(s=>{const r=s.konvaShape,o=r?r.getAbsoluteTransform():null,a=[];for(let l=0;l<s.points.length;l+=2)if(o){const c=o.point({x:s.points[l],y:s.points[l+1]});a.push({x:c.x,y:c.y})}else a.push({x:s.points[l],y:s.points[l+1]});return{points:a}});if(i.length>0){const s=kc(i,e);if(s.polygonIndex>=0&&s.distance<t.polygon.proximityThreshold*2){const r=Array.from(se(t).keys())[s.polygonIndex],o=se(t).get(r);o&&o.konvaShape&&qe(t,"Add Polygon Point",()=>{const a=o.points,l=(s.lineIndex+1)*2,c=a[s.lineIndex*2],h=a[s.lineIndex*2+1],p=a[(s.lineIndex+1)*2%a.length],f=a[((s.lineIndex+1)*2+1)%a.length],u=(c+p)/2,m=(h+f)/2;o.points.splice(l,0,u,m),o.konvaShape.points(o.points),un(t),Ge(t),n?.batchDraw(),Se(t)})}}}}},Fc=t=>{!t.polygon.isDrawing.value||t.polygon.mode.value!=="draw"||yr(t)},Dc=t=>{const e=t.layers.polygonPreview,n=t.layers.polygonControls,i=t.stage;if(!e||!i||se(t).size===0)return;const s=i.getPointerPosition();if(!s)return;const r=i.getIntersection(s);if(r&&r.getParent()===n){e.destroyChildren(),e.batchDraw();return}const o=Array.from(se(t).values()).map(a=>{const l=a.konvaShape,c=l?l.getAbsoluteTransform():null,h=[];for(let p=0;p<a.points.length;p+=2)if(c){const f=c.point({x:a.points[p],y:a.points[p+1]});h.push({x:f.x,y:f.y})}else h.push({x:a.points[p],y:a.points[p+1]});return{points:h}});if(o.length>0){const a=kc(o,s);if(e.destroyChildren(),a.polygonIndex>=0&&a.distance<20){const l=Array.from(se(t).values())[a.polygonIndex],c=l.points,h=l.konvaShape,p=h?h.getAbsoluteTransform():null,f=c[a.lineIndex*2],u=c[a.lineIndex*2+1],m=c[(a.lineIndex+1)*2%c.length],_=c[((a.lineIndex+1)*2+1)%c.length],S=p?p.point({x:f,y:u}):{x:f,y:u},C=p?p.point({x:m,y:_}):{x:m,y:_},g=(S.x+C.x)/2,d=(S.y+C.y)/2,y=new tt.Line({points:[S.x,S.y,C.x,C.y],stroke:"#00ff00",strokeWidth:4,opacity:.8});e.add(y);const b=new tt.Circle({x:g,y:d,radius:5,fill:"#00ff00",stroke:"#00aa00",strokeWidth:2,opacity:.9});e.add(b)}e.batchDraw()}},yr=t=>{const e=t.layers.polygonPreview,n=t.stage;if(!e||!n)return;if(e.destroyChildren(),t.polygon.currentPoints.value.length<4){if(t.polygon.currentPoints.value.length===2){const o=new tt.Circle({x:t.polygon.currentPoints.value[0],y:t.polygon.currentPoints.value[1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});e.add(o)}e.batchDraw();return}const i=n.getPointerPosition();if(!i)return;for(let o=0;o<t.polygon.currentPoints.value.length;o+=2){const a=new tt.Circle({x:t.polygon.currentPoints.value[o],y:t.polygon.currentPoints.value[o+1],radius:4,fill:"#0066ff",stroke:"#004499",strokeWidth:1,listening:!1});e.add(a)}const s=[...t.polygon.currentPoints.value,i.x,i.y],r=new tt.Line({points:s,stroke:"#999",strokeWidth:2,fill:"rgba(153, 153, 153, 0.1)",closed:!1,dash:[5,5],listening:!1});if(e.add(r),t.polygon.currentPoints.value.length>=6){const o=t.polygon.currentPoints.value[0],a=t.polygon.currentPoints.value[1],l=Math.sqrt((i.x-o)**2+(i.y-a)**2),c=new tt.Circle({x:o,y:a,radius:t.polygon.proximityThreshold,stroke:l<t.polygon.proximityThreshold?"#00ff00":"#ff0000",strokeWidth:2,fill:"transparent",listening:!1});e.add(c)}e.batchDraw()},Bs=t=>{const e=t.layers.polygonShapes,n=t.layers.polygonPreview;t.polygon.currentPoints.value.length<6||qe(t,"Create Polygon",()=>{const i=`polygon-${Date.now()}`,s={id:i,points:[...t.polygon.currentPoints.value],closed:!0,creationTime:Date.now()},r=new tt.Line({points:s.points,stroke:"#000",strokeWidth:2,fill:"rgba(0, 100, 255, 0.1)",closed:!0,draggable:!1,id:i});mr(t,r),s.konvaShape=r,se(t).set(i,s),e?.add(r),Ps(t,r),t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],n?.destroyChildren(),un(t),Ge(t),e?.batchDraw(),n?.batchDraw(),Se(t)})},Nc=t=>{const e=t.layers.polygonPreview;t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],e?.destroyChildren(),e?.batchDraw()},un=t=>{const e=t.layers.polygonControls,n=t.layers.polygonShapes;e&&(e.destroyChildren(),t.polygon.mode.value==="edit"&&se(t).forEach(i=>{i.controlPoints=[];for(let s=0;s<i.points.length;s+=2){const r=s,o=i.points[r],a=i.points[r+1];let l=o,c=a;if(i.konvaShape){const f=i.konvaShape.getAbsoluteTransform().point({x:o,y:a});l=f.x,c=f.y}const h=new tt.Circle({x:l,y:c,radius:6,fill:"#ff6600",stroke:"#ff4400",strokeWidth:2,draggable:!0,id:`${i.id}-control-${r/2}`});h.on("mouseenter",()=>{h.fill("#ffaa00"),h.radius(8),e?.batchDraw()}),h.on("mouseleave",()=>{h.fill("#ff6600"),h.radius(6),e?.batchDraw()}),h.on("dragstart",()=>{Gs(t)}),h.on("dragmove",()=>{const p={x:h.x(),y:h.y()};if(i.konvaShape){const f=i.konvaShape.getAbsoluteTransform().copy();f.invert();const u=f.point(p);i.points[r]=u.x,i.points[r+1]=u.y}else i.points[r]=p.x,i.points[r+1]=p.y;i.konvaShape&&(i.konvaShape.points(i.points),n?.batchDraw())}),h.on("dragend",()=>{Is(t,"Polygon Control Point"),Ge(t)}),i.controlPoints.push(h),e.add(h)}}),e.batchDraw())},Oc=t=>It(()=>t.polygon.mode.value,e=>{const n=t.layers.polygonControls,i=t.layers.polygonPreview;if(t.activeTool.value!=="polygon"){n?.destroyChildren(),n?.batchDraw();return}Os(t),e==="draw"?(t.polygon.isDrawing.value=!1,t.polygon.currentPoints.value=[],i?.destroyChildren(),i?.batchDraw(),se(t).forEach(s=>{s.konvaShape?.draggable(!1)})):e==="edit"&&(i?.destroyChildren(),i?.batchDraw(),se(t).forEach(s=>{s.konvaShape?.draggable(!1)})),un(t),Os(t)}),Lc=Object.freeze(Object.defineProperty({__proto__:null,attachPolygonHandlers:mr,clearCurrentPolygon:Nc,clearPolygonSelection:Os,deserializePolygonState:Us,finishPolygon:Bs,finishPolygonDragTracking:Is,generateBakedPolygonData:Rc,getCurrentPolygonState:Ls,getCurrentPolygonStateString:dn,handlePolygonClick:Mc,handlePolygonEditMouseMove:Dc,handlePolygonMouseMove:Fc,initPolygonLayers:Ac,restorePolygonState:Ec,serializePolygonState:Ge,setupPolygonModeWatcher:Oc,startPolygonDragTracking:Gs,updateBakedPolygonData:Se,updatePolygonControlPoints:un,updatePolygonPreview:yr},Symbol.toStringTag,{value:"Module"})),L0=(t,e)=>{t.layers.transformerLayer=e;const n=new tt.Transformer({rotateEnabled:!0,keepRatio:!1,padding:6});return t.layers.transformer=n,n.on("transformstart",()=>{U0(t)}),n.on("transformend",()=>{B0(t,"Transform")}),e.add(n),It(t.selection.selectedKonvaNodes,i=>{I0(t,i)},{immediate:!0}),n};function G0(t,e){L0(t,e)}function I0(t,e){const n=t.layers.transformer,i=t.layers.transformerLayer;if(!n||!i)return;const s=e.filter(r=>!(r instanceof tt.Line&&t.polygon.mode.value==="edit"&&t.activeTool.value==="polygon"));n.nodes(s),i.batchDraw()}function U0(t){Promise.resolve().then(()=>Tc).then(({getCurrentFreehandStateString:e})=>{Promise.resolve().then(()=>Lc).then(({getCurrentPolygonStateString:n})=>{const i=JSON.stringify({freehand:e(t),polygon:n(t)});t.selection.transformStartState=i})})}function B0(t,e){const n=t.selection.transformStartState;n&&Promise.resolve().then(()=>Tc).then(({getCurrentFreehandStateString:i})=>{Promise.resolve().then(()=>Lc).then(({getCurrentPolygonStateString:s})=>{const r=JSON.stringify({freehand:i(t),polygon:s(t)});n!==r&&ar(t,e,n,r),t.selection.transformStartState=""})})}function H0(t,e){t.layers.selectionOverlay=e,t.selection.selectionRect=new tt.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),e.add(t.selection.selectionRect)}function V0(t,e,n){const i=e.getPointerPosition();if(!i)return;const s=r=>{let o=r;for(;o&&!(o instanceof tt.Stage);){if(o instanceof tt.Transformer)return!0;o=o.getParent()}return!1};if(!(n.target&&s(n.target))){if(n.target!==e){let r=n.target,o=r.getParent();for(;o&&!(o instanceof tt.Layer);)r=o,o=r.getParent();const a=dr(t,r);if(a){const l=Xl(t,a);n.evt.shiftKey?wf(t,a,!0):l||(oe(t),cr(t,a,!0)),Xl(t,a)&&K0(t,e);return}}(n.target===e||n.target instanceof tt.Layer)&&(t.selection.dragSelectionState.value={isSelecting:!0,startPos:{x:i.x,y:i.y},currentPos:{x:i.x,y:i.y},isShiftHeld:n.evt.shiftKey},$0(t,i.x,i.y))}}function z0(t,e,n){if(t.selection.selectionDragState.isDragging){Y0(t,e);return}if(!t.selection.dragSelectionState.value.isSelecting)return;const i=e.getPointerPosition();i&&(t.selection.dragSelectionState.value.currentPos={x:i.x,y:i.y},j0(t))}function W0(t,e,n){if(t.selection.selectionDragState.isDragging){X0(t);return}t.selection.dragSelectionState.value.isSelecting&&(q0(t,t.selection.dragSelectionState.value.isShiftHeld),t.selection.dragSelectionState.value.isSelecting=!1)}function $0(t,e,n){t.selection.selectionRect&&t.selection.selectionRect.setAttrs({x:e,y:n,width:0,height:0,visible:!1})}function j0(t){if(!t.selection.selectionRect||!t.selection.dragSelectionState.value.isSelecting)return;const{startPos:e,currentPos:n}=t.selection.dragSelectionState.value,i=Math.min(e.x,n.x),s=Math.min(e.y,n.y),r=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y);t.selection.selectionRect.setAttrs({x:i,y:s,width:r,height:o,visible:r>5||o>5}),t.layers.selectionOverlay?.batchDraw()}function q0(t,e=!1){if(!t.selection.selectionRect)return;const{startPos:n,currentPos:i}=t.selection.dragSelectionState.value,s=Math.abs(i.x-n.x),r=Math.abs(i.y-n.y);if(!(s>=5||r>=5)){e||oe(t),t.selection.selectionRect.visible(!1),t.layers.selectionOverlay?.batchDraw();return}const a=[],l=t.selection.selectionRect.getClientRect(),c=f=>f instanceof tt.Transformer?!1:f instanceof tt.Path||f instanceof tt.Line||f instanceof tt.Group,h=[],p=t.layers.selectionOverlay?.getStage();if(p){const f=t.layers.freehandShape;f&&h.push(f);const u=t.layers.polygonShapes;u&&h.push(u),h.length===0&&p.getLayers().forEach(m=>{m.getChildren().some(S=>c(S))&&h.push(m)})}h.forEach(f=>{f.getChildren().forEach(u=>{if(!c(u))return;const m=u.getClientRect();if(!(l.x+l.width<m.x||m.x+m.width<l.x||l.y+l.height<m.y||m.y+m.height<l.y)){const _=dr(t,u);_&&a.push(_)}})}),e||(oe(t),Rs(t)),a.forEach(f=>cr(t,f,!0)),t.selection.selectionRect.setAttrs({x:0,y:0,width:0,height:0,visible:!1}),t.layers.selectionOverlay?.batchDraw()}function K0(t,e){const n=e.getPointerPosition();if(!n)return;t.selection.selectionDragState.isDragging=!0,t.selection.selectionDragState.startPos={x:n.x,y:n.y},t.selection.selectionDragState.startNodePositions.clear(),t.selection.selectionDragState.beforeState=JSON.stringify({freehand:Me(t),polygon:dn(t)}),t.selection.selectedKonvaNodes.value.forEach(s=>{const r=s.getAbsolutePosition();t.selection.selectionDragState.startNodePositions.set(s,{x:r.x,y:r.y})})}function Y0(t,e){const n=e.getPointerPosition();if(!n)return;const i=n.x-t.selection.selectionDragState.startPos.x,s=n.y-t.selection.selectionDragState.startPos.y;t.selection.selectionDragState.startNodePositions.forEach((o,a)=>{a.absolutePosition({x:o.x+i,y:o.y+s})});const r=new Set;t.selection.selectionDragState.startNodePositions.forEach((o,a)=>{let l=a.getParent();for(;l&&!(l instanceof tt.Layer);)l=l.getParent();l instanceof tt.Layer&&r.add(l)}),r.forEach(o=>o.batchDraw())}function X0(t){const e=JSON.stringify({freehand:Me(t),polygon:dn(t)});t.selection.selectionDragState.beforeState!==e&&ar(t,"Move Selection",t.selection.selectionDragState.beforeState,e),t.selection.selectionDragState.isDragging=!1,t.selection.selectionDragState.startNodePositions.clear()}function Gc(t){return t.selection.selectedKonvaNodes.value}function Ic(t){let e=t;for(;e&&!(e instanceof tt.Layer);)e=e.getParent();return e instanceof tt.Layer?e:null}function Uc(t,e){const n=t.getAbsoluteTransform().copy();t.moveTo(e);const i=e.getAbsoluteTransform().copy();i.invert();const r=i.multiply(n).decompose();t.setAttrs({x:r.x,y:r.y,scaleX:r.scaleX,scaleY:r.scaleY,rotation:r.rotation,skewX:r.skewX,skewY:r.skewY})}function Bc(t){const e=Gc(t);if(e.length<1||e.some(s=>s instanceof tt.Line)||new Set(e.map(s=>Ic(s))).size!==1)return!1;const i=e.filter(s=>s instanceof tt.Path||s instanceof tt.Group);return!(i.length<1||Tf(i))}function J0(t){if(!Bc(t))return;const e=t.selection.selectedKonvaNodes.value.filter(n=>n instanceof tt.Path||n instanceof tt.Group);e.length<1||qe(t,"Group Selection",()=>{const n=e.filter(a=>!e.some(l=>l!==a&&l.isAncestorOf(a))),i=Ic(n[0]);if(!i)return;let s=n[0].getParent();n.every(a=>a.getParent()===s)||(s=i);const r=new tt.Group({draggable:!1});s.add(r),n.forEach(a=>{Uc(a,r)});const o=Cs(t,r);oe(t),cr(t,o),r.getLayer()?.batchDraw(),ge(t)})}function Hc(t){const e=Gc(t);return e.length!==1||e[0]instanceof tt.Line?!1:e[0]instanceof tt.Group}function Q0(t){if(!Hc(t))return;const e=t.selection.selectedKonvaNodes.value[0],n=e.getParent();n&&qe(t,"Ungroup Selection",()=>{[...e.getChildren()].forEach(r=>{Uc(r,n),r.draggable(!1)});const s=e.id();e.destroy(),Ql(t,s),oe(t),n.getLayer()?.batchDraw();try{Fs(t)}catch{console.error("refreshStrokeConnections failed")}ge(t)})}function Vc(t){const e=t.selection.selectedKonvaNodes.value;return e.filter(n=>!e.some(i=>i!==n&&i.isAncestorOf(n)))}function Z0(t){const e=t.layers.freehandShape;t.selection.selectedKonvaNodes.value.length!==0&&qe(t,"Duplicate",()=>{xs(t,()=>{const i=Vc(t),s=[];i.forEach(r=>{if(r instanceof tt.Path||r instanceof tt.Group){const o=gc(t,r,50,50),a=r.getParent();a&&a.add(o),s.push(o)}else if(r instanceof tt.Line){const o=r.clone({x:r.x()+50,y:r.y()+50}),a=_i("poly_");o.id(a);const l=r.getParent();l&&l.add(o),Ps(t,o),mr(t,o),se(t).set(a,{id:a,points:[...o.points()],closed:!!o.closed(),creationTime:Date.now(),konvaShape:o}),s.push(o)}}),oe(t),s.forEach(r=>{const o=dr(t,r);o&&cr(t,o,!0)}),e?.batchDraw(),t.layers.polygonShapes?.batchDraw(),ge(t),Se(t),Ge(t)})})}function tg(t){const e=t.layers.freehandShape;t.selection.selectedKonvaNodes.value.length!==0&&qe(t,"Delete Selected",()=>{Vc(t).forEach(s=>{const r=[],o=a=>{r.push(a),a instanceof tt.Container&&a.getChildren().forEach(l=>o(l))};o(s),r.forEach(a=>{a instanceof tt.Path&&(qt(t).delete(a.id()),Array.from(qt(t).entries()).forEach(([l,c])=>{c.shape===a&&qt(t).delete(l)}),Array.from(ys(t).values()).forEach(l=>{l.strokeIds=l.strokeIds.filter(c=>c!==a.id())})),a instanceof tt.Group&&ys(t).delete(a.id()),a instanceof tt.Line&&se(t).delete(a.id()),Ql(t,a.id())}),s.destroy()}),oe(t),e?.batchDraw(),t.layers.polygonShapes?.batchDraw(),ge(t),Se(t),Ge(t),Promise.resolve().then(()=>f0).then(({refreshAnciliaryViz:s})=>s(t)).catch(()=>{})})}const eg={class:"canvas-root"},ng={class:"control-panel"},ig=["disabled"],rg={class:"button-group vertical"},sg=["disabled"],og=["disabled"],ag={class:"button-group vertical"},lg=["disabled"],cg=["disabled"],hg={class:"button-group vertical"},dg=["disabled"],ug=["disabled"],fg=["disabled"],gg={class:"button-group vertical"},pg=["disabled"],mg=["disabled"],yg=["disabled"],_g={class:"button-group vertical"},vg=["disabled"],bg=["disabled"],Sg=["disabled"],xg=["disabled"],wg=["disabled"],Cg=["disabled"],Pg=["disabled"],Tg=["disabled"],kg={key:0,class:"info"},Ag={class:"info"},Rg={class:"canvas-wrapper"},Eg={key:0,class:"metadata-suite"},Mg={key:1,class:"animation-lock-warning"},Fg=vi(rn({__name:"CanvasRoot",props:{syncState:{type:Function},initialFreehandState:{default:"",type:String},initialPolygonState:{default:"",type:String},width:{default:1e3,type:[Number,String]},height:{default:500,type:[Number,String]}},emits:["state-update"],setup(t,{emit:e}){const n=t,i=e,s=Dt(()=>{const G=Number(n.width),I=Number(n.height);return{width:Number.isFinite(G)?G:1e3,height:Number.isFinite(I)?I:500}}),r=pf(),o=D0(r);let a;const l=r.activeTool,c=r.metadata.showEditor,h=G=>{n.syncState&&n.syncState(G),i("state-update",G)};r.callbacks.syncAppState=h,It(()=>n.syncState,()=>{h(r)},{immediate:!0});const p=G=>H0(r,G),f=(G,I)=>V0(r,G,I),u=(G,I)=>z0(r,G),m=(G,I)=>W0(r),_=()=>J0(r),S=()=>Q0(r),C=()=>Z0(r),g=()=>tg(r),d=Dt(()=>Bc(r)),y=Dt(()=>Hc(r)),b=(G,I)=>Pc(r,G,I),k=()=>Ds(r),D=()=>Rs(r),x=G=>Ns(r,G),w=()=>wc(r),T=()=>Cc(r),M=()=>un(r),L=G=>Mc(r,G),B=()=>Fc(r),V=()=>Dc(r),U=()=>Bs(r),K=()=>Nc(r),v=()=>Oc(r),P=r.selection.selectedKonvaNodes,E=Dt(()=>Cf(r)),A=Dt(()=>cn(r)>1),O=Dt(()=>{const G=P.value;return G.length===1&&G[0]instanceof tt.Group});r.callbacks.refreshAncillaryViz=()=>Ke(r);const j=()=>{const G=Me(r),I=dn(r);return JSON.stringify({freehand:G,polygon:I})},H=G=>{if(G)try{const I=JSON.parse(G);I.freehand&&Sc(r,I.freehand,{handleTimeUpdate:x}),I.polygon&&Ec(r,I.polygon)}catch(I){console.warn("Failed to restore canvas state:",I)}},X=Tt(!1),rt=Tt(!1),$=()=>{ge(r),Se(r),Ke(r),X.value=F.canUndo(),rt.value=F.canRedo()},F=new gf(j,H,$);r.command.stack=F,X.value=F.canUndo(),rt.value=F.canRedo();const z=(G,I)=>F.executeCommand(G,I),et=()=>F.undo(),it=()=>F.redo();r.command.executeCommand=z,r.command.pushCommand=(G,I,q)=>{F.pushCommand(G,I,q)};const ct=G=>{r.freehand.isAnimating.value=G;const I=r.stage;I&&(G?I.listening(!1):I.listening(!0))},R=Tt(),N=(G,I)=>{const q=G.layers.freehandShape,J=G.layers.freehandDrawing,nt=G.layers.transformerLayer??G.layers.freehandSelection,Z=G.stage;oe(G),I==="select"?(q?.listening(!0),G.layers.polygonShapes?.listening(!0),J?.listening(!1),G.layers.polygonPreview?.listening(!1),G.layers.polygonControls?.listening(!1),nt?.listening(!0),G.layers.polygonSelection?.listening(!0),nt?.moveToTop(),Z&&fc(r,Z).moveToTop()):I==="freehand"?(q?.listening(!0),J?.listening(!0),nt?.listening(!0),G.layers.polygonShapes?.listening(!1),G.layers.polygonPreview?.listening(!1),G.layers.polygonControls?.listening(!1),G.layers.polygonSelection?.listening(!1)):I==="polygon"&&(G.layers.polygonShapes?.listening(!0),G.layers.polygonPreview?.listening(!0),G.layers.polygonControls?.listening(!0),G.layers.polygonSelection?.listening(!0),q?.listening(!1),J?.listening(!1),nt?.listening(!1)),I==="polygon"&&G.polygon.mode.value==="edit"?M():(G.layers.polygonControls?.destroyChildren(),G.layers.polygonControls?.batchDraw()),(st=>{q?.getChildren().forEach(Y=>{(Y instanceof tt.Path||Y instanceof tt.Group)&&Y.draggable(st)}),G.layers.polygonShapes?.getChildren().forEach(Y=>{(Y instanceof tt.Line||Y instanceof tt.Group)&&Y.draggable(st)})})(!1),Z?.batchDraw()};It(l,G=>{N(r,G)},{immediate:!0});const W=(G,I)=>{try{const q=dr(r,G);q?Pf(r,q,I):(G.setAttr("metadata",I===void 0||Object.keys(I).length===0?void 0:I),ge(r),Se(r))}catch{G.setAttr("metadata",I===void 0||Object.keys(I).length===0?void 0:I),ge(r),Se(r)}};return Io(async()=>{try{if(!R.value){console.error("Konva container ref not found");return}const G=s.value,I=new tt.Stage({container:R.value,width:G.width,height:G.height});r.stage=I,r.konvaContainer=R.value;const q=()=>{R.value&&(R.value.style.cursor=l.value==="freehand"?"crosshair":"default")};r.callbacks.updateCursor=q,r.callbacks.updateCursor?.(),pc(r,I),Ac(r,I);const J=r.layers.freehandSelection;if(!J){console.error("Freehand selection layer not initialized");return}G0(r,J);const nt=r.layers.transformerLayer??J;p(nt);const Z=fc(r,I);r.layers.transformerLayer?.moveToTop(),Z.moveToTop(),sc(r),N(r,l.value),l.value==="polygon"&&r.polygon.mode.value==="edit"&&M(),r.callbacks.updateCursor?.();const Q=Y=>{!Y||Y===r.freehand.serializedState||pr(r,Y)},st=Y=>{!Y||Y===r.polygon.serializedState||Us(r,Y)};Q(n.initialFreehandState),st(n.initialPolygonState),It(()=>n.initialFreehandState,Y=>{Q(Y)}),It(()=>n.initialPolygonState,Y=>{st(Y)}),It(()=>[n.width,n.height],([Y,ot])=>{const ht=Number(Y),dt=Number(ot),pt=Number.isFinite(ht)?ht:s.value.width,ft=Number.isFinite(dt)?dt:s.value.height,vt=r.stage;vt&&(vt.width(pt),vt.height(ft),vt.batchDraw()),r.konvaContainer&&(r.konvaContainer.style.width=`${pt}px`,r.konvaContainer.style.height=`${ft}px`)},{immediate:!0}),N(r,l.value),I.on("mousedown touchstart",Y=>{const ot=I.getPointerPosition();ot&&(l.value==="select"?f(I,Y):l.value==="freehand"?(r.freehand.isDrawing=!0,r.freehand.currentPoints=[ot.x,ot.y],r.freehand.drawingStartTime=performance.now(),r.freehand.currentTimestamps=[0],oe(r)):l.value==="polygon"&&(Y.target.getParent?.()===r.layers.polygonControls||L(ot)))}),I.on("mousemove touchmove",Y=>{const ot=r.layers.freehandDrawing;if(l.value==="select")u(I,Y);else if(l.value==="freehand"){if(r.freehand.isDrawing){const ht=I.getPointerPosition();if(!ht)return;r.freehand.currentPoints.push(ht.x,ht.y),r.freehand.currentTimestamps.push(performance.now()-r.freehand.drawingStartTime),ot?.destroyChildren();const dt=new tt.Path({data:wi(r.freehand.currentPoints),fill:"#666",strokeWidth:0});ot?.add(dt),ot?.batchDraw()}}else l.value==="polygon"&&(r.polygon.mode.value==="draw"&&r.polygon.isDrawing.value?B():r.polygon.mode.value==="edit"&&V())}),I.on("mouseup touchend",Y=>{const ot=r.layers.freehandDrawing;l.value==="freehand"&&r.freehand.isDrawing?(r.freehand.isDrawing=!1,ot?.destroyChildren(),r.freehand.currentPoints.length>2&&z("Draw Stroke",()=>{const ht=r.layers.freehandShape,dt=Date.now(),pt=`stroke-${dt}`,ft=hr(r.freehand.currentPoints),vt=[];for(let te=0;te<r.freehand.currentPoints.length;te+=2)vt.push(r.freehand.currentPoints[te]-ft.minX),vt.push(r.freehand.currentPoints[te+1]-ft.minY);const xt=wi(vt),Ct={id:pt,points:r.freehand.currentPoints,timestamps:r.freehand.currentTimestamps,originalPath:xt,creationTime:dt,isFreehand:!0},Nt=b(r.freehand.currentPoints,pt);Ct.shape=Nt,qt(r).set(pt,Ct),ht?.add(Nt),k(),D(),ht?.batchDraw(),ge(r)}),r.freehand.currentPoints=[],r.freehand.currentTimestamps=[]):m(I,Y)}),v(),a=Rf(r,"Escape",Y=>{l.value==="polygon"&&r.polygon.isDrawing.value&&(r.polygon.currentPoints.value.length>=6?U():K())})}catch(G){console.warn(G)}}),Cn(()=>{console.log("disposing livecoded resources"),xc(r),Ge(r),a?.(),a=void 0,r.keyboardDisposables.splice(0).forEach(G=>G()),r.stage?.destroy()}),(G,I)=>(wt(),At("div",eg,[at("div",ng,[No(at("select",{"onUpdate:modelValue":I[0]||(I[0]=q=>Lt(l)?l.value=q:null),disabled:lt(r).freehand.isAnimating.value,class:"tool-dropdown"},I[8]||(I[8]=[at("option",{value:"select"}," Select",-1),at("option",{value:"freehand"}," Freehand",-1),at("option",{value:"polygon"}," Polygon",-1)]),8,ig),[[yu,lt(l)]]),I[16]||(I[16]=at("span",{class:"separator"},"|",-1)),at("div",rg,[at("button",{onClick:et,disabled:!X.value||lt(r).freehand.isAnimating.value,title:"Undo (Ctrl/Cmd+Z)"},"  Undo ",8,sg),at("button",{onClick:it,disabled:!rt.value||lt(r).freehand.isAnimating.value,title:"Redo (Ctrl/Cmd+Shift+Z)"},"  Redo ",8,og)]),I[17]||(I[17]=at("span",{class:"separator"},"|",-1)),lt(l)==="select"?(wt(),At($t,{key:0},[at("div",ag,[at("button",{onClick:_,disabled:!d.value||lt(r).freehand.isAnimating.value}," Group ",8,lg),at("button",{onClick:S,disabled:!y.value||lt(r).freehand.isAnimating.value}," Ungroup ",8,cg)]),I[9]||(I[9]=at("span",{class:"separator"},"|",-1)),at("div",hg,[at("button",{onClick:C,disabled:cn(lt(r))===0||lt(r).freehand.isAnimating.value},"  Duplicate ",8,dg),at("button",{onClick:g,disabled:cn(lt(r))===0||lt(r).freehand.isAnimating.value},"  Delete ",8,ug)]),I[10]||(I[10]=at("span",{class:"separator"},"|",-1))],64)):re("",!0),lt(l)==="freehand"?(wt(),At($t,{key:1},[at("button",{onClick:I[1]||(I[1]=q=>lt(r).freehand.showGrid.value=!lt(r).freehand.showGrid.value),class:he({active:lt(r).freehand.showGrid.value}),disabled:lt(r).freehand.isAnimating.value},Yt(lt(r).freehand.showGrid.value?" Grid On":" Grid Off"),11,fg),at("div",gg,[at("button",{onClick:C,disabled:cn(lt(r))===0||lt(r).freehand.isAnimating.value},"  Duplicate ",8,pg),at("button",{onClick:g,disabled:cn(lt(r))===0||lt(r).freehand.isAnimating.value},"  Delete ",8,mg)]),I[11]||(I[11]=at("span",{class:"separator"},"|",-1)),at("button",{onClick:I[2]||(I[2]=q=>lt(r).freehand.useRealTiming.value=!lt(r).freehand.useRealTiming.value),class:he({active:lt(r).freehand.useRealTiming.value})},Yt(lt(r).freehand.useRealTiming.value?" Real Time":" Max 0.3s"),3),I[12]||(I[12]=at("span",{class:"separator"},"|",-1)),at("button",{onClick:I[3]||(I[3]=q=>c.value=!lt(c)),class:he({active:lt(c)}),disabled:lt(r).freehand.isAnimating.value},"  Metadata ",10,yg),I[13]||(I[13]=at("span",{class:"separator"},"|",-1)),at("div",_g,[at("button",{onClick:w,disabled:lt(r).freehand.isAnimating.value},"  Download ",8,vg),at("button",{onClick:T,disabled:lt(r).freehand.isAnimating.value},"  Upload ",8,bg)])],64)):re("",!0),lt(l)==="polygon"?(wt(),At($t,{key:2},[at("button",{onClick:I[4]||(I[4]=q=>lt(r).polygon.mode.value="draw"),class:he({active:lt(r).polygon.mode.value==="draw"}),disabled:lt(r).freehand.isAnimating.value},"  New Shape ",10,Sg),at("button",{onClick:I[5]||(I[5]=q=>lt(r).polygon.mode.value="edit"),class:he({active:lt(r).polygon.mode.value==="edit"}),disabled:lt(r).freehand.isAnimating.value},"  Edit Shape ",10,xg),at("button",{onClick:I[6]||(I[6]=q=>lt(r).freehand.showGrid.value=!lt(r).freehand.showGrid.value),class:he({active:lt(r).freehand.showGrid.value}),disabled:lt(r).freehand.isAnimating.value},Yt(lt(r).freehand.showGrid.value?" Grid On":" Grid Off"),11,wg),I[14]||(I[14]=at("span",{class:"separator"},"|",-1)),at("button",{onClick:K,disabled:!lt(r).polygon.isDrawing.value||lt(r).freehand.isAnimating.value},"  Cancel Shape ",8,Cg),at("button",{onClick:g,disabled:ws(lt(r))||lt(r).freehand.isAnimating.value},"  Delete ",8,Pg),I[15]||(I[15]=at("span",{class:"separator"},"|",-1)),at("button",{onClick:I[7]||(I[7]=q=>c.value=!lt(c)),class:he({active:lt(c)}),disabled:lt(r).freehand.isAnimating.value},"  Metadata ",10,Tg),lt(r).polygon.isDrawing.value?(wt(),At("span",kg,"Drawing: "+Yt(lt(r).polygon.currentPoints.value.length/2)+" points",1)):re("",!0)],64)):re("",!0),I[18]||(I[18]=at("span",{class:"separator"},"|",-1)),at("span",Ag,Yt(cn(lt(r)))+" selected",1)]),at("div",Rg,[at("div",{ref_key:"konvaContainer",ref:R,class:"konva-container",style:Ie({width:s.value.width+"px",height:s.value.height+"px"})},null,4),lt(c)?(wt(),At("div",Eg,[Zt(y0,{"canvas-state":lt(r)},null,8,["canvas-state"]),Zt(a0,{"selected-nodes":lt(P),"single-node":E.value,"multi-selected":A.value,"group-selected":O.value,"collect-hierarchy-from-root":lt(o).collectHierarchyFromRoot,"update-metadata-highlight":lt(o).updateMetadataHighlight,"update-hover-highlight":lt(o).updateHoverHighlight,"on-apply-metadata":W},null,8,["selected-nodes","single-node","multi-selected","group-selected","collect-hierarchy-from-root","update-metadata-highlight","update-hover-highlight"])])):re("",!0),Zt(Uf,{strokes:lt(qt)(lt(r)),selectedStrokes:lt(r).freehand.selectedStrokesForTimeline.value,useRealTiming:lt(r).freehand.useRealTiming.value,maxInterStrokeDelay:lt(gr),overrideDuration:lt(r).freehand.timelineDuration.value>0?lt(r).freehand.timelineDuration.value:void 0,lockWhileAnimating:ct,onTimeUpdate:x},null,8,["strokes","selectedStrokes","useRealTiming","maxInterStrokeDelay","overrideDuration"]),lt(r).freehand.isAnimating.value?(wt(),At("div",Mg,"  Timeline has modified elements - press Stop to unlock ")):re("",!0)])]))}}),[["styles",[".canvas-root[data-v-c643356c]{display:flex;flex-direction:column;align-items:center;gap:20px;padding:20px}.control-panel[data-v-c643356c]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:10px 15px;display:flex;align-items:center;gap:10px;box-shadow:0 2px 10px #0000001a}.canvas-wrapper[data-v-c643356c]{display:flex;flex-direction:column;align-items:center;gap:20px}.control-panel button[data-v-c643356c]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 15px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-c643356c]:hover:not(:disabled){background:#e0e0e0}.control-panel button.active[data-v-c643356c]{background:#06f;color:#fff;border-color:#06f}.control-panel button[data-v-c643356c]:disabled{opacity:.5;cursor:not-allowed}.button-group.vertical[data-v-c643356c]{display:flex;flex-direction:column;gap:2px}.button-group.vertical button[data-v-c643356c]{margin:0;padding:3px 10px;font-size:12px}.tool-dropdown[data-v-c643356c]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 10px;font-size:14px;cursor:pointer;transition:all .2s}.tool-dropdown[data-v-c643356c]:hover{background:#e0e0e0}.tool-dropdown[data-v-c643356c]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-c643356c]{color:#ccc}.info[data-v-c643356c]{color:#666;font-size:14px}.animation-lock-warning[data-v-c643356c]{color:#e67e22;font-size:14px;font-weight:700;text-align:center;background:#fef5e7;border:1px solid #f39c12;border-radius:4px;padding:8px 15px;animation:pulse-c643356c 2s infinite}@keyframes pulse-c643356c{0%,to{opacity:1}50%{opacity:.6}}.konva-container[data-v-c643356c]{background-color:#fff;border:1px solid black}.metadata-suite[data-v-c643356c]{display:flex;flex-direction:column;gap:8px;max-width:600px}"]],["__scopeId","data-v-c643356c"]]),zc="handwriting-canvas",Hs=fu(Fg);return customElements.get(zc)||customElements.define(zc,Hs),Ci.CanvasElement=Hs,Ci.default=Hs,Object.defineProperties(Ci,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),Ci}({});
