var PianoRollComponent=function(jr){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Zr(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Et={},pn=[],we=()=>{},qh=()=>!1,Yi=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),qr=t=>t.startsWith("onUpdate:"),$t=Object.assign,Kr=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Kh=Object.prototype.hasOwnProperty,Ct=(t,e)=>Kh.call(t,e),ft=Array.isArray,mn=t=>Hn(t)==="[object Map]",Xi=t=>Hn(t)==="[object Set]",vo=t=>Hn(t)==="[object Date]",pt=t=>typeof t=="function",Gt=t=>typeof t=="string",xe=t=>typeof t=="symbol",Ot=t=>t!==null&&typeof t=="object",bo=t=>(Ot(t)||pt(t))&&pt(t.then)&&pt(t.catch),yo=Object.prototype.toString,Hn=t=>yo.call(t),Yh=t=>Hn(t).slice(8,-1),Qi=t=>Hn(t)==="[object Object]",Yr=t=>Gt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Bn=Zr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ji=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Xh=/-(\w)/g,ve=Ji(t=>t.replace(Xh,(e,n)=>n?n.toUpperCase():"")),Qh=/\B([A-Z])/g,fe=Ji(t=>t.replace(Qh,"-$1").toLowerCase()),So=Ji(t=>t.charAt(0).toUpperCase()+t.slice(1)),Xr=Ji(t=>t?`on${So(t)}`:""),Be=(t,e)=>!Object.is(t,e),tr=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},wo=(t,e,n,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:n})},er=t=>{const e=parseFloat(t);return isNaN(e)?t:e},xo=t=>{const e=Gt(t)?Number(t):NaN;return isNaN(e)?t:e};let Co;const Po=()=>Co||(Co=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Te(t){if(ft(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],r=Gt(i)?nu(i):Te(i);if(r)for(const s in r)e[s]=r[s]}return e}else if(Gt(t)||Ot(t))return t}const Jh=/;(?![^(]*\))/g,tu=/:([^]+)/,eu=/\/\*[^]*?\*\//g;function nu(t){const e={};return t.replace(eu,"").split(Jh).forEach(n=>{if(n){const i=n.split(tu);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function be(t){let e="";if(Gt(t))e=t;else if(ft(t))for(let n=0;n<t.length;n++){const i=be(t[n]);i&&(e+=i+" ")}else if(Ot(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const iu=Zr("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function ko(t){return!!t||t===""}function ru(t,e){if(t.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<t.length;i++)n=nr(t[i],e[i]);return n}function nr(t,e){if(t===e)return!0;let n=vo(t),i=vo(e);if(n||i)return n&&i?t.getTime()===e.getTime():!1;if(n=xe(t),i=xe(e),n||i)return t===e;if(n=ft(t),i=ft(e),n||i)return n&&i?ru(t,e):!1;if(n=Ot(t),i=Ot(e),n||i){if(!n||!i)return!1;const r=Object.keys(t).length,s=Object.keys(e).length;if(r!==s)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!nr(t[o],e[o]))return!1}}return String(t)===String(e)}function su(t,e){return t.findIndex(n=>nr(n,e))}const Eo=t=>!!(t&&t.__v_isRef===!0),Ve=t=>Gt(t)?t:t==null?"":ft(t)||Ot(t)&&(t.toString===yo||!pt(t.toString))?Eo(t)?Ve(t.value):JSON.stringify(t,To,2):String(t),To=(t,e)=>Eo(e)?To(t,e.value):mn(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,r],s)=>(n[Qr(i,s)+" =>"]=r,n),{})}:Xi(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Qr(n))}:xe(e)?Qr(e):Ot(e)&&!ft(e)&&!Qi(e)?String(e):e,Qr=(t,e="")=>{var n;return xe(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ce;class ou{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ce,!e&&ce&&(this.index=(ce.scopes||(ce.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=ce;try{return ce=this,e()}finally{ce=n}}}on(){ce=this}off(){ce=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function au(){return ce}let Mt;const Jr=new WeakSet;class Ro{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ce&&ce.active&&ce.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Jr.has(this)&&(Jr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Mo(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Do(this),No(this);const e=Mt,n=ye;Mt=this,ye=!0;try{return this.fn()}finally{Io(this),Mt=e,ye=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)is(e);this.deps=this.depsTail=void 0,Do(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Jr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ns(this)&&this.run()}get dirty(){return ns(this)}}let Ao=0,Vn,$n;function Mo(t,e=!1){if(t.flags|=8,e){t.next=$n,$n=t;return}t.next=Vn,Vn=t}function ts(){Ao++}function es(){if(--Ao>0)return;if($n){let e=$n;for($n=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Vn;){let e=Vn;for(Vn=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){t||(t=i)}e=n}}if(t)throw t}function No(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Io(t){let e,n=t.depsTail,i=n;for(;i;){const r=i.prevDep;i.version===-1?(i===n&&(n=r),is(i),lu(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}t.deps=e,t.depsTail=n}function ns(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Oo(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Oo(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Wn))return;t.globalVersion=Wn;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!ns(t)){t.flags&=-3;return}const n=Mt,i=ye;Mt=t,ye=!0;try{No(t);const r=t.fn(t._value);(e.version===0||Be(r,t._value))&&(t._value=r,e.version++)}catch(r){throw e.version++,r}finally{Mt=n,ye=i,Io(t),t.flags&=-3}}function is(t,e=!1){const{dep:n,prevSub:i,nextSub:r}=t;if(i&&(i.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=i,t.nextSub=void 0),n.subs===t&&(n.subs=i),!n.subs&&n.computed){n.computed.flags&=-5;for(let s=n.computed.deps;s;s=s.nextDep)is(s,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function lu(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let ye=!0;const Fo=[];function Re(){Fo.push(ye),ye=!1}function Ae(){const t=Fo.pop();ye=t===void 0?!0:t}function Do(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Mt;Mt=void 0;try{e()}finally{Mt=n}}}let Wn=0;class cu{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class rs{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Mt||!ye||Mt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Mt)n=this.activeLink=new cu(Mt,this),Mt.deps?(n.prevDep=Mt.depsTail,Mt.depsTail.nextDep=n,Mt.depsTail=n):Mt.deps=Mt.depsTail=n,zo(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=Mt.depsTail,n.nextDep=void 0,Mt.depsTail.nextDep=n,Mt.depsTail=n,Mt.deps===n&&(Mt.deps=i)}return n}trigger(e){this.version++,Wn++,this.notify(e)}notify(e){ts();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{es()}}}function zo(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)zo(i)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const ss=new WeakMap,tn=Symbol(""),os=Symbol(""),jn=Symbol("");function Xt(t,e,n){if(ye&&Mt){let i=ss.get(t);i||ss.set(t,i=new Map);let r=i.get(n);r||(i.set(n,r=new rs),r.map=i,r.key=n),r.track()}}function Me(t,e,n,i,r,s){const o=ss.get(t);if(!o){Wn++;return}const a=l=>{l&&l.trigger()};if(ts(),e==="clear")o.forEach(a);else{const l=ft(t),c=l&&Yr(n);if(l&&n==="length"){const h=Number(i);o.forEach((p,f)=>{(f==="length"||f===jn||!xe(f)&&f>=h)&&a(p)})}else switch(n!==void 0&&a(o.get(n)),c&&a(o.get(jn)),e){case"add":l?c&&a(o.get("length")):(a(o.get(tn)),mn(t)&&a(o.get(os)));break;case"delete":l||(a(o.get(tn)),mn(t)&&a(o.get(os)));break;case"set":mn(t)&&a(o.get(tn));break}}es()}function _n(t){const e=wt(t);return e===t?e:(Xt(e,"iterate",jn),Se(t)?e:e.map(Qt))}function as(t){return Xt(t=wt(t),"iterate",jn),t}const hu={__proto__:null,[Symbol.iterator](){return ls(this,Symbol.iterator,Qt)},concat(...t){return _n(this).concat(...t.map(e=>ft(e)?_n(e):e))},entries(){return ls(this,"entries",t=>(t[1]=Qt(t[1]),t))},every(t,e){return Ne(this,"every",t,e,void 0,arguments)},filter(t,e){return Ne(this,"filter",t,e,n=>n.map(Qt),arguments)},find(t,e){return Ne(this,"find",t,e,Qt,arguments)},findIndex(t,e){return Ne(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Ne(this,"findLast",t,e,Qt,arguments)},findLastIndex(t,e){return Ne(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Ne(this,"forEach",t,e,void 0,arguments)},includes(...t){return cs(this,"includes",t)},indexOf(...t){return cs(this,"indexOf",t)},join(t){return _n(this).join(t)},lastIndexOf(...t){return cs(this,"lastIndexOf",t)},map(t,e){return Ne(this,"map",t,e,void 0,arguments)},pop(){return Zn(this,"pop")},push(...t){return Zn(this,"push",t)},reduce(t,...e){return Lo(this,"reduce",t,e)},reduceRight(t,...e){return Lo(this,"reduceRight",t,e)},shift(){return Zn(this,"shift")},some(t,e){return Ne(this,"some",t,e,void 0,arguments)},splice(...t){return Zn(this,"splice",t)},toReversed(){return _n(this).toReversed()},toSorted(t){return _n(this).toSorted(t)},toSpliced(...t){return _n(this).toSpliced(...t)},unshift(...t){return Zn(this,"unshift",t)},values(){return ls(this,"values",Qt)}};function ls(t,e,n){const i=as(t),r=i[e]();return i!==t&&!Se(t)&&(r._next=r.next,r.next=()=>{const s=r._next();return s.value&&(s.value=n(s.value)),s}),r}const uu=Array.prototype;function Ne(t,e,n,i,r,s){const o=as(t),a=o!==t&&!Se(t),l=o[e];if(l!==uu[e]){const p=l.apply(t,s);return a?Qt(p):p}let c=n;o!==t&&(a?c=function(p,f){return n.call(this,Qt(p),f,t)}:n.length>2&&(c=function(p,f){return n.call(this,p,f,t)}));const h=l.call(o,c,i);return a&&r?r(h):h}function Lo(t,e,n,i){const r=as(t);let s=n;return r!==t&&(Se(t)?n.length>3&&(s=function(o,a,l){return n.call(this,o,a,l,t)}):s=function(o,a,l){return n.call(this,o,Qt(a),l,t)}),r[e](s,...i)}function cs(t,e,n){const i=wt(t);Xt(i,"iterate",jn);const r=i[e](...n);return(r===-1||r===!1)&&us(n[0])?(n[0]=wt(n[0]),i[e](...n)):r}function Zn(t,e,n=[]){Re(),ts();const i=wt(t)[e].apply(t,n);return es(),Ae(),i}const du=Zr("__proto__,__v_isRef,__isVue"),Go=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(xe));function fu(t){xe(t)||(t=String(t));const e=wt(this);return Xt(e,"has",t),e.hasOwnProperty(t)}class Uo{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,i){const r=this._isReadonly,s=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return s;if(n==="__v_raw")return i===(r?s?Yo:Ko:s?qo:Zo).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=ft(e);if(!r){let l;if(o&&(l=hu[n]))return l;if(n==="hasOwnProperty")return fu}const a=Reflect.get(e,n,qt(e)?e:i);return(xe(n)?Go.has(n):du(n))||(r||Xt(e,"get",n),s)?a:qt(a)?o&&Yr(n)?a:a.value:Ot(a)?r?Xo(a):en(a):a}}class Ho extends Uo{constructor(e=!1){super(!1,e)}set(e,n,i,r){let s=e[n];if(!this._isShallow){const l=nn(s);if(!Se(i)&&!nn(i)&&(s=wt(s),i=wt(i)),!ft(e)&&qt(s)&&!qt(i))return l?!1:(s.value=i,!0)}const o=ft(e)&&Yr(n)?Number(n)<e.length:Ct(e,n),a=Reflect.set(e,n,i,qt(e)?e:r);return e===wt(r)&&(o?Be(i,s)&&Me(e,"set",n,i):Me(e,"add",n,i)),a}deleteProperty(e,n){const i=Ct(e,n);e[n];const r=Reflect.deleteProperty(e,n);return r&&i&&Me(e,"delete",n,void 0),r}has(e,n){const i=Reflect.has(e,n);return(!xe(n)||!Go.has(n))&&Xt(e,"has",n),i}ownKeys(e){return Xt(e,"iterate",ft(e)?"length":tn),Reflect.ownKeys(e)}}class Bo extends Uo{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const gu=new Ho,pu=new Bo,mu=new Ho(!0),_u=new Bo(!0),hs=t=>t,ir=t=>Reflect.getPrototypeOf(t);function rr(t,e,n=!1,i=!1){t=t.__v_raw;const r=wt(t),s=wt(e);n||(Be(e,s)&&Xt(r,"get",e),Xt(r,"get",s));const{has:o}=ir(r),a=i?hs:n?ds:Qt;if(o.call(r,e))return a(t.get(e));if(o.call(r,s))return a(t.get(s));t!==r&&t.get(e)}function sr(t,e=!1){const n=this.__v_raw,i=wt(n),r=wt(t);return e||(Be(t,r)&&Xt(i,"has",t),Xt(i,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function or(t,e=!1){return t=t.__v_raw,!e&&Xt(wt(t),"iterate",tn),Reflect.get(t,"size",t)}function Vo(t,e=!1){!e&&!Se(t)&&!nn(t)&&(t=wt(t));const n=wt(this);return ir(n).has.call(n,t)||(n.add(t),Me(n,"add",t,t)),this}function $o(t,e,n=!1){!n&&!Se(e)&&!nn(e)&&(e=wt(e));const i=wt(this),{has:r,get:s}=ir(i);let o=r.call(i,t);o||(t=wt(t),o=r.call(i,t));const a=s.call(i,t);return i.set(t,e),o?Be(e,a)&&Me(i,"set",t,e):Me(i,"add",t,e),this}function Wo(t){const e=wt(this),{has:n,get:i}=ir(e);let r=n.call(e,t);r||(t=wt(t),r=n.call(e,t)),i&&i.call(e,t);const s=e.delete(t);return r&&Me(e,"delete",t,void 0),s}function jo(){const t=wt(this),e=t.size!==0,n=t.clear();return e&&Me(t,"clear",void 0,void 0),n}function ar(t,e){return function(i,r){const s=this,o=s.__v_raw,a=wt(o),l=e?hs:t?ds:Qt;return!t&&Xt(a,"iterate",tn),o.forEach((c,h)=>i.call(r,l(c),l(h),s))}}function lr(t,e,n){return function(...i){const r=this.__v_raw,s=wt(r),o=mn(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=r[t](...i),h=n?hs:e?ds:Qt;return!e&&Xt(s,"iterate",l?os:tn),{next(){const{value:p,done:f}=c.next();return f?{value:p,done:f}:{value:a?[h(p[0]),h(p[1])]:h(p),done:f}},[Symbol.iterator](){return this}}}}function $e(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function vu(){const t={get(s){return rr(this,s)},get size(){return or(this)},has:sr,add:Vo,set:$o,delete:Wo,clear:jo,forEach:ar(!1,!1)},e={get(s){return rr(this,s,!1,!0)},get size(){return or(this)},has:sr,add(s){return Vo.call(this,s,!0)},set(s,o){return $o.call(this,s,o,!0)},delete:Wo,clear:jo,forEach:ar(!1,!0)},n={get(s){return rr(this,s,!0)},get size(){return or(this,!0)},has(s){return sr.call(this,s,!0)},add:$e("add"),set:$e("set"),delete:$e("delete"),clear:$e("clear"),forEach:ar(!0,!1)},i={get(s){return rr(this,s,!0,!0)},get size(){return or(this,!0)},has(s){return sr.call(this,s,!0)},add:$e("add"),set:$e("set"),delete:$e("delete"),clear:$e("clear"),forEach:ar(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=lr(s,!1,!1),n[s]=lr(s,!0,!1),e[s]=lr(s,!1,!0),i[s]=lr(s,!0,!0)}),[t,n,e,i]}const[bu,yu,Su,wu]=vu();function cr(t,e){const n=e?t?wu:Su:t?yu:bu;return(i,r,s)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?i:Reflect.get(Ct(n,r)&&r in i?n:i,r,s)}const xu={get:cr(!1,!1)},Cu={get:cr(!1,!0)},Pu={get:cr(!0,!1)},ku={get:cr(!0,!0)},Zo=new WeakMap,qo=new WeakMap,Ko=new WeakMap,Yo=new WeakMap;function Eu(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Tu(t){return t.__v_skip||!Object.isExtensible(t)?0:Eu(Yh(t))}function en(t){return nn(t)?t:hr(t,!1,gu,xu,Zo)}function Ru(t){return hr(t,!1,mu,Cu,qo)}function Xo(t){return hr(t,!0,pu,Pu,Ko)}function y5(t){return hr(t,!0,_u,ku,Yo)}function hr(t,e,n,i,r){if(!Ot(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=r.get(t);if(s)return s;const o=Tu(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return r.set(t,a),a}function qn(t){return nn(t)?qn(t.__v_raw):!!(t&&t.__v_isReactive)}function nn(t){return!!(t&&t.__v_isReadonly)}function Se(t){return!!(t&&t.__v_isShallow)}function us(t){return t?!!t.__v_raw:!1}function wt(t){const e=t&&t.__v_raw;return e?wt(e):t}function Au(t){return!Ct(t,"__v_skip")&&Object.isExtensible(t)&&wo(t,"__v_skip",!0),t}const Qt=t=>Ot(t)?en(t):t,ds=t=>Ot(t)?Xo(t):t;function qt(t){return t?t.__v_isRef===!0:!1}function Ut(t){return Qo(t,!1)}function Mu(t){return Qo(t,!0)}function Qo(t,e){return qt(t)?t:new Nu(t,e)}class Nu{constructor(e,n){this.dep=new rs,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:wt(e),this._value=n?e:Qt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,i=this.__v_isShallow||Se(e)||nn(e);e=i?e:wt(e),Be(e,n)&&(this._rawValue=e,this._value=i?e:Qt(e),this.dep.trigger())}}function We(t){return qt(t)?t.value:t}const Iu={get:(t,e,n)=>e==="__v_raw"?t:We(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const r=t[e];return qt(r)&&!qt(n)?(r.value=n,!0):Reflect.set(t,e,n,i)}};function Jo(t){return qn(t)?t:new Proxy(t,Iu)}class Ou{constructor(e,n,i){this.fn=e,this.setter=n,this._value=void 0,this.dep=new rs(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Wn-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Mt!==this)return Mo(this,!0),!0}get value(){const e=this.dep.track();return Oo(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Fu(t,e,n=!1){let i,r;return pt(t)?i=t:(i=t.get,r=t.set),new Ou(i,r,n)}const ur={},dr=new WeakMap;let rn;function Du(t,e=!1,n=rn){if(n){let i=dr.get(n);i||dr.set(n,i=[]),i.push(t)}}function zu(t,e,n=Et){const{immediate:i,deep:r,once:s,scheduler:o,augmentJob:a,call:l}=n,c=_=>r?_:Se(_)||r===!1||r===0?Ie(_,1):Ie(_);let h,p,f,d,g=!1,v=!1;if(qt(t)?(p=()=>t.value,g=Se(t)):qn(t)?(p=()=>c(t),g=!0):ft(t)?(v=!0,g=t.some(_=>qn(_)||Se(_)),p=()=>t.map(_=>{if(qt(_))return _.value;if(qn(_))return c(_);if(pt(_))return l?l(_,2):_()})):pt(t)?e?p=l?()=>l(t,2):t:p=()=>{if(f){Re();try{f()}finally{Ae()}}const _=rn;rn=h;try{return l?l(t,3,[d]):t(d)}finally{rn=_}}:p=we,e&&r){const _=p,S=r===!0?1/0:r;p=()=>Ie(_(),S)}const w=au(),x=()=>{h.stop(),w&&Kr(w.effects,h)};if(s&&e){const _=e;e=(...S)=>{_(...S),x()}}let m=v?new Array(t.length).fill(ur):ur;const u=_=>{if(!(!(h.flags&1)||!h.dirty&&!_))if(e){const S=h.run();if(r||g||(v?S.some((P,I)=>Be(P,m[I])):Be(S,m))){f&&f();const P=rn;rn=h;try{const I=[S,m===ur?void 0:v&&m[0]===ur?[]:m,d];l?l(e,3,I):e(...I),m=S}finally{rn=P}}}else h.run()};return a&&a(u),h=new Ro(p),h.scheduler=o?()=>o(u,!1):u,d=_=>Du(_,!1,h),f=h.onStop=()=>{const _=dr.get(h);if(_){if(l)l(_,4);else for(const S of _)S();dr.delete(h)}},e?i?u(!0):m=h.run():o?o(u.bind(null,!0),!0):h.run(),x.pause=h.pause.bind(h),x.resume=h.resume.bind(h),x.stop=x,x}function Ie(t,e=1/0,n){if(e<=0||!Ot(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,qt(t))Ie(t.value,e,n);else if(ft(t))for(let i=0;i<t.length;i++)Ie(t[i],e,n);else if(Xi(t)||mn(t))t.forEach(i=>{Ie(i,e,n)});else if(Qi(t)){for(const i in t)Ie(t[i],e,n);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&Ie(t[i],e,n)}return t}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Kn=[];let fs=!1;function S5(t,...e){if(fs)return;fs=!0,Re();const n=Kn.length?Kn[Kn.length-1].component:null,i=n&&n.appContext.config.warnHandler,r=Lu();if(i)vn(i,n,11,[t+e.map(s=>{var o,a;return(a=(o=s.toString)==null?void 0:o.call(s))!=null?a:JSON.stringify(s)}).join(""),n&&n.proxy,r.map(({vnode:s})=>`at <${ja(n,s.type)}>`).join(`
`),r]);else{const s=[`[Vue warn]: ${t}`,...e];r.length&&s.push(`
`,...Gu(r)),console.warn(...s)}Ae(),fs=!1}function Lu(){let t=Kn[Kn.length-1];if(!t)return[];const e=[];for(;t;){const n=e[0];n&&n.vnode===t?n.recurseCount++:e.push({vnode:t,recurseCount:0});const i=t.component&&t.component.parent;t=i&&i.vnode}return e}function Gu(t){const e=[];return t.forEach((n,i)=>{e.push(...i===0?[]:[`
`],...Uu(n))}),e}function Uu({vnode:t,recurseCount:e}){const n=e>0?`... (${e} recursive calls)`:"",i=t.component?t.component.parent==null:!1,r=` at <${ja(t.component,t.type,i)}`,s=">"+n;return t.props?[r,...Hu(t.props),s]:[r+s]}function Hu(t){const e=[],n=Object.keys(t);return n.slice(0,3).forEach(i=>{e.push(...ta(i,t[i]))}),n.length>3&&e.push(" ..."),e}function ta(t,e,n){return Gt(e)?(e=JSON.stringify(e),n?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?n?e:[`${t}=${e}`]:qt(e)?(e=ta(t,wt(e.value),!0),n?e:[`${t}=Ref<`,e,">"]):pt(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=wt(e),n?e:[`${t}=`,e])}function vn(t,e,n,i){try{return i?t(...i):t()}catch(r){fr(r,e,n)}}function Ce(t,e,n,i){if(pt(t)){const r=vn(t,e,n,i);return r&&bo(r)&&r.catch(s=>{fr(s,e,n)}),r}if(ft(t)){const r=[];for(let s=0;s<t.length;s++)r.push(Ce(t[s],e,n,i));return r}}function fr(t,e,n,i=!0){const r=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Et;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let p=0;p<h.length;p++)if(h[p](t,l,c)===!1)return}a=a.parent}if(s){Re(),vn(s,null,10,[t,l,c]),Ae();return}}Bu(t,n,r,i,o)}function Bu(t,e,n,i=!0,r=!1){if(r)throw t;console.error(t)}const Jt=[];let Pe=-1;const bn=[];let je=null,yn=0;const ea=Promise.resolve();let gr=null;function gs(t){const e=gr||ea;return t?e.then(this?t.bind(this):t):e}function Vu(t){let e=Pe+1,n=Jt.length;for(;e<n;){const i=e+n>>>1,r=Jt[i],s=Yn(r);s<t||s===t&&r.flags&2?e=i+1:n=i}return e}function ps(t){if(!(t.flags&1)){const e=Yn(t),n=Jt[Jt.length-1];!n||!(t.flags&2)&&e>=Yn(n)?Jt.push(t):Jt.splice(Vu(e),0,t),t.flags|=1,na()}}function na(){gr||(gr=ea.then(sa))}function $u(t){ft(t)?bn.push(...t):je&&t.id===-1?je.splice(yn+1,0,t):t.flags&1||(bn.push(t),t.flags|=1),na()}function ia(t,e,n=Pe+1){for(;n<Jt.length;n++){const i=Jt[n];if(i&&i.flags&2){if(t&&i.id!==t.uid)continue;Jt.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function ra(t){if(bn.length){const e=[...new Set(bn)].sort((n,i)=>Yn(n)-Yn(i));if(bn.length=0,je){je.push(...e);return}for(je=e,yn=0;yn<je.length;yn++){const n=je[yn];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}je=null,yn=0}}const Yn=t=>t.id==null?t.flags&2?-1:1/0:t.id;function sa(t){try{for(Pe=0;Pe<Jt.length;Pe++){const e=Jt[Pe];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),vn(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Pe<Jt.length;Pe++){const e=Jt[Pe];e&&(e.flags&=-2)}Pe=-1,Jt.length=0,ra(),gr=null,(Jt.length||bn.length)&&sa()}}let ge=null,oa=null;function pr(t){const e=ge;return ge=t,oa=t&&t.type.__scopeId||null,e}function Wu(t,e=ge,n){if(!e||t._n)return t;const i=(...r)=>{i._d&&La(-1);const s=pr(e);let o;try{o=t(...r)}finally{pr(s),i._d&&La(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function aa(t,e){if(ge===null)return t;const n=Cr(ge),i=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[s,o,a,l=Et]=e[r];s&&(pt(s)&&(s={mounted:s,updated:s}),s.deep&&Ie(o),i.push({dir:s,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function sn(t,e,n,i){const r=t.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(Re(),Ce(l,n,8,[t.el,a,t,e]),Ae())}}const ju=Symbol("_vte"),Zu=t=>t.__isTeleport;function ms(t,e){t.shapeFlag&6&&t.component?(t.transition=e,ms(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function _s(t,e){return pt(t)?$t({name:t.name},e,{setup:t}):t}function la(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function vs(t,e,n,i,r=!1){if(ft(t)){t.forEach((g,v)=>vs(g,e&&(ft(e)?e[v]:e),n,i,r));return}if(Xn(i)&&!r)return;const s=i.shapeFlag&4?Cr(i.component):i.el,o=r?null:s,{i:a,r:l}=t,c=e&&e.r,h=a.refs===Et?a.refs={}:a.refs,p=a.setupState,f=wt(p),d=p===Et?()=>!1:g=>Ct(f,g);if(c!=null&&c!==l&&(Gt(c)?(h[c]=null,d(c)&&(p[c]=null)):qt(c)&&(c.value=null)),pt(l))vn(l,a,12,[o,h]);else{const g=Gt(l),v=qt(l);if(g||v){const w=()=>{if(t.f){const x=g?d(l)?p[l]:h[l]:l.value;r?ft(x)&&Kr(x,s):ft(x)?x.includes(s)||x.push(s):g?(h[l]=[s],d(l)&&(p[l]=h[l])):(l.value=[s],t.k&&(h[t.k]=l.value))}else g?(h[l]=o,d(l)&&(p[l]=o)):v&&(l.value=o,t.k&&(h[t.k]=o))};o?(w.id=-1,he(w,n)):w()}}}const Xn=t=>!!t.type.__asyncLoader,ca=t=>t.type.__isKeepAlive;function qu(t,e){ha(t,"a",e)}function Ku(t,e){ha(t,"da",e)}function ha(t,e,n=ee){const i=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(mr(e,i,n),n){let r=n.parent;for(;r&&r.parent;)ca(r.parent.vnode)&&Yu(i,e,n,r),r=r.parent}}function Yu(t,e,n,i){const r=mr(e,t,i,!0);bs(()=>{Kr(i[e],r)},n)}function mr(t,e,n=ee,i=!1){if(n){const r=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...o)=>{Re();const a=ii(n),l=Ce(e,n,t,o);return a(),Ae(),l});return i?r.unshift(s):r.push(s),s}}const Oe=t=>(e,n=ee)=>{(!xr||t==="sp")&&mr(t,(...i)=>e(...i),n)},Xu=Oe("bm"),ua=Oe("m"),Qu=Oe("bu"),Ju=Oe("u"),td=Oe("bum"),bs=Oe("um"),ed=Oe("sp"),nd=Oe("rtg"),id=Oe("rtc");function rd(t,e=ee){mr("ec",t,e)}const sd=Symbol.for("v-ndc"),ys=t=>t?Va(t)?Cr(t):ys(t.parent):null,Qn=$t(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>ys(t.parent),$root:t=>ys(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>pa(t),$forceUpdate:t=>t.f||(t.f=()=>{ps(t.update)}),$nextTick:t=>t.n||(t.n=gs.bind(t.proxy)),$watch:t=>Ed.bind(t)}),Ss=(t,e)=>t!==Et&&!t.__isScriptSetup&&Ct(t,e),od={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const d=o[e];if(d!==void 0)switch(d){case 1:return i[e];case 2:return r[e];case 4:return n[e];case 3:return s[e]}else{if(Ss(i,e))return o[e]=1,i[e];if(r!==Et&&Ct(r,e))return o[e]=2,r[e];if((c=t.propsOptions[0])&&Ct(c,e))return o[e]=3,s[e];if(n!==Et&&Ct(n,e))return o[e]=4,n[e];ws&&(o[e]=0)}}const h=Qn[e];let p,f;if(h)return e==="$attrs"&&Xt(t.attrs,"get",""),h(t);if((p=a.__cssModules)&&(p=p[e]))return p;if(n!==Et&&Ct(n,e))return o[e]=4,n[e];if(f=l.config.globalProperties,Ct(f,e))return f[e]},set({_:t},e,n){const{data:i,setupState:r,ctx:s}=t;return Ss(r,e)?(r[e]=n,!0):i!==Et&&Ct(i,e)?(i[e]=n,!0):Ct(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!n[o]||t!==Et&&Ct(t,o)||Ss(e,o)||(a=s[0])&&Ct(a,o)||Ct(i,o)||Ct(Qn,o)||Ct(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ct(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function da(t){return ft(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let ws=!0;function ad(t){const e=pa(t),n=t.proxy,i=t.ctx;ws=!1,e.beforeCreate&&fa(e.beforeCreate,t,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:p,mounted:f,beforeUpdate:d,updated:g,activated:v,deactivated:w,beforeDestroy:x,beforeUnmount:m,destroyed:u,unmounted:_,render:S,renderTracked:P,renderTriggered:I,errorCaptured:b,serverPrefetch:C,expose:E,inheritAttrs:N,components:D,directives:G,filters:U}=e;if(c&&ld(c,i,null),o)for(const y in o){const k=o[y];pt(k)&&(i[y]=k.bind(n))}if(r){const y=r.call(n,n);Ot(y)&&(t.data=en(y))}if(ws=!0,s)for(const y in s){const k=s[y],M=pt(k)?k.bind(n,n):pt(k.get)?k.get.bind(n,n):we,R=!pt(k)&&pt(k.set)?k.set.bind(n):we,F=Nt({get:M,set:R});Object.defineProperty(i,y,{enumerable:!0,configurable:!0,get:()=>F.value,set:$=>F.value=$})}if(a)for(const y in a)ga(a[y],i,n,y);if(l){const y=pt(l)?l.call(n):l;Reflect.ownKeys(y).forEach(k=>{gd(k,y[k])})}h&&fa(h,t,"c");function q(y,k){ft(k)?k.forEach(M=>y(M.bind(n))):k&&y(k.bind(n))}if(q(Xu,p),q(ua,f),q(Qu,d),q(Ju,g),q(qu,v),q(Ku,w),q(rd,b),q(id,P),q(nd,I),q(td,m),q(bs,_),q(ed,C),ft(E))if(E.length){const y=t.exposed||(t.exposed={});E.forEach(k=>{Object.defineProperty(y,k,{get:()=>n[k],set:M=>n[k]=M})})}else t.exposed||(t.exposed={});S&&t.render===we&&(t.render=S),N!=null&&(t.inheritAttrs=N),D&&(t.components=D),G&&(t.directives=G),C&&la(t)}function ld(t,e,n=we){ft(t)&&(t=xs(t));for(const i in t){const r=t[i];let s;Ot(r)?"default"in r?s=vr(r.from||i,r.default,!0):s=vr(r.from||i):s=vr(r),qt(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[i]=s}}function fa(t,e,n){Ce(ft(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function ga(t,e,n,i){let r=i.includes(".")?Ia(n,i):()=>n[i];if(Gt(t)){const s=e[t];pt(s)&&Fe(r,s)}else if(pt(t))Fe(r,t.bind(n));else if(Ot(t))if(ft(t))t.forEach(s=>ga(s,e,n,i));else{const s=pt(t.handler)?t.handler.bind(n):e[t.handler];pt(s)&&Fe(r,s,t)}}function pa(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!n&&!i?l=e:(l={},r.length&&r.forEach(c=>_r(l,c,o,!0)),_r(l,e,o)),Ot(e)&&s.set(e,l),l}function _r(t,e,n,i=!1){const{mixins:r,extends:s}=e;s&&_r(t,s,n,!0),r&&r.forEach(o=>_r(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=cd[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const cd={data:ma,props:_a,emits:_a,methods:Jn,computed:Jn,beforeCreate:te,created:te,beforeMount:te,mounted:te,beforeUpdate:te,updated:te,beforeDestroy:te,beforeUnmount:te,destroyed:te,unmounted:te,activated:te,deactivated:te,errorCaptured:te,serverPrefetch:te,components:Jn,directives:Jn,watch:ud,provide:ma,inject:hd};function ma(t,e){return e?t?function(){return $t(pt(t)?t.call(this,this):t,pt(e)?e.call(this,this):e)}:e:t}function hd(t,e){return Jn(xs(t),xs(e))}function xs(t){if(ft(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function te(t,e){return t?[...new Set([].concat(t,e))]:e}function Jn(t,e){return t?$t(Object.create(null),t,e):e}function _a(t,e){return t?ft(t)&&ft(e)?[...new Set([...t,...e])]:$t(Object.create(null),da(t),da(e??{})):e}function ud(t,e){if(!t)return e;if(!e)return t;const n=$t(Object.create(null),t);for(const i in e)n[i]=te(t[i],e[i]);return n}function va(){return{app:null,config:{isNativeTag:qh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let dd=0;function fd(t,e){return function(i,r=null){pt(i)||(i=$t({},i)),r!=null&&!Ot(r)&&(r=null);const s=va(),o=new WeakSet,a=[];let l=!1;const c=s.app={_uid:dd++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:Xd,get config(){return s.config},set config(h){},use(h,...p){return o.has(h)||(h&&pt(h.install)?(o.add(h),h.install(c,...p)):pt(h)&&(o.add(h),h(c,...p))),c},mixin(h){return s.mixins.includes(h)||s.mixins.push(h),c},component(h,p){return p?(s.components[h]=p,c):s.components[h]},directive(h,p){return p?(s.directives[h]=p,c):s.directives[h]},mount(h,p,f){if(!l){const d=c._ceVNode||pe(i,r);return d.appContext=s,f===!0?f="svg":f===!1&&(f=void 0),t(d,h,f),l=!0,c._container=h,h.__vue_app__=c,Cr(d.component)}},onUnmount(h){a.push(h)},unmount(){l&&(Ce(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(h,p){return s.provides[h]=p,c},runWithContext(h){const p=Sn;Sn=c;try{return h()}finally{Sn=p}}};return c}}let Sn=null;function gd(t,e){if(ee){let n=ee.provides;const i=ee.parent&&ee.parent.provides;i===n&&(n=ee.provides=Object.create(i)),n[t]=e}}function vr(t,e,n=!1){const i=ee||ge;if(i||Sn){const r=Sn?Sn._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return n&&pt(e)?e.call(i&&i.proxy):e}}const ba={},ya=()=>Object.create(ba),Sa=t=>Object.getPrototypeOf(t)===ba;function pd(t,e,n,i=!1){const r={},s=ya();t.propsDefaults=Object.create(null),wa(t,e,r,s);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=i?r:Ru(r):t.type.props?t.props=r:t.props=s,t.attrs=s}function md(t,e,n,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=t,a=wt(r),[l]=t.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let p=0;p<h.length;p++){let f=h[p];if(br(t.emitsOptions,f))continue;const d=e[f];if(l)if(Ct(s,f))d!==s[f]&&(s[f]=d,c=!0);else{const g=ve(f);r[g]=Cs(l,a,g,d,t,!1)}else d!==s[f]&&(s[f]=d,c=!0)}}}else{wa(t,e,r,s)&&(c=!0);let h;for(const p in a)(!e||!Ct(e,p)&&((h=fe(p))===p||!Ct(e,h)))&&(l?n&&(n[p]!==void 0||n[h]!==void 0)&&(r[p]=Cs(l,a,p,void 0,t,!0)):delete r[p]);if(s!==a)for(const p in s)(!e||!Ct(e,p))&&(delete s[p],c=!0)}c&&Me(t.attrs,"set","")}function wa(t,e,n,i){const[r,s]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(Bn(l))continue;const c=e[l];let h;r&&Ct(r,h=ve(l))?!s||!s.includes(h)?n[h]=c:(a||(a={}))[h]=c:br(t.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(s){const l=wt(n),c=a||Et;for(let h=0;h<s.length;h++){const p=s[h];n[p]=Cs(r,l,p,c[p],t,!Ct(c,p))}}return o}function Cs(t,e,n,i,r,s){const o=t[n];if(o!=null){const a=Ct(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&pt(l)){const{propsDefaults:c}=r;if(n in c)i=c[n];else{const h=ii(r);i=c[n]=l.call(null,e),h()}}else i=l;r.ce&&r.ce._setProp(n,i)}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===fe(n))&&(i=!0))}return i}const _d=new WeakMap;function xa(t,e,n=!1){const i=n?_d:e.propsCache,r=i.get(t);if(r)return r;const s=t.props,o={},a=[];let l=!1;if(!pt(t)){const h=p=>{l=!0;const[f,d]=xa(p,e,!0);$t(o,f),d&&a.push(...d)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!s&&!l)return Ot(t)&&i.set(t,pn),pn;if(ft(s))for(let h=0;h<s.length;h++){const p=ve(s[h]);Ca(p)&&(o[p]=Et)}else if(s)for(const h in s){const p=ve(h);if(Ca(p)){const f=s[h],d=o[p]=ft(f)||pt(f)?{type:f}:$t({},f),g=d.type;let v=!1,w=!0;if(ft(g))for(let x=0;x<g.length;++x){const m=g[x],u=pt(m)&&m.name;if(u==="Boolean"){v=!0;break}else u==="String"&&(w=!1)}else v=pt(g)&&g.name==="Boolean";d[0]=v,d[1]=w,(v||Ct(d,"default"))&&a.push(p)}}const c=[o,a];return Ot(t)&&i.set(t,c),c}function Ca(t){return t[0]!=="$"&&!Bn(t)}const Pa=t=>t[0]==="_"||t==="$stable",Ps=t=>ft(t)?t.map(ke):[ke(t)],vd=(t,e,n)=>{if(e._n)return e;const i=Wu((...r)=>Ps(e(...r)),n);return i._c=!1,i},ka=(t,e,n)=>{const i=t._ctx;for(const r in t){if(Pa(r))continue;const s=t[r];if(pt(s))e[r]=vd(r,s,i);else if(s!=null){const o=Ps(s);e[r]=()=>o}}},Ea=(t,e)=>{const n=Ps(e);t.slots.default=()=>n},Ta=(t,e,n)=>{for(const i in e)(n||i!=="_")&&(t[i]=e[i])},bd=(t,e,n)=>{const i=t.slots=ya();if(t.vnode.shapeFlag&32){const r=e._;r?(Ta(i,e,n),n&&wo(i,"_",r,!0)):ka(e,i)}else e&&Ea(t,e)},yd=(t,e,n)=>{const{vnode:i,slots:r}=t;let s=!0,o=Et;if(i.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:Ta(r,e,n):(s=!e.$stable,ka(e,r)),o=e}else e&&(Ea(t,e),o={default:1});if(s)for(const a in r)!Pa(a)&&o[a]==null&&delete r[a]},he=Od;function Sd(t){return wd(t)}function wd(t,e){const n=Po();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:p,nextSibling:f,setScopeId:d=we,insertStaticContent:g}=t,v=(T,O,V,W=null,K=null,j=null,J=void 0,nt=null,tt=!!O.dynamicChildren)=>{if(T===O)return;T&&!ni(T,O)&&(W=A(T),$(T,K,j,!0),T=null),O.patchFlag===-2&&(tt=!1,O.dynamicChildren=null);const{type:Q,ref:ot,shapeFlag:it}=O;switch(Q){case yr:w(T,O,V,W);break;case an:x(T,O,V,W);break;case Es:T==null&&m(O,V,W,J);break;case De:D(T,O,V,W,K,j,J,nt,tt);break;default:it&1?S(T,O,V,W,K,j,J,nt,tt):it&6?G(T,O,V,W,K,j,J,nt,tt):(it&64||it&128)&&Q.process(T,O,V,W,K,j,J,nt,tt,st)}ot!=null&&K&&vs(ot,T&&T.ref,j,O||T,!O)},w=(T,O,V,W)=>{if(T==null)i(O.el=a(O.children),V,W);else{const K=O.el=T.el;O.children!==T.children&&c(K,O.children)}},x=(T,O,V,W)=>{T==null?i(O.el=l(O.children||""),V,W):O.el=T.el},m=(T,O,V,W)=>{[T.el,T.anchor]=g(T.children,O,V,W,T.el,T.anchor)},u=({el:T,anchor:O},V,W)=>{let K;for(;T&&T!==O;)K=f(T),i(T,V,W),T=K;i(O,V,W)},_=({el:T,anchor:O})=>{let V;for(;T&&T!==O;)V=f(T),r(T),T=V;r(O)},S=(T,O,V,W,K,j,J,nt,tt)=>{O.type==="svg"?J="svg":O.type==="math"&&(J="mathml"),T==null?P(O,V,W,K,j,J,nt,tt):C(T,O,K,j,J,nt,tt)},P=(T,O,V,W,K,j,J,nt)=>{let tt,Q;const{props:ot,shapeFlag:it,transition:lt,dirs:ut}=T;if(tt=T.el=o(T.type,j,ot&&ot.is,ot),it&8?h(tt,T.children):it&16&&b(T.children,tt,null,W,K,ks(T,j),J,nt),ut&&sn(T,null,W,"created"),I(tt,T,T.scopeId,J,W),ot){for(const vt in ot)vt!=="value"&&!Bn(vt)&&s(tt,vt,null,ot[vt],j,W);"value"in ot&&s(tt,"value",null,ot.value,j),(Q=ot.onVnodeBeforeMount)&&Ee(Q,W,T)}ut&&sn(T,null,W,"beforeMount");const dt=xd(K,lt);dt&&lt.beforeEnter(tt),i(tt,O,V),((Q=ot&&ot.onVnodeMounted)||dt||ut)&&he(()=>{Q&&Ee(Q,W,T),dt&&lt.enter(tt),ut&&sn(T,null,W,"mounted")},K)},I=(T,O,V,W,K)=>{if(V&&d(T,V),W)for(let j=0;j<W.length;j++)d(T,W[j]);if(K){let j=K.subTree;if(O===j||za(j.type)&&(j.ssContent===O||j.ssFallback===O)){const J=K.vnode;I(T,J,J.scopeId,J.slotScopeIds,K.parent)}}},b=(T,O,V,W,K,j,J,nt,tt=0)=>{for(let Q=tt;Q<T.length;Q++){const ot=T[Q]=nt?Ze(T[Q]):ke(T[Q]);v(null,ot,O,V,W,K,j,J,nt)}},C=(T,O,V,W,K,j,J)=>{const nt=O.el=T.el;let{patchFlag:tt,dynamicChildren:Q,dirs:ot}=O;tt|=T.patchFlag&16;const it=T.props||Et,lt=O.props||Et;let ut;if(V&&on(V,!1),(ut=lt.onVnodeBeforeUpdate)&&Ee(ut,V,O,T),ot&&sn(O,T,V,"beforeUpdate"),V&&on(V,!0),(it.innerHTML&&lt.innerHTML==null||it.textContent&&lt.textContent==null)&&h(nt,""),Q?E(T.dynamicChildren,Q,nt,V,W,ks(O,K),j):J||k(T,O,nt,null,V,W,ks(O,K),j,!1),tt>0){if(tt&16)N(nt,it,lt,V,K);else if(tt&2&&it.class!==lt.class&&s(nt,"class",null,lt.class,K),tt&4&&s(nt,"style",it.style,lt.style,K),tt&8){const dt=O.dynamicProps;for(let vt=0;vt<dt.length;vt++){const _t=dt[vt],Pt=it[_t],xt=lt[_t];(xt!==Pt||_t==="value")&&s(nt,_t,Pt,xt,K,V)}}tt&1&&T.children!==O.children&&h(nt,O.children)}else!J&&Q==null&&N(nt,it,lt,V,K);((ut=lt.onVnodeUpdated)||ot)&&he(()=>{ut&&Ee(ut,V,O,T),ot&&sn(O,T,V,"updated")},W)},E=(T,O,V,W,K,j,J)=>{for(let nt=0;nt<O.length;nt++){const tt=T[nt],Q=O[nt],ot=tt.el&&(tt.type===De||!ni(tt,Q)||tt.shapeFlag&70)?p(tt.el):V;v(tt,Q,ot,null,W,K,j,J,!0)}},N=(T,O,V,W,K)=>{if(O!==V){if(O!==Et)for(const j in O)!Bn(j)&&!(j in V)&&s(T,j,O[j],null,K,W);for(const j in V){if(Bn(j))continue;const J=V[j],nt=O[j];J!==nt&&j!=="value"&&s(T,j,nt,J,K,W)}"value"in V&&s(T,"value",O.value,V.value,K)}},D=(T,O,V,W,K,j,J,nt,tt)=>{const Q=O.el=T?T.el:a(""),ot=O.anchor=T?T.anchor:a("");let{patchFlag:it,dynamicChildren:lt,slotScopeIds:ut}=O;ut&&(nt=nt?nt.concat(ut):ut),T==null?(i(Q,V,W),i(ot,V,W),b(O.children||[],V,ot,K,j,J,nt,tt)):it>0&&it&64&&lt&&T.dynamicChildren?(E(T.dynamicChildren,lt,V,K,j,J,nt),(O.key!=null||K&&O===K.subTree)&&Ra(T,O,!0)):k(T,O,V,ot,K,j,J,nt,tt)},G=(T,O,V,W,K,j,J,nt,tt)=>{O.slotScopeIds=nt,T==null?O.shapeFlag&512?K.ctx.activate(O,V,W,J,tt):U(O,V,W,K,j,J,tt):z(T,O,tt)},U=(T,O,V,W,K,j,J)=>{const nt=T.component=Bd(T,W,K);if(ca(T)&&(nt.ctx.renderer=st),Vd(nt,!1,J),nt.asyncDep){if(K&&K.registerDep(nt,q,J),!T.el){const tt=nt.subTree=pe(an);x(null,tt,O,V)}}else q(nt,T,O,V,K,j,J)},z=(T,O,V)=>{const W=O.component=T.component;if(Nd(T,O,V))if(W.asyncDep&&!W.asyncResolved){y(W,O,V);return}else W.next=O,W.update();else O.el=T.el,W.vnode=O},q=(T,O,V,W,K,j,J)=>{const nt=()=>{if(T.isMounted){let{next:it,bu:lt,u:ut,parent:dt,vnode:vt}=T;{const jt=Aa(T);if(jt){it&&(it.el=vt.el,y(T,it,J)),jt.asyncDep.then(()=>{T.isUnmounted||nt()});return}}let _t=it,Pt;on(T,!1),it?(it.el=vt.el,y(T,it,J)):it=vt,lt&&tr(lt),(Pt=it.props&&it.props.onVnodeBeforeUpdate)&&Ee(Pt,dt,it,vt),on(T,!0);const xt=Fa(T),At=T.subTree;T.subTree=xt,v(At,xt,p(At.el),A(At),T,K,j),it.el=xt.el,_t===null&&Id(T,xt.el),ut&&he(ut,K),(Pt=it.props&&it.props.onVnodeUpdated)&&he(()=>Ee(Pt,dt,it,vt),K)}else{let it;const{el:lt,props:ut}=O,{bm:dt,m:vt,parent:_t,root:Pt,type:xt}=T,At=Xn(O);on(T,!1),dt&&tr(dt),!At&&(it=ut&&ut.onVnodeBeforeMount)&&Ee(it,_t,O),on(T,!0);{Pt.ce&&Pt.ce._injectChildStyle(xt);const jt=T.subTree=Fa(T);v(null,jt,V,W,T,K,j),O.el=jt.el}if(vt&&he(vt,K),!At&&(it=ut&&ut.onVnodeMounted)){const jt=O;he(()=>Ee(it,_t,jt),K)}(O.shapeFlag&256||_t&&Xn(_t.vnode)&&_t.vnode.shapeFlag&256)&&T.a&&he(T.a,K),T.isMounted=!0,O=V=W=null}};T.scope.on();const tt=T.effect=new Ro(nt);T.scope.off();const Q=T.update=tt.run.bind(tt),ot=T.job=tt.runIfDirty.bind(tt);ot.i=T,ot.id=T.uid,tt.scheduler=()=>ps(ot),on(T,!0),Q()},y=(T,O,V)=>{O.component=T;const W=T.vnode.props;T.vnode=O,T.next=null,md(T,O.props,W,V),yd(T,O.children,V),Re(),ia(T),Ae()},k=(T,O,V,W,K,j,J,nt,tt=!1)=>{const Q=T&&T.children,ot=T?T.shapeFlag:0,it=O.children,{patchFlag:lt,shapeFlag:ut}=O;if(lt>0){if(lt&128){R(Q,it,V,W,K,j,J,nt,tt);return}else if(lt&256){M(Q,it,V,W,K,j,J,nt,tt);return}}ut&8?(ot&16&&H(Q,K,j),it!==Q&&h(V,it)):ot&16?ut&16?R(Q,it,V,W,K,j,J,nt,tt):H(Q,K,j,!0):(ot&8&&h(V,""),ut&16&&b(it,V,W,K,j,J,nt,tt))},M=(T,O,V,W,K,j,J,nt,tt)=>{T=T||pn,O=O||pn;const Q=T.length,ot=O.length,it=Math.min(Q,ot);let lt;for(lt=0;lt<it;lt++){const ut=O[lt]=tt?Ze(O[lt]):ke(O[lt]);v(T[lt],ut,V,null,K,j,J,nt,tt)}Q>ot?H(T,K,j,!0,!1,it):b(O,V,W,K,j,J,nt,tt,it)},R=(T,O,V,W,K,j,J,nt,tt)=>{let Q=0;const ot=O.length;let it=T.length-1,lt=ot-1;for(;Q<=it&&Q<=lt;){const ut=T[Q],dt=O[Q]=tt?Ze(O[Q]):ke(O[Q]);if(ni(ut,dt))v(ut,dt,V,null,K,j,J,nt,tt);else break;Q++}for(;Q<=it&&Q<=lt;){const ut=T[it],dt=O[lt]=tt?Ze(O[lt]):ke(O[lt]);if(ni(ut,dt))v(ut,dt,V,null,K,j,J,nt,tt);else break;it--,lt--}if(Q>it){if(Q<=lt){const ut=lt+1,dt=ut<ot?O[ut].el:W;for(;Q<=lt;)v(null,O[Q]=tt?Ze(O[Q]):ke(O[Q]),V,dt,K,j,J,nt,tt),Q++}}else if(Q>lt)for(;Q<=it;)$(T[Q],K,j,!0),Q++;else{const ut=Q,dt=Q,vt=new Map;for(Q=dt;Q<=lt;Q++){const Kt=O[Q]=tt?Ze(O[Q]):ke(O[Q]);Kt.key!=null&&vt.set(Kt.key,Q)}let _t,Pt=0;const xt=lt-dt+1;let At=!1,jt=0;const _e=new Array(xt);for(Q=0;Q<xt;Q++)_e[Q]=0;for(Q=ut;Q<=it;Q++){const Kt=T[Q];if(Pt>=xt){$(Kt,K,j,!0);continue}let ae;if(Kt.key!=null)ae=vt.get(Kt.key);else for(_t=dt;_t<=lt;_t++)if(_e[_t-dt]===0&&ni(Kt,O[_t])){ae=_t;break}ae===void 0?$(Kt,K,j,!0):(_e[ae-dt]=Q+1,ae>=jt?jt=ae:At=!0,v(Kt,O[ae],V,null,K,j,J,nt,tt),Pt++)}const He=At?Cd(_e):pn;for(_t=He.length-1,Q=xt-1;Q>=0;Q--){const Kt=dt+Q,ae=O[Kt],Ln=Kt+1<ot?O[Kt+1].el:W;_e[Q]===0?v(null,ae,V,Ln,K,j,J,nt,tt):At&&(_t<0||Q!==He[_t]?F(ae,V,Ln,2):_t--)}}},F=(T,O,V,W,K=null)=>{const{el:j,type:J,transition:nt,children:tt,shapeFlag:Q}=T;if(Q&6){F(T.component.subTree,O,V,W);return}if(Q&128){T.suspense.move(O,V,W);return}if(Q&64){J.move(T,O,V,st);return}if(J===De){i(j,O,V);for(let it=0;it<tt.length;it++)F(tt[it],O,V,W);i(T.anchor,O,V);return}if(J===Es){u(T,O,V);return}if(W!==2&&Q&1&&nt)if(W===0)nt.beforeEnter(j),i(j,O,V),he(()=>nt.enter(j),K);else{const{leave:it,delayLeave:lt,afterLeave:ut}=nt,dt=()=>i(j,O,V),vt=()=>{it(j,()=>{dt(),ut&&ut()})};lt?lt(j,dt,vt):vt()}else i(j,O,V)},$=(T,O,V,W=!1,K=!1)=>{const{type:j,props:J,ref:nt,children:tt,dynamicChildren:Q,shapeFlag:ot,patchFlag:it,dirs:lt,cacheIndex:ut}=T;if(it===-2&&(K=!1),nt!=null&&vs(nt,null,V,T,!0),ut!=null&&(O.renderCache[ut]=void 0),ot&256){O.ctx.deactivate(T);return}const dt=ot&1&&lt,vt=!Xn(T);let _t;if(vt&&(_t=J&&J.onVnodeBeforeUnmount)&&Ee(_t,O,T),ot&6)X(T.component,V,W);else{if(ot&128){T.suspense.unmount(V,W);return}dt&&sn(T,null,O,"beforeUnmount"),ot&64?T.type.remove(T,O,V,st,W):Q&&!Q.hasOnce&&(j!==De||it>0&&it&64)?H(Q,O,V,!1,!0):(j===De&&it&384||!K&&ot&16)&&H(tt,O,V),W&&L(T)}(vt&&(_t=J&&J.onVnodeUnmounted)||dt)&&he(()=>{_t&&Ee(_t,O,T),dt&&sn(T,null,O,"unmounted")},V)},L=T=>{const{type:O,el:V,anchor:W,transition:K}=T;if(O===De){Y(V,W);return}if(O===Es){_(T);return}const j=()=>{r(V),K&&!K.persisted&&K.afterLeave&&K.afterLeave()};if(T.shapeFlag&1&&K&&!K.persisted){const{leave:J,delayLeave:nt}=K,tt=()=>J(V,j);nt?nt(T.el,j,tt):tt()}else j()},Y=(T,O)=>{let V;for(;T!==O;)V=f(T),r(T),T=V;r(O)},X=(T,O,V)=>{const{bum:W,scope:K,job:j,subTree:J,um:nt,m:tt,a:Q}=T;Ma(tt),Ma(Q),W&&tr(W),K.stop(),j&&(j.flags|=8,$(J,T,O,V)),nt&&he(nt,O),he(()=>{T.isUnmounted=!0},O),O&&O.pendingBranch&&!O.isUnmounted&&T.asyncDep&&!T.asyncResolved&&T.suspenseId===O.pendingId&&(O.deps--,O.deps===0&&O.resolve())},H=(T,O,V,W=!1,K=!1,j=0)=>{for(let J=j;J<T.length;J++)$(T[J],O,V,W,K)},A=T=>{if(T.shapeFlag&6)return A(T.component.subTree);if(T.shapeFlag&128)return T.suspense.next();const O=f(T.anchor||T.el),V=O&&O[ju];return V?f(V):O};let B=!1;const et=(T,O,V)=>{T==null?O._vnode&&$(O._vnode,null,null,!0):v(O._vnode||null,T,O,null,null,null,V),O._vnode=T,B||(B=!0,ia(),ra(),B=!1)},st={p:v,um:$,m:F,r:L,mt:U,mc:b,pc:k,pbc:E,n:A,o:t};return{render:et,hydrate:void 0,createApp:fd(et)}}function ks({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function on({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function xd(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Ra(t,e,n=!1){const i=t.children,r=e.children;if(ft(i)&&ft(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=Ze(r[s]),a.el=o.el),!n&&a.patchFlag!==-2&&Ra(o,a)),a.type===yr&&(a.el=o.el)}}function Cd(t){const e=t.slice(),n=[0];let i,r,s,o,a;const l=t.length;for(i=0;i<l;i++){const c=t[i];if(c!==0){if(r=n[n.length-1],t[r]<c){e[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,t[n[a]]<c?s=a+1:o=a;c<t[n[s]]&&(s>0&&(e[i]=n[s-1]),n[s]=i)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=e[o];return n}function Aa(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Aa(e)}function Ma(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Pd=Symbol.for("v-scx"),kd=()=>vr(Pd);function Fe(t,e,n){return Na(t,e,n)}function Na(t,e,n=Et){const{immediate:i,deep:r,flush:s,once:o}=n,a=$t({},n);let l;if(xr)if(s==="sync"){const f=kd();l=f.__watcherHandles||(f.__watcherHandles=[])}else if(!e||i)a.once=!0;else{const f=()=>{};return f.stop=we,f.resume=we,f.pause=we,f}const c=ee;a.call=(f,d,g)=>Ce(f,c,d,g);let h=!1;s==="post"?a.scheduler=f=>{he(f,c&&c.suspense)}:s!=="sync"&&(h=!0,a.scheduler=(f,d)=>{d?f():ps(f)}),a.augmentJob=f=>{e&&(f.flags|=4),h&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const p=zu(t,e,a);return l&&l.push(p),p}function Ed(t,e,n){const i=this.proxy,r=Gt(t)?t.includes(".")?Ia(i,t):()=>i[t]:t.bind(i,i);let s;pt(e)?s=e:(s=e.handler,n=e);const o=ii(this),a=Na(r,s.bind(i),n);return o(),a}function Ia(t,e){const n=e.split(".");return()=>{let i=t;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}const Td=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${ve(e)}Modifiers`]||t[`${fe(e)}Modifiers`];function Rd(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||Et;let r=n;const s=e.startsWith("update:"),o=s&&Td(i,e.slice(7));o&&(o.trim&&(r=n.map(h=>Gt(h)?h.trim():h)),o.number&&(r=n.map(er)));let a,l=i[a=Xr(e)]||i[a=Xr(ve(e))];!l&&s&&(l=i[a=Xr(fe(e))]),l&&Ce(l,t,6,r);const c=i[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Ce(c,t,6,r)}}function Oa(t,e,n=!1){const i=e.emitsCache,r=i.get(t);if(r!==void 0)return r;const s=t.emits;let o={},a=!1;if(!pt(t)){const l=c=>{const h=Oa(c,e,!0);h&&(a=!0,$t(o,h))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!s&&!a?(Ot(t)&&i.set(t,null),null):(ft(s)?s.forEach(l=>o[l]=null):$t(o,s),Ot(t)&&i.set(t,o),o)}function br(t,e){return!t||!Yi(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ct(t,e[0].toLowerCase()+e.slice(1))||Ct(t,fe(e))||Ct(t,e))}function w5(){}function Fa(t){const{type:e,vnode:n,proxy:i,withProxy:r,propsOptions:[s],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:p,data:f,setupState:d,ctx:g,inheritAttrs:v}=t,w=pr(t);let x,m;try{if(n.shapeFlag&4){const _=r||i,S=_;x=ke(c.call(S,_,h,p,d,f,g)),m=a}else{const _=e;x=ke(_.length>1?_(p,{attrs:a,slots:o,emit:l}):_(p,null)),m=e.props?a:Ad(a)}}catch(_){ti.length=0,fr(_,t,1),x=pe(an)}let u=x;if(m&&v!==!1){const _=Object.keys(m),{shapeFlag:S}=u;_.length&&S&7&&(s&&_.some(qr)&&(m=Md(m,s)),u=wn(u,m,!1,!0))}return n.dirs&&(u=wn(u,null,!1,!0),u.dirs=u.dirs?u.dirs.concat(n.dirs):n.dirs),n.transition&&ms(u,n.transition),x=u,pr(w),x}const Ad=t=>{let e;for(const n in t)(n==="class"||n==="style"||Yi(n))&&((e||(e={}))[n]=t[n]);return e},Md=(t,e)=>{const n={};for(const i in t)(!qr(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function Nd(t,e,n){const{props:i,children:r,component:s}=t,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?Da(i,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let p=0;p<h.length;p++){const f=h[p];if(o[f]!==i[f]&&!br(c,f))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?Da(i,o,c):!0:!!o;return!1}function Da(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==t[s]&&!br(n,s))return!0}return!1}function Id({vnode:t,parent:e},n){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=n,e=e.parent;else break}}const za=t=>t.__isSuspense;function Od(t,e){e&&e.pendingBranch?ft(t)?e.effects.push(...t):e.effects.push(t):$u(t)}const De=Symbol.for("v-fgt"),yr=Symbol.for("v-txt"),an=Symbol.for("v-cmt"),Es=Symbol.for("v-stc"),ti=[];let ue=null;function re(t=!1){ti.push(ue=t?null:[])}function Fd(){ti.pop(),ue=ti[ti.length-1]||null}let ei=1;function La(t){ei+=t,t<0&&ue&&(ue.hasOnce=!0)}function Ga(t){return t.dynamicChildren=ei>0?ue||pn:null,Fd(),ei>0&&ue&&ue.push(t),t}function de(t,e,n,i,r,s){return Ga(mt(t,e,n,i,r,s,!0))}function Dd(t,e,n,i,r){return Ga(pe(t,e,n,i,r,!0))}function Ua(t){return t?t.__v_isVNode===!0:!1}function ni(t,e){return t.type===e.type&&t.key===e.key}const Ha=({key:t})=>t??null,Sr=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Gt(t)||qt(t)||pt(t)?{i:ge,r:t,k:e,f:!!n}:t:null);function mt(t,e=null,n=null,i=0,r=null,s=t===De?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Ha(e),ref:e&&Sr(e),scopeId:oa,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:ge};return a?(Rs(l,n),s&128&&t.normalize(l)):n&&(l.shapeFlag|=Gt(n)?8:16),ei>0&&!o&&ue&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&ue.push(l),l}const pe=zd;function zd(t,e=null,n=null,i=0,r=null,s=!1){if((!t||t===sd)&&(t=an),Ua(t)){const a=wn(t,e,!0);return n&&Rs(a,n),ei>0&&!s&&ue&&(a.shapeFlag&6?ue[ue.indexOf(t)]=a:ue.push(a)),a.patchFlag=-2,a}if(Yd(t)&&(t=t.__vccOpts),e){e=Ld(e);let{class:a,style:l}=e;a&&!Gt(a)&&(e.class=be(a)),Ot(l)&&(us(l)&&!ft(l)&&(l=$t({},l)),e.style=Te(l))}const o=Gt(t)?1:za(t)?128:Zu(t)?64:Ot(t)?4:pt(t)?2:0;return mt(t,e,n,i,r,o,s,!0)}function Ld(t){return t?us(t)||Sa(t)?$t({},t):t:null}function wn(t,e,n=!1,i=!1){const{props:r,ref:s,patchFlag:o,children:a,transition:l}=t,c=e?Gd(r||{},e):r,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&Ha(c),ref:e&&e.ref?n&&s?ft(s)?s.concat(Sr(e)):[s,Sr(e)]:Sr(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==De?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&wn(t.ssContent),ssFallback:t.ssFallback&&wn(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&i&&ms(h,l.clone(h)),h}function Ts(t=" ",e=0){return pe(yr,null,t,e)}function ln(t="",e=!1){return e?(re(),Dd(an,null,t)):pe(an,null,t)}function ke(t){return t==null||typeof t=="boolean"?pe(an):ft(t)?pe(De,null,t.slice()):Ua(t)?Ze(t):pe(yr,null,String(t))}function Ze(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:wn(t)}function Rs(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(ft(e))n=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),Rs(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!Sa(e)?e._ctx=ge:r===3&&ge&&(ge.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else pt(e)?(e={default:e,_ctx:ge},n=32):(e=String(e),i&64?(n=16,e=[Ts(e)]):n=8);t.children=e,t.shapeFlag|=n}function Gd(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=be([e.class,i.class]));else if(r==="style")e.style=Te([e.style,i.style]);else if(Yi(r)){const s=e[r],o=i[r];o&&s!==o&&!(ft(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function Ee(t,e,n,i=null){Ce(t,e,7,[n,i])}const Ud=va();let Hd=0;function Bd(t,e,n){const i=t.type,r=(e?e.appContext:t.appContext)||Ud,s={uid:Hd++,vnode:t,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ou(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:xa(i,r),emitsOptions:Oa(i,r),emit:null,emitted:null,propsDefaults:Et,inheritAttrs:i.inheritAttrs,ctx:Et,data:Et,props:Et,attrs:Et,slots:Et,refs:Et,setupState:Et,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=Rd.bind(null,s),t.ce&&t.ce(s),s}let ee=null,wr,As;{const t=Po(),e=(n,i)=>{let r;return(r=t[n])||(r=t[n]=[]),r.push(i),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};wr=e("__VUE_INSTANCE_SETTERS__",n=>ee=n),As=e("__VUE_SSR_SETTERS__",n=>xr=n)}const ii=t=>{const e=ee;return wr(t),t.scope.on(),()=>{t.scope.off(),wr(e)}},Ba=()=>{ee&&ee.scope.off(),wr(null)};function Va(t){return t.vnode.shapeFlag&4}let xr=!1;function Vd(t,e=!1,n=!1){e&&As(e);const{props:i,children:r}=t.vnode,s=Va(t);pd(t,i,s,e),bd(t,r,n);const o=s?$d(t,e):void 0;return e&&As(!1),o}function $d(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,od);const{setup:i}=n;if(i){const r=t.setupContext=i.length>1?jd(t):null,s=ii(t);Re();const o=vn(i,t,0,[t.props,r]);if(Ae(),s(),bo(o)){if(Xn(t)||la(t),o.then(Ba,Ba),e)return o.then(a=>{$a(t,a)}).catch(a=>{fr(a,t,0)});t.asyncDep=o}else $a(t,o)}else Wa(t)}function $a(t,e,n){pt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ot(e)&&(t.setupState=Jo(e)),Wa(t)}function Wa(t,e,n){const i=t.type;t.render||(t.render=i.render||we);{const r=ii(t);Re();try{ad(t)}finally{Ae(),r()}}}const Wd={get(t,e){return Xt(t,"get",""),t[e]}};function jd(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Wd),slots:t.slots,emit:t.emit,expose:e}}function Cr(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Jo(Au(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Qn)return Qn[n](t)},has(e,n){return n in e||n in Qn}})):t.proxy}const Zd=/(?:^|[-_])(\w)/g,qd=t=>t.replace(Zd,e=>e.toUpperCase()).replace(/[-_]/g,"");function Kd(t,e=!0){return pt(t)?t.displayName||t.name:t.name||e&&t.__name}function ja(t,e,n=!1){let i=Kd(e);if(!i&&e.__file){const r=e.__file.match(/([^/\\]+)\.\w+$/);r&&(i=r[1])}if(!i&&t&&t.parent){const r=s=>{for(const o in s)if(s[o]===e)return o};i=r(t.components||t.parent.type.components)||r(t.appContext.components)}return i?qd(i):n?"App":"Anonymous"}function Yd(t){return pt(t)&&"__vccOpts"in t}const Nt=(t,e)=>Fu(t,e,xr),Xd="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ms;const Za=typeof window<"u"&&window.trustedTypes;if(Za)try{Ms=Za.createPolicy("vue",{createHTML:t=>t})}catch{}const qa=Ms?t=>Ms.createHTML(t):t=>t,Qd="http://www.w3.org/2000/svg",Jd="http://www.w3.org/1998/Math/MathML",ze=typeof document<"u"?document:null,Ka=ze&&ze.createElement("template"),tf={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const r=e==="svg"?ze.createElementNS(Qd,t):e==="mathml"?ze.createElementNS(Jd,t):n?ze.createElement(t,{is:n}):ze.createElement(t);return t==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:t=>ze.createTextNode(t),createComment:t=>ze.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ze.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,r,s){const o=n?n.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{Ka.innerHTML=qa(i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t);const a=Ka.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},ef=Symbol("_vtc");function nf(t,e,n){const i=t[ef];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Ya=Symbol("_vod"),rf=Symbol("_vsh"),sf=Symbol(""),of=/(^|;)\s*display\s*:/;function af(t,e,n){const i=t.style,r=Gt(n);let s=!1;if(n&&!r){if(e)if(Gt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&Pr(i,a,"")}else for(const o in e)n[o]==null&&Pr(i,o,"");for(const o in n)o==="display"&&(s=!0),Pr(i,o,n[o])}else if(r){if(e!==n){const o=i[sf];o&&(n+=";"+o),i.cssText=n,s=of.test(n)}}else e&&t.removeAttribute("style");Ya in t&&(t[Ya]=s?i.display:"",t[rf]&&(i.display="none"))}const Xa=/\s*!important$/;function Pr(t,e,n){if(ft(n))n.forEach(i=>Pr(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=lf(t,e);Xa.test(n)?t.setProperty(fe(i),n.replace(Xa,""),"important"):t[i]=n}}const Qa=["Webkit","Moz","ms"],Ns={};function lf(t,e){const n=Ns[e];if(n)return n;let i=ve(e);if(i!=="filter"&&i in t)return Ns[e]=i;i=So(i);for(let r=0;r<Qa.length;r++){const s=Qa[r]+i;if(s in t)return Ns[e]=s}return e}const Ja="http://www.w3.org/1999/xlink";function tl(t,e,n,i,r,s=iu(e)){i&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Ja,e.slice(6,e.length)):t.setAttributeNS(Ja,e,n):n==null||s&&!ko(n)?t.removeAttribute(e):t.setAttribute(e,s?"":xe(n)?String(n):n)}function el(t,e,n,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?qa(n):n);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const o=r==="OPTION"?t.getAttribute("value")||"":t.value,a=n==null?t.type==="checkbox"?"on":"":String(n);(o!==a||!("_value"in t))&&(t.value=a),n==null&&t.removeAttribute(e),t._value=n;return}let s=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=ko(n):n==null&&o==="string"?(n="",s=!0):o==="number"&&(n=0,s=!0)}try{t[e]=n}catch{}s&&t.removeAttribute(e)}function cn(t,e,n,i){t.addEventListener(e,n,i)}function cf(t,e,n,i){t.removeEventListener(e,n,i)}const nl=Symbol("_vei");function hf(t,e,n,i,r=null){const s=t[nl]||(t[nl]={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=uf(e);if(i){const c=s[e]=gf(i,r);cn(t,a,c,l)}else o&&(cf(t,a,o,l),s[e]=void 0)}}const il=/(?:Once|Passive|Capture)$/;function uf(t){let e;if(il.test(t)){e={};let i;for(;i=t.match(il);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):fe(t.slice(2)),e]}let Is=0;const df=Promise.resolve(),ff=()=>Is||(df.then(()=>Is=0),Is=Date.now());function gf(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;Ce(pf(i,n.value),e,5,[i])};return n.value=t,n.attached=ff(),n}function pf(t,e){if(ft(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const rl=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,mf=(t,e,n,i,r,s)=>{const o=r==="svg";e==="class"?nf(t,i,o):e==="style"?af(t,n,i):Yi(e)?qr(e)||hf(t,e,n,i,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):_f(t,e,i,o))?(el(t,e,i),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&tl(t,e,i,o,s,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Gt(i))?el(t,ve(e),i):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),tl(t,e,i,o))};function _f(t,e,n,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&rl(e)&&pt(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return rl(e)&&Gt(n)?!1:e in t}const sl={};/*! #__NO_SIDE_EFFECTS__ */function vf(t,e,n){const i=_s(t,e);Qi(i)&&$t(i,e);class r extends Os{constructor(o){super(i,o,n)}}return r.def=i,r}const bf=typeof HTMLElement<"u"?HTMLElement:class{};class Os extends bf{constructor(e,n={},i=hl){super(),this._def=e,this._props=n,this._createApp=i,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&i!==hl?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof Os){this._parent=e;break}this._instance||(this._resolved?(this._setParent(),this._update()):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._instance.provides=e._instance.provides)}disconnectedCallback(){this._connected=!1,gs(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const r of i)this._setAttr(r.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(i,r=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:s,styles:o}=i;let a;if(s&&!ft(s))for(const l in s){const c=s[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=xo(this._props[l])),(a||(a=Object.create(null)))[ve(l)]=!0)}this._numberProps=a,r&&this._resolveProps(i),this.shadowRoot&&this._applyStyles(o),this._mount(i)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(i=>e(this._def=i,!0)):e(this._def)}_mount(e){this._app=this._createApp(e),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const i in n)Ct(this,i)||Object.defineProperty(this,i,{get:()=>We(n[i])})}_resolveProps(e){const{props:n}=e,i=ft(n)?n:Object.keys(n||{});for(const r of Object.keys(this))r[0]!=="_"&&i.includes(r)&&this._setProp(r,this[r]);for(const r of i.map(ve))Object.defineProperty(this,r,{get(){return this._getProp(r)},set(s){this._setProp(r,s,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const n=this.hasAttribute(e);let i=n?this.getAttribute(e):sl;const r=ve(e);n&&this._numberProps&&this._numberProps[r]&&(i=xo(i)),this._setProp(r,i,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,n,i=!0,r=!1){n!==this._props[e]&&(n===sl?delete this._props[e]:(this._props[e]=n,e==="key"&&this._app&&(this._app._ceVNode.key=n)),r&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(fe(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(fe(e),n+""):n||this.removeAttribute(fe(e))))}_update(){kf(this._createVNode(),this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const n=pe(this._def,$t(e,this._props));return this._instance||(n.ce=i=>{this._instance=i,i.ce=this,i.isCE=!0;const r=(s,o)=>{this.dispatchEvent(new CustomEvent(s,Qi(o[0])?$t({detail:o},o[0]):{detail:o}))};i.emit=(s,...o)=>{r(s,o),fe(s)!==s&&r(fe(s),o)},this._setParent()}),n}_applyStyles(e,n){if(!e)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const i=this._nonce;for(let r=e.length-1;r>=0;r--){const s=document.createElement("style");i&&s.setAttribute("nonce",i),s.textContent=e[r],this.shadowRoot.prepend(s)}}_parseSlots(){const e=this._slots={};let n;for(;n=this.firstChild;){const i=n.nodeType===1&&n.getAttribute("slot")||"default";(e[i]||(e[i]=[])).push(n),this.removeChild(n)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let i=0;i<e.length;i++){const r=e[i],s=r.getAttribute("name")||"default",o=this._slots[s],a=r.parentNode;if(o)for(const l of o){if(n&&l.nodeType===1){const c=n+"-s",h=document.createTreeWalker(l,1);l.setAttribute(c,"");let p;for(;p=h.nextNode();)p.setAttribute(c,"")}a.insertBefore(l,r)}else for(;r.firstChild;)a.insertBefore(r.firstChild,r);a.removeChild(r)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}const kr=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ft(e)?n=>tr(e,n):e};function yf(t){t.target.composing=!0}function ol(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const xn=Symbol("_assign"),Sf={created(t,{modifiers:{lazy:e,trim:n,number:i}},r){t[xn]=kr(r);const s=i||r.props&&r.props.type==="number";cn(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),s&&(a=er(a)),t[xn](a)}),n&&cn(t,"change",()=>{t.value=t.value.trim()}),e||(cn(t,"compositionstart",yf),cn(t,"compositionend",ol),cn(t,"change",ol))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:i,trim:r,number:s}},o){if(t[xn]=kr(o),t.composing)return;const a=(s||t.type==="number")&&!/^0\d/.test(t.value)?er(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(i&&e===n||r&&t.value.trim()===l)||(t.value=l))}},wf={deep:!0,created(t,{value:e,modifiers:{number:n}},i){const r=Xi(e);cn(t,"change",()=>{const s=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?er(Er(o)):Er(o));t[xn](t.multiple?r?new Set(s):s:s[0]),t._assigning=!0,gs(()=>{t._assigning=!1})}),t[xn]=kr(i)},mounted(t,{value:e}){al(t,e)},beforeUpdate(t,e,n){t[xn]=kr(n)},updated(t,{value:e}){t._assigning||al(t,e)}};function al(t,e){const n=t.multiple,i=ft(e);if(!(n&&!i&&!Xi(e))){for(let r=0,s=t.options.length;r<s;r++){const o=t.options[r],a=Er(o);if(n)if(i){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=su(e,a)>-1}else o.selected=e.has(a);else if(nr(Er(o),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Er(t){return"_value"in t?t._value:t.value}const xf=["ctrl","shift","alt","meta"],Cf={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>xf.some(n=>t[`${n}Key`]&&!e.includes(n))},qe=(t,e)=>{const n=t._withMods||(t._withMods={}),i=e.join(".");return n[i]||(n[i]=(r,...s)=>{for(let o=0;o<e.length;o++){const a=Cf[e[o]];if(a&&a(r,e))return}return t(r,...s)})},Pf=$t({patchProp:mf},tf);let ll;function cl(){return ll||(ll=Sd(Pf))}const kf=(...t)=>{cl().render(...t)},hl=(...t)=>{const e=cl().createApp(...t),{mount:n}=e;return e.mount=i=>{const r=Tf(i);if(!r)return;const s=e._component;!pt(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,Ef(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function Ef(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Tf(t){return Gt(t)?document.querySelector(t):t}var ul=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Tr={exports:{}},ri={},Fs={},Ds={},dl;function bt(){return dl||(dl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof ul<"u"?ul:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.21",isBrowser:n(),isUnminified:/param/.test(function(r){}.toString()),dblClickWindow:400,getAngle(r){return t.Konva.angleDeg?r*e:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var r;return(r=t.Konva.Transformer)===null||r===void 0?void 0:r.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(r){t.glob.Konva=r}};const i=r=>{t.Konva[r.prototype.getClassName()]=r};t._registerNode=i,t.Konva._injectGlobal(t.Konva)}(Ds)),Ds}var zs={},fl;function Lt(){return fl||(fl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=bt();class n{constructor(_=[1,0,0,1,0,0]){this.dirty=!1,this.m=_&&_.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(_){_.m[0]=this.m[0],_.m[1]=this.m[1],_.m[2]=this.m[2],_.m[3]=this.m[3],_.m[4]=this.m[4],_.m[5]=this.m[5]}point(_){const S=this.m;return{x:S[0]*_.x+S[2]*_.y+S[4],y:S[1]*_.x+S[3]*_.y+S[5]}}translate(_,S){return this.m[4]+=this.m[0]*_+this.m[2]*S,this.m[5]+=this.m[1]*_+this.m[3]*S,this}scale(_,S){return this.m[0]*=_,this.m[1]*=_,this.m[2]*=S,this.m[3]*=S,this}rotate(_){const S=Math.cos(_),P=Math.sin(_),I=this.m[0]*S+this.m[2]*P,b=this.m[1]*S+this.m[3]*P,C=this.m[0]*-P+this.m[2]*S,E=this.m[1]*-P+this.m[3]*S;return this.m[0]=I,this.m[1]=b,this.m[2]=C,this.m[3]=E,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(_,S){const P=this.m[0]+this.m[2]*S,I=this.m[1]+this.m[3]*S,b=this.m[2]+this.m[0]*_,C=this.m[3]+this.m[1]*_;return this.m[0]=P,this.m[1]=I,this.m[2]=b,this.m[3]=C,this}multiply(_){const S=this.m[0]*_.m[0]+this.m[2]*_.m[1],P=this.m[1]*_.m[0]+this.m[3]*_.m[1],I=this.m[0]*_.m[2]+this.m[2]*_.m[3],b=this.m[1]*_.m[2]+this.m[3]*_.m[3],C=this.m[0]*_.m[4]+this.m[2]*_.m[5]+this.m[4],E=this.m[1]*_.m[4]+this.m[3]*_.m[5]+this.m[5];return this.m[0]=S,this.m[1]=P,this.m[2]=I,this.m[3]=b,this.m[4]=C,this.m[5]=E,this}invert(){const _=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),S=this.m[3]*_,P=-this.m[1]*_,I=-this.m[2]*_,b=this.m[0]*_,C=_*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),E=_*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=S,this.m[1]=P,this.m[2]=I,this.m[3]=b,this.m[4]=C,this.m[5]=E,this}getMatrix(){return this.m}decompose(){const _=this.m[0],S=this.m[1],P=this.m[2],I=this.m[3],b=this.m[4],C=this.m[5],E=_*I-S*P,N={x:b,y:C,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(_!=0||S!=0){const D=Math.sqrt(_*_+S*S);N.rotation=S>0?Math.acos(_/D):-Math.acos(_/D),N.scaleX=D,N.scaleY=E/D,N.skewX=(_*P+S*I)/E,N.skewY=0}else if(P!=0||I!=0){const D=Math.sqrt(P*P+I*I);N.rotation=Math.PI/2-(I>0?Math.acos(-P/D):-Math.acos(P/D)),N.scaleX=E/D,N.scaleY=D,N.skewX=0,N.skewY=(_*P+S*I)/E}return N.rotation=t.Util._getRotation(N.rotation),N}}t.Transform=n;const i="[object Array]",r="[object Number]",s="[object String]",o="[object Boolean]",a=Math.PI/180,l=180/Math.PI,c="#",h="",p="0",f="Konva warning: ",d="Konva error: ",g="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},w=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let x=[];const m=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(u){setTimeout(u,60)};t.Util={_isElement(u){return!!(u&&u.nodeType==1)},_isFunction(u){return!!(u&&u.constructor&&u.call&&u.apply)},_isPlainObject(u){return!!u&&u.constructor===Object},_isArray(u){return Object.prototype.toString.call(u)===i},_isNumber(u){return Object.prototype.toString.call(u)===r&&!isNaN(u)&&isFinite(u)},_isString(u){return Object.prototype.toString.call(u)===s},_isBoolean(u){return Object.prototype.toString.call(u)===o},isObject(u){return u instanceof Object},isValidSelector(u){if(typeof u!="string")return!1;const _=u[0];return _==="#"||_==="."||_===_.toUpperCase()},_sign(u){return u===0||u>0?1:-1},requestAnimFrame(u){x.push(u),x.length===1&&m(function(){const _=x;x=[],_.forEach(function(S){S()})})},createCanvasElement(){const u=document.createElement("canvas");try{u.style=u.style||{}}catch{}return u},createImageElement(){return document.createElement("img")},_isInDocument(u){for(;u=u.parentNode;)if(u==document)return!0;return!1},_urlToImage(u,_){const S=t.Util.createImageElement();S.onload=function(){_(S)},S.src=u},_rgbToHex(u,_,S){return(16777216+(u<<16)+(_<<8)+S).toString(16).slice(1)},_hexToRgb(u){u=u.replace(c,h);const _=parseInt(u,16);return{r:_>>16&255,g:_>>8&255,b:_&255}},getRandomColor(){let u=(Math.random()*16777215<<0).toString(16);for(;u.length<6;)u=p+u;return c+u},getRGB(u){let _;return u in v?(_=v[u],{r:_[0],g:_[1],b:_[2]}):u[0]===c?this._hexToRgb(u.substring(1)):u.substr(0,4)===g?(_=w.exec(u.replace(/ /g,"")),{r:parseInt(_[1],10),g:parseInt(_[2],10),b:parseInt(_[3],10)}):{r:0,g:0,b:0}},colorToRGBA(u){return u=u||"black",t.Util._namedColorToRBA(u)||t.Util._hex3ColorToRGBA(u)||t.Util._hex4ColorToRGBA(u)||t.Util._hex6ColorToRGBA(u)||t.Util._hex8ColorToRGBA(u)||t.Util._rgbColorToRGBA(u)||t.Util._rgbaColorToRGBA(u)||t.Util._hslColorToRGBA(u)},_namedColorToRBA(u){const _=v[u.toLowerCase()];return _?{r:_[0],g:_[1],b:_[2],a:1}:null},_rgbColorToRGBA(u){if(u.indexOf("rgb(")===0){u=u.match(/rgb\(([^)]+)\)/)[1];const _=u.split(/ *, */).map(Number);return{r:_[0],g:_[1],b:_[2],a:1}}},_rgbaColorToRGBA(u){if(u.indexOf("rgba(")===0){u=u.match(/rgba\(([^)]+)\)/)[1];const _=u.split(/ *, */).map((S,P)=>S.slice(-1)==="%"?P===3?parseInt(S)/100:parseInt(S)/100*255:Number(S));return{r:_[0],g:_[1],b:_[2],a:_[3]}}},_hex8ColorToRGBA(u){if(u[0]==="#"&&u.length===9)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:parseInt(u.slice(7,9),16)/255}},_hex6ColorToRGBA(u){if(u[0]==="#"&&u.length===7)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:1}},_hex4ColorToRGBA(u){if(u[0]==="#"&&u.length===5)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:parseInt(u[4]+u[4],16)/255}},_hex3ColorToRGBA(u){if(u[0]==="#"&&u.length===4)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:1}},_hslColorToRGBA(u){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(u)){const[_,...S]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(u),P=Number(S[0])/360,I=Number(S[1])/100,b=Number(S[2])/100;let C,E,N;if(I===0)return N=b*255,{r:Math.round(N),g:Math.round(N),b:Math.round(N),a:1};b<.5?C=b*(1+I):C=b+I-b*I;const D=2*b-C,G=[0,0,0];for(let U=0;U<3;U++)E=P+.3333333333333333*-(U-1),E<0&&E++,E>1&&E--,6*E<1?N=D+(C-D)*6*E:2*E<1?N=C:3*E<2?N=D+(C-D)*(.6666666666666666-E)*6:N=D,G[U]=N*255;return{r:Math.round(G[0]),g:Math.round(G[1]),b:Math.round(G[2]),a:1}}},haveIntersection(u,_){return!(_.x>u.x+u.width||_.x+_.width<u.x||_.y>u.y+u.height||_.y+_.height<u.y)},cloneObject(u){const _={};for(const S in u)this._isPlainObject(u[S])?_[S]=this.cloneObject(u[S]):this._isArray(u[S])?_[S]=this.cloneArray(u[S]):_[S]=u[S];return _},cloneArray(u){return u.slice(0)},degToRad(u){return u*a},radToDeg(u){return u*l},_degToRad(u){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(u)},_radToDeg(u){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(u)},_getRotation(u){return e.Konva.angleDeg?t.Util.radToDeg(u):u},_capitalize(u){return u.charAt(0).toUpperCase()+u.slice(1)},throw(u){throw new Error(d+u)},error(u){console.error(d+u)},warn(u){e.Konva.showWarnings&&console.warn(f+u)},each(u,_){for(const S in u)_(S,u[S])},_inRange(u,_,S){return _<=u&&u<S},_getProjectionToSegment(u,_,S,P,I,b){let C,E,N;const D=(u-S)*(u-S)+(_-P)*(_-P);if(D==0)C=u,E=_,N=(I-S)*(I-S)+(b-P)*(b-P);else{const G=((I-u)*(S-u)+(b-_)*(P-_))/D;G<0?(C=u,E=_,N=(u-I)*(u-I)+(_-b)*(_-b)):G>1?(C=S,E=P,N=(S-I)*(S-I)+(P-b)*(P-b)):(C=u+G*(S-u),E=_+G*(P-_),N=(C-I)*(C-I)+(E-b)*(E-b))}return[C,E,N]},_getProjectionToLine(u,_,S){const P=t.Util.cloneObject(u);let I=Number.MAX_VALUE;return _.forEach(function(b,C){if(!S&&C===_.length-1)return;const E=_[(C+1)%_.length],N=t.Util._getProjectionToSegment(b.x,b.y,E.x,E.y,u.x,u.y),D=N[0],G=N[1],U=N[2];U<I&&(P.x=D,P.y=G,I=U)}),P},_prepareArrayForTween(u,_,S){const P=[],I=[];if(u.length>_.length){const C=_;_=u,u=C}for(let C=0;C<u.length;C+=2)P.push({x:u[C],y:u[C+1]});for(let C=0;C<_.length;C+=2)I.push({x:_[C],y:_[C+1]});const b=[];return I.forEach(function(C){const E=t.Util._getProjectionToLine(C,P,S);b.push(E.x),b.push(E.y)}),b},_prepareToStringify(u){let _;u.visitedByCircularReferenceRemoval=!0;for(const S in u)if(u.hasOwnProperty(S)&&u[S]&&typeof u[S]=="object"){if(_=Object.getOwnPropertyDescriptor(u,S),u[S].visitedByCircularReferenceRemoval||t.Util._isElement(u[S]))if(_.configurable)delete u[S];else return null;else if(t.Util._prepareToStringify(u[S])===null)if(_.configurable)delete u[S];else return null}return delete u.visitedByCircularReferenceRemoval,u},_assign(u,_){for(const S in _)u[S]=_[S];return u},_getFirstPointerId(u){return u.touches?u.changedTouches[0].identifier:u.pointerId||999},releaseCanvas(...u){e.Konva.releaseCanvasOnDestroy&&u.forEach(_=>{_.width=0,_.height=0})},drawRoundedRectPath(u,_,S,P){let I=0,b=0,C=0,E=0;typeof P=="number"?I=b=C=E=Math.min(P,_/2,S/2):(I=Math.min(P[0]||0,_/2,S/2),b=Math.min(P[1]||0,_/2,S/2),E=Math.min(P[2]||0,_/2,S/2),C=Math.min(P[3]||0,_/2,S/2)),u.moveTo(I,0),u.lineTo(_-b,0),u.arc(_-b,b,b,Math.PI*3/2,0,!1),u.lineTo(_,S-E),u.arc(_-E,S-E,E,0,Math.PI/2,!1),u.lineTo(C,S),u.arc(C,S-C,C,Math.PI/2,Math.PI,!1),u.lineTo(0,I),u.arc(I,I,I,Math.PI,Math.PI*3/2,!1)}}}(zs)),zs}var si={},Le={},Ge={},gl;function pl(){if(gl)return Ge;gl=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.HitContext=Ge.SceneContext=Ge.Context=void 0;const t=Lt(),e=bt();function n(x){const m=[],u=x.length,_=t.Util;for(let S=0;S<u;S++){let P=x[S];_._isNumber(P)?P=Math.round(P*1e3)/1e3:_._isString(P)||(P=P+""),m.push(P)}return m}const i=",",r="(",s=")",o="([",a="])",l=";",c="()",h="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],f=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],d=100;let g=class{constructor(m){this.canvas=m,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(m){m.fillEnabled()&&this._fill(m)}_fill(m){}strokeShape(m){m.hasStroke()&&this._stroke(m)}_stroke(m){}fillStrokeShape(m){m.attrs.fillAfterStrokeEnabled?(this.strokeShape(m),this.fillShape(m)):(this.fillShape(m),this.strokeShape(m))}getTrace(m,u){let _=this.traceArr,S=_.length,P="",I,b,C,E;for(I=0;I<S;I++)b=_[I],C=b.method,C?(E=b.args,P+=C,m?P+=c:t.Util._isArray(E[0])?P+=o+E.join(i)+a:(u&&(E=E.map(N=>typeof N=="number"?Math.floor(N):N)),P+=r+E.join(i)+s)):(P+=b.property,m||(P+=h+b.val)),P+=l;return P}clearTrace(){this.traceArr=[]}_trace(m){let u=this.traceArr,_;u.push(m),_=u.length,_>=d&&u.shift()}reset(){const m=this.getCanvas().getPixelRatio();this.setTransform(1*m,0,0,1*m,0,0)}getCanvas(){return this.canvas}clear(m){const u=this.getCanvas();m?this.clearRect(m.x||0,m.y||0,m.width||0,m.height||0):this.clearRect(0,0,u.getWidth()/u.pixelRatio,u.getHeight()/u.pixelRatio)}_applyLineCap(m){const u=m.attrs.lineCap;u&&this.setAttr("lineCap",u)}_applyOpacity(m){const u=m.getAbsoluteOpacity();u!==1&&this.setAttr("globalAlpha",u)}_applyLineJoin(m){const u=m.attrs.lineJoin;u&&this.setAttr("lineJoin",u)}setAttr(m,u){this._context[m]=u}arc(m,u,_,S,P,I){this._context.arc(m,u,_,S,P,I)}arcTo(m,u,_,S,P){this._context.arcTo(m,u,_,S,P)}beginPath(){this._context.beginPath()}bezierCurveTo(m,u,_,S,P,I){this._context.bezierCurveTo(m,u,_,S,P,I)}clearRect(m,u,_,S){this._context.clearRect(m,u,_,S)}clip(...m){this._context.clip.apply(this._context,m)}closePath(){this._context.closePath()}createImageData(m,u){const _=arguments;if(_.length===2)return this._context.createImageData(m,u);if(_.length===1)return this._context.createImageData(m)}createLinearGradient(m,u,_,S){return this._context.createLinearGradient(m,u,_,S)}createPattern(m,u){return this._context.createPattern(m,u)}createRadialGradient(m,u,_,S,P,I){return this._context.createRadialGradient(m,u,_,S,P,I)}drawImage(m,u,_,S,P,I,b,C,E){const N=arguments,D=this._context;N.length===3?D.drawImage(m,u,_):N.length===5?D.drawImage(m,u,_,S,P):N.length===9&&D.drawImage(m,u,_,S,P,I,b,C,E)}ellipse(m,u,_,S,P,I,b,C){this._context.ellipse(m,u,_,S,P,I,b,C)}isPointInPath(m,u,_,S){return _?this._context.isPointInPath(_,m,u,S):this._context.isPointInPath(m,u,S)}fill(...m){this._context.fill.apply(this._context,m)}fillRect(m,u,_,S){this._context.fillRect(m,u,_,S)}strokeRect(m,u,_,S){this._context.strokeRect(m,u,_,S)}fillText(m,u,_,S){S?this._context.fillText(m,u,_,S):this._context.fillText(m,u,_)}measureText(m){return this._context.measureText(m)}getImageData(m,u,_,S){return this._context.getImageData(m,u,_,S)}lineTo(m,u){this._context.lineTo(m,u)}moveTo(m,u){this._context.moveTo(m,u)}rect(m,u,_,S){this._context.rect(m,u,_,S)}roundRect(m,u,_,S,P){this._context.roundRect(m,u,_,S,P)}putImageData(m,u,_){this._context.putImageData(m,u,_)}quadraticCurveTo(m,u,_,S){this._context.quadraticCurveTo(m,u,_,S)}restore(){this._context.restore()}rotate(m){this._context.rotate(m)}save(){this._context.save()}scale(m,u){this._context.scale(m,u)}setLineDash(m){this._context.setLineDash?this._context.setLineDash(m):"mozDash"in this._context?this._context.mozDash=m:"webkitLineDash"in this._context&&(this._context.webkitLineDash=m)}getLineDash(){return this._context.getLineDash()}setTransform(m,u,_,S,P,I){this._context.setTransform(m,u,_,S,P,I)}stroke(m){m?this._context.stroke(m):this._context.stroke()}strokeText(m,u,_,S){this._context.strokeText(m,u,_,S)}transform(m,u,_,S,P,I){this._context.transform(m,u,_,S,P,I)}translate(m,u){this._context.translate(m,u)}_enableTrace(){let m=this,u=p.length,_=this.setAttr,S,P;const I=function(b){let C=m[b],E;m[b]=function(){return P=n(Array.prototype.slice.call(arguments,0)),E=C.apply(m,arguments),m._trace({method:b,args:P}),E}};for(S=0;S<u;S++)I(p[S]);m.setAttr=function(){_.apply(m,arguments);const b=arguments[0];let C=arguments[1];(b==="shadowOffsetX"||b==="shadowOffsetY"||b==="shadowBlur")&&(C=C/this.canvas.getPixelRatio()),m._trace({property:b,val:C})}}_applyGlobalCompositeOperation(m){const u=m.attrs.globalCompositeOperation;!u||u==="source-over"||this.setAttr("globalCompositeOperation",u)}};Ge.Context=g,f.forEach(function(x){Object.defineProperty(g.prototype,x,{get(){return this._context[x]},set(m){this._context[x]=m}})});class v extends g{constructor(m,{willReadFrequently:u=!1}={}){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:u})}_fillColor(m){const u=m.fill();this.setAttr("fillStyle",u),m._fillFunc(this)}_fillPattern(m){this.setAttr("fillStyle",m._getFillPattern()),m._fillFunc(this)}_fillLinearGradient(m){const u=m._getLinearGradient();u&&(this.setAttr("fillStyle",u),m._fillFunc(this))}_fillRadialGradient(m){const u=m._getRadialGradient();u&&(this.setAttr("fillStyle",u),m._fillFunc(this))}_fill(m){const u=m.fill(),_=m.getFillPriority();if(u&&_==="color"){this._fillColor(m);return}const S=m.getFillPatternImage();if(S&&_==="pattern"){this._fillPattern(m);return}const P=m.getFillLinearGradientColorStops();if(P&&_==="linear-gradient"){this._fillLinearGradient(m);return}const I=m.getFillRadialGradientColorStops();if(I&&_==="radial-gradient"){this._fillRadialGradient(m);return}u?this._fillColor(m):S?this._fillPattern(m):P?this._fillLinearGradient(m):I&&this._fillRadialGradient(m)}_strokeLinearGradient(m){const u=m.getStrokeLinearGradientStartPoint(),_=m.getStrokeLinearGradientEndPoint(),S=m.getStrokeLinearGradientColorStops(),P=this.createLinearGradient(u.x,u.y,_.x,_.y);if(S){for(let I=0;I<S.length;I+=2)P.addColorStop(S[I],S[I+1]);this.setAttr("strokeStyle",P)}}_stroke(m){const u=m.dash(),_=m.getStrokeScaleEnabled();if(m.hasStroke()){if(!_){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(m),u&&m.dashEnabled()&&(this.setLineDash(u),this.setAttr("lineDashOffset",m.dashOffset())),this.setAttr("lineWidth",m.strokeWidth()),m.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),m.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(m):this.setAttr("strokeStyle",m.stroke()),m._strokeFunc(this),_||this.restore()}}_applyShadow(m){var u,_,S;const P=(u=m.getShadowRGBA())!==null&&u!==void 0?u:"black",I=(_=m.getShadowBlur())!==null&&_!==void 0?_:5,b=(S=m.getShadowOffset())!==null&&S!==void 0?S:{x:0,y:0},C=m.getAbsoluteScale(),E=this.canvas.getPixelRatio(),N=C.x*E,D=C.y*E;this.setAttr("shadowColor",P),this.setAttr("shadowBlur",I*Math.min(Math.abs(N),Math.abs(D))),this.setAttr("shadowOffsetX",b.x*N),this.setAttr("shadowOffsetY",b.y*D)}}Ge.SceneContext=v;class w extends g{constructor(m){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:!0})}_fill(m){this.save(),this.setAttr("fillStyle",m.colorKey),m._fillFuncHit(this),this.restore()}strokeShape(m){m.hasHitStroke()&&this._stroke(m)}_stroke(m){if(m.hasHitStroke()){const u=m.getStrokeScaleEnabled();if(!u){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(m);const _=m.hitStrokeWidth(),S=_==="auto"?m.strokeWidth():_;this.setAttr("lineWidth",S),this.setAttr("strokeStyle",m.colorKey),m._strokeFuncHit(this),u||this.restore()}}}return Ge.HitContext=w,Ge}var ml;function Rr(){if(ml)return Le;ml=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.HitCanvas=Le.SceneCanvas=Le.Canvas=void 0;const t=Lt(),e=pl(),n=bt();let i;function r(){if(i)return i;const l=t.Util.createCanvasElement(),c=l.getContext("2d");return i=function(){const h=n.Konva._global.devicePixelRatio||1,p=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;return h/p}(),t.Util.releaseCanvas(l),i}let s=class{constructor(c){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const p=(c||{}).pixelRatio||n.Konva.pixelRatio||r();this.pixelRatio=p,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(c){const h=this.pixelRatio;this.pixelRatio=c,this.setSize(this.getWidth()/h,this.getHeight()/h)}setWidth(c){this.width=this._canvas.width=c*this.pixelRatio,this._canvas.style.width=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}setHeight(c){this.height=this._canvas.height=c*this.pixelRatio,this._canvas.style.height=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}getWidth(){return this.width}getHeight(){return this.height}setSize(c,h){this.setWidth(c||0),this.setHeight(h||0)}toDataURL(c,h){try{return this._canvas.toDataURL(c,h)}catch{try{return this._canvas.toDataURL()}catch(f){return t.Util.error("Unable to get data URL. "+f.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Le.Canvas=s;class o extends s{constructor(c={width:0,height:0,willReadFrequently:!1}){super(c),this.context=new e.SceneContext(this,{willReadFrequently:c.willReadFrequently}),this.setSize(c.width,c.height)}}Le.SceneCanvas=o;class a extends s{constructor(c={width:0,height:0}){super(c),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(c.width,c.height)}}return Le.HitCanvas=a,Le}var Ls={},_l;function Gs(){return _l||(_l=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=bt(),n=Lt();t.DD={get isDragging(){let i=!1;return t.DD._dragElements.forEach(r=>{r.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return t.DD._dragElements.forEach(r=>{i=r.node}),i},_dragElements:new Map,_drag(i){const r=[];t.DD._dragElements.forEach((s,o)=>{const{node:a}=s,l=a.getStage();l.setPointersPositions(i),s.pointerId===void 0&&(s.pointerId=n.Util._getFirstPointerId(i));const c=l._changedPointerPositions.find(h=>h.id===s.pointerId);if(c){if(s.dragStatus!=="dragging"){const h=a.dragDistance();if(Math.max(Math.abs(c.x-s.startPointerPos.x),Math.abs(c.y-s.startPointerPos.y))<h||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,s),r.push(a)}}),r.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:i},!0)})},_endDragBefore(i){const r=[];t.DD._dragElements.forEach(s=>{const{node:o}=s,a=o.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(h=>h.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const c=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;c&&r.indexOf(c)===-1&&r.push(c)}),r.forEach(s=>{s.draw()})},_endDragAfter(i){t.DD._dragElements.forEach((r,s)=>{r.dragStatus==="stopped"&&r.node.fire("dragend",{type:"dragend",target:r.node,evt:i},!0),r.dragStatus!=="dragging"&&t.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))}(Ls)),Ls}var Us={},se={},vl;function St(){if(vl)return se;vl=1,Object.defineProperty(se,"__esModule",{value:!0}),se.RGBComponent=i,se.alphaComponent=r,se.getNumberValidator=s,se.getNumberOrArrayOfNumbersValidator=o,se.getNumberOrAutoValidator=a,se.getStringValidator=l,se.getStringOrGradientValidator=c,se.getFunctionValidator=h,se.getNumberArrayValidator=p,se.getBooleanValidator=f,se.getComponentValidator=d;const t=bt(),e=Lt();function n(g){return e.Util._isString(g)?'"'+g+'"':Object.prototype.toString.call(g)==="[object Number]"||e.Util._isBoolean(g)?g:Object.prototype.toString.call(g)}function i(g){return g>255?255:g<0?0:Math.round(g)}function r(g){return g>1?1:g<1e-4?1e-4:g}function s(){if(t.Konva.isUnminified)return function(g,v){return e.Util._isNumber(g)||e.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a number.'),g}}function o(g){if(t.Konva.isUnminified)return function(v,w){let x=e.Util._isNumber(v),m=e.Util._isArray(v)&&v.length==g;return!x&&!m&&e.Util.warn(n(v)+' is a not valid value for "'+w+'" attribute. The value should be a number or Array<number>('+g+")"),v}}function a(){if(t.Konva.isUnminified)return function(g,v){return e.Util._isNumber(g)||g==="auto"||e.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a number or "auto".'),g}}function l(){if(t.Konva.isUnminified)return function(g,v){return e.Util._isString(g)||e.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a string.'),g}}function c(){if(t.Konva.isUnminified)return function(g,v){const w=e.Util._isString(g),x=Object.prototype.toString.call(g)==="[object CanvasGradient]"||g&&g.addColorStop;return w||x||e.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a string or a native gradient.'),g}}function h(){if(t.Konva.isUnminified)return function(g,v){return e.Util._isFunction(g)||e.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a function.'),g}}function p(){if(t.Konva.isUnminified)return function(g,v){const w=Int8Array?Object.getPrototypeOf(Int8Array):null;return w&&g instanceof w||(e.Util._isArray(g)?g.forEach(function(x){e.Util._isNumber(x)||e.Util.warn('"'+v+'" attribute has non numeric element '+x+". Make sure that all elements are numbers.")}):e.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a array of numbers.')),g}}function f(){if(t.Konva.isUnminified)return function(g,v){return g===!0||g===!1||e.Util.warn(n(g)+' is a not valid value for "'+v+'" attribute. The value should be a boolean.'),g}}function d(g){if(t.Konva.isUnminified)return function(v,w){return v==null||e.Util.isObject(v)||e.Util.warn(n(v)+' is a not valid value for "'+w+'" attribute. The value should be an object with properties '+g),v}}return se}var bl;function yt(){return bl||(bl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Lt(),n=St(),i="get",r="set";t.Factory={addGetterSetter(s,o,a,l,c){t.Factory.addGetter(s,o,a),t.Factory.addSetter(s,o,l,c),t.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,a){const l=i+e.Util._capitalize(o);s.prototype[l]=s.prototype[l]||function(){const c=this.attrs[o];return c===void 0?a:c}},addSetter(s,o,a,l){const c=r+e.Util._capitalize(o);s.prototype[c]||t.Factory.overWriteSetter(s,o,a,l)},overWriteSetter(s,o,a,l){const c=r+e.Util._capitalize(o);s.prototype[c]=function(h){return a&&h!==void 0&&h!==null&&(h=a.call(this,h,o)),this._setAttr(o,h),l&&l.call(this),this}},addComponentsGetterSetter(s,o,a,l,c){const h=a.length,p=e.Util._capitalize,f=i+p(o),d=r+p(o);s.prototype[f]=function(){const v={};for(let w=0;w<h;w++){const x=a[w];v[x]=this.getAttr(o+p(x))}return v};const g=(0,n.getComponentValidator)(a);s.prototype[d]=function(v){const w=this.attrs[o];l&&(v=l.call(this,v,o)),g&&g.call(this,v,o);for(const x in v)v.hasOwnProperty(x)&&this._setAttr(o+p(x),v[x]);return v||a.forEach(x=>{this._setAttr(o+p(x),void 0)}),this._fireChangeEvent(o,w,v),c&&c.call(this),this},t.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const a=e.Util._capitalize(o),l=r+a,c=i+a;s.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(s,o,a,l){e.Util.error("Adding deprecated "+o);const c=i+e.Util._capitalize(o),h=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[c]=function(){e.Util.error(h);const p=this.attrs[o];return p===void 0?a:p},t.Factory.addSetter(s,o,l,function(){e.Util.error(h)}),t.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(a,l){const c=s.prototype[l],h=i+e.Util._capitalize(a),p=r+e.Util._capitalize(a);function f(){c.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}s.prototype[a]=f,s.prototype[h]=f,s.prototype[p]=f})},afterSetFilter(){this._filterUpToDate=!1}}}(Us)),Us}var yl;function Ht(){if(yl)return si;yl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.Node=void 0;const t=Rr(),e=Gs(),n=yt(),i=bt(),r=Lt(),s=St(),o="absoluteOpacity",a="allEventListeners",l="absoluteTransform",c="absoluteScale",h="canvas",p="Change",f="children",d="konva",g="listening",v="mouseenter",w="mouseleave",x="pointerenter",m="pointerleave",u="touchenter",_="touchleave",S="set",P="Shape",I=" ",b="stage",C="transform",E="Stage",N="visible",D=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(I);let G=1,U=class _o{constructor(y){this._id=G++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(y),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(y){(y===C||y===l)&&this._cache.get(y)?this._cache.get(y).dirty=!0:y?this._cache.delete(y):this._cache.clear()}_getCache(y,k){let M=this._cache.get(y);return(M===void 0||(y===C||y===l)&&M.dirty===!0)&&(M=k.call(this),this._cache.set(y,M)),M}_calculate(y,k,M){if(!this._attachedDepsListeners.get(y)){const R=k.map(F=>F+"Change.konva").join(I);this.on(R,()=>{this._clearCache(y)}),this._attachedDepsListeners.set(y,!0)}return this._getCache(y,M)}_getCanvasCache(){return this._cache.get(h)}_clearSelfAndDescendantCache(y){this._clearCache(y),y===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(h)){const{scene:y,filter:k,hit:M,buffer:R}=this._cache.get(h);r.Util.releaseCanvas(y,k,M,R),this._cache.delete(h)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(y){const k=y||{};let M={};(k.x===void 0||k.y===void 0||k.width===void 0||k.height===void 0)&&(M=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let R=Math.ceil(k.width||M.width),F=Math.ceil(k.height||M.height),$=k.pixelRatio,L=k.x===void 0?Math.floor(M.x):k.x,Y=k.y===void 0?Math.floor(M.y):k.y,X=k.offset||0,H=k.drawBorder||!1,A=k.hitCanvasPixelRatio||1;if(!R||!F){r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const B=Math.abs(Math.round(M.x)-L)>.5?1:0,et=Math.abs(Math.round(M.y)-Y)>.5?1:0;R+=X*2+B,F+=X*2+et,L-=X,Y-=X;const st=new t.SceneCanvas({pixelRatio:$,width:R,height:F}),ct=new t.SceneCanvas({pixelRatio:$,width:0,height:0,willReadFrequently:!0}),T=new t.HitCanvas({pixelRatio:A,width:R,height:F}),O=st.getContext(),V=T.getContext(),W=new t.SceneCanvas({width:st.width/st.pixelRatio+Math.abs(L),height:st.height/st.pixelRatio+Math.abs(Y),pixelRatio:st.pixelRatio}),K=W.getContext();return T.isCache=!0,st.isCache=!0,this._cache.delete(h),this._filterUpToDate=!1,k.imageSmoothingEnabled===!1&&(st.getContext()._context.imageSmoothingEnabled=!1,ct.getContext()._context.imageSmoothingEnabled=!1),O.save(),V.save(),K.save(),O.translate(-L,-Y),V.translate(-L,-Y),K.translate(-L,-Y),W.x=L,W.y=Y,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this.drawScene(st,this,W),this.drawHit(T,this),this._isUnderCache=!1,O.restore(),V.restore(),H&&(O.save(),O.beginPath(),O.rect(0,0,R,F),O.closePath(),O.setAttr("strokeStyle","red"),O.setAttr("lineWidth",5),O.stroke(),O.restore()),this._cache.set(h,{scene:st,filter:ct,hit:T,buffer:W,x:L,y:Y}),this._requestDraw(),this}isCached(){return this._cache.has(h)}getClientRect(y){throw new Error('abstract "getClientRect" method call')}_transformedRect(y,k){const M=[{x:y.x,y:y.y},{x:y.x+y.width,y:y.y},{x:y.x+y.width,y:y.y+y.height},{x:y.x,y:y.y+y.height}];let R=1/0,F=1/0,$=-1/0,L=-1/0;const Y=this.getAbsoluteTransform(k);return M.forEach(function(X){const H=Y.point(X);R===void 0&&(R=$=H.x,F=L=H.y),R=Math.min(R,H.x),F=Math.min(F,H.y),$=Math.max($,H.x),L=Math.max(L,H.y)}),{x:R,y:F,width:$-R,height:L-F}}_drawCachedSceneCanvas(y){y.save(),y._applyOpacity(this),y._applyGlobalCompositeOperation(this);const k=this._getCanvasCache();y.translate(k.x,k.y);const M=this._getCachedSceneCanvas(),R=M.pixelRatio;y.drawImage(M._canvas,0,0,M.width/R,M.height/R),y.restore()}_drawCachedHitCanvas(y){const k=this._getCanvasCache(),M=k.hit;y.save(),y.translate(k.x,k.y),y.drawImage(M._canvas,0,0,M.width/M.pixelRatio,M.height/M.pixelRatio),y.restore()}_getCachedSceneCanvas(){let y=this.filters(),k=this._getCanvasCache(),M=k.scene,R=k.filter,F=R.getContext(),$,L,Y,X;if(y){if(!this._filterUpToDate){const H=M.pixelRatio;R.setSize(M.width/M.pixelRatio,M.height/M.pixelRatio);try{for($=y.length,F.clear(),F.drawImage(M._canvas,0,0,M.getWidth()/H,M.getHeight()/H),L=F.getImageData(0,0,R.getWidth(),R.getHeight()),Y=0;Y<$;Y++){if(X=y[Y],typeof X!="function"){r.Util.error("Filter should be type of function, but got "+typeof X+" instead. Please check correct filters");continue}X.call(this,L),F.putImageData(L,0,0)}}catch(A){r.Util.error("Unable to apply filter. "+A.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return R}return M}on(y,k){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const M=y.split(I);for(let R=0;R<M.length;R++){const $=M[R].split("."),L=$[0],Y=$[1]||"";this.eventListeners[L]||(this.eventListeners[L]=[]),this.eventListeners[L].push({name:Y,handler:k})}return this}off(y,k){let M=(y||"").split(I),R=M.length,F,$,L,Y,X,H;if(this._cache&&this._cache.delete(a),!y)for($ in this.eventListeners)this._off($);for(F=0;F<R;F++)if(L=M[F],Y=L.split("."),X=Y[0],H=Y[1],X)this.eventListeners[X]&&this._off(X,H,k);else for($ in this.eventListeners)this._off($,H,k);return this}dispatchEvent(y){const k={target:this,type:y.type,evt:y};return this.fire(y.type,k),this}addEventListener(y,k){return this.on(y,function(M){k.call(this,M.evt)}),this}removeEventListener(y){return this.off(y),this}_delegate(y,k,M){const R=this;this.on(y,function(F){const $=F.target.findAncestors(k,!0,R);for(let L=0;L<$.length;L++)F=r.Util.cloneObject(F),F.currentTarget=$[L],M.call($[L],F)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(b),this._clearSelfAndDescendantCache(N),this._clearSelfAndDescendantCache(g)}_remove(){this._clearCaches();const y=this.getParent();y&&y.children&&(y.children.splice(this.index,1),y._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(y){const k="get"+r.Util._capitalize(y);return r.Util._isFunction(this[k])?this[k]():this.attrs[y]}getAncestors(){let y=this.getParent(),k=[];for(;y;)k.push(y),y=y.getParent();return k}getAttrs(){return this.attrs||{}}setAttrs(y){return this._batchTransformChanges(()=>{let k,M;if(!y)return this;for(k in y)k!==f&&(M=S+r.Util._capitalize(k),r.Util._isFunction(this[M])?this[M](y[k]):this._setAttr(k,y[k]))}),this}isListening(){return this._getCache(g,this._isListening)}_isListening(y){if(!this.listening())return!1;const M=this.getParent();return M&&M!==y&&this!==y?M._isListening(y):!0}isVisible(){return this._getCache(N,this._isVisible)}_isVisible(y){if(!this.visible())return!1;const M=this.getParent();return M&&M!==y&&this!==y?M._isVisible(y):!0}shouldDrawHit(y,k=!1){if(y)return this._isVisible(y)&&this._isListening(y);const M=this.getLayer();let R=!1;e.DD._dragElements.forEach($=>{$.dragStatus==="dragging"&&($.node.nodeType==="Stage"||$.node.getLayer()===M)&&(R=!0)});const F=!k&&!i.Konva.hitOnDragEnabled&&(R||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!F}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let y=this.getDepth(),k=this,M=0,R,F,$,L;function Y(H){for(R=[],F=H.length,$=0;$<F;$++)L=H[$],M++,L.nodeType!==P&&(R=R.concat(L.getChildren().slice())),L._id===k._id&&($=F);R.length>0&&R[0].getDepth()<=y&&Y(R)}const X=this.getStage();return k.nodeType!==E&&X&&Y(X.getChildren()),M}getDepth(){let y=0,k=this.parent;for(;k;)y++,k=k.parent;return y}_batchTransformChanges(y){this._batchingTransformChange=!0,y(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(C),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(y){return this._batchTransformChanges(()=>{this.x(y.x),this.y(y.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const y=this.getStage();if(!y)return null;const k=y.getPointerPosition();if(!k)return null;const M=this.getAbsoluteTransform().copy();return M.invert(),M.point(k)}getAbsolutePosition(y){let k=!1,M=this.parent;for(;M;){if(M.isCached()){k=!0;break}M=M.parent}k&&!y&&(y=!0);const R=this.getAbsoluteTransform(y).getMatrix(),F=new r.Transform,$=this.offset();return F.m=R.slice(),F.translate($.x,$.y),F.getTranslation()}setAbsolutePosition(y){const{x:k,y:M,...R}=this._clearTransform();this.attrs.x=k,this.attrs.y=M,this._clearCache(C);const F=this._getAbsoluteTransform().copy();return F.invert(),F.translate(y.x,y.y),y={x:this.attrs.x+F.getTranslation().x,y:this.attrs.y+F.getTranslation().y},this._setTransform(R),this.setPosition({x:y.x,y:y.y}),this._clearCache(C),this._clearSelfAndDescendantCache(l),this}_setTransform(y){let k;for(k in y)this.attrs[k]=y[k]}_clearTransform(){const y={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,y}move(y){let k=y.x,M=y.y,R=this.x(),F=this.y();return k!==void 0&&(R+=k),M!==void 0&&(F+=M),this.setPosition({x:R,y:F}),this}_eachAncestorReverse(y,k){let M=[],R=this.getParent(),F,$;if(!(k&&k._id===this._id)){for(M.unshift(this);R&&(!k||R._id!==k._id);)M.unshift(R),R=R.parent;for(F=M.length,$=0;$<F;$++)y(M[$])}}rotate(y){return this.rotation(this.rotation()+y),this}moveToTop(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const y=this.index,k=this.parent.getChildren().length;return y<k-1?(this.parent.children.splice(y,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;const y=this.index,k=this.parent.getChildren().length;return y<k-1?(this.parent.children.splice(y,1),this.parent.children.splice(y+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;const y=this.index;return y>0?(this.parent.children.splice(y,1),this.parent.children.splice(y-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const y=this.index;return y>0?(this.parent.children.splice(y,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(y){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(y<0||y>=this.parent.children.length)&&r.Util.warn("Unexpected value "+y+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const k=this.index;return this.parent.children.splice(k,1),this.parent.children.splice(y,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let y=this.opacity();const k=this.getParent();return k&&!k._isUnderCache&&(y*=k.getAbsoluteOpacity()),y}moveTo(y){return this.getParent()!==y&&(this._remove(),y.add(this)),this}toObject(){let y=this.getAttrs(),k,M,R,F,$;const L={attrs:{},className:this.getClassName()};for(k in y)M=y[k],$=r.Util.isObject(M)&&!r.Util._isPlainObject(M)&&!r.Util._isArray(M),!$&&(R=typeof this[k]=="function"&&this[k],delete y[k],F=R?R.call(this):null,y[k]=M,F!==M&&(L.attrs[k]=M));return r.Util._prepareToStringify(L)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(y,k,M){const R=[];k&&this._isMatch(y)&&R.push(this);let F=this.parent;for(;F;){if(F===M)return R;F._isMatch(y)&&R.push(F),F=F.parent}return R}isAncestorOf(y){return!1}findAncestor(y,k,M){return this.findAncestors(y,k,M)[0]}_isMatch(y){if(!y)return!1;if(typeof y=="function")return y(this);let k=y.replace(/ /g,"").split(","),M=k.length,R,F;for(R=0;R<M;R++)if(F=k[R],r.Util.isValidSelector(F)||(r.Util.warn('Selector "'+F+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),F.charAt(0)==="#"){if(this.id()===F.slice(1))return!0}else if(F.charAt(0)==="."){if(this.hasName(F.slice(1)))return!0}else if(this.className===F||this.nodeType===F)return!0;return!1}getLayer(){const y=this.getParent();return y?y.getLayer():null}getStage(){return this._getCache(b,this._getStage)}_getStage(){const y=this.getParent();return y?y.getStage():null}fire(y,k={},M){return k.target=k.target||this,M?this._fireAndBubble(y,k):this._fire(y,k),this}getAbsoluteTransform(y){return y?this._getAbsoluteTransform(y):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(y){let k;if(y)return k=new r.Transform,this._eachAncestorReverse(function(M){const R=M.transformsEnabled();R==="all"?k.multiply(M.getTransform()):R==="position"&&k.translate(M.x()-M.offsetX(),M.y()-M.offsetY())},y),k;{k=this._cache.get(l)||new r.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(k):k.reset();const M=this.transformsEnabled();if(M==="all")k.multiply(this.getTransform());else if(M==="position"){const R=this.attrs.x||0,F=this.attrs.y||0,$=this.attrs.offsetX||0,L=this.attrs.offsetY||0;k.translate(R-$,F-L)}return k.dirty=!1,k}}getAbsoluteScale(y){let k=this;for(;k;)k._isUnderCache&&(y=k),k=k.getParent();const R=this.getAbsoluteTransform(y).decompose();return{x:R.scaleX,y:R.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(C,this._getTransform)}_getTransform(){var y,k;const M=this._cache.get(C)||new r.Transform;M.reset();const R=this.x(),F=this.y(),$=i.Konva.getAngle(this.rotation()),L=(y=this.attrs.scaleX)!==null&&y!==void 0?y:1,Y=(k=this.attrs.scaleY)!==null&&k!==void 0?k:1,X=this.attrs.skewX||0,H=this.attrs.skewY||0,A=this.attrs.offsetX||0,B=this.attrs.offsetY||0;return(R!==0||F!==0)&&M.translate(R,F),$!==0&&M.rotate($),(X!==0||H!==0)&&M.skew(X,H),(L!==1||Y!==1)&&M.scale(L,Y),(A!==0||B!==0)&&M.translate(-1*A,-1*B),M.dirty=!1,M}clone(y){let k=r.Util.cloneObject(this.attrs),M,R,F,$,L;for(M in y)k[M]=y[M];const Y=new this.constructor(k);for(M in this.eventListeners)for(R=this.eventListeners[M],F=R.length,$=0;$<F;$++)L=R[$],L.name.indexOf(d)<0&&(Y.eventListeners[M]||(Y.eventListeners[M]=[]),Y.eventListeners[M].push(L));return Y}_toKonvaCanvas(y){y=y||{};const k=this.getClientRect(),M=this.getStage(),R=y.x!==void 0?y.x:Math.floor(k.x),F=y.y!==void 0?y.y:Math.floor(k.y),$=y.pixelRatio||1,L=new t.SceneCanvas({width:y.width||Math.ceil(k.width)||(M?M.width():0),height:y.height||Math.ceil(k.height)||(M?M.height():0),pixelRatio:$}),Y=L.getContext(),X=new t.SceneCanvas({width:L.width/L.pixelRatio+Math.abs(R),height:L.height/L.pixelRatio+Math.abs(F),pixelRatio:L.pixelRatio});return y.imageSmoothingEnabled===!1&&(Y._context.imageSmoothingEnabled=!1),Y.save(),(R||F)&&Y.translate(-1*R,-1*F),this.drawScene(L,void 0,X),Y.restore(),L}toCanvas(y){return this._toKonvaCanvas(y)._canvas}toDataURL(y){y=y||{};const k=y.mimeType||null,M=y.quality||null,R=this._toKonvaCanvas(y).toDataURL(k,M);return y.callback&&y.callback(R),R}toImage(y){return new Promise((k,M)=>{try{const R=y?.callback;R&&delete y.callback,r.Util._urlToImage(this.toDataURL(y),function(F){k(F),R?.(F)})}catch(R){M(R)}})}toBlob(y){return new Promise((k,M)=>{try{const R=y?.callback;R&&delete y.callback,this.toCanvas(y).toBlob(F=>{k(F),R?.(F)},y?.mimeType,y?.quality)}catch(R){M(R)}})}setSize(y){return this.width(y.width),this.height(y.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(y,k,M){let R=this.eventListeners[y],F,$,L;for(F=0;F<R.length;F++)if($=R[F].name,L=R[F].handler,($!=="konva"||k==="konva")&&(!k||$===k)&&(!M||M===L)){if(R.splice(F,1),R.length===0){delete this.eventListeners[y];break}F--}}_fireChangeEvent(y,k,M){this._fire(y+p,{oldVal:k,newVal:M})}addName(y){if(!this.hasName(y)){const k=this.name(),M=k?k+" "+y:y;this.name(M)}return this}hasName(y){if(!y)return!1;const k=this.name();return k?(k||"").split(/\s/g).indexOf(y)!==-1:!1}removeName(y){const k=(this.name()||"").split(/\s/g),M=k.indexOf(y);return M!==-1&&(k.splice(M,1),this.name(k.join(" "))),this}setAttr(y,k){const M=this[S+r.Util._capitalize(y)];return r.Util._isFunction(M)?M.call(this,k):this._setAttr(y,k),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const y=this.getLayer()||this.getStage();y?.batchDraw()}}_setAttr(y,k){const M=this.attrs[y];M===k&&!r.Util.isObject(k)||(k==null?delete this.attrs[y]:this.attrs[y]=k,this._shouldFireChangeEvents&&this._fireChangeEvent(y,M,k),this._requestDraw())}_setComponentAttr(y,k,M){let R;M!==void 0&&(R=this.attrs[y],R||(this.attrs[y]=this.getAttr(y)),this.attrs[y][k]=M,this._fireChangeEvent(y,R,M))}_fireAndBubble(y,k,M){k&&this.nodeType===P&&(k.target=this);const R=[v,w,x,m,u,_];if(!(R.indexOf(y)!==-1&&(M&&(this===M||this.isAncestorOf&&this.isAncestorOf(M))||this.nodeType==="Stage"&&!M))){this._fire(y,k);const $=R.indexOf(y)!==-1&&M&&M.isAncestorOf&&M.isAncestorOf(this)&&!M.isAncestorOf(this.parent);(k&&!k.cancelBubble||!k)&&this.parent&&this.parent.isListening()&&!$&&(M&&M.parent?this._fireAndBubble.call(this.parent,y,k,M):this._fireAndBubble.call(this.parent,y,k))}}_getProtoListeners(y){var k,M,R;const F=(k=this._cache.get(a))!==null&&k!==void 0?k:{};let $=F?.[y];if($===void 0){$=[];let L=Object.getPrototypeOf(this);for(;L;){const Y=(R=(M=L.eventListeners)===null||M===void 0?void 0:M[y])!==null&&R!==void 0?R:[];$.push(...Y),L=Object.getPrototypeOf(L)}F[y]=$,this._cache.set(a,F)}return $}_fire(y,k){k=k||{},k.currentTarget=this,k.type=y;const M=this._getProtoListeners(y);if(M)for(let F=0;F<M.length;F++)M[F].handler.call(this,k);const R=this.eventListeners[y];if(R)for(let F=0;F<R.length;F++)R[F].handler.call(this,k)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(y){const k=y?y.pointerId:void 0,M=this.getStage(),R=this.getAbsolutePosition();if(!M)return;const F=M._getPointerById(k)||M._changedPointerPositions[0]||R;e.DD._dragElements.set(this._id,{node:this,startPointerPos:F,offset:{x:F.x-R.x,y:F.y-R.y},dragStatus:"ready",pointerId:k})}startDrag(y,k=!0){e.DD._dragElements.has(this._id)||this._createDragElement(y);const M=e.DD._dragElements.get(this._id);M.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:y&&y.evt},k)}_setDragPosition(y,k){const M=this.getStage()._getPointerById(k.pointerId);if(!M)return;let R={x:M.x-k.offset.x,y:M.y-k.offset.y};const F=this.dragBoundFunc();if(F!==void 0){const $=F.call(this,R,y);$?R=$:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==R.x||this._lastPos.y!==R.y)&&(this.setAbsolutePosition(R),this._requestDraw()),this._lastPos=R}stopDrag(y){const k=e.DD._dragElements.get(this._id);k&&(k.dragStatus="stopped"),e.DD._endDragBefore(y),e.DD._endDragAfter(y)}setDraggable(y){this._setAttr("draggable",y),this._dragChange()}isDragging(){const y=e.DD._dragElements.get(this._id);return y?y.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(y){if(!(!(y.evt.button!==void 0)||i.Konva.dragButtons.indexOf(y.evt.button)>=0)||this.isDragging())return;let R=!1;e.DD._dragElements.forEach(F=>{this.isAncestorOf(F.node)&&(R=!0)}),R||this._createDragElement(y)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const k=e.DD._dragElements.get(this._id),M=k&&k.dragStatus==="dragging",R=k&&k.dragStatus==="ready";M?this.stopDrag():R&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(y={x:0,y:0}){const k=this.getStage();if(!k)return!1;const M={x:-y.x,y:-y.y,width:k.width()+2*y.x,height:k.height()+2*y.y};return r.Util.haveIntersection(M,this.getClientRect())}static create(y,k){return r.Util._isString(y)&&(y=JSON.parse(y)),this._createNode(y,k)}static _createNode(y,k){let M=_o.prototype.getClassName.call(y),R=y.children,F,$,L;k&&(y.attrs.container=k),i.Konva[M]||(r.Util.warn('Can not find a node with class name "'+M+'". Fallback to "Shape".'),M="Shape");const Y=i.Konva[M];if(F=new Y(y.attrs),R)for($=R.length,L=0;L<$;L++)F.add(_o._createNode(R[L]));return F}};si.Node=U,U.prototype.nodeType="Node",U.prototype._attrsAffectingSize=[],U.prototype.eventListeners={},U.prototype.on.call(U.prototype,D,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(C),this._clearSelfAndDescendantCache(l)}),U.prototype.on.call(U.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(N)}),U.prototype.on.call(U.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(g)}),U.prototype.on.call(U.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const z=n.Factory.addGetterSetter;return z(U,"zIndex"),z(U,"absolutePosition"),z(U,"position"),z(U,"x",0,(0,s.getNumberValidator)()),z(U,"y",0,(0,s.getNumberValidator)()),z(U,"globalCompositeOperation","source-over",(0,s.getStringValidator)()),z(U,"opacity",1,(0,s.getNumberValidator)()),z(U,"name","",(0,s.getStringValidator)()),z(U,"id","",(0,s.getStringValidator)()),z(U,"rotation",0,(0,s.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"scale",["x","y"]),z(U,"scaleX",1,(0,s.getNumberValidator)()),z(U,"scaleY",1,(0,s.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"skew",["x","y"]),z(U,"skewX",0,(0,s.getNumberValidator)()),z(U,"skewY",0,(0,s.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"offset",["x","y"]),z(U,"offsetX",0,(0,s.getNumberValidator)()),z(U,"offsetY",0,(0,s.getNumberValidator)()),z(U,"dragDistance",void 0,(0,s.getNumberValidator)()),z(U,"width",0,(0,s.getNumberValidator)()),z(U,"height",0,(0,s.getNumberValidator)()),z(U,"listening",!0,(0,s.getBooleanValidator)()),z(U,"preventDefault",!0,(0,s.getBooleanValidator)()),z(U,"filters",void 0,function(q){return this._filterUpToDate=!1,q}),z(U,"visible",!0,(0,s.getBooleanValidator)()),z(U,"transformsEnabled","all",(0,s.getStringValidator)()),z(U,"size"),z(U,"dragBoundFunc"),z(U,"draggable",!1,(0,s.getBooleanValidator)()),n.Factory.backCompat(U,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),si}var oi={},Sl;function Ar(){if(Sl)return oi;Sl=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.Container=void 0;const t=yt(),e=Ht(),n=St();let i=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(s){const o=this.children||[];return s?o.filter(s):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.destroy()}),this.children=[],this._requestDraw(),this}add(...s){if(s.length===0)return this;if(s.length>1){for(let a=0;a<s.length;a++)this.add(s[a]);return this}const o=s[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(s){return this._generalFind(s,!1)}findOne(s){const o=this._generalFind(s,!0);return o.length>0?o[0]:void 0}_generalFind(s,o){const a=[];return this._descendants(l=>{const c=l._isMatch(s);return c&&a.push(l),!!(c&&o)}),a}_descendants(s){let o=!1;const a=this.getChildren();for(const l of a){if(o=s(l),o)return!0;if(l.hasChildren()&&(o=l._descendants(s),o))return!0}return!1}toObject(){const s=e.Node.prototype.toObject.call(this);return s.children=[],this.getChildren().forEach(o=>{s.children.push(o.toObject())}),s}isAncestorOf(s){let o=s.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(s){const o=e.Node.prototype.clone.call(this,s);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(s){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(s)&&o.push(a)}),o}_clearSelfAndDescendantCache(s){var o;super._clearSelfAndDescendantCache(s),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(s)}))}_setChildrenIndices(){var s;(s=this.children)===null||s===void 0||s.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(s,o,a){const l=this.getLayer(),c=s||l&&l.getCanvas(),h=c&&c.getContext(),p=this._getCanvasCache(),f=p&&p.scene,d=c&&c.isCache;if(!this.isVisible()&&!d)return this;if(f){h.save();const g=this.getAbsoluteTransform(o).getMatrix();h.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedSceneCanvas(h),h.restore()}else this._drawChildren("drawScene",c,o,a);return this}drawHit(s,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),l=s||a&&a.hitCanvas,c=l&&l.getContext(),h=this._getCanvasCache();if(h&&h.hit){c.save();const f=this.getAbsoluteTransform(o).getMatrix();c.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",l,o);return this}_drawChildren(s,o,a,l){var c;const h=o&&o.getContext(),p=this.clipWidth(),f=this.clipHeight(),d=this.clipFunc(),g=typeof p=="number"&&typeof f=="number"||d,v=a===this;if(g){h.save();const x=this.getAbsoluteTransform(a);let m=x.getMatrix();h.transform(m[0],m[1],m[2],m[3],m[4],m[5]),h.beginPath();let u;if(d)u=d.call(this,h,this);else{const _=this.clipX(),S=this.clipY();h.rect(_||0,S||0,p,f)}h.clip.apply(h,u),m=x.copy().invert().getMatrix(),h.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const w=!v&&this.globalCompositeOperation()!=="source-over"&&s==="drawScene";w&&(h.save(),h._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(x){x[s](o,a,l)}),w&&h.restore(),g&&h.restore()}getClientRect(s={}){var o;const a=s.skipTransform,l=s.relativeTo;let c,h,p,f,d={x:1/0,y:1/0,width:0,height:0};const g=this;(o=this.children)===null||o===void 0||o.forEach(function(x){if(!x.visible())return;const m=x.getClientRect({relativeTo:g,skipShadow:s.skipShadow,skipStroke:s.skipStroke});m.width===0&&m.height===0||(c===void 0?(c=m.x,h=m.y,p=m.x+m.width,f=m.y+m.height):(c=Math.min(c,m.x),h=Math.min(h,m.y),p=Math.max(p,m.x+m.width),f=Math.max(f,m.y+m.height)))});const v=this.find("Shape");let w=!1;for(let x=0;x<v.length;x++)if(v[x]._isVisible(this)){w=!0;break}return w&&c!==void 0?d={x:c,y:h,width:p-c,height:f-h}:d={x:0,y:0,width:0,height:0},a?d:this._transformedRect(d,l)}};return oi.Container=i,t.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipFunc"),oi}var Hs={},Ke={},wl;function xl(){if(wl)return Ke;wl=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.getCapturedShape=i,Ke.createEvent=r,Ke.hasPointerCapture=s,Ke.setPointerCapture=o,Ke.releaseCapture=a;const t=bt(),e=new Map,n=t.Konva._global.PointerEvent!==void 0;function i(l){return e.get(l)}function r(l){return{evt:l,pointerId:l.pointerId}}function s(l,c){return e.get(l)===c}function o(l,c){a(l),c.getStage()&&(e.set(l,c),n&&c._fire("gotpointercapture",r(new PointerEvent("gotpointercapture"))))}function a(l,c){const h=e.get(l);if(!h)return;const p=h.getStage();p&&p.content,e.delete(l),n&&h._fire("lostpointercapture",r(new PointerEvent("lostpointercapture")))}return Ke}var Cl;function Af(){return Cl||(Cl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Lt(),n=yt(),i=Ar(),r=bt(),s=Rr(),o=Gs(),a=bt(),l=xl(),c="Stage",h="string",p="px",f="mouseout",d="mouseleave",g="mouseover",v="mouseenter",w="mousemove",x="mousedown",m="mouseup",u="pointermove",_="pointerdown",S="pointerup",P="pointercancel",I="lostpointercapture",b="pointerout",C="pointerleave",E="pointerover",N="pointerenter",D="contextmenu",G="touchstart",U="touchend",z="touchmove",q="touchcancel",y="wheel",k=5,M=[[v,"_pointerenter"],[x,"_pointerdown"],[w,"_pointermove"],[m,"_pointerup"],[d,"_pointerleave"],[G,"_pointerdown"],[z,"_pointermove"],[U,"_pointerup"],[q,"_pointercancel"],[g,"_pointerover"],[y,"_wheel"],[D,"_contextmenu"],[_,"_pointerdown"],[u,"_pointermove"],[S,"_pointerup"],[P,"_pointercancel"],[C,"_pointerleave"],[I,"_lostpointercapture"]],R={mouse:{[b]:f,[C]:d,[E]:g,[N]:v,[u]:w,[_]:x,[S]:m,[P]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[b]:"touchout",[C]:"touchleave",[E]:"touchover",[N]:"touchenter",[u]:z,[_]:G,[S]:U,[P]:q,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[b]:b,[C]:C,[E]:E,[N]:N,[u]:u,[_]:_,[S]:S,[P]:P,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},F=H=>H.indexOf("pointer")>=0?"pointer":H.indexOf("touch")>=0?"touch":"mouse",$=H=>{const A=F(H);if(A==="pointer")return r.Konva.pointerEventsEnabled&&R.pointer;if(A==="touch")return R.touch;if(A==="mouse")return R.mouse};function L(H={}){return(H.clipFunc||H.clipWidth||H.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),H}const Y="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class X extends i.Container{constructor(A){super(L(A)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{L(this.attrs)}),this._checkVisibility()}_validateAdd(A){const B=A.getType()==="Layer",et=A.getType()==="FastLayer";B||et||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const A=this.visible()?"":"none";this.content.style.display=A}setContainer(A){if(typeof A===h){let B;if(A.charAt(0)==="."){const et=A.slice(1);A=document.getElementsByClassName(et)[0]}else A.charAt(0)!=="#"?B=A:B=A.slice(1),A=document.getElementById(B);if(!A)throw"Can not find container in document with id "+B}return this._setAttr("container",A),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),A.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const A=this.children,B=A.length;for(let et=0;et<B;et++)A[et].clear();return this}clone(A){return A||(A={}),A.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,A)}destroy(){super.destroy();const A=this.content;A&&e.Util._isInDocument(A)&&this.container().removeChild(A);const B=t.stages.indexOf(this);return B>-1&&t.stages.splice(B,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const A=this._pointerPositions[0]||this._changedPointerPositions[0];return A?{x:A.x,y:A.y}:(e.Util.warn(Y),null)}_getPointerById(A){return this._pointerPositions.find(B=>B.id===A)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(A){A=A||{},A.x=A.x||0,A.y=A.y||0,A.width=A.width||this.width(),A.height=A.height||this.height();const B=new s.SceneCanvas({width:A.width,height:A.height,pixelRatio:A.pixelRatio||1}),et=B.getContext()._context,st=this.children;return(A.x||A.y)&&et.translate(-1*A.x,-1*A.y),st.forEach(function(ct){if(!ct.isVisible())return;const T=ct._toKonvaCanvas(A);et.drawImage(T._canvas,A.x,A.y,T.getWidth()/T.getPixelRatio(),T.getHeight()/T.getPixelRatio())}),B}getIntersection(A){if(!A)return null;const B=this.children,et=B.length,st=et-1;for(let ct=st;ct>=0;ct--){const T=B[ct].getIntersection(A);if(T)return T}return null}_resizeDOM(){const A=this.width(),B=this.height();this.content&&(this.content.style.width=A+p,this.content.style.height=B+p),this.bufferCanvas.setSize(A,B),this.bufferHitCanvas.setSize(A,B),this.children.forEach(et=>{et.setSize({width:A,height:B}),et.draw()})}add(A,...B){if(arguments.length>1){for(let st=0;st<arguments.length;st++)this.add(arguments[st]);return this}super.add(A);const et=this.children.length;return et>k&&e.Util.warn("The stage has "+et+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),A.setSize({width:this.width(),height:this.height()}),A.draw(),r.Konva.isBrowser&&this.content.appendChild(A.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(A){return l.hasPointerCapture(A,this)}setPointerCapture(A){l.setPointerCapture(A,this)}releaseCapture(A){l.releaseCapture(A,this)}getLayers(){return this.children}_bindContentEvents(){r.Konva.isBrowser&&M.forEach(([A,B])=>{this.content.addEventListener(A,et=>{this[B](et)},{passive:!1})})}_pointerenter(A){this.setPointersPositions(A);const B=$(A.type);B&&this._fire(B.pointerenter,{evt:A,target:this,currentTarget:this})}_pointerover(A){this.setPointersPositions(A);const B=$(A.type);B&&this._fire(B.pointerover,{evt:A,target:this,currentTarget:this})}_getTargetShape(A){let B=this[A+"targetShape"];return B&&!B.getStage()&&(B=null),B}_pointerleave(A){const B=$(A.type),et=F(A.type);if(!B)return;this.setPointersPositions(A);const st=this._getTargetShape(et),ct=!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled;st&&ct?(st._fireAndBubble(B.pointerout,{evt:A}),st._fireAndBubble(B.pointerleave,{evt:A}),this._fire(B.pointerleave,{evt:A,target:this,currentTarget:this}),this[et+"targetShape"]=null):ct&&(this._fire(B.pointerleave,{evt:A,target:this,currentTarget:this}),this._fire(B.pointerout,{evt:A,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(A){const B=$(A.type),et=F(A.type);if(!B)return;this.setPointersPositions(A);let st=!1;this._changedPointerPositions.forEach(ct=>{const T=this.getIntersection(ct);if(o.DD.justDragged=!1,r.Konva["_"+et+"ListenClick"]=!0,!T||!T.isListening()){this[et+"ClickStartShape"]=void 0;return}r.Konva.capturePointerEventsEnabled&&T.setPointerCapture(ct.id),this[et+"ClickStartShape"]=T,T._fireAndBubble(B.pointerdown,{evt:A,pointerId:ct.id}),st=!0;const O=A.type.indexOf("touch")>=0;T.preventDefault()&&A.cancelable&&O&&A.preventDefault()}),st||this._fire(B.pointerdown,{evt:A,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(A){const B=$(A.type),et=F(A.type);if(!B||(r.Konva.isDragging()&&o.DD.node.preventDefault()&&A.cancelable&&A.preventDefault(),this.setPointersPositions(A),!(!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled)))return;const ct={};let T=!1;const O=this._getTargetShape(et);this._changedPointerPositions.forEach(V=>{const W=l.getCapturedShape(V.id)||this.getIntersection(V),K=V.id,j={evt:A,pointerId:K},J=O!==W;if(J&&O&&(O._fireAndBubble(B.pointerout,{...j},W),O._fireAndBubble(B.pointerleave,{...j},W)),W){if(ct[W._id])return;ct[W._id]=!0}W&&W.isListening()?(T=!0,J&&(W._fireAndBubble(B.pointerover,{...j},O),W._fireAndBubble(B.pointerenter,{...j},O),this[et+"targetShape"]=W),W._fireAndBubble(B.pointermove,{...j})):O&&(this._fire(B.pointerover,{evt:A,target:this,currentTarget:this,pointerId:K}),this[et+"targetShape"]=null)}),T||this._fire(B.pointermove,{evt:A,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(A){const B=$(A.type),et=F(A.type);if(!B)return;this.setPointersPositions(A);const st=this[et+"ClickStartShape"],ct=this[et+"ClickEndShape"],T={};let O=!1;this._changedPointerPositions.forEach(V=>{const W=l.getCapturedShape(V.id)||this.getIntersection(V);if(W){if(W.releaseCapture(V.id),T[W._id])return;T[W._id]=!0}const K=V.id,j={evt:A,pointerId:K};let J=!1;r.Konva["_"+et+"InDblClickWindow"]?(J=!0,clearTimeout(this[et+"DblTimeout"])):o.DD.justDragged||(r.Konva["_"+et+"InDblClickWindow"]=!0,clearTimeout(this[et+"DblTimeout"])),this[et+"DblTimeout"]=setTimeout(function(){r.Konva["_"+et+"InDblClickWindow"]=!1},r.Konva.dblClickWindow),W&&W.isListening()?(O=!0,this[et+"ClickEndShape"]=W,W._fireAndBubble(B.pointerup,{...j}),r.Konva["_"+et+"ListenClick"]&&st&&st===W&&(W._fireAndBubble(B.pointerclick,{...j}),J&&ct&&ct===W&&W._fireAndBubble(B.pointerdblclick,{...j}))):(this[et+"ClickEndShape"]=null,r.Konva["_"+et+"ListenClick"]&&this._fire(B.pointerclick,{evt:A,target:this,currentTarget:this,pointerId:K}),J&&this._fire(B.pointerdblclick,{evt:A,target:this,currentTarget:this,pointerId:K}))}),O||this._fire(B.pointerup,{evt:A,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),r.Konva["_"+et+"ListenClick"]=!1,A.cancelable&&et!=="touch"&&et!=="pointer"&&A.preventDefault()}_contextmenu(A){this.setPointersPositions(A);const B=this.getIntersection(this.getPointerPosition());B&&B.isListening()?B._fireAndBubble(D,{evt:A}):this._fire(D,{evt:A,target:this,currentTarget:this})}_wheel(A){this.setPointersPositions(A);const B=this.getIntersection(this.getPointerPosition());B&&B.isListening()?B._fireAndBubble(y,{evt:A}):this._fire(y,{evt:A,target:this,currentTarget:this})}_pointercancel(A){this.setPointersPositions(A);const B=l.getCapturedShape(A.pointerId)||this.getIntersection(this.getPointerPosition());B&&B._fireAndBubble(S,l.createEvent(A)),l.releaseCapture(A.pointerId)}_lostpointercapture(A){l.releaseCapture(A.pointerId)}setPointersPositions(A){const B=this._getContentPosition();let et=null,st=null;A=A||window.event,A.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(A.touches,ct=>{this._pointerPositions.push({id:ct.identifier,x:(ct.clientX-B.left)/B.scaleX,y:(ct.clientY-B.top)/B.scaleY})}),Array.prototype.forEach.call(A.changedTouches||A.touches,ct=>{this._changedPointerPositions.push({id:ct.identifier,x:(ct.clientX-B.left)/B.scaleX,y:(ct.clientY-B.top)/B.scaleY})})):(et=(A.clientX-B.left)/B.scaleX,st=(A.clientY-B.top)/B.scaleY,this.pointerPos={x:et,y:st},this._pointerPositions=[{x:et,y:st,id:e.Util._getFirstPointerId(A)}],this._changedPointerPositions=[{x:et,y:st,id:e.Util._getFirstPointerId(A)}])}_setPointerPosition(A){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(A)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const A=this.content.getBoundingClientRect();return{top:A.top,left:A.left,scaleX:A.width/this.content.clientWidth||1,scaleY:A.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!r.Konva.isBrowser)return;const A=this.container();if(!A)throw"Stage has no container. A container is required.";A.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),A.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(A){A.batchDraw()}),this}}t.Stage=X,X.prototype.nodeType=c,(0,a._registerNode)(X),n.Factory.addGetterSetter(X,"container"),r.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(H=>{H.batchDraw()})})}(Hs)),Hs}var ai={},Bs={},Pl;function Wt(){return Pl||(Pl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=bt(),n=Lt(),i=yt(),r=Ht(),s=St(),o=bt(),a=xl(),l="hasShadow",c="shadowRGBA",h="patternImage",p="linearGradient",f="radialGradient";let d;function g(){return d||(d=n.Util.createCanvasElement().getContext("2d"),d)}t.shapes={};function v(C){const E=this.attrs.fillRule;E?C.fill(E):C.fill()}function w(C){C.stroke()}function x(C){const E=this.attrs.fillRule;E?C.fill(E):C.fill()}function m(C){C.stroke()}function u(){this._clearCache(l)}function _(){this._clearCache(c)}function S(){this._clearCache(h)}function P(){this._clearCache(p)}function I(){this._clearCache(f)}class b extends r.Node{constructor(E){super(E);let N;for(;N=n.Util.getRandomColor(),!(N&&!(N in t.shapes)););this.colorKey=N,t.shapes[N]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const N=g().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(N&&N.setTransform){const D=new n.Transform;D.translate(this.fillPatternX(),this.fillPatternY()),D.rotate(e.Konva.getAngle(this.fillPatternRotation())),D.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),D.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const G=D.getMatrix(),U=typeof DOMMatrix>"u"?{a:G[0],b:G[1],c:G[2],d:G[3],e:G[4],f:G[5]}:new DOMMatrix(G);N.setTransform(U)}return N}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const E=this.fillLinearGradientColorStops();if(E){const N=g(),D=this.fillLinearGradientStartPoint(),G=this.fillLinearGradientEndPoint(),U=N.createLinearGradient(D.x,D.y,G.x,G.y);for(let z=0;z<E.length;z+=2)U.addColorStop(E[z],E[z+1]);return U}}_getRadialGradient(){return this._getCache(f,this.__getRadialGradient)}__getRadialGradient(){const E=this.fillRadialGradientColorStops();if(E){const N=g(),D=this.fillRadialGradientStartPoint(),G=this.fillRadialGradientEndPoint(),U=N.createRadialGradient(D.x,D.y,this.fillRadialGradientStartRadius(),G.x,G.y,this.fillRadialGradientEndRadius());for(let z=0;z<E.length;z+=2)U.addColorStop(E[z],E[z+1]);return U}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const E=n.Util.colorToRGBA(this.shadowColor());if(E)return"rgba("+E.r+","+E.g+","+E.b+","+E.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const E=this.hitStrokeWidth();return E==="auto"?this.hasStroke():this.strokeEnabled()&&!!E}intersects(E){const N=this.getStage();if(!N)return!1;const D=N.bufferHitCanvas;return D.getContext().clear(),this.drawHit(D,void 0,!0),D.context.getImageData(Math.round(E.x),Math.round(E.y),1,1).data[3]>0}destroy(){return r.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(E){var N;if(!((N=this.attrs.perfectDrawEnabled)!==null&&N!==void 0?N:!0))return!1;const G=E||this.hasFill(),U=this.hasStroke(),z=this.getAbsoluteOpacity()!==1;if(G&&U&&z)return!0;const q=this.hasShadow(),y=this.shadowForStrokeEnabled();return!!(G&&U&&q&&y)}setStrokeHitEnabled(E){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),E?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const E=this.size();return{x:this._centroid?-E.width/2:0,y:this._centroid?-E.height/2:0,width:E.width,height:E.height}}getClientRect(E={}){let N=!1,D=this.getParent();for(;D;){if(D.isCached()){N=!0;break}D=D.getParent()}const G=E.skipTransform,U=E.relativeTo||N&&this.getStage()||void 0,z=this.getSelfRect(),y=!E.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,k=z.width+y,M=z.height+y,R=!E.skipShadow&&this.hasShadow(),F=R?this.shadowOffsetX():0,$=R?this.shadowOffsetY():0,L=k+Math.abs(F),Y=M+Math.abs($),X=R&&this.shadowBlur()||0,H=L+X*2,A=Y+X*2,B={width:H,height:A,x:-(y/2+X)+Math.min(F,0)+z.x,y:-(y/2+X)+Math.min($,0)+z.y};return G?B:this._transformedRect(B,U)}drawScene(E,N,D){const G=this.getLayer(),U=E||G.getCanvas(),z=U.getContext(),q=this._getCanvasCache(),y=this.getSceneFunc(),k=this.hasShadow();let M;const R=N===this;if(!this.isVisible()&&!R)return this;if(q){z.save();const F=this.getAbsoluteTransform(N).getMatrix();return z.transform(F[0],F[1],F[2],F[3],F[4],F[5]),this._drawCachedSceneCanvas(z),z.restore(),this}if(!y)return this;if(z.save(),this._useBufferCanvas()){M=this.getStage();const F=D||M.bufferCanvas,$=F.getContext();$.clear(),$.save(),$._applyLineJoin(this);const L=this.getAbsoluteTransform(N).getMatrix();$.transform(L[0],L[1],L[2],L[3],L[4],L[5]),y.call(this,$,this),$.restore();const Y=F.pixelRatio;k&&z._applyShadow(this),z._applyOpacity(this),z._applyGlobalCompositeOperation(this),z.drawImage(F._canvas,F.x||0,F.y||0,F.width/Y,F.height/Y)}else{if(z._applyLineJoin(this),!R){const F=this.getAbsoluteTransform(N).getMatrix();z.transform(F[0],F[1],F[2],F[3],F[4],F[5]),z._applyOpacity(this),z._applyGlobalCompositeOperation(this)}k&&z._applyShadow(this),y.call(this,z,this)}return z.restore(),this}drawHit(E,N,D=!1){if(!this.shouldDrawHit(N,D))return this;const G=this.getLayer(),U=E||G.hitCanvas,z=U&&U.getContext(),q=this.hitFunc()||this.sceneFunc(),y=this._getCanvasCache(),k=y&&y.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),k){z.save();const R=this.getAbsoluteTransform(N).getMatrix();return z.transform(R[0],R[1],R[2],R[3],R[4],R[5]),this._drawCachedHitCanvas(z),z.restore(),this}if(!q)return this;if(z.save(),z._applyLineJoin(this),!(this===N)){const R=this.getAbsoluteTransform(N).getMatrix();z.transform(R[0],R[1],R[2],R[3],R[4],R[5])}return q.call(this,z,this),z.restore(),this}drawHitFromCache(E=0){const N=this._getCanvasCache(),D=this._getCachedSceneCanvas(),G=N.hit,U=G.getContext(),z=G.getWidth(),q=G.getHeight();U.clear(),U.drawImage(D._canvas,0,0,z,q);try{const y=U.getImageData(0,0,z,q),k=y.data,M=k.length,R=n.Util._hexToRgb(this.colorKey);for(let F=0;F<M;F+=4)k[F+3]>E?(k[F]=R.r,k[F+1]=R.g,k[F+2]=R.b,k[F+3]=255):k[F+3]=0;U.putImageData(y,0,0)}catch(y){n.Util.error("Unable to draw hit graph from cached scene canvas. "+y.message)}return this}hasPointerCapture(E){return a.hasPointerCapture(E,this)}setPointerCapture(E){a.setPointerCapture(E,this)}releaseCapture(E){a.releaseCapture(E,this)}}t.Shape=b,b.prototype._fillFunc=v,b.prototype._strokeFunc=w,b.prototype._fillFuncHit=x,b.prototype._strokeFuncHit=m,b.prototype._centroid=!1,b.prototype.nodeType="Shape",(0,o._registerNode)(b),b.prototype.eventListeners={},b.prototype.on.call(b.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",u),b.prototype.on.call(b.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),b.prototype.on.call(b.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",S),b.prototype.on.call(b.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",P),b.prototype.on.call(b.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",I),i.Factory.addGetterSetter(b,"stroke",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(b,"strokeWidth",2,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(b,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(b,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(b,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(b,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(b,"lineJoin"),i.Factory.addGetterSetter(b,"lineCap"),i.Factory.addGetterSetter(b,"sceneFunc"),i.Factory.addGetterSetter(b,"hitFunc"),i.Factory.addGetterSetter(b,"dash"),i.Factory.addGetterSetter(b,"dashOffset",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"shadowColor",void 0,(0,s.getStringValidator)()),i.Factory.addGetterSetter(b,"shadowBlur",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"shadowOpacity",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(b,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(b,"shadowOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"shadowOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternImage"),i.Factory.addGetterSetter(b,"fill",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(b,"fillPatternX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(b,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(b,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(b,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(b,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(b,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(b,"fillEnabled",!0),i.Factory.addGetterSetter(b,"strokeEnabled",!0),i.Factory.addGetterSetter(b,"shadowEnabled",!0),i.Factory.addGetterSetter(b,"dashEnabled",!0),i.Factory.addGetterSetter(b,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(b,"fillPriority","color"),i.Factory.addComponentsGetterSetter(b,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(b,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(b,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(b,"fillPatternScaleX",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternScaleY",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(b,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(b,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(b,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(b,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(b,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(b,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(b,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(b,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(b,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(b,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(b,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(b,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(b,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(b,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(b,"fillPatternRotation",0),i.Factory.addGetterSetter(b,"fillRule",void 0,(0,s.getStringValidator)()),i.Factory.backCompat(b,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(Bs)),Bs}var kl;function El(){if(kl)return ai;kl=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.Layer=void 0;const t=Lt(),e=Ar(),n=Ht(),i=yt(),r=Rr(),s=St(),o=Wt(),a=bt(),l="#",c="beforeDraw",h="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],f=p.length;let d=class extends e.Container{constructor(v){super(v),this.canvas=new r.SceneCanvas,this.hitCanvas=new r.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(v){return this.getContext().clear(v),this.getHitCanvas().getContext().clear(v),this}setZIndex(v){super.setZIndex(v);const w=this.getStage();return w&&w.content&&(w.content.removeChild(this.getNativeCanvasElement()),v<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[v+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!n.Node.prototype.moveUp.call(this))return!1;const w=this.getStage();return!w||!w.content?!1:(w.content.removeChild(this.getNativeCanvasElement()),this.index<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[this.index+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const v=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),v&&v.parentNode&&t.Util._isInDocument(v)&&v.parentNode.removeChild(v),this}getStage(){return this.parent}setSize({width:v,height:w}){return this.canvas.setSize(v,w),this.hitCanvas.setSize(v,w),this._setSmoothEnabled(),this}_validateAdd(v){const w=v.getType();w!=="Group"&&w!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(v){return v=v||{},v.width=v.width||this.getWidth(),v.height=v.height||this.getHeight(),v.x=v.x!==void 0?v.x:this.x(),v.y=v.y!==void 0?v.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,v)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(v){if(!this.isListening()||!this.isVisible())return null;let w=1,x=!1;for(;;){for(let m=0;m<f;m++){const u=p[m],_=this._getIntersection({x:v.x+u.x*w,y:v.y+u.y*w}),S=_.shape;if(S)return S;if(x=!!_.antialiased,!_.antialiased)break}if(x)w+=1;else return null}}_getIntersection(v){const w=this.hitCanvas.pixelRatio,x=this.hitCanvas.context.getImageData(Math.round(v.x*w),Math.round(v.y*w),1,1).data,m=x[3];if(m===255){const u=t.Util._rgbToHex(x[0],x[1],x[2]),_=o.shapes[l+u];return _?{shape:_}:{antialiased:!0}}else if(m>0)return{antialiased:!0};return{}}drawScene(v,w,x){const m=this.getLayer(),u=v||m&&m.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&u.getContext().clear(),e.Container.prototype.drawScene.call(this,u,w,x),this._fire(h,{node:this}),this}drawHit(v,w){const x=this.getLayer(),m=v||x&&x.hitCanvas;return x&&x.clearBeforeDraw()&&x.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,m,w),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(v){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(v)}getHitGraphEnabled(v){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const v=this.parent;!!this.hitCanvas._canvas.parentNode?v.content.removeChild(this.hitCanvas._canvas):v.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return ai.Layer=d,d.prototype.nodeType="Layer",(0,a._registerNode)(d),i.Factory.addGetterSetter(d,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(d,"clearBeforeDraw",!0),i.Factory.addGetterSetter(d,"hitGraphEnabled",!0,(0,s.getBooleanValidator)()),ai}var li={},Tl;function Mf(){if(Tl)return li;Tl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.FastLayer=void 0;const t=Lt(),e=El(),n=bt();let i=class extends e.Layer{constructor(s){super(s),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return li.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),li}var ci={},Rl;function Vs(){if(Rl)return ci;Rl=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.Group=void 0;const t=Lt(),e=Ar(),n=bt();let i=class extends e.Container{_validateAdd(s){const o=s.getType();o!=="Group"&&o!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return ci.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),ci}var hi={},Al;function $s(){if(Al)return hi;Al=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Animation=void 0;const t=bt(),e=Lt(),n=function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}}();let i=class Un{constructor(s,o){this.id=Un.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=s,this.setLayers(o)}setLayers(s){let o=[];return s&&(o=Array.isArray(s)?s:[s]),this.layers=o,this}getLayers(){return this.layers}addLayer(s){const o=this.layers,a=o.length;for(let l=0;l<a;l++)if(o[l]._id===s._id)return!1;return this.layers.push(s),!0}isRunning(){const o=Un.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),Un._addAnimation(this),this}stop(){return Un._removeAnimation(this),this}_updateFrameObject(s){this.frame.timeDiff=s-this.frame.lastTime,this.frame.lastTime=s,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(s){this.animations.push(s),this._handleAnimation()}static _removeAnimation(s){const o=s.id,a=this.animations,l=a.length;for(let c=0;c<l;c++)if(a[c].id===o){this.animations.splice(c,1);break}}static _runFrames(){const s={},o=this.animations;for(let a=0;a<o.length;a++){const l=o[a],c=l.layers,h=l.func;l._updateFrameObject(n());const p=c.length;let f;if(h?f=h.call(l,l.frame)!==!1:f=!0,!!f)for(let d=0;d<p;d++){const g=c[d];g._id!==void 0&&(s[g._id]=g)}}for(const a in s)s.hasOwnProperty(a)&&s[a].batchDraw()}static _animationLoop(){const s=Un;s.animations.length?(s._runFrames(),e.Util.requestAnimFrame(s._animationLoop)):s.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return hi.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,hi}var Ws={},Ml;function Nf(){return Ml||(Ml=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Lt(),n=$s(),i=Ht(),r=bt(),s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,l=3,c=["fill","stroke","shadowColor"];let h=0;class p{constructor(g,v,w,x,m,u,_){this.prop=g,this.propFunc=v,this.begin=x,this._pos=x,this.duration=u,this._change=0,this.prevPos=0,this.yoyo=_,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=w,this._change=m-this.begin,this.pause()}fire(g){const v=this[g];v&&v()}setTime(g){g>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():g<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=g,this.update())}getTime(){return this._time}setPosition(g){this.prevPos=this._pos,this.propFunc(g),this._pos=g}getPosition(g){return g===void 0&&(g=this._time),this.func(g,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(g){this.pause(),this._time=g,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const g=this.getTimer()-this._startTime;this.state===a?this.setTime(g):this.state===l&&this.setTime(this.duration-g)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class f{constructor(g){const v=this,w=g.node,x=w._id,m=g.easing||t.Easings.Linear,u=!!g.yoyo;let _,S;typeof g.duration>"u"?_=.3:g.duration===0?_=.001:_=g.duration,this.node=w,this._id=h++;const P=w.getLayer()||(w instanceof r.Konva.Stage?w.getLayers():null);P||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){v.tween.onEnterFrame()},P),this.tween=new p(S,function(I){v._tweenFunc(I)},m,0,1,_*1e3,u),this._addListeners(),f.attrs[x]||(f.attrs[x]={}),f.attrs[x][this._id]||(f.attrs[x][this._id]={}),f.tweens[x]||(f.tweens[x]={});for(S in g)s[S]===void 0&&this._addAttr(S,g[S]);this.reset(),this.onFinish=g.onFinish,this.onReset=g.onReset,this.onUpdate=g.onUpdate}_addAttr(g,v){const w=this.node,x=w._id;let m,u,_,S,P;const I=f.tweens[x][g];I&&delete f.attrs[x][I][g];let b=w.getAttr(g);if(e.Util._isArray(v))if(m=[],u=Math.max(v.length,b.length),g==="points"&&v.length!==b.length&&(v.length>b.length?(S=b,b=e.Util._prepareArrayForTween(b,v,w.closed())):(_=v,v=e.Util._prepareArrayForTween(v,b,w.closed()))),g.indexOf("fill")===0)for(let C=0;C<u;C++)if(C%2===0)m.push(v[C]-b[C]);else{const E=e.Util.colorToRGBA(b[C]);P=e.Util.colorToRGBA(v[C]),b[C]=E,m.push({r:P.r-E.r,g:P.g-E.g,b:P.b-E.b,a:P.a-E.a})}else for(let C=0;C<u;C++)m.push(v[C]-b[C]);else c.indexOf(g)!==-1?(b=e.Util.colorToRGBA(b),P=e.Util.colorToRGBA(v),m={r:P.r-b.r,g:P.g-b.g,b:P.b-b.b,a:P.a-b.a}):m=v-b;f.attrs[x][this._id][g]={start:b,diff:m,end:v,trueEnd:_,trueStart:S},f.tweens[x][g]=this._id}_tweenFunc(g){const v=this.node,w=f.attrs[v._id][this._id];let x,m,u,_,S,P,I,b;for(x in w){if(m=w[x],u=m.start,_=m.diff,b=m.end,e.Util._isArray(u))if(S=[],I=Math.max(u.length,b.length),x.indexOf("fill")===0)for(P=0;P<I;P++)P%2===0?S.push((u[P]||0)+_[P]*g):S.push("rgba("+Math.round(u[P].r+_[P].r*g)+","+Math.round(u[P].g+_[P].g*g)+","+Math.round(u[P].b+_[P].b*g)+","+(u[P].a+_[P].a*g)+")");else for(P=0;P<I;P++)S.push((u[P]||0)+_[P]*g);else c.indexOf(x)!==-1?S="rgba("+Math.round(u.r+_.r*g)+","+Math.round(u.g+_.g*g)+","+Math.round(u.b+_.b*g)+","+(u.a+_.a*g)+")":S=u+_*g;v.setAttr(x,S)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const g=this.node,v=f.attrs[g._id][this._id];v.points&&v.points.trueEnd&&g.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const g=this.node,v=f.attrs[g._id][this._id];v.points&&v.points.trueStart&&g.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(g){return this.tween.seek(g*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const g=this.node._id,v=this._id,w=f.tweens[g];this.pause(),this.anim&&this.anim.stop();for(const x in w)delete f.tweens[g][x];delete f.attrs[g][v],Object.keys(f.tweens[g]).length===0&&delete f.tweens[g],Object.keys(f.attrs[g]).length===0&&delete f.attrs[g]}}t.Tween=f,f.attrs={},f.tweens={},i.Node.prototype.to=function(d){const g=d.onFinish;d.node=this,d.onFinish=function(){this.destroy(),g&&g()},new f(d).play()},t.Easings={BackEaseIn(d,g,v,w){return v*(d/=w)*d*(2.70158*d-1.70158)+g},BackEaseOut(d,g,v,w){return v*((d=d/w-1)*d*(2.70158*d+1.70158)+1)+g},BackEaseInOut(d,g,v,w){let x=1.70158;return(d/=w/2)<1?v/2*(d*d*(((x*=1.525)+1)*d-x))+g:v/2*((d-=2)*d*(((x*=1.525)+1)*d+x)+2)+g},ElasticEaseIn(d,g,v,w,x,m){let u=0;return d===0?g:(d/=w)===1?g+v:(m||(m=w*.3),!x||x<Math.abs(v)?(x=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/x),-(x*Math.pow(2,10*(d-=1))*Math.sin((d*w-u)*(2*Math.PI)/m))+g)},ElasticEaseOut(d,g,v,w,x,m){let u=0;return d===0?g:(d/=w)===1?g+v:(m||(m=w*.3),!x||x<Math.abs(v)?(x=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/x),x*Math.pow(2,-10*d)*Math.sin((d*w-u)*(2*Math.PI)/m)+v+g)},ElasticEaseInOut(d,g,v,w,x,m){let u=0;return d===0?g:(d/=w/2)===2?g+v:(m||(m=w*.44999999999999996),!x||x<Math.abs(v)?(x=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/x),d<1?-.5*(x*Math.pow(2,10*(d-=1))*Math.sin((d*w-u)*(2*Math.PI)/m))+g:x*Math.pow(2,-10*(d-=1))*Math.sin((d*w-u)*(2*Math.PI)/m)*.5+v+g)},BounceEaseOut(d,g,v,w){return(d/=w)<.36363636363636365?v*(7.5625*d*d)+g:d<.7272727272727273?v*(7.5625*(d-=.5454545454545454)*d+.75)+g:d<.9090909090909091?v*(7.5625*(d-=.8181818181818182)*d+.9375)+g:v*(7.5625*(d-=.9545454545454546)*d+.984375)+g},BounceEaseIn(d,g,v,w){return v-t.Easings.BounceEaseOut(w-d,0,v,w)+g},BounceEaseInOut(d,g,v,w){return d<w/2?t.Easings.BounceEaseIn(d*2,0,v,w)*.5+g:t.Easings.BounceEaseOut(d*2-w,0,v,w)*.5+v*.5+g},EaseIn(d,g,v,w){return v*(d/=w)*d+g},EaseOut(d,g,v,w){return-v*(d/=w)*(d-2)+g},EaseInOut(d,g,v,w){return(d/=w/2)<1?v/2*d*d+g:-v/2*(--d*(d-2)-1)+g},StrongEaseIn(d,g,v,w){return v*(d/=w)*d*d*d*d+g},StrongEaseOut(d,g,v,w){return v*((d=d/w-1)*d*d*d*d+1)+g},StrongEaseInOut(d,g,v,w){return(d/=w/2)<1?v/2*d*d*d*d*d+g:v/2*((d-=2)*d*d*d*d+2)+g},Linear(d,g,v,w){return v*d/w+g}}}(Ws)),Ws}var Nl;function If(){return Nl||(Nl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=bt(),n=Lt(),i=Ht(),r=Ar(),s=Af(),o=El(),a=Mf(),l=Vs(),c=Gs(),h=Wt(),p=$s(),f=Nf(),d=pl(),g=Rr();t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:r.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:c.DD,Shape:h.Shape,shapes:h.shapes,Animation:p.Animation,Tween:f.Tween,Easings:f.Easings,Context:d.Context,Canvas:g.Canvas}),t.default=t.Konva}(Fs)),Fs}var ui={},Il;function Of(){if(Il)return ui;Il=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Arc=void 0;const t=yt(),e=Wt(),n=bt(),i=St(),r=bt();let s=class extends e.Shape{_sceneFunc(a){const l=n.Konva.getAngle(this.angle()),c=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,c),a.arc(0,0,this.innerRadius(),l,0,!c),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),c=this.clockwise(),h=n.Konva.getAngle(c?360-this.angle():this.angle()),p=Math.cos(Math.min(h,Math.PI)),f=1,d=Math.sin(Math.min(Math.max(Math.PI,h),3*Math.PI/2)),g=Math.sin(Math.min(h,Math.PI/2)),v=p*(p>0?a:l),w=f*l,x=d*(d>0?a:l),m=g*(g>0?l:a);return{x:v,y:c?-1*m:x,width:w-v,height:m-x}}};return ui.Arc=s,s.prototype._centroid=!0,s.prototype.className="Arc",s.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"clockwise",!1,(0,i.getBooleanValidator)()),ui}var di={},fi={},Ol;function Fl(){if(Ol)return fi;Ol=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.Line=void 0;const t=yt(),e=bt(),n=Wt(),i=St();function r(a,l,c,h,p,f,d){const g=Math.sqrt(Math.pow(c-a,2)+Math.pow(h-l,2)),v=Math.sqrt(Math.pow(p-c,2)+Math.pow(f-h,2)),w=d*g/(g+v),x=d*v/(g+v),m=c-w*(p-a),u=h-w*(f-l),_=c+x*(p-a),S=h+x*(f-l);return[m,u,_,S]}function s(a,l){const c=a.length,h=[];for(let p=2;p<c-2;p+=2){const f=r(a[p-2],a[p-1],a[p],a[p+1],a[p+2],a[p+3],l);isNaN(f[0])||(h.push(f[0]),h.push(f[1]),h.push(a[p]),h.push(a[p+1]),h.push(f[2]),h.push(f[3]))}return h}let o=class extends n.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const c=this.points(),h=c.length,p=this.tension(),f=this.closed(),d=this.bezier();if(!h)return;let g=0;if(l.beginPath(),l.moveTo(c[0],c[1]),p!==0&&h>4){const v=this.getTensionPoints(),w=v.length;for(g=f?0:4,f||l.quadraticCurveTo(v[0],v[1],v[2],v[3]);g<w-2;)l.bezierCurveTo(v[g++],v[g++],v[g++],v[g++],v[g++],v[g++]);f||l.quadraticCurveTo(v[w-2],v[w-1],c[h-2],c[h-1])}else if(d)for(g=2;g<h;)l.bezierCurveTo(c[g++],c[g++],c[g++],c[g++],c[g++],c[g++]);else for(g=2;g<h;g+=2)l.lineTo(c[g],c[g+1]);f?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():s(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),c=l.length,h=this.tension(),p=r(l[c-2],l[c-1],l[0],l[1],l[2],l[3],h),f=r(l[c-4],l[c-3],l[c-2],l[c-1],l[0],l[1],h),d=s(l,h);return[p[2],p[3]].concat(d).concat([f[0],f[1],l[c-2],l[c-1],f[2],f[3],p[0],p[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let c=l[0],h=l[0],p=l[1],f=l[1],d,g;for(let v=0;v<l.length/2;v++)d=l[v*2],g=l[v*2+1],c=Math.min(c,d),h=Math.max(h,d),p=Math.min(p,g),f=Math.max(f,g);return{x:c,y:p,width:h-c,height:f-p}}};return fi.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),t.Factory.addGetterSetter(o,"closed",!1),t.Factory.addGetterSetter(o,"bezier",!1),t.Factory.addGetterSetter(o,"tension",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,"points",[],(0,i.getNumberArrayValidator)()),fi}var gi={},js={},Dl;function Ff(){return Dl||(Dl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,l)=>{let c,h;const f=l/2;c=0;for(let d=0;d<20;d++)h=f*t.tValues[20][d]+f,c+=t.cValues[20][d]*i(o,a,h);return f*c};t.getCubicArcLength=e;const n=(o,a,l)=>{l===void 0&&(l=1);const c=o[0]-2*o[1]+o[2],h=a[0]-2*a[1]+a[2],p=2*o[1]-2*o[0],f=2*a[1]-2*a[0],d=4*(c*c+h*h),g=4*(c*p+h*f),v=p*p+f*f;if(d===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const w=g/(2*d),x=v/d,m=l+w,u=x-w*w,_=m*m+u>0?Math.sqrt(m*m+u):0,S=w*w+u>0?Math.sqrt(w*w+u):0,P=w+Math.sqrt(w*w+u)!==0?u*Math.log(Math.abs((m+_)/(w+S))):0;return Math.sqrt(d)/2*(m*_-w*S+P)};t.getQuadraticArcLength=n;function i(o,a,l){const c=r(1,l,o),h=r(1,l,a),p=c*c+h*h;return Math.sqrt(p)}const r=(o,a,l)=>{const c=l.length-1;let h,p;if(c===0)return 0;if(o===0){p=0;for(let f=0;f<=c;f++)p+=t.binomialCoefficients[c][f]*Math.pow(1-a,c-f)*Math.pow(a,f)*l[f];return p}else{h=new Array(c);for(let f=0;f<c;f++)h[f]=c*(l[f+1]-l[f]);return r(o-1,a,h)}},s=(o,a,l)=>{let c=1,h=o/a,p=(o-l(h))/a,f=0;for(;c>.001;){const d=l(h+p),g=Math.abs(o-d)/a;if(g<c)c=g,h+=p;else{const v=l(h-p),w=Math.abs(o-v)/a;w<c?(c=w,h-=p):p/=2}if(f++,f>500)break}return h};t.t2length=s}(js)),js}var zl;function Zs(){if(zl)return gi;zl=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.Path=void 0;const t=yt(),e=bt(),n=Wt(),i=Ff();let r=class le extends n.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=le.parsePathData(this.data()),this.pathLength=le.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let l=!1;for(let c=0;c<a.length;c++){const h=a[c].command,p=a[c].points;switch(h){case"L":o.lineTo(p[0],p[1]);break;case"M":o.moveTo(p[0],p[1]);break;case"C":o.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":o.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":const f=p[0],d=p[1],g=p[2],v=p[3],w=p[4],x=p[5],m=p[6],u=p[7],_=g>v?g:v,S=g>v?1:g/v,P=g>v?v/g:1;o.translate(f,d),o.rotate(m),o.scale(S,P),o.arc(0,0,_,w,w+x,1-u),o.scale(1/S,1/P),o.rotate(-m),o.translate(-f,-d);break;case"z":l=!0,o.closePath();break}}!l&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(d){if(d.command==="A"){const g=d.points[4],v=d.points[5],w=d.points[4]+v;let x=Math.PI/180;if(Math.abs(g-w)<x&&(x=Math.abs(g-w)),v<0)for(let m=g-x;m>w;m-=x){const u=le.getPointOnEllipticalArc(d.points[0],d.points[1],d.points[2],d.points[3],m,0);o.push(u.x,u.y)}else for(let m=g+x;m<w;m+=x){const u=le.getPointOnEllipticalArc(d.points[0],d.points[1],d.points[2],d.points[3],m,0);o.push(u.x,u.y)}}else if(d.command==="C")for(let g=0;g<=1;g+=.01){const v=le.getPointOnCubicBezier(g,d.start.x,d.start.y,d.points[0],d.points[1],d.points[2],d.points[3],d.points[4],d.points[5]);o.push(v.x,v.y)}else o=o.concat(d.points)});let a=o[0],l=o[0],c=o[1],h=o[1],p,f;for(let d=0;d<o.length/2;d++)p=o[d*2],f=o[d*2+1],isNaN(p)||(a=Math.min(a,p),l=Math.max(l,p)),isNaN(f)||(c=Math.min(c,f),h=Math.max(h,f));return{x:a,y:c,width:l-a,height:h-c}}getLength(){return this.pathLength}getPointAtLength(o){return le.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,l,c){return Math.sqrt((l-o)*(l-o)+(c-a)*(c-a))}static getPathLength(o){let a=0;for(let l=0;l<o.length;++l)a+=o[l].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let l,c=0,h=a.length;if(!h)return null;for(;c<h&&o>a[c].pathLength;)o-=a[c].pathLength,++c;if(c===h)return l=a[c-1].points.slice(-2),{x:l[0],y:l[1]};if(o<.01)return a[c].command==="M"?(l=a[c].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[c].start.x,y:a[c].start.y};const p=a[c],f=p.points;switch(p.command){case"L":return le.getPointOnLine(o,p.start.x,p.start.y,f[0],f[1]);case"C":return le.getPointOnCubicBezier((0,i.t2length)(o,le.getPathLength(a),_=>(0,i.getCubicArcLength)([p.start.x,f[0],f[2],f[4]],[p.start.y,f[1],f[3],f[5]],_)),p.start.x,p.start.y,f[0],f[1],f[2],f[3],f[4],f[5]);case"Q":return le.getPointOnQuadraticBezier((0,i.t2length)(o,le.getPathLength(a),_=>(0,i.getQuadraticArcLength)([p.start.x,f[0],f[2]],[p.start.y,f[1],f[3]],_)),p.start.x,p.start.y,f[0],f[1],f[2],f[3]);case"A":const d=f[0],g=f[1],v=f[2],w=f[3],x=f[5],m=f[6];let u=f[4];return u+=x*o/p.pathLength,le.getPointOnEllipticalArc(d,g,v,w,u,m)}return null}static getPointOnLine(o,a,l,c,h,p,f){p=p??a,f=f??l;const d=this.getLineLength(a,l,c,h);if(d<1e-10)return{x:a,y:l};if(c===a)return{x:p,y:f+(h>l?o:-o)};const g=(h-l)/(c-a),v=Math.sqrt(o*o/(1+g*g))*(c<a?-1:1),w=g*v;if(Math.abs(f-l-g*(p-a))<1e-10)return{x:p+v,y:f+w};const x=((p-a)*(c-a)+(f-l)*(h-l))/(d*d),m=a+x*(c-a),u=l+x*(h-l),_=this.getLineLength(p,f,m,u),S=Math.sqrt(o*o-_*_),P=Math.sqrt(S*S/(1+g*g))*(c<a?-1:1),I=g*P;return{x:m+P,y:u+I}}static getPointOnCubicBezier(o,a,l,c,h,p,f,d,g){function v(S){return S*S*S}function w(S){return 3*S*S*(1-S)}function x(S){return 3*S*(1-S)*(1-S)}function m(S){return(1-S)*(1-S)*(1-S)}const u=d*v(o)+p*w(o)+c*x(o)+a*m(o),_=g*v(o)+f*w(o)+h*x(o)+l*m(o);return{x:u,y:_}}static getPointOnQuadraticBezier(o,a,l,c,h,p,f){function d(m){return m*m}function g(m){return 2*m*(1-m)}function v(m){return(1-m)*(1-m)}const w=p*d(o)+c*g(o)+a*v(o),x=f*d(o)+h*g(o)+l*v(o);return{x:w,y:x}}static getPointOnEllipticalArc(o,a,l,c,h,p){const f=Math.cos(p),d=Math.sin(p),g={x:l*Math.cos(h),y:c*Math.sin(h)};return{x:o+(g.x*f-g.y*d),y:a+(g.x*d+g.y*f)}}static parsePathData(o){if(!o)return[];let a=o;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let w=0;w<l.length;w++)a=a.replace(new RegExp(l[w],"g"),"|"+l[w]);const c=a.split("|"),h=[],p=[];let f=0,d=0;const g=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let v;for(let w=1;w<c.length;w++){let x=c[w],m=x.charAt(0);for(x=x.slice(1),p.length=0;v=g.exec(x);)p.push(v[0]);const u=[];for(let _=0,S=p.length;_<S;_++){if(p[_]==="00"){u.push(0,0);continue}const P=parseFloat(p[_]);isNaN(P)?u.push(0):u.push(P)}for(;u.length>0&&!isNaN(u[0]);){let _="",S=[];const P=f,I=d;let b,C,E,N,D,G,U,z,q,y;switch(m){case"l":f+=u.shift(),d+=u.shift(),_="L",S.push(f,d);break;case"L":f=u.shift(),d=u.shift(),S.push(f,d);break;case"m":const k=u.shift(),M=u.shift();if(f+=k,d+=M,_="M",h.length>2&&h[h.length-1].command==="z"){for(let R=h.length-2;R>=0;R--)if(h[R].command==="M"){f=h[R].points[0]+k,d=h[R].points[1]+M;break}}S.push(f,d),m="l";break;case"M":f=u.shift(),d=u.shift(),_="M",S.push(f,d),m="L";break;case"h":f+=u.shift(),_="L",S.push(f,d);break;case"H":f=u.shift(),_="L",S.push(f,d);break;case"v":d+=u.shift(),_="L",S.push(f,d);break;case"V":d=u.shift(),_="L",S.push(f,d);break;case"C":S.push(u.shift(),u.shift(),u.shift(),u.shift()),f=u.shift(),d=u.shift(),S.push(f,d);break;case"c":S.push(f+u.shift(),d+u.shift(),f+u.shift(),d+u.shift()),f+=u.shift(),d+=u.shift(),_="C",S.push(f,d);break;case"S":C=f,E=d,b=h[h.length-1],b.command==="C"&&(C=f+(f-b.points[2]),E=d+(d-b.points[3])),S.push(C,E,u.shift(),u.shift()),f=u.shift(),d=u.shift(),_="C",S.push(f,d);break;case"s":C=f,E=d,b=h[h.length-1],b.command==="C"&&(C=f+(f-b.points[2]),E=d+(d-b.points[3])),S.push(C,E,f+u.shift(),d+u.shift()),f+=u.shift(),d+=u.shift(),_="C",S.push(f,d);break;case"Q":S.push(u.shift(),u.shift()),f=u.shift(),d=u.shift(),S.push(f,d);break;case"q":S.push(f+u.shift(),d+u.shift()),f+=u.shift(),d+=u.shift(),_="Q",S.push(f,d);break;case"T":C=f,E=d,b=h[h.length-1],b.command==="Q"&&(C=f+(f-b.points[0]),E=d+(d-b.points[1])),f=u.shift(),d=u.shift(),_="Q",S.push(C,E,f,d);break;case"t":C=f,E=d,b=h[h.length-1],b.command==="Q"&&(C=f+(f-b.points[0]),E=d+(d-b.points[1])),f+=u.shift(),d+=u.shift(),_="Q",S.push(C,E,f,d);break;case"A":N=u.shift(),D=u.shift(),G=u.shift(),U=u.shift(),z=u.shift(),q=f,y=d,f=u.shift(),d=u.shift(),_="A",S=this.convertEndpointToCenterParameterization(q,y,f,d,U,z,N,D,G);break;case"a":N=u.shift(),D=u.shift(),G=u.shift(),U=u.shift(),z=u.shift(),q=f,y=d,f+=u.shift(),d+=u.shift(),_="A",S=this.convertEndpointToCenterParameterization(q,y,f,d,U,z,N,D,G);break}h.push({command:_||m,points:S,start:{x:P,y:I},pathLength:this.calcLength(P,I,_||m,S)})}(m==="z"||m==="Z")&&h.push({command:"z",points:[],start:void 0,pathLength:0})}return h}static calcLength(o,a,l,c){let h,p,f,d;const g=le;switch(l){case"L":return g.getLineLength(o,a,c[0],c[1]);case"C":return(0,i.getCubicArcLength)([o,c[0],c[2],c[4]],[a,c[1],c[3],c[5]],1);case"Q":return(0,i.getQuadraticArcLength)([o,c[0],c[2]],[a,c[1],c[3]],1);case"A":h=0;const v=c[4],w=c[5],x=c[4]+w;let m=Math.PI/180;if(Math.abs(v-x)<m&&(m=Math.abs(v-x)),p=g.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],v,0),w<0)for(d=v-m;d>x;d-=m)f=g.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],d,0),h+=g.getLineLength(p.x,p.y,f.x,f.y),p=f;else for(d=v+m;d<x;d+=m)f=g.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],d,0),h+=g.getLineLength(p.x,p.y,f.x,f.y),p=f;return f=g.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],x,0),h+=g.getLineLength(p.x,p.y,f.x,f.y),h}return 0}static convertEndpointToCenterParameterization(o,a,l,c,h,p,f,d,g){const v=g*(Math.PI/180),w=Math.cos(v)*(o-l)/2+Math.sin(v)*(a-c)/2,x=-1*Math.sin(v)*(o-l)/2+Math.cos(v)*(a-c)/2,m=w*w/(f*f)+x*x/(d*d);m>1&&(f*=Math.sqrt(m),d*=Math.sqrt(m));let u=Math.sqrt((f*f*(d*d)-f*f*(x*x)-d*d*(w*w))/(f*f*(x*x)+d*d*(w*w)));h===p&&(u*=-1),isNaN(u)&&(u=0);const _=u*f*x/d,S=u*-d*w/f,P=(o+l)/2+Math.cos(v)*_-Math.sin(v)*S,I=(a+c)/2+Math.sin(v)*_+Math.cos(v)*S,b=function(z){return Math.sqrt(z[0]*z[0]+z[1]*z[1])},C=function(z,q){return(z[0]*q[0]+z[1]*q[1])/(b(z)*b(q))},E=function(z,q){return(z[0]*q[1]<z[1]*q[0]?-1:1)*Math.acos(C(z,q))},N=E([1,0],[(w-_)/f,(x-S)/d]),D=[(w-_)/f,(x-S)/d],G=[(-1*w-_)/f,(-1*x-S)/d];let U=E(D,G);return C(D,G)<=-1&&(U=Math.PI),C(D,G)>=1&&(U=0),p===0&&U>0&&(U=U-2*Math.PI),p===1&&U<0&&(U=U+2*Math.PI),[P,I,f,d,N,U,v,p]}};return gi.Path=r,r.prototype.className="Path",r.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(r),t.Factory.addGetterSetter(r,"data"),gi}var Ll;function Df(){if(Ll)return di;Ll=1,Object.defineProperty(di,"__esModule",{value:!0}),di.Arrow=void 0;const t=yt(),e=Fl(),n=St(),i=bt(),r=Zs();let s=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,c=this.points();let h=c;const p=this.tension()!==0&&c.length>4;p&&(h=this.getTensionPoints());const f=this.pointerLength(),d=c.length;let g,v;if(p){const m=[h[h.length-4],h[h.length-3],h[h.length-2],h[h.length-1],c[d-2],c[d-1]],u=r.Path.calcLength(h[h.length-4],h[h.length-3],"C",m),_=r.Path.getPointOnQuadraticBezier(Math.min(1,1-f/u),m[0],m[1],m[2],m[3],m[4],m[5]);g=c[d-2]-_.x,v=c[d-1]-_.y}else g=c[d-2]-c[d-4],v=c[d-1]-c[d-3];const w=(Math.atan2(v,g)+l)%l,x=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(c[d-2],c[d-1]),a.rotate(w),a.moveTo(0,0),a.lineTo(-f,x/2),a.lineTo(-f,-x/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(c[0],c[1]),p?(g=(h[0]+h[2])/2-c[0],v=(h[1]+h[3])/2-c[1]):(g=c[2]-c[0],v=c[3]-c[1]),a.rotate((Math.atan2(-v,-g)+l)%l),a.moveTo(0,0),a.lineTo(-f,x/2),a.lineTo(-f,-x/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return di.Arrow=s,s.prototype.className="Arrow",(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"pointerLength",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"pointerWidth",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"pointerAtBeginning",!1),t.Factory.addGetterSetter(s,"pointerAtEnding",!0),di}var pi={},Gl;function zf(){if(Gl)return pi;Gl=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Circle=void 0;const t=yt(),e=Wt(),n=St(),i=bt();let r=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}};return pi.Circle=r,r.prototype._centroid=!0,r.prototype.className="Circle",r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,n.getNumberValidator)()),pi}var mi={},Ul;function Lf(){if(Ul)return mi;Ul=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.Ellipse=void 0;const t=yt(),e=Wt(),n=St(),i=bt();let r=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),l=this.radiusY();o.beginPath(),o.save(),a!==l&&o.scale(1,l/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return mi.Ellipse=r,r.prototype.className="Ellipse",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(r),t.Factory.addComponentsGetterSetter(r,"radius",["x","y"]),t.Factory.addGetterSetter(r,"radiusX",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"radiusY",0,(0,n.getNumberValidator)()),mi}var _i={},Hl;function Gf(){if(Hl)return _i;Hl=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.Image=void 0;const t=Lt(),e=yt(),n=Wt(),i=bt(),r=St();let s=class Zh extends n.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),c=this.getHeight(),h=this.cornerRadius(),p=this.attrs.image;let f;if(p){const d=this.attrs.cropWidth,g=this.attrs.cropHeight;d&&g?f=[p,this.cropX(),this.cropY(),d,g,0,0,l,c]:f=[p,0,0,l,c]}(this.hasFill()||this.hasStroke()||h)&&(a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)),p&&(h&&a.clip(),a.drawImage.apply(a,f))}_hitFunc(a){const l=this.width(),c=this.height(),h=this.cornerRadius();a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,c=null){const h=t.Util.createImageElement();h.onload=function(){const p=new Zh({image:h});l(p)},h.onerror=c,h.crossOrigin="Anonymous",h.src=a}};return _i.Image=s,s.prototype.className="Image",(0,i._registerNode)(s),e.Factory.addGetterSetter(s,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(s,"image"),e.Factory.addComponentsGetterSetter(s,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(s,"cropX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropY",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropWidth",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropHeight",0,(0,r.getNumberValidator)()),_i}var hn={},Bl;function Uf(){if(Bl)return hn;Bl=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.Tag=hn.Label=void 0;const t=yt(),e=Wt(),n=Vs(),i=St(),r=bt(),s=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",l="up",c="right",h="down",p="left",f=s.length;let d=class extends n.Group{constructor(w){super(w),this.on("add.konva",function(x){this._addListeners(x.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(w){let x=this,m;const u=function(){x._sync()};for(m=0;m<f;m++)w.on(s[m]+o,u)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let w=this.getText(),x=this.getTag(),m,u,_,S,P,I,b;if(w&&x){switch(m=w.width(),u=w.height(),_=x.pointerDirection(),S=x.pointerWidth(),b=x.pointerHeight(),P=0,I=0,_){case l:P=m/2,I=-1*b;break;case c:P=m+S,I=u/2;break;case h:P=m/2,I=u+b;break;case p:P=-1*S,I=u/2;break}x.setAttrs({x:-1*P,y:-1*I,width:m,height:u}),w.setAttrs({x:-1*P,y:-1*I})}}};hn.Label=d,d.prototype.className="Label",(0,r._registerNode)(d);class g extends e.Shape{_sceneFunc(w){const x=this.width(),m=this.height(),u=this.pointerDirection(),_=this.pointerWidth(),S=this.pointerHeight(),P=this.cornerRadius();let I=0,b=0,C=0,E=0;typeof P=="number"?I=b=C=E=Math.min(P,x/2,m/2):(I=Math.min(P[0]||0,x/2,m/2),b=Math.min(P[1]||0,x/2,m/2),E=Math.min(P[2]||0,x/2,m/2),C=Math.min(P[3]||0,x/2,m/2)),w.beginPath(),w.moveTo(I,0),u===l&&(w.lineTo((x-_)/2,0),w.lineTo(x/2,-1*S),w.lineTo((x+_)/2,0)),w.lineTo(x-b,0),w.arc(x-b,b,b,Math.PI*3/2,0,!1),u===c&&(w.lineTo(x,(m-S)/2),w.lineTo(x+_,m/2),w.lineTo(x,(m+S)/2)),w.lineTo(x,m-E),w.arc(x-E,m-E,E,0,Math.PI/2,!1),u===h&&(w.lineTo((x+_)/2,m),w.lineTo(x/2,m+S),w.lineTo((x-_)/2,m)),w.lineTo(C,m),w.arc(C,m-C,C,Math.PI/2,Math.PI,!1),u===p&&(w.lineTo(0,(m+S)/2),w.lineTo(-1*_,m/2),w.lineTo(0,(m-S)/2)),w.lineTo(0,I),w.arc(I,I,I,Math.PI,Math.PI*3/2,!1),w.closePath(),w.fillStrokeShape(this)}getSelfRect(){let w=0,x=0,m=this.pointerWidth(),u=this.pointerHeight(),_=this.pointerDirection(),S=this.width(),P=this.height();return _===l?(x-=u,P+=u):_===h?P+=u:_===p?(w-=m*1.5,S+=m):_===c&&(S+=m*1.5),{x:w,y:x,width:S,height:P}}}return hn.Tag=g,g.prototype.className="Tag",(0,r._registerNode)(g),t.Factory.addGetterSetter(g,"pointerDirection",a),t.Factory.addGetterSetter(g,"pointerWidth",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(g,"pointerHeight",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(g,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),hn}var vi={},Vl;function $l(){if(Vl)return vi;Vl=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.Rect=void 0;const t=yt(),e=Wt(),n=bt(),i=Lt(),r=St();let s=class extends e.Shape{_sceneFunc(a){const l=this.cornerRadius(),c=this.width(),h=this.height();a.beginPath(),l?i.Util.drawRoundedRectPath(a,c,h,l):a.rect(0,0,c,h),a.closePath(),a.fillStrokeShape(this)}};return vi.Rect=s,s.prototype.className="Rect",(0,n._registerNode)(s),t.Factory.addGetterSetter(s,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),vi}var bi={},Wl;function Hf(){if(Wl)return bi;Wl=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.RegularPolygon=void 0;const t=yt(),e=Wt(),n=St(),i=bt();let r=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)o.lineTo(a[l].x,a[l].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let c=0;c<o;c++)l.push({x:a*Math.sin(c*2*Math.PI/o),y:-1*a*Math.cos(c*2*Math.PI/o)});return l}getSelfRect(){const o=this._getPoints();let a=o[0].x,l=o[0].y,c=o[0].x,h=o[0].y;return o.forEach(p=>{a=Math.min(a,p.x),l=Math.max(l,p.x),c=Math.min(c,p.y),h=Math.max(h,p.y)}),{x:a,y:c,width:l-a,height:h-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return bi.RegularPolygon=r,r.prototype.className="RegularPolygon",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"sides",0,(0,n.getNumberValidator)()),bi}var yi={},jl;function Bf(){if(jl)return yi;jl=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.Ring=void 0;const t=yt(),e=Wt(),n=St(),i=bt(),r=Math.PI*2;let s=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,r,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),r,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return yi.Ring=s,s.prototype.className="Ring",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,n.getNumberValidator)()),yi}var Si={},Zl;function Vf(){if(Zl)return Si;Zl=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.Sprite=void 0;const t=yt(),e=Wt(),n=$s(),i=St(),r=bt();let s=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new n.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,p=this.animations()[l],f=this.frameOffsets(),d=p[h+0],g=p[h+1],v=p[h+2],w=p[h+3],x=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,v,w),a.closePath(),a.fillStrokeShape(this)),x)if(f){const m=f[l],u=c*2;a.drawImage(x,d,g,v,w,m[u+0],m[u+1],v,w)}else a.drawImage(x,d,g,v,w,0,0,v,w)}_hitFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,p=this.animations()[l],f=this.frameOffsets(),d=p[h+2],g=p[h+3];if(a.beginPath(),f){const v=f[l],w=c*2;a.rect(v[w+0],v[w+1],d,g)}else a.rect(0,0,d,g);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),c=this.animations(),h=c[l],p=h.length/4;a<p-1?this.frameIndex(a+1):this.frameIndex(0)}};return Si.Sprite=s,s.prototype.className="Sprite",(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"animation"),t.Factory.addGetterSetter(s,"animations"),t.Factory.addGetterSetter(s,"frameOffsets"),t.Factory.addGetterSetter(s,"image"),t.Factory.addGetterSetter(s,"frameIndex",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"frameRate",17,(0,i.getNumberValidator)()),t.Factory.backCompat(s,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Si}var wi={},ql;function $f(){if(ql)return wi;ql=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.Star=void 0;const t=yt(),e=Wt(),n=St(),i=bt();let r=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),l=this.outerRadius(),c=this.numPoints();o.beginPath(),o.moveTo(0,0-l);for(let h=1;h<c*2;h++){const p=h%2===0?l:a,f=p*Math.sin(h*Math.PI/c),d=-1*p*Math.cos(h*Math.PI/c);o.lineTo(f,d)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return wi.Star=r,r.prototype.className="Star",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"numPoints",5,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,n.getNumberValidator)()),wi}var Cn={},Kl;function Yl(){if(Kl)return Cn;Kl=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.Text=void 0,Cn.stringToArray=o;const t=Lt(),e=yt(),n=Wt(),i=bt(),r=St(),s=bt();function o($){return[...$].reduce((L,Y,X,H)=>{if(/\p{Emoji}/u.test(Y)){const A=H[X+1];A&&/\p{Emoji_Modifier}|\u200D/u.test(A)?(L.push(Y+A),H[X+1]=""):L.push(Y)}else/\p{Regional_Indicator}{2}/u.test(Y+(H[X+1]||""))?L.push(Y+H[X+1]):X>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(Y)?L[L.length-1]+=Y:Y&&L.push(Y);return L},[])}const a="auto",l="center",c="inherit",h="justify",p="Change.konva",f="2d",d="-",g="left",v="text",w="Text",x="top",m="bottom",u="middle",_="normal",S="px ",P=" ",I="right",b="rtl",C="word",E="char",N="none",D="",G=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],U=G.length;function z($){return $.split(",").map(L=>{L=L.trim();const Y=L.indexOf(" ")>=0,X=L.indexOf('"')>=0||L.indexOf("'")>=0;return Y&&!X&&(L=`"${L}"`),L}).join(", ")}let q;function y(){return q||(q=t.Util.createCanvasElement().getContext(f),q)}function k($){$.fillText(this._partialText,this._partialTextX,this._partialTextY)}function M($){$.setAttr("miterLimit",2),$.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function R($){return $=$||{},!$.fillLinearGradientColorStops&&!$.fillRadialGradientColorStops&&!$.fillPatternImage&&($.fill=$.fill||"black"),$}let F=class extends n.Shape{constructor(L){super(R(L)),this._partialTextX=0,this._partialTextY=0;for(let Y=0;Y<U;Y++)this.on(G[Y]+p,this._setTextData);this._setTextData()}_sceneFunc(L){const Y=this.textArr,X=Y.length;if(!this.text())return;let H=this.padding(),A=this.fontSize(),B=this.lineHeight()*A,et=this.verticalAlign(),st=this.direction(),ct=0,T=this.align(),O=this.getWidth(),V=this.letterSpacing(),W=this.fill(),K=this.textDecoration(),j=K.indexOf("underline")!==-1,J=K.indexOf("line-through")!==-1,nt;st=st===c?L.direction:st;let tt=B/2,Q=u;if(i.Konva._fixTextRendering){const ot=this.measureSize("M");Q="alphabetic",tt=(ot.fontBoundingBoxAscent-ot.fontBoundingBoxDescent)/2+B/2}for(st===b&&L.setAttr("direction",st),L.setAttr("font",this._getContextFont()),L.setAttr("textBaseline",Q),L.setAttr("textAlign",g),et===u?ct=(this.getHeight()-X*B-H*2)/2:et===m&&(ct=this.getHeight()-X*B-H*2),L.translate(H,ct+H),nt=0;nt<X;nt++){let ot=0,it=0;const lt=Y[nt],ut=lt.text,dt=lt.width,vt=lt.lastInParagraph;if(L.save(),T===I?ot+=O-dt-H*2:T===l&&(ot+=(O-dt-H*2)/2),j){L.save(),L.beginPath();const _t=i.Konva._fixTextRendering?Math.round(A/4):Math.round(A/2),Pt=ot,xt=tt+it+_t;L.moveTo(Pt,xt);const At=T===h&&!vt?O-H*2:dt;L.lineTo(Pt+Math.round(At),xt),L.lineWidth=A/15;const jt=this._getLinearGradient();L.strokeStyle=jt||W,L.stroke(),L.restore()}if(J){L.save(),L.beginPath();const _t=i.Konva._fixTextRendering?-Math.round(A/4):0;L.moveTo(ot,tt+it+_t);const Pt=T===h&&!vt?O-H*2:dt;L.lineTo(ot+Math.round(Pt),tt+it+_t),L.lineWidth=A/15;const xt=this._getLinearGradient();L.strokeStyle=xt||W,L.stroke(),L.restore()}if(st!==b&&(V!==0||T===h)){const _t=ut.split(" ").length-1,Pt=o(ut);for(let xt=0;xt<Pt.length;xt++){const At=Pt[xt];At===" "&&!vt&&T===h&&(ot+=(O-H*2-dt)/_t),this._partialTextX=ot,this._partialTextY=tt+it,this._partialText=At,L.fillStrokeShape(this),ot+=this.measureSize(At).width+V}}else V!==0&&L.setAttr("letterSpacing",`${V}px`),this._partialTextX=ot,this._partialTextY=tt+it,this._partialText=ut,L.fillStrokeShape(this);L.restore(),X>1&&(tt+=B)}}_hitFunc(L){const Y=this.getWidth(),X=this.getHeight();L.beginPath(),L.rect(0,0,Y,X),L.closePath(),L.fillStrokeShape(this)}setText(L){const Y=t.Util._isString(L)?L:L==null?"":L+"";return this._setAttr(v,Y),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(L){var Y,X,H,A,B,et,st,ct,T,O,V;let W=y(),K=this.fontSize(),j;W.save(),W.font=this._getContextFont(),j=W.measureText(L),W.restore();const J=K/100;return{actualBoundingBoxAscent:(Y=j.actualBoundingBoxAscent)!==null&&Y!==void 0?Y:71.58203125*J,actualBoundingBoxDescent:(X=j.actualBoundingBoxDescent)!==null&&X!==void 0?X:0,actualBoundingBoxLeft:(H=j.actualBoundingBoxLeft)!==null&&H!==void 0?H:-7.421875*J,actualBoundingBoxRight:(A=j.actualBoundingBoxRight)!==null&&A!==void 0?A:75.732421875*J,alphabeticBaseline:(B=j.alphabeticBaseline)!==null&&B!==void 0?B:0,emHeightAscent:(et=j.emHeightAscent)!==null&&et!==void 0?et:100*J,emHeightDescent:(st=j.emHeightDescent)!==null&&st!==void 0?st:-20*J,fontBoundingBoxAscent:(ct=j.fontBoundingBoxAscent)!==null&&ct!==void 0?ct:91*J,fontBoundingBoxDescent:(T=j.fontBoundingBoxDescent)!==null&&T!==void 0?T:21*J,hangingBaseline:(O=j.hangingBaseline)!==null&&O!==void 0?O:72.80000305175781*J,ideographicBaseline:(V=j.ideographicBaseline)!==null&&V!==void 0?V:-21*J,width:j.width,height:K}}_getContextFont(){return this.fontStyle()+P+this.fontVariant()+P+(this.fontSize()+S)+z(this.fontFamily())}_addTextLine(L){this.align()===h&&(L=L.trim());const X=this._getTextWidth(L);return this.textArr.push({text:L,width:X,lastInParagraph:!1})}_getTextWidth(L){const Y=this.letterSpacing(),X=L.length;return y().measureText(L).width+Y*X}_setTextData(){let L=this.text().split(`
`),Y=+this.fontSize(),X=0,H=this.lineHeight()*Y,A=this.attrs.width,B=this.attrs.height,et=A!==a&&A!==void 0,st=B!==a&&B!==void 0,ct=this.padding(),T=A-ct*2,O=B-ct*2,V=0,W=this.wrap(),K=W!==N,j=W!==E&&K,J=this.ellipsis();this.textArr=[],y().font=this._getContextFont();const nt=J?this._getTextWidth(D):0;for(let tt=0,Q=L.length;tt<Q;++tt){let ot=L[tt],it=this._getTextWidth(ot);if(et&&it>T)for(;ot.length>0;){let lt=0,ut=o(ot).length,dt="",vt=0;for(;lt<ut;){const _t=lt+ut>>>1,Pt=o(ot),xt=Pt.slice(0,_t+1).join(""),At=this._getTextWidth(xt);(J&&st&&V+H>O?At+nt:At)<=T?(lt=_t+1,dt=xt,vt=At):ut=_t}if(dt){if(j){const xt=o(ot),At=o(dt),jt=xt[At.length],_e=jt===P||jt===d;let He;if(_e&&vt<=T)He=At.length;else{const Kt=At.lastIndexOf(P),ae=At.lastIndexOf(d);He=Math.max(Kt,ae)+1}He>0&&(lt=He,dt=xt.slice(0,lt).join(""),vt=this._getTextWidth(dt))}if(dt=dt.trimRight(),this._addTextLine(dt),X=Math.max(X,vt),V+=H,this._shouldHandleEllipsis(V)){this._tryToAddEllipsisToLastLine();break}if(ot=o(ot).slice(lt).join("").trimLeft(),ot.length>0&&(it=this._getTextWidth(ot),it<=T)){this._addTextLine(ot),V+=H,X=Math.max(X,it);break}}else break}else this._addTextLine(ot),V+=H,X=Math.max(X,it),this._shouldHandleEllipsis(V)&&tt<Q-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),st&&V+H>O)break}this.textHeight=Y,this.textWidth=X}_shouldHandleEllipsis(L){const Y=+this.fontSize(),X=this.lineHeight()*Y,H=this.attrs.height,A=H!==a&&H!==void 0,B=this.padding(),et=H-B*2;return!(this.wrap()!==N)||A&&L+X>et}_tryToAddEllipsisToLastLine(){const L=this.attrs.width,Y=L!==a&&L!==void 0,X=this.padding(),H=L-X*2,A=this.ellipsis(),B=this.textArr[this.textArr.length-1];!B||!A||(Y&&(this._getTextWidth(B.text+D)<H||(B.text=B.text.slice(0,B.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(B.text+D))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const L=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,Y=this.hasShadow();return L&&Y?!0:super._useBufferCanvas()}};return Cn.Text=F,F.prototype._fillFunc=k,F.prototype._strokeFunc=M,F.prototype.className=w,F.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,s._registerNode)(F),e.Factory.overWriteSetter(F,"width",(0,r.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(F,"height",(0,r.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(F,"direction",c),e.Factory.addGetterSetter(F,"fontFamily","Arial"),e.Factory.addGetterSetter(F,"fontSize",12,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"fontStyle",_),e.Factory.addGetterSetter(F,"fontVariant",_),e.Factory.addGetterSetter(F,"padding",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"align",g),e.Factory.addGetterSetter(F,"verticalAlign",x),e.Factory.addGetterSetter(F,"lineHeight",1,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"wrap",C),e.Factory.addGetterSetter(F,"ellipsis",!1,(0,r.getBooleanValidator)()),e.Factory.addGetterSetter(F,"letterSpacing",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"text","",(0,r.getStringValidator)()),e.Factory.addGetterSetter(F,"textDecoration",""),Cn}var xi={},Xl;function Wf(){if(Xl)return xi;Xl=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.TextPath=void 0;const t=Lt(),e=yt(),n=Wt(),i=Zs(),r=Yl(),s=St(),o=bt(),a="",l="normal";function c(f){f.fillText(this.partialText,0,0)}function h(f){f.strokeText(this.partialText,0,0)}let p=class extends n.Shape{constructor(d){super(d),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(d){if(!this.attrs.data)return null;const g=this.pathLength;return d-1>g?null:i.Path.getPointAtLengthOfDataArray(d,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(d){d.setAttr("font",this._getContextFont()),d.setAttr("textBaseline",this.textBaseline()),d.setAttr("textAlign","left"),d.save();const g=this.textDecoration(),v=this.fill(),w=this.fontSize(),x=this.glyphInfo;g==="underline"&&d.beginPath();for(let m=0;m<x.length;m++){d.save();const u=x[m].p0;d.translate(u.x,u.y),d.rotate(x[m].rotation),this.partialText=x[m].text,d.fillStrokeShape(this),g==="underline"&&(m===0&&d.moveTo(0,w/2+1),d.lineTo(w,w/2+1)),d.restore()}g==="underline"&&(d.strokeStyle=v,d.lineWidth=w/20,d.stroke()),d.restore()}_hitFunc(d){d.beginPath();const g=this.glyphInfo;if(g.length>=1){const v=g[0].p0;d.moveTo(v.x,v.y)}for(let v=0;v<g.length;v++){const w=g[v].p1;d.lineTo(w.x,w.y)}d.setAttr("lineWidth",this.fontSize()),d.setAttr("strokeStyle",this.colorKey),d.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(d){return r.Text.prototype.setText.call(this,d)}_getContextFont(){return r.Text.prototype._getContextFont.call(this)}_getTextSize(d){const v=this.dummyCanvas.getContext("2d");v.save(),v.font=this._getContextFont();const w=v.measureText(d);return v.restore(),{width:w.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:d,height:g}=this._getTextSize(this.attrs.text);if(this.textWidth=d,this.textHeight=g,this.glyphInfo=[],!this.attrs.data)return null;const v=this.letterSpacing(),w=this.align(),x=this.kerningFunc(),m=Math.max(this.textWidth+((this.attrs.text||"").length-1)*v,0);let u=0;w==="center"&&(u=Math.max(0,this.pathLength/2-m/2)),w==="right"&&(u=Math.max(0,this.pathLength-m));const _=(0,r.stringToArray)(this.text());let S=u;for(let P=0;P<_.length;P++){const I=this._getPointAtLength(S);if(!I)return;let b=this._getTextSize(_[P]).width+v;if(_[P]===" "&&w==="justify"){const U=this.text().split(" ").length-1;b+=(this.pathLength-m)/U}const C=this._getPointAtLength(S+b);if(!C)return;const E=i.Path.getLineLength(I.x,I.y,C.x,C.y);let N=0;if(x)try{N=x(_[P-1],_[P])*this.fontSize()}catch{N=0}I.x+=N,C.x+=N,this.textWidth+=N;const D=i.Path.getPointOnLine(N+E/2,I.x,I.y,C.x,C.y),G=Math.atan2(C.y-I.y,C.x-I.x);this.glyphInfo.push({transposeX:D.x,transposeY:D.y,text:_[P],rotation:G,p0:I,p1:C}),S+=b}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const d=[];this.glyphInfo.forEach(function(S){d.push(S.p0.x),d.push(S.p0.y),d.push(S.p1.x),d.push(S.p1.y)});let g=d[0]||0,v=d[0]||0,w=d[1]||0,x=d[1]||0,m,u;for(let S=0;S<d.length/2;S++)m=d[S*2],u=d[S*2+1],g=Math.min(g,m),v=Math.max(v,m),w=Math.min(w,u),x=Math.max(x,u);const _=this.fontSize();return{x:g-_/2,y:w-_/2,width:v-g+_,height:x-w+_}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return xi.TextPath=p,p.prototype._fillFunc=c,p.prototype._strokeFunc=h,p.prototype._fillFuncHit=c,p.prototype._strokeFuncHit=h,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(p),e.Factory.addGetterSetter(p,"data"),e.Factory.addGetterSetter(p,"fontFamily","Arial"),e.Factory.addGetterSetter(p,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(p,"fontStyle",l),e.Factory.addGetterSetter(p,"align","left"),e.Factory.addGetterSetter(p,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(p,"textBaseline","middle"),e.Factory.addGetterSetter(p,"fontVariant",l),e.Factory.addGetterSetter(p,"text",a),e.Factory.addGetterSetter(p,"textDecoration",""),e.Factory.addGetterSetter(p,"kerningFunc",void 0),xi}var Ci={},Ql;function jf(){if(Ql)return Ci;Ql=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.Transformer=void 0;const t=Lt(),e=yt(),n=Ht(),i=Wt(),r=$l(),s=Vs(),o=bt(),a=St(),l=bt(),c="tr-konva",h=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(b=>b+`.${c}`).join(" "),p="nodesRect",f=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],d={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},g="ontouchstart"in o.Konva._global;function v(b,C,E){if(b==="rotater")return E;C+=t.Util.degToRad(d[b]||0);const N=(t.Util.radToDeg(C)%360+360)%360;return t.Util._inRange(N,337.5,360)||t.Util._inRange(N,0,22.5)?"ns-resize":t.Util._inRange(N,22.5,67.5)?"nesw-resize":t.Util._inRange(N,67.5,112.5)?"ew-resize":t.Util._inRange(N,112.5,157.5)?"nwse-resize":t.Util._inRange(N,157.5,202.5)?"ns-resize":t.Util._inRange(N,202.5,247.5)?"nesw-resize":t.Util._inRange(N,247.5,292.5)?"ew-resize":t.Util._inRange(N,292.5,337.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+N),"pointer")}const w=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function x(b){return{x:b.x+b.width/2*Math.cos(b.rotation)+b.height/2*Math.sin(-b.rotation),y:b.y+b.height/2*Math.cos(b.rotation)+b.width/2*Math.sin(b.rotation)}}function m(b,C,E){const N=E.x+(b.x-E.x)*Math.cos(C)-(b.y-E.y)*Math.sin(C),D=E.y+(b.x-E.x)*Math.sin(C)+(b.y-E.y)*Math.cos(C);return{...b,rotation:b.rotation+C,x:N,y:D}}function u(b,C){const E=x(b);return m(b,C,E)}function _(b,C,E){let N=C;for(let D=0;D<b.length;D++){const G=o.Konva.getAngle(b[D]),U=Math.abs(G-C)%(Math.PI*2);Math.min(U,Math.PI*2-U)<E&&(N=G)}return N}let S=0,P=class extends s.Group{constructor(C){super(C),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(h,this.update),this.getNode()&&this.update()}attachTo(C){return this.setNode(C),this}setNode(C){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([C])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(C=[]){this._nodes&&this._nodes.length&&this.detach();const E=C.filter(D=>D.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=C=E,C.length===1&&this.useSingleNodeRotation()?this.rotation(C[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(D=>{const G=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(D._attrsAffectingSize.length){const U=D._attrsAffectingSize.map(z=>z+"Change."+this._getEventNamespace()).join(" ");D.on(U,G)}D.on(f.map(U=>U+`.${this._getEventNamespace()}`).join(" "),G),D.on(`absoluteTransformChange.${this._getEventNamespace()}`,G),this._proxyDrag(D)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(C){let E;C.on(`dragstart.${this._getEventNamespace()}`,N=>{E=C.getAbsolutePosition(),!this.isDragging()&&C!==this.findOne(".back")&&this.startDrag(N,!1)}),C.on(`dragmove.${this._getEventNamespace()}`,N=>{if(!E)return;const D=C.getAbsolutePosition(),G=D.x-E.x,U=D.y-E.y;this.nodes().forEach(z=>{if(z===C||z.isDragging())return;const q=z.getAbsolutePosition();z.setAbsolutePosition({x:q.x+G,y:q.y+U}),z.startDrag(N)}),E=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(C=>{C.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(C,E=this.rotation(),N){const D=C.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),G=C.getAbsoluteScale(N),U=C.getAbsolutePosition(N),z=D.x*G.x-C.offsetX()*G.x,q=D.y*G.y-C.offsetY()*G.y,y=(o.Konva.getAngle(C.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),k={x:U.x+z*Math.cos(y)+q*Math.sin(-y),y:U.y+q*Math.cos(y)+z*Math.sin(y),width:D.width*G.x,height:D.height*G.y,rotation:y};return m(k,-o.Konva.getAngle(E),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const E=[];this.nodes().map(y=>{const k=y.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),M=[{x:k.x,y:k.y},{x:k.x+k.width,y:k.y},{x:k.x+k.width,y:k.y+k.height},{x:k.x,y:k.y+k.height}],R=y.getAbsoluteTransform();M.forEach(function(F){const $=R.point(F);E.push($)})});const N=new t.Transform;N.rotate(-o.Konva.getAngle(this.rotation()));let D=1/0,G=1/0,U=-1/0,z=-1/0;E.forEach(function(y){const k=N.point(y);D===void 0&&(D=U=k.x,G=z=k.y),D=Math.min(D,k.x),G=Math.min(G,k.y),U=Math.max(U,k.x),z=Math.max(z,k.y)}),N.invert();const q=N.point({x:D,y:G});return{x:q.x,y:q.y,width:U-D,height:z-G,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),w.forEach(C=>{this._createAnchor(C)}),this._createAnchor("rotater")}_createAnchor(C){const E=new r.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:C+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:g?10:"auto"}),N=this;E.on("mousedown touchstart",function(D){N._handleMouseDown(D)}),E.on("dragstart",D=>{E.stopDrag(),D.cancelBubble=!0}),E.on("dragend",D=>{D.cancelBubble=!0}),E.on("mouseenter",()=>{const D=o.Konva.getAngle(this.rotation()),G=this.rotateAnchorCursor(),U=v(C,D,G);E.getStage().content&&(E.getStage().content.style.cursor=U),this._cursorChange=!0}),E.on("mouseout",()=>{E.getStage().content&&(E.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(E)}_createBack(){const C=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(E,N){const D=N.getParent(),G=D.padding();E.beginPath(),E.rect(-G,-G,N.width()+G*2,N.height()+G*2),E.moveTo(N.width()/2,-G),D.rotateEnabled()&&D.rotateLineVisible()&&E.lineTo(N.width()/2,-D.rotateAnchorOffset()*t.Util._sign(N.height())-G),E.fillStrokeShape(N)},hitFunc:(E,N)=>{if(!this.shouldOverdrawWholeArea())return;const D=this.padding();E.beginPath(),E.rect(-D,-D,N.width()+D*2,N.height()+D*2),E.fillStrokeShape(N)}});this.add(C),this._proxyDrag(C),C.on("dragstart",E=>{E.cancelBubble=!0}),C.on("dragmove",E=>{E.cancelBubble=!0}),C.on("dragend",E=>{E.cancelBubble=!0}),this.on("dragmove",E=>{this.update()})}_handleMouseDown(C){if(this._transforming)return;this._movingAnchorName=C.target.name().split(" ")[0];const E=this._getNodeRect(),N=E.width,D=E.height,G=Math.sqrt(Math.pow(N,2)+Math.pow(D,2));this.sin=Math.abs(D/G),this.cos=Math.abs(N/G),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const U=C.target.getAbsolutePosition(),z=C.target.getStage().getPointerPosition();this._anchorDragOffset={x:z.x-U.x,y:z.y-U.y},S++,this._fire("transformstart",{evt:C.evt,target:this.getNode()}),this._nodes.forEach(q=>{q._fire("transformstart",{evt:C.evt,target:q})})}_handleMouseMove(C){let E,N,D;const G=this.findOne("."+this._movingAnchorName),U=G.getStage();U.setPointersPositions(C);const z=U.getPointerPosition();let q={x:z.x-this._anchorDragOffset.x,y:z.y-this._anchorDragOffset.y};const y=G.getAbsolutePosition();this.anchorDragBoundFunc()&&(q=this.anchorDragBoundFunc()(y,q,C)),G.setAbsolutePosition(q);const k=G.getAbsolutePosition();if(y.x===k.x&&y.y===k.y)return;if(this._movingAnchorName==="rotater"){const H=this._getNodeRect();E=G.x()-H.width/2,N=-G.y()+H.height/2;let A=Math.atan2(-N,E)+Math.PI/2;H.height<0&&(A-=Math.PI);const et=o.Konva.getAngle(this.rotation())+A,st=o.Konva.getAngle(this.rotationSnapTolerance()),T=_(this.rotationSnaps(),et,st)-H.rotation,O=u(H,T);this._fitNodesInto(O,C);return}const M=this.shiftBehavior();let R;M==="inverted"?R=this.keepRatio()&&!C.shiftKey:M==="none"?R=this.keepRatio():R=this.keepRatio()||C.shiftKey;let F=this.centeredScaling()||C.altKey;if(this._movingAnchorName==="top-left"){if(R){const H=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};D=Math.sqrt(Math.pow(H.x-G.x(),2)+Math.pow(H.y-G.y(),2));const A=this.findOne(".top-left").x()>H.x?-1:1,B=this.findOne(".top-left").y()>H.y?-1:1;E=D*this.cos*A,N=D*this.sin*B,this.findOne(".top-left").x(H.x-E),this.findOne(".top-left").y(H.y-N)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(G.y());else if(this._movingAnchorName==="top-right"){if(R){const H=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};D=Math.sqrt(Math.pow(G.x()-H.x,2)+Math.pow(H.y-G.y(),2));const A=this.findOne(".top-right").x()<H.x?-1:1,B=this.findOne(".top-right").y()>H.y?-1:1;E=D*this.cos*A,N=D*this.sin*B,this.findOne(".top-right").x(H.x+E),this.findOne(".top-right").y(H.y-N)}var $=G.position();this.findOne(".top-left").y($.y),this.findOne(".bottom-right").x($.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(G.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(G.x());else if(this._movingAnchorName==="bottom-left"){if(R){const H=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};D=Math.sqrt(Math.pow(H.x-G.x(),2)+Math.pow(G.y()-H.y,2));const A=H.x<G.x()?-1:1,B=G.y()<H.y?-1:1;E=D*this.cos*A,N=D*this.sin*B,G.x(H.x-E),G.y(H.y+N)}$=G.position(),this.findOne(".top-left").x($.x),this.findOne(".bottom-right").y($.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(G.y());else if(this._movingAnchorName==="bottom-right"){if(R){const H=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};D=Math.sqrt(Math.pow(G.x()-H.x,2)+Math.pow(G.y()-H.y,2));const A=this.findOne(".bottom-right").x()<H.x?-1:1,B=this.findOne(".bottom-right").y()<H.y?-1:1;E=D*this.cos*A,N=D*this.sin*B,this.findOne(".bottom-right").x(H.x+E),this.findOne(".bottom-right").y(H.y+N)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(F=this.centeredScaling()||C.altKey,F){const H=this.findOne(".top-left"),A=this.findOne(".bottom-right"),B=H.x(),et=H.y(),st=this.getWidth()-A.x(),ct=this.getHeight()-A.y();A.move({x:-B,y:-et}),H.move({x:st,y:ct})}const L=this.findOne(".top-left").getAbsolutePosition();E=L.x,N=L.y;const Y=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),X=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:E,y:N,width:Y,height:X,rotation:o.Konva.getAngle(this.rotation())},C)}_handleMouseUp(C){this._removeEvents(C)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(C){var E;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const N=this.getNode();S--,this._fire("transformend",{evt:C,target:N}),(E=this.getLayer())===null||E===void 0||E.batchDraw(),N&&this._nodes.forEach(D=>{var G;D._fire("transformend",{evt:C,target:D}),(G=D.getLayer())===null||G===void 0||G.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(C,E){const N=this._getNodeRect(),D=1;if(t.Util._inRange(C.width,-this.padding()*2-D,D)){this.update();return}if(t.Util._inRange(C.height,-this.padding()*2-D,D)){this.update();return}const G=new t.Transform;if(G.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&C.width<0&&this._movingAnchorName.indexOf("left")>=0){const R=G.point({x:-this.padding()*2,y:0});C.x+=R.x,C.y+=R.y,C.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y}else if(this._movingAnchorName&&C.width<0&&this._movingAnchorName.indexOf("right")>=0){const R=G.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,C.width+=this.padding()*2}if(this._movingAnchorName&&C.height<0&&this._movingAnchorName.indexOf("top")>=0){const R=G.point({x:0,y:-this.padding()*2});C.x+=R.x,C.y+=R.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,C.height+=this.padding()*2}else if(this._movingAnchorName&&C.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const R=G.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,C.height+=this.padding()*2}if(this.boundBoxFunc()){const R=this.boundBoxFunc()(N,C);R?C=R:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const U=1e7,z=new t.Transform;z.translate(N.x,N.y),z.rotate(N.rotation),z.scale(N.width/U,N.height/U);const q=new t.Transform,y=C.width/U,k=C.height/U;this.flipEnabled()===!1?(q.translate(C.x,C.y),q.rotate(C.rotation),q.translate(C.width<0?C.width:0,C.height<0?C.height:0),q.scale(Math.abs(y),Math.abs(k))):(q.translate(C.x,C.y),q.rotate(C.rotation),q.scale(y,k));const M=q.multiply(z.invert());this._nodes.forEach(R=>{var F;const $=R.getParent().getAbsoluteTransform(),L=R.getTransform().copy();L.translate(R.offsetX(),R.offsetY());const Y=new t.Transform;Y.multiply($.copy().invert()).multiply(M).multiply($).multiply(L);const X=Y.decompose();R.setAttrs(X),(F=R.getLayer())===null||F===void 0||F.batchDraw()}),this.rotation(t.Util._getRotation(C.rotation)),this._nodes.forEach(R=>{this._fire("transform",{evt:E,target:R}),R._fire("transform",{evt:E,target:R})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(C,E){this.findOne(C).setAttrs(E)}update(){var C;const E=this._getNodeRect();this.rotation(t.Util._getRotation(E.rotation));const N=E.width,D=E.height,G=this.enabledAnchors(),U=this.resizeEnabled(),z=this.padding(),q=this.anchorSize(),y=this.find("._anchor");y.forEach(M=>{M.setAttrs({width:q,height:q,offsetX:q/2,offsetY:q/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:q/2+z,offsetY:q/2+z,visible:U&&G.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:N/2,y:0,offsetY:q/2+z,visible:U&&G.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:N,y:0,offsetX:q/2-z,offsetY:q/2+z,visible:U&&G.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:D/2,offsetX:q/2+z,visible:U&&G.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:N,y:D/2,offsetX:q/2-z,visible:U&&G.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:D,offsetX:q/2+z,offsetY:q/2-z,visible:U&&G.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:N/2,y:D,offsetY:q/2-z,visible:U&&G.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:N,y:D,offsetX:q/2-z,offsetY:q/2-z,visible:U&&G.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:N/2,y:-this.rotateAnchorOffset()*t.Util._sign(D)-z,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:N,height:D,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const k=this.anchorStyleFunc();k&&y.forEach(M=>{k(M)}),(C=this.getLayer())===null||C===void 0||C.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const C=this.findOne("."+this._movingAnchorName);C&&C.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),s.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(C){return n.Node.prototype.clone.call(this,C)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Ci.Transformer=P,P.isTransforming=()=>S>0;function I(b){return b instanceof Array||t.Util.warn("enabledAnchors value should be an array"),b instanceof Array&&b.forEach(function(C){w.indexOf(C)===-1&&t.Util.warn("Unknown anchor name: "+C+". Available names are: "+w.join(", "))}),b||[]}return P.prototype.className="Transformer",(0,l._registerNode)(P),e.Factory.addGetterSetter(P,"enabledAnchors",w,I),e.Factory.addGetterSetter(P,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(P,"resizeEnabled",!0),e.Factory.addGetterSetter(P,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(P,"rotateEnabled",!0),e.Factory.addGetterSetter(P,"rotateLineVisible",!0),e.Factory.addGetterSetter(P,"rotationSnaps",[]),e.Factory.addGetterSetter(P,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(P,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(P,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(P,"borderEnabled",!0),e.Factory.addGetterSetter(P,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(P,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(P,"anchorFill","white"),e.Factory.addGetterSetter(P,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(P,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(P,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(P,"borderDash"),e.Factory.addGetterSetter(P,"keepRatio",!0),e.Factory.addGetterSetter(P,"shiftBehavior","default"),e.Factory.addGetterSetter(P,"centeredScaling",!1),e.Factory.addGetterSetter(P,"ignoreStroke",!1),e.Factory.addGetterSetter(P,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(P,"nodes"),e.Factory.addGetterSetter(P,"node"),e.Factory.addGetterSetter(P,"boundBoxFunc"),e.Factory.addGetterSetter(P,"anchorDragBoundFunc"),e.Factory.addGetterSetter(P,"anchorStyleFunc"),e.Factory.addGetterSetter(P,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(P,"useSingleNodeRotation",!0),e.Factory.backCompat(P,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Ci}var Pi={},Jl;function Zf(){if(Jl)return Pi;Jl=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.Wedge=void 0;const t=yt(),e=Wt(),n=bt(),i=St(),r=bt();let s=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return Pi.Wedge=s,s.prototype.className="Wedge",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"clockwise",!1),t.Factory.backCompat(s,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Pi}var ki={},tc;function qf(){if(tc)return ki;tc=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.Blur=void 0;const t=yt(),e=Ht(),n=St();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const r=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],s=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(l,c){const h=l.data,p=l.width,f=l.height;let d,g,v,w,x,m,u,_,S,P,I,b,C,E,N,D,G,U,z,q;const y=c+c+1,k=p-1,M=f-1,R=c+1,F=R*(R+1)/2,$=new i,L=r[c],Y=s[c];let X=null,H=$,A=null,B=null;for(let et=1;et<y;et++)H=H.next=new i,et===R&&(X=H);H.next=$,v=g=0;for(let et=0;et<f;et++){b=C=E=N=w=x=m=u=0,_=R*(D=h[g]),S=R*(G=h[g+1]),P=R*(U=h[g+2]),I=R*(z=h[g+3]),w+=F*D,x+=F*G,m+=F*U,u+=F*z,H=$;for(let st=0;st<R;st++)H.r=D,H.g=G,H.b=U,H.a=z,H=H.next;for(let st=1;st<R;st++)d=g+((k<st?k:st)<<2),w+=(H.r=D=h[d])*(q=R-st),x+=(H.g=G=h[d+1])*q,m+=(H.b=U=h[d+2])*q,u+=(H.a=z=h[d+3])*q,b+=D,C+=G,E+=U,N+=z,H=H.next;A=$,B=X;for(let st=0;st<p;st++)h[g+3]=z=u*L>>Y,z!==0?(z=255/z,h[g]=(w*L>>Y)*z,h[g+1]=(x*L>>Y)*z,h[g+2]=(m*L>>Y)*z):h[g]=h[g+1]=h[g+2]=0,w-=_,x-=S,m-=P,u-=I,_-=A.r,S-=A.g,P-=A.b,I-=A.a,d=v+((d=st+c+1)<k?d:k)<<2,b+=A.r=h[d],C+=A.g=h[d+1],E+=A.b=h[d+2],N+=A.a=h[d+3],w+=b,x+=C,m+=E,u+=N,A=A.next,_+=D=B.r,S+=G=B.g,P+=U=B.b,I+=z=B.a,b-=D,C-=G,E-=U,N-=z,B=B.next,g+=4;v+=p}for(let et=0;et<p;et++){C=E=N=b=x=m=u=w=0,g=et<<2,_=R*(D=h[g]),S=R*(G=h[g+1]),P=R*(U=h[g+2]),I=R*(z=h[g+3]),w+=F*D,x+=F*G,m+=F*U,u+=F*z,H=$;for(let ct=0;ct<R;ct++)H.r=D,H.g=G,H.b=U,H.a=z,H=H.next;let st=p;for(let ct=1;ct<=c;ct++)g=st+et<<2,w+=(H.r=D=h[g])*(q=R-ct),x+=(H.g=G=h[g+1])*q,m+=(H.b=U=h[g+2])*q,u+=(H.a=z=h[g+3])*q,b+=D,C+=G,E+=U,N+=z,H=H.next,ct<M&&(st+=p);g=et,A=$,B=X;for(let ct=0;ct<f;ct++)d=g<<2,h[d+3]=z=u*L>>Y,z>0?(z=255/z,h[d]=(w*L>>Y)*z,h[d+1]=(x*L>>Y)*z,h[d+2]=(m*L>>Y)*z):h[d]=h[d+1]=h[d+2]=0,w-=_,x-=S,m-=P,u-=I,_-=A.r,S-=A.g,P-=A.b,I-=A.a,d=et+((d=ct+R)<M?d:M)*p<<2,w+=b+=A.r=h[d],x+=C+=A.g=h[d+1],m+=E+=A.b=h[d+2],u+=N+=A.a=h[d+3],A=A.next,_+=D=B.r,S+=G=B.g,P+=U=B.b,I+=z=B.a,b-=D,C-=G,E-=U,N-=z,B=B.next,g+=p}}const a=function(c){const h=Math.round(this.blurRadius());h>0&&o(c,h)};return ki.Blur=a,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ki}var Ei={},ec;function Kf(){if(ec)return Ei;ec=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.Brighten=void 0;const t=yt(),e=Ht(),n=St(),i=function(r){const s=this.brightness()*255,o=r.data,a=o.length;for(let l=0;l<a;l+=4)o[l]+=s,o[l+1]+=s,o[l+2]+=s};return Ei.Brighten=i,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Ei}var Ti={},nc;function Yf(){if(nc)return Ti;nc=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.Contrast=void 0;const t=yt(),e=Ht(),n=St(),i=function(r){const s=Math.pow((this.contrast()+100)/100,2),o=r.data,a=o.length;let l=150,c=150,h=150;for(let p=0;p<a;p+=4)l=o[p],c=o[p+1],h=o[p+2],l/=255,l-=.5,l*=s,l+=.5,l*=255,c/=255,c-=.5,c*=s,c+=.5,c*=255,h/=255,h-=.5,h*=s,h+=.5,h*=255,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,h=h<0?0:h>255?255:h,o[p]=l,o[p+1]=c,o[p+2]=h};return Ti.Contrast=i,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Ti}var Ri={},ic;function Xf(){if(ic)return Ri;ic=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.Emboss=void 0;const t=yt(),e=Ht(),n=Lt(),i=St(),r=function(s){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),c=this.embossBlend(),h=s.data,p=s.width,f=s.height,d=p*4;let g=0,v=0,w=f;switch(l){case"top-left":g=-1,v=-1;break;case"top":g=-1,v=0;break;case"top-right":g=-1,v=1;break;case"right":g=0,v=1;break;case"bottom-right":g=1,v=1;break;case"bottom":g=1,v=0;break;case"bottom-left":g=1,v=-1;break;case"left":g=0,v=-1;break;default:n.Util.error("Unknown emboss direction: "+l)}do{const x=(w-1)*d;let m=g;w+m<1&&(m=0),w+m>f&&(m=0);const u=(w-1+m)*p*4;let _=p;do{const S=x+(_-1)*4;let P=v;_+P<1&&(P=0),_+P>p&&(P=0);const I=u+(_-1+P)*4,b=h[S]-h[I],C=h[S+1]-h[I+1],E=h[S+2]-h[I+2];let N=b;const D=N>0?N:-N,G=C>0?C:-C,U=E>0?E:-E;if(G>D&&(N=C),U>D&&(N=E),N*=o,c){const z=h[S]+N,q=h[S+1]+N,y=h[S+2]+N;h[S]=z>255?255:z<0?0:z,h[S+1]=q>255?255:q<0?0:q,h[S+2]=y>255?255:y<0?0:y}else{let z=a-N;z<0?z=0:z>255&&(z=255),h[S]=h[S+1]=h[S+2]=z}}while(--_)}while(--w)};return Ri.Emboss=r,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),Ri}var Ai={},rc;function Qf(){if(rc)return Ai;rc=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.Enhance=void 0;const t=yt(),e=Ht(),n=St();function i(s,o,a,l,c){const h=a-o,p=c-l;if(h===0)return l+p/2;if(p===0)return l;let f=(s-o)/h;return f=p*f+l,f}const r=function(s){const o=s.data,a=o.length;let l=o[0],c=l,h,p=o[1],f=p,d,g=o[2],v=g,w;const x=this.enhance();if(x===0)return;for(let b=0;b<a;b+=4)h=o[b+0],h<l?l=h:h>c&&(c=h),d=o[b+1],d<p?p=d:d>f&&(f=d),w=o[b+2],w<g?g=w:w>v&&(v=w);c===l&&(c=255,l=0),f===p&&(f=255,p=0),v===g&&(v=255,g=0);let m,u,_,S,P,I;if(x>0)m=c+x*(255-c),u=l-x*(l-0),_=f+x*(255-f),S=p-x*(p-0),P=v+x*(255-v),I=g-x*(g-0);else{const b=(c+l)*.5;m=c+x*(c-b),u=l+x*(l-b);const C=(f+p)*.5;_=f+x*(f-C),S=p+x*(p-C);const E=(v+g)*.5;P=v+x*(v-E),I=g+x*(g-E)}for(let b=0;b<a;b+=4)o[b+0]=i(o[b+0],l,c,u,m),o[b+1]=i(o[b+1],p,f,S,_),o[b+2]=i(o[b+2],g,v,I,P)};return Ai.Enhance=r,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Ai}var Mi={},sc;function Jf(){if(sc)return Mi;sc=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.Grayscale=void 0;const t=function(e){const n=e.data,i=n.length;for(let r=0;r<i;r+=4){const s=.34*n[r]+.5*n[r+1]+.16*n[r+2];n[r]=s,n[r+1]=s,n[r+2]=s}};return Mi.Grayscale=t,Mi}var Ni={},oc;function t0(){if(oc)return Ni;oc=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.HSL=void 0;const t=yt(),e=Ht(),n=St();t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter);const i=function(r){const s=r.data,o=s.length,a=1,l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=this.luminance()*127,p=a*l*Math.cos(c*Math.PI/180),f=a*l*Math.sin(c*Math.PI/180),d=.299*a+.701*p+.167*f,g=.587*a-.587*p+.33*f,v=.114*a-.114*p-.497*f,w=.299*a-.299*p-.328*f,x=.587*a+.413*p+.035*f,m=.114*a-.114*p+.293*f,u=.299*a-.3*p+1.25*f,_=.587*a-.586*p-1.05*f,S=.114*a+.886*p-.2*f;let P,I,b,C;for(let E=0;E<o;E+=4)P=s[E+0],I=s[E+1],b=s[E+2],C=s[E+3],s[E+0]=d*P+g*I+v*b+h,s[E+1]=w*P+x*I+m*b+h,s[E+2]=u*P+_*I+S*b+h,s[E+3]=C};return Ni.HSL=i,Ni}var Ii={},ac;function e0(){if(ac)return Ii;ac=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.HSV=void 0;const t=yt(),e=Ht(),n=St(),i=function(r){const s=r.data,o=s.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=a*l*Math.cos(c*Math.PI/180),p=a*l*Math.sin(c*Math.PI/180),f=.299*a+.701*h+.167*p,d=.587*a-.587*h+.33*p,g=.114*a-.114*h-.497*p,v=.299*a-.299*h-.328*p,w=.587*a+.413*h+.035*p,x=.114*a-.114*h+.293*p,m=.299*a-.3*h+1.25*p,u=.587*a-.586*h-1.05*p,_=.114*a+.886*h-.2*p;for(let S=0;S<o;S+=4){const P=s[S+0],I=s[S+1],b=s[S+2],C=s[S+3];s[S+0]=f*P+d*I+g*b,s[S+1]=v*P+w*I+x*b,s[S+2]=m*P+u*I+_*b,s[S+3]=C}};return Ii.HSV=i,t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Ii}var Oi={},lc;function n0(){if(lc)return Oi;lc=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.Invert=void 0;const t=function(e){const n=e.data,i=n.length;for(let r=0;r<i;r+=4)n[r]=255-n[r],n[r+1]=255-n[r+1],n[r+2]=255-n[r+2]};return Oi.Invert=t,Oi}var Fi={},cc;function i0(){if(cc)return Fi;cc=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.Kaleidoscope=void 0;const t=yt(),e=Ht(),n=Lt(),i=St(),r=function(a,l,c){const h=a.data,p=l.data,f=a.width,d=a.height,g=c.polarCenterX||f/2,v=c.polarCenterY||d/2;let w=Math.sqrt(g*g+v*v),x=f-g,m=d-v;const u=Math.sqrt(x*x+m*m);w=u>w?u:w;const _=d,S=f,P=360/S*Math.PI/180;for(let I=0;I<S;I+=1){const b=Math.sin(I*P),C=Math.cos(I*P);for(let E=0;E<_;E+=1){x=Math.floor(g+w*E/_*C),m=Math.floor(v+w*E/_*b);let N=(m*f+x)*4;const D=h[N+0],G=h[N+1],U=h[N+2],z=h[N+3];N=(I+E*f)*4,p[N+0]=D,p[N+1]=G,p[N+2]=U,p[N+3]=z}}},s=function(a,l,c){const h=a.data,p=l.data,f=a.width,d=a.height,g=c.polarCenterX||f/2,v=c.polarCenterY||d/2;let w=Math.sqrt(g*g+v*v),x=f-g,m=d-v;const u=Math.sqrt(x*x+m*m);w=u>w?u:w;const _=d,S=f,P=0;let I,b;for(x=0;x<f;x+=1)for(m=0;m<d;m+=1){const C=x-g,E=m-v,N=Math.sqrt(C*C+E*E)*_/w;let D=(Math.atan2(E,C)*180/Math.PI+360+P)%360;D=D*S/360,I=Math.floor(D),b=Math.floor(N);let G=(b*f+I)*4;const U=h[G+0],z=h[G+1],q=h[G+2],y=h[G+3];G=(m*f+x)*4,p[G+0]=U,p[G+1]=z,p[G+2]=q,p[G+3]=y}},o=function(a){const l=a.width,c=a.height;let h,p,f,d,g,v,w,x,m,u,_=Math.round(this.kaleidoscopePower());const S=Math.round(this.kaleidoscopeAngle()),P=Math.floor(l*(S%360)/360);if(_<1)return;const I=n.Util.createCanvasElement();I.width=l,I.height=c;const b=I.getContext("2d").getImageData(0,0,l,c);n.Util.releaseCanvas(I),r(a,b,{polarCenterX:l/2,polarCenterY:c/2});let C=l/Math.pow(2,_);for(;C<=8;)C=C*2,_-=1;C=Math.ceil(C);let E=C,N=0,D=E,G=1;for(P+C>l&&(N=E,D=0,G=-1),p=0;p<c;p+=1)for(h=N;h!==D;h+=G)f=Math.round(h+P)%l,m=(l*p+f)*4,g=b.data[m+0],v=b.data[m+1],w=b.data[m+2],x=b.data[m+3],u=(l*p+h)*4,b.data[u+0]=g,b.data[u+1]=v,b.data[u+2]=w,b.data[u+3]=x;for(p=0;p<c;p+=1)for(E=Math.floor(C),d=0;d<_;d+=1){for(h=0;h<E+1;h+=1)m=(l*p+h)*4,g=b.data[m+0],v=b.data[m+1],w=b.data[m+2],x=b.data[m+3],u=(l*p+E*2-h-1)*4,b.data[u+0]=g,b.data[u+1]=v,b.data[u+2]=w,b.data[u+3]=x;E*=2}s(b,a,{})};return Fi.Kaleidoscope=o,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Fi}var Di={},hc;function r0(){if(hc)return Di;hc=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.Mask=void 0;const t=yt(),e=Ht(),n=St();function i(f,d,g){let v=(g*f.width+d)*4;const w=[];return w.push(f.data[v++],f.data[v++],f.data[v++],f.data[v++]),w}function r(f,d){return Math.sqrt(Math.pow(f[0]-d[0],2)+Math.pow(f[1]-d[1],2)+Math.pow(f[2]-d[2],2))}function s(f){const d=[0,0,0];for(let g=0;g<f.length;g++)d[0]+=f[g][0],d[1]+=f[g][1],d[2]+=f[g][2];return d[0]/=f.length,d[1]/=f.length,d[2]/=f.length,d}function o(f,d){const g=i(f,0,0),v=i(f,f.width-1,0),w=i(f,0,f.height-1),x=i(f,f.width-1,f.height-1),m=d||10;if(r(g,v)<m&&r(v,x)<m&&r(x,w)<m&&r(w,g)<m){const u=s([v,g,x,w]),_=[];for(let S=0;S<f.width*f.height;S++){const P=r(u,[f.data[S*4],f.data[S*4+1],f.data[S*4+2]]);_[S]=P<m?0:255}return _}}function a(f,d){for(let g=0;g<f.width*f.height;g++)f.data[4*g+3]=d[g]}function l(f,d,g){const v=[1,1,1,1,0,1,1,1,1],w=Math.round(Math.sqrt(v.length)),x=Math.floor(w/2),m=[];for(let u=0;u<g;u++)for(let _=0;_<d;_++){const S=u*d+_;let P=0;for(let I=0;I<w;I++)for(let b=0;b<w;b++){const C=u+I-x,E=_+b-x;if(C>=0&&C<g&&E>=0&&E<d){const N=C*d+E,D=v[I*w+b];P+=f[N]*D}}m[S]=P===2040?255:0}return m}function c(f,d,g){const v=[1,1,1,1,1,1,1,1,1],w=Math.round(Math.sqrt(v.length)),x=Math.floor(w/2),m=[];for(let u=0;u<g;u++)for(let _=0;_<d;_++){const S=u*d+_;let P=0;for(let I=0;I<w;I++)for(let b=0;b<w;b++){const C=u+I-x,E=_+b-x;if(C>=0&&C<g&&E>=0&&E<d){const N=C*d+E,D=v[I*w+b];P+=f[N]*D}}m[S]=P>=1020?255:0}return m}function h(f,d,g){const v=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],w=Math.round(Math.sqrt(v.length)),x=Math.floor(w/2),m=[];for(let u=0;u<g;u++)for(let _=0;_<d;_++){const S=u*d+_;let P=0;for(let I=0;I<w;I++)for(let b=0;b<w;b++){const C=u+I-x,E=_+b-x;if(C>=0&&C<g&&E>=0&&E<d){const N=C*d+E,D=v[I*w+b];P+=f[N]*D}}m[S]=P}return m}const p=function(f){const d=this.threshold();let g=o(f,d);return g&&(g=l(g,f.width,f.height),g=c(g,f.width,f.height),g=h(g,f.width,f.height),a(f,g)),f};return Di.Mask=p,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Di}var zi={},uc;function s0(){if(uc)return zi;uc=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.Noise=void 0;const t=yt(),e=Ht(),n=St(),i=function(r){const s=this.noise()*255,o=r.data,a=o.length,l=s/2;for(let c=0;c<a;c+=4)o[c+0]+=l-2*l*Math.random(),o[c+1]+=l-2*l*Math.random(),o[c+2]+=l-2*l*Math.random()};return zi.Noise=i,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),zi}var Li={},dc;function o0(){if(dc)return Li;dc=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.Pixelate=void 0;const t=yt(),e=Lt(),n=Ht(),i=St(),r=function(s){let o=Math.ceil(this.pixelSize()),a=s.width,l=s.height,c=Math.ceil(a/o),h=Math.ceil(l/o),p=s.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let f=0;f<c;f+=1)for(let d=0;d<h;d+=1){let g=0,v=0,w=0,x=0;const m=f*o,u=m+o,_=d*o,S=_+o;let P=0;for(let I=m;I<u;I+=1)if(!(I>=a))for(let b=_;b<S;b+=1){if(b>=l)continue;const C=(a*b+I)*4;g+=p[C+0],v+=p[C+1],w+=p[C+2],x+=p[C+3],P+=1}g=g/P,v=v/P,w=w/P,x=x/P;for(let I=m;I<u;I+=1)if(!(I>=a))for(let b=_;b<S;b+=1){if(b>=l)continue;const C=(a*b+I)*4;p[C+0]=g,p[C+1]=v,p[C+2]=w,p[C+3]=x}}};return Li.Pixelate=r,t.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Li}var Gi={},fc;function a0(){if(fc)return Gi;fc=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.Posterize=void 0;const t=yt(),e=Ht(),n=St(),i=function(r){const s=Math.round(this.levels()*254)+1,o=r.data,a=o.length,l=255/s;for(let c=0;c<a;c+=1)o[c]=Math.floor(o[c]/l)*l};return Gi.Posterize=i,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Gi}var Ui={},gc;function l0(){if(gc)return Ui;gc=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.RGB=void 0;const t=yt(),e=Ht(),n=St(),i=function(r){const s=r.data,o=s.length,a=this.red(),l=this.green(),c=this.blue();for(let h=0;h<o;h+=4){const p=(.34*s[h]+.5*s[h+1]+.16*s[h+2])/255;s[h]=p*a,s[h+1]=p*l,s[h+2]=p*c,s[h+3]=s[h+3]}};return Ui.RGB=i,t.Factory.addGetterSetter(e.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),Ui}var Hi={},pc;function c0(){if(pc)return Hi;pc=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.RGBA=void 0;const t=yt(),e=Ht(),n=St(),i=function(r){const s=r.data,o=s.length,a=this.red(),l=this.green(),c=this.blue(),h=this.alpha();for(let p=0;p<o;p+=4){const f=1-h;s[p]=a*h+s[p]*f,s[p+1]=l*h+s[p+1]*f,s[p+2]=c*h+s[p+2]*f}};return Hi.RGBA=i,t.Factory.addGetterSetter(e.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r}),Hi}var Bi={},mc;function h0(){if(mc)return Bi;mc=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.Sepia=void 0;const t=function(e){const n=e.data,i=n.length;for(let r=0;r<i;r+=4){const s=n[r+0],o=n[r+1],a=n[r+2];n[r+0]=Math.min(255,s*.393+o*.769+a*.189),n[r+1]=Math.min(255,s*.349+o*.686+a*.168),n[r+2]=Math.min(255,s*.272+o*.534+a*.131)}};return Bi.Sepia=t,Bi}var Vi={},_c;function u0(){if(_c)return Vi;_c=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.Solarize=void 0;const t=function(e){const n=e.data,i=e.width,r=e.height,s=i*4;let o=r;do{const a=(o-1)*s;let l=i;do{const c=a+(l-1)*4;let h=n[c],p=n[c+1],f=n[c+2];h>127&&(h=255-h),p>127&&(p=255-p),f>127&&(f=255-f),n[c]=h,n[c+1]=p,n[c+2]=f}while(--l)}while(--o)};return Vi.Solarize=t,Vi}var $i={},vc;function d0(){if(vc)return $i;vc=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.Threshold=void 0;const t=yt(),e=Ht(),n=St(),i=function(r){const s=this.threshold()*255,o=r.data,a=o.length;for(let l=0;l<a;l+=1)o[l]=o[l]<s?0:255};return $i.Threshold=i,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),$i}var bc;function f0(){if(bc)return ri;bc=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.Konva=void 0;const t=If(),e=Of(),n=Df(),i=zf(),r=Lf(),s=Gf(),o=Uf(),a=Fl(),l=Zs(),c=$l(),h=Hf(),p=Bf(),f=Vf(),d=$f(),g=Yl(),v=Wf(),w=jf(),x=Zf(),m=qf(),u=Kf(),_=Yf(),S=Xf(),P=Qf(),I=Jf(),b=t0(),C=e0(),E=n0(),N=i0(),D=r0(),G=s0(),U=o0(),z=a0(),q=l0(),y=c0(),k=h0(),M=u0(),R=d0();return ri.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:r.Ellipse,Image:s.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:l.Path,Rect:c.Rect,RegularPolygon:h.RegularPolygon,Ring:p.Ring,Sprite:f.Sprite,Star:d.Star,Text:g.Text,TextPath:v.TextPath,Transformer:w.Transformer,Wedge:x.Wedge,Filters:{Blur:m.Blur,Brighten:u.Brighten,Contrast:_.Contrast,Emboss:S.Emboss,Enhance:P.Enhance,Grayscale:I.Grayscale,HSL:b.HSL,HSV:C.HSV,Invert:E.Invert,Kaleidoscope:N.Kaleidoscope,Mask:D.Mask,Noise:G.Noise,Pixelate:U.Pixelate,Posterize:z.Posterize,RGB:q.RGB,RGBA:y.RGBA,Sepia:k.Sepia,Solarize:M.Solarize,Threshold:R.Threshold}}),ri}var g0=Tr.exports,yc;function p0(){if(yc)return Tr.exports;yc=1,Object.defineProperty(g0,"__esModule",{value:!0});const t=f0();return Tr.exports=t.Konva,Tr.exports}var m0=p0();const Bt=Rf(m0),_0=()=>({stage:void 0,konvaContainer:void 0,notes:new Map,selection:{selectedIds:new Set,selectionRect:void 0},viewport:{scrollX:0,scrollY:55*20,zoomX:1,zoomY:1},grid:{quarterNoteWidth:120,noteHeight:20,baseQuarterNoteWidth:120,baseNoteHeight:20,subdivision:16,numMeasures:100,timeSignature:4,maxLength:64,backgroundColor1:"#ddd",backgroundColor2:"#bbb",noteColor:"#f23",selectedNoteColor:"#2ee"},interaction:{isDragging:!1,dragStartPos:void 0,draggedNoteInitialStates:new Map,quantDragActivated:!1,dragBeforeState:void 0,isResizing:!1,resizeTargetId:void 0,resizeIsEnd:!1,resizeInitialStates:new Map,quantResizeActivated:!1,resizeBeforeState:void 0,isMarqueeSelecting:!1,marqueeStart:void 0,marqueeCurrent:void 0,marqueeIsShift:!1,hiddenNoteIds:new Set,truncatedNotes:new Map,createEmptyOverlapAdjustments:()=>({toDelete:new Set,toTruncate:new Map})},command:{stack:void 0},layers:{grid:void 0,notes:void 0,overlay:void 0},renderCache:{grid:{lastScrollX:-1,lastScrollY:-1,lastSubdivision:-1,lastQuarterNoteWidth:-1,lastNoteHeight:-1,lastStageWidth:-1,lastStageHeight:-1}},needsRedraw:!1,rafHandle:void 0,queuePlayhead:{position:0,element:void 0},livePlayhead:{position:0,element:void 0},notifyExternalChange:void 0,mpe:{enabled:!1,selectedHandles:new Set}});function Z(t,e,n){function i(a,l){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:l,constr:o,traits:new Set},enumerable:!1}),a._zod.traits.has(t))return;a._zod.traits.add(t),e(a,l);const c=o.prototype,h=Object.keys(c);for(let p=0;p<h.length;p++){const f=h[p];f in a||(a[f]=c[f].bind(a))}}const r=n?.Parent??Object;class s extends r{}Object.defineProperty(s,"name",{value:t});function o(a){var l;const c=n?.Parent?new s:this;i(c,a),(l=c._zod).deferred??(l.deferred=[]);for(const h of c._zod.deferred)h();return c}return Object.defineProperty(o,"init",{value:i}),Object.defineProperty(o,Symbol.hasInstance,{value:a=>n?.Parent&&a instanceof n.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(o,"name",{value:t}),o}class Pn extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Sc extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const wc={};function Ye(t){return wc}function v0(t){const e=Object.values(t).filter(i=>typeof i=="number");return Object.entries(t).filter(([i,r])=>e.indexOf(+i)===-1).map(([i,r])=>r)}function qs(t,e){return typeof e=="bigint"?e.toString():e}function Mr(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function Ks(t){return t==null}function Ys(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}function b0(t,e){const n=(t.toString().split(".")[1]||"").length,i=e.toString();let r=(i.split(".")[1]||"").length;if(r===0&&/\d?e-\d?/.test(i)){const l=i.match(/\d?e-(\d?)/);l?.[1]&&(r=Number.parseInt(l[1]))}const s=n>r?n:r,o=Number.parseInt(t.toFixed(s).replace(".","")),a=Number.parseInt(e.toFixed(s).replace(".",""));return o%a/10**s}const xc=Symbol("evaluating");function Tt(t,e,n){let i;Object.defineProperty(t,e,{get(){if(i!==xc)return i===void 0&&(i=xc,i=n()),i},set(r){Object.defineProperty(t,e,{value:r})},configurable:!0})}function un(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function dn(...t){const e={};for(const n of t){const i=Object.getOwnPropertyDescriptors(n);Object.assign(e,i)}return Object.defineProperties({},e)}function Cc(t){return JSON.stringify(t)}function y0(t){return t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const Pc="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function Wi(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const S0=Mr(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function kn(t){if(Wi(t)===!1)return!1;const e=t.constructor;if(e===void 0||typeof e!="function")return!0;const n=e.prototype;return!(Wi(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function kc(t){return kn(t)?{...t}:Array.isArray(t)?[...t]:t}const w0=new Set(["string","number","symbol"]);function En(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Xe(t,e,n){const i=new t._zod.constr(e??t._zod.def);return(!e||n?.parent)&&(i._zod.parent=t),i}function ht(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function x0(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const C0={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function P0(t,e){const n=t._zod.def,i=dn(t._zod.def,{get shape(){const r={};for(const s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&(r[s]=n.shape[s])}return un(this,"shape",r),r},checks:[]});return Xe(t,i)}function k0(t,e){const n=t._zod.def,i=dn(t._zod.def,{get shape(){const r={...t._zod.def.shape};for(const s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&delete r[s]}return un(this,"shape",r),r},checks:[]});return Xe(t,i)}function E0(t,e){if(!kn(e))throw new Error("Invalid input to extend: expected a plain object");const n=t._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const r=dn(t._zod.def,{get shape(){const s={...t._zod.def.shape,...e};return un(this,"shape",s),s},checks:[]});return Xe(t,r)}function T0(t,e){if(!kn(e))throw new Error("Invalid input to safeExtend: expected a plain object");const n={...t._zod.def,get shape(){const i={...t._zod.def.shape,...e};return un(this,"shape",i),i},checks:t._zod.def.checks};return Xe(t,n)}function R0(t,e){const n=dn(t._zod.def,{get shape(){const i={...t._zod.def.shape,...e._zod.def.shape};return un(this,"shape",i),i},get catchall(){return e._zod.def.catchall},checks:[]});return Xe(t,n)}function A0(t,e,n){const i=dn(e._zod.def,{get shape(){const r=e._zod.def.shape,s={...r};if(n)for(const o in n){if(!(o in r))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(s[o]=t?new t({type:"optional",innerType:r[o]}):r[o])}else for(const o in r)s[o]=t?new t({type:"optional",innerType:r[o]}):r[o];return un(this,"shape",s),s},checks:[]});return Xe(e,i)}function M0(t,e,n){const i=dn(e._zod.def,{get shape(){const r=e._zod.def.shape,s={...r};if(n)for(const o in n){if(!(o in s))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(s[o]=new t({type:"nonoptional",innerType:r[o]}))}else for(const o in r)s[o]=new t({type:"nonoptional",innerType:r[o]});return un(this,"shape",s),s},checks:[]});return Xe(e,i)}function Tn(t,e=0){if(t.aborted===!0)return!0;for(let n=e;n<t.issues.length;n++)if(t.issues[n]?.continue!==!0)return!0;return!1}function fn(t,e){return e.map(n=>{var i;return(i=n).path??(i.path=[]),n.path.unshift(t),n})}function Nr(t){return typeof t=="string"?t:t?.message}function Qe(t,e,n){const i={...t,path:t.path??[]};if(!t.message){const r=Nr(t.inst?._zod.def?.error?.(t))??Nr(e?.error?.(t))??Nr(n.customError?.(t))??Nr(n.localeError?.(t))??"Invalid input";i.message=r}return delete i.inst,delete i.continue,e?.reportInput||delete i.input,i}function Xs(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function ji(...t){const[e,n,i]=t;return typeof e=="string"?{message:e,code:"custom",input:n,inst:i}:{...e}}const Ec=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,qs,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},Tc=Z("$ZodError",Ec),Rc=Z("$ZodError",Ec,{Parent:Error});function N0(t,e=n=>n.message){const n={},i=[];for(const r of t.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(e(r))):i.push(e(r));return{formErrors:i,fieldErrors:n}}function I0(t,e=n=>n.message){const n={_errors:[]},i=r=>{for(const s of r.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(o=>i({issues:o}));else if(s.code==="invalid_key")i({issues:s.issues});else if(s.code==="invalid_element")i({issues:s.issues});else if(s.path.length===0)n._errors.push(e(s));else{let o=n,a=0;for(;a<s.path.length;){const l=s.path[a];a===s.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(e(s))):o[l]=o[l]||{_errors:[]},o=o[l],a++}}};return i(t),n}const Qs=t=>(e,n,i,r)=>{const s=i?Object.assign(i,{async:!1}):{async:!1},o=e._zod.run({value:n,issues:[]},s);if(o instanceof Promise)throw new Pn;if(o.issues.length){const a=new(r?.Err??t)(o.issues.map(l=>Qe(l,s,Ye())));throw Pc(a,r?.callee),a}return o.value},Js=t=>async(e,n,i,r)=>{const s=i?Object.assign(i,{async:!0}):{async:!0};let o=e._zod.run({value:n,issues:[]},s);if(o instanceof Promise&&(o=await o),o.issues.length){const a=new(r?.Err??t)(o.issues.map(l=>Qe(l,s,Ye())));throw Pc(a,r?.callee),a}return o.value},Ir=t=>(e,n,i)=>{const r=i?{...i,async:!1}:{async:!1},s=e._zod.run({value:n,issues:[]},r);if(s instanceof Promise)throw new Pn;return s.issues.length?{success:!1,error:new(t??Tc)(s.issues.map(o=>Qe(o,r,Ye())))}:{success:!0,data:s.value}},O0=Ir(Rc),Or=t=>async(e,n,i)=>{const r=i?Object.assign(i,{async:!0}):{async:!0};let s=e._zod.run({value:n,issues:[]},r);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new t(s.issues.map(o=>Qe(o,r,Ye())))}:{success:!0,data:s.value}},F0=Or(Rc),D0=t=>(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Qs(t)(e,n,r)},z0=t=>(e,n,i)=>Qs(t)(e,n,i),L0=t=>async(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Js(t)(e,n,r)},G0=t=>async(e,n,i)=>Js(t)(e,n,i),U0=t=>(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Ir(t)(e,n,r)},H0=t=>(e,n,i)=>Ir(t)(e,n,i),B0=t=>async(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Or(t)(e,n,r)},V0=t=>async(e,n,i)=>Or(t)(e,n,i),$0=/^[cC][^\s-]{8,}$/,W0=/^[0-9a-z]+$/,j0=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Z0=/^[0-9a-vA-V]{20}$/,q0=/^[A-Za-z0-9]{27}$/,K0=/^[a-zA-Z0-9_-]{21}$/,Y0=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,X0=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Ac=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Q0=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,J0="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function tg(){return new RegExp(J0,"u")}const eg=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ng=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,ig=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,rg=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,sg=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Mc=/^[A-Za-z0-9_-]*$/,og=/^\+(?:[0-9]){6,14}[0-9]$/,Nc="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",ag=new RegExp(`^${Nc}$`);function Ic(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function lg(t){return new RegExp(`^${Ic(t)}$`)}function cg(t){const e=Ic({precision:t.precision}),n=["Z"];t.local&&n.push(""),t.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const i=`${e}(?:${n.join("|")})`;return new RegExp(`^${Nc}T(?:${i})$`)}const hg=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},ug=/^-?\d+$/,dg=/^-?\d+(?:\.\d+)?/,fg=/^(?:true|false)$/i,gg=/^[^A-Z]*$/,pg=/^[^a-z]*$/,oe=Z("$ZodCheck",(t,e)=>{var n;t._zod??(t._zod={}),t._zod.def=e,(n=t._zod).onattach??(n.onattach=[])}),Oc={number:"number",bigint:"bigint",object:"date"},Fc=Z("$ZodCheckLessThan",(t,e)=>{oe.init(t,e);const n=Oc[typeof e.value];t._zod.onattach.push(i=>{const r=i._zod.bag,s=(e.inclusive?r.maximum:r.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?r.maximum=e.value:r.exclusiveMaximum=e.value)}),t._zod.check=i=>{(e.inclusive?i.value<=e.value:i.value<e.value)||i.issues.push({origin:n,code:"too_big",maximum:e.value,input:i.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Dc=Z("$ZodCheckGreaterThan",(t,e)=>{oe.init(t,e);const n=Oc[typeof e.value];t._zod.onattach.push(i=>{const r=i._zod.bag,s=(e.inclusive?r.minimum:r.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?r.minimum=e.value:r.exclusiveMinimum=e.value)}),t._zod.check=i=>{(e.inclusive?i.value>=e.value:i.value>e.value)||i.issues.push({origin:n,code:"too_small",minimum:e.value,input:i.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),mg=Z("$ZodCheckMultipleOf",(t,e)=>{oe.init(t,e),t._zod.onattach.push(n=>{var i;(i=n._zod.bag).multipleOf??(i.multipleOf=e.value)}),t._zod.check=n=>{if(typeof n.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%e.value===BigInt(0):b0(n.value,e.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:e.value,input:n.value,inst:t,continue:!e.abort})}}),_g=Z("$ZodCheckNumberFormat",(t,e)=>{oe.init(t,e),e.format=e.format||"float64";const n=e.format?.includes("int"),i=n?"int":"number",[r,s]=C0[e.format];t._zod.onattach.push(o=>{const a=o._zod.bag;a.format=e.format,a.minimum=r,a.maximum=s,n&&(a.pattern=ug)}),t._zod.check=o=>{const a=o.value;if(n){if(!Number.isInteger(a)){o.issues.push({expected:i,format:e.format,code:"invalid_type",continue:!1,input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?o.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:i,continue:!e.abort}):o.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:i,continue:!e.abort});return}}a<r&&o.issues.push({origin:"number",input:a,code:"too_small",minimum:r,inclusive:!0,inst:t,continue:!e.abort}),a>s&&o.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inst:t})}}),vg=Z("$ZodCheckMaxLength",(t,e)=>{var n;oe.init(t,e),(n=t._zod.def).when??(n.when=i=>{const r=i.value;return!Ks(r)&&r.length!==void 0}),t._zod.onattach.push(i=>{const r=i._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<r&&(i._zod.bag.maximum=e.maximum)}),t._zod.check=i=>{const r=i.value;if(r.length<=e.maximum)return;const o=Xs(r);i.issues.push({origin:o,code:"too_big",maximum:e.maximum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),bg=Z("$ZodCheckMinLength",(t,e)=>{var n;oe.init(t,e),(n=t._zod.def).when??(n.when=i=>{const r=i.value;return!Ks(r)&&r.length!==void 0}),t._zod.onattach.push(i=>{const r=i._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>r&&(i._zod.bag.minimum=e.minimum)}),t._zod.check=i=>{const r=i.value;if(r.length>=e.minimum)return;const o=Xs(r);i.issues.push({origin:o,code:"too_small",minimum:e.minimum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),yg=Z("$ZodCheckLengthEquals",(t,e)=>{var n;oe.init(t,e),(n=t._zod.def).when??(n.when=i=>{const r=i.value;return!Ks(r)&&r.length!==void 0}),t._zod.onattach.push(i=>{const r=i._zod.bag;r.minimum=e.length,r.maximum=e.length,r.length=e.length}),t._zod.check=i=>{const r=i.value,s=r.length;if(s===e.length)return;const o=Xs(r),a=s>e.length;i.issues.push({origin:o,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:i.value,inst:t,continue:!e.abort})}}),Fr=Z("$ZodCheckStringFormat",(t,e)=>{var n,i;oe.init(t,e),t._zod.onattach.push(r=>{const s=r._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(n=t._zod).check??(n.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:e.format,input:r.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(i=t._zod).check??(i.check=()=>{})}),Sg=Z("$ZodCheckRegex",(t,e)=>{Fr.init(t,e),t._zod.check=n=>{e.pattern.lastIndex=0,!e.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),wg=Z("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=gg),Fr.init(t,e)}),xg=Z("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=pg),Fr.init(t,e)}),Cg=Z("$ZodCheckIncludes",(t,e)=>{oe.init(t,e);const n=En(e.includes),i=new RegExp(typeof e.position=="number"?`^.{${e.position}}${n}`:n);e.pattern=i,t._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(i)}),t._zod.check=r=>{r.value.includes(e.includes,e.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:r.value,inst:t,continue:!e.abort})}}),Pg=Z("$ZodCheckStartsWith",(t,e)=>{oe.init(t,e);const n=new RegExp(`^${En(e.prefix)}.*`);e.pattern??(e.pattern=n),t._zod.onattach.push(i=>{const r=i._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),t._zod.check=i=>{i.value.startsWith(e.prefix)||i.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:i.value,inst:t,continue:!e.abort})}}),kg=Z("$ZodCheckEndsWith",(t,e)=>{oe.init(t,e);const n=new RegExp(`.*${En(e.suffix)}$`);e.pattern??(e.pattern=n),t._zod.onattach.push(i=>{const r=i._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),t._zod.check=i=>{i.value.endsWith(e.suffix)||i.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:i.value,inst:t,continue:!e.abort})}}),Eg=Z("$ZodCheckOverwrite",(t,e)=>{oe.init(t,e),t._zod.check=n=>{n.value=e.tx(n.value)}});class Tg{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const i=e.split(`
`).filter(o=>o),r=Math.min(...i.map(o=>o.length-o.trimStart().length)),s=i.map(o=>o.slice(r)).map(o=>" ".repeat(this.indent*2)+o);for(const o of s)this.content.push(o)}compile(){const e=Function,n=this?.args,r=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...n,r.join(`
`))}}const Rg={major:4,minor:1,patch:13},It=Z("$ZodType",(t,e)=>{var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=Rg;const i=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&i.unshift(t);for(const r of i)for(const s of r._zod.onattach)s(t);if(i.length===0)(n=t._zod).deferred??(n.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const r=(o,a,l)=>{let c=Tn(o),h;for(const p of a){if(p._zod.def.when){if(!p._zod.def.when(o))continue}else if(c)continue;const f=o.issues.length,d=p._zod.check(o);if(d instanceof Promise&&l?.async===!1)throw new Pn;if(h||d instanceof Promise)h=(h??Promise.resolve()).then(async()=>{await d,o.issues.length!==f&&(c||(c=Tn(o,f)))});else{if(o.issues.length===f)continue;c||(c=Tn(o,f))}}return h?h.then(()=>o):o},s=(o,a,l)=>{if(Tn(o))return o.aborted=!0,o;const c=r(a,i,l);if(c instanceof Promise){if(l.async===!1)throw new Pn;return c.then(h=>t._zod.parse(h,l))}return t._zod.parse(c,l)};t._zod.run=(o,a)=>{if(a.skipChecks)return t._zod.parse(o,a);if(a.direction==="backward"){const c=t._zod.parse({value:o.value,issues:[]},{...a,skipChecks:!0});return c instanceof Promise?c.then(h=>s(h,o,a)):s(c,o,a)}const l=t._zod.parse(o,a);if(l instanceof Promise){if(a.async===!1)throw new Pn;return l.then(c=>r(c,i,a))}return r(l,i,a)}}t["~standard"]={validate:r=>{try{const s=O0(t,r);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return F0(t,r).then(o=>o.success?{value:o.data}:{issues:o.error?.issues})}},vendor:"zod",version:1}}),to=Z("$ZodString",(t,e)=>{It.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??hg(t._zod.bag),t._zod.parse=(n,i)=>{if(e.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:t}),n}}),Ft=Z("$ZodStringFormat",(t,e)=>{Fr.init(t,e),to.init(t,e)}),Ag=Z("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=X0),Ft.init(t,e)}),Mg=Z("$ZodUUID",(t,e)=>{if(e.version){const i={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(i===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Ac(i))}else e.pattern??(e.pattern=Ac());Ft.init(t,e)}),Ng=Z("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=Q0),Ft.init(t,e)}),Ig=Z("$ZodURL",(t,e)=>{Ft.init(t,e),t._zod.check=n=>{try{const i=n.value.trim(),r=new URL(i);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(r.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:e.hostname.source,input:n.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(r.protocol.endsWith(":")?r.protocol.slice(0,-1):r.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:t,continue:!e.abort})),e.normalize?n.value=r.href:n.value=i;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:t,continue:!e.abort})}}}),Og=Z("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=tg()),Ft.init(t,e)}),Fg=Z("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=K0),Ft.init(t,e)}),Dg=Z("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=$0),Ft.init(t,e)}),zg=Z("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=W0),Ft.init(t,e)}),Lg=Z("$ZodULID",(t,e)=>{e.pattern??(e.pattern=j0),Ft.init(t,e)}),Gg=Z("$ZodXID",(t,e)=>{e.pattern??(e.pattern=Z0),Ft.init(t,e)}),Ug=Z("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=q0),Ft.init(t,e)}),Hg=Z("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=cg(e)),Ft.init(t,e)}),Bg=Z("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=ag),Ft.init(t,e)}),Vg=Z("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=lg(e)),Ft.init(t,e)}),$g=Z("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=Y0),Ft.init(t,e)}),Wg=Z("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=eg),Ft.init(t,e),t._zod.bag.format="ipv4"}),jg=Z("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=ng),Ft.init(t,e),t._zod.bag.format="ipv6",t._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:t,continue:!e.abort})}}}),Zg=Z("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=ig),Ft.init(t,e)}),qg=Z("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=rg),Ft.init(t,e),t._zod.check=n=>{const i=n.value.split("/");try{if(i.length!==2)throw new Error;const[r,s]=i;if(!s)throw new Error;const o=Number(s);if(`${o}`!==s)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:t,continue:!e.abort})}}});function zc(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const Kg=Z("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=sg),Ft.init(t,e),t._zod.bag.contentEncoding="base64",t._zod.check=n=>{zc(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:t,continue:!e.abort})}});function Yg(t){if(!Mc.test(t))return!1;const e=t.replace(/[-_]/g,i=>i==="-"?"+":"/"),n=e.padEnd(Math.ceil(e.length/4)*4,"=");return zc(n)}const Xg=Z("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=Mc),Ft.init(t,e),t._zod.bag.contentEncoding="base64url",t._zod.check=n=>{Yg(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:t,continue:!e.abort})}}),Qg=Z("$ZodE164",(t,e)=>{e.pattern??(e.pattern=og),Ft.init(t,e)});function Jg(t,e=null){try{const n=t.split(".");if(n.length!==3)return!1;const[i]=n;if(!i)return!1;const r=JSON.parse(atob(i));return!("typ"in r&&r?.typ!=="JWT"||!r.alg||e&&(!("alg"in r)||r.alg!==e))}catch{return!1}}const tp=Z("$ZodJWT",(t,e)=>{Ft.init(t,e),t._zod.check=n=>{Jg(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:t,continue:!e.abort})}}),Lc=Z("$ZodNumber",(t,e)=>{It.init(t,e),t._zod.pattern=t._zod.bag.pattern??dg,t._zod.parse=(n,i)=>{if(e.coerce)try{n.value=Number(n.value)}catch{}const r=n.value;if(typeof r=="number"&&!Number.isNaN(r)&&Number.isFinite(r))return n;const s=typeof r=="number"?Number.isNaN(r)?"NaN":Number.isFinite(r)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:r,inst:t,...s?{received:s}:{}}),n}}),ep=Z("$ZodNumberFormat",(t,e)=>{_g.init(t,e),Lc.init(t,e)}),np=Z("$ZodBoolean",(t,e)=>{It.init(t,e),t._zod.pattern=fg,t._zod.parse=(n,i)=>{if(e.coerce)try{n.value=!!n.value}catch{}const r=n.value;return typeof r=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:r,inst:t}),n}}),ip=Z("$ZodUnknown",(t,e)=>{It.init(t,e),t._zod.parse=n=>n}),rp=Z("$ZodNever",(t,e)=>{It.init(t,e),t._zod.parse=(n,i)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)});function Gc(t,e,n){t.issues.length&&e.issues.push(...fn(n,t.issues)),e.value[n]=t.value}const sp=Z("$ZodArray",(t,e)=>{It.init(t,e),t._zod.parse=(n,i)=>{const r=n.value;if(!Array.isArray(r))return n.issues.push({expected:"array",code:"invalid_type",input:r,inst:t}),n;n.value=Array(r.length);const s=[];for(let o=0;o<r.length;o++){const a=r[o],l=e.element._zod.run({value:a,issues:[]},i);l instanceof Promise?s.push(l.then(c=>Gc(c,n,o))):Gc(l,n,o)}return s.length?Promise.all(s).then(()=>n):n}});function Dr(t,e,n,i){t.issues.length&&e.issues.push(...fn(n,t.issues)),t.value===void 0?n in i&&(e.value[n]=void 0):e.value[n]=t.value}function Uc(t){const e=Object.keys(t.shape);for(const i of e)if(!t.shape?.[i]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${i}": expected a Zod schema`);const n=x0(t.shape);return{...t,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(n)}}function Hc(t,e,n,i,r,s){const o=[],a=r.keySet,l=r.catchall._zod,c=l.def.type;for(const h in e){if(a.has(h))continue;if(c==="never"){o.push(h);continue}const p=l.run({value:e[h],issues:[]},i);p instanceof Promise?t.push(p.then(f=>Dr(f,n,h,e))):Dr(p,n,h,e)}return o.length&&n.issues.push({code:"unrecognized_keys",keys:o,input:e,inst:s}),t.length?Promise.all(t).then(()=>n):n}const op=Z("$ZodObject",(t,e)=>{if(It.init(t,e),!Object.getOwnPropertyDescriptor(e,"shape")?.get){const a=e.shape;Object.defineProperty(e,"shape",{get:()=>{const l={...a};return Object.defineProperty(e,"shape",{value:l}),l}})}const i=Mr(()=>Uc(e));Tt(t._zod,"propValues",()=>{const a=e.shape,l={};for(const c in a){const h=a[c]._zod;if(h.values){l[c]??(l[c]=new Set);for(const p of h.values)l[c].add(p)}}return l});const r=Wi,s=e.catchall;let o;t._zod.parse=(a,l)=>{o??(o=i.value);const c=a.value;if(!r(c))return a.issues.push({expected:"object",code:"invalid_type",input:c,inst:t}),a;a.value={};const h=[],p=o.shape;for(const f of o.keys){const g=p[f]._zod.run({value:c[f],issues:[]},l);g instanceof Promise?h.push(g.then(v=>Dr(v,a,f,c))):Dr(g,a,f,c)}return s?Hc(h,c,a,l,i.value,t):h.length?Promise.all(h).then(()=>a):a}}),ap=Z("$ZodObjectJIT",(t,e)=>{op.init(t,e);const n=t._zod.parse,i=Mr(()=>Uc(e)),r=f=>{const d=new Tg(["shape","payload","ctx"]),g=i.value,v=u=>{const _=Cc(u);return`shape[${_}]._zod.run({ value: input[${_}], issues: [] }, ctx)`};d.write("const input = payload.value;");const w=Object.create(null);let x=0;for(const u of g.keys)w[u]=`key_${x++}`;d.write("const newResult = {};");for(const u of g.keys){const _=w[u],S=Cc(u);d.write(`const ${_} = ${v(u)};`),d.write(`
        if (${_}.issues.length) {
          payload.issues = payload.issues.concat(${_}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${S}, ...iss.path] : [${S}]
          })));
        }
        
        
        if (${_}.value === undefined) {
          if (${S} in input) {
            newResult[${S}] = undefined;
          }
        } else {
          newResult[${S}] = ${_}.value;
        }
        
      `)}d.write("payload.value = newResult;"),d.write("return payload;");const m=d.compile();return(u,_)=>m(f,u,_)};let s;const o=Wi,a=!wc.jitless,c=a&&S0.value,h=e.catchall;let p;t._zod.parse=(f,d)=>{p??(p=i.value);const g=f.value;return o(g)?a&&c&&d?.async===!1&&d.jitless!==!0?(s||(s=r(e.shape)),f=s(f,d),h?Hc([],g,f,d,p,t):f):n(f,d):(f.issues.push({expected:"object",code:"invalid_type",input:g,inst:t}),f)}});function Bc(t,e,n,i){for(const s of t)if(s.issues.length===0)return e.value=s.value,e;const r=t.filter(s=>!Tn(s));return r.length===1?(e.value=r[0].value,r[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(s=>s.issues.map(o=>Qe(o,i,Ye())))}),e)}const Vc=Z("$ZodUnion",(t,e)=>{It.init(t,e),Tt(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),Tt(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),Tt(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),Tt(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){const r=e.options.map(s=>s._zod.pattern);return new RegExp(`^(${r.map(s=>Ys(s.source)).join("|")})$`)}});const n=e.options.length===1,i=e.options[0]._zod.run;t._zod.parse=(r,s)=>{if(n)return i(r,s);let o=!1;const a=[];for(const l of e.options){const c=l._zod.run({value:r.value,issues:[]},s);if(c instanceof Promise)a.push(c),o=!0;else{if(c.issues.length===0)return c;a.push(c)}}return o?Promise.all(a).then(l=>Bc(l,r,t,s)):Bc(a,r,t,s)}}),lp=Z("$ZodDiscriminatedUnion",(t,e)=>{Vc.init(t,e);const n=t._zod.parse;Tt(t._zod,"propValues",()=>{const r={};for(const s of e.options){const o=s._zod.propValues;if(!o||Object.keys(o).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(const[a,l]of Object.entries(o)){r[a]||(r[a]=new Set);for(const c of l)r[a].add(c)}}return r});const i=Mr(()=>{const r=e.options,s=new Map;for(const o of r){const a=o._zod.propValues?.[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(o)}"`);for(const l of a){if(s.has(l))throw new Error(`Duplicate discriminator value "${String(l)}"`);s.set(l,o)}}return s});t._zod.parse=(r,s)=>{const o=r.value;if(!Wi(o))return r.issues.push({code:"invalid_type",expected:"object",input:o,inst:t}),r;const a=i.value.get(o?.[e.discriminator]);return a?a._zod.run(r,s):e.unionFallback?n(r,s):(r.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:e.discriminator,input:o,path:[e.discriminator],inst:t}),r)}}),cp=Z("$ZodIntersection",(t,e)=>{It.init(t,e),t._zod.parse=(n,i)=>{const r=n.value,s=e.left._zod.run({value:r,issues:[]},i),o=e.right._zod.run({value:r,issues:[]},i);return s instanceof Promise||o instanceof Promise?Promise.all([s,o]).then(([l,c])=>$c(n,l,c)):$c(n,s,o)}});function eo(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(kn(t)&&kn(e)){const n=Object.keys(e),i=Object.keys(t).filter(s=>n.indexOf(s)!==-1),r={...t,...e};for(const s of i){const o=eo(t[s],e[s]);if(!o.valid)return{valid:!1,mergeErrorPath:[s,...o.mergeErrorPath]};r[s]=o.data}return{valid:!0,data:r}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let i=0;i<t.length;i++){const r=t[i],s=e[i],o=eo(r,s);if(!o.valid)return{valid:!1,mergeErrorPath:[i,...o.mergeErrorPath]};n.push(o.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function $c(t,e,n){if(e.issues.length&&t.issues.push(...e.issues),n.issues.length&&t.issues.push(...n.issues),Tn(t))return t;const i=eo(e.value,n.value);if(!i.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(i.mergeErrorPath)}`);return t.value=i.data,t}const hp=Z("$ZodTuple",(t,e)=>{It.init(t,e);const n=e.items;t._zod.parse=(i,r)=>{const s=i.value;if(!Array.isArray(s))return i.issues.push({input:s,inst:t,expected:"tuple",code:"invalid_type"}),i;i.value=[];const o=[],a=[...n].reverse().findIndex(h=>h._zod.optin!=="optional"),l=a===-1?0:n.length-a;if(!e.rest){const h=s.length>n.length,p=s.length<l-1;if(h||p)return i.issues.push({...h?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length},input:s,inst:t,origin:"array"}),i}let c=-1;for(const h of n){if(c++,c>=s.length&&c>=l)continue;const p=h._zod.run({value:s[c],issues:[]},r);p instanceof Promise?o.push(p.then(f=>zr(f,i,c))):zr(p,i,c)}if(e.rest){const h=s.slice(n.length);for(const p of h){c++;const f=e.rest._zod.run({value:p,issues:[]},r);f instanceof Promise?o.push(f.then(d=>zr(d,i,c))):zr(f,i,c)}}return o.length?Promise.all(o).then(()=>i):i}});function zr(t,e,n){t.issues.length&&e.issues.push(...fn(n,t.issues)),e.value[n]=t.value}const up=Z("$ZodRecord",(t,e)=>{It.init(t,e),t._zod.parse=(n,i)=>{const r=n.value;if(!kn(r))return n.issues.push({expected:"record",code:"invalid_type",input:r,inst:t}),n;const s=[],o=e.keyType._zod.values;if(o){n.value={};const a=new Set;for(const c of o)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){a.add(typeof c=="number"?c.toString():c);const h=e.valueType._zod.run({value:r[c],issues:[]},i);h instanceof Promise?s.push(h.then(p=>{p.issues.length&&n.issues.push(...fn(c,p.issues)),n.value[c]=p.value})):(h.issues.length&&n.issues.push(...fn(c,h.issues)),n.value[c]=h.value)}let l;for(const c in r)a.has(c)||(l=l??[],l.push(c));l&&l.length>0&&n.issues.push({code:"unrecognized_keys",input:r,inst:t,keys:l})}else{n.value={};for(const a of Reflect.ownKeys(r)){if(a==="__proto__")continue;const l=e.keyType._zod.run({value:a,issues:[]},i);if(l instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(l.issues.length){n.issues.push({code:"invalid_key",origin:"record",issues:l.issues.map(h=>Qe(h,i,Ye())),input:a,path:[a],inst:t}),n.value[l.value]=l.value;continue}const c=e.valueType._zod.run({value:r[a],issues:[]},i);c instanceof Promise?s.push(c.then(h=>{h.issues.length&&n.issues.push(...fn(a,h.issues)),n.value[l.value]=h.value})):(c.issues.length&&n.issues.push(...fn(a,c.issues)),n.value[l.value]=c.value)}}return s.length?Promise.all(s).then(()=>n):n}}),dp=Z("$ZodEnum",(t,e)=>{It.init(t,e);const n=v0(e.entries),i=new Set(n);t._zod.values=i,t._zod.pattern=new RegExp(`^(${n.filter(r=>w0.has(typeof r)).map(r=>typeof r=="string"?En(r):r.toString()).join("|")})$`),t._zod.parse=(r,s)=>{const o=r.value;return i.has(o)||r.issues.push({code:"invalid_value",values:n,input:o,inst:t}),r}}),fp=Z("$ZodLiteral",(t,e)=>{if(It.init(t,e),e.values.length===0)throw new Error("Cannot create literal schema with no valid values");const n=new Set(e.values);t._zod.values=n,t._zod.pattern=new RegExp(`^(${e.values.map(i=>typeof i=="string"?En(i):i?En(i.toString()):String(i)).join("|")})$`),t._zod.parse=(i,r)=>{const s=i.value;return n.has(s)||i.issues.push({code:"invalid_value",values:e.values,input:s,inst:t}),i}}),gp=Z("$ZodTransform",(t,e)=>{It.init(t,e),t._zod.parse=(n,i)=>{if(i.direction==="backward")throw new Sc(t.constructor.name);const r=e.transform(n.value,n);if(i.async)return(r instanceof Promise?r:Promise.resolve(r)).then(o=>(n.value=o,n));if(r instanceof Promise)throw new Pn;return n.value=r,n}});function Wc(t,e){return t.issues.length&&e===void 0?{issues:[],value:void 0}:t}const pp=Z("$ZodOptional",(t,e)=>{It.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Tt(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Tt(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${Ys(n.source)})?$`):void 0}),t._zod.parse=(n,i)=>{if(e.innerType._zod.optin==="optional"){const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>Wc(s,n.value)):Wc(r,n.value)}return n.value===void 0?n:e.innerType._zod.run(n,i)}}),mp=Z("$ZodNullable",(t,e)=>{It.init(t,e),Tt(t._zod,"optin",()=>e.innerType._zod.optin),Tt(t._zod,"optout",()=>e.innerType._zod.optout),Tt(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${Ys(n.source)}|null)$`):void 0}),Tt(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(n,i)=>n.value===null?n:e.innerType._zod.run(n,i)}),_p=Z("$ZodDefault",(t,e)=>{It.init(t,e),t._zod.optin="optional",Tt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,i)=>{if(i.direction==="backward")return e.innerType._zod.run(n,i);if(n.value===void 0)return n.value=e.defaultValue,n;const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>jc(s,e)):jc(r,e)}});function jc(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const vp=Z("$ZodPrefault",(t,e)=>{It.init(t,e),t._zod.optin="optional",Tt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,i)=>(i.direction==="backward"||n.value===void 0&&(n.value=e.defaultValue),e.innerType._zod.run(n,i))}),bp=Z("$ZodNonOptional",(t,e)=>{It.init(t,e),Tt(t._zod,"values",()=>{const n=e.innerType._zod.values;return n?new Set([...n].filter(i=>i!==void 0)):void 0}),t._zod.parse=(n,i)=>{const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>Zc(s,t)):Zc(r,t)}});function Zc(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const yp=Z("$ZodCatch",(t,e)=>{It.init(t,e),Tt(t._zod,"optin",()=>e.innerType._zod.optin),Tt(t._zod,"optout",()=>e.innerType._zod.optout),Tt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,i)=>{if(i.direction==="backward")return e.innerType._zod.run(n,i);const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>(n.value=s.value,s.issues.length&&(n.value=e.catchValue({...n,error:{issues:s.issues.map(o=>Qe(o,i,Ye()))},input:n.value}),n.issues=[]),n)):(n.value=r.value,r.issues.length&&(n.value=e.catchValue({...n,error:{issues:r.issues.map(s=>Qe(s,i,Ye()))},input:n.value}),n.issues=[]),n)}}),Sp=Z("$ZodPipe",(t,e)=>{It.init(t,e),Tt(t._zod,"values",()=>e.in._zod.values),Tt(t._zod,"optin",()=>e.in._zod.optin),Tt(t._zod,"optout",()=>e.out._zod.optout),Tt(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(n,i)=>{if(i.direction==="backward"){const s=e.out._zod.run(n,i);return s instanceof Promise?s.then(o=>Lr(o,e.in,i)):Lr(s,e.in,i)}const r=e.in._zod.run(n,i);return r instanceof Promise?r.then(s=>Lr(s,e.out,i)):Lr(r,e.out,i)}});function Lr(t,e,n){return t.issues.length?(t.aborted=!0,t):e._zod.run({value:t.value,issues:t.issues},n)}const wp=Z("$ZodReadonly",(t,e)=>{It.init(t,e),Tt(t._zod,"propValues",()=>e.innerType._zod.propValues),Tt(t._zod,"values",()=>e.innerType._zod.values),Tt(t._zod,"optin",()=>e.innerType?._zod?.optin),Tt(t._zod,"optout",()=>e.innerType?._zod?.optout),t._zod.parse=(n,i)=>{if(i.direction==="backward")return e.innerType._zod.run(n,i);const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(qc):qc(r)}});function qc(t){return t.value=Object.freeze(t.value),t}const xp=Z("$ZodCustom",(t,e)=>{oe.init(t,e),It.init(t,e),t._zod.parse=(n,i)=>n,t._zod.check=n=>{const i=n.value,r=e.fn(i);if(r instanceof Promise)return r.then(s=>Kc(s,n,i,t));Kc(r,n,i,t)}});function Kc(t,e,n,i){if(!t){const r={code:"custom",input:n,inst:i,path:[...i._zod.def.path??[]],continue:!i._zod.def.abort};i._zod.def.params&&(r.params=i._zod.def.params),e.issues.push(ji(r))}}var Yc;class Cp{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...n){const i=n[0];if(this._map.set(e,i),i&&typeof i=="object"&&"id"in i){if(this._idmap.has(i.id))throw new Error(`ID ${i.id} already exists in the registry`);this._idmap.set(i.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const i={...this.get(n)??{}};delete i.id;const r={...i,...this._map.get(e)};return Object.keys(r).length?r:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function Pp(){return new Cp}(Yc=globalThis).__zod_globalRegistry??(Yc.__zod_globalRegistry=Pp());const Gr=globalThis.__zod_globalRegistry;function kp(t,e){return new t({type:"string",...ht(e)})}function Ep(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...ht(e)})}function Xc(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...ht(e)})}function Tp(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...ht(e)})}function Rp(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ht(e)})}function Ap(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ht(e)})}function Mp(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ht(e)})}function Np(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...ht(e)})}function Ip(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...ht(e)})}function Op(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...ht(e)})}function Fp(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...ht(e)})}function Dp(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...ht(e)})}function zp(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...ht(e)})}function Lp(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...ht(e)})}function Gp(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...ht(e)})}function Up(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...ht(e)})}function Hp(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...ht(e)})}function Bp(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ht(e)})}function Vp(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ht(e)})}function $p(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...ht(e)})}function Wp(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...ht(e)})}function jp(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...ht(e)})}function Zp(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...ht(e)})}function qp(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ht(e)})}function Kp(t,e){return new t({type:"string",format:"date",check:"string_format",...ht(e)})}function Yp(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...ht(e)})}function Xp(t,e){return new t({type:"string",format:"duration",check:"string_format",...ht(e)})}function Qp(t,e){return new t({type:"number",checks:[],...ht(e)})}function Jp(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...ht(e)})}function t1(t,e){return new t({type:"boolean",...ht(e)})}function e1(t){return new t({type:"unknown"})}function n1(t,e){return new t({type:"never",...ht(e)})}function Qc(t,e){return new Fc({check:"less_than",...ht(e),value:t,inclusive:!1})}function no(t,e){return new Fc({check:"less_than",...ht(e),value:t,inclusive:!0})}function Jc(t,e){return new Dc({check:"greater_than",...ht(e),value:t,inclusive:!1})}function io(t,e){return new Dc({check:"greater_than",...ht(e),value:t,inclusive:!0})}function th(t,e){return new mg({check:"multiple_of",...ht(e),value:t})}function eh(t,e){return new vg({check:"max_length",...ht(e),maximum:t})}function Ur(t,e){return new bg({check:"min_length",...ht(e),minimum:t})}function nh(t,e){return new yg({check:"length_equals",...ht(e),length:t})}function i1(t,e){return new Sg({check:"string_format",format:"regex",...ht(e),pattern:t})}function r1(t){return new wg({check:"string_format",format:"lowercase",...ht(t)})}function s1(t){return new xg({check:"string_format",format:"uppercase",...ht(t)})}function o1(t,e){return new Cg({check:"string_format",format:"includes",...ht(e),includes:t})}function a1(t,e){return new Pg({check:"string_format",format:"starts_with",...ht(e),prefix:t})}function l1(t,e){return new kg({check:"string_format",format:"ends_with",...ht(e),suffix:t})}function Rn(t){return new Eg({check:"overwrite",tx:t})}function c1(t){return Rn(e=>e.normalize(t))}function h1(){return Rn(t=>t.trim())}function u1(){return Rn(t=>t.toLowerCase())}function d1(){return Rn(t=>t.toUpperCase())}function f1(){return Rn(t=>y0(t))}function g1(t,e,n){return new t({type:"array",element:e,...ht(n)})}function p1(t,e,n){return new t({type:"custom",check:"custom",fn:e,...ht(n)})}function m1(t){const e=_1(n=>(n.addIssue=i=>{if(typeof i=="string")n.issues.push(ji(i,n.value,e._zod.def));else{const r=i;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=e),r.continue??(r.continue=!e._zod.def.abort),n.issues.push(ji(r))}},t(n.value,n)));return e}function _1(t,e){const n=new oe({check:"custom",...ht(e)});return n._zod.check=t,n}const v1=Z("ZodISODateTime",(t,e)=>{Hg.init(t,e),zt.init(t,e)});function b1(t){return qp(v1,t)}const y1=Z("ZodISODate",(t,e)=>{Bg.init(t,e),zt.init(t,e)});function S1(t){return Kp(y1,t)}const w1=Z("ZodISOTime",(t,e)=>{Vg.init(t,e),zt.init(t,e)});function x1(t){return Yp(w1,t)}const C1=Z("ZodISODuration",(t,e)=>{$g.init(t,e),zt.init(t,e)});function P1(t){return Xp(C1,t)}const me=Z("ZodError",(t,e)=>{Tc.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:n=>I0(t,n)},flatten:{value:n=>N0(t,n)},addIssue:{value:n=>{t.issues.push(n),t.message=JSON.stringify(t.issues,qs,2)}},addIssues:{value:n=>{t.issues.push(...n),t.message=JSON.stringify(t.issues,qs,2)}},isEmpty:{get(){return t.issues.length===0}}})},{Parent:Error}),k1=Qs(me),E1=Js(me),T1=Ir(me),R1=Or(me),A1=D0(me),M1=z0(me),N1=L0(me),I1=G0(me),O1=U0(me),F1=H0(me),D1=B0(me),z1=V0(me),Dt=Z("ZodType",(t,e)=>(It.init(t,e),t.def=e,t.type=e.type,Object.defineProperty(t,"_def",{value:e}),t.check=(...n)=>t.clone(dn(e,{checks:[...e.checks??[],...n.map(i=>typeof i=="function"?{_zod:{check:i,def:{check:"custom"},onattach:[]}}:i)]})),t.clone=(n,i)=>Xe(t,n,i),t.brand=()=>t,t.register=(n,i)=>(n.add(t,i),t),t.parse=(n,i)=>k1(t,n,i,{callee:t.parse}),t.safeParse=(n,i)=>T1(t,n,i),t.parseAsync=async(n,i)=>E1(t,n,i,{callee:t.parseAsync}),t.safeParseAsync=async(n,i)=>R1(t,n,i),t.spa=t.safeParseAsync,t.encode=(n,i)=>A1(t,n,i),t.decode=(n,i)=>M1(t,n,i),t.encodeAsync=async(n,i)=>N1(t,n,i),t.decodeAsync=async(n,i)=>I1(t,n,i),t.safeEncode=(n,i)=>O1(t,n,i),t.safeDecode=(n,i)=>F1(t,n,i),t.safeEncodeAsync=async(n,i)=>D1(t,n,i),t.safeDecodeAsync=async(n,i)=>z1(t,n,i),t.refine=(n,i)=>t.check(N2(n,i)),t.superRefine=n=>t.check(I2(n)),t.overwrite=n=>t.check(Rn(n)),t.optional=()=>uh(t),t.nullable=()=>dh(t),t.nullish=()=>uh(dh(t)),t.nonoptional=n=>P2(t,n),t.array=()=>Br(t),t.or=n=>c2([t,n]),t.and=n=>d2(t,n),t.transform=n=>gh(t,b2(n)),t.default=n=>w2(t,n),t.prefault=n=>C2(t,n),t.catch=n=>E2(t,n),t.pipe=n=>gh(t,n),t.readonly=()=>A2(t),t.describe=n=>{const i=t.clone();return Gr.add(i,{description:n}),i},Object.defineProperty(t,"description",{get(){return Gr.get(t)?.description},configurable:!0}),t.meta=(...n)=>{if(n.length===0)return Gr.get(t);const i=t.clone();return Gr.add(i,n[0]),i},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),ih=Z("_ZodString",(t,e)=>{to.init(t,e),Dt.init(t,e);const n=t._zod.bag;t.format=n.format??null,t.minLength=n.minimum??null,t.maxLength=n.maximum??null,t.regex=(...i)=>t.check(i1(...i)),t.includes=(...i)=>t.check(o1(...i)),t.startsWith=(...i)=>t.check(a1(...i)),t.endsWith=(...i)=>t.check(l1(...i)),t.min=(...i)=>t.check(Ur(...i)),t.max=(...i)=>t.check(eh(...i)),t.length=(...i)=>t.check(nh(...i)),t.nonempty=(...i)=>t.check(Ur(1,...i)),t.lowercase=i=>t.check(r1(i)),t.uppercase=i=>t.check(s1(i)),t.trim=()=>t.check(h1()),t.normalize=(...i)=>t.check(c1(...i)),t.toLowerCase=()=>t.check(u1()),t.toUpperCase=()=>t.check(d1()),t.slugify=()=>t.check(f1())}),L1=Z("ZodString",(t,e)=>{to.init(t,e),ih.init(t,e),t.email=n=>t.check(Ep(G1,n)),t.url=n=>t.check(Np(U1,n)),t.jwt=n=>t.check(Zp(e2,n)),t.emoji=n=>t.check(Ip(H1,n)),t.guid=n=>t.check(Xc(rh,n)),t.uuid=n=>t.check(Tp(Hr,n)),t.uuidv4=n=>t.check(Rp(Hr,n)),t.uuidv6=n=>t.check(Ap(Hr,n)),t.uuidv7=n=>t.check(Mp(Hr,n)),t.nanoid=n=>t.check(Op(B1,n)),t.guid=n=>t.check(Xc(rh,n)),t.cuid=n=>t.check(Fp(V1,n)),t.cuid2=n=>t.check(Dp($1,n)),t.ulid=n=>t.check(zp(W1,n)),t.base64=n=>t.check($p(Q1,n)),t.base64url=n=>t.check(Wp(J1,n)),t.xid=n=>t.check(Lp(j1,n)),t.ksuid=n=>t.check(Gp(Z1,n)),t.ipv4=n=>t.check(Up(q1,n)),t.ipv6=n=>t.check(Hp(K1,n)),t.cidrv4=n=>t.check(Bp(Y1,n)),t.cidrv6=n=>t.check(Vp(X1,n)),t.e164=n=>t.check(jp(t2,n)),t.datetime=n=>t.check(b1(n)),t.date=n=>t.check(S1(n)),t.time=n=>t.check(x1(n)),t.duration=n=>t.check(P1(n))});function An(t){return kp(L1,t)}const zt=Z("ZodStringFormat",(t,e)=>{Ft.init(t,e),ih.init(t,e)}),G1=Z("ZodEmail",(t,e)=>{Ng.init(t,e),zt.init(t,e)}),rh=Z("ZodGUID",(t,e)=>{Ag.init(t,e),zt.init(t,e)}),Hr=Z("ZodUUID",(t,e)=>{Mg.init(t,e),zt.init(t,e)}),U1=Z("ZodURL",(t,e)=>{Ig.init(t,e),zt.init(t,e)}),H1=Z("ZodEmoji",(t,e)=>{Og.init(t,e),zt.init(t,e)}),B1=Z("ZodNanoID",(t,e)=>{Fg.init(t,e),zt.init(t,e)}),V1=Z("ZodCUID",(t,e)=>{Dg.init(t,e),zt.init(t,e)}),$1=Z("ZodCUID2",(t,e)=>{zg.init(t,e),zt.init(t,e)}),W1=Z("ZodULID",(t,e)=>{Lg.init(t,e),zt.init(t,e)}),j1=Z("ZodXID",(t,e)=>{Gg.init(t,e),zt.init(t,e)}),Z1=Z("ZodKSUID",(t,e)=>{Ug.init(t,e),zt.init(t,e)}),q1=Z("ZodIPv4",(t,e)=>{Wg.init(t,e),zt.init(t,e)}),K1=Z("ZodIPv6",(t,e)=>{jg.init(t,e),zt.init(t,e)}),Y1=Z("ZodCIDRv4",(t,e)=>{Zg.init(t,e),zt.init(t,e)}),X1=Z("ZodCIDRv6",(t,e)=>{qg.init(t,e),zt.init(t,e)}),Q1=Z("ZodBase64",(t,e)=>{Kg.init(t,e),zt.init(t,e)}),J1=Z("ZodBase64URL",(t,e)=>{Xg.init(t,e),zt.init(t,e)}),t2=Z("ZodE164",(t,e)=>{Qg.init(t,e),zt.init(t,e)}),e2=Z("ZodJWT",(t,e)=>{tp.init(t,e),zt.init(t,e)}),sh=Z("ZodNumber",(t,e)=>{Lc.init(t,e),Dt.init(t,e),t.gt=(i,r)=>t.check(Jc(i,r)),t.gte=(i,r)=>t.check(io(i,r)),t.min=(i,r)=>t.check(io(i,r)),t.lt=(i,r)=>t.check(Qc(i,r)),t.lte=(i,r)=>t.check(no(i,r)),t.max=(i,r)=>t.check(no(i,r)),t.int=i=>t.check(oh(i)),t.safe=i=>t.check(oh(i)),t.positive=i=>t.check(Jc(0,i)),t.nonnegative=i=>t.check(io(0,i)),t.negative=i=>t.check(Qc(0,i)),t.nonpositive=i=>t.check(no(0,i)),t.multipleOf=(i,r)=>t.check(th(i,r)),t.step=(i,r)=>t.check(th(i,r)),t.finite=()=>t;const n=t._zod.bag;t.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),t.isFinite=!0,t.format=n.format??null});function Vt(t){return Qp(sh,t)}const n2=Z("ZodNumberFormat",(t,e)=>{ep.init(t,e),sh.init(t,e)});function oh(t){return Jp(n2,t)}const i2=Z("ZodBoolean",(t,e)=>{np.init(t,e),Dt.init(t,e)});function ro(t){return t1(i2,t)}const r2=Z("ZodUnknown",(t,e)=>{ip.init(t,e),Dt.init(t,e)});function so(){return e1(r2)}const s2=Z("ZodNever",(t,e)=>{rp.init(t,e),Dt.init(t,e)});function o2(t){return n1(s2,t)}const a2=Z("ZodArray",(t,e)=>{sp.init(t,e),Dt.init(t,e),t.element=e.element,t.min=(n,i)=>t.check(Ur(n,i)),t.nonempty=n=>t.check(Ur(1,n)),t.max=(n,i)=>t.check(eh(n,i)),t.length=(n,i)=>t.check(nh(n,i)),t.unwrap=()=>t.element});function Br(t,e){return g1(a2,t,e)}const l2=Z("ZodObject",(t,e)=>{ap.init(t,e),Dt.init(t,e),Tt(t,"shape",()=>e.shape),t.keyof=()=>ch(Object.keys(t._zod.def.shape)),t.catchall=n=>t.clone({...t._zod.def,catchall:n}),t.passthrough=()=>t.clone({...t._zod.def,catchall:so()}),t.loose=()=>t.clone({...t._zod.def,catchall:so()}),t.strict=()=>t.clone({...t._zod.def,catchall:o2()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=n=>E0(t,n),t.safeExtend=n=>T0(t,n),t.merge=n=>R0(t,n),t.pick=n=>P0(t,n),t.omit=n=>k0(t,n),t.partial=(...n)=>A0(hh,t,n[0]),t.required=(...n)=>M0(fh,t,n[0])});function ne(t,e){const n={type:"object",shape:t??{},...ht(e)};return new l2(n)}const ah=Z("ZodUnion",(t,e)=>{Vc.init(t,e),Dt.init(t,e),t.options=e.options});function c2(t,e){return new ah({type:"union",options:t,...ht(e)})}const h2=Z("ZodDiscriminatedUnion",(t,e)=>{ah.init(t,e),lp.init(t,e)});function lh(t,e,n){return new h2({type:"union",options:e,discriminator:t,...ht(n)})}const u2=Z("ZodIntersection",(t,e)=>{cp.init(t,e),Dt.init(t,e)});function d2(t,e){return new u2({type:"intersection",left:t,right:e})}const f2=Z("ZodTuple",(t,e)=>{hp.init(t,e),Dt.init(t,e),t.rest=n=>t.clone({...t._zod.def,rest:n})});function g2(t,e,n){const i=e instanceof It,r=i?n:e,s=i?e:null;return new f2({type:"tuple",items:t,rest:s,...ht(r)})}const p2=Z("ZodRecord",(t,e)=>{up.init(t,e),Dt.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function m2(t,e,n){return new p2({type:"record",keyType:t,valueType:e,...ht(n)})}const oo=Z("ZodEnum",(t,e)=>{dp.init(t,e),Dt.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));t.extract=(i,r)=>{const s={};for(const o of i)if(n.has(o))s[o]=e.entries[o];else throw new Error(`Key ${o} not found in enum`);return new oo({...e,checks:[],...ht(r),entries:s})},t.exclude=(i,r)=>{const s={...e.entries};for(const o of i)if(n.has(o))delete s[o];else throw new Error(`Key ${o} not found in enum`);return new oo({...e,checks:[],...ht(r),entries:s})}});function ch(t,e){const n=Array.isArray(t)?Object.fromEntries(t.map(i=>[i,i])):t;return new oo({type:"enum",entries:n,...ht(e)})}const _2=Z("ZodLiteral",(t,e)=>{fp.init(t,e),Dt.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function Ue(t,e){return new _2({type:"literal",values:Array.isArray(t)?t:[t],...ht(e)})}const v2=Z("ZodTransform",(t,e)=>{gp.init(t,e),Dt.init(t,e),t._zod.parse=(n,i)=>{if(i.direction==="backward")throw new Sc(t.constructor.name);n.addIssue=s=>{if(typeof s=="string")n.issues.push(ji(s,n.value,e));else{const o=s;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=n.value),o.inst??(o.inst=t),n.issues.push(ji(o))}};const r=e.transform(n.value,n);return r instanceof Promise?r.then(s=>(n.value=s,n)):(n.value=r,n)}});function b2(t){return new v2({type:"transform",transform:t})}const hh=Z("ZodOptional",(t,e)=>{pp.init(t,e),Dt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function uh(t){return new hh({type:"optional",innerType:t})}const y2=Z("ZodNullable",(t,e)=>{mp.init(t,e),Dt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function dh(t){return new y2({type:"nullable",innerType:t})}const S2=Z("ZodDefault",(t,e)=>{_p.init(t,e),Dt.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function w2(t,e){return new S2({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():kc(e)}})}const x2=Z("ZodPrefault",(t,e)=>{vp.init(t,e),Dt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function C2(t,e){return new x2({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():kc(e)}})}const fh=Z("ZodNonOptional",(t,e)=>{bp.init(t,e),Dt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function P2(t,e){return new fh({type:"nonoptional",innerType:t,...ht(e)})}const k2=Z("ZodCatch",(t,e)=>{yp.init(t,e),Dt.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function E2(t,e){return new k2({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const T2=Z("ZodPipe",(t,e)=>{Sp.init(t,e),Dt.init(t,e),t.in=e.in,t.out=e.out});function gh(t,e){return new T2({type:"pipe",in:t,out:e})}const R2=Z("ZodReadonly",(t,e)=>{wp.init(t,e),Dt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function A2(t){return new R2({type:"readonly",innerType:t})}const M2=Z("ZodCustom",(t,e)=>{xp.init(t,e),Dt.init(t,e)});function N2(t,e={}){return p1(M2,t,e)}function I2(t){return m1(t)}const ph=ch(["notes","selection","playhead","viewport","grid","other"]),ao=m2(An(),so()).optional(),O2=ne({time:Vt(),pitchOffset:Vt(),metadata:ao,rooted:ro().optional()}),mh=ne({points:Br(O2)}).optional(),F2=ne({id:An().optional(),pitch:Vt().int().min(0).max(127),position:Vt(),duration:Vt().positive(),velocity:Vt().int().min(0).max(127).optional(),mpePitch:mh,metadata:ao}),D2=ne({id:An(),pitch:Vt().int().min(0).max(127),position:Vt(),duration:Vt().positive(),velocity:Vt().int().min(0).max(127),mpePitch:mh,metadata:ao}),z2=ne({type:Ue("setNotes"),notes:Br(F2)}),L2=ne({type:Ue("setLivePlayhead"),position:Vt().nonnegative()}),G2=ne({type:Ue("fitZoomToNotes")}),U2=ne({type:Ue("getPlayStartPosition"),requestId:An().optional()}),H2=ne({type:Ue("setConfig"),width:Vt().positive().optional(),height:Vt().positive().optional(),interactive:ro().optional(),showControlPanel:ro().optional()}),B2=lh("type",[z2,L2,G2,U2,H2]),V2=ne({type:Ue("notesUpdate"),notes:Br(g2([An(),D2])),source:ph.optional()}),$2=ne({type:Ue("stateUpdate"),viewport:ne({scrollX:Vt(),scrollY:Vt(),zoomX:Vt(),zoomY:Vt()}),grid:ne({quarterNoteWidth:Vt(),noteHeight:Vt(),subdivision:Vt()}),source:ph.optional()}),W2=ne({type:Ue("playStartPositionResponse"),position:Vt(),requestId:An().optional()}),j2=ne({type:Ue("connectionReady")}),Z2=lh("type",[V2,$2,W2,j2]);class q2{ws=null;reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;reconnectTimer=null;address;handlers={};constructor(e){this.address=e}setHandlers(e){this.handlers=e}connect(){if(this.ws?.readyState!==WebSocket.OPEN)try{this.ws=new WebSocket(this.address),this.ws.onopen=()=>{this.reconnectAttempts=0,this.send({type:"connectionReady"})},this.ws.onmessage=e=>{this.handleMessage(e.data)},this.ws.onclose=()=>{this.scheduleReconnect()},this.ws.onerror=()=>{}}catch{this.scheduleReconnect()}}scheduleReconnect(){this.reconnectAttempts>=this.maxReconnectAttempts||(this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.reconnectAttempts++,this.connect()},this.reconnectDelay*Math.pow(2,this.reconnectAttempts)))}handleMessage(e){let n;try{n=JSON.parse(e)}catch{console.warn("[PianoRollWS] Invalid JSON received:",e);return}const i=B2.safeParse(n);if(!i.success){console.warn("[PianoRollWS] Invalid message format:",i.error.format());return}const r=i.data;switch(r.type){case"setNotes":this.handlers.onSetNotes?.(r.notes);break;case"setLivePlayhead":this.handlers.onSetLivePlayhead?.(r.position);break;case"fitZoomToNotes":this.handlers.onFitZoomToNotes?.();break;case"getPlayStartPosition":this.handlers.onGetPlayStartPosition?.(r.requestId);break;case"setConfig":this.handlers.onSetConfig?.({width:r.width,height:r.height,interactive:r.interactive,showControlPanel:r.showControlPanel});break}}send(e){if(this.ws?.readyState!==WebSocket.OPEN)return;const n=Z2.safeParse(e);if(!n.success){console.warn("[PianoRollWS] Invalid outgoing message:",n.error.format());return}this.ws.send(JSON.stringify(e))}sendNotesUpdate(e,n){this.send({type:"notesUpdate",notes:e,source:n})}sendStateUpdate(e,n){this.send({type:"stateUpdate",viewport:{scrollX:e.viewport.scrollX,scrollY:e.viewport.scrollY,zoomX:e.viewport.zoomX,zoomY:e.viewport.zoomY},grid:{quarterNoteWidth:e.grid.quarterNoteWidth,noteHeight:e.grid.noteHeight,subdivision:e.grid.subdivision},source:n})}sendPlayStartPositionResponse(e,n){this.send({type:"playStartPositionResponse",position:e,requestId:n})}disconnect(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.onclose=null,this.ws.close(),this.ws=null)}get isConnected(){return this.ws?.readyState===WebSocket.OPEN}}const K2=(t="note_")=>`${t}${Date.now()}_${Math.random().toString(36).substr(2,9)}`;function _h(t,e){const{scrollX:n,scrollY:i}=e.viewport,{quarterNoteWidth:r,noteHeight:s}=e.grid,o=t.x+n,a=t.y+i,l=o/r;return{pitch:127-Math.floor(a/s),position:l}}function Zi(t,e,n){const{scrollX:i,scrollY:r}=n.viewport,{quarterNoteWidth:s,noteHeight:o}=n.grid,a=e*s,l=(127-t)*o;return{x:a-i,y:l-r}}function vh(t,e){const n=e/4;return Math.floor(t*n)/n}function bh(t){return t.grid.quarterNoteWidth*(4/t.grid.subdivision)}function yh(t,e){const{scrollX:n,scrollY:i}=e.viewport,{quarterNoteWidth:r,noteHeight:s}=e.grid,o=e.stage;if(!o)return!1;const a=o.width(),l=o.height(),c=n/r,h=(n+a)/r,p=Math.floor(i/s),f=Math.ceil((i+l)/s),d=t.position+t.duration,g=127-t.pitch;return!(d<c||t.position>h||g<p||g>f)}function Y2(t,e){const{scrollX:n,scrollY:i}=t.viewport,{quarterNoteWidth:r,noteHeight:s}=t.grid,o=[];return t.notes.forEach((a,l)=>{const c=Zi(a.pitch,a.position,t),h=a.duration*r,p=c.x+h,f=c.y+s,d=e.x+e.width,g=e.y+e.height;!(p<e.x||c.x>d||f<e.y||c.y>g)&&o.push(l)}),o}function Sh(t,e){const n=new Set(e);if(n.size===0)return t.interaction.createEmptyOverlapAdjustments();const i=new Set,r=new Map;return n.forEach(s=>{const o=t.notes.get(s);if(!o)return;const a=o.position+o.duration;t.notes.forEach((l,c)=>{if(n.has(c)||l.pitch!==o.pitch)return;const h=l.position+l.duration;if(l.position<o.position&&o.position<h){const p=o.position-l.position;p>0?i.has(c)||r.set(c,p):(i.add(c),r.delete(c))}else o.position<=l.position&&l.position<a&&(i.add(c),r.delete(c))})}),i.size===0&&r.size===0?t.interaction.createEmptyOverlapAdjustments():{toDelete:i,toTruncate:r}}function wh(t){t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear();const e=Sh(t,t.selection.selectedIds);e.toDelete.forEach(n=>t.interaction.hiddenNoteIds.add(n)),e.toTruncate.forEach((n,i)=>t.interaction.truncatedNotes.set(i,n))}function X2(t,e,n){return t.interaction.truncatedNotes.get(e)??n}function lo(t,e){let n=null,i=!1;if(!e&&(t.interaction.hiddenNoteIds.size>0||t.interaction.truncatedNotes.size>0))n={toDelete:new Set(t.interaction.hiddenNoteIds),toTruncate:new Map(t.interaction.truncatedNotes)},i=!0;else{const r=e??t.selection.selectedIds;n=Sh(t,r)}return n.toDelete.size===0&&n.toTruncate.size===0?(i||(t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear()),n):(n.toDelete.forEach(r=>{t.notes.delete(r),t.selection.selectedIds.delete(r)}),n.toTruncate.forEach((r,s)=>{const o=t.notes.get(s);o&&(o.duration=Math.max(r,0))}),t.needsRedraw=!0,i||(t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear()),n)}function xh(t){t.interaction.truncatedNotes.clear(),t.interaction.hiddenNoteIds.clear()}function Q2(t){let n=null;for(const i of t.selection.selectedIds){const r=t.notes.get(i);if(!r)continue;let s=1/0,o=null;if(t.notes.forEach((a,l)=>{if(t.selection.selectedIds.has(l))return;const c=Math.abs(r.position-a.position);c<s&&c<.1&&(s=c,o=a.position)}),o!==null){n=o-r.position;break}}n!==null&&t.selection.selectedIds.forEach(i=>{const r=t.notes.get(i);r&&(r.position+=n)})}const J2=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function Ch(t){return J2[t%12]+(Math.floor(t/12)-2)}class tm{constructor(e,n,i){this.captureState=e,this.restoreState=n,this.onChangeCallback=i}stack=[];currentIndex=-1;onChangeCallback;executeCommand(e,n){const i=this.captureState();n();const r=this.captureState();i!==r&&this.pushCommand(e,i,r)}pushCommand(e,n,i){this.stack=this.stack.slice(0,this.currentIndex+1),this.stack.push({name:e,beforeState:n,afterState:i}),this.currentIndex++,this.onChangeCallback?.()}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.stack.length-1}undo(){if(!this.canUndo())return;const e=this.stack[this.currentIndex];this.restoreState(e.beforeState),this.currentIndex--,this.onChangeCallback?.()}redo(){if(!this.canRedo())return;this.currentIndex++;const e=this.stack[this.currentIndex];this.restoreState(e.afterState),this.onChangeCallback?.()}clear(){this.stack=[],this.currentIndex=-1,this.onChangeCallback?.()}}const Mn=24,em=.2,Ph={x:12,y:-14},nm=4,im="#000000",rm="#39d353",sm="#ff8c00";function gn(t){return JSON.stringify({notes:Array.from(t.notes.entries()),selection:Array.from(t.selection.selectedIds)})}function om(t,e){const n=JSON.parse(e);t.notes=new Map(n.notes),t.selection.selectedIds=new Set(n.selection),t.needsRedraw=!0}function am(t,e){if(t.size!==e.size)return!0;for(const n of t)if(!e.has(n))return!0;return!1}function Vr(t,e){const n=new Set(t.selection.selectedIds);e();const i=am(n,t.selection.selectedIds);return i&&t.notifyExternalChange?.("selection"),i}function lm(t,e,n){const i=new Bt.Layer({listening:!1,name:"grid-layer"});e.add(i),t.layers.grid=i;const r=new Bt.Layer({name:"notes-layer"});e.add(r),t.layers.notes=r;const s=new Bt.Layer({name:"overlay-layer"});e.add(s),t.layers.overlay=s,t.selection.selectionRect=new Bt.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),s.add(t.selection.selectionRect);const o=128*t.grid.noteHeight;t.queuePlayhead.element=new Bt.Line({points:[0,0,0,o],stroke:"#00ff00",strokeWidth:2,listening:!1}),s.add(t.queuePlayhead.element),t.livePlayhead.element=new Bt.Line({points:[0,0,0,o],stroke:"#ff8800",strokeWidth:2,listening:!1}),s.add(t.livePlayhead.element),t.command.stack=new tm(()=>gn(t),a=>om(t,a),()=>{t.needsRedraw=!0,n?.()})}function cm(t){const e=t.layers.grid;if(!e||!t.stage)return;const n=t.renderCache.grid,i=t.stage,r=i.width(),s=i.height();if(n.lastScrollX===t.viewport.scrollX&&n.lastScrollY===t.viewport.scrollY&&n.lastSubdivision===t.grid.subdivision&&n.lastQuarterNoteWidth===t.grid.quarterNoteWidth&&n.lastNoteHeight===t.grid.noteHeight&&n.lastStageWidth===r&&n.lastStageHeight===s)return;n.lastScrollX=t.viewport.scrollX,n.lastScrollY=t.viewport.scrollY,n.lastSubdivision=t.grid.subdivision,n.lastQuarterNoteWidth=t.grid.quarterNoteWidth,n.lastNoteHeight=t.grid.noteHeight,n.lastStageWidth=r,n.lastStageHeight=s,e.destroyChildren();const{scrollX:o,scrollY:a}=t.viewport,{quarterNoteWidth:l,noteHeight:c,numMeasures:h,timeSignature:p}=t.grid,f=128*c,d=p*4,g=l*d,v=Math.floor(o/g),w=Math.ceil((o+r)/g);for(let I=v;I<=w&&I<h;I++){const b=I%2===0?t.grid.backgroundColor1:t.grid.backgroundColor2,C=I*g-o;e.add(new Bt.Rect({x:C,y:-a,width:g,height:f,fill:b,listening:!1}))}const x=h*d*(t.grid.subdivision/4),m=l*(4/t.grid.subdivision),u=Math.floor(o/m),_=Math.ceil((o+r)/m);for(let I=u;I<=_&&I<x;I++){const b=I*m-o,E=I*m%l===0?1.8:1;e.add(new Bt.Line({points:[b,-a,b,f-a],stroke:"#000",strokeWidth:E,listening:!1}))}const S=Math.floor(a/c),P=Math.ceil((a+s)/c);for(let I=S;I<=P&&I<128;I++){const b=I*c-a;e.add(new Bt.Line({points:[0-o,b,h*g-o,b],stroke:"#000",strokeWidth:1,listening:!1}))}e.batchDraw()}function hm(t){const e=t.layers.notes;if(!e||!t.stage)return;e.destroyChildren();const{scrollX:n,scrollY:i}=t.viewport,{quarterNoteWidth:r,noteHeight:s}=t.grid,o=[],a=[];t.notes.forEach((l,c)=>{yh(l,t)&&(t.selection.selectedIds.has(c)?a.push([c,l]):o.push([c,l]))}),o.forEach(([l,c])=>{const h=Zi(c.pitch,c.position,t),f=X2(t,l,c.duration)*r,d=t.interaction.hiddenNoteIds.has(l),g=new Bt.Rect({x:h.x,y:h.y,width:f,height:s,fill:t.grid.noteColor,stroke:"#000",strokeWidth:1,opacity:d?.3:1,listening:!0});g.setAttr("noteId",l),e.add(g);const v=Ch(c.pitch),w=new Bt.Text({x:h.x+4,y:h.y+2,text:v,fontSize:14,fill:"#000",listening:!1});e.add(w),kh({state:t,noteId:l,note:c,screenX:h.x,screenY:h.y,width:f,isSelected:!1})}),a.forEach(([l,c])=>{const h=Zi(c.pitch,c.position,t),p=c.duration*r,f=t.interaction.hiddenNoteIds.has(l),d=new Bt.Rect({x:h.x,y:h.y,width:p,height:s,fill:t.grid.selectedNoteColor,stroke:"#000",strokeWidth:1,opacity:f?.3:1,listening:!0});d.setAttr("noteId",l),e.add(d);const g=Ch(c.pitch),v=new Bt.Text({x:h.x+4,y:h.y+2,text:g,fontSize:14,fill:"#000",listening:!1});e.add(v),kh({state:t,noteId:l,note:c,screenX:h.x,screenY:h.y,width:p,isSelected:!0})}),e.batchDraw()}function kh({state:t,noteId:e,note:n,screenX:i,screenY:r,width:s,isSelected:o}){const a=t.layers.notes;if(!a)return;const l=t.grid.noteHeight,c=(n.mpePitch?.points?.length??0)>0,h=t.mpe.enabled&&o,p=t.mpe.enabled&&!c;if(!c&&!p)return;const f=r+l/2,d=Eh({note:n,screenX:i,centerY:f,width:s,noteHeight:l}),g=new Bt.Line({points:d.flatMap(w=>[w.x,w.y]),stroke:"#000000",strokeWidth:2,hitStrokeWidth:12,lineCap:"round",lineJoin:"round",dash:c?[]:[6,4],listening:h||p});if(g.setAttr("mpeLineNoteId",e),g.setAttr("mpeLineEditable",h),a.add(g),!c&&p){g.on("mousedown touchstart",()=>{const w=t.stage?.getPointerPosition();if(!w)return;const{time:x,pitchOffset:m}=Mh({x:w.x,y:w.y,screenX:i,screenY:r,width:s,noteHeight:l});t.command.stack?.executeCommand("Add MPE Pitch Point",()=>{const u=t.notes.get(e);if(!u)return;t.selection.selectedIds.has(e)||Vr(t,()=>{t.selection.selectedIds.clear(),t.selection.selectedIds.add(e)});const _={time:x,pitchOffset:m},P=[...u.mpePitch?.points??[],_],I=$r(P);u.mpePitch={points:I};const b=I.findIndex(C=>C===_);b>=0&&Nn(t,[b]),t.needsRedraw=!0})});return}if(!c||!h)return;(n.mpePitch?.points??[]).forEach((w,x)=>{const m=Ki({point:w,screenX:i,centerY:f,width:s,noteHeight:l}),u=o&&t.mpe.selectedHandles.has(x),_=Rh(w,u),S=new Bt.Circle({x:m.x,y:m.y,radius:nm,fill:_.fill,strokeEnabled:!1,draggable:!0,name:"mpe-handle"});S.setAttr("mpeHandleNoteId",e),S.setAttr("mpeHandleIndex",x),S.setAttr("mpeLineRef",g),S.dragBoundFunc(P=>{const I=In(P.x,i,i+s),b=In(P.y,f-Mn*l,f+Mn*l);return{x:I,y:b}}),S.on("mousedown touchstart",()=>{t.mpe.selectedHandles.has(x)||(Nn(t,[x]),qi(t))}),S.on("dragstart",()=>{t.mpe.selectedHandles.has(x)||(Nn(t,[x]),qi(t));const P=pm(t),b=t.notes.get(e)?.mpePitch?.points??[],C=t.stage?.getPointerPosition(),E=Array.from(t.mpe.selectedHandles).sort((D,G)=>D-G),N=new Map;a&&a.find(".mpe-handle").forEach(D=>{const G=D.getAttr("mpeHandleNoteId"),U=Number(D.getAttr("mpeHandleIndex"));Number.isFinite(U)&&G===e&&E.includes(U)&&N.set(U,D)}),t.interaction.mpeDrag={noteId:e,pointIndex:x,beforeState:gn(t),tooltip:P,selectedIndices:E,startPointer:C?{x:C.x,y:C.y}:void 0,startPoints:b.map(D=>({...D})),handleRefs:N},P&&Ah(P,S.x(),S.y(),w.pitchOffset)}),S.on("dblclick dbltap",()=>{t.command.stack?.executeCommand("Delete MPE Pitch Point",()=>{const P=t.notes.get(e);if(!P?.mpePitch)return;const I=[...P.mpePitch.points];x<0||x>=I.length||(I.splice(x,1),P.mpePitch={points:I},co(t),t.needsRedraw=!0)})}),S.on("dragmove",P=>{P.target;const I=t.notes.get(e);if(!I?.mpePitch)return;const b=t.interaction.mpeDrag,C=t.stage?.getPointerPosition();if(!b||!C||!b.startPoints||!b.selectedIndices?.length)return;const E=!!P.evt?.shiftKey;b.fineMode!==E&&(b.fineMode=E,b.startPointer={x:C.x,y:C.y},b.startPoints=I.mpePitch.points.map(X=>({...X})));const N=b.startPointer,D=b.startPoints;if(!N||!D)return;const G=C.x-N.x;let U=C.y-N.y;b.fineMode&&(U*=em);let z=G/s,q=-(U/l);const y=fm(b.selectedIndices),k=0;let M=-1/0,R=1/0;y.forEach(({start:X,end:H})=>{const A=D[X]?.time??0,B=D[H]?.time??0,et=X>0?D[X-1]?.time:void 0,st=H<D.length-1?D[H+1]?.time:void 0,ct=Math.max(-A,et!==void 0?et+k-A:-A),T=Math.min(1-B,st!==void 0?st-k-B:1-B);M=Math.max(M,ct),R=Math.min(R,T)}),Number.isFinite(M)&&Number.isFinite(R)&&(z=In(z,M,R));let F=-1/0,$=1/0;b.selectedIndices.forEach(X=>{const H=D[X]?.pitchOffset??0;F=Math.max(F,-Mn-H),$=Math.min($,Mn-H)}),Number.isFinite(F)&&Number.isFinite($)&&(q=In(q,F,$));const L=[...I.mpePitch.points];b.selectedIndices.forEach(X=>{const H=D[X];H&&(L[X]={...H,time:H.time+z,pitchOffset:H.pitchOffset+q})}),I.mpePitch={points:L},um(g,I,i,f,s,l),b.selectedIndices.forEach(X=>{const H=b.handleRefs?.get(X);if(!H)return;const A=L[X],B=Ki({point:A,screenX:i,centerY:f,width:s,noteHeight:l});H.position({x:B.x,y:B.y})});const Y=L[x];if(b.tooltip&&Y){const X=Ki({point:Y,screenX:i,centerY:f,width:s,noteHeight:l});Ah(b.tooltip,X.x,X.y,Y.pitchOffset)}}),S.on("dragend",()=>{const P=t.interaction.mpeDrag,I=t.notes.get(e);I?.mpePitch?.points&&(I.mpePitch={points:$r(I.mpePitch.points)});const b=gn(t);P?.beforeState&&P.beforeState!==b&&t.command.stack?.pushCommand("Edit MPE Pitch Curve",P.beforeState,b),P?.tooltip&&(P.tooltip.group.destroy(),t.layers.overlay?.batchDraw()),t.interaction.mpeDrag=void 0,t.needsRedraw=!0}),a.add(S)}),g.on("mousedown touchstart",()=>{const w=t.stage?.getPointerPosition();if(!w)return;const{time:x,pitchOffset:m}=Mh({x:w.x,y:w.y,screenX:i,screenY:r,width:s,noteHeight:l});t.command.stack?.executeCommand("Add MPE Pitch Point",()=>{const u=t.notes.get(e);if(!u)return;const _={time:x,pitchOffset:m},P=[...u.mpePitch?.points??[],_],I=$r(P);u.mpePitch={points:I};const b=I.findIndex(C=>C===_);b>=0&&Nn(t,[b]),t.needsRedraw=!0})})}function Eh({note:t,screenX:e,centerY:n,width:i,noteHeight:r}){const s=t.mpePitch?.points??[];if(s.length===0)return[{x:e,y:n},{x:e+i,y:n}];const o=$r(s),a=o.map(p=>Ki({point:p,screenX:e,centerY:n,width:i,noteHeight:r})),l=a[0],c=a[a.length-1],h=[...a];return o[0].time>0?h.unshift({x:e,y:l.y}):h[0]={x:e,y:l.y},o[o.length-1].time<1?h.push({x:e+i,y:c.y}):h[h.length-1]={x:e+i,y:c.y},h}function um(t,e,n,i,r,s){const o=Eh({note:e,screenX:n,centerY:i,width:r,noteHeight:s});t.points(o.flatMap(a=>[a.x,a.y]))}function Th(t){return t.selection.selectedIds.size!==1?null:Array.from(t.selection.selectedIds)[0]??null}function qi(t){const e=t.layers.notes;if(!e)return;const n=Th(t);e.find(".mpe-handle").forEach(i=>{const r=i,s=Number(r.getAttr("mpeHandleIndex")),o=r.getAttr("mpeHandleNoteId");if(!Number.isFinite(s))return;const a=o===n&&t.mpe.selectedHandles.has(s),c=(o?t.notes.get(o):void 0)?.mpePitch?.points?.[s],h=Rh(c,a);r.fill(h.fill)}),e.batchDraw()}function Rh(t,e){const n=!!t?.rooted;return{fill:e?sm:n?rm:im}}function Nn(t,e){const n=new Set(e),i=t.mpe.selectedHandles;let r=i.size!==n.size;if(!r){for(const s of n)if(!i.has(s)){r=!0;break}}return r?(t.mpe.selectedHandles=n,t.notifyExternalChange?.("selection"),!0):!1}function co(t){return Nn(t,[])}function dm(t,e,n){const i=t.notes.get(e);if(!i?.mpePitch?.points?.length)return[];const r=Zi(i.pitch,i.position,t),s=i.duration*t.grid.quarterNoteWidth,o=r.y+t.grid.noteHeight/2,a=t.grid.noteHeight,l=n.x,c=n.x+n.width,h=n.y,p=n.y+n.height,f=[];return i.mpePitch.points.forEach((d,g)=>{const v=Ki({point:d,screenX:r.x,centerY:o,width:s,noteHeight:a});v.x>=l&&v.x<=c&&v.y>=h&&v.y<=p&&f.push(g)}),f}function fm(t){if(t.length===0)return[];const e=[...t].sort((s,o)=>s-o),n=[];let i=e[0],r=e[0];for(let s=1;s<e.length;s++){const o=e[s];if(o===r+1){r=o;continue}n.push({start:i,end:r}),i=o,r=o}return n.push({start:i,end:r}),n}function gm(t){const e=Math.round(t*100)/100,n=Object.is(e,-0)?0:e;return`${n>=0?"+":""}${n.toFixed(2)}`}function pm(t){const e=t.layers.overlay;if(!e)return;const n=6,i=new Bt.Group({listening:!1}),r=new Bt.Rect({fill:"rgba(0, 0, 0, 0.75)",cornerRadius:4}),s=new Bt.Text({text:"",fontSize:12,fontFamily:"Menlo, Monaco, Consolas, monospace",fill:"#fff"});return i.add(r),i.add(s),e.add(i),{group:i,background:r,text:s,padding:n}}function Ah(t,e,n,i){if(!t)return;const r=gm(i);t.text.text(r);const s=t.text.width(),o=t.text.height();t.background.width(s+t.padding*2),t.background.height(o+t.padding*2),t.text.position({x:t.padding,y:t.padding}),t.group.position({x:e+Ph.x,y:n+Ph.y-(o+t.padding*2)}),t.group.getLayer()?.batchDraw()}function Mh({x:t,y:e,screenX:n,screenY:i,width:r,noteHeight:s}){const o=i+s/2,a=In((t-n)/r,0,1),l=In((o-e)/s,-Mn,Mn);return{time:a,pitchOffset:l}}function Ki({point:t,screenX:e,centerY:n,width:i,noteHeight:r}){return{x:e+t.time*i,y:n-t.pitchOffset*r}}function $r(t){return[...t].sort((e,n)=>e.time-n.time)}function In(t,e,n){return Math.max(e,Math.min(n,t))}function mm(t){const e=t.layers.notes;if(!e)return;const{quarterNoteWidth:n,noteHeight:i}=t.grid,r=5;e.find(".resize-handle").forEach(s=>s.destroy()),t.selection.selectedIds.forEach(s=>{const o=t.notes.get(s);if(!o||!yh(o,t))return;const a=Zi(o.pitch,o.position,t),l=o.duration*n,c=new Bt.Circle({x:a.x,y:a.y+i/2,radius:r,fill:"#000",listening:!0,name:"resize-handle"});c.setAttr("handleNoteId",s),c.setAttr("handleIsEnd",!1),e.add(c);const h=new Bt.Circle({x:a.x+l,y:a.y+i/2,radius:r,fill:"#000",listening:!0,name:"resize-handle"});h.setAttr("handleNoteId",s),h.setAttr("handleIsEnd",!0),e.add(h)}),e.batchDraw()}function _m(t){if(!t.selection.selectionRect||!t.interaction.marqueeStart||!t.interaction.marqueeCurrent)return;const e=t.interaction.marqueeStart,n=t.interaction.marqueeCurrent,i=Math.min(e.x,n.x),r=Math.min(e.y,n.y),s=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y);t.selection.selectionRect.setAttrs({x:i,y:r,width:s,height:o,visible:s>5||o>5}),t.layers.overlay?.batchDraw()}function vm(t){if(!t.queuePlayhead.element)return;const{scrollX:e}=t.viewport,n=t.queuePlayhead.position*t.grid.quarterNoteWidth-e;t.queuePlayhead.element.x(n),t.layers.overlay?.batchDraw()}function bm(t){if(!t.livePlayhead.element)return;const{scrollX:e}=t.viewport,n=t.livePlayhead.position*t.grid.quarterNoteWidth-e;t.livePlayhead.element.x(n),t.layers.overlay?.batchDraw()}function ym(t,e){t.layers.notes;const n=t.layers.grid;e.on("dblclick",i=>{if(i.target===e||i.target.getLayer()===n){const r=e.getPointerPosition();if(!r)return;const{pitch:s,position:o}=_h(r,t),a=vh(o,t.grid.subdivision),l=Math.round(s);t.command.stack?.executeCommand("Add Note",()=>{const c={id:K2(),pitch:l,position:a,duration:4/t.grid.subdivision,velocity:.8};t.notes.set(c.id,c),t.needsRedraw=!0})}}),e.on("mousedown touchstart",i=>{const r=i.target,s=r.getAttr?.("handleNoteId");if(s){const a=r.getAttr("handleIsEnd");Cm(t,e,s,a);return}const o=r.getAttr?.("noteId");if(o){const a=t.selection.selectedIds.has(o);if(Vr(t,()=>{a||(t.selection.selectedIds.clear(),t.selection.selectedIds.add(o))}),t.mpe.enabled){co(t),qi(t),t.needsRedraw=!0;return}Sm(t,e),t.needsRedraw=!0;return}if(r===e||r.getLayer()===n){const a=e.getPointerPosition();if(!a)return;t.interaction.isMarqueeSelecting=!0,t.interaction.marqueeStart=a,t.interaction.marqueeCurrent=a,t.interaction.marqueeIsShift=!1,t.mpe.enabled?(co(t),qi(t)):Vr(t,()=>{t.selection.selectedIds.clear()}),t.needsRedraw=!0}}),e.on("mousemove touchmove",i=>{const r=e.getPointerPosition();if(r){if(t.interaction.isDragging){wm(t,e);return}if(t.interaction.isResizing){Pm(t,e);return}if(t.interaction.isMarqueeSelecting){t.interaction.marqueeCurrent=r,_m(t);const s={x:Math.min(t.interaction.marqueeStart.x,r.x),y:Math.min(t.interaction.marqueeStart.y,r.y),width:Math.abs(r.x-t.interaction.marqueeStart.x),height:Math.abs(r.y-t.interaction.marqueeStart.y)};if(t.mpe.enabled){const o=Th(t);if(o){const a=dm(t,o,s);Nn(t,a),qi(t)}}else{const o=Y2(t,s);Vr(t,()=>{t.selection.selectedIds.clear();const a=o[0];a&&t.selection.selectedIds.add(a)}),t.needsRedraw=!0}}}}),e.on("mouseup touchend",i=>{if(t.interaction.isDragging){xm(t);return}if(t.interaction.isResizing){km(t);return}if(t.interaction.isMarqueeSelecting){const r=t.interaction.marqueeStart&&t.interaction.marqueeCurrent&&Math.abs(t.interaction.marqueeStart.x-t.interaction.marqueeCurrent.x)<5&&Math.abs(t.interaction.marqueeStart.y-t.interaction.marqueeCurrent.y)<5;if(t.interaction.isMarqueeSelecting=!1,t.selection.selectionRect&&(t.selection.selectionRect.visible(!1),t.layers.overlay?.batchDraw()),r&&i.target===e||i.target.getLayer()===n){const s=e.getPointerPosition();if(s){const{position:o}=_h(s,t),a=vh(o,t.grid.subdivision);t.queuePlayhead.position=Math.max(0,Math.min(a,t.grid.maxLength)),t.needsRedraw=!0,t.notifyExternalChange?.("playhead")}}}})}function Sm(t,e){const n=e.getPointerPosition();n&&(t.interaction.isDragging=!0,t.interaction.dragStartPos=n,t.interaction.quantDragActivated=!1,t.interaction.dragBeforeState=gn(t),t.interaction.draggedNoteInitialStates.clear(),t.selection.selectedIds.forEach(i=>{const r=t.notes.get(i);r&&t.interaction.draggedNoteInitialStates.set(i,{position:r.position,pitch:r.pitch})}))}function wm(t,e){const n=e.getPointerPosition();if(!n||!t.interaction.dragStartPos)return;const i=n.x-t.interaction.dragStartPos.x,r=n.y-t.interaction.dragStartPos.y,s=bh(t);let o;Math.abs(i)<s*.9&&!t.interaction.quantDragActivated?o=i:(o=Math.round(i/s)*s,t.interaction.quantDragActivated=!0);const a=Math.round(r/t.grid.noteHeight);t.interaction.draggedNoteInitialStates.forEach((l,c)=>{const h=t.notes.get(c);h&&(h.position=l.position+o/t.grid.quarterNoteWidth,h.pitch=Math.max(0,Math.min(127,l.pitch-a)))}),Q2(t),wh(t),t.needsRedraw=!0}function xm(t){lo(t);const e=gn(t);t.interaction.dragBeforeState&&t.interaction.dragBeforeState!==e&&t.command.stack?.pushCommand("Move Notes",t.interaction.dragBeforeState,e),t.interaction.isDragging=!1,xh(t),t.needsRedraw=!0}function Cm(t,e,n,i){const r=e.getPointerPosition();r&&(t.interaction.isResizing=!0,t.interaction.resizeTargetId=n,t.interaction.resizeIsEnd=i,t.interaction.quantResizeActivated=!1,t.interaction.dragStartPos=r,t.interaction.resizeBeforeState=gn(t),t.interaction.resizeInitialStates.clear(),t.selection.selectedIds.forEach(s=>{const o=t.notes.get(s);o&&t.interaction.resizeInitialStates.set(s,{position:o.position,duration:o.duration})}))}function Pm(t,e){const n=e.getPointerPosition();if(!n||!t.interaction.dragStartPos)return;const i=n.x-t.interaction.dragStartPos.x,r=bh(t);let s;Math.abs(i)<r*.9&&!t.interaction.quantResizeActivated?s=i:(s=Math.round(i/r)*r,t.interaction.quantResizeActivated=!0);const o=s/t.grid.quarterNoteWidth;t.interaction.resizeInitialStates.forEach((a,l)=>{const c=t.notes.get(l);c&&(t.interaction.resizeIsEnd?c.duration=Math.max(.25,a.duration+o):(c.position=a.position+o,c.duration=Math.max(.25,a.duration-o)))}),wh(t),t.needsRedraw=!0}function km(t){lo(t);const e=gn(t);t.interaction.resizeBeforeState&&t.interaction.resizeBeforeState!==e&&t.command.stack?.pushCommand("Resize Notes",t.interaction.resizeBeforeState,e),t.interaction.isResizing=!1,xh(t),t.needsRedraw=!0}const On=.25,Fn=1,ie=128,Nh=4,Ih=12,Em=55,Rt=(t,e,n)=>n<e?e:Math.min(Math.max(t,e),n),Dn=(t,e)=>t.stage?.width()??e,zn=(t,e)=>t.stage?.height()??e,Tm=t=>t.grid.maxLength*t.grid.quarterNoteWidth,Rm=t=>ie*t.grid.noteHeight,Am=(t,e)=>{t.grid.quarterNoteWidth=e,t.viewport.zoomX=e/t.grid.baseQuarterNoteWidth},Mm=(t,e)=>{t.grid.noteHeight=e,t.viewport.zoomY=e/t.grid.baseNoteHeight},Nm=(t,e)=>{const n=t.grid.quarterNoteWidth,i=Dn(t,e),r=n===0?0:t.viewport.scrollX/n,s=r+i/(n||1);return{startQuarter:r,endQuarter:s}},Im=(t,e)=>{const n=t.grid.noteHeight,i=zn(t,e),r=n===0?0:t.viewport.scrollY/n,s=r+i/(n||1);return{topIndex:r,bottomIndex:s}},ho=(t,e,n,i)=>{const r=Dn(t,e),s=zn(t,n),o=Math.max(0,Tm(t)-r),a=Rt(t.viewport.scrollX,0,o);a!==t.viewport.scrollX&&(t.viewport.scrollX=a,t.needsRedraw=!0,i());const l=Math.max(0,Rm(t)-s),c=Rt(t.viewport.scrollY,0,l);c!==t.viewport.scrollY&&(t.viewport.scrollY=c,t.needsRedraw=!0,i())},uo=(t,e,n,i,r,s)=>{if(!Number.isFinite(e)||e<=0)return;Am(t,e);const a=Dn(t,i)/t.grid.quarterNoteWidth,l=Math.max(0,t.grid.maxLength-a),c=Rt(n,0,l);t.viewport.scrollX=c*t.grid.quarterNoteWidth,ho(t,i,r,s),t.needsRedraw=!0,s()},fo=(t,e,n,i,r,s)=>{if(!Number.isFinite(e)||e<=0)return;Mm(t,e);const a=zn(t,r)/t.grid.noteHeight,l=Math.max(0,ie-a),c=Rt(n,0,l);t.viewport.scrollY=c*t.grid.noteHeight,ho(t,i,r,s),t.needsRedraw=!0,s()},Om=(t,e,n,i)=>{const r=Dn(t,e),s=zn(t,n);if(r<=0||s<=0)return;const o=Array.from(t.notes.values());if(o.length===0){const D=r/Nh;uo(t,D,0,e,n,i);const G=Ih,U=s/G,z=127-Em,q=Math.max(0,ie-G),y=Rt(z-(G-1),0,q);fo(t,U,y,e,n,i);return}const a=o.reduce((N,D)=>Math.min(N,D.position),Number.POSITIVE_INFINITY),l=o.reduce((N,D)=>Math.max(N,D.position+D.duration),Number.NEGATIVE_INFINITY),c=Math.max(l-a,0),h=Math.max(c,Nh),p=r/h,f=Math.max(0,t.grid.maxLength-h),d=Math.max(h-c,0),g=a-d/2,v=Rt(g,0,f);uo(t,p,v,e,n,i);const w=o.reduce((N,D)=>Math.max(N,D.pitch),Number.NEGATIVE_INFINITY),x=o.reduce((N,D)=>Math.min(N,D.pitch),Number.POSITIVE_INFINITY),m=127-w,u=127-x,_=Math.max(u-m+1,1),S=Math.max(_,Ih),P=s/S,I=Math.max(S-_,0),b=m-I/2,C=Math.max(0,ie-S),E=Rt(b,0,C);fo(t,P,E,e,n,i)};class Fm{constructor(e){this.options=e}dragState=null;getThumbMetrics=()=>{const e=this.options.state.grid.maxLength;if(e<=0)return{start:0,size:1};const n=this.options.state.grid.quarterNoteWidth,i=Dn(this.options.state,this.options.getFallbackWidth());if(n<=0||i<=0)return{start:0,size:1};const r=this.options.state.viewport.scrollX/n,s=i/n,o=Math.min(1,s/e);if(o>=1)return{start:0,size:1};const a=r/e;return{start:Rt(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:e,size:n}=this.getThumbMetrics(),i=Rt(n,0,1),r=Math.min(1,Math.max(i,.01));return{left:`${Rt(e,0,1-r)*100}%`,width:`${r*100}%`}};startDrag=(e,n)=>{if(!this.options.isInteractive())return;const i=this.options.horizontalTrack.value;if(!i)return;this.stopDrag();const r=i.getBoundingClientRect();if(r.width<=0)return;const{startQuarter:s,endQuarter:o}=this.options.getViewportRange(),a=Math.max(On,o-s),l=Dn(this.options.state,this.options.getFallbackWidth()),c=this.options.state.grid.maxLength;if(l<=0||c<=0)return;const h=s/c,p=o/c;let f=0;e==="resize-start"?f=n.clientX-(r.left+h*r.width):e==="resize-end"&&(f=n.clientX-(r.left+p*r.width)),this.dragState={mode:e,pointerId:n.pointerId,pointerStart:n.clientX,trackRect:r,startQuarter:s,endQuarter:o,anchorQuarter:e==="resize-start"?o:s,spanQuarter:a,stageWidth:l,pointerOffset:f},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),n.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=e=>{const n=this.dragState;if(!n||e.pointerId!==n.pointerId)return;const i=this.options.state.grid.maxLength,r=n.trackRect;if(i<=0||r.width<=0||n.stageWidth<=0)return;if(e.preventDefault(),n.mode==="move"){const c=(e.clientX-n.pointerStart)/r.width*i,h=Math.max(0,i-n.spanQuarter),p=Rt(n.startQuarter+c,0,h);this.options.state.viewport.scrollX=p*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const s=Rt(e.clientX,r.left,r.right),a=(Rt(s-n.pointerOffset,r.left,r.right)-r.left)/r.width;if(n.mode==="resize-start"){let l=a*i;const c=n.anchorQuarter-On;l=Rt(l,0,Math.max(0,c));const h=Math.max(On,n.anchorQuarter-l),p=n.stageWidth/h;this.options.applyHorizontalZoom(p,l),n.startQuarter=l,n.spanQuarter=h;return}if(n.mode==="resize-end"){let l=a*i;const c=n.anchorQuarter+On;l=Rt(l,Math.min(c,i),i);const h=Math.max(On,l-n.anchorQuarter),p=n.stageWidth/h;this.options.applyHorizontalZoom(p,n.anchorQuarter),n.endQuarter=l,n.spanQuarter=h}};onTrackPointerDown=e=>{if(!this.options.isInteractive())return;const n=this.options.horizontalTrack.value;if(!n)return;const i=n.getBoundingClientRect();if(i.width<=0)return;const r=Rt((e.clientX-i.left)/i.width,0,1),{startQuarter:s,endQuarter:o}=this.options.getViewportRange(),a=Math.max(On,o-s),l=this.options.state.grid.maxLength,c=Math.max(0,l-a),h=Rt(r*l-a/2,0,c);this.options.state.viewport.scrollX=h*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}class Dm{constructor(e){this.options=e}dragState=null;getThumbMetrics=()=>{const e=ie,n=this.options.state.grid.noteHeight,i=zn(this.options.state,this.options.getFallbackHeight());if(n<=0||i<=0)return{start:0,size:1};const r=this.options.state.viewport.scrollY/n,s=i/n,o=Math.min(1,s/e);if(o>=1)return{start:0,size:1};const a=r/e;return{start:Rt(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:e,size:n}=this.getThumbMetrics(),i=Rt(n,0,1),r=Math.min(1,Math.max(i,.01));return{top:`${Rt(e,0,1-r)*100}%`,height:`${r*100}%`}};startDrag=(e,n)=>{if(!this.options.isInteractive())return;const i=this.options.verticalTrack.value;if(!i)return;this.stopDrag();const r=i.getBoundingClientRect();if(r.height<=0)return;const{topIndex:s,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(Fn,o-s),l=zn(this.options.state,this.options.getFallbackHeight());if(l<=0)return;const c=s/ie,h=o/ie;let p=0;e==="resize-start"?p=n.clientY-(r.top+c*r.height):e==="resize-end"&&(p=n.clientY-(r.top+h*r.height)),this.dragState={mode:e,pointerId:n.pointerId,pointerStart:n.clientY,trackRect:r,topIndex:s,bottomIndex:o,anchorIndex:e==="resize-start"?o:s,span:a,stageHeight:l,pointerOffset:p},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),n.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=e=>{const n=this.dragState;if(!n||e.pointerId!==n.pointerId)return;const i=n.trackRect;if(i.height<=0||n.stageHeight<=0)return;if(e.preventDefault(),n.mode==="move"){const l=(e.clientY-n.pointerStart)/i.height*ie,c=Math.max(0,ie-n.span),h=Rt(n.topIndex+l,0,c);this.options.state.viewport.scrollY=h*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const r=Rt(e.clientY,i.top,i.bottom),o=(Rt(r-n.pointerOffset,i.top,i.bottom)-i.top)/i.height;if(n.mode==="resize-start"){let a=o*ie;const l=n.anchorIndex-Fn;a=Rt(a,0,Math.max(0,l));const c=Math.max(Fn,n.anchorIndex-a),h=n.stageHeight/c;this.options.applyVerticalZoom(h,a),n.topIndex=a,n.span=c;return}if(n.mode==="resize-end"){let a=o*ie;const l=n.anchorIndex+Fn;a=Rt(a,Math.min(l,ie),ie);const c=Math.max(Fn,a-n.anchorIndex),h=n.stageHeight/c;this.options.applyVerticalZoom(h,n.anchorIndex),n.bottomIndex=a,n.span=c}};onTrackPointerDown=e=>{if(!this.options.isInteractive())return;const n=this.options.verticalTrack.value;if(!n)return;const i=n.getBoundingClientRect();if(i.height<=0)return;const r=Rt((e.clientY-i.top)/i.height,0,1),{topIndex:s,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(Fn,o-s),l=Math.max(0,ie-a),c=Rt(r*ie-a/2,0,l);this.options.state.viewport.scrollY=c*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}const zm=({state:t,canUndo:e,canRedo:n,emitStateUpdate:i})=>{const r=()=>{e.value=t.command.stack?.canUndo()??!1,n.value=t.command.stack?.canRedo()??!1};return{undo:()=>{t.command.stack?.undo(),r()},redo:()=>{t.command.stack?.redo(),r()},deleteSelected:()=>{t.selection.selectedIds.size!==0&&(t.command.stack?.executeCommand("Delete Selected",()=>{t.selection.selectedIds.forEach(c=>t.notes.delete(c)),t.selection.selectedIds.clear(),t.needsRedraw=!0}),r())},updateCommandStackButtons:r,handleCommandStackUpdate:()=>{r(),i()}}},Lm=({state:t,isInteractive:e,undo:n,redo:i,deleteSelected:r,updateCommandStackButtons:s,executeOverlapChanges:o,getContainer:a})=>{let l=!1;const c=()=>{if(!t.mpe.enabled||t.selection.selectedIds.size!==1||t.mpe.selectedHandles.size===0)return!1;const d=Array.from(t.selection.selectedIds)[0],g=Array.from(t.mpe.selectedHandles).sort((w,x)=>x-w);return t.notes.get(d)?.mpePitch?(t.command.stack?.executeCommand("Delete MPE Pitch Points",()=>{const w=t.notes.get(d);if(!w?.mpePitch)return;const x=[...w.mpePitch.points];g.forEach(m=>{m>=0&&m<x.length&&x.splice(m,1)}),w.mpePitch={points:x},t.mpe.selectedHandles=new Set,t.needsRedraw=!0,t.notifyExternalChange?.("selection")}),s(),!0):!1},h=d=>{if(e()){if((d.metaKey||d.ctrlKey)&&d.key==="z"&&!d.shiftKey){d.preventDefault(),n();return}if((d.metaKey||d.ctrlKey)&&d.key==="z"&&d.shiftKey){d.preventDefault(),i();return}if(d.key==="Backspace"||d.key==="Delete"){if(d.preventDefault(),t.mpe.enabled){c();return}r();return}if(d.key.startsWith("Arrow")&&t.selection.selectedIds.size>0){d.preventDefault(),t.command.stack?.executeCommand("Move Selection",()=>{t.selection.selectedIds.forEach(g=>{const v=t.notes.get(g);if(v)switch(d.key){case"ArrowUp":v.pitch=Math.min(127,v.pitch+1);break;case"ArrowDown":v.pitch=Math.max(0,v.pitch-1);break;case"ArrowLeft":v.position=Math.max(0,v.position-.25);break;case"ArrowRight":v.position+=.25;break}}),o(t,t.selection.selectedIds),t.needsRedraw=!0}),s();return}if((d.metaKey||d.ctrlKey)&&d.key==="c"&&t.selection.selectedIds.size>0){d.preventDefault();const g=Array.from(t.selection.selectedIds).map(w=>{const x=t.notes.get(w);return x?{...x}:null}).filter(w=>w!==null);if(g.length===0)return;const v=Math.min(...g.map(w=>w.position));sessionStorage.setItem("copiedPianoRollNotes",JSON.stringify({notes:g.map(w=>({...w,position:w.position-v}))}));return}if((d.metaKey||d.ctrlKey)&&d.key==="v"){d.preventDefault();const g=sessionStorage.getItem("copiedPianoRollNotes");if(!g)return;try{const{notes:v}=JSON.parse(g);t.command.stack?.executeCommand("Paste Notes",()=>{t.selection.selectedIds.clear(),v.forEach(w=>{const x={...w,id:`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,position:t.queuePlayhead.position+w.position};t.notes.set(x.id,x),t.selection.selectedIds.add(x.id)}),o(t,t.selection.selectedIds),t.needsRedraw=!0}),s()}catch(v){console.error("Failed to paste notes",v)}}}};return{attach:()=>{if(l)return;const d=a();d&&(d.setAttribute("tabindex","0"),d.addEventListener("keydown",h),l=!0)},detach:()=>{if(!l)return;const d=a();d&&d.removeEventListener("keydown",h),l=!1},isAttached:()=>l}};class Gm{constructor(e){this.deps=e}eventHandlersInitialized=!1;keyboardAttached=!1;renderFrame=()=>{this.deps.state.needsRedraw&&(this.deps.renderGrid(this.deps.state),this.deps.renderVisibleNotes(this.deps.state),this.deps.renderResizeHandles(this.deps.state),this.deps.updateQueuePlayheadPosition(this.deps.state),this.deps.updateLivePlayheadPosition(this.deps.state),this.deps.state.needsRedraw=!1),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)};startRenderLoop(){this.stopRenderLoop(),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)}stopRenderLoop(){this.deps.state.rafHandle&&(cancelAnimationFrame(this.deps.state.rafHandle),this.deps.state.rafHandle=void 0)}enableInteractivity(){this.deps.state.stage&&(this.eventHandlersInitialized||(this.deps.setupEventHandlers(this.deps.state,this.deps.state.stage),this.eventHandlersInitialized=!0),this.deps.state.stage.listening(!0),this.keyboardAttached||(this.deps.attachKeyboard(),this.keyboardAttached=!0))}disableInteractivity(){this.deps.state.stage&&(this.deps.state.stage.listening(!1),this.deps.state.interaction.isDragging=!1,this.deps.state.interaction.isResizing=!1,this.deps.state.interaction.isMarqueeSelecting=!1,this.deps.state.selection.selectionRect?.visible(!1),this.keyboardAttached&&(this.deps.detachKeyboard(),this.keyboardAttached=!1),this.deps.state.layers.overlay?.batchDraw(),this.deps.syncUiCounters())}mount({width:e,height:n,interactive:i,initialNotes:r}){if(!this.deps.konvaContainer.value){console.error("Konva container ref not found");return}const s=new Bt.Stage({container:this.deps.konvaContainer.value,width:e,height:n});this.deps.state.stage=s,this.deps.state.konvaContainer=this.deps.konvaContainer.value,this.deps.initializeLayers(this.deps.state,s,this.deps.handleCommandStackUpdate),i?this.enableInteractivity():this.disableInteractivity(),r.length>0&&(this.deps.state.notes=new Map(r),this.deps.state.needsRedraw=!0,this.deps.syncUiCounters()),this.startRenderLoop(),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds(),this.deps.handleCommandStackUpdate()}unmount(){this.stopRenderLoop(),this.disableInteractivity(),this.deps.state.stage?.destroy(),this.deps.state.stage=void 0,this.deps.state.konvaContainer=void 0,this.eventHandlersInitialized=!1}setInteractive(e){this.deps.state.stage&&(e?this.enableInteractivity():this.disableInteractivity())}resize(e,n){this.deps.state.stage&&(this.deps.state.stage.width(e),this.deps.state.stage.height(n),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds())}}const Um={key:0,class:"metadata-editor"},Hm={class:"header"},Bm={key:0,class:"unsaved-indicator"},Vm={class:"rooted-label"},$m=["disabled"],Wm={key:0,class:"rooted-mixed-text"},jm={key:1,class:"rooted-state-text"},Zm={key:2,class:"rooted-empty-text"},qm={key:1},Km={class:"help"},Ym={class:"buttons"},Xm=["disabled"],Qm=["disabled"],Jm={key:2,class:"warning"},t5=_s({__name:"NoteMetadataEditor",props:{metadata:{type:null},visible:{type:Boolean},canEdit:{type:Boolean},helpText:{type:String},emptyText:{type:String},showRooted:{type:Boolean},rootedValue:{type:[Boolean,null]},canEditRooted:{type:Boolean},rootedLabel:{type:String},rootedMixedText:{type:String}},emits:["apply","cancel","setRooted"],setup(t,{emit:e}){const n=t,i=e,r=Ut(""),s=Ut(""),o=Nt(()=>r.value!==s.value);Fe(()=>[n.metadata,n.canEdit],([h,p])=>{if(p){const f=JSON.stringify(h??{},null,2);r.value=f,s.value=f}else r.value="",s.value=""},{immediate:!0,deep:!0});const a=()=>{try{const h=JSON.parse(r.value||"{}");i("apply",h),s.value=r.value}catch{alert("Invalid JSON format")}},l=()=>{r.value=s.value,i("cancel")},c=()=>{if(n.canEditRooted){if(n.rootedValue===null){i("setRooted",!0);return}i("setRooted",!n.rootedValue)}};return(h,p)=>h.visible?(re(),de("div",Um,[mt("div",Hm,[o.value?(re(),de("div",Bm,p[1]||(p[1]=[mt("span",{class:"dot"},null,-1),Ts(" Unsaved changes ")]))):ln("",!0)]),h.showRooted?(re(),de("div",{key:0,class:be(["rooted-row",{disabled:!h.canEditRooted}])},[mt("span",Vm,Ve(h.rootedLabel??"Rooted"),1),mt("button",{type:"button",class:be(["rooted-toggle",{on:h.rootedValue===!0,mixed:h.rootedValue===null,off:h.rootedValue===!1}]),disabled:!h.canEditRooted,onClick:c},p[2]||(p[2]=[mt("span",{class:"rooted-icon"},null,-1)]),10,$m),h.canEditRooted&&h.rootedValue===null?(re(),de("span",Wm,Ve(h.rootedMixedText??"multiple values"),1)):h.canEditRooted&&h.rootedValue!==null?(re(),de("span",jm,Ve(h.rootedValue?"true":"false"),1)):(re(),de("span",Zm,"Select MPE points to edit rooted."))],2)):ln("",!0),h.canEdit?(re(),de("div",qm,[mt("p",Km,Ve(h.helpText??"Edit the selected note metadata as JSON:"),1),aa(mt("textarea",{"onUpdate:modelValue":p[0]||(p[0]=f=>r.value=f),class:"textarea",placeholder:"{}"},null,512),[[Sf,r.value]]),mt("div",Ym,[mt("button",{onClick:a,class:"btn save",disabled:!o.value}," Save ",8,Xm),mt("button",{onClick:l,class:"btn cancel",disabled:!o.value}," Cancel ",8,Qm)])])):(re(),de("div",Jm,[mt("p",null,Ve(h.emptyText??"Select exactly one note to edit its metadata."),1)]))])):ln("",!0)}}),e5='.metadata-editor[data-v-5415610b]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:6px 16px;margin-top:8px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-5415610b]{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}.unsaved-indicator[data-v-5415610b]{display:flex;align-items:center;gap:6px;font-size:13px;color:#f39c12;font-weight:500}.dot[data-v-5415610b]{width:6px;height:6px;background:#f39c12;border-radius:50%;animation:pulse-5415610b 1.5s infinite}@keyframes pulse-5415610b{0%,to{opacity:1}50%{opacity:.5}}.help[data-v-5415610b]{margin:0 0 4px;color:#666;font-size:14px}.rooted-row[data-v-5415610b]{display:flex;align-items:center;gap:8px;margin-bottom:8px;font-size:14px}.rooted-row.disabled[data-v-5415610b]{opacity:.6}.rooted-label[data-v-5415610b]{font-weight:600;color:#333}.rooted-toggle[data-v-5415610b]{width:26px;height:18px;border:1px solid #bbb;border-radius:4px;background:#f7f7f7;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;padding:0;position:relative}.rooted-toggle[data-v-5415610b]:disabled{cursor:not-allowed}.rooted-toggle.on[data-v-5415610b]{background:#e6f3ff;border-color:#6aa8ff}.rooted-toggle.off[data-v-5415610b]{background:#f7f7f7}.rooted-icon[data-v-5415610b]{width:12px;height:12px;border:2px solid #555;box-sizing:border-box}.rooted-toggle.on .rooted-icon[data-v-5415610b]{background:#6aa8ff;border-color:#2f6fd8}.rooted-toggle.mixed .rooted-icon[data-v-5415610b]{position:relative}.rooted-toggle.mixed .rooted-icon[data-v-5415610b]:after{content:"";position:absolute;top:50%;left:-2px;right:-2px;height:2px;background:#555;transform:rotate(-20deg)}.rooted-mixed-text[data-v-5415610b]{color:#a05a00;font-weight:600}.rooted-state-text[data-v-5415610b]{color:#444}.rooted-empty-text[data-v-5415610b]{color:#888;font-size:13px}.textarea[data-v-5415610b]{width:100%;min-height:120px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:14px;line-height:1.3;resize:vertical;margin-bottom:4px}.textarea[data-v-5415610b]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 2px #0066ff26}.buttons[data-v-5415610b]{display:flex;gap:8px}.btn[data-v-5415610b]{padding:4px 12px;border:1px solid;border-radius:4px;cursor:pointer;font-size:14px;transition:all .2s}.btn[data-v-5415610b]:disabled{opacity:.5;cursor:not-allowed}.save[data-v-5415610b]{background:#28a745;color:#fff;border-color:#28a745}.save[data-v-5415610b]:hover:not(:disabled){background:#218838}.cancel[data-v-5415610b]{background:#6c757d;color:#fff;border-color:#6c757d}.cancel[data-v-5415610b]:hover:not(:disabled){background:#5a6268}.warning[data-v-5415610b]{text-align:center;color:#e67e22;padding:8px}',Oh=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},Fh=Oh(t5,[["styles",[e5]],["__scopeId","data-v-5415610b"]]),n5={class:"piano-roll-root"},i5={key:0,class:"control-panel"},r5=["disabled"],s5=["disabled"],o5=["disabled"],a5=["disabled"],l5=["disabled"],c5={key:0,class:"separator"},h5={class:"info"},u5={class:"piano-roll-layout"},d5={class:"stage-wrapper"},f5={key:1,class:"metadata-editor-wrapper"},Dh=1/3,zh=1,Lh=12,g5=Oh(_s({__name:"PianoRollRoot",props:{width:{default:640,type:Number},height:{default:360,type:Number},initialNotes:{default:()=>[],type:Array},syncState:{type:Function},showControlPanel:{type:Boolean,default:!0},interactive:{type:Boolean,default:!0},wsAddress:{type:String}},emits:["notes-update"],setup(t,{expose:e,emit:n}){const i=t,r=en({width:void 0,height:void 0,interactive:void 0,showControlPanel:void 0}),s=Nt(()=>r.width??i.width),o=Nt(()=>r.height??i.height),a=Nt(()=>r.interactive??i.interactive),l=Nt(()=>r.showControlPanel??i.showControlPanel),c=Nt(()=>s.value),h=Nt(()=>o.value),p=Ut(),f=Ut(null);let d=null;const g=Nt(()=>Lh+zh),v=Nt(()=>Number.isFinite(f.value??NaN)?Math.max(0,f.value-g.value):null),w=Nt(()=>{const at=c.value;if(!Number.isFinite(at)||at<=0)return 1;const gt=(v.value??at)/at;return Number.isFinite(gt)?Math.min(1,Math.max(Dh,gt)):1}),x=Nt(()=>Math.round(c.value*w.value)),m=Nt(()=>Math.round(h.value*w.value)),u=Nt(()=>Math.round(c.value*Dh)),_=Nt(()=>Math.round(c.value+g.value)),S=Nt(()=>Math.round(u.value+g.value)),P=Mu(null),I=n,b=_0();b.viewport=en(b.viewport),b.grid=en(b.grid),b.mpe=en(b.mpe);const C=Ut(),E=Ut(),N=Ut(),D=Ut(!1),G=Ut(!1),U=Ut(b.grid.subdivision),z=Ut(!1),q=Ut(!1),y=Ut(null),k=Ut(null),M=Ut(null),R=Ut([]),F=Ut(null),$=Ut(null),L=Ut(!1),Y=Ut(b.notes.size),X=Ut(b.selection.selectedIds.size),H=Nt(()=>a.value),A=Nt(()=>l.value),B=Nt(()=>y.value!==null&&H.value),et=Nt(()=>A.value&&z.value),st=Nt(()=>M.value!==null&&H.value&&b.mpe.enabled),ct=Nt(()=>R.value.length>0&&H.value&&b.mpe.enabled),T=Nt(()=>A.value&&q.value),O=at=>{if(at==null)return{};try{return JSON.parse(JSON.stringify(at))}catch{return at}},V=()=>{if(Y.value=b.notes.size,X.value=b.selection.selectedIds.size,b.selection.selectedIds.size===1){const[at]=Array.from(b.selection.selectedIds),rt=b.notes.get(at);y.value=rt?.id??null,k.value=rt?O(rt.metadata):{}}else y.value=null,k.value=null;if(b.mpe.enabled&&b.selection.selectedIds.size===1&&b.mpe.selectedHandles.size>0){const[at]=Array.from(b.selection.selectedIds),rt=b.notes.get(at),gt=Array.from(b.mpe.selectedHandles).sort((kt,Yt)=>kt-Yt);if(R.value=gt,gt.length===1){const kt=gt[0],Yt=rt?.mpePitch?.points?.[kt??-1];Yt?(M.value=kt??null,F.value=O(Yt.metadata)):(M.value=null,F.value=null)}else M.value=null,F.value=null;if(rt?.mpePitch?.points){const kt=gt.map(Yt=>!!rt.mpePitch.points[Yt]?.rooted);if(kt.length>0){const Yt=kt.every(Zt=>Zt===kt[0]);$.value=Yt?kt[0]:null}else $.value=null}else $.value=null}else M.value=null,R.value=[],F.value=null,$.value=null},W=()=>{i.syncState?.(b)},K=()=>{C.value?.focus()},j=()=>{Om(b,x.value,m.value,W)},J=()=>{ho(b,x.value,m.value,W)},nt=(at,rt)=>{uo(b,at,rt,x.value,m.value,W)},tt=(at,rt)=>{fo(b,at,rt,x.value,m.value,W)},Q=()=>Nm(b,x.value),ot=()=>Im(b,m.value),it=new Fm({state:b,horizontalTrack:E,isInteractive:()=>a.value,getViewportRange:Q,applyHorizontalZoom:nt,enforceScrollBounds:J,notifyViewportChange:W,getFallbackWidth:()=>x.value}),lt=new Dm({state:b,verticalTrack:N,isInteractive:()=>a.value,getViewportRange:ot,applyVerticalZoom:tt,enforceScrollBounds:J,notifyViewportChange:W,getFallbackHeight:()=>m.value}),ut=Nt(()=>it.getThumbStyle()),dt=Nt(()=>lt.getThumbStyle()),vt=(at,rt)=>{it.startDrag(at,rt)},_t=()=>{it.stopDrag()},Pt=(at,rt)=>{lt.startDrag(at,rt)},xt=()=>{lt.stopDrag()},At=at=>{it.onTrackPointerDown(at)},jt=at=>{lt.onTrackPointerDown(at)};Fe(U,at=>{b.grid.subdivision=at,b.needsRedraw=!0,i.syncState?.(b)}),Fe(L,at=>{b.mpe.enabled=at,at&&(b.selection.selectedIds.clear(),b.mpe.selectedHandles=new Set),at||(b.mpe.selectedHandles=new Set,q.value=!1),b.needsRedraw=!0,i.syncState?.(b),V()});const _e=(at={})=>{const rt=at.source??"notes";V();const gt=Array.from(b.notes.entries());I("notes-update",gt),i.syncState?.(b),P.value?.isConnected&&(!at.suppressWsNotes&&rt==="notes"&&P.value.sendNotesUpdate(gt,rt),P.value.sendStateUpdate(b,rt))};Fe(A,at=>{at||(z.value=!1,q.value=!1)});const He=at=>{if(!y.value)return;const rt=y.value,gt=b.notes.get(rt);if(!gt)return;const kt=at??{},Yt=gt.metadata??{};JSON.stringify(Yt)!==JSON.stringify(kt)&&b.command.stack?.executeCommand("Edit Note Metadata",()=>{const Zt=b.notes.get(rt);if(!Zt)return;const Je=kt&&Object.keys(kt).length===0?void 0:kt,Gn={...Zt,metadata:Je};Je||delete Gn.metadata,b.notes.set(rt,Gn),b.needsRedraw=!0})},Kt=at=>{if(!y.value||M.value===null)return;const rt=y.value,gt=M.value,kt=b.notes.get(rt),Yt=kt?.mpePitch?.points?.[gt];if(!kt||!Yt)return;const Zt=at??{},Je=Yt.metadata??{};JSON.stringify(Je)!==JSON.stringify(Zt)&&b.command.stack?.executeCommand("Edit MPE Point Metadata",()=>{const Gn=b.notes.get(rt);if(!Gn?.mpePitch)return;const Wh=Zt&&Object.keys(Zt).length===0?void 0:Zt,_5=Gn.mpePitch.points.map((jh,v5)=>{if(v5!==gt)return jh;const mo={...jh};return Wh?mo.metadata=Wh:delete mo.metadata,mo});Gn.mpePitch={points:_5},b.needsRedraw=!0})},ae=at=>{if(!y.value||R.value.length===0)return;const rt=y.value,gt=R.value;b.command.stack?.executeCommand("Set MPE Point Rooted",()=>{const kt=b.notes.get(rt);if(!kt?.mpePitch)return;const Yt=kt.mpePitch.points.map((Zt,Je)=>gt.includes(Je)?{...Zt,rooted:at}:Zt);kt.mpePitch={points:Yt},b.needsRedraw=!0})};b.notifyExternalChange=at=>{_e({source:at??"other"})};const{undo:Ln,redo:go,deleteSelected:po,updateCommandStackButtons:p5,handleCommandStackUpdate:m5}=zm({state:b,canUndo:D,canRedo:G,emitStateUpdate:_e}),Hh=Lm({state:b,isInteractive:()=>a.value,undo:Ln,redo:go,deleteSelected:po,updateCommandStackButtons:p5,executeOverlapChanges:lo,getContainer:()=>C.value??null}),Wr=new Gm({state:b,konvaContainer:C,initializeLayers:lm,setupEventHandlers:ym,renderGrid:cm,renderVisibleNotes:hm,renderResizeHandles:mm,updateQueuePlayheadPosition:vm,updateLivePlayheadPosition:bm,handleCommandStackUpdate:m5,syncUiCounters:V,enforceScrollBounds:J,attachKeyboard:()=>Hh.attach(),detachKeyboard:()=>Hh.detach()});ua(()=>{p.value&&(d=new ResizeObserver(at=>{const rt=at[0];if(!rt)return;const kt=(Array.isArray(rt.contentBoxSize)?rt.contentBoxSize[0]:rt.contentBoxSize)?.inlineSize??rt.contentRect.width;Number.isFinite(kt)&&(f.value=kt)}),d.observe(p.value)),Wr.mount({width:x.value,height:m.value,interactive:a.value,initialNotes:i.initialNotes??[]}),i.wsAddress&&(P.value=new q2(i.wsAddress),P.value.setHandlers({onSetNotes:at=>Bh(at,{suppressWsNotes:!0}),onSetLivePlayhead:at=>Vh(at),onFitZoomToNotes:()=>j(),onGetPlayStartPosition:at=>{const rt=$h();P.value?.sendPlayStartPositionResponse(rt,at)},onSetConfig:at=>{at.width!==void 0&&(r.width=at.width),at.height!==void 0&&(r.height=at.height),at.interactive!==void 0&&(r.interactive=at.interactive),at.showControlPanel!==void 0&&(r.showControlPanel=at.showControlPanel)}}),P.value.connect())}),bs(()=>{_t(),xt(),Wr.unmount(),P.value?.disconnect(),d?.disconnect(),d=null}),Fe(a,at=>{Wr.setInteractive(at),at||(_t(),xt())}),Fe([x,m],([at,rt])=>{Wr.resize(at,rt)});const Bh=(at,rt={})=>{const gt=new Set;b.notes.clear(),at.forEach((kt,Yt)=>{let Zt=kt.id||`note_${Date.now()}_${Yt}`;for(;gt.has(Zt);)Zt=`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;gt.add(Zt);const Je={...kt,id:Zt,velocity:kt.velocity??100};b.notes.set(Zt,Je)}),b.needsRedraw=!0,_e({...rt,source:"notes"})},Vh=at=>{b.livePlayhead.position=Math.max(0,Math.min(at,b.grid.maxLength)),b.needsRedraw=!0},$h=()=>b.queuePlayhead.position;return e({setNotes:Bh,setLivePlayheadPosition:Vh,getPlayStartPosition:$h,fitZoomToNotes:j}),(at,rt)=>(re(),de("div",n5,[mt("div",{ref_key:"sizeObserver",ref:p,class:"piano-roll-shell",style:Te({maxWidth:_.value+"px",minWidth:S.value+"px","--scrollbar-thickness":Lh+"px","--scrollbar-gap":zh+"px"})},[A.value?(re(),de("div",i5,[mt("button",{onClick:rt[0]||(rt[0]=(...gt)=>We(Ln)&&We(Ln)(...gt)),disabled:!H.value||!D.value}," Undo",8,r5),mt("button",{onClick:rt[1]||(rt[1]=(...gt)=>We(go)&&We(go)(...gt)),disabled:!H.value||!G.value}," Redo",8,s5),rt[15]||(rt[15]=mt("span",{class:"separator"},"|",-1)),mt("label",null,[rt[14]||(rt[14]=Ts(" Grid: ")),aa(mt("select",{"onUpdate:modelValue":rt[2]||(rt[2]=gt=>U.value=gt),disabled:!H.value},rt[13]||(rt[13]=[mt("option",{value:4},"Quarter",-1),mt("option",{value:8},"Eighth",-1),mt("option",{value:16},"16th",-1),mt("option",{value:32},"32nd",-1)]),8,o5),[[wf,U.value,void 0,{number:!0}]])]),rt[16]||(rt[16]=mt("span",{class:"separator"},"|",-1)),mt("button",{onClick:rt[3]||(rt[3]=(...gt)=>We(po)&&We(po)(...gt)),disabled:!H.value||X.value===0},"  Delete ",8,a5),rt[17]||(rt[17]=mt("span",{class:"separator"},"|",-1)),mt("button",{class:be(["mpe-toggle",{active:L.value}]),disabled:!H.value,onClick:rt[4]||(rt[4]=gt=>L.value=!L.value)}," MPE ",10,l5),rt[18]||(rt[18]=mt("span",{class:"separator"},"|",-1)),mt("button",{class:be(["metadata-toggle",{active:z.value}]),onClick:rt[5]||(rt[5]=gt=>z.value=!z.value)},"  Metadata ",2),L.value?(re(),de("span",c5,"|")):ln("",!0),L.value?(re(),de("button",{key:1,class:be(["mpe-point-toggle",{active:q.value}]),onClick:rt[6]||(rt[6]=gt=>q.value=!q.value)},"  Point Metadata ",2)):ln("",!0),rt[19]||(rt[19]=mt("span",{class:"separator"},"|",-1)),mt("span",h5,Ve(Y.value)+" notes, "+Ve(X.value)+" selected",1)])):ln("",!0),mt("div",u5,[mt("div",d5,[mt("div",{ref_key:"konvaContainer",ref:C,class:be(["piano-roll-container",{"is-disabled":!H.value}]),style:Te({width:x.value+"px",height:m.value+"px"}),tabindex:"0",onPointerdown:K},null,38),mt("div",{ref_key:"horizontalTrack",ref:E,class:be(["scrollbar horizontal",{"is-disabled":!H.value}]),style:Te({width:x.value+"px"}),onPointerdown:qe(At,["self"])},[mt("div",{class:"scrollbar-thumb horizontal-thumb",style:Te(ut.value)},[mt("div",{class:"scrollbar-handle handle-left",onPointerdown:rt[7]||(rt[7]=qe(gt=>vt("resize-start",gt),["stop","prevent"]))},null,32),mt("div",{class:"scrollbar-body",onPointerdown:rt[8]||(rt[8]=qe(gt=>vt("move",gt),["stop","prevent"]))},null,32),mt("div",{class:"scrollbar-handle handle-right",onPointerdown:rt[9]||(rt[9]=qe(gt=>vt("resize-end",gt),["stop","prevent"]))},null,32)],4)],38)]),mt("div",{ref_key:"verticalTrack",ref:N,class:be(["scrollbar vertical",{"is-disabled":!H.value}]),style:Te({height:m.value+"px"}),onPointerdown:qe(jt,["self"])},[mt("div",{class:"scrollbar-thumb vertical-thumb",style:Te(dt.value)},[mt("div",{class:"scrollbar-handle handle-top",onPointerdown:rt[10]||(rt[10]=qe(gt=>Pt("resize-start",gt),["stop","prevent"]))},null,32),mt("div",{class:"scrollbar-body vertical-body",onPointerdown:rt[11]||(rt[11]=qe(gt=>Pt("move",gt),["stop","prevent"]))},null,32),mt("div",{class:"scrollbar-handle handle-bottom",onPointerdown:rt[12]||(rt[12]=qe(gt=>Pt("resize-end",gt),["stop","prevent"]))},null,32)],4)],38)]),A.value?(re(),de("div",f5,[pe(Fh,{visible:et.value,metadata:k.value??void 0,"can-edit":B.value,onApply:He},null,8,["visible","metadata","can-edit"]),pe(Fh,{visible:T.value,metadata:F.value??void 0,"can-edit":st.value,"show-rooted":!0,"rooted-value":$.value,"can-edit-rooted":ct.value,"help-text":"Edit the selected MPE point metadata as JSON:","empty-text":"Select exactly one MPE point to edit its metadata.",onApply:Kt,onSetRooted:ae},null,8,["visible","metadata","can-edit","rooted-value","can-edit-rooted"])])):ln("",!0)],4)]))}}),[["styles",[".piano-roll-root[data-v-6913985b]{display:flex;flex-direction:column;align-items:center;padding:8px 10px}.piano-roll-shell[data-v-6913985b]{width:100%;display:flex;flex-direction:column;align-items:center;gap:10px;margin:0 auto}.control-panel[data-v-6913985b]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:6px 8px;display:flex;align-items:center;flex-wrap:wrap;column-gap:6px;row-gap:6px;align-self:stretch;box-sizing:border-box;justify-content:center;box-shadow:0 2px 10px #0000001a}.control-panel button[data-v-6913985b]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:4px 10px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-6913985b]:hover:not(:disabled){background:#e0e0e0}.control-panel button[data-v-6913985b]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-6913985b]{color:#ccc}.metadata-toggle[data-v-6913985b],.mpe-point-toggle[data-v-6913985b],.mpe-toggle[data-v-6913985b]{display:flex;align-items:center;gap:6px}.metadata-toggle.active[data-v-6913985b]{background:#d6eaff;border-color:#6aa8ff;color:#0b5394}.mpe-point-toggle.active[data-v-6913985b]{background:#f3e7ff;border-color:#b78cff;color:#4b2a7a}.mpe-toggle.active[data-v-6913985b]{background:#ffe7cc;border-color:#ffb14a;color:#8a4b00}.info[data-v-6913985b]{color:#666;font-size:14px}.piano-roll-container[data-v-6913985b]{background-color:#fff;border:1px solid black;cursor:default;box-sizing:border-box;border-radius:8px}.piano-roll-container.is-disabled[data-v-6913985b]{pointer-events:none;cursor:not-allowed}.piano-roll-layout[data-v-6913985b]{display:flex;align-items:flex-start;gap:var(--scrollbar-gap)}.stage-wrapper[data-v-6913985b]{display:flex;flex-direction:column;gap:var(--scrollbar-gap);align-items:stretch}.scrollbar[data-v-6913985b]{position:relative;background:#f5f5f5;border:1px solid #ccc;border-radius:10px;box-sizing:border-box;user-select:none;touch-action:none}.scrollbar.horizontal[data-v-6913985b]{height:var(--scrollbar-thickness)}.scrollbar.vertical[data-v-6913985b]{width:var(--scrollbar-thickness)}.scrollbar.is-disabled[data-v-6913985b]{opacity:.45;pointer-events:none}.scrollbar-thumb[data-v-6913985b]{position:absolute;background:#0000002e;border-radius:6px;display:flex;align-items:center;justify-content:space-between;min-width:calc(var(--scrollbar-thickness) * .66);min-height:calc(var(--scrollbar-thickness) * .66);cursor:grab;transition:background .15s ease;box-sizing:border-box}.scrollbar-thumb.horizontal-thumb[data-v-6913985b]{top:0;height:100%;align-items:stretch}.scrollbar-thumb.vertical-thumb[data-v-6913985b]{left:0;width:100%;flex-direction:column;justify-content:space-between;align-items:stretch}.scrollbar-thumb[data-v-6913985b]:hover{background:#00000040}.scrollbar-body[data-v-6913985b]{flex:1;height:100%;cursor:grab}.scrollbar-body.vertical-body[data-v-6913985b]{width:100%}.scrollbar-handle[data-v-6913985b]{background:#00000059;border-radius:4px;flex:0 0 auto}.handle-left[data-v-6913985b],.handle-right[data-v-6913985b]{width:calc(var(--scrollbar-thickness) / 3);height:100%;cursor:ew-resize}.handle-top[data-v-6913985b],.handle-bottom[data-v-6913985b]{width:100%;height:calc(var(--scrollbar-thickness) / 3);cursor:ns-resize}label[data-v-6913985b]{display:flex;align-items:center;gap:5px;font-size:14px}select[data-v-6913985b]{padding:3px 8px;border:1px solid #ccc;border-radius:4px;font-size:14px;cursor:pointer}.metadata-editor-wrapper[data-v-6913985b]{width:100%;display:flex;flex-direction:column;align-items:center;gap:8px}"]],["__scopeId","data-v-6913985b"]]),Gh="piano-roll-component",Uh=vf(g5);return customElements.get(Gh)||customElements.define(Gh,Uh),jr.PianoRollElement=Uh,Object.defineProperty(jr,Symbol.toStringTag,{value:"Module"}),jr}({});
