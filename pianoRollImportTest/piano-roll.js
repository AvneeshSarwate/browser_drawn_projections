var PianoRollComponent=function(kr){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Er(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const wt={},rn=[],de=()=>{},uh=()=>!1,Ii=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Rr=t=>t.startsWith("onUpdate:"),zt=Object.assign,Ar=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},dh=Object.prototype.hasOwnProperty,yt=(t,e)=>dh.call(t,e),ut=Array.isArray,sn=t=>Tn(t)==="[object Map]",Oi=t=>Tn(t)==="[object Set]",Ks=t=>Tn(t)==="[object Date]",ft=t=>typeof t=="function",Ot=t=>typeof t=="string",fe=t=>typeof t=="symbol",Rt=t=>t!==null&&typeof t=="object",Ys=t=>(Rt(t)||ft(t))&&ft(t.then)&&ft(t.catch),Xs=Object.prototype.toString,Tn=t=>Xs.call(t),fh=t=>Tn(t).slice(8,-1),Fi=t=>Tn(t)==="[object Object]",Nr=t=>Ot(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,kn=Er(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Di=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},gh=/-(\w)/g,le=Di(t=>t.replace(gh,(e,n)=>n?n.toUpperCase():"")),ph=/\B([A-Z])/g,ie=Di(t=>t.replace(ph,"-$1").toLowerCase()),Qs=Di(t=>t.charAt(0).toUpperCase()+t.slice(1)),Mr=Di(t=>t?`on${Qs(t)}`:""),Ae=(t,e)=>!Object.is(t,e),zi=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Js=(t,e,n,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:n})},Li=t=>{const e=parseFloat(t);return isNaN(e)?t:e},to=t=>{const e=Ot(t)?Number(t):NaN;return isNaN(e)?t:e};let eo;const no=()=>eo||(eo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ne(t){if(ut(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],r=Ot(i)?bh(i):Ne(i);if(r)for(const s in r)e[s]=r[s]}return e}else if(Ot(t)||Rt(t))return t}const mh=/;(?![^(]*\))/g,_h=/:([^]+)/,vh=/\/\*[^]*?\*\//g;function bh(t){const e={};return t.replace(vh,"").split(mh).forEach(n=>{if(n){const i=n.split(_h);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function Ve(t){let e="";if(Ot(t))e=t;else if(ut(t))for(let n=0;n<t.length;n++){const i=Ve(t[n]);i&&(e+=i+" ")}else if(Rt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const yh=Er("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function io(t){return!!t||t===""}function Sh(t,e){if(t.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<t.length;i++)n=Gi(t[i],e[i]);return n}function Gi(t,e){if(t===e)return!0;let n=Ks(t),i=Ks(e);if(n||i)return n&&i?t.getTime()===e.getTime():!1;if(n=fe(t),i=fe(e),n||i)return t===e;if(n=ut(t),i=ut(e),n||i)return n&&i?Sh(t,e):!1;if(n=Rt(t),i=Rt(e),n||i){if(!n||!i)return!1;const r=Object.keys(t).length,s=Object.keys(e).length;if(r!==s)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Gi(t[o],e[o]))return!1}}return String(t)===String(e)}function wh(t,e){return t.findIndex(n=>Gi(n,e))}const ro=t=>!!(t&&t.__v_isRef===!0),Ir=t=>Ot(t)?t:t==null?"":ut(t)||Rt(t)&&(t.toString===Xs||!ft(t.toString))?ro(t)?Ir(t.value):JSON.stringify(t,so,2):String(t),so=(t,e)=>ro(e)?so(t,e.value):sn(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,r],s)=>(n[Or(i,s)+" =>"]=r,n),{})}:Oi(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Or(n))}:fe(e)?Or(e):Rt(e)&&!ut(e)&&!Fi(e)?String(e):e,Or=(t,e="")=>{var n;return fe(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Qt;class xh{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Qt,!e&&Qt&&(this.index=(Qt.scopes||(Qt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Qt;try{return Qt=this,e()}finally{Qt=n}}}on(){Qt=this}off(){Qt=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function Ch(){return Qt}let Tt;const Fr=new WeakSet;class oo{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Qt&&Qt.active&&Qt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Fr.has(this)&&(Fr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||lo(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,go(this),co(this);const e=Tt,n=ce;Tt=this,ce=!0;try{return this.fn()}finally{ho(this),Tt=e,ce=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Gr(e);this.deps=this.depsTail=void 0,go(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Fr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Lr(this)&&this.run()}get dirty(){return Lr(this)}}let ao=0,En,Rn;function lo(t,e=!1){if(t.flags|=8,e){t.next=Rn,Rn=t;return}t.next=En,En=t}function Dr(){ao++}function zr(){if(--ao>0)return;if(Rn){let e=Rn;for(Rn=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;En;){let e=En;for(En=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){t||(t=i)}e=n}}if(t)throw t}function co(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function ho(t){let e,n=t.depsTail,i=n;for(;i;){const r=i.prevDep;i.version===-1?(i===n&&(n=r),Gr(i),Ph(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}t.deps=e,t.depsTail=n}function Lr(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(uo(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function uo(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===An))return;t.globalVersion=An;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!Lr(t)){t.flags&=-3;return}const n=Tt,i=ce;Tt=t,ce=!0;try{co(t);const r=t.fn(t._value);(e.version===0||Ae(r,t._value))&&(t._value=r,e.version++)}catch(r){throw e.version++,r}finally{Tt=n,ce=i,ho(t),t.flags&=-3}}function Gr(t,e=!1){const{dep:n,prevSub:i,nextSub:r}=t;if(i&&(i.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=i,t.nextSub=void 0),n.subs===t&&(n.subs=i),!n.subs&&n.computed){n.computed.flags&=-5;for(let s=n.computed.deps;s;s=s.nextDep)Gr(s,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function Ph(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let ce=!0;const fo=[];function ve(){fo.push(ce),ce=!1}function be(){const t=fo.pop();ce=t===void 0?!0:t}function go(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Tt;Tt=void 0;try{e()}finally{Tt=n}}}let An=0;class Th{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ur{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Tt||!ce||Tt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Tt)n=this.activeLink=new Th(Tt,this),Tt.deps?(n.prevDep=Tt.depsTail,Tt.depsTail.nextDep=n,Tt.depsTail=n):Tt.deps=Tt.depsTail=n,po(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=Tt.depsTail,n.nextDep=void 0,Tt.depsTail.nextDep=n,Tt.depsTail=n,Tt.deps===n&&(Tt.deps=i)}return n}trigger(e){this.version++,An++,this.notify(e)}notify(e){Dr();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{zr()}}}function po(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)po(i)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Br=new WeakMap,He=Symbol(""),$r=Symbol(""),Nn=Symbol("");function Ut(t,e,n){if(ce&&Tt){let i=Br.get(t);i||Br.set(t,i=new Map);let r=i.get(n);r||(i.set(n,r=new Ur),r.map=i,r.key=n),r.track()}}function ye(t,e,n,i,r,s){const o=Br.get(t);if(!o){An++;return}const a=l=>{l&&l.trigger()};if(Dr(),e==="clear")o.forEach(a);else{const l=ut(t),c=l&&Nr(n);if(l&&n==="length"){const h=Number(i);o.forEach((d,g)=>{(g==="length"||g===Nn||!fe(g)&&g>=h)&&a(d)})}else switch(n!==void 0&&a(o.get(n)),c&&a(o.get(Nn)),e){case"add":l?c&&a(o.get("length")):(a(o.get(He)),sn(t)&&a(o.get($r)));break;case"delete":l||(a(o.get(He)),sn(t)&&a(o.get($r)));break;case"set":sn(t)&&a(o.get(He));break}}zr()}function on(t){const e=bt(t);return e===t?e:(Ut(e,"iterate",Nn),he(t)?e:e.map(Vt))}function Vr(t){return Ut(t=bt(t),"iterate",Nn),t}const kh={__proto__:null,[Symbol.iterator](){return Hr(this,Symbol.iterator,Vt)},concat(...t){return on(this).concat(...t.map(e=>ut(e)?on(e):e))},entries(){return Hr(this,"entries",t=>(t[1]=Vt(t[1]),t))},every(t,e){return Se(this,"every",t,e,void 0,arguments)},filter(t,e){return Se(this,"filter",t,e,n=>n.map(Vt),arguments)},find(t,e){return Se(this,"find",t,e,Vt,arguments)},findIndex(t,e){return Se(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Se(this,"findLast",t,e,Vt,arguments)},findLastIndex(t,e){return Se(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Se(this,"forEach",t,e,void 0,arguments)},includes(...t){return Wr(this,"includes",t)},indexOf(...t){return Wr(this,"indexOf",t)},join(t){return on(this).join(t)},lastIndexOf(...t){return Wr(this,"lastIndexOf",t)},map(t,e){return Se(this,"map",t,e,void 0,arguments)},pop(){return Mn(this,"pop")},push(...t){return Mn(this,"push",t)},reduce(t,...e){return mo(this,"reduce",t,e)},reduceRight(t,...e){return mo(this,"reduceRight",t,e)},shift(){return Mn(this,"shift")},some(t,e){return Se(this,"some",t,e,void 0,arguments)},splice(...t){return Mn(this,"splice",t)},toReversed(){return on(this).toReversed()},toSorted(t){return on(this).toSorted(t)},toSpliced(...t){return on(this).toSpliced(...t)},unshift(...t){return Mn(this,"unshift",t)},values(){return Hr(this,"values",Vt)}};function Hr(t,e,n){const i=Vr(t),r=i[e]();return i!==t&&!he(t)&&(r._next=r.next,r.next=()=>{const s=r._next();return s.value&&(s.value=n(s.value)),s}),r}const Eh=Array.prototype;function Se(t,e,n,i,r,s){const o=Vr(t),a=o!==t&&!he(t),l=o[e];if(l!==Eh[e]){const d=l.apply(t,s);return a?Vt(d):d}let c=n;o!==t&&(a?c=function(d,g){return n.call(this,Vt(d),g,t)}:n.length>2&&(c=function(d,g){return n.call(this,d,g,t)}));const h=l.call(o,c,i);return a&&r?r(h):h}function mo(t,e,n,i){const r=Vr(t);let s=n;return r!==t&&(he(t)?n.length>3&&(s=function(o,a,l){return n.call(this,o,a,l,t)}):s=function(o,a,l){return n.call(this,o,Vt(a),l,t)}),r[e](s,...i)}function Wr(t,e,n){const i=bt(t);Ut(i,"iterate",Nn);const r=i[e](...n);return(r===-1||r===!1)&&Zr(n[0])?(n[0]=bt(n[0]),i[e](...n)):r}function Mn(t,e,n=[]){ve(),Dr();const i=bt(t)[e].apply(t,n);return zr(),be(),i}const Rh=Er("__proto__,__v_isRef,__isVue"),_o=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(fe));function Ah(t){fe(t)||(t=String(t));const e=bt(this);return Ut(e,"has",t),e.hasOwnProperty(t)}class vo{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,i){const r=this._isReadonly,s=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return s;if(n==="__v_raw")return i===(r?s?Eo:ko:s?To:Po).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=ut(e);if(!r){let l;if(o&&(l=kh[n]))return l;if(n==="hasOwnProperty")return Ah}const a=Reflect.get(e,n,Gt(e)?e:i);return(fe(n)?_o.has(n):Rh(n))||(r||Ut(e,"get",n),s)?a:Gt(a)?o&&Nr(n)?a:a.value:Rt(a)?r?Ro(a):an(a):a}}class bo extends vo{constructor(e=!1){super(!1,e)}set(e,n,i,r){let s=e[n];if(!this._isShallow){const l=We(s);if(!he(i)&&!We(i)&&(s=bt(s),i=bt(i)),!ut(e)&&Gt(s)&&!Gt(i))return l?!1:(s.value=i,!0)}const o=ut(e)&&Nr(n)?Number(n)<e.length:yt(e,n),a=Reflect.set(e,n,i,Gt(e)?e:r);return e===bt(r)&&(o?Ae(i,s)&&ye(e,"set",n,i):ye(e,"add",n,i)),a}deleteProperty(e,n){const i=yt(e,n);e[n];const r=Reflect.deleteProperty(e,n);return r&&i&&ye(e,"delete",n,void 0),r}has(e,n){const i=Reflect.has(e,n);return(!fe(n)||!_o.has(n))&&Ut(e,"has",n),i}ownKeys(e){return Ut(e,"iterate",ut(e)?"length":He),Reflect.ownKeys(e)}}class yo extends vo{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Nh=new bo,Mh=new yo,Ih=new bo(!0),Oh=new yo(!0),jr=t=>t,Ui=t=>Reflect.getPrototypeOf(t);function Bi(t,e,n=!1,i=!1){t=t.__v_raw;const r=bt(t),s=bt(e);n||(Ae(e,s)&&Ut(r,"get",e),Ut(r,"get",s));const{has:o}=Ui(r),a=i?jr:n?qr:Vt;if(o.call(r,e))return a(t.get(e));if(o.call(r,s))return a(t.get(s));t!==r&&t.get(e)}function $i(t,e=!1){const n=this.__v_raw,i=bt(n),r=bt(t);return e||(Ae(t,r)&&Ut(i,"has",t),Ut(i,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function Vi(t,e=!1){return t=t.__v_raw,!e&&Ut(bt(t),"iterate",He),Reflect.get(t,"size",t)}function So(t,e=!1){!e&&!he(t)&&!We(t)&&(t=bt(t));const n=bt(this);return Ui(n).has.call(n,t)||(n.add(t),ye(n,"add",t,t)),this}function wo(t,e,n=!1){!n&&!he(e)&&!We(e)&&(e=bt(e));const i=bt(this),{has:r,get:s}=Ui(i);let o=r.call(i,t);o||(t=bt(t),o=r.call(i,t));const a=s.call(i,t);return i.set(t,e),o?Ae(e,a)&&ye(i,"set",t,e):ye(i,"add",t,e),this}function xo(t){const e=bt(this),{has:n,get:i}=Ui(e);let r=n.call(e,t);r||(t=bt(t),r=n.call(e,t)),i&&i.call(e,t);const s=e.delete(t);return r&&ye(e,"delete",t,void 0),s}function Co(){const t=bt(this),e=t.size!==0,n=t.clear();return e&&ye(t,"clear",void 0,void 0),n}function Hi(t,e){return function(i,r){const s=this,o=s.__v_raw,a=bt(o),l=e?jr:t?qr:Vt;return!t&&Ut(a,"iterate",He),o.forEach((c,h)=>i.call(r,l(c),l(h),s))}}function Wi(t,e,n){return function(...i){const r=this.__v_raw,s=bt(r),o=sn(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=r[t](...i),h=n?jr:e?qr:Vt;return!e&&Ut(s,"iterate",l?$r:He),{next(){const{value:d,done:g}=c.next();return g?{value:d,done:g}:{value:a?[h(d[0]),h(d[1])]:h(d),done:g}},[Symbol.iterator](){return this}}}}function Me(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Fh(){const t={get(s){return Bi(this,s)},get size(){return Vi(this)},has:$i,add:So,set:wo,delete:xo,clear:Co,forEach:Hi(!1,!1)},e={get(s){return Bi(this,s,!1,!0)},get size(){return Vi(this)},has:$i,add(s){return So.call(this,s,!0)},set(s,o){return wo.call(this,s,o,!0)},delete:xo,clear:Co,forEach:Hi(!1,!0)},n={get(s){return Bi(this,s,!0)},get size(){return Vi(this,!0)},has(s){return $i.call(this,s,!0)},add:Me("add"),set:Me("set"),delete:Me("delete"),clear:Me("clear"),forEach:Hi(!0,!1)},i={get(s){return Bi(this,s,!0,!0)},get size(){return Vi(this,!0)},has(s){return $i.call(this,s,!0)},add:Me("add"),set:Me("set"),delete:Me("delete"),clear:Me("clear"),forEach:Hi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=Wi(s,!1,!1),n[s]=Wi(s,!0,!1),e[s]=Wi(s,!1,!0),i[s]=Wi(s,!0,!0)}),[t,n,e,i]}const[Dh,zh,Lh,Gh]=Fh();function ji(t,e){const n=e?t?Gh:Lh:t?zh:Dh;return(i,r,s)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?i:Reflect.get(yt(n,r)&&r in i?n:i,r,s)}const Uh={get:ji(!1,!1)},Bh={get:ji(!1,!0)},$h={get:ji(!0,!1)},Vh={get:ji(!0,!0)},Po=new WeakMap,To=new WeakMap,ko=new WeakMap,Eo=new WeakMap;function Hh(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Wh(t){return t.__v_skip||!Object.isExtensible(t)?0:Hh(fh(t))}function an(t){return We(t)?t:Zi(t,!1,Nh,Uh,Po)}function jh(t){return Zi(t,!1,Ih,Bh,To)}function Ro(t){return Zi(t,!0,Mh,$h,ko)}function pm(t){return Zi(t,!0,Oh,Vh,Eo)}function Zi(t,e,n,i,r){if(!Rt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=r.get(t);if(s)return s;const o=Wh(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return r.set(t,a),a}function In(t){return We(t)?In(t.__v_raw):!!(t&&t.__v_isReactive)}function We(t){return!!(t&&t.__v_isReadonly)}function he(t){return!!(t&&t.__v_isShallow)}function Zr(t){return t?!!t.__v_raw:!1}function bt(t){const e=t&&t.__v_raw;return e?bt(e):t}function Zh(t){return!yt(t,"__v_skip")&&Object.isExtensible(t)&&Js(t,"__v_skip",!0),t}const Vt=t=>Rt(t)?an(t):t,qr=t=>Rt(t)?Ro(t):t;function Gt(t){return t?t.__v_isRef===!0:!1}function Jt(t){return Ao(t,!1)}function qh(t){return Ao(t,!0)}function Ao(t,e){return Gt(t)?t:new Kh(t,e)}class Kh{constructor(e,n){this.dep=new Ur,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:bt(e),this._value=n?e:Vt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,i=this.__v_isShallow||he(e)||We(e);e=i?e:bt(e),Ae(e,n)&&(this._rawValue=e,this._value=i?e:Vt(e),this.dep.trigger())}}function Ie(t){return Gt(t)?t.value:t}const Yh={get:(t,e,n)=>e==="__v_raw"?t:Ie(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const r=t[e];return Gt(r)&&!Gt(n)?(r.value=n,!0):Reflect.set(t,e,n,i)}};function No(t){return In(t)?t:new Proxy(t,Yh)}class Xh{constructor(e,n,i){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Ur(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=An-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Tt!==this)return lo(this,!0),!0}get value(){const e=this.dep.track();return uo(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Qh(t,e,n=!1){let i,r;return ft(t)?i=t:(i=t.get,r=t.set),new Xh(i,r,n)}const qi={},Ki=new WeakMap;let je;function Jh(t,e=!1,n=je){if(n){let i=Ki.get(n);i||Ki.set(n,i=[]),i.push(t)}}function tu(t,e,n=wt){const{immediate:i,deep:r,once:s,scheduler:o,augmentJob:a,call:l}=n,c=_=>r?_:he(_)||r===!1||r===0?we(_,1):we(_);let h,d,g,f,p=!1,v=!1;if(Gt(t)?(d=()=>t.value,p=he(t)):In(t)?(d=()=>c(t),p=!0):ut(t)?(v=!0,p=t.some(_=>In(_)||he(_)),d=()=>t.map(_=>{if(Gt(_))return _.value;if(In(_))return c(_);if(ft(_))return l?l(_,2):_()})):ft(t)?e?d=l?()=>l(t,2):t:d=()=>{if(g){ve();try{g()}finally{be()}}const _=je;je=h;try{return l?l(t,3,[f]):t(f)}finally{je=_}}:d=de,e&&r){const _=d,y=r===!0?1/0:r;d=()=>we(_(),y)}const S=Ch(),C=()=>{h.stop(),S&&Ar(S.effects,h)};if(s&&e){const _=e;e=(...y)=>{_(...y),C()}}let m=v?new Array(t.length).fill(qi):qi;const u=_=>{if(!(!(h.flags&1)||!h.dirty&&!_))if(e){const y=h.run();if(r||p||(v?y.some((k,I)=>Ae(k,m[I])):Ae(y,m))){g&&g();const k=je;je=h;try{const I=[y,m===qi?void 0:v&&m[0]===qi?[]:m,f];l?l(e,3,I):e(...I),m=y}finally{je=k}}}else h.run()};return a&&a(u),h=new oo(d),h.scheduler=o?()=>o(u,!1):u,f=_=>Jh(_,!1,h),g=h.onStop=()=>{const _=Ki.get(h);if(_){if(l)l(_,4);else for(const y of _)y();Ki.delete(h)}},e?i?u(!0):m=h.run():o?o(u.bind(null,!0),!0):h.run(),C.pause=h.pause.bind(h),C.resume=h.resume.bind(h),C.stop=C,C}function we(t,e=1/0,n){if(e<=0||!Rt(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,Gt(t))we(t.value,e,n);else if(ut(t))for(let i=0;i<t.length;i++)we(t[i],e,n);else if(Oi(t)||sn(t))t.forEach(i=>{we(i,e,n)});else if(Fi(t)){for(const i in t)we(t[i],e,n);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&we(t[i],e,n)}return t}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const On=[];let Kr=!1;function mm(t,...e){if(Kr)return;Kr=!0,ve();const n=On.length?On[On.length-1].component:null,i=n&&n.appContext.config.warnHandler,r=eu();if(i)ln(i,n,11,[t+e.map(s=>{var o,a;return(a=(o=s.toString)==null?void 0:o.call(s))!=null?a:JSON.stringify(s)}).join(""),n&&n.proxy,r.map(({vnode:s})=>`at <${Ca(n,s.type)}>`).join(`
`),r]);else{const s=[`[Vue warn]: ${t}`,...e];r.length&&s.push(`
`,...nu(r)),console.warn(...s)}be(),Kr=!1}function eu(){let t=On[On.length-1];if(!t)return[];const e=[];for(;t;){const n=e[0];n&&n.vnode===t?n.recurseCount++:e.push({vnode:t,recurseCount:0});const i=t.component&&t.component.parent;t=i&&i.vnode}return e}function nu(t){const e=[];return t.forEach((n,i)=>{e.push(...i===0?[]:[`
`],...iu(n))}),e}function iu({vnode:t,recurseCount:e}){const n=e>0?`... (${e} recursive calls)`:"",i=t.component?t.component.parent==null:!1,r=` at <${Ca(t.component,t.type,i)}`,s=">"+n;return t.props?[r,...ru(t.props),s]:[r+s]}function ru(t){const e=[],n=Object.keys(t);return n.slice(0,3).forEach(i=>{e.push(...Mo(i,t[i]))}),n.length>3&&e.push(" ..."),e}function Mo(t,e,n){return Ot(e)?(e=JSON.stringify(e),n?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?n?e:[`${t}=${e}`]:Gt(e)?(e=Mo(t,bt(e.value),!0),n?e:[`${t}=Ref<`,e,">"]):ft(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=bt(e),n?e:[`${t}=`,e])}function ln(t,e,n,i){try{return i?t(...i):t()}catch(r){Yi(r,e,n)}}function ge(t,e,n,i){if(ft(t)){const r=ln(t,e,n,i);return r&&Ys(r)&&r.catch(s=>{Yi(s,e,n)}),r}if(ut(t)){const r=[];for(let s=0;s<t.length;s++)r.push(ge(t[s],e,n,i));return r}}function Yi(t,e,n,i=!0){const r=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||wt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let d=0;d<h.length;d++)if(h[d](t,l,c)===!1)return}a=a.parent}if(s){ve(),ln(s,null,10,[t,l,c]),be();return}}su(t,n,r,i,o)}function su(t,e,n,i=!0,r=!1){if(r)throw t;console.error(t)}const Ht=[];let pe=-1;const cn=[];let Oe=null,hn=0;const Io=Promise.resolve();let Xi=null;function Yr(t){const e=Xi||Io;return t?e.then(this?t.bind(this):t):e}function ou(t){let e=pe+1,n=Ht.length;for(;e<n;){const i=e+n>>>1,r=Ht[i],s=Fn(r);s<t||s===t&&r.flags&2?e=i+1:n=i}return e}function Xr(t){if(!(t.flags&1)){const e=Fn(t),n=Ht[Ht.length-1];!n||!(t.flags&2)&&e>=Fn(n)?Ht.push(t):Ht.splice(ou(e),0,t),t.flags|=1,Oo()}}function Oo(){Xi||(Xi=Io.then(zo))}function au(t){ut(t)?cn.push(...t):Oe&&t.id===-1?Oe.splice(hn+1,0,t):t.flags&1||(cn.push(t),t.flags|=1),Oo()}function Fo(t,e,n=pe+1){for(;n<Ht.length;n++){const i=Ht[n];if(i&&i.flags&2){if(t&&i.id!==t.uid)continue;Ht.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Do(t){if(cn.length){const e=[...new Set(cn)].sort((n,i)=>Fn(n)-Fn(i));if(cn.length=0,Oe){Oe.push(...e);return}for(Oe=e,hn=0;hn<Oe.length;hn++){const n=Oe[hn];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Oe=null,hn=0}}const Fn=t=>t.id==null?t.flags&2?-1:1/0:t.id;function zo(t){try{for(pe=0;pe<Ht.length;pe++){const e=Ht[pe];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),ln(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;pe<Ht.length;pe++){const e=Ht[pe];e&&(e.flags&=-2)}pe=-1,Ht.length=0,Do(),Xi=null,(Ht.length||cn.length)&&zo()}}let re=null,Lo=null;function Qi(t){const e=re;return re=t,Lo=t&&t.type.__scopeId||null,e}function lu(t,e=re,n){if(!e||t._n)return t;const i=(...r)=>{i._d&&ma(-1);const s=Qi(e);let o;try{o=t(...r)}finally{Qi(s),i._d&&ma(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Go(t,e){if(re===null)return t;const n=lr(re),i=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[s,o,a,l=wt]=e[r];s&&(ft(s)&&(s={mounted:s,updated:s}),s.deep&&we(o),i.push({dir:s,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function Ze(t,e,n,i){const r=t.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(ve(),ge(l,n,8,[t.el,a,t,e]),be())}}const cu=Symbol("_vte"),hu=t=>t.__isTeleport;function Qr(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Qr(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function Jr(t,e){return ft(t)?zt({name:t.name},e,{setup:t}):t}function Uo(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function ts(t,e,n,i,r=!1){if(ut(t)){t.forEach((p,v)=>ts(p,e&&(ut(e)?e[v]:e),n,i,r));return}if(Dn(i)&&!r)return;const s=i.shapeFlag&4?lr(i.component):i.el,o=r?null:s,{i:a,r:l}=t,c=e&&e.r,h=a.refs===wt?a.refs={}:a.refs,d=a.setupState,g=bt(d),f=d===wt?()=>!1:p=>yt(g,p);if(c!=null&&c!==l&&(Ot(c)?(h[c]=null,f(c)&&(d[c]=null)):Gt(c)&&(c.value=null)),ft(l))ln(l,a,12,[o,h]);else{const p=Ot(l),v=Gt(l);if(p||v){const S=()=>{if(t.f){const C=p?f(l)?d[l]:h[l]:l.value;r?ut(C)&&Ar(C,s):ut(C)?C.includes(s)||C.push(s):p?(h[l]=[s],f(l)&&(d[l]=h[l])):(l.value=[s],t.k&&(h[t.k]=l.value))}else p?(h[l]=o,f(l)&&(d[l]=o)):v&&(l.value=o,t.k&&(h[t.k]=o))};o?(S.id=-1,te(S,n)):S()}}}const Dn=t=>!!t.type.__asyncLoader,Bo=t=>t.type.__isKeepAlive;function uu(t,e){$o(t,"a",e)}function du(t,e){$o(t,"da",e)}function $o(t,e,n=jt){const i=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Ji(e,i,n),n){let r=n.parent;for(;r&&r.parent;)Bo(r.parent.vnode)&&fu(i,e,n,r),r=r.parent}}function fu(t,e,n,i){const r=Ji(e,t,i,!0);es(()=>{Ar(i[e],r)},n)}function Ji(t,e,n=jt,i=!1){if(n){const r=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...o)=>{ve();const a=$n(n),l=ge(e,n,t,o);return a(),be(),l});return i?r.unshift(s):r.push(s),s}}const xe=t=>(e,n=jt)=>{(!ar||t==="sp")&&Ji(t,(...i)=>e(...i),n)},gu=xe("bm"),Vo=xe("m"),pu=xe("bu"),mu=xe("u"),_u=xe("bum"),es=xe("um"),vu=xe("sp"),bu=xe("rtg"),yu=xe("rtc");function Su(t,e=jt){Ji("ec",t,e)}const wu=Symbol.for("v-ndc"),ns=t=>t?Sa(t)?lr(t):ns(t.parent):null,zn=zt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>ns(t.parent),$root:t=>ns(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Zo(t),$forceUpdate:t=>t.f||(t.f=()=>{Xr(t.update)}),$nextTick:t=>t.n||(t.n=Yr.bind(t.proxy)),$watch:t=>Hu.bind(t)}),is=(t,e)=>t!==wt&&!t.__isScriptSetup&&yt(t,e),xu={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return i[e];case 2:return r[e];case 4:return n[e];case 3:return s[e]}else{if(is(i,e))return o[e]=1,i[e];if(r!==wt&&yt(r,e))return o[e]=2,r[e];if((c=t.propsOptions[0])&&yt(c,e))return o[e]=3,s[e];if(n!==wt&&yt(n,e))return o[e]=4,n[e];rs&&(o[e]=0)}}const h=zn[e];let d,g;if(h)return e==="$attrs"&&Ut(t.attrs,"get",""),h(t);if((d=a.__cssModules)&&(d=d[e]))return d;if(n!==wt&&yt(n,e))return o[e]=4,n[e];if(g=l.config.globalProperties,yt(g,e))return g[e]},set({_:t},e,n){const{data:i,setupState:r,ctx:s}=t;return is(r,e)?(r[e]=n,!0):i!==wt&&yt(i,e)?(i[e]=n,!0):yt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!n[o]||t!==wt&&yt(t,o)||is(e,o)||(a=s[0])&&yt(a,o)||yt(i,o)||yt(zn,o)||yt(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:yt(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Ho(t){return ut(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let rs=!0;function Cu(t){const e=Zo(t),n=t.proxy,i=t.ctx;rs=!1,e.beforeCreate&&Wo(e.beforeCreate,t,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:d,mounted:g,beforeUpdate:f,updated:p,activated:v,deactivated:S,beforeDestroy:C,beforeUnmount:m,destroyed:u,unmounted:_,render:y,renderTracked:k,renderTriggered:I,errorCaptured:w,serverPrefetch:x,expose:T,inheritAttrs:N,components:D,directives:L,filters:U}=e;if(c&&Pu(c,i,null),o)for(const b in o){const P=o[b];ft(P)&&(i[b]=P.bind(n))}if(r){const b=r.call(n,n);Rt(b)&&(t.data=an(b))}if(rs=!0,s)for(const b in s){const P=s[b],M=ft(P)?P.bind(n,n):ft(P.get)?P.get.bind(n,n):de,R=!ft(P)&&ft(P.set)?P.set.bind(n):de,F=se({get:M,set:R});Object.defineProperty(i,b,{enumerable:!0,configurable:!0,get:()=>F.value,set:H=>F.value=H})}if(a)for(const b in a)jo(a[b],i,n,b);if(l){const b=ft(l)?l.call(n):l;Reflect.ownKeys(b).forEach(P=>{Nu(P,b[P])})}h&&Wo(h,t,"c");function X(b,P){ut(P)?P.forEach(M=>b(M.bind(n))):P&&b(P.bind(n))}if(X(gu,d),X(Vo,g),X(pu,f),X(mu,p),X(uu,v),X(du,S),X(Su,w),X(yu,k),X(bu,I),X(_u,m),X(es,_),X(vu,x),ut(T))if(T.length){const b=t.exposed||(t.exposed={});T.forEach(P=>{Object.defineProperty(b,P,{get:()=>n[P],set:M=>n[P]=M})})}else t.exposed||(t.exposed={});y&&t.render===de&&(t.render=y),N!=null&&(t.inheritAttrs=N),D&&(t.components=D),L&&(t.directives=L),x&&Uo(t)}function Pu(t,e,n=de){ut(t)&&(t=ss(t));for(const i in t){const r=t[i];let s;Rt(r)?"default"in r?s=er(r.from||i,r.default,!0):s=er(r.from||i):s=er(r),Gt(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[i]=s}}function Wo(t,e,n){ge(ut(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function jo(t,e,n,i){let r=i.includes(".")?ua(n,i):()=>n[i];if(Ot(t)){const s=e[t];ft(s)&&Ce(r,s)}else if(ft(t))Ce(r,t.bind(n));else if(Rt(t))if(ut(t))t.forEach(s=>jo(s,e,n,i));else{const s=ft(t.handler)?t.handler.bind(n):e[t.handler];ft(s)&&Ce(r,s,t)}}function Zo(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!n&&!i?l=e:(l={},r.length&&r.forEach(c=>tr(l,c,o,!0)),tr(l,e,o)),Rt(e)&&s.set(e,l),l}function tr(t,e,n,i=!1){const{mixins:r,extends:s}=e;s&&tr(t,s,n,!0),r&&r.forEach(o=>tr(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=Tu[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Tu={data:qo,props:Ko,emits:Ko,methods:Ln,computed:Ln,beforeCreate:Wt,created:Wt,beforeMount:Wt,mounted:Wt,beforeUpdate:Wt,updated:Wt,beforeDestroy:Wt,beforeUnmount:Wt,destroyed:Wt,unmounted:Wt,activated:Wt,deactivated:Wt,errorCaptured:Wt,serverPrefetch:Wt,components:Ln,directives:Ln,watch:Eu,provide:qo,inject:ku};function qo(t,e){return e?t?function(){return zt(ft(t)?t.call(this,this):t,ft(e)?e.call(this,this):e)}:e:t}function ku(t,e){return Ln(ss(t),ss(e))}function ss(t){if(ut(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Wt(t,e){return t?[...new Set([].concat(t,e))]:e}function Ln(t,e){return t?zt(Object.create(null),t,e):e}function Ko(t,e){return t?ut(t)&&ut(e)?[...new Set([...t,...e])]:zt(Object.create(null),Ho(t),Ho(e??{})):e}function Eu(t,e){if(!t)return e;if(!e)return t;const n=zt(Object.create(null),t);for(const i in e)n[i]=Wt(t[i],e[i]);return n}function Yo(){return{app:null,config:{isNativeTag:uh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ru=0;function Au(t,e){return function(i,r=null){ft(i)||(i=zt({},i)),r!=null&&!Rt(r)&&(r=null);const s=Yo(),o=new WeakSet,a=[];let l=!1;const c=s.app={_uid:Ru++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:gd,get config(){return s.config},set config(h){},use(h,...d){return o.has(h)||(h&&ft(h.install)?(o.add(h),h.install(c,...d)):ft(h)&&(o.add(h),h(c,...d))),c},mixin(h){return s.mixins.includes(h)||s.mixins.push(h),c},component(h,d){return d?(s.components[h]=d,c):s.components[h]},directive(h,d){return d?(s.directives[h]=d,c):s.directives[h]},mount(h,d,g){if(!l){const f=c._ceVNode||ue(i,r);return f.appContext=s,g===!0?g="svg":g===!1&&(g=void 0),t(f,h,g),l=!0,c._container=h,h.__vue_app__=c,lr(f.component)}},onUnmount(h){a.push(h)},unmount(){l&&(ge(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(h,d){return s.provides[h]=d,c},runWithContext(h){const d=un;un=c;try{return h()}finally{un=d}}};return c}}let un=null;function Nu(t,e){if(jt){let n=jt.provides;const i=jt.parent&&jt.parent.provides;i===n&&(n=jt.provides=Object.create(i)),n[t]=e}}function er(t,e,n=!1){const i=jt||re;if(i||un){const r=un?un._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return n&&ft(e)?e.call(i&&i.proxy):e}}const Xo={},Qo=()=>Object.create(Xo),Jo=t=>Object.getPrototypeOf(t)===Xo;function Mu(t,e,n,i=!1){const r={},s=Qo();t.propsDefaults=Object.create(null),ta(t,e,r,s);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=i?r:jh(r):t.type.props?t.props=r:t.props=s,t.attrs=s}function Iu(t,e,n,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=t,a=bt(r),[l]=t.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let d=0;d<h.length;d++){let g=h[d];if(nr(t.emitsOptions,g))continue;const f=e[g];if(l)if(yt(s,g))f!==s[g]&&(s[g]=f,c=!0);else{const p=le(g);r[p]=os(l,a,p,f,t,!1)}else f!==s[g]&&(s[g]=f,c=!0)}}}else{ta(t,e,r,s)&&(c=!0);let h;for(const d in a)(!e||!yt(e,d)&&((h=ie(d))===d||!yt(e,h)))&&(l?n&&(n[d]!==void 0||n[h]!==void 0)&&(r[d]=os(l,a,d,void 0,t,!0)):delete r[d]);if(s!==a)for(const d in s)(!e||!yt(e,d))&&(delete s[d],c=!0)}c&&ye(t.attrs,"set","")}function ta(t,e,n,i){const[r,s]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(kn(l))continue;const c=e[l];let h;r&&yt(r,h=le(l))?!s||!s.includes(h)?n[h]=c:(a||(a={}))[h]=c:nr(t.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(s){const l=bt(n),c=a||wt;for(let h=0;h<s.length;h++){const d=s[h];n[d]=os(r,l,d,c[d],t,!yt(c,d))}}return o}function os(t,e,n,i,r,s){const o=t[n];if(o!=null){const a=yt(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&ft(l)){const{propsDefaults:c}=r;if(n in c)i=c[n];else{const h=$n(r);i=c[n]=l.call(null,e),h()}}else i=l;r.ce&&r.ce._setProp(n,i)}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===ie(n))&&(i=!0))}return i}const Ou=new WeakMap;function ea(t,e,n=!1){const i=n?Ou:e.propsCache,r=i.get(t);if(r)return r;const s=t.props,o={},a=[];let l=!1;if(!ft(t)){const h=d=>{l=!0;const[g,f]=ea(d,e,!0);zt(o,g),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!s&&!l)return Rt(t)&&i.set(t,rn),rn;if(ut(s))for(let h=0;h<s.length;h++){const d=le(s[h]);na(d)&&(o[d]=wt)}else if(s)for(const h in s){const d=le(h);if(na(d)){const g=s[h],f=o[d]=ut(g)||ft(g)?{type:g}:zt({},g),p=f.type;let v=!1,S=!0;if(ut(p))for(let C=0;C<p.length;++C){const m=p[C],u=ft(m)&&m.name;if(u==="Boolean"){v=!0;break}else u==="String"&&(S=!1)}else v=ft(p)&&p.name==="Boolean";f[0]=v,f[1]=S,(v||yt(f,"default"))&&a.push(d)}}const c=[o,a];return Rt(t)&&i.set(t,c),c}function na(t){return t[0]!=="$"&&!kn(t)}const ia=t=>t[0]==="_"||t==="$stable",as=t=>ut(t)?t.map(me):[me(t)],Fu=(t,e,n)=>{if(e._n)return e;const i=lu((...r)=>as(e(...r)),n);return i._c=!1,i},ra=(t,e,n)=>{const i=t._ctx;for(const r in t){if(ia(r))continue;const s=t[r];if(ft(s))e[r]=Fu(r,s,i);else if(s!=null){const o=as(s);e[r]=()=>o}}},sa=(t,e)=>{const n=as(e);t.slots.default=()=>n},oa=(t,e,n)=>{for(const i in e)(n||i!=="_")&&(t[i]=e[i])},Du=(t,e,n)=>{const i=t.slots=Qo();if(t.vnode.shapeFlag&32){const r=e._;r?(oa(i,e,n),n&&Js(i,"_",r,!0)):ra(e,i)}else e&&sa(t,e)},zu=(t,e,n)=>{const{vnode:i,slots:r}=t;let s=!0,o=wt;if(i.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:oa(r,e,n):(s=!e.$stable,ra(e,r)),o=e}else e&&(sa(t,e),o={default:1});if(s)for(const a in r)!ia(a)&&o[a]==null&&delete r[a]},te=Xu;function Lu(t){return Gu(t)}function Gu(t,e){const n=no();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:d,nextSibling:g,setScopeId:f=de,insertStaticContent:p}=t,v=(E,O,B,j=null,Y=null,q=null,J=void 0,rt=null,et=!!O.dynamicChildren)=>{if(E===O)return;E&&!Bn(E,O)&&(j=A(E),H(E,Y,q,!0),E=null),O.patchFlag===-2&&(et=!1,O.dynamicChildren=null);const{type:tt,ref:Z,shapeFlag:W}=O;switch(tt){case ir:S(E,O,B,j);break;case Ke:C(E,O,B,j);break;case cs:E==null&&m(O,B,j,J);break;case Pe:D(E,O,B,j,Y,q,J,rt,et);break;default:W&1?y(E,O,B,j,Y,q,J,rt,et):W&6?L(E,O,B,j,Y,q,J,rt,et):(W&64||W&128)&&tt.process(E,O,B,j,Y,q,J,rt,et,ot)}Z!=null&&Y&&ts(Z,E&&E.ref,q,O||E,!O)},S=(E,O,B,j)=>{if(E==null)i(O.el=a(O.children),B,j);else{const Y=O.el=E.el;O.children!==E.children&&c(Y,O.children)}},C=(E,O,B,j)=>{E==null?i(O.el=l(O.children||""),B,j):O.el=E.el},m=(E,O,B,j)=>{[E.el,E.anchor]=p(E.children,O,B,j,E.el,E.anchor)},u=({el:E,anchor:O},B,j)=>{let Y;for(;E&&E!==O;)Y=g(E),i(E,B,j),E=Y;i(O,B,j)},_=({el:E,anchor:O})=>{let B;for(;E&&E!==O;)B=g(E),r(E),E=B;r(O)},y=(E,O,B,j,Y,q,J,rt,et)=>{O.type==="svg"?J="svg":O.type==="math"&&(J="mathml"),E==null?k(O,B,j,Y,q,J,rt,et):x(E,O,Y,q,J,rt,et)},k=(E,O,B,j,Y,q,J,rt)=>{let et,tt;const{props:Z,shapeFlag:W,transition:nt,dirs:at}=E;if(et=E.el=o(E.type,q,Z&&Z.is,Z),W&8?h(et,E.children):W&16&&w(E.children,et,null,j,Y,ls(E,q),J,rt),at&&Ze(E,null,j,"created"),I(et,E,E.scopeId,J,j),Z){for(const gt in Z)gt!=="value"&&!kn(gt)&&s(et,gt,null,Z[gt],q,j);"value"in Z&&s(et,"value",null,Z.value,q),(tt=Z.onVnodeBeforeMount)&&_e(tt,j,E)}at&&Ze(E,null,j,"beforeMount");const ht=Uu(Y,nt);ht&&nt.beforeEnter(et),i(et,O,B),((tt=Z&&Z.onVnodeMounted)||ht||at)&&te(()=>{tt&&_e(tt,j,E),ht&&nt.enter(et),at&&Ze(E,null,j,"mounted")},Y)},I=(E,O,B,j,Y)=>{if(B&&f(E,B),j)for(let q=0;q<j.length;q++)f(E,j[q]);if(Y){let q=Y.subTree;if(O===q||pa(q.type)&&(q.ssContent===O||q.ssFallback===O)){const J=Y.vnode;I(E,J,J.scopeId,J.slotScopeIds,Y.parent)}}},w=(E,O,B,j,Y,q,J,rt,et=0)=>{for(let tt=et;tt<E.length;tt++){const Z=E[tt]=rt?De(E[tt]):me(E[tt]);v(null,Z,O,B,j,Y,q,J,rt)}},x=(E,O,B,j,Y,q,J)=>{const rt=O.el=E.el;let{patchFlag:et,dynamicChildren:tt,dirs:Z}=O;et|=E.patchFlag&16;const W=E.props||wt,nt=O.props||wt;let at;if(B&&qe(B,!1),(at=nt.onVnodeBeforeUpdate)&&_e(at,B,O,E),Z&&Ze(O,E,B,"beforeUpdate"),B&&qe(B,!0),(W.innerHTML&&nt.innerHTML==null||W.textContent&&nt.textContent==null)&&h(rt,""),tt?T(E.dynamicChildren,tt,rt,B,j,ls(O,Y),q):J||P(E,O,rt,null,B,j,ls(O,Y),q,!1),et>0){if(et&16)N(rt,W,nt,B,Y);else if(et&2&&W.class!==nt.class&&s(rt,"class",null,nt.class,Y),et&4&&s(rt,"style",W.style,nt.style,Y),et&8){const ht=O.dynamicProps;for(let gt=0;gt<ht.length;gt++){const dt=ht[gt],Pt=W[dt],St=nt[dt];(St!==Pt||dt==="value")&&s(rt,dt,Pt,St,Y,B)}}et&1&&E.children!==O.children&&h(rt,O.children)}else!J&&tt==null&&N(rt,W,nt,B,Y);((at=nt.onVnodeUpdated)||Z)&&te(()=>{at&&_e(at,B,O,E),Z&&Ze(O,E,B,"updated")},j)},T=(E,O,B,j,Y,q,J)=>{for(let rt=0;rt<O.length;rt++){const et=E[rt],tt=O[rt],Z=et.el&&(et.type===Pe||!Bn(et,tt)||et.shapeFlag&70)?d(et.el):B;v(et,tt,Z,null,j,Y,q,J,!0)}},N=(E,O,B,j,Y)=>{if(O!==B){if(O!==wt)for(const q in O)!kn(q)&&!(q in B)&&s(E,q,O[q],null,Y,j);for(const q in B){if(kn(q))continue;const J=B[q],rt=O[q];J!==rt&&q!=="value"&&s(E,q,rt,J,Y,j)}"value"in B&&s(E,"value",O.value,B.value,Y)}},D=(E,O,B,j,Y,q,J,rt,et)=>{const tt=O.el=E?E.el:a(""),Z=O.anchor=E?E.anchor:a("");let{patchFlag:W,dynamicChildren:nt,slotScopeIds:at}=O;at&&(rt=rt?rt.concat(at):at),E==null?(i(tt,B,j),i(Z,B,j),w(O.children||[],B,Z,Y,q,J,rt,et)):W>0&&W&64&&nt&&E.dynamicChildren?(T(E.dynamicChildren,nt,B,Y,q,J,rt),(O.key!=null||Y&&O===Y.subTree)&&aa(E,O,!0)):P(E,O,B,Z,Y,q,J,rt,et)},L=(E,O,B,j,Y,q,J,rt,et)=>{O.slotScopeIds=rt,E==null?O.shapeFlag&512?Y.ctx.activate(O,B,j,J,et):U(O,B,j,Y,q,J,et):z(E,O,et)},U=(E,O,B,j,Y,q,J)=>{const rt=E.component=sd(E,j,Y);if(Bo(E)&&(rt.ctx.renderer=ot),od(rt,!1,J),rt.asyncDep){if(Y&&Y.registerDep(rt,X,J),!E.el){const et=rt.subTree=ue(Ke);C(null,et,O,B)}}else X(rt,E,O,B,Y,q,J)},z=(E,O,B)=>{const j=O.component=E.component;if(Ku(E,O,B))if(j.asyncDep&&!j.asyncResolved){b(j,O,B);return}else j.next=O,j.update();else O.el=E.el,j.vnode=O},X=(E,O,B,j,Y,q,J)=>{const rt=()=>{if(E.isMounted){let{next:W,bu:nt,u:at,parent:ht,vnode:gt}=E;{const $t=la(E);if($t){W&&(W.el=gt.el,b(E,W,J)),$t.asyncDep.then(()=>{E.isUnmounted||rt()});return}}let dt=W,Pt;qe(E,!1),W?(W.el=gt.el,b(E,W,J)):W=gt,nt&&zi(nt),(Pt=W.props&&W.props.onVnodeBeforeUpdate)&&_e(Pt,ht,W,gt),qe(E,!0);const St=fa(E),Et=E.subTree;E.subTree=St,v(Et,St,d(Et.el),A(Et),E,Y,q),W.el=St.el,dt===null&&Yu(E,St.el),at&&te(at,Y),(Pt=W.props&&W.props.onVnodeUpdated)&&te(()=>_e(Pt,ht,W,gt),Y)}else{let W;const{el:nt,props:at}=O,{bm:ht,m:gt,parent:dt,root:Pt,type:St}=E,Et=Dn(O);qe(E,!1),ht&&zi(ht),!Et&&(W=at&&at.onVnodeBeforeMount)&&_e(W,dt,O),qe(E,!0);{Pt.ce&&Pt.ce._injectChildStyle(St);const $t=E.subTree=fa(E);v(null,$t,B,j,E,Y,q),O.el=$t.el}if(gt&&te(gt,Y),!Et&&(W=at&&at.onVnodeMounted)){const $t=O;te(()=>_e(W,dt,$t),Y)}(O.shapeFlag&256||dt&&Dn(dt.vnode)&&dt.vnode.shapeFlag&256)&&E.a&&te(E.a,Y),E.isMounted=!0,O=B=j=null}};E.scope.on();const et=E.effect=new oo(rt);E.scope.off();const tt=E.update=et.run.bind(et),Z=E.job=et.runIfDirty.bind(et);Z.i=E,Z.id=E.uid,et.scheduler=()=>Xr(Z),qe(E,!0),tt()},b=(E,O,B)=>{O.component=E;const j=E.vnode.props;E.vnode=O,E.next=null,Iu(E,O.props,j,B),zu(E,O.children,B),ve(),Fo(E),be()},P=(E,O,B,j,Y,q,J,rt,et=!1)=>{const tt=E&&E.children,Z=E?E.shapeFlag:0,W=O.children,{patchFlag:nt,shapeFlag:at}=O;if(nt>0){if(nt&128){R(tt,W,B,j,Y,q,J,rt,et);return}else if(nt&256){M(tt,W,B,j,Y,q,J,rt,et);return}}at&8?(Z&16&&V(tt,Y,q),W!==tt&&h(B,W)):Z&16?at&16?R(tt,W,B,j,Y,q,J,rt,et):V(tt,Y,q,!0):(Z&8&&h(B,""),at&16&&w(W,B,j,Y,q,J,rt,et))},M=(E,O,B,j,Y,q,J,rt,et)=>{E=E||rn,O=O||rn;const tt=E.length,Z=O.length,W=Math.min(tt,Z);let nt;for(nt=0;nt<W;nt++){const at=O[nt]=et?De(O[nt]):me(O[nt]);v(E[nt],at,B,null,Y,q,J,rt,et)}tt>Z?V(E,Y,q,!0,!1,W):w(O,B,j,Y,q,J,rt,et,W)},R=(E,O,B,j,Y,q,J,rt,et)=>{let tt=0;const Z=O.length;let W=E.length-1,nt=Z-1;for(;tt<=W&&tt<=nt;){const at=E[tt],ht=O[tt]=et?De(O[tt]):me(O[tt]);if(Bn(at,ht))v(at,ht,B,null,Y,q,J,rt,et);else break;tt++}for(;tt<=W&&tt<=nt;){const at=E[W],ht=O[nt]=et?De(O[nt]):me(O[nt]);if(Bn(at,ht))v(at,ht,B,null,Y,q,J,rt,et);else break;W--,nt--}if(tt>W){if(tt<=nt){const at=nt+1,ht=at<Z?O[at].el:j;for(;tt<=nt;)v(null,O[tt]=et?De(O[tt]):me(O[tt]),B,ht,Y,q,J,rt,et),tt++}}else if(tt>nt)for(;tt<=W;)H(E[tt],Y,q,!0),tt++;else{const at=tt,ht=tt,gt=new Map;for(tt=ht;tt<=nt;tt++){const qt=O[tt]=et?De(O[tt]):me(O[tt]);qt.key!=null&&gt.set(qt.key,tt)}let dt,Pt=0;const St=nt-ht+1;let Et=!1,$t=0;const $e=new Array(St);for(tt=0;tt<St;tt++)$e[tt]=0;for(tt=at;tt<=W;tt++){const qt=E[tt];if(Pt>=St){H(qt,Y,q,!0);continue}let ae;if(qt.key!=null)ae=gt.get(qt.key);else for(dt=ht;dt<=nt;dt++)if($e[dt-ht]===0&&Bn(qt,O[dt])){ae=dt;break}ae===void 0?H(qt,Y,q,!0):($e[ae-ht]=tt+1,ae>=$t?$t=ae:Et=!0,v(qt,O[ae],B,null,Y,q,J,rt,et),Pt++)}const nn=Et?Bu($e):rn;for(dt=nn.length-1,tt=St-1;tt>=0;tt--){const qt=ht+tt,ae=O[qt],ch=qt+1<Z?O[qt+1].el:j;$e[tt]===0?v(null,ae,B,ch,Y,q,J,rt,et):Et&&(dt<0||tt!==nn[dt]?F(ae,B,ch,2):dt--)}}},F=(E,O,B,j,Y=null)=>{const{el:q,type:J,transition:rt,children:et,shapeFlag:tt}=E;if(tt&6){F(E.component.subTree,O,B,j);return}if(tt&128){E.suspense.move(O,B,j);return}if(tt&64){J.move(E,O,B,ot);return}if(J===Pe){i(q,O,B);for(let W=0;W<et.length;W++)F(et[W],O,B,j);i(E.anchor,O,B);return}if(J===cs){u(E,O,B);return}if(j!==2&&tt&1&&rt)if(j===0)rt.beforeEnter(q),i(q,O,B),te(()=>rt.enter(q),Y);else{const{leave:W,delayLeave:nt,afterLeave:at}=rt,ht=()=>i(q,O,B),gt=()=>{W(q,()=>{ht(),at&&at()})};nt?nt(q,ht,gt):gt()}else i(q,O,B)},H=(E,O,B,j=!1,Y=!1)=>{const{type:q,props:J,ref:rt,children:et,dynamicChildren:tt,shapeFlag:Z,patchFlag:W,dirs:nt,cacheIndex:at}=E;if(W===-2&&(Y=!1),rt!=null&&ts(rt,null,B,E,!0),at!=null&&(O.renderCache[at]=void 0),Z&256){O.ctx.deactivate(E);return}const ht=Z&1&&nt,gt=!Dn(E);let dt;if(gt&&(dt=J&&J.onVnodeBeforeUnmount)&&_e(dt,O,E),Z&6)st(E.component,B,j);else{if(Z&128){E.suspense.unmount(B,j);return}ht&&Ze(E,null,O,"beforeUnmount"),Z&64?E.type.remove(E,O,B,ot,j):tt&&!tt.hasOnce&&(q!==Pe||W>0&&W&64)?V(tt,O,B,!1,!0):(q===Pe&&W&384||!Y&&Z&16)&&V(et,O,B),j&&G(E)}(gt&&(dt=J&&J.onVnodeUnmounted)||ht)&&te(()=>{dt&&_e(dt,O,E),ht&&Ze(E,null,O,"unmounted")},B)},G=E=>{const{type:O,el:B,anchor:j,transition:Y}=E;if(O===Pe){Q(B,j);return}if(O===cs){_(E);return}const q=()=>{r(B),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(E.shapeFlag&1&&Y&&!Y.persisted){const{leave:J,delayLeave:rt}=Y,et=()=>J(B,q);rt?rt(E.el,q,et):et()}else q()},Q=(E,O)=>{let B;for(;E!==O;)B=g(E),r(E),E=B;r(O)},st=(E,O,B)=>{const{bum:j,scope:Y,job:q,subTree:J,um:rt,m:et,a:tt}=E;ca(et),ca(tt),j&&zi(j),Y.stop(),q&&(q.flags|=8,H(J,E,O,B)),rt&&te(rt,O),te(()=>{E.isUnmounted=!0},O),O&&O.pendingBranch&&!O.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===O.pendingId&&(O.deps--,O.deps===0&&O.resolve())},V=(E,O,B,j=!1,Y=!1,q=0)=>{for(let J=q;J<E.length;J++)H(E[J],O,B,j,Y)},A=E=>{if(E.shapeFlag&6)return A(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const O=g(E.anchor||E.el),B=O&&O[cu];return B?g(B):O};let $=!1;const it=(E,O,B)=>{E==null?O._vnode&&H(O._vnode,null,null,!0):v(O._vnode||null,E,O,null,null,null,B),O._vnode=E,$||($=!0,Fo(),Do(),$=!1)},ot={p:v,um:H,m:F,r:G,mt:U,mc:w,pc:P,pbc:T,n:A,o:t};return{render:it,hydrate:void 0,createApp:Au(it)}}function ls({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function qe({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Uu(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function aa(t,e,n=!1){const i=t.children,r=e.children;if(ut(i)&&ut(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=De(r[s]),a.el=o.el),!n&&a.patchFlag!==-2&&aa(o,a)),a.type===ir&&(a.el=o.el)}}function Bu(t){const e=t.slice(),n=[0];let i,r,s,o,a;const l=t.length;for(i=0;i<l;i++){const c=t[i];if(c!==0){if(r=n[n.length-1],t[r]<c){e[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,t[n[a]]<c?s=a+1:o=a;c<t[n[s]]&&(s>0&&(e[i]=n[s-1]),n[s]=i)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=e[o];return n}function la(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:la(e)}function ca(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const $u=Symbol.for("v-scx"),Vu=()=>er($u);function Ce(t,e,n){return ha(t,e,n)}function ha(t,e,n=wt){const{immediate:i,deep:r,flush:s,once:o}=n,a=zt({},n);let l;if(ar)if(s==="sync"){const g=Vu();l=g.__watcherHandles||(g.__watcherHandles=[])}else if(!e||i)a.once=!0;else{const g=()=>{};return g.stop=de,g.resume=de,g.pause=de,g}const c=jt;a.call=(g,f,p)=>ge(g,c,f,p);let h=!1;s==="post"?a.scheduler=g=>{te(g,c&&c.suspense)}:s!=="sync"&&(h=!0,a.scheduler=(g,f)=>{f?g():Xr(g)}),a.augmentJob=g=>{e&&(g.flags|=4),h&&(g.flags|=2,c&&(g.id=c.uid,g.i=c))};const d=tu(t,e,a);return l&&l.push(d),d}function Hu(t,e,n){const i=this.proxy,r=Ot(t)?t.includes(".")?ua(i,t):()=>i[t]:t.bind(i,i);let s;ft(e)?s=e:(s=e.handler,n=e);const o=$n(this),a=ha(r,s.bind(i),n);return o(),a}function ua(t,e){const n=e.split(".");return()=>{let i=t;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}const Wu=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${le(e)}Modifiers`]||t[`${ie(e)}Modifiers`];function ju(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||wt;let r=n;const s=e.startsWith("update:"),o=s&&Wu(i,e.slice(7));o&&(o.trim&&(r=n.map(h=>Ot(h)?h.trim():h)),o.number&&(r=n.map(Li)));let a,l=i[a=Mr(e)]||i[a=Mr(le(e))];!l&&s&&(l=i[a=Mr(ie(e))]),l&&ge(l,t,6,r);const c=i[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,ge(c,t,6,r)}}function da(t,e,n=!1){const i=e.emitsCache,r=i.get(t);if(r!==void 0)return r;const s=t.emits;let o={},a=!1;if(!ft(t)){const l=c=>{const h=da(c,e,!0);h&&(a=!0,zt(o,h))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!s&&!a?(Rt(t)&&i.set(t,null),null):(ut(s)?s.forEach(l=>o[l]=null):zt(o,s),Rt(t)&&i.set(t,o),o)}function nr(t,e){return!t||!Ii(e)?!1:(e=e.slice(2).replace(/Once$/,""),yt(t,e[0].toLowerCase()+e.slice(1))||yt(t,ie(e))||yt(t,e))}function _m(){}function fa(t){const{type:e,vnode:n,proxy:i,withProxy:r,propsOptions:[s],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:d,data:g,setupState:f,ctx:p,inheritAttrs:v}=t,S=Qi(t);let C,m;try{if(n.shapeFlag&4){const _=r||i,y=_;C=me(c.call(y,_,h,d,f,g,p)),m=a}else{const _=e;C=me(_.length>1?_(d,{attrs:a,slots:o,emit:l}):_(d,null)),m=e.props?a:Zu(a)}}catch(_){Gn.length=0,Yi(_,t,1),C=ue(Ke)}let u=C;if(m&&v!==!1){const _=Object.keys(m),{shapeFlag:y}=u;_.length&&y&7&&(s&&_.some(Rr)&&(m=qu(m,s)),u=dn(u,m,!1,!0))}return n.dirs&&(u=dn(u,null,!1,!0),u.dirs=u.dirs?u.dirs.concat(n.dirs):n.dirs),n.transition&&Qr(u,n.transition),C=u,Qi(S),C}const Zu=t=>{let e;for(const n in t)(n==="class"||n==="style"||Ii(n))&&((e||(e={}))[n]=t[n]);return e},qu=(t,e)=>{const n={};for(const i in t)(!Rr(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function Ku(t,e,n){const{props:i,children:r,component:s}=t,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?ga(i,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let d=0;d<h.length;d++){const g=h[d];if(o[g]!==i[g]&&!nr(c,g))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?ga(i,o,c):!0:!!o;return!1}function ga(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==t[s]&&!nr(n,s))return!0}return!1}function Yu({vnode:t,parent:e},n){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=n,e=e.parent;else break}}const pa=t=>t.__isSuspense;function Xu(t,e){e&&e.pendingBranch?ut(t)?e.effects.push(...t):e.effects.push(t):au(t)}const Pe=Symbol.for("v-fgt"),ir=Symbol.for("v-txt"),Ke=Symbol.for("v-cmt"),cs=Symbol.for("v-stc"),Gn=[];let ee=null;function Fe(t=!1){Gn.push(ee=t?null:[])}function Qu(){Gn.pop(),ee=Gn[Gn.length-1]||null}let Un=1;function ma(t){Un+=t,t<0&&ee&&(ee.hasOnce=!0)}function _a(t){return t.dynamicChildren=Un>0?ee||rn:null,Qu(),Un>0&&ee&&ee.push(t),t}function Ye(t,e,n,i,r,s){return _a(pt(t,e,n,i,r,s,!0))}function Ju(t,e,n,i,r){return _a(ue(t,e,n,i,r,!0))}function va(t){return t?t.__v_isVNode===!0:!1}function Bn(t,e){return t.type===e.type&&t.key===e.key}const ba=({key:t})=>t??null,rr=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Ot(t)||Gt(t)||ft(t)?{i:re,r:t,k:e,f:!!n}:t:null);function pt(t,e=null,n=null,i=0,r=null,s=t===Pe?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&ba(e),ref:e&&rr(e),scopeId:Lo,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:re};return a?(us(l,n),s&128&&t.normalize(l)):n&&(l.shapeFlag|=Ot(n)?8:16),Un>0&&!o&&ee&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&ee.push(l),l}const ue=td;function td(t,e=null,n=null,i=0,r=null,s=!1){if((!t||t===wu)&&(t=Ke),va(t)){const a=dn(t,e,!0);return n&&us(a,n),Un>0&&!s&&ee&&(a.shapeFlag&6?ee[ee.indexOf(t)]=a:ee.push(a)),a.patchFlag=-2,a}if(fd(t)&&(t=t.__vccOpts),e){e=ed(e);let{class:a,style:l}=e;a&&!Ot(a)&&(e.class=Ve(a)),Rt(l)&&(Zr(l)&&!ut(l)&&(l=zt({},l)),e.style=Ne(l))}const o=Ot(t)?1:pa(t)?128:hu(t)?64:Rt(t)?4:ft(t)?2:0;return pt(t,e,n,i,r,o,s,!0)}function ed(t){return t?Zr(t)||Jo(t)?zt({},t):t:null}function dn(t,e,n=!1,i=!1){const{props:r,ref:s,patchFlag:o,children:a,transition:l}=t,c=e?nd(r||{},e):r,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&ba(c),ref:e&&e.ref?n&&s?ut(s)?s.concat(rr(e)):[s,rr(e)]:rr(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Pe?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&dn(t.ssContent),ssFallback:t.ssFallback&&dn(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&i&&Qr(h,l.clone(h)),h}function hs(t=" ",e=0){return ue(ir,null,t,e)}function sr(t="",e=!1){return e?(Fe(),Ju(Ke,null,t)):ue(Ke,null,t)}function me(t){return t==null||typeof t=="boolean"?ue(Ke):ut(t)?ue(Pe,null,t.slice()):va(t)?De(t):ue(ir,null,String(t))}function De(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:dn(t)}function us(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(ut(e))n=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),us(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!Jo(e)?e._ctx=re:r===3&&re&&(re.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else ft(e)?(e={default:e,_ctx:re},n=32):(e=String(e),i&64?(n=16,e=[hs(e)]):n=8);t.children=e,t.shapeFlag|=n}function nd(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=Ve([e.class,i.class]));else if(r==="style")e.style=Ne([e.style,i.style]);else if(Ii(r)){const s=e[r],o=i[r];o&&s!==o&&!(ut(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function _e(t,e,n,i=null){ge(t,e,7,[n,i])}const id=Yo();let rd=0;function sd(t,e,n){const i=t.type,r=(e?e.appContext:t.appContext)||id,s={uid:rd++,vnode:t,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new xh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ea(i,r),emitsOptions:da(i,r),emit:null,emitted:null,propsDefaults:wt,inheritAttrs:i.inheritAttrs,ctx:wt,data:wt,props:wt,attrs:wt,slots:wt,refs:wt,setupState:wt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=ju.bind(null,s),t.ce&&t.ce(s),s}let jt=null,or,ds;{const t=no(),e=(n,i)=>{let r;return(r=t[n])||(r=t[n]=[]),r.push(i),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};or=e("__VUE_INSTANCE_SETTERS__",n=>jt=n),ds=e("__VUE_SSR_SETTERS__",n=>ar=n)}const $n=t=>{const e=jt;return or(t),t.scope.on(),()=>{t.scope.off(),or(e)}},ya=()=>{jt&&jt.scope.off(),or(null)};function Sa(t){return t.vnode.shapeFlag&4}let ar=!1;function od(t,e=!1,n=!1){e&&ds(e);const{props:i,children:r}=t.vnode,s=Sa(t);Mu(t,i,s,e),Du(t,r,n);const o=s?ad(t,e):void 0;return e&&ds(!1),o}function ad(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,xu);const{setup:i}=n;if(i){const r=t.setupContext=i.length>1?cd(t):null,s=$n(t);ve();const o=ln(i,t,0,[t.props,r]);if(be(),s(),Ys(o)){if(Dn(t)||Uo(t),o.then(ya,ya),e)return o.then(a=>{wa(t,a)}).catch(a=>{Yi(a,t,0)});t.asyncDep=o}else wa(t,o)}else xa(t)}function wa(t,e,n){ft(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Rt(e)&&(t.setupState=No(e)),xa(t)}function xa(t,e,n){const i=t.type;t.render||(t.render=i.render||de);{const r=$n(t);ve();try{Cu(t)}finally{be(),r()}}}const ld={get(t,e){return Ut(t,"get",""),t[e]}};function cd(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,ld),slots:t.slots,emit:t.emit,expose:e}}function lr(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(No(Zh(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in zn)return zn[n](t)},has(e,n){return n in e||n in zn}})):t.proxy}const hd=/(?:^|[-_])(\w)/g,ud=t=>t.replace(hd,e=>e.toUpperCase()).replace(/[-_]/g,"");function dd(t,e=!0){return ft(t)?t.displayName||t.name:t.name||e&&t.__name}function Ca(t,e,n=!1){let i=dd(e);if(!i&&e.__file){const r=e.__file.match(/([^/\\]+)\.\w+$/);r&&(i=r[1])}if(!i&&t&&t.parent){const r=s=>{for(const o in s)if(s[o]===e)return o};i=r(t.components||t.parent.type.components)||r(t.appContext.components)}return i?ud(i):n?"App":"Anonymous"}function fd(t){return ft(t)&&"__vccOpts"in t}const se=(t,e)=>Qh(t,e,ar),gd="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let fs;const Pa=typeof window<"u"&&window.trustedTypes;if(Pa)try{fs=Pa.createPolicy("vue",{createHTML:t=>t})}catch{}const Ta=fs?t=>fs.createHTML(t):t=>t,pd="http://www.w3.org/2000/svg",md="http://www.w3.org/1998/Math/MathML",Te=typeof document<"u"?document:null,ka=Te&&Te.createElement("template"),_d={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const r=e==="svg"?Te.createElementNS(pd,t):e==="mathml"?Te.createElementNS(md,t):n?Te.createElement(t,{is:n}):Te.createElement(t);return t==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:t=>Te.createTextNode(t),createComment:t=>Te.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Te.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,r,s){const o=n?n.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{ka.innerHTML=Ta(i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t);const a=ka.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},vd=Symbol("_vtc");function bd(t,e,n){const i=t[vd];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Ea=Symbol("_vod"),yd=Symbol("_vsh"),Sd=Symbol(""),wd=/(^|;)\s*display\s*:/;function xd(t,e,n){const i=t.style,r=Ot(n);let s=!1;if(n&&!r){if(e)if(Ot(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&cr(i,a,"")}else for(const o in e)n[o]==null&&cr(i,o,"");for(const o in n)o==="display"&&(s=!0),cr(i,o,n[o])}else if(r){if(e!==n){const o=i[Sd];o&&(n+=";"+o),i.cssText=n,s=wd.test(n)}}else e&&t.removeAttribute("style");Ea in t&&(t[Ea]=s?i.display:"",t[yd]&&(i.display="none"))}const Ra=/\s*!important$/;function cr(t,e,n){if(ut(n))n.forEach(i=>cr(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=Cd(t,e);Ra.test(n)?t.setProperty(ie(i),n.replace(Ra,""),"important"):t[i]=n}}const Aa=["Webkit","Moz","ms"],gs={};function Cd(t,e){const n=gs[e];if(n)return n;let i=le(e);if(i!=="filter"&&i in t)return gs[e]=i;i=Qs(i);for(let r=0;r<Aa.length;r++){const s=Aa[r]+i;if(s in t)return gs[e]=s}return e}const Na="http://www.w3.org/1999/xlink";function Ma(t,e,n,i,r,s=yh(e)){i&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Na,e.slice(6,e.length)):t.setAttributeNS(Na,e,n):n==null||s&&!io(n)?t.removeAttribute(e):t.setAttribute(e,s?"":fe(n)?String(n):n)}function Ia(t,e,n,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Ta(n):n);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const o=r==="OPTION"?t.getAttribute("value")||"":t.value,a=n==null?t.type==="checkbox"?"on":"":String(n);(o!==a||!("_value"in t))&&(t.value=a),n==null&&t.removeAttribute(e),t._value=n;return}let s=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=io(n):n==null&&o==="string"?(n="",s=!0):o==="number"&&(n=0,s=!0)}try{t[e]=n}catch{}s&&t.removeAttribute(e)}function Xe(t,e,n,i){t.addEventListener(e,n,i)}function Pd(t,e,n,i){t.removeEventListener(e,n,i)}const Oa=Symbol("_vei");function Td(t,e,n,i,r=null){const s=t[Oa]||(t[Oa]={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=kd(e);if(i){const c=s[e]=Ad(i,r);Xe(t,a,c,l)}else o&&(Pd(t,a,o,l),s[e]=void 0)}}const Fa=/(?:Once|Passive|Capture)$/;function kd(t){let e;if(Fa.test(t)){e={};let i;for(;i=t.match(Fa);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ie(t.slice(2)),e]}let ps=0;const Ed=Promise.resolve(),Rd=()=>ps||(Ed.then(()=>ps=0),ps=Date.now());function Ad(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;ge(Nd(i,n.value),e,5,[i])};return n.value=t,n.attached=Rd(),n}function Nd(t,e){if(ut(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const Da=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Md=(t,e,n,i,r,s)=>{const o=r==="svg";e==="class"?bd(t,i,o):e==="style"?xd(t,n,i):Ii(e)?Rr(e)||Td(t,e,n,i,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Id(t,e,i,o))?(Ia(t,e,i),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ma(t,e,i,o,s,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Ot(i))?Ia(t,le(e),i):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),Ma(t,e,i,o))};function Id(t,e,n,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&Da(e)&&ft(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Da(e)&&Ot(n)?!1:e in t}const za={};/*! #__NO_SIDE_EFFECTS__ */function Od(t,e,n){const i=Jr(t,e);Fi(i)&&zt(i,e);class r extends ms{constructor(o){super(i,o,n)}}return r.def=i,r}const Fd=typeof HTMLElement<"u"?HTMLElement:class{};class ms extends Fd{constructor(e,n={},i=$a){super(),this._def=e,this._props=n,this._createApp=i,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&i!==$a?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof ms){this._parent=e;break}this._instance||(this._resolved?(this._setParent(),this._update()):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._instance.provides=e._instance.provides)}disconnectedCallback(){this._connected=!1,Yr(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const r of i)this._setAttr(r.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(i,r=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:s,styles:o}=i;let a;if(s&&!ut(s))for(const l in s){const c=s[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=to(this._props[l])),(a||(a=Object.create(null)))[le(l)]=!0)}this._numberProps=a,r&&this._resolveProps(i),this.shadowRoot&&this._applyStyles(o),this._mount(i)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(i=>e(this._def=i,!0)):e(this._def)}_mount(e){this._app=this._createApp(e),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const i in n)yt(this,i)||Object.defineProperty(this,i,{get:()=>Ie(n[i])})}_resolveProps(e){const{props:n}=e,i=ut(n)?n:Object.keys(n||{});for(const r of Object.keys(this))r[0]!=="_"&&i.includes(r)&&this._setProp(r,this[r]);for(const r of i.map(le))Object.defineProperty(this,r,{get(){return this._getProp(r)},set(s){this._setProp(r,s,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const n=this.hasAttribute(e);let i=n?this.getAttribute(e):za;const r=le(e);n&&this._numberProps&&this._numberProps[r]&&(i=to(i)),this._setProp(r,i,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,n,i=!0,r=!1){n!==this._props[e]&&(n===za?delete this._props[e]:(this._props[e]=n,e==="key"&&this._app&&(this._app._ceVNode.key=n)),r&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(ie(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(ie(e),n+""):n||this.removeAttribute(ie(e))))}_update(){$d(this._createVNode(),this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const n=ue(this._def,zt(e,this._props));return this._instance||(n.ce=i=>{this._instance=i,i.ce=this,i.isCE=!0;const r=(s,o)=>{this.dispatchEvent(new CustomEvent(s,Fi(o[0])?zt({detail:o},o[0]):{detail:o}))};i.emit=(s,...o)=>{r(s,o),ie(s)!==s&&r(ie(s),o)},this._setParent()}),n}_applyStyles(e,n){if(!e)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const i=this._nonce;for(let r=e.length-1;r>=0;r--){const s=document.createElement("style");i&&s.setAttribute("nonce",i),s.textContent=e[r],this.shadowRoot.prepend(s)}}_parseSlots(){const e=this._slots={};let n;for(;n=this.firstChild;){const i=n.nodeType===1&&n.getAttribute("slot")||"default";(e[i]||(e[i]=[])).push(n),this.removeChild(n)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let i=0;i<e.length;i++){const r=e[i],s=r.getAttribute("name")||"default",o=this._slots[s],a=r.parentNode;if(o)for(const l of o){if(n&&l.nodeType===1){const c=n+"-s",h=document.createTreeWalker(l,1);l.setAttribute(c,"");let d;for(;d=h.nextNode();)d.setAttribute(c,"")}a.insertBefore(l,r)}else for(;r.firstChild;)a.insertBefore(r.firstChild,r);a.removeChild(r)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}const hr=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ut(e)?n=>zi(e,n):e};function Dd(t){t.target.composing=!0}function La(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const fn=Symbol("_assign"),zd={created(t,{modifiers:{lazy:e,trim:n,number:i}},r){t[fn]=hr(r);const s=i||r.props&&r.props.type==="number";Xe(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),s&&(a=Li(a)),t[fn](a)}),n&&Xe(t,"change",()=>{t.value=t.value.trim()}),e||(Xe(t,"compositionstart",Dd),Xe(t,"compositionend",La),Xe(t,"change",La))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:i,trim:r,number:s}},o){if(t[fn]=hr(o),t.composing)return;const a=(s||t.type==="number")&&!/^0\d/.test(t.value)?Li(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(i&&e===n||r&&t.value.trim()===l)||(t.value=l))}},Ld={deep:!0,created(t,{value:e,modifiers:{number:n}},i){const r=Oi(e);Xe(t,"change",()=>{const s=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Li(ur(o)):ur(o));t[fn](t.multiple?r?new Set(s):s:s[0]),t._assigning=!0,Yr(()=>{t._assigning=!1})}),t[fn]=hr(i)},mounted(t,{value:e}){Ga(t,e)},beforeUpdate(t,e,n){t[fn]=hr(n)},updated(t,{value:e}){t._assigning||Ga(t,e)}};function Ga(t,e){const n=t.multiple,i=ut(e);if(!(n&&!i&&!Oi(e))){for(let r=0,s=t.options.length;r<s;r++){const o=t.options[r],a=ur(o);if(n)if(i){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=wh(e,a)>-1}else o.selected=e.has(a);else if(Gi(ur(o),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function ur(t){return"_value"in t?t._value:t.value}const Gd=["ctrl","shift","alt","meta"],Ud={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Gd.some(n=>t[`${n}Key`]&&!e.includes(n))},ze=(t,e)=>{const n=t._withMods||(t._withMods={}),i=e.join(".");return n[i]||(n[i]=(r,...s)=>{for(let o=0;o<e.length;o++){const a=Ud[e[o]];if(a&&a(r,e))return}return t(r,...s)})},Bd=zt({patchProp:Md},_d);let Ua;function Ba(){return Ua||(Ua=Lu(Bd))}const $d=(...t)=>{Ba().render(...t)},$a=(...t)=>{const e=Ba().createApp(...t),{mount:n}=e;return e.mount=i=>{const r=Hd(i);if(!r)return;const s=e._component;!ft(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,Vd(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function Vd(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Hd(t){return Ot(t)?document.querySelector(t):t}var Va=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dr={exports:{}},Vn={},_s={},vs={},Ha;function mt(){return Ha||(Ha=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Va<"u"?Va:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.21",isBrowser:n(),isUnminified:/param/.test(function(r){}.toString()),dblClickWindow:400,getAngle(r){return t.Konva.angleDeg?r*e:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var r;return(r=t.Konva.Transformer)===null||r===void 0?void 0:r.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(r){t.glob.Konva=r}};const i=r=>{t.Konva[r.prototype.getClassName()]=r};t._registerNode=i,t.Konva._injectGlobal(t.Konva)}(vs)),vs}var bs={},Wa;function It(){return Wa||(Wa=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=mt();class n{constructor(_=[1,0,0,1,0,0]){this.dirty=!1,this.m=_&&_.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(_){_.m[0]=this.m[0],_.m[1]=this.m[1],_.m[2]=this.m[2],_.m[3]=this.m[3],_.m[4]=this.m[4],_.m[5]=this.m[5]}point(_){const y=this.m;return{x:y[0]*_.x+y[2]*_.y+y[4],y:y[1]*_.x+y[3]*_.y+y[5]}}translate(_,y){return this.m[4]+=this.m[0]*_+this.m[2]*y,this.m[5]+=this.m[1]*_+this.m[3]*y,this}scale(_,y){return this.m[0]*=_,this.m[1]*=_,this.m[2]*=y,this.m[3]*=y,this}rotate(_){const y=Math.cos(_),k=Math.sin(_),I=this.m[0]*y+this.m[2]*k,w=this.m[1]*y+this.m[3]*k,x=this.m[0]*-k+this.m[2]*y,T=this.m[1]*-k+this.m[3]*y;return this.m[0]=I,this.m[1]=w,this.m[2]=x,this.m[3]=T,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(_,y){const k=this.m[0]+this.m[2]*y,I=this.m[1]+this.m[3]*y,w=this.m[2]+this.m[0]*_,x=this.m[3]+this.m[1]*_;return this.m[0]=k,this.m[1]=I,this.m[2]=w,this.m[3]=x,this}multiply(_){const y=this.m[0]*_.m[0]+this.m[2]*_.m[1],k=this.m[1]*_.m[0]+this.m[3]*_.m[1],I=this.m[0]*_.m[2]+this.m[2]*_.m[3],w=this.m[1]*_.m[2]+this.m[3]*_.m[3],x=this.m[0]*_.m[4]+this.m[2]*_.m[5]+this.m[4],T=this.m[1]*_.m[4]+this.m[3]*_.m[5]+this.m[5];return this.m[0]=y,this.m[1]=k,this.m[2]=I,this.m[3]=w,this.m[4]=x,this.m[5]=T,this}invert(){const _=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),y=this.m[3]*_,k=-this.m[1]*_,I=-this.m[2]*_,w=this.m[0]*_,x=_*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),T=_*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=y,this.m[1]=k,this.m[2]=I,this.m[3]=w,this.m[4]=x,this.m[5]=T,this}getMatrix(){return this.m}decompose(){const _=this.m[0],y=this.m[1],k=this.m[2],I=this.m[3],w=this.m[4],x=this.m[5],T=_*I-y*k,N={x:w,y:x,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(_!=0||y!=0){const D=Math.sqrt(_*_+y*y);N.rotation=y>0?Math.acos(_/D):-Math.acos(_/D),N.scaleX=D,N.scaleY=T/D,N.skewX=(_*k+y*I)/T,N.skewY=0}else if(k!=0||I!=0){const D=Math.sqrt(k*k+I*I);N.rotation=Math.PI/2-(I>0?Math.acos(-k/D):-Math.acos(k/D)),N.scaleX=T/D,N.scaleY=D,N.skewX=0,N.skewY=(_*k+y*I)/T}return N.rotation=t.Util._getRotation(N.rotation),N}}t.Transform=n;const i="[object Array]",r="[object Number]",s="[object String]",o="[object Boolean]",a=Math.PI/180,l=180/Math.PI,c="#",h="",d="0",g="Konva warning: ",f="Konva error: ",p="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const m=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(u){setTimeout(u,60)};t.Util={_isElement(u){return!!(u&&u.nodeType==1)},_isFunction(u){return!!(u&&u.constructor&&u.call&&u.apply)},_isPlainObject(u){return!!u&&u.constructor===Object},_isArray(u){return Object.prototype.toString.call(u)===i},_isNumber(u){return Object.prototype.toString.call(u)===r&&!isNaN(u)&&isFinite(u)},_isString(u){return Object.prototype.toString.call(u)===s},_isBoolean(u){return Object.prototype.toString.call(u)===o},isObject(u){return u instanceof Object},isValidSelector(u){if(typeof u!="string")return!1;const _=u[0];return _==="#"||_==="."||_===_.toUpperCase()},_sign(u){return u===0||u>0?1:-1},requestAnimFrame(u){C.push(u),C.length===1&&m(function(){const _=C;C=[],_.forEach(function(y){y()})})},createCanvasElement(){const u=document.createElement("canvas");try{u.style=u.style||{}}catch{}return u},createImageElement(){return document.createElement("img")},_isInDocument(u){for(;u=u.parentNode;)if(u==document)return!0;return!1},_urlToImage(u,_){const y=t.Util.createImageElement();y.onload=function(){_(y)},y.src=u},_rgbToHex(u,_,y){return(16777216+(u<<16)+(_<<8)+y).toString(16).slice(1)},_hexToRgb(u){u=u.replace(c,h);const _=parseInt(u,16);return{r:_>>16&255,g:_>>8&255,b:_&255}},getRandomColor(){let u=(Math.random()*16777215<<0).toString(16);for(;u.length<6;)u=d+u;return c+u},getRGB(u){let _;return u in v?(_=v[u],{r:_[0],g:_[1],b:_[2]}):u[0]===c?this._hexToRgb(u.substring(1)):u.substr(0,4)===p?(_=S.exec(u.replace(/ /g,"")),{r:parseInt(_[1],10),g:parseInt(_[2],10),b:parseInt(_[3],10)}):{r:0,g:0,b:0}},colorToRGBA(u){return u=u||"black",t.Util._namedColorToRBA(u)||t.Util._hex3ColorToRGBA(u)||t.Util._hex4ColorToRGBA(u)||t.Util._hex6ColorToRGBA(u)||t.Util._hex8ColorToRGBA(u)||t.Util._rgbColorToRGBA(u)||t.Util._rgbaColorToRGBA(u)||t.Util._hslColorToRGBA(u)},_namedColorToRBA(u){const _=v[u.toLowerCase()];return _?{r:_[0],g:_[1],b:_[2],a:1}:null},_rgbColorToRGBA(u){if(u.indexOf("rgb(")===0){u=u.match(/rgb\(([^)]+)\)/)[1];const _=u.split(/ *, */).map(Number);return{r:_[0],g:_[1],b:_[2],a:1}}},_rgbaColorToRGBA(u){if(u.indexOf("rgba(")===0){u=u.match(/rgba\(([^)]+)\)/)[1];const _=u.split(/ *, */).map((y,k)=>y.slice(-1)==="%"?k===3?parseInt(y)/100:parseInt(y)/100*255:Number(y));return{r:_[0],g:_[1],b:_[2],a:_[3]}}},_hex8ColorToRGBA(u){if(u[0]==="#"&&u.length===9)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:parseInt(u.slice(7,9),16)/255}},_hex6ColorToRGBA(u){if(u[0]==="#"&&u.length===7)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:1}},_hex4ColorToRGBA(u){if(u[0]==="#"&&u.length===5)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:parseInt(u[4]+u[4],16)/255}},_hex3ColorToRGBA(u){if(u[0]==="#"&&u.length===4)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:1}},_hslColorToRGBA(u){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(u)){const[_,...y]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(u),k=Number(y[0])/360,I=Number(y[1])/100,w=Number(y[2])/100;let x,T,N;if(I===0)return N=w*255,{r:Math.round(N),g:Math.round(N),b:Math.round(N),a:1};w<.5?x=w*(1+I):x=w+I-w*I;const D=2*w-x,L=[0,0,0];for(let U=0;U<3;U++)T=k+.3333333333333333*-(U-1),T<0&&T++,T>1&&T--,6*T<1?N=D+(x-D)*6*T:2*T<1?N=x:3*T<2?N=D+(x-D)*(.6666666666666666-T)*6:N=D,L[U]=N*255;return{r:Math.round(L[0]),g:Math.round(L[1]),b:Math.round(L[2]),a:1}}},haveIntersection(u,_){return!(_.x>u.x+u.width||_.x+_.width<u.x||_.y>u.y+u.height||_.y+_.height<u.y)},cloneObject(u){const _={};for(const y in u)this._isPlainObject(u[y])?_[y]=this.cloneObject(u[y]):this._isArray(u[y])?_[y]=this.cloneArray(u[y]):_[y]=u[y];return _},cloneArray(u){return u.slice(0)},degToRad(u){return u*a},radToDeg(u){return u*l},_degToRad(u){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(u)},_radToDeg(u){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(u)},_getRotation(u){return e.Konva.angleDeg?t.Util.radToDeg(u):u},_capitalize(u){return u.charAt(0).toUpperCase()+u.slice(1)},throw(u){throw new Error(f+u)},error(u){console.error(f+u)},warn(u){e.Konva.showWarnings&&console.warn(g+u)},each(u,_){for(const y in u)_(y,u[y])},_inRange(u,_,y){return _<=u&&u<y},_getProjectionToSegment(u,_,y,k,I,w){let x,T,N;const D=(u-y)*(u-y)+(_-k)*(_-k);if(D==0)x=u,T=_,N=(I-y)*(I-y)+(w-k)*(w-k);else{const L=((I-u)*(y-u)+(w-_)*(k-_))/D;L<0?(x=u,T=_,N=(u-I)*(u-I)+(_-w)*(_-w)):L>1?(x=y,T=k,N=(y-I)*(y-I)+(k-w)*(k-w)):(x=u+L*(y-u),T=_+L*(k-_),N=(x-I)*(x-I)+(T-w)*(T-w))}return[x,T,N]},_getProjectionToLine(u,_,y){const k=t.Util.cloneObject(u);let I=Number.MAX_VALUE;return _.forEach(function(w,x){if(!y&&x===_.length-1)return;const T=_[(x+1)%_.length],N=t.Util._getProjectionToSegment(w.x,w.y,T.x,T.y,u.x,u.y),D=N[0],L=N[1],U=N[2];U<I&&(k.x=D,k.y=L,I=U)}),k},_prepareArrayForTween(u,_,y){const k=[],I=[];if(u.length>_.length){const x=_;_=u,u=x}for(let x=0;x<u.length;x+=2)k.push({x:u[x],y:u[x+1]});for(let x=0;x<_.length;x+=2)I.push({x:_[x],y:_[x+1]});const w=[];return I.forEach(function(x){const T=t.Util._getProjectionToLine(x,k,y);w.push(T.x),w.push(T.y)}),w},_prepareToStringify(u){let _;u.visitedByCircularReferenceRemoval=!0;for(const y in u)if(u.hasOwnProperty(y)&&u[y]&&typeof u[y]=="object"){if(_=Object.getOwnPropertyDescriptor(u,y),u[y].visitedByCircularReferenceRemoval||t.Util._isElement(u[y]))if(_.configurable)delete u[y];else return null;else if(t.Util._prepareToStringify(u[y])===null)if(_.configurable)delete u[y];else return null}return delete u.visitedByCircularReferenceRemoval,u},_assign(u,_){for(const y in _)u[y]=_[y];return u},_getFirstPointerId(u){return u.touches?u.changedTouches[0].identifier:u.pointerId||999},releaseCanvas(...u){e.Konva.releaseCanvasOnDestroy&&u.forEach(_=>{_.width=0,_.height=0})},drawRoundedRectPath(u,_,y,k){let I=0,w=0,x=0,T=0;typeof k=="number"?I=w=x=T=Math.min(k,_/2,y/2):(I=Math.min(k[0]||0,_/2,y/2),w=Math.min(k[1]||0,_/2,y/2),T=Math.min(k[2]||0,_/2,y/2),x=Math.min(k[3]||0,_/2,y/2)),u.moveTo(I,0),u.lineTo(_-w,0),u.arc(_-w,w,w,Math.PI*3/2,0,!1),u.lineTo(_,y-T),u.arc(_-T,y-T,T,0,Math.PI/2,!1),u.lineTo(x,y),u.arc(x,y-x,x,Math.PI/2,Math.PI,!1),u.lineTo(0,I),u.arc(I,I,I,Math.PI,Math.PI*3/2,!1)}}}(bs)),bs}var Hn={},ke={},Ee={},ja;function Za(){if(ja)return Ee;ja=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.HitContext=Ee.SceneContext=Ee.Context=void 0;const t=It(),e=mt();function n(C){const m=[],u=C.length,_=t.Util;for(let y=0;y<u;y++){let k=C[y];_._isNumber(k)?k=Math.round(k*1e3)/1e3:_._isString(k)||(k=k+""),m.push(k)}return m}const i=",",r="(",s=")",o="([",a="])",l=";",c="()",h="=",d=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],f=100;let p=class{constructor(m){this.canvas=m,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(m){m.fillEnabled()&&this._fill(m)}_fill(m){}strokeShape(m){m.hasStroke()&&this._stroke(m)}_stroke(m){}fillStrokeShape(m){m.attrs.fillAfterStrokeEnabled?(this.strokeShape(m),this.fillShape(m)):(this.fillShape(m),this.strokeShape(m))}getTrace(m,u){let _=this.traceArr,y=_.length,k="",I,w,x,T;for(I=0;I<y;I++)w=_[I],x=w.method,x?(T=w.args,k+=x,m?k+=c:t.Util._isArray(T[0])?k+=o+T.join(i)+a:(u&&(T=T.map(N=>typeof N=="number"?Math.floor(N):N)),k+=r+T.join(i)+s)):(k+=w.property,m||(k+=h+w.val)),k+=l;return k}clearTrace(){this.traceArr=[]}_trace(m){let u=this.traceArr,_;u.push(m),_=u.length,_>=f&&u.shift()}reset(){const m=this.getCanvas().getPixelRatio();this.setTransform(1*m,0,0,1*m,0,0)}getCanvas(){return this.canvas}clear(m){const u=this.getCanvas();m?this.clearRect(m.x||0,m.y||0,m.width||0,m.height||0):this.clearRect(0,0,u.getWidth()/u.pixelRatio,u.getHeight()/u.pixelRatio)}_applyLineCap(m){const u=m.attrs.lineCap;u&&this.setAttr("lineCap",u)}_applyOpacity(m){const u=m.getAbsoluteOpacity();u!==1&&this.setAttr("globalAlpha",u)}_applyLineJoin(m){const u=m.attrs.lineJoin;u&&this.setAttr("lineJoin",u)}setAttr(m,u){this._context[m]=u}arc(m,u,_,y,k,I){this._context.arc(m,u,_,y,k,I)}arcTo(m,u,_,y,k){this._context.arcTo(m,u,_,y,k)}beginPath(){this._context.beginPath()}bezierCurveTo(m,u,_,y,k,I){this._context.bezierCurveTo(m,u,_,y,k,I)}clearRect(m,u,_,y){this._context.clearRect(m,u,_,y)}clip(...m){this._context.clip.apply(this._context,m)}closePath(){this._context.closePath()}createImageData(m,u){const _=arguments;if(_.length===2)return this._context.createImageData(m,u);if(_.length===1)return this._context.createImageData(m)}createLinearGradient(m,u,_,y){return this._context.createLinearGradient(m,u,_,y)}createPattern(m,u){return this._context.createPattern(m,u)}createRadialGradient(m,u,_,y,k,I){return this._context.createRadialGradient(m,u,_,y,k,I)}drawImage(m,u,_,y,k,I,w,x,T){const N=arguments,D=this._context;N.length===3?D.drawImage(m,u,_):N.length===5?D.drawImage(m,u,_,y,k):N.length===9&&D.drawImage(m,u,_,y,k,I,w,x,T)}ellipse(m,u,_,y,k,I,w,x){this._context.ellipse(m,u,_,y,k,I,w,x)}isPointInPath(m,u,_,y){return _?this._context.isPointInPath(_,m,u,y):this._context.isPointInPath(m,u,y)}fill(...m){this._context.fill.apply(this._context,m)}fillRect(m,u,_,y){this._context.fillRect(m,u,_,y)}strokeRect(m,u,_,y){this._context.strokeRect(m,u,_,y)}fillText(m,u,_,y){y?this._context.fillText(m,u,_,y):this._context.fillText(m,u,_)}measureText(m){return this._context.measureText(m)}getImageData(m,u,_,y){return this._context.getImageData(m,u,_,y)}lineTo(m,u){this._context.lineTo(m,u)}moveTo(m,u){this._context.moveTo(m,u)}rect(m,u,_,y){this._context.rect(m,u,_,y)}roundRect(m,u,_,y,k){this._context.roundRect(m,u,_,y,k)}putImageData(m,u,_){this._context.putImageData(m,u,_)}quadraticCurveTo(m,u,_,y){this._context.quadraticCurveTo(m,u,_,y)}restore(){this._context.restore()}rotate(m){this._context.rotate(m)}save(){this._context.save()}scale(m,u){this._context.scale(m,u)}setLineDash(m){this._context.setLineDash?this._context.setLineDash(m):"mozDash"in this._context?this._context.mozDash=m:"webkitLineDash"in this._context&&(this._context.webkitLineDash=m)}getLineDash(){return this._context.getLineDash()}setTransform(m,u,_,y,k,I){this._context.setTransform(m,u,_,y,k,I)}stroke(m){m?this._context.stroke(m):this._context.stroke()}strokeText(m,u,_,y){this._context.strokeText(m,u,_,y)}transform(m,u,_,y,k,I){this._context.transform(m,u,_,y,k,I)}translate(m,u){this._context.translate(m,u)}_enableTrace(){let m=this,u=d.length,_=this.setAttr,y,k;const I=function(w){let x=m[w],T;m[w]=function(){return k=n(Array.prototype.slice.call(arguments,0)),T=x.apply(m,arguments),m._trace({method:w,args:k}),T}};for(y=0;y<u;y++)I(d[y]);m.setAttr=function(){_.apply(m,arguments);const w=arguments[0];let x=arguments[1];(w==="shadowOffsetX"||w==="shadowOffsetY"||w==="shadowBlur")&&(x=x/this.canvas.getPixelRatio()),m._trace({property:w,val:x})}}_applyGlobalCompositeOperation(m){const u=m.attrs.globalCompositeOperation;!u||u==="source-over"||this.setAttr("globalCompositeOperation",u)}};Ee.Context=p,g.forEach(function(C){Object.defineProperty(p.prototype,C,{get(){return this._context[C]},set(m){this._context[C]=m}})});class v extends p{constructor(m,{willReadFrequently:u=!1}={}){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:u})}_fillColor(m){const u=m.fill();this.setAttr("fillStyle",u),m._fillFunc(this)}_fillPattern(m){this.setAttr("fillStyle",m._getFillPattern()),m._fillFunc(this)}_fillLinearGradient(m){const u=m._getLinearGradient();u&&(this.setAttr("fillStyle",u),m._fillFunc(this))}_fillRadialGradient(m){const u=m._getRadialGradient();u&&(this.setAttr("fillStyle",u),m._fillFunc(this))}_fill(m){const u=m.fill(),_=m.getFillPriority();if(u&&_==="color"){this._fillColor(m);return}const y=m.getFillPatternImage();if(y&&_==="pattern"){this._fillPattern(m);return}const k=m.getFillLinearGradientColorStops();if(k&&_==="linear-gradient"){this._fillLinearGradient(m);return}const I=m.getFillRadialGradientColorStops();if(I&&_==="radial-gradient"){this._fillRadialGradient(m);return}u?this._fillColor(m):y?this._fillPattern(m):k?this._fillLinearGradient(m):I&&this._fillRadialGradient(m)}_strokeLinearGradient(m){const u=m.getStrokeLinearGradientStartPoint(),_=m.getStrokeLinearGradientEndPoint(),y=m.getStrokeLinearGradientColorStops(),k=this.createLinearGradient(u.x,u.y,_.x,_.y);if(y){for(let I=0;I<y.length;I+=2)k.addColorStop(y[I],y[I+1]);this.setAttr("strokeStyle",k)}}_stroke(m){const u=m.dash(),_=m.getStrokeScaleEnabled();if(m.hasStroke()){if(!_){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(m),u&&m.dashEnabled()&&(this.setLineDash(u),this.setAttr("lineDashOffset",m.dashOffset())),this.setAttr("lineWidth",m.strokeWidth()),m.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),m.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(m):this.setAttr("strokeStyle",m.stroke()),m._strokeFunc(this),_||this.restore()}}_applyShadow(m){var u,_,y;const k=(u=m.getShadowRGBA())!==null&&u!==void 0?u:"black",I=(_=m.getShadowBlur())!==null&&_!==void 0?_:5,w=(y=m.getShadowOffset())!==null&&y!==void 0?y:{x:0,y:0},x=m.getAbsoluteScale(),T=this.canvas.getPixelRatio(),N=x.x*T,D=x.y*T;this.setAttr("shadowColor",k),this.setAttr("shadowBlur",I*Math.min(Math.abs(N),Math.abs(D))),this.setAttr("shadowOffsetX",w.x*N),this.setAttr("shadowOffsetY",w.y*D)}}Ee.SceneContext=v;class S extends p{constructor(m){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:!0})}_fill(m){this.save(),this.setAttr("fillStyle",m.colorKey),m._fillFuncHit(this),this.restore()}strokeShape(m){m.hasHitStroke()&&this._stroke(m)}_stroke(m){if(m.hasHitStroke()){const u=m.getStrokeScaleEnabled();if(!u){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(m);const _=m.hitStrokeWidth(),y=_==="auto"?m.strokeWidth():_;this.setAttr("lineWidth",y),this.setAttr("strokeStyle",m.colorKey),m._strokeFuncHit(this),u||this.restore()}}}return Ee.HitContext=S,Ee}var qa;function fr(){if(qa)return ke;qa=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.HitCanvas=ke.SceneCanvas=ke.Canvas=void 0;const t=It(),e=Za(),n=mt();let i;function r(){if(i)return i;const l=t.Util.createCanvasElement(),c=l.getContext("2d");return i=function(){const h=n.Konva._global.devicePixelRatio||1,d=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;return h/d}(),t.Util.releaseCanvas(l),i}let s=class{constructor(c){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const d=(c||{}).pixelRatio||n.Konva.pixelRatio||r();this.pixelRatio=d,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(c){const h=this.pixelRatio;this.pixelRatio=c,this.setSize(this.getWidth()/h,this.getHeight()/h)}setWidth(c){this.width=this._canvas.width=c*this.pixelRatio,this._canvas.style.width=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}setHeight(c){this.height=this._canvas.height=c*this.pixelRatio,this._canvas.style.height=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}getWidth(){return this.width}getHeight(){return this.height}setSize(c,h){this.setWidth(c||0),this.setHeight(h||0)}toDataURL(c,h){try{return this._canvas.toDataURL(c,h)}catch{try{return this._canvas.toDataURL()}catch(g){return t.Util.error("Unable to get data URL. "+g.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};ke.Canvas=s;class o extends s{constructor(c={width:0,height:0,willReadFrequently:!1}){super(c),this.context=new e.SceneContext(this,{willReadFrequently:c.willReadFrequently}),this.setSize(c.width,c.height)}}ke.SceneCanvas=o;class a extends s{constructor(c={width:0,height:0}){super(c),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(c.width,c.height)}}return ke.HitCanvas=a,ke}var ys={},Ka;function Ss(){return Ka||(Ka=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=mt(),n=It();t.DD={get isDragging(){let i=!1;return t.DD._dragElements.forEach(r=>{r.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return t.DD._dragElements.forEach(r=>{i=r.node}),i},_dragElements:new Map,_drag(i){const r=[];t.DD._dragElements.forEach((s,o)=>{const{node:a}=s,l=a.getStage();l.setPointersPositions(i),s.pointerId===void 0&&(s.pointerId=n.Util._getFirstPointerId(i));const c=l._changedPointerPositions.find(h=>h.id===s.pointerId);if(c){if(s.dragStatus!=="dragging"){const h=a.dragDistance();if(Math.max(Math.abs(c.x-s.startPointerPos.x),Math.abs(c.y-s.startPointerPos.y))<h||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,s),r.push(a)}}),r.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:i},!0)})},_endDragBefore(i){const r=[];t.DD._dragElements.forEach(s=>{const{node:o}=s,a=o.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(h=>h.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const c=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;c&&r.indexOf(c)===-1&&r.push(c)}),r.forEach(s=>{s.draw()})},_endDragAfter(i){t.DD._dragElements.forEach((r,s)=>{r.dragStatus==="stopped"&&r.node.fire("dragend",{type:"dragend",target:r.node,evt:i},!0),r.dragStatus!=="dragging"&&t.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))}(ys)),ys}var ws={},Kt={},Ya;function vt(){if(Ya)return Kt;Ya=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.RGBComponent=i,Kt.alphaComponent=r,Kt.getNumberValidator=s,Kt.getNumberOrArrayOfNumbersValidator=o,Kt.getNumberOrAutoValidator=a,Kt.getStringValidator=l,Kt.getStringOrGradientValidator=c,Kt.getFunctionValidator=h,Kt.getNumberArrayValidator=d,Kt.getBooleanValidator=g,Kt.getComponentValidator=f;const t=mt(),e=It();function n(p){return e.Util._isString(p)?'"'+p+'"':Object.prototype.toString.call(p)==="[object Number]"||e.Util._isBoolean(p)?p:Object.prototype.toString.call(p)}function i(p){return p>255?255:p<0?0:Math.round(p)}function r(p){return p>1?1:p<1e-4?1e-4:p}function s(){if(t.Konva.isUnminified)return function(p,v){return e.Util._isNumber(p)||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a number.'),p}}function o(p){if(t.Konva.isUnminified)return function(v,S){let C=e.Util._isNumber(v),m=e.Util._isArray(v)&&v.length==p;return!C&&!m&&e.Util.warn(n(v)+' is a not valid value for "'+S+'" attribute. The value should be a number or Array<number>('+p+")"),v}}function a(){if(t.Konva.isUnminified)return function(p,v){return e.Util._isNumber(p)||p==="auto"||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a number or "auto".'),p}}function l(){if(t.Konva.isUnminified)return function(p,v){return e.Util._isString(p)||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a string.'),p}}function c(){if(t.Konva.isUnminified)return function(p,v){const S=e.Util._isString(p),C=Object.prototype.toString.call(p)==="[object CanvasGradient]"||p&&p.addColorStop;return S||C||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a string or a native gradient.'),p}}function h(){if(t.Konva.isUnminified)return function(p,v){return e.Util._isFunction(p)||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a function.'),p}}function d(){if(t.Konva.isUnminified)return function(p,v){const S=Int8Array?Object.getPrototypeOf(Int8Array):null;return S&&p instanceof S||(e.Util._isArray(p)?p.forEach(function(C){e.Util._isNumber(C)||e.Util.warn('"'+v+'" attribute has non numeric element '+C+". Make sure that all elements are numbers.")}):e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a array of numbers.')),p}}function g(){if(t.Konva.isUnminified)return function(p,v){return p===!0||p===!1||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a boolean.'),p}}function f(p){if(t.Konva.isUnminified)return function(v,S){return v==null||e.Util.isObject(v)||e.Util.warn(n(v)+' is a not valid value for "'+S+'" attribute. The value should be an object with properties '+p),v}}return Kt}var Xa;function _t(){return Xa||(Xa=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=It(),n=vt(),i="get",r="set";t.Factory={addGetterSetter(s,o,a,l,c){t.Factory.addGetter(s,o,a),t.Factory.addSetter(s,o,l,c),t.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,a){const l=i+e.Util._capitalize(o);s.prototype[l]=s.prototype[l]||function(){const c=this.attrs[o];return c===void 0?a:c}},addSetter(s,o,a,l){const c=r+e.Util._capitalize(o);s.prototype[c]||t.Factory.overWriteSetter(s,o,a,l)},overWriteSetter(s,o,a,l){const c=r+e.Util._capitalize(o);s.prototype[c]=function(h){return a&&h!==void 0&&h!==null&&(h=a.call(this,h,o)),this._setAttr(o,h),l&&l.call(this),this}},addComponentsGetterSetter(s,o,a,l,c){const h=a.length,d=e.Util._capitalize,g=i+d(o),f=r+d(o);s.prototype[g]=function(){const v={};for(let S=0;S<h;S++){const C=a[S];v[C]=this.getAttr(o+d(C))}return v};const p=(0,n.getComponentValidator)(a);s.prototype[f]=function(v){const S=this.attrs[o];l&&(v=l.call(this,v,o)),p&&p.call(this,v,o);for(const C in v)v.hasOwnProperty(C)&&this._setAttr(o+d(C),v[C]);return v||a.forEach(C=>{this._setAttr(o+d(C),void 0)}),this._fireChangeEvent(o,S,v),c&&c.call(this),this},t.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const a=e.Util._capitalize(o),l=r+a,c=i+a;s.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(s,o,a,l){e.Util.error("Adding deprecated "+o);const c=i+e.Util._capitalize(o),h=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[c]=function(){e.Util.error(h);const d=this.attrs[o];return d===void 0?a:d},t.Factory.addSetter(s,o,l,function(){e.Util.error(h)}),t.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(a,l){const c=s.prototype[l],h=i+e.Util._capitalize(a),d=r+e.Util._capitalize(a);function g(){c.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}s.prototype[a]=g,s.prototype[h]=g,s.prototype[d]=g})},afterSetFilter(){this._filterUpToDate=!1}}}(ws)),ws}var Qa;function Ft(){if(Qa)return Hn;Qa=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.Node=void 0;const t=fr(),e=Ss(),n=_t(),i=mt(),r=It(),s=vt(),o="absoluteOpacity",a="allEventListeners",l="absoluteTransform",c="absoluteScale",h="canvas",d="Change",g="children",f="konva",p="listening",v="mouseenter",S="mouseleave",C="pointerenter",m="pointerleave",u="touchenter",_="touchleave",y="set",k="Shape",I=" ",w="stage",x="transform",T="Stage",N="visible",D=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(I);let L=1,U=class qs{constructor(b){this._id=L++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(b),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(b){(b===x||b===l)&&this._cache.get(b)?this._cache.get(b).dirty=!0:b?this._cache.delete(b):this._cache.clear()}_getCache(b,P){let M=this._cache.get(b);return(M===void 0||(b===x||b===l)&&M.dirty===!0)&&(M=P.call(this),this._cache.set(b,M)),M}_calculate(b,P,M){if(!this._attachedDepsListeners.get(b)){const R=P.map(F=>F+"Change.konva").join(I);this.on(R,()=>{this._clearCache(b)}),this._attachedDepsListeners.set(b,!0)}return this._getCache(b,M)}_getCanvasCache(){return this._cache.get(h)}_clearSelfAndDescendantCache(b){this._clearCache(b),b===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(h)){const{scene:b,filter:P,hit:M,buffer:R}=this._cache.get(h);r.Util.releaseCanvas(b,P,M,R),this._cache.delete(h)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(b){const P=b||{};let M={};(P.x===void 0||P.y===void 0||P.width===void 0||P.height===void 0)&&(M=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let R=Math.ceil(P.width||M.width),F=Math.ceil(P.height||M.height),H=P.pixelRatio,G=P.x===void 0?Math.floor(M.x):P.x,Q=P.y===void 0?Math.floor(M.y):P.y,st=P.offset||0,V=P.drawBorder||!1,A=P.hitCanvasPixelRatio||1;if(!R||!F){r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const $=Math.abs(Math.round(M.x)-G)>.5?1:0,it=Math.abs(Math.round(M.y)-Q)>.5?1:0;R+=st*2+$,F+=st*2+it,G-=st,Q-=st;const ot=new t.SceneCanvas({pixelRatio:H,width:R,height:F}),lt=new t.SceneCanvas({pixelRatio:H,width:0,height:0,willReadFrequently:!0}),E=new t.HitCanvas({pixelRatio:A,width:R,height:F}),O=ot.getContext(),B=E.getContext(),j=new t.SceneCanvas({width:ot.width/ot.pixelRatio+Math.abs(G),height:ot.height/ot.pixelRatio+Math.abs(Q),pixelRatio:ot.pixelRatio}),Y=j.getContext();return E.isCache=!0,ot.isCache=!0,this._cache.delete(h),this._filterUpToDate=!1,P.imageSmoothingEnabled===!1&&(ot.getContext()._context.imageSmoothingEnabled=!1,lt.getContext()._context.imageSmoothingEnabled=!1),O.save(),B.save(),Y.save(),O.translate(-G,-Q),B.translate(-G,-Q),Y.translate(-G,-Q),j.x=G,j.y=Q,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this.drawScene(ot,this,j),this.drawHit(E,this),this._isUnderCache=!1,O.restore(),B.restore(),V&&(O.save(),O.beginPath(),O.rect(0,0,R,F),O.closePath(),O.setAttr("strokeStyle","red"),O.setAttr("lineWidth",5),O.stroke(),O.restore()),this._cache.set(h,{scene:ot,filter:lt,hit:E,buffer:j,x:G,y:Q}),this._requestDraw(),this}isCached(){return this._cache.has(h)}getClientRect(b){throw new Error('abstract "getClientRect" method call')}_transformedRect(b,P){const M=[{x:b.x,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x+b.width,y:b.y+b.height},{x:b.x,y:b.y+b.height}];let R=1/0,F=1/0,H=-1/0,G=-1/0;const Q=this.getAbsoluteTransform(P);return M.forEach(function(st){const V=Q.point(st);R===void 0&&(R=H=V.x,F=G=V.y),R=Math.min(R,V.x),F=Math.min(F,V.y),H=Math.max(H,V.x),G=Math.max(G,V.y)}),{x:R,y:F,width:H-R,height:G-F}}_drawCachedSceneCanvas(b){b.save(),b._applyOpacity(this),b._applyGlobalCompositeOperation(this);const P=this._getCanvasCache();b.translate(P.x,P.y);const M=this._getCachedSceneCanvas(),R=M.pixelRatio;b.drawImage(M._canvas,0,0,M.width/R,M.height/R),b.restore()}_drawCachedHitCanvas(b){const P=this._getCanvasCache(),M=P.hit;b.save(),b.translate(P.x,P.y),b.drawImage(M._canvas,0,0,M.width/M.pixelRatio,M.height/M.pixelRatio),b.restore()}_getCachedSceneCanvas(){let b=this.filters(),P=this._getCanvasCache(),M=P.scene,R=P.filter,F=R.getContext(),H,G,Q,st;if(b){if(!this._filterUpToDate){const V=M.pixelRatio;R.setSize(M.width/M.pixelRatio,M.height/M.pixelRatio);try{for(H=b.length,F.clear(),F.drawImage(M._canvas,0,0,M.getWidth()/V,M.getHeight()/V),G=F.getImageData(0,0,R.getWidth(),R.getHeight()),Q=0;Q<H;Q++){if(st=b[Q],typeof st!="function"){r.Util.error("Filter should be type of function, but got "+typeof st+" instead. Please check correct filters");continue}st.call(this,G),F.putImageData(G,0,0)}}catch(A){r.Util.error("Unable to apply filter. "+A.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return R}return M}on(b,P){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const M=b.split(I);for(let R=0;R<M.length;R++){const H=M[R].split("."),G=H[0],Q=H[1]||"";this.eventListeners[G]||(this.eventListeners[G]=[]),this.eventListeners[G].push({name:Q,handler:P})}return this}off(b,P){let M=(b||"").split(I),R=M.length,F,H,G,Q,st,V;if(this._cache&&this._cache.delete(a),!b)for(H in this.eventListeners)this._off(H);for(F=0;F<R;F++)if(G=M[F],Q=G.split("."),st=Q[0],V=Q[1],st)this.eventListeners[st]&&this._off(st,V,P);else for(H in this.eventListeners)this._off(H,V,P);return this}dispatchEvent(b){const P={target:this,type:b.type,evt:b};return this.fire(b.type,P),this}addEventListener(b,P){return this.on(b,function(M){P.call(this,M.evt)}),this}removeEventListener(b){return this.off(b),this}_delegate(b,P,M){const R=this;this.on(b,function(F){const H=F.target.findAncestors(P,!0,R);for(let G=0;G<H.length;G++)F=r.Util.cloneObject(F),F.currentTarget=H[G],M.call(H[G],F)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(w),this._clearSelfAndDescendantCache(N),this._clearSelfAndDescendantCache(p)}_remove(){this._clearCaches();const b=this.getParent();b&&b.children&&(b.children.splice(this.index,1),b._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(b){const P="get"+r.Util._capitalize(b);return r.Util._isFunction(this[P])?this[P]():this.attrs[b]}getAncestors(){let b=this.getParent(),P=[];for(;b;)P.push(b),b=b.getParent();return P}getAttrs(){return this.attrs||{}}setAttrs(b){return this._batchTransformChanges(()=>{let P,M;if(!b)return this;for(P in b)P!==g&&(M=y+r.Util._capitalize(P),r.Util._isFunction(this[M])?this[M](b[P]):this._setAttr(P,b[P]))}),this}isListening(){return this._getCache(p,this._isListening)}_isListening(b){if(!this.listening())return!1;const M=this.getParent();return M&&M!==b&&this!==b?M._isListening(b):!0}isVisible(){return this._getCache(N,this._isVisible)}_isVisible(b){if(!this.visible())return!1;const M=this.getParent();return M&&M!==b&&this!==b?M._isVisible(b):!0}shouldDrawHit(b,P=!1){if(b)return this._isVisible(b)&&this._isListening(b);const M=this.getLayer();let R=!1;e.DD._dragElements.forEach(H=>{H.dragStatus==="dragging"&&(H.node.nodeType==="Stage"||H.node.getLayer()===M)&&(R=!0)});const F=!P&&!i.Konva.hitOnDragEnabled&&(R||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!F}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let b=this.getDepth(),P=this,M=0,R,F,H,G;function Q(V){for(R=[],F=V.length,H=0;H<F;H++)G=V[H],M++,G.nodeType!==k&&(R=R.concat(G.getChildren().slice())),G._id===P._id&&(H=F);R.length>0&&R[0].getDepth()<=b&&Q(R)}const st=this.getStage();return P.nodeType!==T&&st&&Q(st.getChildren()),M}getDepth(){let b=0,P=this.parent;for(;P;)b++,P=P.parent;return b}_batchTransformChanges(b){this._batchingTransformChange=!0,b(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(x),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(b){return this._batchTransformChanges(()=>{this.x(b.x),this.y(b.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const b=this.getStage();if(!b)return null;const P=b.getPointerPosition();if(!P)return null;const M=this.getAbsoluteTransform().copy();return M.invert(),M.point(P)}getAbsolutePosition(b){let P=!1,M=this.parent;for(;M;){if(M.isCached()){P=!0;break}M=M.parent}P&&!b&&(b=!0);const R=this.getAbsoluteTransform(b).getMatrix(),F=new r.Transform,H=this.offset();return F.m=R.slice(),F.translate(H.x,H.y),F.getTranslation()}setAbsolutePosition(b){const{x:P,y:M,...R}=this._clearTransform();this.attrs.x=P,this.attrs.y=M,this._clearCache(x);const F=this._getAbsoluteTransform().copy();return F.invert(),F.translate(b.x,b.y),b={x:this.attrs.x+F.getTranslation().x,y:this.attrs.y+F.getTranslation().y},this._setTransform(R),this.setPosition({x:b.x,y:b.y}),this._clearCache(x),this._clearSelfAndDescendantCache(l),this}_setTransform(b){let P;for(P in b)this.attrs[P]=b[P]}_clearTransform(){const b={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,b}move(b){let P=b.x,M=b.y,R=this.x(),F=this.y();return P!==void 0&&(R+=P),M!==void 0&&(F+=M),this.setPosition({x:R,y:F}),this}_eachAncestorReverse(b,P){let M=[],R=this.getParent(),F,H;if(!(P&&P._id===this._id)){for(M.unshift(this);R&&(!P||R._id!==P._id);)M.unshift(R),R=R.parent;for(F=M.length,H=0;H<F;H++)b(M[H])}}rotate(b){return this.rotation(this.rotation()+b),this}moveToTop(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const b=this.index,P=this.parent.getChildren().length;return b<P-1?(this.parent.children.splice(b,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;const b=this.index,P=this.parent.getChildren().length;return b<P-1?(this.parent.children.splice(b,1),this.parent.children.splice(b+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;const b=this.index;return b>0?(this.parent.children.splice(b,1),this.parent.children.splice(b-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const b=this.index;return b>0?(this.parent.children.splice(b,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(b){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(b<0||b>=this.parent.children.length)&&r.Util.warn("Unexpected value "+b+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const P=this.index;return this.parent.children.splice(P,1),this.parent.children.splice(b,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let b=this.opacity();const P=this.getParent();return P&&!P._isUnderCache&&(b*=P.getAbsoluteOpacity()),b}moveTo(b){return this.getParent()!==b&&(this._remove(),b.add(this)),this}toObject(){let b=this.getAttrs(),P,M,R,F,H;const G={attrs:{},className:this.getClassName()};for(P in b)M=b[P],H=r.Util.isObject(M)&&!r.Util._isPlainObject(M)&&!r.Util._isArray(M),!H&&(R=typeof this[P]=="function"&&this[P],delete b[P],F=R?R.call(this):null,b[P]=M,F!==M&&(G.attrs[P]=M));return r.Util._prepareToStringify(G)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(b,P,M){const R=[];P&&this._isMatch(b)&&R.push(this);let F=this.parent;for(;F;){if(F===M)return R;F._isMatch(b)&&R.push(F),F=F.parent}return R}isAncestorOf(b){return!1}findAncestor(b,P,M){return this.findAncestors(b,P,M)[0]}_isMatch(b){if(!b)return!1;if(typeof b=="function")return b(this);let P=b.replace(/ /g,"").split(","),M=P.length,R,F;for(R=0;R<M;R++)if(F=P[R],r.Util.isValidSelector(F)||(r.Util.warn('Selector "'+F+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),F.charAt(0)==="#"){if(this.id()===F.slice(1))return!0}else if(F.charAt(0)==="."){if(this.hasName(F.slice(1)))return!0}else if(this.className===F||this.nodeType===F)return!0;return!1}getLayer(){const b=this.getParent();return b?b.getLayer():null}getStage(){return this._getCache(w,this._getStage)}_getStage(){const b=this.getParent();return b?b.getStage():null}fire(b,P={},M){return P.target=P.target||this,M?this._fireAndBubble(b,P):this._fire(b,P),this}getAbsoluteTransform(b){return b?this._getAbsoluteTransform(b):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(b){let P;if(b)return P=new r.Transform,this._eachAncestorReverse(function(M){const R=M.transformsEnabled();R==="all"?P.multiply(M.getTransform()):R==="position"&&P.translate(M.x()-M.offsetX(),M.y()-M.offsetY())},b),P;{P=this._cache.get(l)||new r.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(P):P.reset();const M=this.transformsEnabled();if(M==="all")P.multiply(this.getTransform());else if(M==="position"){const R=this.attrs.x||0,F=this.attrs.y||0,H=this.attrs.offsetX||0,G=this.attrs.offsetY||0;P.translate(R-H,F-G)}return P.dirty=!1,P}}getAbsoluteScale(b){let P=this;for(;P;)P._isUnderCache&&(b=P),P=P.getParent();const R=this.getAbsoluteTransform(b).decompose();return{x:R.scaleX,y:R.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(x,this._getTransform)}_getTransform(){var b,P;const M=this._cache.get(x)||new r.Transform;M.reset();const R=this.x(),F=this.y(),H=i.Konva.getAngle(this.rotation()),G=(b=this.attrs.scaleX)!==null&&b!==void 0?b:1,Q=(P=this.attrs.scaleY)!==null&&P!==void 0?P:1,st=this.attrs.skewX||0,V=this.attrs.skewY||0,A=this.attrs.offsetX||0,$=this.attrs.offsetY||0;return(R!==0||F!==0)&&M.translate(R,F),H!==0&&M.rotate(H),(st!==0||V!==0)&&M.skew(st,V),(G!==1||Q!==1)&&M.scale(G,Q),(A!==0||$!==0)&&M.translate(-1*A,-1*$),M.dirty=!1,M}clone(b){let P=r.Util.cloneObject(this.attrs),M,R,F,H,G;for(M in b)P[M]=b[M];const Q=new this.constructor(P);for(M in this.eventListeners)for(R=this.eventListeners[M],F=R.length,H=0;H<F;H++)G=R[H],G.name.indexOf(f)<0&&(Q.eventListeners[M]||(Q.eventListeners[M]=[]),Q.eventListeners[M].push(G));return Q}_toKonvaCanvas(b){b=b||{};const P=this.getClientRect(),M=this.getStage(),R=b.x!==void 0?b.x:Math.floor(P.x),F=b.y!==void 0?b.y:Math.floor(P.y),H=b.pixelRatio||1,G=new t.SceneCanvas({width:b.width||Math.ceil(P.width)||(M?M.width():0),height:b.height||Math.ceil(P.height)||(M?M.height():0),pixelRatio:H}),Q=G.getContext(),st=new t.SceneCanvas({width:G.width/G.pixelRatio+Math.abs(R),height:G.height/G.pixelRatio+Math.abs(F),pixelRatio:G.pixelRatio});return b.imageSmoothingEnabled===!1&&(Q._context.imageSmoothingEnabled=!1),Q.save(),(R||F)&&Q.translate(-1*R,-1*F),this.drawScene(G,void 0,st),Q.restore(),G}toCanvas(b){return this._toKonvaCanvas(b)._canvas}toDataURL(b){b=b||{};const P=b.mimeType||null,M=b.quality||null,R=this._toKonvaCanvas(b).toDataURL(P,M);return b.callback&&b.callback(R),R}toImage(b){return new Promise((P,M)=>{try{const R=b?.callback;R&&delete b.callback,r.Util._urlToImage(this.toDataURL(b),function(F){P(F),R?.(F)})}catch(R){M(R)}})}toBlob(b){return new Promise((P,M)=>{try{const R=b?.callback;R&&delete b.callback,this.toCanvas(b).toBlob(F=>{P(F),R?.(F)},b?.mimeType,b?.quality)}catch(R){M(R)}})}setSize(b){return this.width(b.width),this.height(b.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(b,P,M){let R=this.eventListeners[b],F,H,G;for(F=0;F<R.length;F++)if(H=R[F].name,G=R[F].handler,(H!=="konva"||P==="konva")&&(!P||H===P)&&(!M||M===G)){if(R.splice(F,1),R.length===0){delete this.eventListeners[b];break}F--}}_fireChangeEvent(b,P,M){this._fire(b+d,{oldVal:P,newVal:M})}addName(b){if(!this.hasName(b)){const P=this.name(),M=P?P+" "+b:b;this.name(M)}return this}hasName(b){if(!b)return!1;const P=this.name();return P?(P||"").split(/\s/g).indexOf(b)!==-1:!1}removeName(b){const P=(this.name()||"").split(/\s/g),M=P.indexOf(b);return M!==-1&&(P.splice(M,1),this.name(P.join(" "))),this}setAttr(b,P){const M=this[y+r.Util._capitalize(b)];return r.Util._isFunction(M)?M.call(this,P):this._setAttr(b,P),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const b=this.getLayer()||this.getStage();b?.batchDraw()}}_setAttr(b,P){const M=this.attrs[b];M===P&&!r.Util.isObject(P)||(P==null?delete this.attrs[b]:this.attrs[b]=P,this._shouldFireChangeEvents&&this._fireChangeEvent(b,M,P),this._requestDraw())}_setComponentAttr(b,P,M){let R;M!==void 0&&(R=this.attrs[b],R||(this.attrs[b]=this.getAttr(b)),this.attrs[b][P]=M,this._fireChangeEvent(b,R,M))}_fireAndBubble(b,P,M){P&&this.nodeType===k&&(P.target=this);const R=[v,S,C,m,u,_];if(!(R.indexOf(b)!==-1&&(M&&(this===M||this.isAncestorOf&&this.isAncestorOf(M))||this.nodeType==="Stage"&&!M))){this._fire(b,P);const H=R.indexOf(b)!==-1&&M&&M.isAncestorOf&&M.isAncestorOf(this)&&!M.isAncestorOf(this.parent);(P&&!P.cancelBubble||!P)&&this.parent&&this.parent.isListening()&&!H&&(M&&M.parent?this._fireAndBubble.call(this.parent,b,P,M):this._fireAndBubble.call(this.parent,b,P))}}_getProtoListeners(b){var P,M,R;const F=(P=this._cache.get(a))!==null&&P!==void 0?P:{};let H=F?.[b];if(H===void 0){H=[];let G=Object.getPrototypeOf(this);for(;G;){const Q=(R=(M=G.eventListeners)===null||M===void 0?void 0:M[b])!==null&&R!==void 0?R:[];H.push(...Q),G=Object.getPrototypeOf(G)}F[b]=H,this._cache.set(a,F)}return H}_fire(b,P){P=P||{},P.currentTarget=this,P.type=b;const M=this._getProtoListeners(b);if(M)for(let F=0;F<M.length;F++)M[F].handler.call(this,P);const R=this.eventListeners[b];if(R)for(let F=0;F<R.length;F++)R[F].handler.call(this,P)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(b){const P=b?b.pointerId:void 0,M=this.getStage(),R=this.getAbsolutePosition();if(!M)return;const F=M._getPointerById(P)||M._changedPointerPositions[0]||R;e.DD._dragElements.set(this._id,{node:this,startPointerPos:F,offset:{x:F.x-R.x,y:F.y-R.y},dragStatus:"ready",pointerId:P})}startDrag(b,P=!0){e.DD._dragElements.has(this._id)||this._createDragElement(b);const M=e.DD._dragElements.get(this._id);M.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:b&&b.evt},P)}_setDragPosition(b,P){const M=this.getStage()._getPointerById(P.pointerId);if(!M)return;let R={x:M.x-P.offset.x,y:M.y-P.offset.y};const F=this.dragBoundFunc();if(F!==void 0){const H=F.call(this,R,b);H?R=H:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==R.x||this._lastPos.y!==R.y)&&(this.setAbsolutePosition(R),this._requestDraw()),this._lastPos=R}stopDrag(b){const P=e.DD._dragElements.get(this._id);P&&(P.dragStatus="stopped"),e.DD._endDragBefore(b),e.DD._endDragAfter(b)}setDraggable(b){this._setAttr("draggable",b),this._dragChange()}isDragging(){const b=e.DD._dragElements.get(this._id);return b?b.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(b){if(!(!(b.evt.button!==void 0)||i.Konva.dragButtons.indexOf(b.evt.button)>=0)||this.isDragging())return;let R=!1;e.DD._dragElements.forEach(F=>{this.isAncestorOf(F.node)&&(R=!0)}),R||this._createDragElement(b)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const P=e.DD._dragElements.get(this._id),M=P&&P.dragStatus==="dragging",R=P&&P.dragStatus==="ready";M?this.stopDrag():R&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(b={x:0,y:0}){const P=this.getStage();if(!P)return!1;const M={x:-b.x,y:-b.y,width:P.width()+2*b.x,height:P.height()+2*b.y};return r.Util.haveIntersection(M,this.getClientRect())}static create(b,P){return r.Util._isString(b)&&(b=JSON.parse(b)),this._createNode(b,P)}static _createNode(b,P){let M=qs.prototype.getClassName.call(b),R=b.children,F,H,G;P&&(b.attrs.container=P),i.Konva[M]||(r.Util.warn('Can not find a node with class name "'+M+'". Fallback to "Shape".'),M="Shape");const Q=i.Konva[M];if(F=new Q(b.attrs),R)for(H=R.length,G=0;G<H;G++)F.add(qs._createNode(R[G]));return F}};Hn.Node=U,U.prototype.nodeType="Node",U.prototype._attrsAffectingSize=[],U.prototype.eventListeners={},U.prototype.on.call(U.prototype,D,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(x),this._clearSelfAndDescendantCache(l)}),U.prototype.on.call(U.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(N)}),U.prototype.on.call(U.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(p)}),U.prototype.on.call(U.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const z=n.Factory.addGetterSetter;return z(U,"zIndex"),z(U,"absolutePosition"),z(U,"position"),z(U,"x",0,(0,s.getNumberValidator)()),z(U,"y",0,(0,s.getNumberValidator)()),z(U,"globalCompositeOperation","source-over",(0,s.getStringValidator)()),z(U,"opacity",1,(0,s.getNumberValidator)()),z(U,"name","",(0,s.getStringValidator)()),z(U,"id","",(0,s.getStringValidator)()),z(U,"rotation",0,(0,s.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"scale",["x","y"]),z(U,"scaleX",1,(0,s.getNumberValidator)()),z(U,"scaleY",1,(0,s.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"skew",["x","y"]),z(U,"skewX",0,(0,s.getNumberValidator)()),z(U,"skewY",0,(0,s.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"offset",["x","y"]),z(U,"offsetX",0,(0,s.getNumberValidator)()),z(U,"offsetY",0,(0,s.getNumberValidator)()),z(U,"dragDistance",void 0,(0,s.getNumberValidator)()),z(U,"width",0,(0,s.getNumberValidator)()),z(U,"height",0,(0,s.getNumberValidator)()),z(U,"listening",!0,(0,s.getBooleanValidator)()),z(U,"preventDefault",!0,(0,s.getBooleanValidator)()),z(U,"filters",void 0,function(X){return this._filterUpToDate=!1,X}),z(U,"visible",!0,(0,s.getBooleanValidator)()),z(U,"transformsEnabled","all",(0,s.getStringValidator)()),z(U,"size"),z(U,"dragBoundFunc"),z(U,"draggable",!1,(0,s.getBooleanValidator)()),n.Factory.backCompat(U,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Hn}var Wn={},Ja;function gr(){if(Ja)return Wn;Ja=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.Container=void 0;const t=_t(),e=Ft(),n=vt();let i=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(s){const o=this.children||[];return s?o.filter(s):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.destroy()}),this.children=[],this._requestDraw(),this}add(...s){if(s.length===0)return this;if(s.length>1){for(let a=0;a<s.length;a++)this.add(s[a]);return this}const o=s[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(s){return this._generalFind(s,!1)}findOne(s){const o=this._generalFind(s,!0);return o.length>0?o[0]:void 0}_generalFind(s,o){const a=[];return this._descendants(l=>{const c=l._isMatch(s);return c&&a.push(l),!!(c&&o)}),a}_descendants(s){let o=!1;const a=this.getChildren();for(const l of a){if(o=s(l),o)return!0;if(l.hasChildren()&&(o=l._descendants(s),o))return!0}return!1}toObject(){const s=e.Node.prototype.toObject.call(this);return s.children=[],this.getChildren().forEach(o=>{s.children.push(o.toObject())}),s}isAncestorOf(s){let o=s.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(s){const o=e.Node.prototype.clone.call(this,s);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(s){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(s)&&o.push(a)}),o}_clearSelfAndDescendantCache(s){var o;super._clearSelfAndDescendantCache(s),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(s)}))}_setChildrenIndices(){var s;(s=this.children)===null||s===void 0||s.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(s,o,a){const l=this.getLayer(),c=s||l&&l.getCanvas(),h=c&&c.getContext(),d=this._getCanvasCache(),g=d&&d.scene,f=c&&c.isCache;if(!this.isVisible()&&!f)return this;if(g){h.save();const p=this.getAbsoluteTransform(o).getMatrix();h.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(h),h.restore()}else this._drawChildren("drawScene",c,o,a);return this}drawHit(s,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),l=s||a&&a.hitCanvas,c=l&&l.getContext(),h=this._getCanvasCache();if(h&&h.hit){c.save();const g=this.getAbsoluteTransform(o).getMatrix();c.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",l,o);return this}_drawChildren(s,o,a,l){var c;const h=o&&o.getContext(),d=this.clipWidth(),g=this.clipHeight(),f=this.clipFunc(),p=typeof d=="number"&&typeof g=="number"||f,v=a===this;if(p){h.save();const C=this.getAbsoluteTransform(a);let m=C.getMatrix();h.transform(m[0],m[1],m[2],m[3],m[4],m[5]),h.beginPath();let u;if(f)u=f.call(this,h,this);else{const _=this.clipX(),y=this.clipY();h.rect(_||0,y||0,d,g)}h.clip.apply(h,u),m=C.copy().invert().getMatrix(),h.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const S=!v&&this.globalCompositeOperation()!=="source-over"&&s==="drawScene";S&&(h.save(),h._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(C){C[s](o,a,l)}),S&&h.restore(),p&&h.restore()}getClientRect(s={}){var o;const a=s.skipTransform,l=s.relativeTo;let c,h,d,g,f={x:1/0,y:1/0,width:0,height:0};const p=this;(o=this.children)===null||o===void 0||o.forEach(function(C){if(!C.visible())return;const m=C.getClientRect({relativeTo:p,skipShadow:s.skipShadow,skipStroke:s.skipStroke});m.width===0&&m.height===0||(c===void 0?(c=m.x,h=m.y,d=m.x+m.width,g=m.y+m.height):(c=Math.min(c,m.x),h=Math.min(h,m.y),d=Math.max(d,m.x+m.width),g=Math.max(g,m.y+m.height)))});const v=this.find("Shape");let S=!1;for(let C=0;C<v.length;C++)if(v[C]._isVisible(this)){S=!0;break}return S&&c!==void 0?f={x:c,y:h,width:d-c,height:g-h}:f={x:0,y:0,width:0,height:0},a?f:this._transformedRect(f,l)}};return Wn.Container=i,t.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipFunc"),Wn}var xs={},Le={},tl;function el(){if(tl)return Le;tl=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.getCapturedShape=i,Le.createEvent=r,Le.hasPointerCapture=s,Le.setPointerCapture=o,Le.releaseCapture=a;const t=mt(),e=new Map,n=t.Konva._global.PointerEvent!==void 0;function i(l){return e.get(l)}function r(l){return{evt:l,pointerId:l.pointerId}}function s(l,c){return e.get(l)===c}function o(l,c){a(l),c.getStage()&&(e.set(l,c),n&&c._fire("gotpointercapture",r(new PointerEvent("gotpointercapture"))))}function a(l,c){const h=e.get(l);if(!h)return;const d=h.getStage();d&&d.content,e.delete(l),n&&h._fire("lostpointercapture",r(new PointerEvent("lostpointercapture")))}return Le}var nl;function jd(){return nl||(nl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=It(),n=_t(),i=gr(),r=mt(),s=fr(),o=Ss(),a=mt(),l=el(),c="Stage",h="string",d="px",g="mouseout",f="mouseleave",p="mouseover",v="mouseenter",S="mousemove",C="mousedown",m="mouseup",u="pointermove",_="pointerdown",y="pointerup",k="pointercancel",I="lostpointercapture",w="pointerout",x="pointerleave",T="pointerover",N="pointerenter",D="contextmenu",L="touchstart",U="touchend",z="touchmove",X="touchcancel",b="wheel",P=5,M=[[v,"_pointerenter"],[C,"_pointerdown"],[S,"_pointermove"],[m,"_pointerup"],[f,"_pointerleave"],[L,"_pointerdown"],[z,"_pointermove"],[U,"_pointerup"],[X,"_pointercancel"],[p,"_pointerover"],[b,"_wheel"],[D,"_contextmenu"],[_,"_pointerdown"],[u,"_pointermove"],[y,"_pointerup"],[k,"_pointercancel"],[x,"_pointerleave"],[I,"_lostpointercapture"]],R={mouse:{[w]:g,[x]:f,[T]:p,[N]:v,[u]:S,[_]:C,[y]:m,[k]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[w]:"touchout",[x]:"touchleave",[T]:"touchover",[N]:"touchenter",[u]:z,[_]:L,[y]:U,[k]:X,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[w]:w,[x]:x,[T]:T,[N]:N,[u]:u,[_]:_,[y]:y,[k]:k,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},F=V=>V.indexOf("pointer")>=0?"pointer":V.indexOf("touch")>=0?"touch":"mouse",H=V=>{const A=F(V);if(A==="pointer")return r.Konva.pointerEventsEnabled&&R.pointer;if(A==="touch")return R.touch;if(A==="mouse")return R.mouse};function G(V={}){return(V.clipFunc||V.clipWidth||V.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),V}const Q="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class st extends i.Container{constructor(A){super(G(A)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{G(this.attrs)}),this._checkVisibility()}_validateAdd(A){const $=A.getType()==="Layer",it=A.getType()==="FastLayer";$||it||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const A=this.visible()?"":"none";this.content.style.display=A}setContainer(A){if(typeof A===h){let $;if(A.charAt(0)==="."){const it=A.slice(1);A=document.getElementsByClassName(it)[0]}else A.charAt(0)!=="#"?$=A:$=A.slice(1),A=document.getElementById($);if(!A)throw"Can not find container in document with id "+$}return this._setAttr("container",A),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),A.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const A=this.children,$=A.length;for(let it=0;it<$;it++)A[it].clear();return this}clone(A){return A||(A={}),A.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,A)}destroy(){super.destroy();const A=this.content;A&&e.Util._isInDocument(A)&&this.container().removeChild(A);const $=t.stages.indexOf(this);return $>-1&&t.stages.splice($,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const A=this._pointerPositions[0]||this._changedPointerPositions[0];return A?{x:A.x,y:A.y}:(e.Util.warn(Q),null)}_getPointerById(A){return this._pointerPositions.find($=>$.id===A)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(A){A=A||{},A.x=A.x||0,A.y=A.y||0,A.width=A.width||this.width(),A.height=A.height||this.height();const $=new s.SceneCanvas({width:A.width,height:A.height,pixelRatio:A.pixelRatio||1}),it=$.getContext()._context,ot=this.children;return(A.x||A.y)&&it.translate(-1*A.x,-1*A.y),ot.forEach(function(lt){if(!lt.isVisible())return;const E=lt._toKonvaCanvas(A);it.drawImage(E._canvas,A.x,A.y,E.getWidth()/E.getPixelRatio(),E.getHeight()/E.getPixelRatio())}),$}getIntersection(A){if(!A)return null;const $=this.children,it=$.length,ot=it-1;for(let lt=ot;lt>=0;lt--){const E=$[lt].getIntersection(A);if(E)return E}return null}_resizeDOM(){const A=this.width(),$=this.height();this.content&&(this.content.style.width=A+d,this.content.style.height=$+d),this.bufferCanvas.setSize(A,$),this.bufferHitCanvas.setSize(A,$),this.children.forEach(it=>{it.setSize({width:A,height:$}),it.draw()})}add(A,...$){if(arguments.length>1){for(let ot=0;ot<arguments.length;ot++)this.add(arguments[ot]);return this}super.add(A);const it=this.children.length;return it>P&&e.Util.warn("The stage has "+it+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),A.setSize({width:this.width(),height:this.height()}),A.draw(),r.Konva.isBrowser&&this.content.appendChild(A.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(A){return l.hasPointerCapture(A,this)}setPointerCapture(A){l.setPointerCapture(A,this)}releaseCapture(A){l.releaseCapture(A,this)}getLayers(){return this.children}_bindContentEvents(){r.Konva.isBrowser&&M.forEach(([A,$])=>{this.content.addEventListener(A,it=>{this[$](it)},{passive:!1})})}_pointerenter(A){this.setPointersPositions(A);const $=H(A.type);$&&this._fire($.pointerenter,{evt:A,target:this,currentTarget:this})}_pointerover(A){this.setPointersPositions(A);const $=H(A.type);$&&this._fire($.pointerover,{evt:A,target:this,currentTarget:this})}_getTargetShape(A){let $=this[A+"targetShape"];return $&&!$.getStage()&&($=null),$}_pointerleave(A){const $=H(A.type),it=F(A.type);if(!$)return;this.setPointersPositions(A);const ot=this._getTargetShape(it),lt=!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled;ot&&lt?(ot._fireAndBubble($.pointerout,{evt:A}),ot._fireAndBubble($.pointerleave,{evt:A}),this._fire($.pointerleave,{evt:A,target:this,currentTarget:this}),this[it+"targetShape"]=null):lt&&(this._fire($.pointerleave,{evt:A,target:this,currentTarget:this}),this._fire($.pointerout,{evt:A,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(A){const $=H(A.type),it=F(A.type);if(!$)return;this.setPointersPositions(A);let ot=!1;this._changedPointerPositions.forEach(lt=>{const E=this.getIntersection(lt);if(o.DD.justDragged=!1,r.Konva["_"+it+"ListenClick"]=!0,!E||!E.isListening()){this[it+"ClickStartShape"]=void 0;return}r.Konva.capturePointerEventsEnabled&&E.setPointerCapture(lt.id),this[it+"ClickStartShape"]=E,E._fireAndBubble($.pointerdown,{evt:A,pointerId:lt.id}),ot=!0;const O=A.type.indexOf("touch")>=0;E.preventDefault()&&A.cancelable&&O&&A.preventDefault()}),ot||this._fire($.pointerdown,{evt:A,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(A){const $=H(A.type),it=F(A.type);if(!$||(r.Konva.isDragging()&&o.DD.node.preventDefault()&&A.cancelable&&A.preventDefault(),this.setPointersPositions(A),!(!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled)))return;const lt={};let E=!1;const O=this._getTargetShape(it);this._changedPointerPositions.forEach(B=>{const j=l.getCapturedShape(B.id)||this.getIntersection(B),Y=B.id,q={evt:A,pointerId:Y},J=O!==j;if(J&&O&&(O._fireAndBubble($.pointerout,{...q},j),O._fireAndBubble($.pointerleave,{...q},j)),j){if(lt[j._id])return;lt[j._id]=!0}j&&j.isListening()?(E=!0,J&&(j._fireAndBubble($.pointerover,{...q},O),j._fireAndBubble($.pointerenter,{...q},O),this[it+"targetShape"]=j),j._fireAndBubble($.pointermove,{...q})):O&&(this._fire($.pointerover,{evt:A,target:this,currentTarget:this,pointerId:Y}),this[it+"targetShape"]=null)}),E||this._fire($.pointermove,{evt:A,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(A){const $=H(A.type),it=F(A.type);if(!$)return;this.setPointersPositions(A);const ot=this[it+"ClickStartShape"],lt=this[it+"ClickEndShape"],E={};let O=!1;this._changedPointerPositions.forEach(B=>{const j=l.getCapturedShape(B.id)||this.getIntersection(B);if(j){if(j.releaseCapture(B.id),E[j._id])return;E[j._id]=!0}const Y=B.id,q={evt:A,pointerId:Y};let J=!1;r.Konva["_"+it+"InDblClickWindow"]?(J=!0,clearTimeout(this[it+"DblTimeout"])):o.DD.justDragged||(r.Konva["_"+it+"InDblClickWindow"]=!0,clearTimeout(this[it+"DblTimeout"])),this[it+"DblTimeout"]=setTimeout(function(){r.Konva["_"+it+"InDblClickWindow"]=!1},r.Konva.dblClickWindow),j&&j.isListening()?(O=!0,this[it+"ClickEndShape"]=j,j._fireAndBubble($.pointerup,{...q}),r.Konva["_"+it+"ListenClick"]&&ot&&ot===j&&(j._fireAndBubble($.pointerclick,{...q}),J&&lt&&lt===j&&j._fireAndBubble($.pointerdblclick,{...q}))):(this[it+"ClickEndShape"]=null,r.Konva["_"+it+"ListenClick"]&&this._fire($.pointerclick,{evt:A,target:this,currentTarget:this,pointerId:Y}),J&&this._fire($.pointerdblclick,{evt:A,target:this,currentTarget:this,pointerId:Y}))}),O||this._fire($.pointerup,{evt:A,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),r.Konva["_"+it+"ListenClick"]=!1,A.cancelable&&it!=="touch"&&it!=="pointer"&&A.preventDefault()}_contextmenu(A){this.setPointersPositions(A);const $=this.getIntersection(this.getPointerPosition());$&&$.isListening()?$._fireAndBubble(D,{evt:A}):this._fire(D,{evt:A,target:this,currentTarget:this})}_wheel(A){this.setPointersPositions(A);const $=this.getIntersection(this.getPointerPosition());$&&$.isListening()?$._fireAndBubble(b,{evt:A}):this._fire(b,{evt:A,target:this,currentTarget:this})}_pointercancel(A){this.setPointersPositions(A);const $=l.getCapturedShape(A.pointerId)||this.getIntersection(this.getPointerPosition());$&&$._fireAndBubble(y,l.createEvent(A)),l.releaseCapture(A.pointerId)}_lostpointercapture(A){l.releaseCapture(A.pointerId)}setPointersPositions(A){const $=this._getContentPosition();let it=null,ot=null;A=A||window.event,A.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(A.touches,lt=>{this._pointerPositions.push({id:lt.identifier,x:(lt.clientX-$.left)/$.scaleX,y:(lt.clientY-$.top)/$.scaleY})}),Array.prototype.forEach.call(A.changedTouches||A.touches,lt=>{this._changedPointerPositions.push({id:lt.identifier,x:(lt.clientX-$.left)/$.scaleX,y:(lt.clientY-$.top)/$.scaleY})})):(it=(A.clientX-$.left)/$.scaleX,ot=(A.clientY-$.top)/$.scaleY,this.pointerPos={x:it,y:ot},this._pointerPositions=[{x:it,y:ot,id:e.Util._getFirstPointerId(A)}],this._changedPointerPositions=[{x:it,y:ot,id:e.Util._getFirstPointerId(A)}])}_setPointerPosition(A){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(A)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const A=this.content.getBoundingClientRect();return{top:A.top,left:A.left,scaleX:A.width/this.content.clientWidth||1,scaleY:A.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!r.Konva.isBrowser)return;const A=this.container();if(!A)throw"Stage has no container. A container is required.";A.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),A.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(A){A.batchDraw()}),this}}t.Stage=st,st.prototype.nodeType=c,(0,a._registerNode)(st),n.Factory.addGetterSetter(st,"container"),r.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(V=>{V.batchDraw()})})}(xs)),xs}var jn={},Cs={},il;function Lt(){return il||(il=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=mt(),n=It(),i=_t(),r=Ft(),s=vt(),o=mt(),a=el(),l="hasShadow",c="shadowRGBA",h="patternImage",d="linearGradient",g="radialGradient";let f;function p(){return f||(f=n.Util.createCanvasElement().getContext("2d"),f)}t.shapes={};function v(x){const T=this.attrs.fillRule;T?x.fill(T):x.fill()}function S(x){x.stroke()}function C(x){const T=this.attrs.fillRule;T?x.fill(T):x.fill()}function m(x){x.stroke()}function u(){this._clearCache(l)}function _(){this._clearCache(c)}function y(){this._clearCache(h)}function k(){this._clearCache(d)}function I(){this._clearCache(g)}class w extends r.Node{constructor(T){super(T);let N;for(;N=n.Util.getRandomColor(),!(N&&!(N in t.shapes)););this.colorKey=N,t.shapes[N]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const N=p().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(N&&N.setTransform){const D=new n.Transform;D.translate(this.fillPatternX(),this.fillPatternY()),D.rotate(e.Konva.getAngle(this.fillPatternRotation())),D.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),D.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const L=D.getMatrix(),U=typeof DOMMatrix>"u"?{a:L[0],b:L[1],c:L[2],d:L[3],e:L[4],f:L[5]}:new DOMMatrix(L);N.setTransform(U)}return N}}_getLinearGradient(){return this._getCache(d,this.__getLinearGradient)}__getLinearGradient(){const T=this.fillLinearGradientColorStops();if(T){const N=p(),D=this.fillLinearGradientStartPoint(),L=this.fillLinearGradientEndPoint(),U=N.createLinearGradient(D.x,D.y,L.x,L.y);for(let z=0;z<T.length;z+=2)U.addColorStop(T[z],T[z+1]);return U}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const T=this.fillRadialGradientColorStops();if(T){const N=p(),D=this.fillRadialGradientStartPoint(),L=this.fillRadialGradientEndPoint(),U=N.createRadialGradient(D.x,D.y,this.fillRadialGradientStartRadius(),L.x,L.y,this.fillRadialGradientEndRadius());for(let z=0;z<T.length;z+=2)U.addColorStop(T[z],T[z+1]);return U}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const T=n.Util.colorToRGBA(this.shadowColor());if(T)return"rgba("+T.r+","+T.g+","+T.b+","+T.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const T=this.hitStrokeWidth();return T==="auto"?this.hasStroke():this.strokeEnabled()&&!!T}intersects(T){const N=this.getStage();if(!N)return!1;const D=N.bufferHitCanvas;return D.getContext().clear(),this.drawHit(D,void 0,!0),D.context.getImageData(Math.round(T.x),Math.round(T.y),1,1).data[3]>0}destroy(){return r.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(T){var N;if(!((N=this.attrs.perfectDrawEnabled)!==null&&N!==void 0?N:!0))return!1;const L=T||this.hasFill(),U=this.hasStroke(),z=this.getAbsoluteOpacity()!==1;if(L&&U&&z)return!0;const X=this.hasShadow(),b=this.shadowForStrokeEnabled();return!!(L&&U&&X&&b)}setStrokeHitEnabled(T){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),T?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const T=this.size();return{x:this._centroid?-T.width/2:0,y:this._centroid?-T.height/2:0,width:T.width,height:T.height}}getClientRect(T={}){let N=!1,D=this.getParent();for(;D;){if(D.isCached()){N=!0;break}D=D.getParent()}const L=T.skipTransform,U=T.relativeTo||N&&this.getStage()||void 0,z=this.getSelfRect(),b=!T.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,P=z.width+b,M=z.height+b,R=!T.skipShadow&&this.hasShadow(),F=R?this.shadowOffsetX():0,H=R?this.shadowOffsetY():0,G=P+Math.abs(F),Q=M+Math.abs(H),st=R&&this.shadowBlur()||0,V=G+st*2,A=Q+st*2,$={width:V,height:A,x:-(b/2+st)+Math.min(F,0)+z.x,y:-(b/2+st)+Math.min(H,0)+z.y};return L?$:this._transformedRect($,U)}drawScene(T,N,D){const L=this.getLayer(),U=T||L.getCanvas(),z=U.getContext(),X=this._getCanvasCache(),b=this.getSceneFunc(),P=this.hasShadow();let M;const R=N===this;if(!this.isVisible()&&!R)return this;if(X){z.save();const F=this.getAbsoluteTransform(N).getMatrix();return z.transform(F[0],F[1],F[2],F[3],F[4],F[5]),this._drawCachedSceneCanvas(z),z.restore(),this}if(!b)return this;if(z.save(),this._useBufferCanvas()){M=this.getStage();const F=D||M.bufferCanvas,H=F.getContext();H.clear(),H.save(),H._applyLineJoin(this);const G=this.getAbsoluteTransform(N).getMatrix();H.transform(G[0],G[1],G[2],G[3],G[4],G[5]),b.call(this,H,this),H.restore();const Q=F.pixelRatio;P&&z._applyShadow(this),z._applyOpacity(this),z._applyGlobalCompositeOperation(this),z.drawImage(F._canvas,F.x||0,F.y||0,F.width/Q,F.height/Q)}else{if(z._applyLineJoin(this),!R){const F=this.getAbsoluteTransform(N).getMatrix();z.transform(F[0],F[1],F[2],F[3],F[4],F[5]),z._applyOpacity(this),z._applyGlobalCompositeOperation(this)}P&&z._applyShadow(this),b.call(this,z,this)}return z.restore(),this}drawHit(T,N,D=!1){if(!this.shouldDrawHit(N,D))return this;const L=this.getLayer(),U=T||L.hitCanvas,z=U&&U.getContext(),X=this.hitFunc()||this.sceneFunc(),b=this._getCanvasCache(),P=b&&b.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),P){z.save();const R=this.getAbsoluteTransform(N).getMatrix();return z.transform(R[0],R[1],R[2],R[3],R[4],R[5]),this._drawCachedHitCanvas(z),z.restore(),this}if(!X)return this;if(z.save(),z._applyLineJoin(this),!(this===N)){const R=this.getAbsoluteTransform(N).getMatrix();z.transform(R[0],R[1],R[2],R[3],R[4],R[5])}return X.call(this,z,this),z.restore(),this}drawHitFromCache(T=0){const N=this._getCanvasCache(),D=this._getCachedSceneCanvas(),L=N.hit,U=L.getContext(),z=L.getWidth(),X=L.getHeight();U.clear(),U.drawImage(D._canvas,0,0,z,X);try{const b=U.getImageData(0,0,z,X),P=b.data,M=P.length,R=n.Util._hexToRgb(this.colorKey);for(let F=0;F<M;F+=4)P[F+3]>T?(P[F]=R.r,P[F+1]=R.g,P[F+2]=R.b,P[F+3]=255):P[F+3]=0;U.putImageData(b,0,0)}catch(b){n.Util.error("Unable to draw hit graph from cached scene canvas. "+b.message)}return this}hasPointerCapture(T){return a.hasPointerCapture(T,this)}setPointerCapture(T){a.setPointerCapture(T,this)}releaseCapture(T){a.releaseCapture(T,this)}}t.Shape=w,w.prototype._fillFunc=v,w.prototype._strokeFunc=S,w.prototype._fillFuncHit=C,w.prototype._strokeFuncHit=m,w.prototype._centroid=!1,w.prototype.nodeType="Shape",(0,o._registerNode)(w),w.prototype.eventListeners={},w.prototype.on.call(w.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",u),w.prototype.on.call(w.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),w.prototype.on.call(w.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",y),w.prototype.on.call(w.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",k),w.prototype.on.call(w.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",I),i.Factory.addGetterSetter(w,"stroke",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(w,"strokeWidth",2,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(w,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(w,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(w,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(w,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(w,"lineJoin"),i.Factory.addGetterSetter(w,"lineCap"),i.Factory.addGetterSetter(w,"sceneFunc"),i.Factory.addGetterSetter(w,"hitFunc"),i.Factory.addGetterSetter(w,"dash"),i.Factory.addGetterSetter(w,"dashOffset",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"shadowColor",void 0,(0,s.getStringValidator)()),i.Factory.addGetterSetter(w,"shadowBlur",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"shadowOpacity",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(w,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(w,"shadowOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"shadowOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"fillPatternImage"),i.Factory.addGetterSetter(w,"fill",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(w,"fillPatternX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"fillPatternY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(w,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(w,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(w,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(w,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(w,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(w,"fillEnabled",!0),i.Factory.addGetterSetter(w,"strokeEnabled",!0),i.Factory.addGetterSetter(w,"shadowEnabled",!0),i.Factory.addGetterSetter(w,"dashEnabled",!0),i.Factory.addGetterSetter(w,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(w,"fillPriority","color"),i.Factory.addComponentsGetterSetter(w,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(w,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(w,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(w,"fillPatternScaleX",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"fillPatternScaleY",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(w,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(w,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(w,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(w,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(w,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(w,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(w,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(w,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(w,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(w,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(w,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(w,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(w,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(w,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(w,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(w,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(w,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(w,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(w,"fillPatternRotation",0),i.Factory.addGetterSetter(w,"fillRule",void 0,(0,s.getStringValidator)()),i.Factory.backCompat(w,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(Cs)),Cs}var rl;function sl(){if(rl)return jn;rl=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.Layer=void 0;const t=It(),e=gr(),n=Ft(),i=_t(),r=fr(),s=vt(),o=Lt(),a=mt(),l="#",c="beforeDraw",h="draw",d=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=d.length;let f=class extends e.Container{constructor(v){super(v),this.canvas=new r.SceneCanvas,this.hitCanvas=new r.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(v){return this.getContext().clear(v),this.getHitCanvas().getContext().clear(v),this}setZIndex(v){super.setZIndex(v);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),v<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[v+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!n.Node.prototype.moveUp.call(this))return!1;const S=this.getStage();return!S||!S.content?!1:(S.content.removeChild(this.getNativeCanvasElement()),this.index<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[this.index+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){const v=this.getStage();if(v){const S=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),S[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){const v=this.getStage();if(v){const S=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),S[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const v=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),v&&v.parentNode&&t.Util._isInDocument(v)&&v.parentNode.removeChild(v),this}getStage(){return this.parent}setSize({width:v,height:S}){return this.canvas.setSize(v,S),this.hitCanvas.setSize(v,S),this._setSmoothEnabled(),this}_validateAdd(v){const S=v.getType();S!=="Group"&&S!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(v){return v=v||{},v.width=v.width||this.getWidth(),v.height=v.height||this.getHeight(),v.x=v.x!==void 0?v.x:this.x(),v.y=v.y!==void 0?v.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,v)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(v){if(!this.isListening()||!this.isVisible())return null;let S=1,C=!1;for(;;){for(let m=0;m<g;m++){const u=d[m],_=this._getIntersection({x:v.x+u.x*S,y:v.y+u.y*S}),y=_.shape;if(y)return y;if(C=!!_.antialiased,!_.antialiased)break}if(C)S+=1;else return null}}_getIntersection(v){const S=this.hitCanvas.pixelRatio,C=this.hitCanvas.context.getImageData(Math.round(v.x*S),Math.round(v.y*S),1,1).data,m=C[3];if(m===255){const u=t.Util._rgbToHex(C[0],C[1],C[2]),_=o.shapes[l+u];return _?{shape:_}:{antialiased:!0}}else if(m>0)return{antialiased:!0};return{}}drawScene(v,S,C){const m=this.getLayer(),u=v||m&&m.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&u.getContext().clear(),e.Container.prototype.drawScene.call(this,u,S,C),this._fire(h,{node:this}),this}drawHit(v,S){const C=this.getLayer(),m=v||C&&C.hitCanvas;return C&&C.clearBeforeDraw()&&C.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,m,S),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(v){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(v)}getHitGraphEnabled(v){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const v=this.parent;!!this.hitCanvas._canvas.parentNode?v.content.removeChild(this.hitCanvas._canvas):v.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return jn.Layer=f,f.prototype.nodeType="Layer",(0,a._registerNode)(f),i.Factory.addGetterSetter(f,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(f,"clearBeforeDraw",!0),i.Factory.addGetterSetter(f,"hitGraphEnabled",!0,(0,s.getBooleanValidator)()),jn}var Zn={},ol;function Zd(){if(ol)return Zn;ol=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.FastLayer=void 0;const t=It(),e=sl(),n=mt();let i=class extends e.Layer{constructor(s){super(s),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return Zn.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),Zn}var qn={},al;function Ps(){if(al)return qn;al=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.Group=void 0;const t=It(),e=gr(),n=mt();let i=class extends e.Container{_validateAdd(s){const o=s.getType();o!=="Group"&&o!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return qn.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),qn}var Kn={},ll;function Ts(){if(ll)return Kn;ll=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.Animation=void 0;const t=mt(),e=It(),n=function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}}();let i=class Pn{constructor(s,o){this.id=Pn.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=s,this.setLayers(o)}setLayers(s){let o=[];return s&&(o=Array.isArray(s)?s:[s]),this.layers=o,this}getLayers(){return this.layers}addLayer(s){const o=this.layers,a=o.length;for(let l=0;l<a;l++)if(o[l]._id===s._id)return!1;return this.layers.push(s),!0}isRunning(){const o=Pn.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),Pn._addAnimation(this),this}stop(){return Pn._removeAnimation(this),this}_updateFrameObject(s){this.frame.timeDiff=s-this.frame.lastTime,this.frame.lastTime=s,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(s){this.animations.push(s),this._handleAnimation()}static _removeAnimation(s){const o=s.id,a=this.animations,l=a.length;for(let c=0;c<l;c++)if(a[c].id===o){this.animations.splice(c,1);break}}static _runFrames(){const s={},o=this.animations;for(let a=0;a<o.length;a++){const l=o[a],c=l.layers,h=l.func;l._updateFrameObject(n());const d=c.length;let g;if(h?g=h.call(l,l.frame)!==!1:g=!0,!!g)for(let f=0;f<d;f++){const p=c[f];p._id!==void 0&&(s[p._id]=p)}}for(const a in s)s.hasOwnProperty(a)&&s[a].batchDraw()}static _animationLoop(){const s=Pn;s.animations.length?(s._runFrames(),e.Util.requestAnimFrame(s._animationLoop)):s.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return Kn.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,Kn}var ks={},cl;function qd(){return cl||(cl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=It(),n=Ts(),i=Ft(),r=mt(),s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,l=3,c=["fill","stroke","shadowColor"];let h=0;class d{constructor(p,v,S,C,m,u,_){this.prop=p,this.propFunc=v,this.begin=C,this._pos=C,this.duration=u,this._change=0,this.prevPos=0,this.yoyo=_,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=S,this._change=m-this.begin,this.pause()}fire(p){const v=this[p];v&&v()}setTime(p){p>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():p<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=p,this.update())}getTime(){return this._time}setPosition(p){this.prevPos=this._pos,this.propFunc(p),this._pos=p}getPosition(p){return p===void 0&&(p=this._time),this.func(p,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(p){this.pause(),this._time=p,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const p=this.getTimer()-this._startTime;this.state===a?this.setTime(p):this.state===l&&this.setTime(this.duration-p)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(p){const v=this,S=p.node,C=S._id,m=p.easing||t.Easings.Linear,u=!!p.yoyo;let _,y;typeof p.duration>"u"?_=.3:p.duration===0?_=.001:_=p.duration,this.node=S,this._id=h++;const k=S.getLayer()||(S instanceof r.Konva.Stage?S.getLayers():null);k||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){v.tween.onEnterFrame()},k),this.tween=new d(y,function(I){v._tweenFunc(I)},m,0,1,_*1e3,u),this._addListeners(),g.attrs[C]||(g.attrs[C]={}),g.attrs[C][this._id]||(g.attrs[C][this._id]={}),g.tweens[C]||(g.tweens[C]={});for(y in p)s[y]===void 0&&this._addAttr(y,p[y]);this.reset(),this.onFinish=p.onFinish,this.onReset=p.onReset,this.onUpdate=p.onUpdate}_addAttr(p,v){const S=this.node,C=S._id;let m,u,_,y,k;const I=g.tweens[C][p];I&&delete g.attrs[C][I][p];let w=S.getAttr(p);if(e.Util._isArray(v))if(m=[],u=Math.max(v.length,w.length),p==="points"&&v.length!==w.length&&(v.length>w.length?(y=w,w=e.Util._prepareArrayForTween(w,v,S.closed())):(_=v,v=e.Util._prepareArrayForTween(v,w,S.closed()))),p.indexOf("fill")===0)for(let x=0;x<u;x++)if(x%2===0)m.push(v[x]-w[x]);else{const T=e.Util.colorToRGBA(w[x]);k=e.Util.colorToRGBA(v[x]),w[x]=T,m.push({r:k.r-T.r,g:k.g-T.g,b:k.b-T.b,a:k.a-T.a})}else for(let x=0;x<u;x++)m.push(v[x]-w[x]);else c.indexOf(p)!==-1?(w=e.Util.colorToRGBA(w),k=e.Util.colorToRGBA(v),m={r:k.r-w.r,g:k.g-w.g,b:k.b-w.b,a:k.a-w.a}):m=v-w;g.attrs[C][this._id][p]={start:w,diff:m,end:v,trueEnd:_,trueStart:y},g.tweens[C][p]=this._id}_tweenFunc(p){const v=this.node,S=g.attrs[v._id][this._id];let C,m,u,_,y,k,I,w;for(C in S){if(m=S[C],u=m.start,_=m.diff,w=m.end,e.Util._isArray(u))if(y=[],I=Math.max(u.length,w.length),C.indexOf("fill")===0)for(k=0;k<I;k++)k%2===0?y.push((u[k]||0)+_[k]*p):y.push("rgba("+Math.round(u[k].r+_[k].r*p)+","+Math.round(u[k].g+_[k].g*p)+","+Math.round(u[k].b+_[k].b*p)+","+(u[k].a+_[k].a*p)+")");else for(k=0;k<I;k++)y.push((u[k]||0)+_[k]*p);else c.indexOf(C)!==-1?y="rgba("+Math.round(u.r+_.r*p)+","+Math.round(u.g+_.g*p)+","+Math.round(u.b+_.b*p)+","+(u.a+_.a*p)+")":y=u+_*p;v.setAttr(C,y)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const p=this.node,v=g.attrs[p._id][this._id];v.points&&v.points.trueEnd&&p.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const p=this.node,v=g.attrs[p._id][this._id];v.points&&v.points.trueStart&&p.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(p){return this.tween.seek(p*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const p=this.node._id,v=this._id,S=g.tweens[p];this.pause(),this.anim&&this.anim.stop();for(const C in S)delete g.tweens[p][C];delete g.attrs[p][v],Object.keys(g.tweens[p]).length===0&&delete g.tweens[p],Object.keys(g.attrs[p]).length===0&&delete g.attrs[p]}}t.Tween=g,g.attrs={},g.tweens={},i.Node.prototype.to=function(f){const p=f.onFinish;f.node=this,f.onFinish=function(){this.destroy(),p&&p()},new g(f).play()},t.Easings={BackEaseIn(f,p,v,S){return v*(f/=S)*f*(2.70158*f-1.70158)+p},BackEaseOut(f,p,v,S){return v*((f=f/S-1)*f*(2.70158*f+1.70158)+1)+p},BackEaseInOut(f,p,v,S){let C=1.70158;return(f/=S/2)<1?v/2*(f*f*(((C*=1.525)+1)*f-C))+p:v/2*((f-=2)*f*(((C*=1.525)+1)*f+C)+2)+p},ElasticEaseIn(f,p,v,S,C,m){let u=0;return f===0?p:(f/=S)===1?p+v:(m||(m=S*.3),!C||C<Math.abs(v)?(C=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/C),-(C*Math.pow(2,10*(f-=1))*Math.sin((f*S-u)*(2*Math.PI)/m))+p)},ElasticEaseOut(f,p,v,S,C,m){let u=0;return f===0?p:(f/=S)===1?p+v:(m||(m=S*.3),!C||C<Math.abs(v)?(C=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/C),C*Math.pow(2,-10*f)*Math.sin((f*S-u)*(2*Math.PI)/m)+v+p)},ElasticEaseInOut(f,p,v,S,C,m){let u=0;return f===0?p:(f/=S/2)===2?p+v:(m||(m=S*.44999999999999996),!C||C<Math.abs(v)?(C=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/C),f<1?-.5*(C*Math.pow(2,10*(f-=1))*Math.sin((f*S-u)*(2*Math.PI)/m))+p:C*Math.pow(2,-10*(f-=1))*Math.sin((f*S-u)*(2*Math.PI)/m)*.5+v+p)},BounceEaseOut(f,p,v,S){return(f/=S)<.36363636363636365?v*(7.5625*f*f)+p:f<.7272727272727273?v*(7.5625*(f-=.5454545454545454)*f+.75)+p:f<.9090909090909091?v*(7.5625*(f-=.8181818181818182)*f+.9375)+p:v*(7.5625*(f-=.9545454545454546)*f+.984375)+p},BounceEaseIn(f,p,v,S){return v-t.Easings.BounceEaseOut(S-f,0,v,S)+p},BounceEaseInOut(f,p,v,S){return f<S/2?t.Easings.BounceEaseIn(f*2,0,v,S)*.5+p:t.Easings.BounceEaseOut(f*2-S,0,v,S)*.5+v*.5+p},EaseIn(f,p,v,S){return v*(f/=S)*f+p},EaseOut(f,p,v,S){return-v*(f/=S)*(f-2)+p},EaseInOut(f,p,v,S){return(f/=S/2)<1?v/2*f*f+p:-v/2*(--f*(f-2)-1)+p},StrongEaseIn(f,p,v,S){return v*(f/=S)*f*f*f*f+p},StrongEaseOut(f,p,v,S){return v*((f=f/S-1)*f*f*f*f+1)+p},StrongEaseInOut(f,p,v,S){return(f/=S/2)<1?v/2*f*f*f*f*f+p:v/2*((f-=2)*f*f*f*f+2)+p},Linear(f,p,v,S){return v*f/S+p}}}(ks)),ks}var hl;function Kd(){return hl||(hl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=mt(),n=It(),i=Ft(),r=gr(),s=jd(),o=sl(),a=Zd(),l=Ps(),c=Ss(),h=Lt(),d=Ts(),g=qd(),f=Za(),p=fr();t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:r.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:c.DD,Shape:h.Shape,shapes:h.shapes,Animation:d.Animation,Tween:g.Tween,Easings:g.Easings,Context:f.Context,Canvas:p.Canvas}),t.default=t.Konva}(_s)),_s}var Yn={},ul;function Yd(){if(ul)return Yn;ul=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.Arc=void 0;const t=_t(),e=Lt(),n=mt(),i=vt(),r=mt();let s=class extends e.Shape{_sceneFunc(a){const l=n.Konva.getAngle(this.angle()),c=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,c),a.arc(0,0,this.innerRadius(),l,0,!c),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),c=this.clockwise(),h=n.Konva.getAngle(c?360-this.angle():this.angle()),d=Math.cos(Math.min(h,Math.PI)),g=1,f=Math.sin(Math.min(Math.max(Math.PI,h),3*Math.PI/2)),p=Math.sin(Math.min(h,Math.PI/2)),v=d*(d>0?a:l),S=g*l,C=f*(f>0?a:l),m=p*(p>0?l:a);return{x:v,y:c?-1*m:C,width:S-v,height:m-C}}};return Yn.Arc=s,s.prototype._centroid=!0,s.prototype.className="Arc",s.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"clockwise",!1,(0,i.getBooleanValidator)()),Yn}var Xn={},Qn={},dl;function fl(){if(dl)return Qn;dl=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.Line=void 0;const t=_t(),e=mt(),n=Lt(),i=vt();function r(a,l,c,h,d,g,f){const p=Math.sqrt(Math.pow(c-a,2)+Math.pow(h-l,2)),v=Math.sqrt(Math.pow(d-c,2)+Math.pow(g-h,2)),S=f*p/(p+v),C=f*v/(p+v),m=c-S*(d-a),u=h-S*(g-l),_=c+C*(d-a),y=h+C*(g-l);return[m,u,_,y]}function s(a,l){const c=a.length,h=[];for(let d=2;d<c-2;d+=2){const g=r(a[d-2],a[d-1],a[d],a[d+1],a[d+2],a[d+3],l);isNaN(g[0])||(h.push(g[0]),h.push(g[1]),h.push(a[d]),h.push(a[d+1]),h.push(g[2]),h.push(g[3]))}return h}let o=class extends n.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const c=this.points(),h=c.length,d=this.tension(),g=this.closed(),f=this.bezier();if(!h)return;let p=0;if(l.beginPath(),l.moveTo(c[0],c[1]),d!==0&&h>4){const v=this.getTensionPoints(),S=v.length;for(p=g?0:4,g||l.quadraticCurveTo(v[0],v[1],v[2],v[3]);p<S-2;)l.bezierCurveTo(v[p++],v[p++],v[p++],v[p++],v[p++],v[p++]);g||l.quadraticCurveTo(v[S-2],v[S-1],c[h-2],c[h-1])}else if(f)for(p=2;p<h;)l.bezierCurveTo(c[p++],c[p++],c[p++],c[p++],c[p++],c[p++]);else for(p=2;p<h;p+=2)l.lineTo(c[p],c[p+1]);g?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():s(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),c=l.length,h=this.tension(),d=r(l[c-2],l[c-1],l[0],l[1],l[2],l[3],h),g=r(l[c-4],l[c-3],l[c-2],l[c-1],l[0],l[1],h),f=s(l,h);return[d[2],d[3]].concat(f).concat([g[0],g[1],l[c-2],l[c-1],g[2],g[3],d[0],d[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let c=l[0],h=l[0],d=l[1],g=l[1],f,p;for(let v=0;v<l.length/2;v++)f=l[v*2],p=l[v*2+1],c=Math.min(c,f),h=Math.max(h,f),d=Math.min(d,p),g=Math.max(g,p);return{x:c,y:d,width:h-c,height:g-d}}};return Qn.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),t.Factory.addGetterSetter(o,"closed",!1),t.Factory.addGetterSetter(o,"bezier",!1),t.Factory.addGetterSetter(o,"tension",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,"points",[],(0,i.getNumberArrayValidator)()),Qn}var Jn={},Es={},gl;function Xd(){return gl||(gl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,l)=>{let c,h;const g=l/2;c=0;for(let f=0;f<20;f++)h=g*t.tValues[20][f]+g,c+=t.cValues[20][f]*i(o,a,h);return g*c};t.getCubicArcLength=e;const n=(o,a,l)=>{l===void 0&&(l=1);const c=o[0]-2*o[1]+o[2],h=a[0]-2*a[1]+a[2],d=2*o[1]-2*o[0],g=2*a[1]-2*a[0],f=4*(c*c+h*h),p=4*(c*d+h*g),v=d*d+g*g;if(f===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const S=p/(2*f),C=v/f,m=l+S,u=C-S*S,_=m*m+u>0?Math.sqrt(m*m+u):0,y=S*S+u>0?Math.sqrt(S*S+u):0,k=S+Math.sqrt(S*S+u)!==0?u*Math.log(Math.abs((m+_)/(S+y))):0;return Math.sqrt(f)/2*(m*_-S*y+k)};t.getQuadraticArcLength=n;function i(o,a,l){const c=r(1,l,o),h=r(1,l,a),d=c*c+h*h;return Math.sqrt(d)}const r=(o,a,l)=>{const c=l.length-1;let h,d;if(c===0)return 0;if(o===0){d=0;for(let g=0;g<=c;g++)d+=t.binomialCoefficients[c][g]*Math.pow(1-a,c-g)*Math.pow(a,g)*l[g];return d}else{h=new Array(c);for(let g=0;g<c;g++)h[g]=c*(l[g+1]-l[g]);return r(o-1,a,h)}},s=(o,a,l)=>{let c=1,h=o/a,d=(o-l(h))/a,g=0;for(;c>.001;){const f=l(h+d),p=Math.abs(o-f)/a;if(p<c)c=p,h+=d;else{const v=l(h-d),S=Math.abs(o-v)/a;S<c?(c=S,h-=d):d/=2}if(g++,g>500)break}return h};t.t2length=s}(Es)),Es}var pl;function Rs(){if(pl)return Jn;pl=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.Path=void 0;const t=_t(),e=mt(),n=Lt(),i=Xd();let r=class Xt extends n.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Xt.parsePathData(this.data()),this.pathLength=Xt.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let l=!1;for(let c=0;c<a.length;c++){const h=a[c].command,d=a[c].points;switch(h){case"L":o.lineTo(d[0],d[1]);break;case"M":o.moveTo(d[0],d[1]);break;case"C":o.bezierCurveTo(d[0],d[1],d[2],d[3],d[4],d[5]);break;case"Q":o.quadraticCurveTo(d[0],d[1],d[2],d[3]);break;case"A":const g=d[0],f=d[1],p=d[2],v=d[3],S=d[4],C=d[5],m=d[6],u=d[7],_=p>v?p:v,y=p>v?1:p/v,k=p>v?v/p:1;o.translate(g,f),o.rotate(m),o.scale(y,k),o.arc(0,0,_,S,S+C,1-u),o.scale(1/y,1/k),o.rotate(-m),o.translate(-g,-f);break;case"z":l=!0,o.closePath();break}}!l&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(f){if(f.command==="A"){const p=f.points[4],v=f.points[5],S=f.points[4]+v;let C=Math.PI/180;if(Math.abs(p-S)<C&&(C=Math.abs(p-S)),v<0)for(let m=p-C;m>S;m-=C){const u=Xt.getPointOnEllipticalArc(f.points[0],f.points[1],f.points[2],f.points[3],m,0);o.push(u.x,u.y)}else for(let m=p+C;m<S;m+=C){const u=Xt.getPointOnEllipticalArc(f.points[0],f.points[1],f.points[2],f.points[3],m,0);o.push(u.x,u.y)}}else if(f.command==="C")for(let p=0;p<=1;p+=.01){const v=Xt.getPointOnCubicBezier(p,f.start.x,f.start.y,f.points[0],f.points[1],f.points[2],f.points[3],f.points[4],f.points[5]);o.push(v.x,v.y)}else o=o.concat(f.points)});let a=o[0],l=o[0],c=o[1],h=o[1],d,g;for(let f=0;f<o.length/2;f++)d=o[f*2],g=o[f*2+1],isNaN(d)||(a=Math.min(a,d),l=Math.max(l,d)),isNaN(g)||(c=Math.min(c,g),h=Math.max(h,g));return{x:a,y:c,width:l-a,height:h-c}}getLength(){return this.pathLength}getPointAtLength(o){return Xt.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,l,c){return Math.sqrt((l-o)*(l-o)+(c-a)*(c-a))}static getPathLength(o){let a=0;for(let l=0;l<o.length;++l)a+=o[l].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let l,c=0,h=a.length;if(!h)return null;for(;c<h&&o>a[c].pathLength;)o-=a[c].pathLength,++c;if(c===h)return l=a[c-1].points.slice(-2),{x:l[0],y:l[1]};if(o<.01)return a[c].command==="M"?(l=a[c].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[c].start.x,y:a[c].start.y};const d=a[c],g=d.points;switch(d.command){case"L":return Xt.getPointOnLine(o,d.start.x,d.start.y,g[0],g[1]);case"C":return Xt.getPointOnCubicBezier((0,i.t2length)(o,Xt.getPathLength(a),_=>(0,i.getCubicArcLength)([d.start.x,g[0],g[2],g[4]],[d.start.y,g[1],g[3],g[5]],_)),d.start.x,d.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return Xt.getPointOnQuadraticBezier((0,i.t2length)(o,Xt.getPathLength(a),_=>(0,i.getQuadraticArcLength)([d.start.x,g[0],g[2]],[d.start.y,g[1],g[3]],_)),d.start.x,d.start.y,g[0],g[1],g[2],g[3]);case"A":const f=g[0],p=g[1],v=g[2],S=g[3],C=g[5],m=g[6];let u=g[4];return u+=C*o/d.pathLength,Xt.getPointOnEllipticalArc(f,p,v,S,u,m)}return null}static getPointOnLine(o,a,l,c,h,d,g){d=d??a,g=g??l;const f=this.getLineLength(a,l,c,h);if(f<1e-10)return{x:a,y:l};if(c===a)return{x:d,y:g+(h>l?o:-o)};const p=(h-l)/(c-a),v=Math.sqrt(o*o/(1+p*p))*(c<a?-1:1),S=p*v;if(Math.abs(g-l-p*(d-a))<1e-10)return{x:d+v,y:g+S};const C=((d-a)*(c-a)+(g-l)*(h-l))/(f*f),m=a+C*(c-a),u=l+C*(h-l),_=this.getLineLength(d,g,m,u),y=Math.sqrt(o*o-_*_),k=Math.sqrt(y*y/(1+p*p))*(c<a?-1:1),I=p*k;return{x:m+k,y:u+I}}static getPointOnCubicBezier(o,a,l,c,h,d,g,f,p){function v(y){return y*y*y}function S(y){return 3*y*y*(1-y)}function C(y){return 3*y*(1-y)*(1-y)}function m(y){return(1-y)*(1-y)*(1-y)}const u=f*v(o)+d*S(o)+c*C(o)+a*m(o),_=p*v(o)+g*S(o)+h*C(o)+l*m(o);return{x:u,y:_}}static getPointOnQuadraticBezier(o,a,l,c,h,d,g){function f(m){return m*m}function p(m){return 2*m*(1-m)}function v(m){return(1-m)*(1-m)}const S=d*f(o)+c*p(o)+a*v(o),C=g*f(o)+h*p(o)+l*v(o);return{x:S,y:C}}static getPointOnEllipticalArc(o,a,l,c,h,d){const g=Math.cos(d),f=Math.sin(d),p={x:l*Math.cos(h),y:c*Math.sin(h)};return{x:o+(p.x*g-p.y*f),y:a+(p.x*f+p.y*g)}}static parsePathData(o){if(!o)return[];let a=o;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let S=0;S<l.length;S++)a=a.replace(new RegExp(l[S],"g"),"|"+l[S]);const c=a.split("|"),h=[],d=[];let g=0,f=0;const p=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let v;for(let S=1;S<c.length;S++){let C=c[S],m=C.charAt(0);for(C=C.slice(1),d.length=0;v=p.exec(C);)d.push(v[0]);const u=[];for(let _=0,y=d.length;_<y;_++){if(d[_]==="00"){u.push(0,0);continue}const k=parseFloat(d[_]);isNaN(k)?u.push(0):u.push(k)}for(;u.length>0&&!isNaN(u[0]);){let _="",y=[];const k=g,I=f;let w,x,T,N,D,L,U,z,X,b;switch(m){case"l":g+=u.shift(),f+=u.shift(),_="L",y.push(g,f);break;case"L":g=u.shift(),f=u.shift(),y.push(g,f);break;case"m":const P=u.shift(),M=u.shift();if(g+=P,f+=M,_="M",h.length>2&&h[h.length-1].command==="z"){for(let R=h.length-2;R>=0;R--)if(h[R].command==="M"){g=h[R].points[0]+P,f=h[R].points[1]+M;break}}y.push(g,f),m="l";break;case"M":g=u.shift(),f=u.shift(),_="M",y.push(g,f),m="L";break;case"h":g+=u.shift(),_="L",y.push(g,f);break;case"H":g=u.shift(),_="L",y.push(g,f);break;case"v":f+=u.shift(),_="L",y.push(g,f);break;case"V":f=u.shift(),_="L",y.push(g,f);break;case"C":y.push(u.shift(),u.shift(),u.shift(),u.shift()),g=u.shift(),f=u.shift(),y.push(g,f);break;case"c":y.push(g+u.shift(),f+u.shift(),g+u.shift(),f+u.shift()),g+=u.shift(),f+=u.shift(),_="C",y.push(g,f);break;case"S":x=g,T=f,w=h[h.length-1],w.command==="C"&&(x=g+(g-w.points[2]),T=f+(f-w.points[3])),y.push(x,T,u.shift(),u.shift()),g=u.shift(),f=u.shift(),_="C",y.push(g,f);break;case"s":x=g,T=f,w=h[h.length-1],w.command==="C"&&(x=g+(g-w.points[2]),T=f+(f-w.points[3])),y.push(x,T,g+u.shift(),f+u.shift()),g+=u.shift(),f+=u.shift(),_="C",y.push(g,f);break;case"Q":y.push(u.shift(),u.shift()),g=u.shift(),f=u.shift(),y.push(g,f);break;case"q":y.push(g+u.shift(),f+u.shift()),g+=u.shift(),f+=u.shift(),_="Q",y.push(g,f);break;case"T":x=g,T=f,w=h[h.length-1],w.command==="Q"&&(x=g+(g-w.points[0]),T=f+(f-w.points[1])),g=u.shift(),f=u.shift(),_="Q",y.push(x,T,g,f);break;case"t":x=g,T=f,w=h[h.length-1],w.command==="Q"&&(x=g+(g-w.points[0]),T=f+(f-w.points[1])),g+=u.shift(),f+=u.shift(),_="Q",y.push(x,T,g,f);break;case"A":N=u.shift(),D=u.shift(),L=u.shift(),U=u.shift(),z=u.shift(),X=g,b=f,g=u.shift(),f=u.shift(),_="A",y=this.convertEndpointToCenterParameterization(X,b,g,f,U,z,N,D,L);break;case"a":N=u.shift(),D=u.shift(),L=u.shift(),U=u.shift(),z=u.shift(),X=g,b=f,g+=u.shift(),f+=u.shift(),_="A",y=this.convertEndpointToCenterParameterization(X,b,g,f,U,z,N,D,L);break}h.push({command:_||m,points:y,start:{x:k,y:I},pathLength:this.calcLength(k,I,_||m,y)})}(m==="z"||m==="Z")&&h.push({command:"z",points:[],start:void 0,pathLength:0})}return h}static calcLength(o,a,l,c){let h,d,g,f;const p=Xt;switch(l){case"L":return p.getLineLength(o,a,c[0],c[1]);case"C":return(0,i.getCubicArcLength)([o,c[0],c[2],c[4]],[a,c[1],c[3],c[5]],1);case"Q":return(0,i.getQuadraticArcLength)([o,c[0],c[2]],[a,c[1],c[3]],1);case"A":h=0;const v=c[4],S=c[5],C=c[4]+S;let m=Math.PI/180;if(Math.abs(v-C)<m&&(m=Math.abs(v-C)),d=p.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],v,0),S<0)for(f=v-m;f>C;f-=m)g=p.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],f,0),h+=p.getLineLength(d.x,d.y,g.x,g.y),d=g;else for(f=v+m;f<C;f+=m)g=p.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],f,0),h+=p.getLineLength(d.x,d.y,g.x,g.y),d=g;return g=p.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],C,0),h+=p.getLineLength(d.x,d.y,g.x,g.y),h}return 0}static convertEndpointToCenterParameterization(o,a,l,c,h,d,g,f,p){const v=p*(Math.PI/180),S=Math.cos(v)*(o-l)/2+Math.sin(v)*(a-c)/2,C=-1*Math.sin(v)*(o-l)/2+Math.cos(v)*(a-c)/2,m=S*S/(g*g)+C*C/(f*f);m>1&&(g*=Math.sqrt(m),f*=Math.sqrt(m));let u=Math.sqrt((g*g*(f*f)-g*g*(C*C)-f*f*(S*S))/(g*g*(C*C)+f*f*(S*S)));h===d&&(u*=-1),isNaN(u)&&(u=0);const _=u*g*C/f,y=u*-f*S/g,k=(o+l)/2+Math.cos(v)*_-Math.sin(v)*y,I=(a+c)/2+Math.sin(v)*_+Math.cos(v)*y,w=function(z){return Math.sqrt(z[0]*z[0]+z[1]*z[1])},x=function(z,X){return(z[0]*X[0]+z[1]*X[1])/(w(z)*w(X))},T=function(z,X){return(z[0]*X[1]<z[1]*X[0]?-1:1)*Math.acos(x(z,X))},N=T([1,0],[(S-_)/g,(C-y)/f]),D=[(S-_)/g,(C-y)/f],L=[(-1*S-_)/g,(-1*C-y)/f];let U=T(D,L);return x(D,L)<=-1&&(U=Math.PI),x(D,L)>=1&&(U=0),d===0&&U>0&&(U=U-2*Math.PI),d===1&&U<0&&(U=U+2*Math.PI),[k,I,g,f,N,U,v,d]}};return Jn.Path=r,r.prototype.className="Path",r.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(r),t.Factory.addGetterSetter(r,"data"),Jn}var ml;function Qd(){if(ml)return Xn;ml=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.Arrow=void 0;const t=_t(),e=fl(),n=vt(),i=mt(),r=Rs();let s=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,c=this.points();let h=c;const d=this.tension()!==0&&c.length>4;d&&(h=this.getTensionPoints());const g=this.pointerLength(),f=c.length;let p,v;if(d){const m=[h[h.length-4],h[h.length-3],h[h.length-2],h[h.length-1],c[f-2],c[f-1]],u=r.Path.calcLength(h[h.length-4],h[h.length-3],"C",m),_=r.Path.getPointOnQuadraticBezier(Math.min(1,1-g/u),m[0],m[1],m[2],m[3],m[4],m[5]);p=c[f-2]-_.x,v=c[f-1]-_.y}else p=c[f-2]-c[f-4],v=c[f-1]-c[f-3];const S=(Math.atan2(v,p)+l)%l,C=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(c[f-2],c[f-1]),a.rotate(S),a.moveTo(0,0),a.lineTo(-g,C/2),a.lineTo(-g,-C/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(c[0],c[1]),d?(p=(h[0]+h[2])/2-c[0],v=(h[1]+h[3])/2-c[1]):(p=c[2]-c[0],v=c[3]-c[1]),a.rotate((Math.atan2(-v,-p)+l)%l),a.moveTo(0,0),a.lineTo(-g,C/2),a.lineTo(-g,-C/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return Xn.Arrow=s,s.prototype.className="Arrow",(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"pointerLength",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"pointerWidth",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"pointerAtBeginning",!1),t.Factory.addGetterSetter(s,"pointerAtEnding",!0),Xn}var ti={},_l;function Jd(){if(_l)return ti;_l=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.Circle=void 0;const t=_t(),e=Lt(),n=vt(),i=mt();let r=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}};return ti.Circle=r,r.prototype._centroid=!0,r.prototype.className="Circle",r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,n.getNumberValidator)()),ti}var ei={},vl;function tf(){if(vl)return ei;vl=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.Ellipse=void 0;const t=_t(),e=Lt(),n=vt(),i=mt();let r=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),l=this.radiusY();o.beginPath(),o.save(),a!==l&&o.scale(1,l/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return ei.Ellipse=r,r.prototype.className="Ellipse",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(r),t.Factory.addComponentsGetterSetter(r,"radius",["x","y"]),t.Factory.addGetterSetter(r,"radiusX",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"radiusY",0,(0,n.getNumberValidator)()),ei}var ni={},bl;function ef(){if(bl)return ni;bl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.Image=void 0;const t=It(),e=_t(),n=Lt(),i=mt(),r=vt();let s=class hh extends n.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),c=this.getHeight(),h=this.cornerRadius(),d=this.attrs.image;let g;if(d){const f=this.attrs.cropWidth,p=this.attrs.cropHeight;f&&p?g=[d,this.cropX(),this.cropY(),f,p,0,0,l,c]:g=[d,0,0,l,c]}(this.hasFill()||this.hasStroke()||h)&&(a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)),d&&(h&&a.clip(),a.drawImage.apply(a,g))}_hitFunc(a){const l=this.width(),c=this.height(),h=this.cornerRadius();a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,c=null){const h=t.Util.createImageElement();h.onload=function(){const d=new hh({image:h});l(d)},h.onerror=c,h.crossOrigin="Anonymous",h.src=a}};return ni.Image=s,s.prototype.className="Image",(0,i._registerNode)(s),e.Factory.addGetterSetter(s,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(s,"image"),e.Factory.addComponentsGetterSetter(s,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(s,"cropX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropY",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropWidth",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropHeight",0,(0,r.getNumberValidator)()),ni}var Qe={},yl;function nf(){if(yl)return Qe;yl=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.Tag=Qe.Label=void 0;const t=_t(),e=Lt(),n=Ps(),i=vt(),r=mt(),s=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",l="up",c="right",h="down",d="left",g=s.length;let f=class extends n.Group{constructor(S){super(S),this.on("add.konva",function(C){this._addListeners(C.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(S){let C=this,m;const u=function(){C._sync()};for(m=0;m<g;m++)S.on(s[m]+o,u)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let S=this.getText(),C=this.getTag(),m,u,_,y,k,I,w;if(S&&C){switch(m=S.width(),u=S.height(),_=C.pointerDirection(),y=C.pointerWidth(),w=C.pointerHeight(),k=0,I=0,_){case l:k=m/2,I=-1*w;break;case c:k=m+y,I=u/2;break;case h:k=m/2,I=u+w;break;case d:k=-1*y,I=u/2;break}C.setAttrs({x:-1*k,y:-1*I,width:m,height:u}),S.setAttrs({x:-1*k,y:-1*I})}}};Qe.Label=f,f.prototype.className="Label",(0,r._registerNode)(f);class p extends e.Shape{_sceneFunc(S){const C=this.width(),m=this.height(),u=this.pointerDirection(),_=this.pointerWidth(),y=this.pointerHeight(),k=this.cornerRadius();let I=0,w=0,x=0,T=0;typeof k=="number"?I=w=x=T=Math.min(k,C/2,m/2):(I=Math.min(k[0]||0,C/2,m/2),w=Math.min(k[1]||0,C/2,m/2),T=Math.min(k[2]||0,C/2,m/2),x=Math.min(k[3]||0,C/2,m/2)),S.beginPath(),S.moveTo(I,0),u===l&&(S.lineTo((C-_)/2,0),S.lineTo(C/2,-1*y),S.lineTo((C+_)/2,0)),S.lineTo(C-w,0),S.arc(C-w,w,w,Math.PI*3/2,0,!1),u===c&&(S.lineTo(C,(m-y)/2),S.lineTo(C+_,m/2),S.lineTo(C,(m+y)/2)),S.lineTo(C,m-T),S.arc(C-T,m-T,T,0,Math.PI/2,!1),u===h&&(S.lineTo((C+_)/2,m),S.lineTo(C/2,m+y),S.lineTo((C-_)/2,m)),S.lineTo(x,m),S.arc(x,m-x,x,Math.PI/2,Math.PI,!1),u===d&&(S.lineTo(0,(m+y)/2),S.lineTo(-1*_,m/2),S.lineTo(0,(m-y)/2)),S.lineTo(0,I),S.arc(I,I,I,Math.PI,Math.PI*3/2,!1),S.closePath(),S.fillStrokeShape(this)}getSelfRect(){let S=0,C=0,m=this.pointerWidth(),u=this.pointerHeight(),_=this.pointerDirection(),y=this.width(),k=this.height();return _===l?(C-=u,k+=u):_===h?k+=u:_===d?(S-=m*1.5,y+=m):_===c&&(y+=m*1.5),{x:S,y:C,width:y,height:k}}}return Qe.Tag=p,p.prototype.className="Tag",(0,r._registerNode)(p),t.Factory.addGetterSetter(p,"pointerDirection",a),t.Factory.addGetterSetter(p,"pointerWidth",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(p,"pointerHeight",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(p,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),Qe}var ii={},Sl;function wl(){if(Sl)return ii;Sl=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.Rect=void 0;const t=_t(),e=Lt(),n=mt(),i=It(),r=vt();let s=class extends e.Shape{_sceneFunc(a){const l=this.cornerRadius(),c=this.width(),h=this.height();a.beginPath(),l?i.Util.drawRoundedRectPath(a,c,h,l):a.rect(0,0,c,h),a.closePath(),a.fillStrokeShape(this)}};return ii.Rect=s,s.prototype.className="Rect",(0,n._registerNode)(s),t.Factory.addGetterSetter(s,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),ii}var ri={},xl;function rf(){if(xl)return ri;xl=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.RegularPolygon=void 0;const t=_t(),e=Lt(),n=vt(),i=mt();let r=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)o.lineTo(a[l].x,a[l].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let c=0;c<o;c++)l.push({x:a*Math.sin(c*2*Math.PI/o),y:-1*a*Math.cos(c*2*Math.PI/o)});return l}getSelfRect(){const o=this._getPoints();let a=o[0].x,l=o[0].y,c=o[0].x,h=o[0].y;return o.forEach(d=>{a=Math.min(a,d.x),l=Math.max(l,d.x),c=Math.min(c,d.y),h=Math.max(h,d.y)}),{x:a,y:c,width:l-a,height:h-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return ri.RegularPolygon=r,r.prototype.className="RegularPolygon",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"sides",0,(0,n.getNumberValidator)()),ri}var si={},Cl;function sf(){if(Cl)return si;Cl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.Ring=void 0;const t=_t(),e=Lt(),n=vt(),i=mt(),r=Math.PI*2;let s=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,r,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),r,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return si.Ring=s,s.prototype.className="Ring",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,n.getNumberValidator)()),si}var oi={},Pl;function of(){if(Pl)return oi;Pl=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.Sprite=void 0;const t=_t(),e=Lt(),n=Ts(),i=vt(),r=mt();let s=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new n.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,d=this.animations()[l],g=this.frameOffsets(),f=d[h+0],p=d[h+1],v=d[h+2],S=d[h+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,v,S),a.closePath(),a.fillStrokeShape(this)),C)if(g){const m=g[l],u=c*2;a.drawImage(C,f,p,v,S,m[u+0],m[u+1],v,S)}else a.drawImage(C,f,p,v,S,0,0,v,S)}_hitFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,d=this.animations()[l],g=this.frameOffsets(),f=d[h+2],p=d[h+3];if(a.beginPath(),g){const v=g[l],S=c*2;a.rect(v[S+0],v[S+1],f,p)}else a.rect(0,0,f,p);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),c=this.animations(),h=c[l],d=h.length/4;a<d-1?this.frameIndex(a+1):this.frameIndex(0)}};return oi.Sprite=s,s.prototype.className="Sprite",(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"animation"),t.Factory.addGetterSetter(s,"animations"),t.Factory.addGetterSetter(s,"frameOffsets"),t.Factory.addGetterSetter(s,"image"),t.Factory.addGetterSetter(s,"frameIndex",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"frameRate",17,(0,i.getNumberValidator)()),t.Factory.backCompat(s,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),oi}var ai={},Tl;function af(){if(Tl)return ai;Tl=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.Star=void 0;const t=_t(),e=Lt(),n=vt(),i=mt();let r=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),l=this.outerRadius(),c=this.numPoints();o.beginPath(),o.moveTo(0,0-l);for(let h=1;h<c*2;h++){const d=h%2===0?l:a,g=d*Math.sin(h*Math.PI/c),f=-1*d*Math.cos(h*Math.PI/c);o.lineTo(g,f)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return ai.Star=r,r.prototype.className="Star",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"numPoints",5,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,n.getNumberValidator)()),ai}var gn={},kl;function El(){if(kl)return gn;kl=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.Text=void 0,gn.stringToArray=o;const t=It(),e=_t(),n=Lt(),i=mt(),r=vt(),s=mt();function o(H){return[...H].reduce((G,Q,st,V)=>{if(/\p{Emoji}/u.test(Q)){const A=V[st+1];A&&/\p{Emoji_Modifier}|\u200D/u.test(A)?(G.push(Q+A),V[st+1]=""):G.push(Q)}else/\p{Regional_Indicator}{2}/u.test(Q+(V[st+1]||""))?G.push(Q+V[st+1]):st>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(Q)?G[G.length-1]+=Q:Q&&G.push(Q);return G},[])}const a="auto",l="center",c="inherit",h="justify",d="Change.konva",g="2d",f="-",p="left",v="text",S="Text",C="top",m="bottom",u="middle",_="normal",y="px ",k=" ",I="right",w="rtl",x="word",T="char",N="none",D="",L=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],U=L.length;function z(H){return H.split(",").map(G=>{G=G.trim();const Q=G.indexOf(" ")>=0,st=G.indexOf('"')>=0||G.indexOf("'")>=0;return Q&&!st&&(G=`"${G}"`),G}).join(", ")}let X;function b(){return X||(X=t.Util.createCanvasElement().getContext(g),X)}function P(H){H.fillText(this._partialText,this._partialTextX,this._partialTextY)}function M(H){H.setAttr("miterLimit",2),H.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function R(H){return H=H||{},!H.fillLinearGradientColorStops&&!H.fillRadialGradientColorStops&&!H.fillPatternImage&&(H.fill=H.fill||"black"),H}let F=class extends n.Shape{constructor(G){super(R(G)),this._partialTextX=0,this._partialTextY=0;for(let Q=0;Q<U;Q++)this.on(L[Q]+d,this._setTextData);this._setTextData()}_sceneFunc(G){const Q=this.textArr,st=Q.length;if(!this.text())return;let V=this.padding(),A=this.fontSize(),$=this.lineHeight()*A,it=this.verticalAlign(),ot=this.direction(),lt=0,E=this.align(),O=this.getWidth(),B=this.letterSpacing(),j=this.fill(),Y=this.textDecoration(),q=Y.indexOf("underline")!==-1,J=Y.indexOf("line-through")!==-1,rt;ot=ot===c?G.direction:ot;let et=$/2,tt=u;if(i.Konva._fixTextRendering){const Z=this.measureSize("M");tt="alphabetic",et=(Z.fontBoundingBoxAscent-Z.fontBoundingBoxDescent)/2+$/2}for(ot===w&&G.setAttr("direction",ot),G.setAttr("font",this._getContextFont()),G.setAttr("textBaseline",tt),G.setAttr("textAlign",p),it===u?lt=(this.getHeight()-st*$-V*2)/2:it===m&&(lt=this.getHeight()-st*$-V*2),G.translate(V,lt+V),rt=0;rt<st;rt++){let Z=0,W=0;const nt=Q[rt],at=nt.text,ht=nt.width,gt=nt.lastInParagraph;if(G.save(),E===I?Z+=O-ht-V*2:E===l&&(Z+=(O-ht-V*2)/2),q){G.save(),G.beginPath();const dt=i.Konva._fixTextRendering?Math.round(A/4):Math.round(A/2),Pt=Z,St=et+W+dt;G.moveTo(Pt,St);const Et=E===h&&!gt?O-V*2:ht;G.lineTo(Pt+Math.round(Et),St),G.lineWidth=A/15;const $t=this._getLinearGradient();G.strokeStyle=$t||j,G.stroke(),G.restore()}if(J){G.save(),G.beginPath();const dt=i.Konva._fixTextRendering?-Math.round(A/4):0;G.moveTo(Z,et+W+dt);const Pt=E===h&&!gt?O-V*2:ht;G.lineTo(Z+Math.round(Pt),et+W+dt),G.lineWidth=A/15;const St=this._getLinearGradient();G.strokeStyle=St||j,G.stroke(),G.restore()}if(ot!==w&&(B!==0||E===h)){const dt=at.split(" ").length-1,Pt=o(at);for(let St=0;St<Pt.length;St++){const Et=Pt[St];Et===" "&&!gt&&E===h&&(Z+=(O-V*2-ht)/dt),this._partialTextX=Z,this._partialTextY=et+W,this._partialText=Et,G.fillStrokeShape(this),Z+=this.measureSize(Et).width+B}}else B!==0&&G.setAttr("letterSpacing",`${B}px`),this._partialTextX=Z,this._partialTextY=et+W,this._partialText=at,G.fillStrokeShape(this);G.restore(),st>1&&(et+=$)}}_hitFunc(G){const Q=this.getWidth(),st=this.getHeight();G.beginPath(),G.rect(0,0,Q,st),G.closePath(),G.fillStrokeShape(this)}setText(G){const Q=t.Util._isString(G)?G:G==null?"":G+"";return this._setAttr(v,Q),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(G){var Q,st,V,A,$,it,ot,lt,E,O,B;let j=b(),Y=this.fontSize(),q;j.save(),j.font=this._getContextFont(),q=j.measureText(G),j.restore();const J=Y/100;return{actualBoundingBoxAscent:(Q=q.actualBoundingBoxAscent)!==null&&Q!==void 0?Q:71.58203125*J,actualBoundingBoxDescent:(st=q.actualBoundingBoxDescent)!==null&&st!==void 0?st:0,actualBoundingBoxLeft:(V=q.actualBoundingBoxLeft)!==null&&V!==void 0?V:-7.421875*J,actualBoundingBoxRight:(A=q.actualBoundingBoxRight)!==null&&A!==void 0?A:75.732421875*J,alphabeticBaseline:($=q.alphabeticBaseline)!==null&&$!==void 0?$:0,emHeightAscent:(it=q.emHeightAscent)!==null&&it!==void 0?it:100*J,emHeightDescent:(ot=q.emHeightDescent)!==null&&ot!==void 0?ot:-20*J,fontBoundingBoxAscent:(lt=q.fontBoundingBoxAscent)!==null&&lt!==void 0?lt:91*J,fontBoundingBoxDescent:(E=q.fontBoundingBoxDescent)!==null&&E!==void 0?E:21*J,hangingBaseline:(O=q.hangingBaseline)!==null&&O!==void 0?O:72.80000305175781*J,ideographicBaseline:(B=q.ideographicBaseline)!==null&&B!==void 0?B:-21*J,width:q.width,height:Y}}_getContextFont(){return this.fontStyle()+k+this.fontVariant()+k+(this.fontSize()+y)+z(this.fontFamily())}_addTextLine(G){this.align()===h&&(G=G.trim());const st=this._getTextWidth(G);return this.textArr.push({text:G,width:st,lastInParagraph:!1})}_getTextWidth(G){const Q=this.letterSpacing(),st=G.length;return b().measureText(G).width+Q*st}_setTextData(){let G=this.text().split(`
`),Q=+this.fontSize(),st=0,V=this.lineHeight()*Q,A=this.attrs.width,$=this.attrs.height,it=A!==a&&A!==void 0,ot=$!==a&&$!==void 0,lt=this.padding(),E=A-lt*2,O=$-lt*2,B=0,j=this.wrap(),Y=j!==N,q=j!==T&&Y,J=this.ellipsis();this.textArr=[],b().font=this._getContextFont();const rt=J?this._getTextWidth(D):0;for(let et=0,tt=G.length;et<tt;++et){let Z=G[et],W=this._getTextWidth(Z);if(it&&W>E)for(;Z.length>0;){let nt=0,at=o(Z).length,ht="",gt=0;for(;nt<at;){const dt=nt+at>>>1,Pt=o(Z),St=Pt.slice(0,dt+1).join(""),Et=this._getTextWidth(St);(J&&ot&&B+V>O?Et+rt:Et)<=E?(nt=dt+1,ht=St,gt=Et):at=dt}if(ht){if(q){const St=o(Z),Et=o(ht),$t=St[Et.length],$e=$t===k||$t===f;let nn;if($e&&gt<=E)nn=Et.length;else{const qt=Et.lastIndexOf(k),ae=Et.lastIndexOf(f);nn=Math.max(qt,ae)+1}nn>0&&(nt=nn,ht=St.slice(0,nt).join(""),gt=this._getTextWidth(ht))}if(ht=ht.trimRight(),this._addTextLine(ht),st=Math.max(st,gt),B+=V,this._shouldHandleEllipsis(B)){this._tryToAddEllipsisToLastLine();break}if(Z=o(Z).slice(nt).join("").trimLeft(),Z.length>0&&(W=this._getTextWidth(Z),W<=E)){this._addTextLine(Z),B+=V,st=Math.max(st,W);break}}else break}else this._addTextLine(Z),B+=V,st=Math.max(st,W),this._shouldHandleEllipsis(B)&&et<tt-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),ot&&B+V>O)break}this.textHeight=Q,this.textWidth=st}_shouldHandleEllipsis(G){const Q=+this.fontSize(),st=this.lineHeight()*Q,V=this.attrs.height,A=V!==a&&V!==void 0,$=this.padding(),it=V-$*2;return!(this.wrap()!==N)||A&&G+st>it}_tryToAddEllipsisToLastLine(){const G=this.attrs.width,Q=G!==a&&G!==void 0,st=this.padding(),V=G-st*2,A=this.ellipsis(),$=this.textArr[this.textArr.length-1];!$||!A||(Q&&(this._getTextWidth($.text+D)<V||($.text=$.text.slice(0,$.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine($.text+D))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const G=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,Q=this.hasShadow();return G&&Q?!0:super._useBufferCanvas()}};return gn.Text=F,F.prototype._fillFunc=P,F.prototype._strokeFunc=M,F.prototype.className=S,F.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,s._registerNode)(F),e.Factory.overWriteSetter(F,"width",(0,r.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(F,"height",(0,r.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(F,"direction",c),e.Factory.addGetterSetter(F,"fontFamily","Arial"),e.Factory.addGetterSetter(F,"fontSize",12,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"fontStyle",_),e.Factory.addGetterSetter(F,"fontVariant",_),e.Factory.addGetterSetter(F,"padding",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"align",p),e.Factory.addGetterSetter(F,"verticalAlign",C),e.Factory.addGetterSetter(F,"lineHeight",1,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"wrap",x),e.Factory.addGetterSetter(F,"ellipsis",!1,(0,r.getBooleanValidator)()),e.Factory.addGetterSetter(F,"letterSpacing",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"text","",(0,r.getStringValidator)()),e.Factory.addGetterSetter(F,"textDecoration",""),gn}var li={},Rl;function lf(){if(Rl)return li;Rl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.TextPath=void 0;const t=It(),e=_t(),n=Lt(),i=Rs(),r=El(),s=vt(),o=mt(),a="",l="normal";function c(g){g.fillText(this.partialText,0,0)}function h(g){g.strokeText(this.partialText,0,0)}let d=class extends n.Shape{constructor(f){super(f),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(f){if(!this.attrs.data)return null;const p=this.pathLength;return f-1>p?null:i.Path.getPointAtLengthOfDataArray(f,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(f){f.setAttr("font",this._getContextFont()),f.setAttr("textBaseline",this.textBaseline()),f.setAttr("textAlign","left"),f.save();const p=this.textDecoration(),v=this.fill(),S=this.fontSize(),C=this.glyphInfo;p==="underline"&&f.beginPath();for(let m=0;m<C.length;m++){f.save();const u=C[m].p0;f.translate(u.x,u.y),f.rotate(C[m].rotation),this.partialText=C[m].text,f.fillStrokeShape(this),p==="underline"&&(m===0&&f.moveTo(0,S/2+1),f.lineTo(S,S/2+1)),f.restore()}p==="underline"&&(f.strokeStyle=v,f.lineWidth=S/20,f.stroke()),f.restore()}_hitFunc(f){f.beginPath();const p=this.glyphInfo;if(p.length>=1){const v=p[0].p0;f.moveTo(v.x,v.y)}for(let v=0;v<p.length;v++){const S=p[v].p1;f.lineTo(S.x,S.y)}f.setAttr("lineWidth",this.fontSize()),f.setAttr("strokeStyle",this.colorKey),f.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(f){return r.Text.prototype.setText.call(this,f)}_getContextFont(){return r.Text.prototype._getContextFont.call(this)}_getTextSize(f){const v=this.dummyCanvas.getContext("2d");v.save(),v.font=this._getContextFont();const S=v.measureText(f);return v.restore(),{width:S.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:f,height:p}=this._getTextSize(this.attrs.text);if(this.textWidth=f,this.textHeight=p,this.glyphInfo=[],!this.attrs.data)return null;const v=this.letterSpacing(),S=this.align(),C=this.kerningFunc(),m=Math.max(this.textWidth+((this.attrs.text||"").length-1)*v,0);let u=0;S==="center"&&(u=Math.max(0,this.pathLength/2-m/2)),S==="right"&&(u=Math.max(0,this.pathLength-m));const _=(0,r.stringToArray)(this.text());let y=u;for(let k=0;k<_.length;k++){const I=this._getPointAtLength(y);if(!I)return;let w=this._getTextSize(_[k]).width+v;if(_[k]===" "&&S==="justify"){const U=this.text().split(" ").length-1;w+=(this.pathLength-m)/U}const x=this._getPointAtLength(y+w);if(!x)return;const T=i.Path.getLineLength(I.x,I.y,x.x,x.y);let N=0;if(C)try{N=C(_[k-1],_[k])*this.fontSize()}catch{N=0}I.x+=N,x.x+=N,this.textWidth+=N;const D=i.Path.getPointOnLine(N+T/2,I.x,I.y,x.x,x.y),L=Math.atan2(x.y-I.y,x.x-I.x);this.glyphInfo.push({transposeX:D.x,transposeY:D.y,text:_[k],rotation:L,p0:I,p1:x}),y+=w}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const f=[];this.glyphInfo.forEach(function(y){f.push(y.p0.x),f.push(y.p0.y),f.push(y.p1.x),f.push(y.p1.y)});let p=f[0]||0,v=f[0]||0,S=f[1]||0,C=f[1]||0,m,u;for(let y=0;y<f.length/2;y++)m=f[y*2],u=f[y*2+1],p=Math.min(p,m),v=Math.max(v,m),S=Math.min(S,u),C=Math.max(C,u);const _=this.fontSize();return{x:p-_/2,y:S-_/2,width:v-p+_,height:C-S+_}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return li.TextPath=d,d.prototype._fillFunc=c,d.prototype._strokeFunc=h,d.prototype._fillFuncHit=c,d.prototype._strokeFuncHit=h,d.prototype.className="TextPath",d.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(d),e.Factory.addGetterSetter(d,"data"),e.Factory.addGetterSetter(d,"fontFamily","Arial"),e.Factory.addGetterSetter(d,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(d,"fontStyle",l),e.Factory.addGetterSetter(d,"align","left"),e.Factory.addGetterSetter(d,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(d,"textBaseline","middle"),e.Factory.addGetterSetter(d,"fontVariant",l),e.Factory.addGetterSetter(d,"text",a),e.Factory.addGetterSetter(d,"textDecoration",""),e.Factory.addGetterSetter(d,"kerningFunc",void 0),li}var ci={},Al;function cf(){if(Al)return ci;Al=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.Transformer=void 0;const t=It(),e=_t(),n=Ft(),i=Lt(),r=wl(),s=Ps(),o=mt(),a=vt(),l=mt(),c="tr-konva",h=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(w=>w+`.${c}`).join(" "),d="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],f={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},p="ontouchstart"in o.Konva._global;function v(w,x,T){if(w==="rotater")return T;x+=t.Util.degToRad(f[w]||0);const N=(t.Util.radToDeg(x)%360+360)%360;return t.Util._inRange(N,337.5,360)||t.Util._inRange(N,0,22.5)?"ns-resize":t.Util._inRange(N,22.5,67.5)?"nesw-resize":t.Util._inRange(N,67.5,112.5)?"ew-resize":t.Util._inRange(N,112.5,157.5)?"nwse-resize":t.Util._inRange(N,157.5,202.5)?"ns-resize":t.Util._inRange(N,202.5,247.5)?"nesw-resize":t.Util._inRange(N,247.5,292.5)?"ew-resize":t.Util._inRange(N,292.5,337.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+N),"pointer")}const S=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function C(w){return{x:w.x+w.width/2*Math.cos(w.rotation)+w.height/2*Math.sin(-w.rotation),y:w.y+w.height/2*Math.cos(w.rotation)+w.width/2*Math.sin(w.rotation)}}function m(w,x,T){const N=T.x+(w.x-T.x)*Math.cos(x)-(w.y-T.y)*Math.sin(x),D=T.y+(w.x-T.x)*Math.sin(x)+(w.y-T.y)*Math.cos(x);return{...w,rotation:w.rotation+x,x:N,y:D}}function u(w,x){const T=C(w);return m(w,x,T)}function _(w,x,T){let N=x;for(let D=0;D<w.length;D++){const L=o.Konva.getAngle(w[D]),U=Math.abs(L-x)%(Math.PI*2);Math.min(U,Math.PI*2-U)<T&&(N=L)}return N}let y=0,k=class extends s.Group{constructor(x){super(x),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(h,this.update),this.getNode()&&this.update()}attachTo(x){return this.setNode(x),this}setNode(x){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([x])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(x=[]){this._nodes&&this._nodes.length&&this.detach();const T=x.filter(D=>D.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=x=T,x.length===1&&this.useSingleNodeRotation()?this.rotation(x[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(D=>{const L=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(D._attrsAffectingSize.length){const U=D._attrsAffectingSize.map(z=>z+"Change."+this._getEventNamespace()).join(" ");D.on(U,L)}D.on(g.map(U=>U+`.${this._getEventNamespace()}`).join(" "),L),D.on(`absoluteTransformChange.${this._getEventNamespace()}`,L),this._proxyDrag(D)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(x){let T;x.on(`dragstart.${this._getEventNamespace()}`,N=>{T=x.getAbsolutePosition(),!this.isDragging()&&x!==this.findOne(".back")&&this.startDrag(N,!1)}),x.on(`dragmove.${this._getEventNamespace()}`,N=>{if(!T)return;const D=x.getAbsolutePosition(),L=D.x-T.x,U=D.y-T.y;this.nodes().forEach(z=>{if(z===x||z.isDragging())return;const X=z.getAbsolutePosition();z.setAbsolutePosition({x:X.x+L,y:X.y+U}),z.startDrag(N)}),T=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(x=>{x.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(d),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(d,this.__getNodeRect)}__getNodeShape(x,T=this.rotation(),N){const D=x.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),L=x.getAbsoluteScale(N),U=x.getAbsolutePosition(N),z=D.x*L.x-x.offsetX()*L.x,X=D.y*L.y-x.offsetY()*L.y,b=(o.Konva.getAngle(x.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),P={x:U.x+z*Math.cos(b)+X*Math.sin(-b),y:U.y+X*Math.cos(b)+z*Math.sin(b),width:D.width*L.x,height:D.height*L.y,rotation:b};return m(P,-o.Konva.getAngle(T),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const T=[];this.nodes().map(b=>{const P=b.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),M=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}],R=b.getAbsoluteTransform();M.forEach(function(F){const H=R.point(F);T.push(H)})});const N=new t.Transform;N.rotate(-o.Konva.getAngle(this.rotation()));let D=1/0,L=1/0,U=-1/0,z=-1/0;T.forEach(function(b){const P=N.point(b);D===void 0&&(D=U=P.x,L=z=P.y),D=Math.min(D,P.x),L=Math.min(L,P.y),U=Math.max(U,P.x),z=Math.max(z,P.y)}),N.invert();const X=N.point({x:D,y:L});return{x:X.x,y:X.y,width:U-D,height:z-L,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S.forEach(x=>{this._createAnchor(x)}),this._createAnchor("rotater")}_createAnchor(x){const T=new r.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:x+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:p?10:"auto"}),N=this;T.on("mousedown touchstart",function(D){N._handleMouseDown(D)}),T.on("dragstart",D=>{T.stopDrag(),D.cancelBubble=!0}),T.on("dragend",D=>{D.cancelBubble=!0}),T.on("mouseenter",()=>{const D=o.Konva.getAngle(this.rotation()),L=this.rotateAnchorCursor(),U=v(x,D,L);T.getStage().content&&(T.getStage().content.style.cursor=U),this._cursorChange=!0}),T.on("mouseout",()=>{T.getStage().content&&(T.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(T)}_createBack(){const x=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(T,N){const D=N.getParent(),L=D.padding();T.beginPath(),T.rect(-L,-L,N.width()+L*2,N.height()+L*2),T.moveTo(N.width()/2,-L),D.rotateEnabled()&&D.rotateLineVisible()&&T.lineTo(N.width()/2,-D.rotateAnchorOffset()*t.Util._sign(N.height())-L),T.fillStrokeShape(N)},hitFunc:(T,N)=>{if(!this.shouldOverdrawWholeArea())return;const D=this.padding();T.beginPath(),T.rect(-D,-D,N.width()+D*2,N.height()+D*2),T.fillStrokeShape(N)}});this.add(x),this._proxyDrag(x),x.on("dragstart",T=>{T.cancelBubble=!0}),x.on("dragmove",T=>{T.cancelBubble=!0}),x.on("dragend",T=>{T.cancelBubble=!0}),this.on("dragmove",T=>{this.update()})}_handleMouseDown(x){if(this._transforming)return;this._movingAnchorName=x.target.name().split(" ")[0];const T=this._getNodeRect(),N=T.width,D=T.height,L=Math.sqrt(Math.pow(N,2)+Math.pow(D,2));this.sin=Math.abs(D/L),this.cos=Math.abs(N/L),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const U=x.target.getAbsolutePosition(),z=x.target.getStage().getPointerPosition();this._anchorDragOffset={x:z.x-U.x,y:z.y-U.y},y++,this._fire("transformstart",{evt:x.evt,target:this.getNode()}),this._nodes.forEach(X=>{X._fire("transformstart",{evt:x.evt,target:X})})}_handleMouseMove(x){let T,N,D;const L=this.findOne("."+this._movingAnchorName),U=L.getStage();U.setPointersPositions(x);const z=U.getPointerPosition();let X={x:z.x-this._anchorDragOffset.x,y:z.y-this._anchorDragOffset.y};const b=L.getAbsolutePosition();this.anchorDragBoundFunc()&&(X=this.anchorDragBoundFunc()(b,X,x)),L.setAbsolutePosition(X);const P=L.getAbsolutePosition();if(b.x===P.x&&b.y===P.y)return;if(this._movingAnchorName==="rotater"){const V=this._getNodeRect();T=L.x()-V.width/2,N=-L.y()+V.height/2;let A=Math.atan2(-N,T)+Math.PI/2;V.height<0&&(A-=Math.PI);const it=o.Konva.getAngle(this.rotation())+A,ot=o.Konva.getAngle(this.rotationSnapTolerance()),E=_(this.rotationSnaps(),it,ot)-V.rotation,O=u(V,E);this._fitNodesInto(O,x);return}const M=this.shiftBehavior();let R;M==="inverted"?R=this.keepRatio()&&!x.shiftKey:M==="none"?R=this.keepRatio():R=this.keepRatio()||x.shiftKey;let F=this.centeredScaling()||x.altKey;if(this._movingAnchorName==="top-left"){if(R){const V=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};D=Math.sqrt(Math.pow(V.x-L.x(),2)+Math.pow(V.y-L.y(),2));const A=this.findOne(".top-left").x()>V.x?-1:1,$=this.findOne(".top-left").y()>V.y?-1:1;T=D*this.cos*A,N=D*this.sin*$,this.findOne(".top-left").x(V.x-T),this.findOne(".top-left").y(V.y-N)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(L.y());else if(this._movingAnchorName==="top-right"){if(R){const V=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};D=Math.sqrt(Math.pow(L.x()-V.x,2)+Math.pow(V.y-L.y(),2));const A=this.findOne(".top-right").x()<V.x?-1:1,$=this.findOne(".top-right").y()>V.y?-1:1;T=D*this.cos*A,N=D*this.sin*$,this.findOne(".top-right").x(V.x+T),this.findOne(".top-right").y(V.y-N)}var H=L.position();this.findOne(".top-left").y(H.y),this.findOne(".bottom-right").x(H.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(L.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(L.x());else if(this._movingAnchorName==="bottom-left"){if(R){const V=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};D=Math.sqrt(Math.pow(V.x-L.x(),2)+Math.pow(L.y()-V.y,2));const A=V.x<L.x()?-1:1,$=L.y()<V.y?-1:1;T=D*this.cos*A,N=D*this.sin*$,L.x(V.x-T),L.y(V.y+N)}H=L.position(),this.findOne(".top-left").x(H.x),this.findOne(".bottom-right").y(H.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(L.y());else if(this._movingAnchorName==="bottom-right"){if(R){const V=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};D=Math.sqrt(Math.pow(L.x()-V.x,2)+Math.pow(L.y()-V.y,2));const A=this.findOne(".bottom-right").x()<V.x?-1:1,$=this.findOne(".bottom-right").y()<V.y?-1:1;T=D*this.cos*A,N=D*this.sin*$,this.findOne(".bottom-right").x(V.x+T),this.findOne(".bottom-right").y(V.y+N)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(F=this.centeredScaling()||x.altKey,F){const V=this.findOne(".top-left"),A=this.findOne(".bottom-right"),$=V.x(),it=V.y(),ot=this.getWidth()-A.x(),lt=this.getHeight()-A.y();A.move({x:-$,y:-it}),V.move({x:ot,y:lt})}const G=this.findOne(".top-left").getAbsolutePosition();T=G.x,N=G.y;const Q=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),st=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:T,y:N,width:Q,height:st,rotation:o.Konva.getAngle(this.rotation())},x)}_handleMouseUp(x){this._removeEvents(x)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(x){var T;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const N=this.getNode();y--,this._fire("transformend",{evt:x,target:N}),(T=this.getLayer())===null||T===void 0||T.batchDraw(),N&&this._nodes.forEach(D=>{var L;D._fire("transformend",{evt:x,target:D}),(L=D.getLayer())===null||L===void 0||L.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(x,T){const N=this._getNodeRect(),D=1;if(t.Util._inRange(x.width,-this.padding()*2-D,D)){this.update();return}if(t.Util._inRange(x.height,-this.padding()*2-D,D)){this.update();return}const L=new t.Transform;if(L.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&x.width<0&&this._movingAnchorName.indexOf("left")>=0){const R=L.point({x:-this.padding()*2,y:0});x.x+=R.x,x.y+=R.y,x.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y}else if(this._movingAnchorName&&x.width<0&&this._movingAnchorName.indexOf("right")>=0){const R=L.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,x.width+=this.padding()*2}if(this._movingAnchorName&&x.height<0&&this._movingAnchorName.indexOf("top")>=0){const R=L.point({x:0,y:-this.padding()*2});x.x+=R.x,x.y+=R.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,x.height+=this.padding()*2}else if(this._movingAnchorName&&x.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const R=L.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,x.height+=this.padding()*2}if(this.boundBoxFunc()){const R=this.boundBoxFunc()(N,x);R?x=R:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const U=1e7,z=new t.Transform;z.translate(N.x,N.y),z.rotate(N.rotation),z.scale(N.width/U,N.height/U);const X=new t.Transform,b=x.width/U,P=x.height/U;this.flipEnabled()===!1?(X.translate(x.x,x.y),X.rotate(x.rotation),X.translate(x.width<0?x.width:0,x.height<0?x.height:0),X.scale(Math.abs(b),Math.abs(P))):(X.translate(x.x,x.y),X.rotate(x.rotation),X.scale(b,P));const M=X.multiply(z.invert());this._nodes.forEach(R=>{var F;const H=R.getParent().getAbsoluteTransform(),G=R.getTransform().copy();G.translate(R.offsetX(),R.offsetY());const Q=new t.Transform;Q.multiply(H.copy().invert()).multiply(M).multiply(H).multiply(G);const st=Q.decompose();R.setAttrs(st),(F=R.getLayer())===null||F===void 0||F.batchDraw()}),this.rotation(t.Util._getRotation(x.rotation)),this._nodes.forEach(R=>{this._fire("transform",{evt:T,target:R}),R._fire("transform",{evt:T,target:R})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(x,T){this.findOne(x).setAttrs(T)}update(){var x;const T=this._getNodeRect();this.rotation(t.Util._getRotation(T.rotation));const N=T.width,D=T.height,L=this.enabledAnchors(),U=this.resizeEnabled(),z=this.padding(),X=this.anchorSize(),b=this.find("._anchor");b.forEach(M=>{M.setAttrs({width:X,height:X,offsetX:X/2,offsetY:X/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:X/2+z,offsetY:X/2+z,visible:U&&L.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:N/2,y:0,offsetY:X/2+z,visible:U&&L.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:N,y:0,offsetX:X/2-z,offsetY:X/2+z,visible:U&&L.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:D/2,offsetX:X/2+z,visible:U&&L.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:N,y:D/2,offsetX:X/2-z,visible:U&&L.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:D,offsetX:X/2+z,offsetY:X/2-z,visible:U&&L.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:N/2,y:D,offsetY:X/2-z,visible:U&&L.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:N,y:D,offsetX:X/2-z,offsetY:X/2-z,visible:U&&L.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:N/2,y:-this.rotateAnchorOffset()*t.Util._sign(D)-z,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:N,height:D,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const P=this.anchorStyleFunc();P&&b.forEach(M=>{P(M)}),(x=this.getLayer())===null||x===void 0||x.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const x=this.findOne("."+this._movingAnchorName);x&&x.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),s.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(x){return n.Node.prototype.clone.call(this,x)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};ci.Transformer=k,k.isTransforming=()=>y>0;function I(w){return w instanceof Array||t.Util.warn("enabledAnchors value should be an array"),w instanceof Array&&w.forEach(function(x){S.indexOf(x)===-1&&t.Util.warn("Unknown anchor name: "+x+". Available names are: "+S.join(", "))}),w||[]}return k.prototype.className="Transformer",(0,l._registerNode)(k),e.Factory.addGetterSetter(k,"enabledAnchors",S,I),e.Factory.addGetterSetter(k,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(k,"resizeEnabled",!0),e.Factory.addGetterSetter(k,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateEnabled",!0),e.Factory.addGetterSetter(k,"rotateLineVisible",!0),e.Factory.addGetterSetter(k,"rotationSnaps",[]),e.Factory.addGetterSetter(k,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(k,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderEnabled",!0),e.Factory.addGetterSetter(k,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"anchorFill","white"),e.Factory.addGetterSetter(k,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderDash"),e.Factory.addGetterSetter(k,"keepRatio",!0),e.Factory.addGetterSetter(k,"shiftBehavior","default"),e.Factory.addGetterSetter(k,"centeredScaling",!1),e.Factory.addGetterSetter(k,"ignoreStroke",!1),e.Factory.addGetterSetter(k,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"nodes"),e.Factory.addGetterSetter(k,"node"),e.Factory.addGetterSetter(k,"boundBoxFunc"),e.Factory.addGetterSetter(k,"anchorDragBoundFunc"),e.Factory.addGetterSetter(k,"anchorStyleFunc"),e.Factory.addGetterSetter(k,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(k,"useSingleNodeRotation",!0),e.Factory.backCompat(k,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),ci}var hi={},Nl;function hf(){if(Nl)return hi;Nl=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Wedge=void 0;const t=_t(),e=Lt(),n=mt(),i=vt(),r=mt();let s=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return hi.Wedge=s,s.prototype.className="Wedge",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"clockwise",!1),t.Factory.backCompat(s,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),hi}var ui={},Ml;function uf(){if(Ml)return ui;Ml=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Blur=void 0;const t=_t(),e=Ft(),n=vt();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const r=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],s=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(l,c){const h=l.data,d=l.width,g=l.height;let f,p,v,S,C,m,u,_,y,k,I,w,x,T,N,D,L,U,z,X;const b=c+c+1,P=d-1,M=g-1,R=c+1,F=R*(R+1)/2,H=new i,G=r[c],Q=s[c];let st=null,V=H,A=null,$=null;for(let it=1;it<b;it++)V=V.next=new i,it===R&&(st=V);V.next=H,v=p=0;for(let it=0;it<g;it++){w=x=T=N=S=C=m=u=0,_=R*(D=h[p]),y=R*(L=h[p+1]),k=R*(U=h[p+2]),I=R*(z=h[p+3]),S+=F*D,C+=F*L,m+=F*U,u+=F*z,V=H;for(let ot=0;ot<R;ot++)V.r=D,V.g=L,V.b=U,V.a=z,V=V.next;for(let ot=1;ot<R;ot++)f=p+((P<ot?P:ot)<<2),S+=(V.r=D=h[f])*(X=R-ot),C+=(V.g=L=h[f+1])*X,m+=(V.b=U=h[f+2])*X,u+=(V.a=z=h[f+3])*X,w+=D,x+=L,T+=U,N+=z,V=V.next;A=H,$=st;for(let ot=0;ot<d;ot++)h[p+3]=z=u*G>>Q,z!==0?(z=255/z,h[p]=(S*G>>Q)*z,h[p+1]=(C*G>>Q)*z,h[p+2]=(m*G>>Q)*z):h[p]=h[p+1]=h[p+2]=0,S-=_,C-=y,m-=k,u-=I,_-=A.r,y-=A.g,k-=A.b,I-=A.a,f=v+((f=ot+c+1)<P?f:P)<<2,w+=A.r=h[f],x+=A.g=h[f+1],T+=A.b=h[f+2],N+=A.a=h[f+3],S+=w,C+=x,m+=T,u+=N,A=A.next,_+=D=$.r,y+=L=$.g,k+=U=$.b,I+=z=$.a,w-=D,x-=L,T-=U,N-=z,$=$.next,p+=4;v+=d}for(let it=0;it<d;it++){x=T=N=w=C=m=u=S=0,p=it<<2,_=R*(D=h[p]),y=R*(L=h[p+1]),k=R*(U=h[p+2]),I=R*(z=h[p+3]),S+=F*D,C+=F*L,m+=F*U,u+=F*z,V=H;for(let lt=0;lt<R;lt++)V.r=D,V.g=L,V.b=U,V.a=z,V=V.next;let ot=d;for(let lt=1;lt<=c;lt++)p=ot+it<<2,S+=(V.r=D=h[p])*(X=R-lt),C+=(V.g=L=h[p+1])*X,m+=(V.b=U=h[p+2])*X,u+=(V.a=z=h[p+3])*X,w+=D,x+=L,T+=U,N+=z,V=V.next,lt<M&&(ot+=d);p=it,A=H,$=st;for(let lt=0;lt<g;lt++)f=p<<2,h[f+3]=z=u*G>>Q,z>0?(z=255/z,h[f]=(S*G>>Q)*z,h[f+1]=(C*G>>Q)*z,h[f+2]=(m*G>>Q)*z):h[f]=h[f+1]=h[f+2]=0,S-=_,C-=y,m-=k,u-=I,_-=A.r,y-=A.g,k-=A.b,I-=A.a,f=it+((f=lt+R)<M?f:M)*d<<2,S+=w+=A.r=h[f],C+=x+=A.g=h[f+1],m+=T+=A.b=h[f+2],u+=N+=A.a=h[f+3],A=A.next,_+=D=$.r,y+=L=$.g,k+=U=$.b,I+=z=$.a,w-=D,x-=L,T-=U,N-=z,$=$.next,p+=d}}const a=function(c){const h=Math.round(this.blurRadius());h>0&&o(c,h)};return ui.Blur=a,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ui}var di={},Il;function df(){if(Il)return di;Il=1,Object.defineProperty(di,"__esModule",{value:!0}),di.Brighten=void 0;const t=_t(),e=Ft(),n=vt(),i=function(r){const s=this.brightness()*255,o=r.data,a=o.length;for(let l=0;l<a;l+=4)o[l]+=s,o[l+1]+=s,o[l+2]+=s};return di.Brighten=i,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),di}var fi={},Ol;function ff(){if(Ol)return fi;Ol=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.Contrast=void 0;const t=_t(),e=Ft(),n=vt(),i=function(r){const s=Math.pow((this.contrast()+100)/100,2),o=r.data,a=o.length;let l=150,c=150,h=150;for(let d=0;d<a;d+=4)l=o[d],c=o[d+1],h=o[d+2],l/=255,l-=.5,l*=s,l+=.5,l*=255,c/=255,c-=.5,c*=s,c+=.5,c*=255,h/=255,h-=.5,h*=s,h+=.5,h*=255,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,h=h<0?0:h>255?255:h,o[d]=l,o[d+1]=c,o[d+2]=h};return fi.Contrast=i,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),fi}var gi={},Fl;function gf(){if(Fl)return gi;Fl=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.Emboss=void 0;const t=_t(),e=Ft(),n=It(),i=vt(),r=function(s){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),c=this.embossBlend(),h=s.data,d=s.width,g=s.height,f=d*4;let p=0,v=0,S=g;switch(l){case"top-left":p=-1,v=-1;break;case"top":p=-1,v=0;break;case"top-right":p=-1,v=1;break;case"right":p=0,v=1;break;case"bottom-right":p=1,v=1;break;case"bottom":p=1,v=0;break;case"bottom-left":p=1,v=-1;break;case"left":p=0,v=-1;break;default:n.Util.error("Unknown emboss direction: "+l)}do{const C=(S-1)*f;let m=p;S+m<1&&(m=0),S+m>g&&(m=0);const u=(S-1+m)*d*4;let _=d;do{const y=C+(_-1)*4;let k=v;_+k<1&&(k=0),_+k>d&&(k=0);const I=u+(_-1+k)*4,w=h[y]-h[I],x=h[y+1]-h[I+1],T=h[y+2]-h[I+2];let N=w;const D=N>0?N:-N,L=x>0?x:-x,U=T>0?T:-T;if(L>D&&(N=x),U>D&&(N=T),N*=o,c){const z=h[y]+N,X=h[y+1]+N,b=h[y+2]+N;h[y]=z>255?255:z<0?0:z,h[y+1]=X>255?255:X<0?0:X,h[y+2]=b>255?255:b<0?0:b}else{let z=a-N;z<0?z=0:z>255&&(z=255),h[y]=h[y+1]=h[y+2]=z}}while(--_)}while(--S)};return gi.Emboss=r,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),gi}var pi={},Dl;function pf(){if(Dl)return pi;Dl=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Enhance=void 0;const t=_t(),e=Ft(),n=vt();function i(s,o,a,l,c){const h=a-o,d=c-l;if(h===0)return l+d/2;if(d===0)return l;let g=(s-o)/h;return g=d*g+l,g}const r=function(s){const o=s.data,a=o.length;let l=o[0],c=l,h,d=o[1],g=d,f,p=o[2],v=p,S;const C=this.enhance();if(C===0)return;for(let w=0;w<a;w+=4)h=o[w+0],h<l?l=h:h>c&&(c=h),f=o[w+1],f<d?d=f:f>g&&(g=f),S=o[w+2],S<p?p=S:S>v&&(v=S);c===l&&(c=255,l=0),g===d&&(g=255,d=0),v===p&&(v=255,p=0);let m,u,_,y,k,I;if(C>0)m=c+C*(255-c),u=l-C*(l-0),_=g+C*(255-g),y=d-C*(d-0),k=v+C*(255-v),I=p-C*(p-0);else{const w=(c+l)*.5;m=c+C*(c-w),u=l+C*(l-w);const x=(g+d)*.5;_=g+C*(g-x),y=d+C*(d-x);const T=(v+p)*.5;k=v+C*(v-T),I=p+C*(p-T)}for(let w=0;w<a;w+=4)o[w+0]=i(o[w+0],l,c,u,m),o[w+1]=i(o[w+1],d,g,y,_),o[w+2]=i(o[w+2],p,v,I,k)};return pi.Enhance=r,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),pi}var mi={},zl;function mf(){if(zl)return mi;zl=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.Grayscale=void 0;const t=function(e){const n=e.data,i=n.length;for(let r=0;r<i;r+=4){const s=.34*n[r]+.5*n[r+1]+.16*n[r+2];n[r]=s,n[r+1]=s,n[r+2]=s}};return mi.Grayscale=t,mi}var _i={},Ll;function _f(){if(Ll)return _i;Ll=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.HSL=void 0;const t=_t(),e=Ft(),n=vt();t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter);const i=function(r){const s=r.data,o=s.length,a=1,l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=this.luminance()*127,d=a*l*Math.cos(c*Math.PI/180),g=a*l*Math.sin(c*Math.PI/180),f=.299*a+.701*d+.167*g,p=.587*a-.587*d+.33*g,v=.114*a-.114*d-.497*g,S=.299*a-.299*d-.328*g,C=.587*a+.413*d+.035*g,m=.114*a-.114*d+.293*g,u=.299*a-.3*d+1.25*g,_=.587*a-.586*d-1.05*g,y=.114*a+.886*d-.2*g;let k,I,w,x;for(let T=0;T<o;T+=4)k=s[T+0],I=s[T+1],w=s[T+2],x=s[T+3],s[T+0]=f*k+p*I+v*w+h,s[T+1]=S*k+C*I+m*w+h,s[T+2]=u*k+_*I+y*w+h,s[T+3]=x};return _i.HSL=i,_i}var vi={},Gl;function vf(){if(Gl)return vi;Gl=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.HSV=void 0;const t=_t(),e=Ft(),n=vt(),i=function(r){const s=r.data,o=s.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=a*l*Math.cos(c*Math.PI/180),d=a*l*Math.sin(c*Math.PI/180),g=.299*a+.701*h+.167*d,f=.587*a-.587*h+.33*d,p=.114*a-.114*h-.497*d,v=.299*a-.299*h-.328*d,S=.587*a+.413*h+.035*d,C=.114*a-.114*h+.293*d,m=.299*a-.3*h+1.25*d,u=.587*a-.586*h-1.05*d,_=.114*a+.886*h-.2*d;for(let y=0;y<o;y+=4){const k=s[y+0],I=s[y+1],w=s[y+2],x=s[y+3];s[y+0]=g*k+f*I+p*w,s[y+1]=v*k+S*I+C*w,s[y+2]=m*k+u*I+_*w,s[y+3]=x}};return vi.HSV=i,t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),vi}var bi={},Ul;function bf(){if(Ul)return bi;Ul=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.Invert=void 0;const t=function(e){const n=e.data,i=n.length;for(let r=0;r<i;r+=4)n[r]=255-n[r],n[r+1]=255-n[r+1],n[r+2]=255-n[r+2]};return bi.Invert=t,bi}var yi={},Bl;function yf(){if(Bl)return yi;Bl=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.Kaleidoscope=void 0;const t=_t(),e=Ft(),n=It(),i=vt(),r=function(a,l,c){const h=a.data,d=l.data,g=a.width,f=a.height,p=c.polarCenterX||g/2,v=c.polarCenterY||f/2;let S=Math.sqrt(p*p+v*v),C=g-p,m=f-v;const u=Math.sqrt(C*C+m*m);S=u>S?u:S;const _=f,y=g,k=360/y*Math.PI/180;for(let I=0;I<y;I+=1){const w=Math.sin(I*k),x=Math.cos(I*k);for(let T=0;T<_;T+=1){C=Math.floor(p+S*T/_*x),m=Math.floor(v+S*T/_*w);let N=(m*g+C)*4;const D=h[N+0],L=h[N+1],U=h[N+2],z=h[N+3];N=(I+T*g)*4,d[N+0]=D,d[N+1]=L,d[N+2]=U,d[N+3]=z}}},s=function(a,l,c){const h=a.data,d=l.data,g=a.width,f=a.height,p=c.polarCenterX||g/2,v=c.polarCenterY||f/2;let S=Math.sqrt(p*p+v*v),C=g-p,m=f-v;const u=Math.sqrt(C*C+m*m);S=u>S?u:S;const _=f,y=g,k=0;let I,w;for(C=0;C<g;C+=1)for(m=0;m<f;m+=1){const x=C-p,T=m-v,N=Math.sqrt(x*x+T*T)*_/S;let D=(Math.atan2(T,x)*180/Math.PI+360+k)%360;D=D*y/360,I=Math.floor(D),w=Math.floor(N);let L=(w*g+I)*4;const U=h[L+0],z=h[L+1],X=h[L+2],b=h[L+3];L=(m*g+C)*4,d[L+0]=U,d[L+1]=z,d[L+2]=X,d[L+3]=b}},o=function(a){const l=a.width,c=a.height;let h,d,g,f,p,v,S,C,m,u,_=Math.round(this.kaleidoscopePower());const y=Math.round(this.kaleidoscopeAngle()),k=Math.floor(l*(y%360)/360);if(_<1)return;const I=n.Util.createCanvasElement();I.width=l,I.height=c;const w=I.getContext("2d").getImageData(0,0,l,c);n.Util.releaseCanvas(I),r(a,w,{polarCenterX:l/2,polarCenterY:c/2});let x=l/Math.pow(2,_);for(;x<=8;)x=x*2,_-=1;x=Math.ceil(x);let T=x,N=0,D=T,L=1;for(k+x>l&&(N=T,D=0,L=-1),d=0;d<c;d+=1)for(h=N;h!==D;h+=L)g=Math.round(h+k)%l,m=(l*d+g)*4,p=w.data[m+0],v=w.data[m+1],S=w.data[m+2],C=w.data[m+3],u=(l*d+h)*4,w.data[u+0]=p,w.data[u+1]=v,w.data[u+2]=S,w.data[u+3]=C;for(d=0;d<c;d+=1)for(T=Math.floor(x),f=0;f<_;f+=1){for(h=0;h<T+1;h+=1)m=(l*d+h)*4,p=w.data[m+0],v=w.data[m+1],S=w.data[m+2],C=w.data[m+3],u=(l*d+T*2-h-1)*4,w.data[u+0]=p,w.data[u+1]=v,w.data[u+2]=S,w.data[u+3]=C;T*=2}s(w,a,{})};return yi.Kaleidoscope=o,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),yi}var Si={},$l;function Sf(){if($l)return Si;$l=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.Mask=void 0;const t=_t(),e=Ft(),n=vt();function i(g,f,p){let v=(p*g.width+f)*4;const S=[];return S.push(g.data[v++],g.data[v++],g.data[v++],g.data[v++]),S}function r(g,f){return Math.sqrt(Math.pow(g[0]-f[0],2)+Math.pow(g[1]-f[1],2)+Math.pow(g[2]-f[2],2))}function s(g){const f=[0,0,0];for(let p=0;p<g.length;p++)f[0]+=g[p][0],f[1]+=g[p][1],f[2]+=g[p][2];return f[0]/=g.length,f[1]/=g.length,f[2]/=g.length,f}function o(g,f){const p=i(g,0,0),v=i(g,g.width-1,0),S=i(g,0,g.height-1),C=i(g,g.width-1,g.height-1),m=f||10;if(r(p,v)<m&&r(v,C)<m&&r(C,S)<m&&r(S,p)<m){const u=s([v,p,C,S]),_=[];for(let y=0;y<g.width*g.height;y++){const k=r(u,[g.data[y*4],g.data[y*4+1],g.data[y*4+2]]);_[y]=k<m?0:255}return _}}function a(g,f){for(let p=0;p<g.width*g.height;p++)g.data[4*p+3]=f[p]}function l(g,f,p){const v=[1,1,1,1,0,1,1,1,1],S=Math.round(Math.sqrt(v.length)),C=Math.floor(S/2),m=[];for(let u=0;u<p;u++)for(let _=0;_<f;_++){const y=u*f+_;let k=0;for(let I=0;I<S;I++)for(let w=0;w<S;w++){const x=u+I-C,T=_+w-C;if(x>=0&&x<p&&T>=0&&T<f){const N=x*f+T,D=v[I*S+w];k+=g[N]*D}}m[y]=k===2040?255:0}return m}function c(g,f,p){const v=[1,1,1,1,1,1,1,1,1],S=Math.round(Math.sqrt(v.length)),C=Math.floor(S/2),m=[];for(let u=0;u<p;u++)for(let _=0;_<f;_++){const y=u*f+_;let k=0;for(let I=0;I<S;I++)for(let w=0;w<S;w++){const x=u+I-C,T=_+w-C;if(x>=0&&x<p&&T>=0&&T<f){const N=x*f+T,D=v[I*S+w];k+=g[N]*D}}m[y]=k>=1020?255:0}return m}function h(g,f,p){const v=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],S=Math.round(Math.sqrt(v.length)),C=Math.floor(S/2),m=[];for(let u=0;u<p;u++)for(let _=0;_<f;_++){const y=u*f+_;let k=0;for(let I=0;I<S;I++)for(let w=0;w<S;w++){const x=u+I-C,T=_+w-C;if(x>=0&&x<p&&T>=0&&T<f){const N=x*f+T,D=v[I*S+w];k+=g[N]*D}}m[y]=k}return m}const d=function(g){const f=this.threshold();let p=o(g,f);return p&&(p=l(p,g.width,g.height),p=c(p,g.width,g.height),p=h(p,g.width,g.height),a(g,p)),g};return Si.Mask=d,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Si}var wi={},Vl;function wf(){if(Vl)return wi;Vl=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.Noise=void 0;const t=_t(),e=Ft(),n=vt(),i=function(r){const s=this.noise()*255,o=r.data,a=o.length,l=s/2;for(let c=0;c<a;c+=4)o[c+0]+=l-2*l*Math.random(),o[c+1]+=l-2*l*Math.random(),o[c+2]+=l-2*l*Math.random()};return wi.Noise=i,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),wi}var xi={},Hl;function xf(){if(Hl)return xi;Hl=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.Pixelate=void 0;const t=_t(),e=It(),n=Ft(),i=vt(),r=function(s){let o=Math.ceil(this.pixelSize()),a=s.width,l=s.height,c=Math.ceil(a/o),h=Math.ceil(l/o),d=s.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let g=0;g<c;g+=1)for(let f=0;f<h;f+=1){let p=0,v=0,S=0,C=0;const m=g*o,u=m+o,_=f*o,y=_+o;let k=0;for(let I=m;I<u;I+=1)if(!(I>=a))for(let w=_;w<y;w+=1){if(w>=l)continue;const x=(a*w+I)*4;p+=d[x+0],v+=d[x+1],S+=d[x+2],C+=d[x+3],k+=1}p=p/k,v=v/k,S=S/k,C=C/k;for(let I=m;I<u;I+=1)if(!(I>=a))for(let w=_;w<y;w+=1){if(w>=l)continue;const x=(a*w+I)*4;d[x+0]=p,d[x+1]=v,d[x+2]=S,d[x+3]=C}}};return xi.Pixelate=r,t.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),xi}var Ci={},Wl;function Cf(){if(Wl)return Ci;Wl=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.Posterize=void 0;const t=_t(),e=Ft(),n=vt(),i=function(r){const s=Math.round(this.levels()*254)+1,o=r.data,a=o.length,l=255/s;for(let c=0;c<a;c+=1)o[c]=Math.floor(o[c]/l)*l};return Ci.Posterize=i,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Ci}var Pi={},jl;function Pf(){if(jl)return Pi;jl=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.RGB=void 0;const t=_t(),e=Ft(),n=vt(),i=function(r){const s=r.data,o=s.length,a=this.red(),l=this.green(),c=this.blue();for(let h=0;h<o;h+=4){const d=(.34*s[h]+.5*s[h+1]+.16*s[h+2])/255;s[h]=d*a,s[h+1]=d*l,s[h+2]=d*c,s[h+3]=s[h+3]}};return Pi.RGB=i,t.Factory.addGetterSetter(e.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),Pi}var Ti={},Zl;function Tf(){if(Zl)return Ti;Zl=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.RGBA=void 0;const t=_t(),e=Ft(),n=vt(),i=function(r){const s=r.data,o=s.length,a=this.red(),l=this.green(),c=this.blue(),h=this.alpha();for(let d=0;d<o;d+=4){const g=1-h;s[d]=a*h+s[d]*g,s[d+1]=l*h+s[d+1]*g,s[d+2]=c*h+s[d+2]*g}};return Ti.RGBA=i,t.Factory.addGetterSetter(e.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r}),Ti}var ki={},ql;function kf(){if(ql)return ki;ql=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.Sepia=void 0;const t=function(e){const n=e.data,i=n.length;for(let r=0;r<i;r+=4){const s=n[r+0],o=n[r+1],a=n[r+2];n[r+0]=Math.min(255,s*.393+o*.769+a*.189),n[r+1]=Math.min(255,s*.349+o*.686+a*.168),n[r+2]=Math.min(255,s*.272+o*.534+a*.131)}};return ki.Sepia=t,ki}var Ei={},Kl;function Ef(){if(Kl)return Ei;Kl=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.Solarize=void 0;const t=function(e){const n=e.data,i=e.width,r=e.height,s=i*4;let o=r;do{const a=(o-1)*s;let l=i;do{const c=a+(l-1)*4;let h=n[c],d=n[c+1],g=n[c+2];h>127&&(h=255-h),d>127&&(d=255-d),g>127&&(g=255-g),n[c]=h,n[c+1]=d,n[c+2]=g}while(--l)}while(--o)};return Ei.Solarize=t,Ei}var Ri={},Yl;function Rf(){if(Yl)return Ri;Yl=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.Threshold=void 0;const t=_t(),e=Ft(),n=vt(),i=function(r){const s=this.threshold()*255,o=r.data,a=o.length;for(let l=0;l<a;l+=1)o[l]=o[l]<s?0:255};return Ri.Threshold=i,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Ri}var Xl;function Af(){if(Xl)return Vn;Xl=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.Konva=void 0;const t=Kd(),e=Yd(),n=Qd(),i=Jd(),r=tf(),s=ef(),o=nf(),a=fl(),l=Rs(),c=wl(),h=rf(),d=sf(),g=of(),f=af(),p=El(),v=lf(),S=cf(),C=hf(),m=uf(),u=df(),_=ff(),y=gf(),k=pf(),I=mf(),w=_f(),x=vf(),T=bf(),N=yf(),D=Sf(),L=wf(),U=xf(),z=Cf(),X=Pf(),b=Tf(),P=kf(),M=Ef(),R=Rf();return Vn.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:r.Ellipse,Image:s.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:l.Path,Rect:c.Rect,RegularPolygon:h.RegularPolygon,Ring:d.Ring,Sprite:g.Sprite,Star:f.Star,Text:p.Text,TextPath:v.TextPath,Transformer:S.Transformer,Wedge:C.Wedge,Filters:{Blur:m.Blur,Brighten:u.Brighten,Contrast:_.Contrast,Emboss:y.Emboss,Enhance:k.Enhance,Grayscale:I.Grayscale,HSL:w.HSL,HSV:x.HSV,Invert:T.Invert,Kaleidoscope:N.Kaleidoscope,Mask:D.Mask,Noise:L.Noise,Pixelate:U.Pixelate,Posterize:z.Posterize,RGB:X.RGB,RGBA:b.RGBA,Sepia:P.Sepia,Solarize:M.Solarize,Threshold:R.Threshold}}),Vn}var Nf=dr.exports,Ql;function Mf(){if(Ql)return dr.exports;Ql=1,Object.defineProperty(Nf,"__esModule",{value:!0});const t=Af();return dr.exports=t.Konva,dr.exports}var If=Mf();const Bt=Wd(If),Of=()=>({stage:void 0,konvaContainer:void 0,notes:new Map,selection:{selectedIds:new Set,selectionRect:void 0},viewport:{scrollX:0,scrollY:55*20,zoomX:1,zoomY:1},grid:{quarterNoteWidth:120,noteHeight:20,baseQuarterNoteWidth:120,baseNoteHeight:20,subdivision:16,numMeasures:100,timeSignature:4,maxLength:64,backgroundColor1:"#ddd",backgroundColor2:"#bbb",noteColor:"#f23",selectedNoteColor:"#2ee"},interaction:{isDragging:!1,dragStartPos:void 0,draggedNoteInitialStates:new Map,quantDragActivated:!1,dragBeforeState:void 0,isResizing:!1,resizeTargetId:void 0,resizeIsEnd:!1,resizeInitialStates:new Map,quantResizeActivated:!1,resizeBeforeState:void 0,isMarqueeSelecting:!1,marqueeStart:void 0,marqueeCurrent:void 0,marqueeIsShift:!1,hiddenNoteIds:new Set,truncatedNotes:new Map,createEmptyOverlapAdjustments:()=>({toDelete:new Set,toTruncate:new Map})},command:{stack:void 0},layers:{grid:void 0,notes:void 0,overlay:void 0},renderCache:{grid:{lastScrollX:-1,lastScrollY:-1,lastSubdivision:-1,lastQuarterNoteWidth:-1,lastNoteHeight:-1}},needsRedraw:!1,rafHandle:void 0,queuePlayhead:{position:0,element:void 0},livePlayhead:{position:0,element:void 0},notifyExternalChange:void 0});function K(t,e,n){function i(a,l){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:l,constr:o,traits:new Set},enumerable:!1}),a._zod.traits.has(t))return;a._zod.traits.add(t),e(a,l);const c=o.prototype,h=Object.keys(c);for(let d=0;d<h.length;d++){const g=h[d];g in a||(a[g]=c[g].bind(a))}}const r=n?.Parent??Object;class s extends r{}Object.defineProperty(s,"name",{value:t});function o(a){var l;const c=n?.Parent?new s:this;i(c,a),(l=c._zod).deferred??(l.deferred=[]);for(const h of c._zod.deferred)h();return c}return Object.defineProperty(o,"init",{value:i}),Object.defineProperty(o,Symbol.hasInstance,{value:a=>n?.Parent&&a instanceof n.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(o,"name",{value:t}),o}class pn extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Jl extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const tc={};function Ge(t){return tc}function Ff(t){const e=Object.values(t).filter(i=>typeof i=="number");return Object.entries(t).filter(([i,r])=>e.indexOf(+i)===-1).map(([i,r])=>r)}function As(t,e){return typeof e=="bigint"?e.toString():e}function pr(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function Ns(t){return t==null}function Ms(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}function Df(t,e){const n=(t.toString().split(".")[1]||"").length,i=e.toString();let r=(i.split(".")[1]||"").length;if(r===0&&/\d?e-\d?/.test(i)){const l=i.match(/\d?e-(\d?)/);l?.[1]&&(r=Number.parseInt(l[1]))}const s=n>r?n:r,o=Number.parseInt(t.toFixed(s).replace(".","")),a=Number.parseInt(e.toFixed(s).replace(".",""));return o%a/10**s}const ec=Symbol("evaluating");function xt(t,e,n){let i;Object.defineProperty(t,e,{get(){if(i!==ec)return i===void 0&&(i=ec,i=n()),i},set(r){Object.defineProperty(t,e,{value:r})},configurable:!0})}function Je(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function tn(...t){const e={};for(const n of t){const i=Object.getOwnPropertyDescriptors(n);Object.assign(e,i)}return Object.defineProperties({},e)}function nc(t){return JSON.stringify(t)}function zf(t){return t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const ic="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function Ai(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const Lf=pr(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function mn(t){if(Ai(t)===!1)return!1;const e=t.constructor;if(e===void 0||typeof e!="function")return!0;const n=e.prototype;return!(Ai(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function rc(t){return mn(t)?{...t}:Array.isArray(t)?[...t]:t}const Gf=new Set(["string","number","symbol"]);function _n(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ue(t,e,n){const i=new t._zod.constr(e??t._zod.def);return(!e||n?.parent)&&(i._zod.parent=t),i}function ct(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function Uf(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const Bf={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function $f(t,e){const n=t._zod.def,i=tn(t._zod.def,{get shape(){const r={};for(const s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&(r[s]=n.shape[s])}return Je(this,"shape",r),r},checks:[]});return Ue(t,i)}function Vf(t,e){const n=t._zod.def,i=tn(t._zod.def,{get shape(){const r={...t._zod.def.shape};for(const s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&delete r[s]}return Je(this,"shape",r),r},checks:[]});return Ue(t,i)}function Hf(t,e){if(!mn(e))throw new Error("Invalid input to extend: expected a plain object");const n=t._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const r=tn(t._zod.def,{get shape(){const s={...t._zod.def.shape,...e};return Je(this,"shape",s),s},checks:[]});return Ue(t,r)}function Wf(t,e){if(!mn(e))throw new Error("Invalid input to safeExtend: expected a plain object");const n={...t._zod.def,get shape(){const i={...t._zod.def.shape,...e};return Je(this,"shape",i),i},checks:t._zod.def.checks};return Ue(t,n)}function jf(t,e){const n=tn(t._zod.def,{get shape(){const i={...t._zod.def.shape,...e._zod.def.shape};return Je(this,"shape",i),i},get catchall(){return e._zod.def.catchall},checks:[]});return Ue(t,n)}function Zf(t,e,n){const i=tn(e._zod.def,{get shape(){const r=e._zod.def.shape,s={...r};if(n)for(const o in n){if(!(o in r))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(s[o]=t?new t({type:"optional",innerType:r[o]}):r[o])}else for(const o in r)s[o]=t?new t({type:"optional",innerType:r[o]}):r[o];return Je(this,"shape",s),s},checks:[]});return Ue(e,i)}function qf(t,e,n){const i=tn(e._zod.def,{get shape(){const r=e._zod.def.shape,s={...r};if(n)for(const o in n){if(!(o in s))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(s[o]=new t({type:"nonoptional",innerType:r[o]}))}else for(const o in r)s[o]=new t({type:"nonoptional",innerType:r[o]});return Je(this,"shape",s),s},checks:[]});return Ue(e,i)}function vn(t,e=0){if(t.aborted===!0)return!0;for(let n=e;n<t.issues.length;n++)if(t.issues[n]?.continue!==!0)return!0;return!1}function en(t,e){return e.map(n=>{var i;return(i=n).path??(i.path=[]),n.path.unshift(t),n})}function mr(t){return typeof t=="string"?t:t?.message}function Be(t,e,n){const i={...t,path:t.path??[]};if(!t.message){const r=mr(t.inst?._zod.def?.error?.(t))??mr(e?.error?.(t))??mr(n.customError?.(t))??mr(n.localeError?.(t))??"Invalid input";i.message=r}return delete i.inst,delete i.continue,e?.reportInput||delete i.input,i}function Is(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Ni(...t){const[e,n,i]=t;return typeof e=="string"?{message:e,code:"custom",input:n,inst:i}:{...e}}const sc=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,As,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},oc=K("$ZodError",sc),ac=K("$ZodError",sc,{Parent:Error});function Kf(t,e=n=>n.message){const n={},i=[];for(const r of t.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(e(r))):i.push(e(r));return{formErrors:i,fieldErrors:n}}function Yf(t,e=n=>n.message){const n={_errors:[]},i=r=>{for(const s of r.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(o=>i({issues:o}));else if(s.code==="invalid_key")i({issues:s.issues});else if(s.code==="invalid_element")i({issues:s.issues});else if(s.path.length===0)n._errors.push(e(s));else{let o=n,a=0;for(;a<s.path.length;){const l=s.path[a];a===s.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(e(s))):o[l]=o[l]||{_errors:[]},o=o[l],a++}}};return i(t),n}const Os=t=>(e,n,i,r)=>{const s=i?Object.assign(i,{async:!1}):{async:!1},o=e._zod.run({value:n,issues:[]},s);if(o instanceof Promise)throw new pn;if(o.issues.length){const a=new(r?.Err??t)(o.issues.map(l=>Be(l,s,Ge())));throw ic(a,r?.callee),a}return o.value},Fs=t=>async(e,n,i,r)=>{const s=i?Object.assign(i,{async:!0}):{async:!0};let o=e._zod.run({value:n,issues:[]},s);if(o instanceof Promise&&(o=await o),o.issues.length){const a=new(r?.Err??t)(o.issues.map(l=>Be(l,s,Ge())));throw ic(a,r?.callee),a}return o.value},_r=t=>(e,n,i)=>{const r=i?{...i,async:!1}:{async:!1},s=e._zod.run({value:n,issues:[]},r);if(s instanceof Promise)throw new pn;return s.issues.length?{success:!1,error:new(t??oc)(s.issues.map(o=>Be(o,r,Ge())))}:{success:!0,data:s.value}},Xf=_r(ac),vr=t=>async(e,n,i)=>{const r=i?Object.assign(i,{async:!0}):{async:!0};let s=e._zod.run({value:n,issues:[]},r);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new t(s.issues.map(o=>Be(o,r,Ge())))}:{success:!0,data:s.value}},Qf=vr(ac),Jf=t=>(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Os(t)(e,n,r)},t0=t=>(e,n,i)=>Os(t)(e,n,i),e0=t=>async(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Fs(t)(e,n,r)},n0=t=>async(e,n,i)=>Fs(t)(e,n,i),i0=t=>(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return _r(t)(e,n,r)},r0=t=>(e,n,i)=>_r(t)(e,n,i),s0=t=>async(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return vr(t)(e,n,r)},o0=t=>async(e,n,i)=>vr(t)(e,n,i),a0=/^[cC][^\s-]{8,}$/,l0=/^[0-9a-z]+$/,c0=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,h0=/^[0-9a-vA-V]{20}$/,u0=/^[A-Za-z0-9]{27}$/,d0=/^[a-zA-Z0-9_-]{21}$/,f0=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,g0=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,lc=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,p0=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,m0="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function _0(){return new RegExp(m0,"u")}const v0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,b0=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,y0=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,S0=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,w0=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,cc=/^[A-Za-z0-9_-]*$/,x0=/^\+(?:[0-9]){6,14}[0-9]$/,hc="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",C0=new RegExp(`^${hc}$`);function uc(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function P0(t){return new RegExp(`^${uc(t)}$`)}function T0(t){const e=uc({precision:t.precision}),n=["Z"];t.local&&n.push(""),t.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const i=`${e}(?:${n.join("|")})`;return new RegExp(`^${hc}T(?:${i})$`)}const k0=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},E0=/^-?\d+$/,R0=/^-?\d+(?:\.\d+)?/,A0=/^(?:true|false)$/i,N0=/^[^A-Z]*$/,M0=/^[^a-z]*$/,Yt=K("$ZodCheck",(t,e)=>{var n;t._zod??(t._zod={}),t._zod.def=e,(n=t._zod).onattach??(n.onattach=[])}),dc={number:"number",bigint:"bigint",object:"date"},fc=K("$ZodCheckLessThan",(t,e)=>{Yt.init(t,e);const n=dc[typeof e.value];t._zod.onattach.push(i=>{const r=i._zod.bag,s=(e.inclusive?r.maximum:r.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?r.maximum=e.value:r.exclusiveMaximum=e.value)}),t._zod.check=i=>{(e.inclusive?i.value<=e.value:i.value<e.value)||i.issues.push({origin:n,code:"too_big",maximum:e.value,input:i.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),gc=K("$ZodCheckGreaterThan",(t,e)=>{Yt.init(t,e);const n=dc[typeof e.value];t._zod.onattach.push(i=>{const r=i._zod.bag,s=(e.inclusive?r.minimum:r.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?r.minimum=e.value:r.exclusiveMinimum=e.value)}),t._zod.check=i=>{(e.inclusive?i.value>=e.value:i.value>e.value)||i.issues.push({origin:n,code:"too_small",minimum:e.value,input:i.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),I0=K("$ZodCheckMultipleOf",(t,e)=>{Yt.init(t,e),t._zod.onattach.push(n=>{var i;(i=n._zod.bag).multipleOf??(i.multipleOf=e.value)}),t._zod.check=n=>{if(typeof n.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%e.value===BigInt(0):Df(n.value,e.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:e.value,input:n.value,inst:t,continue:!e.abort})}}),O0=K("$ZodCheckNumberFormat",(t,e)=>{Yt.init(t,e),e.format=e.format||"float64";const n=e.format?.includes("int"),i=n?"int":"number",[r,s]=Bf[e.format];t._zod.onattach.push(o=>{const a=o._zod.bag;a.format=e.format,a.minimum=r,a.maximum=s,n&&(a.pattern=E0)}),t._zod.check=o=>{const a=o.value;if(n){if(!Number.isInteger(a)){o.issues.push({expected:i,format:e.format,code:"invalid_type",continue:!1,input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?o.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:i,continue:!e.abort}):o.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:i,continue:!e.abort});return}}a<r&&o.issues.push({origin:"number",input:a,code:"too_small",minimum:r,inclusive:!0,inst:t,continue:!e.abort}),a>s&&o.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inst:t})}}),F0=K("$ZodCheckMaxLength",(t,e)=>{var n;Yt.init(t,e),(n=t._zod.def).when??(n.when=i=>{const r=i.value;return!Ns(r)&&r.length!==void 0}),t._zod.onattach.push(i=>{const r=i._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<r&&(i._zod.bag.maximum=e.maximum)}),t._zod.check=i=>{const r=i.value;if(r.length<=e.maximum)return;const o=Is(r);i.issues.push({origin:o,code:"too_big",maximum:e.maximum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),D0=K("$ZodCheckMinLength",(t,e)=>{var n;Yt.init(t,e),(n=t._zod.def).when??(n.when=i=>{const r=i.value;return!Ns(r)&&r.length!==void 0}),t._zod.onattach.push(i=>{const r=i._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>r&&(i._zod.bag.minimum=e.minimum)}),t._zod.check=i=>{const r=i.value;if(r.length>=e.minimum)return;const o=Is(r);i.issues.push({origin:o,code:"too_small",minimum:e.minimum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),z0=K("$ZodCheckLengthEquals",(t,e)=>{var n;Yt.init(t,e),(n=t._zod.def).when??(n.when=i=>{const r=i.value;return!Ns(r)&&r.length!==void 0}),t._zod.onattach.push(i=>{const r=i._zod.bag;r.minimum=e.length,r.maximum=e.length,r.length=e.length}),t._zod.check=i=>{const r=i.value,s=r.length;if(s===e.length)return;const o=Is(r),a=s>e.length;i.issues.push({origin:o,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:i.value,inst:t,continue:!e.abort})}}),br=K("$ZodCheckStringFormat",(t,e)=>{var n,i;Yt.init(t,e),t._zod.onattach.push(r=>{const s=r._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(n=t._zod).check??(n.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:e.format,input:r.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(i=t._zod).check??(i.check=()=>{})}),L0=K("$ZodCheckRegex",(t,e)=>{br.init(t,e),t._zod.check=n=>{e.pattern.lastIndex=0,!e.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),G0=K("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=N0),br.init(t,e)}),U0=K("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=M0),br.init(t,e)}),B0=K("$ZodCheckIncludes",(t,e)=>{Yt.init(t,e);const n=_n(e.includes),i=new RegExp(typeof e.position=="number"?`^.{${e.position}}${n}`:n);e.pattern=i,t._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(i)}),t._zod.check=r=>{r.value.includes(e.includes,e.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:r.value,inst:t,continue:!e.abort})}}),$0=K("$ZodCheckStartsWith",(t,e)=>{Yt.init(t,e);const n=new RegExp(`^${_n(e.prefix)}.*`);e.pattern??(e.pattern=n),t._zod.onattach.push(i=>{const r=i._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),t._zod.check=i=>{i.value.startsWith(e.prefix)||i.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:i.value,inst:t,continue:!e.abort})}}),V0=K("$ZodCheckEndsWith",(t,e)=>{Yt.init(t,e);const n=new RegExp(`.*${_n(e.suffix)}$`);e.pattern??(e.pattern=n),t._zod.onattach.push(i=>{const r=i._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),t._zod.check=i=>{i.value.endsWith(e.suffix)||i.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:i.value,inst:t,continue:!e.abort})}}),H0=K("$ZodCheckOverwrite",(t,e)=>{Yt.init(t,e),t._zod.check=n=>{n.value=e.tx(n.value)}});class W0{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const i=e.split(`
`).filter(o=>o),r=Math.min(...i.map(o=>o.length-o.trimStart().length)),s=i.map(o=>o.slice(r)).map(o=>" ".repeat(this.indent*2)+o);for(const o of s)this.content.push(o)}compile(){const e=Function,n=this?.args,r=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...n,r.join(`
`))}}const j0={major:4,minor:1,patch:13},kt=K("$ZodType",(t,e)=>{var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=j0;const i=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&i.unshift(t);for(const r of i)for(const s of r._zod.onattach)s(t);if(i.length===0)(n=t._zod).deferred??(n.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const r=(o,a,l)=>{let c=vn(o),h;for(const d of a){if(d._zod.def.when){if(!d._zod.def.when(o))continue}else if(c)continue;const g=o.issues.length,f=d._zod.check(o);if(f instanceof Promise&&l?.async===!1)throw new pn;if(h||f instanceof Promise)h=(h??Promise.resolve()).then(async()=>{await f,o.issues.length!==g&&(c||(c=vn(o,g)))});else{if(o.issues.length===g)continue;c||(c=vn(o,g))}}return h?h.then(()=>o):o},s=(o,a,l)=>{if(vn(o))return o.aborted=!0,o;const c=r(a,i,l);if(c instanceof Promise){if(l.async===!1)throw new pn;return c.then(h=>t._zod.parse(h,l))}return t._zod.parse(c,l)};t._zod.run=(o,a)=>{if(a.skipChecks)return t._zod.parse(o,a);if(a.direction==="backward"){const c=t._zod.parse({value:o.value,issues:[]},{...a,skipChecks:!0});return c instanceof Promise?c.then(h=>s(h,o,a)):s(c,o,a)}const l=t._zod.parse(o,a);if(l instanceof Promise){if(a.async===!1)throw new pn;return l.then(c=>r(c,i,a))}return r(l,i,a)}}t["~standard"]={validate:r=>{try{const s=Xf(t,r);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return Qf(t,r).then(o=>o.success?{value:o.data}:{issues:o.error?.issues})}},vendor:"zod",version:1}}),Ds=K("$ZodString",(t,e)=>{kt.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??k0(t._zod.bag),t._zod.parse=(n,i)=>{if(e.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:t}),n}}),At=K("$ZodStringFormat",(t,e)=>{br.init(t,e),Ds.init(t,e)}),Z0=K("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=g0),At.init(t,e)}),q0=K("$ZodUUID",(t,e)=>{if(e.version){const i={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(i===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=lc(i))}else e.pattern??(e.pattern=lc());At.init(t,e)}),K0=K("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=p0),At.init(t,e)}),Y0=K("$ZodURL",(t,e)=>{At.init(t,e),t._zod.check=n=>{try{const i=n.value.trim(),r=new URL(i);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(r.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:e.hostname.source,input:n.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(r.protocol.endsWith(":")?r.protocol.slice(0,-1):r.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:t,continue:!e.abort})),e.normalize?n.value=r.href:n.value=i;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:t,continue:!e.abort})}}}),X0=K("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=_0()),At.init(t,e)}),Q0=K("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=d0),At.init(t,e)}),J0=K("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=a0),At.init(t,e)}),tg=K("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=l0),At.init(t,e)}),eg=K("$ZodULID",(t,e)=>{e.pattern??(e.pattern=c0),At.init(t,e)}),ng=K("$ZodXID",(t,e)=>{e.pattern??(e.pattern=h0),At.init(t,e)}),ig=K("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=u0),At.init(t,e)}),rg=K("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=T0(e)),At.init(t,e)}),sg=K("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=C0),At.init(t,e)}),og=K("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=P0(e)),At.init(t,e)}),ag=K("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=f0),At.init(t,e)}),lg=K("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=v0),At.init(t,e),t._zod.bag.format="ipv4"}),cg=K("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=b0),At.init(t,e),t._zod.bag.format="ipv6",t._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:t,continue:!e.abort})}}}),hg=K("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=y0),At.init(t,e)}),ug=K("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=S0),At.init(t,e),t._zod.check=n=>{const i=n.value.split("/");try{if(i.length!==2)throw new Error;const[r,s]=i;if(!s)throw new Error;const o=Number(s);if(`${o}`!==s)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:t,continue:!e.abort})}}});function pc(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const dg=K("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=w0),At.init(t,e),t._zod.bag.contentEncoding="base64",t._zod.check=n=>{pc(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:t,continue:!e.abort})}});function fg(t){if(!cc.test(t))return!1;const e=t.replace(/[-_]/g,i=>i==="-"?"+":"/"),n=e.padEnd(Math.ceil(e.length/4)*4,"=");return pc(n)}const gg=K("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=cc),At.init(t,e),t._zod.bag.contentEncoding="base64url",t._zod.check=n=>{fg(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:t,continue:!e.abort})}}),pg=K("$ZodE164",(t,e)=>{e.pattern??(e.pattern=x0),At.init(t,e)});function mg(t,e=null){try{const n=t.split(".");if(n.length!==3)return!1;const[i]=n;if(!i)return!1;const r=JSON.parse(atob(i));return!("typ"in r&&r?.typ!=="JWT"||!r.alg||e&&(!("alg"in r)||r.alg!==e))}catch{return!1}}const _g=K("$ZodJWT",(t,e)=>{At.init(t,e),t._zod.check=n=>{mg(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:t,continue:!e.abort})}}),mc=K("$ZodNumber",(t,e)=>{kt.init(t,e),t._zod.pattern=t._zod.bag.pattern??R0,t._zod.parse=(n,i)=>{if(e.coerce)try{n.value=Number(n.value)}catch{}const r=n.value;if(typeof r=="number"&&!Number.isNaN(r)&&Number.isFinite(r))return n;const s=typeof r=="number"?Number.isNaN(r)?"NaN":Number.isFinite(r)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:r,inst:t,...s?{received:s}:{}}),n}}),vg=K("$ZodNumberFormat",(t,e)=>{O0.init(t,e),mc.init(t,e)}),bg=K("$ZodBoolean",(t,e)=>{kt.init(t,e),t._zod.pattern=A0,t._zod.parse=(n,i)=>{if(e.coerce)try{n.value=!!n.value}catch{}const r=n.value;return typeof r=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:r,inst:t}),n}}),yg=K("$ZodUnknown",(t,e)=>{kt.init(t,e),t._zod.parse=n=>n}),Sg=K("$ZodNever",(t,e)=>{kt.init(t,e),t._zod.parse=(n,i)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)});function _c(t,e,n){t.issues.length&&e.issues.push(...en(n,t.issues)),e.value[n]=t.value}const wg=K("$ZodArray",(t,e)=>{kt.init(t,e),t._zod.parse=(n,i)=>{const r=n.value;if(!Array.isArray(r))return n.issues.push({expected:"array",code:"invalid_type",input:r,inst:t}),n;n.value=Array(r.length);const s=[];for(let o=0;o<r.length;o++){const a=r[o],l=e.element._zod.run({value:a,issues:[]},i);l instanceof Promise?s.push(l.then(c=>_c(c,n,o))):_c(l,n,o)}return s.length?Promise.all(s).then(()=>n):n}});function yr(t,e,n,i){t.issues.length&&e.issues.push(...en(n,t.issues)),t.value===void 0?n in i&&(e.value[n]=void 0):e.value[n]=t.value}function vc(t){const e=Object.keys(t.shape);for(const i of e)if(!t.shape?.[i]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${i}": expected a Zod schema`);const n=Uf(t.shape);return{...t,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(n)}}function bc(t,e,n,i,r,s){const o=[],a=r.keySet,l=r.catchall._zod,c=l.def.type;for(const h in e){if(a.has(h))continue;if(c==="never"){o.push(h);continue}const d=l.run({value:e[h],issues:[]},i);d instanceof Promise?t.push(d.then(g=>yr(g,n,h,e))):yr(d,n,h,e)}return o.length&&n.issues.push({code:"unrecognized_keys",keys:o,input:e,inst:s}),t.length?Promise.all(t).then(()=>n):n}const xg=K("$ZodObject",(t,e)=>{if(kt.init(t,e),!Object.getOwnPropertyDescriptor(e,"shape")?.get){const a=e.shape;Object.defineProperty(e,"shape",{get:()=>{const l={...a};return Object.defineProperty(e,"shape",{value:l}),l}})}const i=pr(()=>vc(e));xt(t._zod,"propValues",()=>{const a=e.shape,l={};for(const c in a){const h=a[c]._zod;if(h.values){l[c]??(l[c]=new Set);for(const d of h.values)l[c].add(d)}}return l});const r=Ai,s=e.catchall;let o;t._zod.parse=(a,l)=>{o??(o=i.value);const c=a.value;if(!r(c))return a.issues.push({expected:"object",code:"invalid_type",input:c,inst:t}),a;a.value={};const h=[],d=o.shape;for(const g of o.keys){const p=d[g]._zod.run({value:c[g],issues:[]},l);p instanceof Promise?h.push(p.then(v=>yr(v,a,g,c))):yr(p,a,g,c)}return s?bc(h,c,a,l,i.value,t):h.length?Promise.all(h).then(()=>a):a}}),Cg=K("$ZodObjectJIT",(t,e)=>{xg.init(t,e);const n=t._zod.parse,i=pr(()=>vc(e)),r=g=>{const f=new W0(["shape","payload","ctx"]),p=i.value,v=u=>{const _=nc(u);return`shape[${_}]._zod.run({ value: input[${_}], issues: [] }, ctx)`};f.write("const input = payload.value;");const S=Object.create(null);let C=0;for(const u of p.keys)S[u]=`key_${C++}`;f.write("const newResult = {};");for(const u of p.keys){const _=S[u],y=nc(u);f.write(`const ${_} = ${v(u)};`),f.write(`
        if (${_}.issues.length) {
          payload.issues = payload.issues.concat(${_}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${y}, ...iss.path] : [${y}]
          })));
        }
        
        
        if (${_}.value === undefined) {
          if (${y} in input) {
            newResult[${y}] = undefined;
          }
        } else {
          newResult[${y}] = ${_}.value;
        }
        
      `)}f.write("payload.value = newResult;"),f.write("return payload;");const m=f.compile();return(u,_)=>m(g,u,_)};let s;const o=Ai,a=!tc.jitless,c=a&&Lf.value,h=e.catchall;let d;t._zod.parse=(g,f)=>{d??(d=i.value);const p=g.value;return o(p)?a&&c&&f?.async===!1&&f.jitless!==!0?(s||(s=r(e.shape)),g=s(g,f),h?bc([],p,g,f,d,t):g):n(g,f):(g.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),g)}});function yc(t,e,n,i){for(const s of t)if(s.issues.length===0)return e.value=s.value,e;const r=t.filter(s=>!vn(s));return r.length===1?(e.value=r[0].value,r[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(s=>s.issues.map(o=>Be(o,i,Ge())))}),e)}const Sc=K("$ZodUnion",(t,e)=>{kt.init(t,e),xt(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),xt(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),xt(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),xt(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){const r=e.options.map(s=>s._zod.pattern);return new RegExp(`^(${r.map(s=>Ms(s.source)).join("|")})$`)}});const n=e.options.length===1,i=e.options[0]._zod.run;t._zod.parse=(r,s)=>{if(n)return i(r,s);let o=!1;const a=[];for(const l of e.options){const c=l._zod.run({value:r.value,issues:[]},s);if(c instanceof Promise)a.push(c),o=!0;else{if(c.issues.length===0)return c;a.push(c)}}return o?Promise.all(a).then(l=>yc(l,r,t,s)):yc(a,r,t,s)}}),Pg=K("$ZodDiscriminatedUnion",(t,e)=>{Sc.init(t,e);const n=t._zod.parse;xt(t._zod,"propValues",()=>{const r={};for(const s of e.options){const o=s._zod.propValues;if(!o||Object.keys(o).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(const[a,l]of Object.entries(o)){r[a]||(r[a]=new Set);for(const c of l)r[a].add(c)}}return r});const i=pr(()=>{const r=e.options,s=new Map;for(const o of r){const a=o._zod.propValues?.[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(o)}"`);for(const l of a){if(s.has(l))throw new Error(`Duplicate discriminator value "${String(l)}"`);s.set(l,o)}}return s});t._zod.parse=(r,s)=>{const o=r.value;if(!Ai(o))return r.issues.push({code:"invalid_type",expected:"object",input:o,inst:t}),r;const a=i.value.get(o?.[e.discriminator]);return a?a._zod.run(r,s):e.unionFallback?n(r,s):(r.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:e.discriminator,input:o,path:[e.discriminator],inst:t}),r)}}),Tg=K("$ZodIntersection",(t,e)=>{kt.init(t,e),t._zod.parse=(n,i)=>{const r=n.value,s=e.left._zod.run({value:r,issues:[]},i),o=e.right._zod.run({value:r,issues:[]},i);return s instanceof Promise||o instanceof Promise?Promise.all([s,o]).then(([l,c])=>wc(n,l,c)):wc(n,s,o)}});function zs(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(mn(t)&&mn(e)){const n=Object.keys(e),i=Object.keys(t).filter(s=>n.indexOf(s)!==-1),r={...t,...e};for(const s of i){const o=zs(t[s],e[s]);if(!o.valid)return{valid:!1,mergeErrorPath:[s,...o.mergeErrorPath]};r[s]=o.data}return{valid:!0,data:r}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let i=0;i<t.length;i++){const r=t[i],s=e[i],o=zs(r,s);if(!o.valid)return{valid:!1,mergeErrorPath:[i,...o.mergeErrorPath]};n.push(o.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function wc(t,e,n){if(e.issues.length&&t.issues.push(...e.issues),n.issues.length&&t.issues.push(...n.issues),vn(t))return t;const i=zs(e.value,n.value);if(!i.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(i.mergeErrorPath)}`);return t.value=i.data,t}const kg=K("$ZodTuple",(t,e)=>{kt.init(t,e);const n=e.items;t._zod.parse=(i,r)=>{const s=i.value;if(!Array.isArray(s))return i.issues.push({input:s,inst:t,expected:"tuple",code:"invalid_type"}),i;i.value=[];const o=[],a=[...n].reverse().findIndex(h=>h._zod.optin!=="optional"),l=a===-1?0:n.length-a;if(!e.rest){const h=s.length>n.length,d=s.length<l-1;if(h||d)return i.issues.push({...h?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length},input:s,inst:t,origin:"array"}),i}let c=-1;for(const h of n){if(c++,c>=s.length&&c>=l)continue;const d=h._zod.run({value:s[c],issues:[]},r);d instanceof Promise?o.push(d.then(g=>Sr(g,i,c))):Sr(d,i,c)}if(e.rest){const h=s.slice(n.length);for(const d of h){c++;const g=e.rest._zod.run({value:d,issues:[]},r);g instanceof Promise?o.push(g.then(f=>Sr(f,i,c))):Sr(g,i,c)}}return o.length?Promise.all(o).then(()=>i):i}});function Sr(t,e,n){t.issues.length&&e.issues.push(...en(n,t.issues)),e.value[n]=t.value}const Eg=K("$ZodRecord",(t,e)=>{kt.init(t,e),t._zod.parse=(n,i)=>{const r=n.value;if(!mn(r))return n.issues.push({expected:"record",code:"invalid_type",input:r,inst:t}),n;const s=[],o=e.keyType._zod.values;if(o){n.value={};const a=new Set;for(const c of o)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){a.add(typeof c=="number"?c.toString():c);const h=e.valueType._zod.run({value:r[c],issues:[]},i);h instanceof Promise?s.push(h.then(d=>{d.issues.length&&n.issues.push(...en(c,d.issues)),n.value[c]=d.value})):(h.issues.length&&n.issues.push(...en(c,h.issues)),n.value[c]=h.value)}let l;for(const c in r)a.has(c)||(l=l??[],l.push(c));l&&l.length>0&&n.issues.push({code:"unrecognized_keys",input:r,inst:t,keys:l})}else{n.value={};for(const a of Reflect.ownKeys(r)){if(a==="__proto__")continue;const l=e.keyType._zod.run({value:a,issues:[]},i);if(l instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(l.issues.length){n.issues.push({code:"invalid_key",origin:"record",issues:l.issues.map(h=>Be(h,i,Ge())),input:a,path:[a],inst:t}),n.value[l.value]=l.value;continue}const c=e.valueType._zod.run({value:r[a],issues:[]},i);c instanceof Promise?s.push(c.then(h=>{h.issues.length&&n.issues.push(...en(a,h.issues)),n.value[l.value]=h.value})):(c.issues.length&&n.issues.push(...en(a,c.issues)),n.value[l.value]=c.value)}}return s.length?Promise.all(s).then(()=>n):n}}),Rg=K("$ZodEnum",(t,e)=>{kt.init(t,e);const n=Ff(e.entries),i=new Set(n);t._zod.values=i,t._zod.pattern=new RegExp(`^(${n.filter(r=>Gf.has(typeof r)).map(r=>typeof r=="string"?_n(r):r.toString()).join("|")})$`),t._zod.parse=(r,s)=>{const o=r.value;return i.has(o)||r.issues.push({code:"invalid_value",values:n,input:o,inst:t}),r}}),Ag=K("$ZodLiteral",(t,e)=>{if(kt.init(t,e),e.values.length===0)throw new Error("Cannot create literal schema with no valid values");const n=new Set(e.values);t._zod.values=n,t._zod.pattern=new RegExp(`^(${e.values.map(i=>typeof i=="string"?_n(i):i?_n(i.toString()):String(i)).join("|")})$`),t._zod.parse=(i,r)=>{const s=i.value;return n.has(s)||i.issues.push({code:"invalid_value",values:e.values,input:s,inst:t}),i}}),Ng=K("$ZodTransform",(t,e)=>{kt.init(t,e),t._zod.parse=(n,i)=>{if(i.direction==="backward")throw new Jl(t.constructor.name);const r=e.transform(n.value,n);if(i.async)return(r instanceof Promise?r:Promise.resolve(r)).then(o=>(n.value=o,n));if(r instanceof Promise)throw new pn;return n.value=r,n}});function xc(t,e){return t.issues.length&&e===void 0?{issues:[],value:void 0}:t}const Mg=K("$ZodOptional",(t,e)=>{kt.init(t,e),t._zod.optin="optional",t._zod.optout="optional",xt(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),xt(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${Ms(n.source)})?$`):void 0}),t._zod.parse=(n,i)=>{if(e.innerType._zod.optin==="optional"){const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>xc(s,n.value)):xc(r,n.value)}return n.value===void 0?n:e.innerType._zod.run(n,i)}}),Ig=K("$ZodNullable",(t,e)=>{kt.init(t,e),xt(t._zod,"optin",()=>e.innerType._zod.optin),xt(t._zod,"optout",()=>e.innerType._zod.optout),xt(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${Ms(n.source)}|null)$`):void 0}),xt(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(n,i)=>n.value===null?n:e.innerType._zod.run(n,i)}),Og=K("$ZodDefault",(t,e)=>{kt.init(t,e),t._zod.optin="optional",xt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,i)=>{if(i.direction==="backward")return e.innerType._zod.run(n,i);if(n.value===void 0)return n.value=e.defaultValue,n;const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>Cc(s,e)):Cc(r,e)}});function Cc(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const Fg=K("$ZodPrefault",(t,e)=>{kt.init(t,e),t._zod.optin="optional",xt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,i)=>(i.direction==="backward"||n.value===void 0&&(n.value=e.defaultValue),e.innerType._zod.run(n,i))}),Dg=K("$ZodNonOptional",(t,e)=>{kt.init(t,e),xt(t._zod,"values",()=>{const n=e.innerType._zod.values;return n?new Set([...n].filter(i=>i!==void 0)):void 0}),t._zod.parse=(n,i)=>{const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>Pc(s,t)):Pc(r,t)}});function Pc(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const zg=K("$ZodCatch",(t,e)=>{kt.init(t,e),xt(t._zod,"optin",()=>e.innerType._zod.optin),xt(t._zod,"optout",()=>e.innerType._zod.optout),xt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,i)=>{if(i.direction==="backward")return e.innerType._zod.run(n,i);const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>(n.value=s.value,s.issues.length&&(n.value=e.catchValue({...n,error:{issues:s.issues.map(o=>Be(o,i,Ge()))},input:n.value}),n.issues=[]),n)):(n.value=r.value,r.issues.length&&(n.value=e.catchValue({...n,error:{issues:r.issues.map(s=>Be(s,i,Ge()))},input:n.value}),n.issues=[]),n)}}),Lg=K("$ZodPipe",(t,e)=>{kt.init(t,e),xt(t._zod,"values",()=>e.in._zod.values),xt(t._zod,"optin",()=>e.in._zod.optin),xt(t._zod,"optout",()=>e.out._zod.optout),xt(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(n,i)=>{if(i.direction==="backward"){const s=e.out._zod.run(n,i);return s instanceof Promise?s.then(o=>wr(o,e.in,i)):wr(s,e.in,i)}const r=e.in._zod.run(n,i);return r instanceof Promise?r.then(s=>wr(s,e.out,i)):wr(r,e.out,i)}});function wr(t,e,n){return t.issues.length?(t.aborted=!0,t):e._zod.run({value:t.value,issues:t.issues},n)}const Gg=K("$ZodReadonly",(t,e)=>{kt.init(t,e),xt(t._zod,"propValues",()=>e.innerType._zod.propValues),xt(t._zod,"values",()=>e.innerType._zod.values),xt(t._zod,"optin",()=>e.innerType?._zod?.optin),xt(t._zod,"optout",()=>e.innerType?._zod?.optout),t._zod.parse=(n,i)=>{if(i.direction==="backward")return e.innerType._zod.run(n,i);const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(Tc):Tc(r)}});function Tc(t){return t.value=Object.freeze(t.value),t}const Ug=K("$ZodCustom",(t,e)=>{Yt.init(t,e),kt.init(t,e),t._zod.parse=(n,i)=>n,t._zod.check=n=>{const i=n.value,r=e.fn(i);if(r instanceof Promise)return r.then(s=>kc(s,n,i,t));kc(r,n,i,t)}});function kc(t,e,n,i){if(!t){const r={code:"custom",input:n,inst:i,path:[...i._zod.def.path??[]],continue:!i._zod.def.abort};i._zod.def.params&&(r.params=i._zod.def.params),e.issues.push(Ni(r))}}var Ec;class Bg{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...n){const i=n[0];if(this._map.set(e,i),i&&typeof i=="object"&&"id"in i){if(this._idmap.has(i.id))throw new Error(`ID ${i.id} already exists in the registry`);this._idmap.set(i.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const i={...this.get(n)??{}};delete i.id;const r={...i,...this._map.get(e)};return Object.keys(r).length?r:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function $g(){return new Bg}(Ec=globalThis).__zod_globalRegistry??(Ec.__zod_globalRegistry=$g());const xr=globalThis.__zod_globalRegistry;function Vg(t,e){return new t({type:"string",...ct(e)})}function Hg(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...ct(e)})}function Rc(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...ct(e)})}function Wg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...ct(e)})}function jg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ct(e)})}function Zg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ct(e)})}function qg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ct(e)})}function Kg(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...ct(e)})}function Yg(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...ct(e)})}function Xg(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...ct(e)})}function Qg(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...ct(e)})}function Jg(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...ct(e)})}function tp(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...ct(e)})}function ep(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...ct(e)})}function np(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...ct(e)})}function ip(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...ct(e)})}function rp(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...ct(e)})}function sp(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ct(e)})}function op(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ct(e)})}function ap(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...ct(e)})}function lp(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...ct(e)})}function cp(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...ct(e)})}function hp(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...ct(e)})}function up(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ct(e)})}function dp(t,e){return new t({type:"string",format:"date",check:"string_format",...ct(e)})}function fp(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...ct(e)})}function gp(t,e){return new t({type:"string",format:"duration",check:"string_format",...ct(e)})}function pp(t,e){return new t({type:"number",checks:[],...ct(e)})}function mp(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...ct(e)})}function _p(t,e){return new t({type:"boolean",...ct(e)})}function vp(t){return new t({type:"unknown"})}function bp(t,e){return new t({type:"never",...ct(e)})}function Ac(t,e){return new fc({check:"less_than",...ct(e),value:t,inclusive:!1})}function Ls(t,e){return new fc({check:"less_than",...ct(e),value:t,inclusive:!0})}function Nc(t,e){return new gc({check:"greater_than",...ct(e),value:t,inclusive:!1})}function Gs(t,e){return new gc({check:"greater_than",...ct(e),value:t,inclusive:!0})}function Mc(t,e){return new I0({check:"multiple_of",...ct(e),value:t})}function Ic(t,e){return new F0({check:"max_length",...ct(e),maximum:t})}function Cr(t,e){return new D0({check:"min_length",...ct(e),minimum:t})}function Oc(t,e){return new z0({check:"length_equals",...ct(e),length:t})}function yp(t,e){return new L0({check:"string_format",format:"regex",...ct(e),pattern:t})}function Sp(t){return new G0({check:"string_format",format:"lowercase",...ct(t)})}function wp(t){return new U0({check:"string_format",format:"uppercase",...ct(t)})}function xp(t,e){return new B0({check:"string_format",format:"includes",...ct(e),includes:t})}function Cp(t,e){return new $0({check:"string_format",format:"starts_with",...ct(e),prefix:t})}function Pp(t,e){return new V0({check:"string_format",format:"ends_with",...ct(e),suffix:t})}function bn(t){return new H0({check:"overwrite",tx:t})}function Tp(t){return bn(e=>e.normalize(t))}function kp(){return bn(t=>t.trim())}function Ep(){return bn(t=>t.toLowerCase())}function Rp(){return bn(t=>t.toUpperCase())}function Ap(){return bn(t=>zf(t))}function Np(t,e,n){return new t({type:"array",element:e,...ct(n)})}function Mp(t,e,n){return new t({type:"custom",check:"custom",fn:e,...ct(n)})}function Ip(t){const e=Op(n=>(n.addIssue=i=>{if(typeof i=="string")n.issues.push(Ni(i,n.value,e._zod.def));else{const r=i;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=e),r.continue??(r.continue=!e._zod.def.abort),n.issues.push(Ni(r))}},t(n.value,n)));return e}function Op(t,e){const n=new Yt({check:"custom",...ct(e)});return n._zod.check=t,n}const Fp=K("ZodISODateTime",(t,e)=>{rg.init(t,e),Mt.init(t,e)});function Dp(t){return up(Fp,t)}const zp=K("ZodISODate",(t,e)=>{sg.init(t,e),Mt.init(t,e)});function Lp(t){return dp(zp,t)}const Gp=K("ZodISOTime",(t,e)=>{og.init(t,e),Mt.init(t,e)});function Up(t){return fp(Gp,t)}const Bp=K("ZodISODuration",(t,e)=>{ag.init(t,e),Mt.init(t,e)});function $p(t){return gp(Bp,t)}const oe=K("ZodError",(t,e)=>{oc.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:n=>Yf(t,n)},flatten:{value:n=>Kf(t,n)},addIssue:{value:n=>{t.issues.push(n),t.message=JSON.stringify(t.issues,As,2)}},addIssues:{value:n=>{t.issues.push(...n),t.message=JSON.stringify(t.issues,As,2)}},isEmpty:{get(){return t.issues.length===0}}})},{Parent:Error}),Vp=Os(oe),Hp=Fs(oe),Wp=_r(oe),jp=vr(oe),Zp=Jf(oe),qp=t0(oe),Kp=e0(oe),Yp=n0(oe),Xp=i0(oe),Qp=r0(oe),Jp=s0(oe),t1=o0(oe),Nt=K("ZodType",(t,e)=>(kt.init(t,e),t.def=e,t.type=e.type,Object.defineProperty(t,"_def",{value:e}),t.check=(...n)=>t.clone(tn(e,{checks:[...e.checks??[],...n.map(i=>typeof i=="function"?{_zod:{check:i,def:{check:"custom"},onattach:[]}}:i)]})),t.clone=(n,i)=>Ue(t,n,i),t.brand=()=>t,t.register=(n,i)=>(n.add(t,i),t),t.parse=(n,i)=>Vp(t,n,i,{callee:t.parse}),t.safeParse=(n,i)=>Wp(t,n,i),t.parseAsync=async(n,i)=>Hp(t,n,i,{callee:t.parseAsync}),t.safeParseAsync=async(n,i)=>jp(t,n,i),t.spa=t.safeParseAsync,t.encode=(n,i)=>Zp(t,n,i),t.decode=(n,i)=>qp(t,n,i),t.encodeAsync=async(n,i)=>Kp(t,n,i),t.decodeAsync=async(n,i)=>Yp(t,n,i),t.safeEncode=(n,i)=>Xp(t,n,i),t.safeDecode=(n,i)=>Qp(t,n,i),t.safeEncodeAsync=async(n,i)=>Jp(t,n,i),t.safeDecodeAsync=async(n,i)=>t1(t,n,i),t.refine=(n,i)=>t.check(K1(n,i)),t.superRefine=n=>t.check(Y1(n)),t.overwrite=n=>t.check(bn(n)),t.optional=()=>Hc(t),t.nullable=()=>Wc(t),t.nullish=()=>Hc(Wc(t)),t.nonoptional=n=>$1(t,n),t.array=()=>Bs(t),t.or=n=>T1([t,n]),t.and=n=>R1(t,n),t.transform=n=>Zc(t,D1(n)),t.default=n=>G1(t,n),t.prefault=n=>B1(t,n),t.catch=n=>H1(t,n),t.pipe=n=>Zc(t,n),t.readonly=()=>Z1(t),t.describe=n=>{const i=t.clone();return xr.add(i,{description:n}),i},Object.defineProperty(t,"description",{get(){return xr.get(t)?.description},configurable:!0}),t.meta=(...n)=>{if(n.length===0)return xr.get(t);const i=t.clone();return xr.add(i,n[0]),i},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),Fc=K("_ZodString",(t,e)=>{Ds.init(t,e),Nt.init(t,e);const n=t._zod.bag;t.format=n.format??null,t.minLength=n.minimum??null,t.maxLength=n.maximum??null,t.regex=(...i)=>t.check(yp(...i)),t.includes=(...i)=>t.check(xp(...i)),t.startsWith=(...i)=>t.check(Cp(...i)),t.endsWith=(...i)=>t.check(Pp(...i)),t.min=(...i)=>t.check(Cr(...i)),t.max=(...i)=>t.check(Ic(...i)),t.length=(...i)=>t.check(Oc(...i)),t.nonempty=(...i)=>t.check(Cr(1,...i)),t.lowercase=i=>t.check(Sp(i)),t.uppercase=i=>t.check(wp(i)),t.trim=()=>t.check(kp()),t.normalize=(...i)=>t.check(Tp(...i)),t.toLowerCase=()=>t.check(Ep()),t.toUpperCase=()=>t.check(Rp()),t.slugify=()=>t.check(Ap())}),e1=K("ZodString",(t,e)=>{Ds.init(t,e),Fc.init(t,e),t.email=n=>t.check(Hg(n1,n)),t.url=n=>t.check(Kg(i1,n)),t.jwt=n=>t.check(hp(v1,n)),t.emoji=n=>t.check(Yg(r1,n)),t.guid=n=>t.check(Rc(Dc,n)),t.uuid=n=>t.check(Wg(Pr,n)),t.uuidv4=n=>t.check(jg(Pr,n)),t.uuidv6=n=>t.check(Zg(Pr,n)),t.uuidv7=n=>t.check(qg(Pr,n)),t.nanoid=n=>t.check(Xg(s1,n)),t.guid=n=>t.check(Rc(Dc,n)),t.cuid=n=>t.check(Qg(o1,n)),t.cuid2=n=>t.check(Jg(a1,n)),t.ulid=n=>t.check(tp(l1,n)),t.base64=n=>t.check(ap(p1,n)),t.base64url=n=>t.check(lp(m1,n)),t.xid=n=>t.check(ep(c1,n)),t.ksuid=n=>t.check(np(h1,n)),t.ipv4=n=>t.check(ip(u1,n)),t.ipv6=n=>t.check(rp(d1,n)),t.cidrv4=n=>t.check(sp(f1,n)),t.cidrv6=n=>t.check(op(g1,n)),t.e164=n=>t.check(cp(_1,n)),t.datetime=n=>t.check(Dp(n)),t.date=n=>t.check(Lp(n)),t.time=n=>t.check(Up(n)),t.duration=n=>t.check($p(n))});function yn(t){return Vg(e1,t)}const Mt=K("ZodStringFormat",(t,e)=>{At.init(t,e),Fc.init(t,e)}),n1=K("ZodEmail",(t,e)=>{K0.init(t,e),Mt.init(t,e)}),Dc=K("ZodGUID",(t,e)=>{Z0.init(t,e),Mt.init(t,e)}),Pr=K("ZodUUID",(t,e)=>{q0.init(t,e),Mt.init(t,e)}),i1=K("ZodURL",(t,e)=>{Y0.init(t,e),Mt.init(t,e)}),r1=K("ZodEmoji",(t,e)=>{X0.init(t,e),Mt.init(t,e)}),s1=K("ZodNanoID",(t,e)=>{Q0.init(t,e),Mt.init(t,e)}),o1=K("ZodCUID",(t,e)=>{J0.init(t,e),Mt.init(t,e)}),a1=K("ZodCUID2",(t,e)=>{tg.init(t,e),Mt.init(t,e)}),l1=K("ZodULID",(t,e)=>{eg.init(t,e),Mt.init(t,e)}),c1=K("ZodXID",(t,e)=>{ng.init(t,e),Mt.init(t,e)}),h1=K("ZodKSUID",(t,e)=>{ig.init(t,e),Mt.init(t,e)}),u1=K("ZodIPv4",(t,e)=>{lg.init(t,e),Mt.init(t,e)}),d1=K("ZodIPv6",(t,e)=>{cg.init(t,e),Mt.init(t,e)}),f1=K("ZodCIDRv4",(t,e)=>{hg.init(t,e),Mt.init(t,e)}),g1=K("ZodCIDRv6",(t,e)=>{ug.init(t,e),Mt.init(t,e)}),p1=K("ZodBase64",(t,e)=>{dg.init(t,e),Mt.init(t,e)}),m1=K("ZodBase64URL",(t,e)=>{gg.init(t,e),Mt.init(t,e)}),_1=K("ZodE164",(t,e)=>{pg.init(t,e),Mt.init(t,e)}),v1=K("ZodJWT",(t,e)=>{_g.init(t,e),Mt.init(t,e)}),zc=K("ZodNumber",(t,e)=>{mc.init(t,e),Nt.init(t,e),t.gt=(i,r)=>t.check(Nc(i,r)),t.gte=(i,r)=>t.check(Gs(i,r)),t.min=(i,r)=>t.check(Gs(i,r)),t.lt=(i,r)=>t.check(Ac(i,r)),t.lte=(i,r)=>t.check(Ls(i,r)),t.max=(i,r)=>t.check(Ls(i,r)),t.int=i=>t.check(Lc(i)),t.safe=i=>t.check(Lc(i)),t.positive=i=>t.check(Nc(0,i)),t.nonnegative=i=>t.check(Gs(0,i)),t.negative=i=>t.check(Ac(0,i)),t.nonpositive=i=>t.check(Ls(0,i)),t.multipleOf=(i,r)=>t.check(Mc(i,r)),t.step=(i,r)=>t.check(Mc(i,r)),t.finite=()=>t;const n=t._zod.bag;t.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),t.isFinite=!0,t.format=n.format??null});function Dt(t){return pp(zc,t)}const b1=K("ZodNumberFormat",(t,e)=>{vg.init(t,e),zc.init(t,e)});function Lc(t){return mp(b1,t)}const y1=K("ZodBoolean",(t,e)=>{bg.init(t,e),Nt.init(t,e)});function Gc(t){return _p(y1,t)}const S1=K("ZodUnknown",(t,e)=>{yg.init(t,e),Nt.init(t,e)});function Us(){return vp(S1)}const w1=K("ZodNever",(t,e)=>{Sg.init(t,e),Nt.init(t,e)});function x1(t){return bp(w1,t)}const C1=K("ZodArray",(t,e)=>{wg.init(t,e),Nt.init(t,e),t.element=e.element,t.min=(n,i)=>t.check(Cr(n,i)),t.nonempty=n=>t.check(Cr(1,n)),t.max=(n,i)=>t.check(Ic(n,i)),t.length=(n,i)=>t.check(Oc(n,i)),t.unwrap=()=>t.element});function Bs(t,e){return Np(C1,t,e)}const P1=K("ZodObject",(t,e)=>{Cg.init(t,e),Nt.init(t,e),xt(t,"shape",()=>e.shape),t.keyof=()=>$c(Object.keys(t._zod.def.shape)),t.catchall=n=>t.clone({...t._zod.def,catchall:n}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Us()}),t.loose=()=>t.clone({...t._zod.def,catchall:Us()}),t.strict=()=>t.clone({...t._zod.def,catchall:x1()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=n=>Hf(t,n),t.safeExtend=n=>Wf(t,n),t.merge=n=>jf(t,n),t.pick=n=>$f(t,n),t.omit=n=>Vf(t,n),t.partial=(...n)=>Zf(Vc,t,n[0]),t.required=(...n)=>qf(jc,t,n[0])});function ne(t,e){const n={type:"object",shape:t??{},...ct(e)};return new P1(n)}const Uc=K("ZodUnion",(t,e)=>{Sc.init(t,e),Nt.init(t,e),t.options=e.options});function T1(t,e){return new Uc({type:"union",options:t,...ct(e)})}const k1=K("ZodDiscriminatedUnion",(t,e)=>{Uc.init(t,e),Pg.init(t,e)});function Bc(t,e,n){return new k1({type:"union",options:e,discriminator:t,...ct(n)})}const E1=K("ZodIntersection",(t,e)=>{Tg.init(t,e),Nt.init(t,e)});function R1(t,e){return new E1({type:"intersection",left:t,right:e})}const A1=K("ZodTuple",(t,e)=>{kg.init(t,e),Nt.init(t,e),t.rest=n=>t.clone({...t._zod.def,rest:n})});function N1(t,e,n){const i=e instanceof kt,r=i?n:e,s=i?e:null;return new A1({type:"tuple",items:t,rest:s,...ct(r)})}const M1=K("ZodRecord",(t,e)=>{Eg.init(t,e),Nt.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function I1(t,e,n){return new M1({type:"record",keyType:t,valueType:e,...ct(n)})}const $s=K("ZodEnum",(t,e)=>{Rg.init(t,e),Nt.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));t.extract=(i,r)=>{const s={};for(const o of i)if(n.has(o))s[o]=e.entries[o];else throw new Error(`Key ${o} not found in enum`);return new $s({...e,checks:[],...ct(r),entries:s})},t.exclude=(i,r)=>{const s={...e.entries};for(const o of i)if(n.has(o))delete s[o];else throw new Error(`Key ${o} not found in enum`);return new $s({...e,checks:[],...ct(r),entries:s})}});function $c(t,e){const n=Array.isArray(t)?Object.fromEntries(t.map(i=>[i,i])):t;return new $s({type:"enum",entries:n,...ct(e)})}const O1=K("ZodLiteral",(t,e)=>{Ag.init(t,e),Nt.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function Re(t,e){return new O1({type:"literal",values:Array.isArray(t)?t:[t],...ct(e)})}const F1=K("ZodTransform",(t,e)=>{Ng.init(t,e),Nt.init(t,e),t._zod.parse=(n,i)=>{if(i.direction==="backward")throw new Jl(t.constructor.name);n.addIssue=s=>{if(typeof s=="string")n.issues.push(Ni(s,n.value,e));else{const o=s;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=n.value),o.inst??(o.inst=t),n.issues.push(Ni(o))}};const r=e.transform(n.value,n);return r instanceof Promise?r.then(s=>(n.value=s,n)):(n.value=r,n)}});function D1(t){return new F1({type:"transform",transform:t})}const Vc=K("ZodOptional",(t,e)=>{Mg.init(t,e),Nt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Hc(t){return new Vc({type:"optional",innerType:t})}const z1=K("ZodNullable",(t,e)=>{Ig.init(t,e),Nt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Wc(t){return new z1({type:"nullable",innerType:t})}const L1=K("ZodDefault",(t,e)=>{Og.init(t,e),Nt.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function G1(t,e){return new L1({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():rc(e)}})}const U1=K("ZodPrefault",(t,e)=>{Fg.init(t,e),Nt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function B1(t,e){return new U1({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():rc(e)}})}const jc=K("ZodNonOptional",(t,e)=>{Dg.init(t,e),Nt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function $1(t,e){return new jc({type:"nonoptional",innerType:t,...ct(e)})}const V1=K("ZodCatch",(t,e)=>{zg.init(t,e),Nt.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function H1(t,e){return new V1({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const W1=K("ZodPipe",(t,e)=>{Lg.init(t,e),Nt.init(t,e),t.in=e.in,t.out=e.out});function Zc(t,e){return new W1({type:"pipe",in:t,out:e})}const j1=K("ZodReadonly",(t,e)=>{Gg.init(t,e),Nt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Z1(t){return new j1({type:"readonly",innerType:t})}const q1=K("ZodCustom",(t,e)=>{Ug.init(t,e),Nt.init(t,e)});function K1(t,e={}){return Mp(q1,t,e)}function Y1(t){return Ip(t)}const qc=$c(["notes","selection","playhead","viewport","grid","other"]),Kc=I1(yn(),Us()).optional(),X1=ne({id:yn().optional(),pitch:Dt().int().min(0).max(127),position:Dt(),duration:Dt().positive(),velocity:Dt().int().min(0).max(127).optional(),metadata:Kc}),Q1=ne({id:yn(),pitch:Dt().int().min(0).max(127),position:Dt(),duration:Dt().positive(),velocity:Dt().int().min(0).max(127),metadata:Kc}),J1=ne({type:Re("setNotes"),notes:Bs(X1)}),t2=ne({type:Re("setLivePlayhead"),position:Dt().nonnegative()}),e2=ne({type:Re("fitZoomToNotes")}),n2=ne({type:Re("getPlayStartPosition"),requestId:yn().optional()}),i2=ne({type:Re("setConfig"),width:Dt().positive().optional(),height:Dt().positive().optional(),interactive:Gc().optional(),showControlPanel:Gc().optional()}),r2=Bc("type",[J1,t2,e2,n2,i2]),s2=ne({type:Re("notesUpdate"),notes:Bs(N1([yn(),Q1])),source:qc.optional()}),o2=ne({type:Re("stateUpdate"),viewport:ne({scrollX:Dt(),scrollY:Dt(),zoomX:Dt(),zoomY:Dt()}),grid:ne({quarterNoteWidth:Dt(),noteHeight:Dt(),subdivision:Dt()}),source:qc.optional()}),a2=ne({type:Re("playStartPositionResponse"),position:Dt(),requestId:yn().optional()}),l2=ne({type:Re("connectionReady")}),c2=Bc("type",[s2,o2,a2,l2]);class h2{ws=null;reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;reconnectTimer=null;address;handlers={};constructor(e){this.address=e}setHandlers(e){this.handlers=e}connect(){if(this.ws?.readyState!==WebSocket.OPEN)try{this.ws=new WebSocket(this.address),this.ws.onopen=()=>{this.reconnectAttempts=0,this.send({type:"connectionReady"})},this.ws.onmessage=e=>{this.handleMessage(e.data)},this.ws.onclose=()=>{this.scheduleReconnect()},this.ws.onerror=()=>{}}catch{this.scheduleReconnect()}}scheduleReconnect(){this.reconnectAttempts>=this.maxReconnectAttempts||(this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.reconnectAttempts++,this.connect()},this.reconnectDelay*Math.pow(2,this.reconnectAttempts)))}handleMessage(e){let n;try{n=JSON.parse(e)}catch{console.warn("[PianoRollWS] Invalid JSON received:",e);return}const i=r2.safeParse(n);if(!i.success){console.warn("[PianoRollWS] Invalid message format:",i.error.format());return}const r=i.data;switch(r.type){case"setNotes":this.handlers.onSetNotes?.(r.notes);break;case"setLivePlayhead":this.handlers.onSetLivePlayhead?.(r.position);break;case"fitZoomToNotes":this.handlers.onFitZoomToNotes?.();break;case"getPlayStartPosition":this.handlers.onGetPlayStartPosition?.(r.requestId);break;case"setConfig":this.handlers.onSetConfig?.({width:r.width,height:r.height,interactive:r.interactive,showControlPanel:r.showControlPanel});break}}send(e){if(this.ws?.readyState!==WebSocket.OPEN)return;const n=c2.safeParse(e);if(!n.success){console.warn("[PianoRollWS] Invalid outgoing message:",n.error.format());return}this.ws.send(JSON.stringify(e))}sendNotesUpdate(e,n){this.send({type:"notesUpdate",notes:e,source:n})}sendStateUpdate(e,n){this.send({type:"stateUpdate",viewport:{scrollX:e.viewport.scrollX,scrollY:e.viewport.scrollY,zoomX:e.viewport.zoomX,zoomY:e.viewport.zoomY},grid:{quarterNoteWidth:e.grid.quarterNoteWidth,noteHeight:e.grid.noteHeight,subdivision:e.grid.subdivision},source:n})}sendPlayStartPositionResponse(e,n){this.send({type:"playStartPositionResponse",position:e,requestId:n})}disconnect(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.onclose=null,this.ws.close(),this.ws=null)}get isConnected(){return this.ws?.readyState===WebSocket.OPEN}}const u2=(t="note_")=>`${t}${Date.now()}_${Math.random().toString(36).substr(2,9)}`;function Yc(t,e){const{scrollX:n,scrollY:i}=e.viewport,{quarterNoteWidth:r,noteHeight:s}=e.grid,o=t.x+n,a=t.y+i,l=o/r;return{pitch:127-Math.floor(a/s),position:l}}function Tr(t,e,n){const{scrollX:i,scrollY:r}=n.viewport,{quarterNoteWidth:s,noteHeight:o}=n.grid,a=e*s,l=(127-t)*o;return{x:a-i,y:l-r}}function Xc(t,e){const n=e/4;return Math.floor(t*n)/n}function Qc(t){return t.grid.quarterNoteWidth*(4/t.grid.subdivision)}function Jc(t,e){const{scrollX:n,scrollY:i}=e.viewport,{quarterNoteWidth:r,noteHeight:s}=e.grid,o=e.stage;if(!o)return!1;const a=o.width(),l=o.height(),c=n/r,h=(n+a)/r,d=Math.floor(i/s),g=Math.ceil((i+l)/s),f=t.position+t.duration,p=127-t.pitch;return!(f<c||t.position>h||p<d||p>g)}function d2(t,e){const{scrollX:n,scrollY:i}=t.viewport,{quarterNoteWidth:r,noteHeight:s}=t.grid,o=[];return t.notes.forEach((a,l)=>{const c=Tr(a.pitch,a.position,t),h=a.duration*r,d=c.x+h,g=c.y+s,f=e.x+e.width,p=e.y+e.height;!(d<e.x||c.x>f||g<e.y||c.y>p)&&o.push(l)}),o}function th(t,e){const n=new Set(e);if(n.size===0)return t.interaction.createEmptyOverlapAdjustments();const i=new Set,r=new Map;return n.forEach(s=>{const o=t.notes.get(s);if(!o)return;const a=o.position+o.duration;t.notes.forEach((l,c)=>{if(n.has(c)||l.pitch!==o.pitch)return;const h=l.position+l.duration;if(l.position<o.position&&o.position<h){const d=o.position-l.position;d>0?i.has(c)||r.set(c,d):(i.add(c),r.delete(c))}else o.position<=l.position&&l.position<a&&(i.add(c),r.delete(c))})}),i.size===0&&r.size===0?t.interaction.createEmptyOverlapAdjustments():{toDelete:i,toTruncate:r}}function eh(t){t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear();const e=th(t,t.selection.selectedIds);e.toDelete.forEach(n=>t.interaction.hiddenNoteIds.add(n)),e.toTruncate.forEach((n,i)=>t.interaction.truncatedNotes.set(i,n))}function f2(t,e,n){return t.interaction.truncatedNotes.get(e)??n}function Vs(t,e){let n=null,i=!1;if(!e&&(t.interaction.hiddenNoteIds.size>0||t.interaction.truncatedNotes.size>0))n={toDelete:new Set(t.interaction.hiddenNoteIds),toTruncate:new Map(t.interaction.truncatedNotes)},i=!0;else{const r=e??t.selection.selectedIds;n=th(t,r)}return n.toDelete.size===0&&n.toTruncate.size===0?(i||(t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear()),n):(n.toDelete.forEach(r=>{t.notes.delete(r),t.selection.selectedIds.delete(r)}),n.toTruncate.forEach((r,s)=>{const o=t.notes.get(s);o&&(o.duration=Math.max(r,0))}),t.needsRedraw=!0,i||(t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear()),n)}function nh(t){t.interaction.truncatedNotes.clear(),t.interaction.hiddenNoteIds.clear()}function g2(t){let n=null;for(const i of t.selection.selectedIds){const r=t.notes.get(i);if(!r)continue;let s=1/0,o=null;if(t.notes.forEach((a,l)=>{if(t.selection.selectedIds.has(l))return;const c=Math.abs(r.position-a.position);c<s&&c<.1&&(s=c,o=a.position)}),o!==null){n=o-r.position;break}}n!==null&&t.selection.selectedIds.forEach(i=>{const r=t.notes.get(i);r&&(r.position+=n)})}const p2=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function ih(t){return p2[t%12]+(Math.floor(t/12)-2)}class m2{constructor(e,n,i){this.captureState=e,this.restoreState=n,this.onChangeCallback=i}stack=[];currentIndex=-1;onChangeCallback;executeCommand(e,n){const i=this.captureState();n();const r=this.captureState();i!==r&&this.pushCommand(e,i,r)}pushCommand(e,n,i){this.stack=this.stack.slice(0,this.currentIndex+1),this.stack.push({name:e,beforeState:n,afterState:i}),this.currentIndex++,this.onChangeCallback?.()}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.stack.length-1}undo(){if(!this.canUndo())return;const e=this.stack[this.currentIndex];this.restoreState(e.beforeState),this.currentIndex--,this.onChangeCallback?.()}redo(){if(!this.canRedo())return;this.currentIndex++;const e=this.stack[this.currentIndex];this.restoreState(e.afterState),this.onChangeCallback?.()}clear(){this.stack=[],this.currentIndex=-1,this.onChangeCallback?.()}}function Mi(t){return JSON.stringify({notes:Array.from(t.notes.entries()),selection:Array.from(t.selection.selectedIds)})}function _2(t,e){const n=JSON.parse(e);t.notes=new Map(n.notes),t.selection.selectedIds=new Set(n.selection),t.needsRedraw=!0}function v2(t,e){if(t.size!==e.size)return!0;for(const n of t)if(!e.has(n))return!0;return!1}function Hs(t,e){const n=new Set(t.selection.selectedIds);e();const i=v2(n,t.selection.selectedIds);return i&&t.notifyExternalChange?.("selection"),i}function b2(t,e,n){const i=new Bt.Layer({listening:!1,name:"grid-layer"});e.add(i),t.layers.grid=i;const r=new Bt.Layer({name:"notes-layer"});e.add(r),t.layers.notes=r;const s=new Bt.Layer({name:"overlay-layer"});e.add(s),t.layers.overlay=s,t.selection.selectionRect=new Bt.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),s.add(t.selection.selectionRect);const o=128*t.grid.noteHeight;t.queuePlayhead.element=new Bt.Line({points:[0,0,0,o],stroke:"#00ff00",strokeWidth:2,listening:!1}),s.add(t.queuePlayhead.element),t.livePlayhead.element=new Bt.Line({points:[0,0,0,o],stroke:"#ff8800",strokeWidth:2,listening:!1}),s.add(t.livePlayhead.element),t.command.stack=new m2(()=>Mi(t),a=>_2(t,a),()=>{t.needsRedraw=!0,n?.()})}function y2(t){const e=t.layers.grid;if(!e||!t.stage)return;const n=t.renderCache.grid;if(n.lastScrollX===t.viewport.scrollX&&n.lastScrollY===t.viewport.scrollY&&n.lastSubdivision===t.grid.subdivision&&n.lastQuarterNoteWidth===t.grid.quarterNoteWidth&&n.lastNoteHeight===t.grid.noteHeight)return;n.lastScrollX=t.viewport.scrollX,n.lastScrollY=t.viewport.scrollY,n.lastSubdivision=t.grid.subdivision,n.lastQuarterNoteWidth=t.grid.quarterNoteWidth,n.lastNoteHeight=t.grid.noteHeight,e.destroyChildren();const{scrollX:i,scrollY:r}=t.viewport,{quarterNoteWidth:s,noteHeight:o,numMeasures:a,timeSignature:l}=t.grid,c=t.stage,h=c.width(),d=c.height(),g=128*o,f=l*4,p=s*f,v=Math.floor(i/p),S=Math.ceil((i+h)/p);for(let I=v;I<=S&&I<a;I++){const w=I%2===0?t.grid.backgroundColor1:t.grid.backgroundColor2,x=I*p-i;e.add(new Bt.Rect({x,y:-r,width:p,height:g,fill:w,listening:!1}))}const C=a*f*(t.grid.subdivision/4),m=s*(4/t.grid.subdivision),u=Math.floor(i/m),_=Math.ceil((i+h)/m);for(let I=u;I<=_&&I<C;I++){const w=I*m-i,T=I*m%s===0?1.8:1;e.add(new Bt.Line({points:[w,-r,w,g-r],stroke:"#000",strokeWidth:T,listening:!1}))}const y=Math.floor(r/o),k=Math.ceil((r+d)/o);for(let I=y;I<=k&&I<128;I++){const w=I*o-r;e.add(new Bt.Line({points:[0-i,w,a*p-i,w],stroke:"#000",strokeWidth:1,listening:!1}))}e.batchDraw()}function S2(t){const e=t.layers.notes;if(!e||!t.stage)return;e.destroyChildren();const{scrollX:n,scrollY:i}=t.viewport,{quarterNoteWidth:r,noteHeight:s}=t.grid,o=[],a=[];t.notes.forEach((l,c)=>{Jc(l,t)&&(t.selection.selectedIds.has(c)?a.push([c,l]):o.push([c,l]))}),o.forEach(([l,c])=>{const h=Tr(c.pitch,c.position,t),g=f2(t,l,c.duration)*r,f=t.interaction.hiddenNoteIds.has(l),p=new Bt.Rect({x:h.x,y:h.y,width:g,height:s,fill:t.grid.noteColor,stroke:"#000",strokeWidth:1,opacity:f?.3:1,listening:!0});p.setAttr("noteId",l),e.add(p);const v=ih(c.pitch),S=new Bt.Text({x:h.x+4,y:h.y+2,text:v,fontSize:14,fill:"#000",listening:!1});e.add(S)}),a.forEach(([l,c])=>{const h=Tr(c.pitch,c.position,t),d=c.duration*r,g=t.interaction.hiddenNoteIds.has(l),f=new Bt.Rect({x:h.x,y:h.y,width:d,height:s,fill:t.grid.selectedNoteColor,stroke:"#000",strokeWidth:1,opacity:g?.3:1,listening:!0});f.setAttr("noteId",l),e.add(f);const p=ih(c.pitch),v=new Bt.Text({x:h.x+4,y:h.y+2,text:p,fontSize:14,fill:"#000",listening:!1});e.add(v)}),e.batchDraw()}function w2(t){const e=t.layers.notes;if(!e)return;const{quarterNoteWidth:n,noteHeight:i}=t.grid,r=5;e.find(".resize-handle").forEach(s=>s.destroy()),t.selection.selectedIds.forEach(s=>{const o=t.notes.get(s);if(!o||!Jc(o,t))return;const a=Tr(o.pitch,o.position,t),l=o.duration*n,c=new Bt.Circle({x:a.x,y:a.y+i/2,radius:r,fill:"#000",listening:!0,name:"resize-handle"});c.setAttr("handleNoteId",s),c.setAttr("handleIsEnd",!1),e.add(c);const h=new Bt.Circle({x:a.x+l,y:a.y+i/2,radius:r,fill:"#000",listening:!0,name:"resize-handle"});h.setAttr("handleNoteId",s),h.setAttr("handleIsEnd",!0),e.add(h)}),e.batchDraw()}function x2(t){if(!t.selection.selectionRect||!t.interaction.marqueeStart||!t.interaction.marqueeCurrent)return;const e=t.interaction.marqueeStart,n=t.interaction.marqueeCurrent,i=Math.min(e.x,n.x),r=Math.min(e.y,n.y),s=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y);t.selection.selectionRect.setAttrs({x:i,y:r,width:s,height:o,visible:s>5||o>5}),t.layers.overlay?.batchDraw()}function C2(t){if(!t.queuePlayhead.element)return;const{scrollX:e}=t.viewport,n=t.queuePlayhead.position*t.grid.quarterNoteWidth-e;t.queuePlayhead.element.x(n),t.layers.overlay?.batchDraw()}function P2(t){if(!t.livePlayhead.element)return;const{scrollX:e}=t.viewport,n=t.livePlayhead.position*t.grid.quarterNoteWidth-e;t.livePlayhead.element.x(n),t.layers.overlay?.batchDraw()}function T2(t,e){t.layers.notes;const n=t.layers.grid;e.on("dblclick",i=>{if(i.target===e||i.target.getLayer()===n){const r=e.getPointerPosition();if(!r)return;const{pitch:s,position:o}=Yc(r,t),a=Xc(o,t.grid.subdivision),l=Math.round(s);t.command.stack?.executeCommand("Add Note",()=>{const c={id:u2(),pitch:l,position:a,duration:4/t.grid.subdivision,velocity:.8};t.notes.set(c.id,c),t.needsRedraw=!0})}}),e.on("mousedown touchstart",i=>{const r=i.target,s=r.getAttr?.("handleNoteId");if(s){const a=r.getAttr("handleIsEnd");A2(t,e,s,a);return}const o=r.getAttr?.("noteId");if(o){const a=i.evt.shiftKey||i.evt.ctrlKey,l=t.selection.selectedIds.has(o);Hs(t,()=>{a?l?t.selection.selectedIds.delete(o):t.selection.selectedIds.add(o):(!l||t.selection.selectedIds.size>1)&&(t.selection.selectedIds.clear(),t.selection.selectedIds.add(o))}),k2(t,e),t.needsRedraw=!0;return}if(r===e||r.getLayer()===n){const a=e.getPointerPosition();if(!a)return;t.interaction.isMarqueeSelecting=!0,t.interaction.marqueeStart=a,t.interaction.marqueeCurrent=a,t.interaction.marqueeIsShift=i.evt.shiftKey||i.evt.ctrlKey,t.interaction.marqueeIsShift||Hs(t,()=>{t.selection.selectedIds.clear()}),t.needsRedraw=!0}}),e.on("mousemove touchmove",i=>{const r=e.getPointerPosition();if(r){if(t.interaction.isDragging){E2(t,e);return}if(t.interaction.isResizing){N2(t,e);return}if(t.interaction.isMarqueeSelecting){t.interaction.marqueeCurrent=r,x2(t);const s={x:Math.min(t.interaction.marqueeStart.x,r.x),y:Math.min(t.interaction.marqueeStart.y,r.y),width:Math.abs(r.x-t.interaction.marqueeStart.x),height:Math.abs(r.y-t.interaction.marqueeStart.y)},o=d2(t,s);Hs(t,()=>{t.interaction.marqueeIsShift?o.forEach(a=>{t.selection.selectedIds.add(a)}):(t.selection.selectedIds.clear(),o.forEach(a=>{t.selection.selectedIds.add(a)}))}),t.needsRedraw=!0}}}),e.on("mouseup touchend",i=>{if(t.interaction.isDragging){R2(t);return}if(t.interaction.isResizing){M2(t);return}if(t.interaction.isMarqueeSelecting){const r=t.interaction.marqueeStart&&t.interaction.marqueeCurrent&&Math.abs(t.interaction.marqueeStart.x-t.interaction.marqueeCurrent.x)<5&&Math.abs(t.interaction.marqueeStart.y-t.interaction.marqueeCurrent.y)<5;if(t.interaction.isMarqueeSelecting=!1,t.selection.selectionRect&&(t.selection.selectionRect.visible(!1),t.layers.overlay?.batchDraw()),r&&i.target===e||i.target.getLayer()===n){const s=e.getPointerPosition();if(s){const{position:o}=Yc(s,t),a=Xc(o,t.grid.subdivision);t.queuePlayhead.position=Math.max(0,Math.min(a,t.grid.maxLength)),t.needsRedraw=!0,t.notifyExternalChange?.("playhead")}}}})}function k2(t,e){const n=e.getPointerPosition();n&&(t.interaction.isDragging=!0,t.interaction.dragStartPos=n,t.interaction.quantDragActivated=!1,t.interaction.dragBeforeState=Mi(t),t.interaction.draggedNoteInitialStates.clear(),t.selection.selectedIds.forEach(i=>{const r=t.notes.get(i);r&&t.interaction.draggedNoteInitialStates.set(i,{position:r.position,pitch:r.pitch})}))}function E2(t,e){const n=e.getPointerPosition();if(!n||!t.interaction.dragStartPos)return;const i=n.x-t.interaction.dragStartPos.x,r=n.y-t.interaction.dragStartPos.y,s=Qc(t);let o;Math.abs(i)<s*.9&&!t.interaction.quantDragActivated?o=i:(o=Math.round(i/s)*s,t.interaction.quantDragActivated=!0);const a=Math.round(r/t.grid.noteHeight);t.interaction.draggedNoteInitialStates.forEach((l,c)=>{const h=t.notes.get(c);h&&(h.position=l.position+o/t.grid.quarterNoteWidth,h.pitch=Math.max(0,Math.min(127,l.pitch-a)))}),g2(t),eh(t),t.needsRedraw=!0}function R2(t){Vs(t);const e=Mi(t);t.interaction.dragBeforeState&&t.interaction.dragBeforeState!==e&&t.command.stack?.pushCommand("Move Notes",t.interaction.dragBeforeState,e),t.interaction.isDragging=!1,nh(t),t.needsRedraw=!0}function A2(t,e,n,i){const r=e.getPointerPosition();r&&(t.interaction.isResizing=!0,t.interaction.resizeTargetId=n,t.interaction.resizeIsEnd=i,t.interaction.quantResizeActivated=!1,t.interaction.dragStartPos=r,t.interaction.resizeBeforeState=Mi(t),t.interaction.resizeInitialStates.clear(),t.selection.selectedIds.forEach(s=>{const o=t.notes.get(s);o&&t.interaction.resizeInitialStates.set(s,{position:o.position,duration:o.duration})}))}function N2(t,e){const n=e.getPointerPosition();if(!n||!t.interaction.dragStartPos)return;const i=n.x-t.interaction.dragStartPos.x,r=Qc(t);let s;Math.abs(i)<r*.9&&!t.interaction.quantResizeActivated?s=i:(s=Math.round(i/r)*r,t.interaction.quantResizeActivated=!0);const o=s/t.grid.quarterNoteWidth;t.interaction.resizeInitialStates.forEach((a,l)=>{const c=t.notes.get(l);c&&(t.interaction.resizeIsEnd?c.duration=Math.max(.25,a.duration+o):(c.position=a.position+o,c.duration=Math.max(.25,a.duration-o)))}),eh(t),t.needsRedraw=!0}function M2(t){Vs(t);const e=Mi(t);t.interaction.resizeBeforeState&&t.interaction.resizeBeforeState!==e&&t.command.stack?.pushCommand("Resize Notes",t.interaction.resizeBeforeState,e),t.interaction.isResizing=!1,nh(t),t.needsRedraw=!0}const Sn=.25,wn=1,Zt=128,rh=4,sh=12,I2=55,Ct=(t,e,n)=>n<e?e:Math.min(Math.max(t,e),n),xn=(t,e)=>t.stage?.width()??e,Cn=(t,e)=>t.stage?.height()??e,O2=t=>t.grid.maxLength*t.grid.quarterNoteWidth,F2=t=>Zt*t.grid.noteHeight,D2=(t,e)=>{t.grid.quarterNoteWidth=e,t.viewport.zoomX=e/t.grid.baseQuarterNoteWidth},z2=(t,e)=>{t.grid.noteHeight=e,t.viewport.zoomY=e/t.grid.baseNoteHeight},L2=(t,e)=>{const n=t.grid.quarterNoteWidth,i=xn(t,e),r=n===0?0:t.viewport.scrollX/n,s=r+i/(n||1);return{startQuarter:r,endQuarter:s}},G2=(t,e)=>{const n=t.grid.noteHeight,i=Cn(t,e),r=n===0?0:t.viewport.scrollY/n,s=r+i/(n||1);return{topIndex:r,bottomIndex:s}},Ws=(t,e,n,i)=>{const r=xn(t,e),s=Cn(t,n),o=Math.max(0,O2(t)-r),a=Ct(t.viewport.scrollX,0,o);a!==t.viewport.scrollX&&(t.viewport.scrollX=a,t.needsRedraw=!0,i());const l=Math.max(0,F2(t)-s),c=Ct(t.viewport.scrollY,0,l);c!==t.viewport.scrollY&&(t.viewport.scrollY=c,t.needsRedraw=!0,i())},js=(t,e,n,i,r,s)=>{if(!Number.isFinite(e)||e<=0)return;D2(t,e);const a=xn(t,i)/t.grid.quarterNoteWidth,l=Math.max(0,t.grid.maxLength-a),c=Ct(n,0,l);t.viewport.scrollX=c*t.grid.quarterNoteWidth,Ws(t,i,r,s),t.needsRedraw=!0,s()},Zs=(t,e,n,i,r,s)=>{if(!Number.isFinite(e)||e<=0)return;z2(t,e);const a=Cn(t,r)/t.grid.noteHeight,l=Math.max(0,Zt-a),c=Ct(n,0,l);t.viewport.scrollY=c*t.grid.noteHeight,Ws(t,i,r,s),t.needsRedraw=!0,s()},U2=(t,e,n,i)=>{const r=xn(t,e),s=Cn(t,n);if(r<=0||s<=0)return;const o=Array.from(t.notes.values());if(o.length===0){const D=r/rh;js(t,D,0,e,n,i);const L=sh,U=s/L,z=127-I2,X=Math.max(0,Zt-L),b=Ct(z-(L-1),0,X);Zs(t,U,b,e,n,i);return}const a=o.reduce((N,D)=>Math.min(N,D.position),Number.POSITIVE_INFINITY),l=o.reduce((N,D)=>Math.max(N,D.position+D.duration),Number.NEGATIVE_INFINITY),c=Math.max(l-a,0),h=Math.max(c,rh),d=r/h,g=Math.max(0,t.grid.maxLength-h),f=Math.max(h-c,0),p=a-f/2,v=Ct(p,0,g);js(t,d,v,e,n,i);const S=o.reduce((N,D)=>Math.max(N,D.pitch),Number.NEGATIVE_INFINITY),C=o.reduce((N,D)=>Math.min(N,D.pitch),Number.POSITIVE_INFINITY),m=127-S,u=127-C,_=Math.max(u-m+1,1),y=Math.max(_,sh),k=s/y,I=Math.max(y-_,0),w=m-I/2,x=Math.max(0,Zt-y),T=Ct(w,0,x);Zs(t,k,T,e,n,i)};class B2{constructor(e){this.options=e}dragState=null;getThumbMetrics=()=>{const e=this.options.state.grid.maxLength;if(e<=0)return{start:0,size:1};const n=this.options.state.grid.quarterNoteWidth,i=xn(this.options.state,this.options.getFallbackWidth());if(n<=0||i<=0)return{start:0,size:1};const r=this.options.state.viewport.scrollX/n,s=i/n,o=Math.min(1,s/e);if(o>=1)return{start:0,size:1};const a=r/e;return{start:Ct(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:e,size:n}=this.getThumbMetrics(),i=Ct(n,0,1),r=Math.min(1,Math.max(i,.01));return{left:`${Ct(e,0,1-r)*100}%`,width:`${r*100}%`}};startDrag=(e,n)=>{if(!this.options.isInteractive())return;const i=this.options.horizontalTrack.value;if(!i)return;this.stopDrag();const r=i.getBoundingClientRect();if(r.width<=0)return;const{startQuarter:s,endQuarter:o}=this.options.getViewportRange(),a=Math.max(Sn,o-s),l=xn(this.options.state,this.options.getFallbackWidth()),c=this.options.state.grid.maxLength;if(l<=0||c<=0)return;const h=s/c,d=o/c;let g=0;e==="resize-start"?g=n.clientX-(r.left+h*r.width):e==="resize-end"&&(g=n.clientX-(r.left+d*r.width)),this.dragState={mode:e,pointerId:n.pointerId,pointerStart:n.clientX,trackRect:r,startQuarter:s,endQuarter:o,anchorQuarter:e==="resize-start"?o:s,spanQuarter:a,stageWidth:l,pointerOffset:g},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),n.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=e=>{const n=this.dragState;if(!n||e.pointerId!==n.pointerId)return;const i=this.options.state.grid.maxLength,r=n.trackRect;if(i<=0||r.width<=0||n.stageWidth<=0)return;if(e.preventDefault(),n.mode==="move"){const c=(e.clientX-n.pointerStart)/r.width*i,h=Math.max(0,i-n.spanQuarter),d=Ct(n.startQuarter+c,0,h);this.options.state.viewport.scrollX=d*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const s=Ct(e.clientX,r.left,r.right),a=(Ct(s-n.pointerOffset,r.left,r.right)-r.left)/r.width;if(n.mode==="resize-start"){let l=a*i;const c=n.anchorQuarter-Sn;l=Ct(l,0,Math.max(0,c));const h=Math.max(Sn,n.anchorQuarter-l),d=n.stageWidth/h;this.options.applyHorizontalZoom(d,l),n.startQuarter=l,n.spanQuarter=h;return}if(n.mode==="resize-end"){let l=a*i;const c=n.anchorQuarter+Sn;l=Ct(l,Math.min(c,i),i);const h=Math.max(Sn,l-n.anchorQuarter),d=n.stageWidth/h;this.options.applyHorizontalZoom(d,n.anchorQuarter),n.endQuarter=l,n.spanQuarter=h}};onTrackPointerDown=e=>{if(!this.options.isInteractive())return;const n=this.options.horizontalTrack.value;if(!n)return;const i=n.getBoundingClientRect();if(i.width<=0)return;const r=Ct((e.clientX-i.left)/i.width,0,1),{startQuarter:s,endQuarter:o}=this.options.getViewportRange(),a=Math.max(Sn,o-s),l=this.options.state.grid.maxLength,c=Math.max(0,l-a),h=Ct(r*l-a/2,0,c);this.options.state.viewport.scrollX=h*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}class $2{constructor(e){this.options=e}dragState=null;getThumbMetrics=()=>{const e=Zt,n=this.options.state.grid.noteHeight,i=Cn(this.options.state,this.options.getFallbackHeight());if(n<=0||i<=0)return{start:0,size:1};const r=this.options.state.viewport.scrollY/n,s=i/n,o=Math.min(1,s/e);if(o>=1)return{start:0,size:1};const a=r/e;return{start:Ct(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:e,size:n}=this.getThumbMetrics(),i=Ct(n,0,1),r=Math.min(1,Math.max(i,.01));return{top:`${Ct(e,0,1-r)*100}%`,height:`${r*100}%`}};startDrag=(e,n)=>{if(!this.options.isInteractive())return;const i=this.options.verticalTrack.value;if(!i)return;this.stopDrag();const r=i.getBoundingClientRect();if(r.height<=0)return;const{topIndex:s,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(wn,o-s),l=Cn(this.options.state,this.options.getFallbackHeight());if(l<=0)return;const c=s/Zt,h=o/Zt;let d=0;e==="resize-start"?d=n.clientY-(r.top+c*r.height):e==="resize-end"&&(d=n.clientY-(r.top+h*r.height)),this.dragState={mode:e,pointerId:n.pointerId,pointerStart:n.clientY,trackRect:r,topIndex:s,bottomIndex:o,anchorIndex:e==="resize-start"?o:s,span:a,stageHeight:l,pointerOffset:d},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),n.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=e=>{const n=this.dragState;if(!n||e.pointerId!==n.pointerId)return;const i=n.trackRect;if(i.height<=0||n.stageHeight<=0)return;if(e.preventDefault(),n.mode==="move"){const l=(e.clientY-n.pointerStart)/i.height*Zt,c=Math.max(0,Zt-n.span),h=Ct(n.topIndex+l,0,c);this.options.state.viewport.scrollY=h*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const r=Ct(e.clientY,i.top,i.bottom),o=(Ct(r-n.pointerOffset,i.top,i.bottom)-i.top)/i.height;if(n.mode==="resize-start"){let a=o*Zt;const l=n.anchorIndex-wn;a=Ct(a,0,Math.max(0,l));const c=Math.max(wn,n.anchorIndex-a),h=n.stageHeight/c;this.options.applyVerticalZoom(h,a),n.topIndex=a,n.span=c;return}if(n.mode==="resize-end"){let a=o*Zt;const l=n.anchorIndex+wn;a=Ct(a,Math.min(l,Zt),Zt);const c=Math.max(wn,a-n.anchorIndex),h=n.stageHeight/c;this.options.applyVerticalZoom(h,n.anchorIndex),n.bottomIndex=a,n.span=c}};onTrackPointerDown=e=>{if(!this.options.isInteractive())return;const n=this.options.verticalTrack.value;if(!n)return;const i=n.getBoundingClientRect();if(i.height<=0)return;const r=Ct((e.clientY-i.top)/i.height,0,1),{topIndex:s,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(wn,o-s),l=Math.max(0,Zt-a),c=Ct(r*Zt-a/2,0,l);this.options.state.viewport.scrollY=c*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}const V2=({state:t,canUndo:e,canRedo:n,emitStateUpdate:i})=>{const r=()=>{e.value=t.command.stack?.canUndo()??!1,n.value=t.command.stack?.canRedo()??!1};return{undo:()=>{t.command.stack?.undo(),r()},redo:()=>{t.command.stack?.redo(),r()},deleteSelected:()=>{t.selection.selectedIds.size!==0&&(t.command.stack?.executeCommand("Delete Selected",()=>{t.selection.selectedIds.forEach(c=>t.notes.delete(c)),t.selection.selectedIds.clear(),t.needsRedraw=!0}),r())},updateCommandStackButtons:r,handleCommandStackUpdate:()=>{r(),i()}}},H2=({state:t,isInteractive:e,undo:n,redo:i,deleteSelected:r,updateCommandStackButtons:s,executeOverlapChanges:o})=>{let a=!1;const l=d=>{if(e()){if((d.metaKey||d.ctrlKey)&&d.key==="z"&&!d.shiftKey){d.preventDefault(),n();return}if((d.metaKey||d.ctrlKey)&&d.key==="z"&&d.shiftKey){d.preventDefault(),i();return}if(d.key==="Backspace"||d.key==="Delete"){d.preventDefault(),r();return}if(d.key.startsWith("Arrow")&&t.selection.selectedIds.size>0){d.preventDefault(),t.command.stack?.executeCommand("Move Selection",()=>{t.selection.selectedIds.forEach(g=>{const f=t.notes.get(g);if(f)switch(d.key){case"ArrowUp":f.pitch=Math.min(127,f.pitch+1);break;case"ArrowDown":f.pitch=Math.max(0,f.pitch-1);break;case"ArrowLeft":f.position=Math.max(0,f.position-.25);break;case"ArrowRight":f.position+=.25;break}}),o(t,t.selection.selectedIds),t.needsRedraw=!0}),s();return}if((d.metaKey||d.ctrlKey)&&d.key==="c"&&t.selection.selectedIds.size>0){d.preventDefault();const g=Array.from(t.selection.selectedIds).map(p=>{const v=t.notes.get(p);return v?{...v}:null}).filter(p=>p!==null);if(g.length===0)return;const f=Math.min(...g.map(p=>p.position));sessionStorage.setItem("copiedPianoRollNotes",JSON.stringify({notes:g.map(p=>({...p,position:p.position-f}))}));return}if((d.metaKey||d.ctrlKey)&&d.key==="v"){d.preventDefault();const g=sessionStorage.getItem("copiedPianoRollNotes");if(!g)return;try{const{notes:f}=JSON.parse(g);t.command.stack?.executeCommand("Paste Notes",()=>{t.selection.selectedIds.clear(),f.forEach(p=>{const v={...p,id:`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,position:t.queuePlayhead.position+p.position};t.notes.set(v.id,v),t.selection.selectedIds.add(v.id)}),o(t,t.selection.selectedIds),t.needsRedraw=!0}),s()}catch(f){console.error("Failed to paste notes",f)}}}};return{attach:()=>{a||(window.addEventListener("keydown",l),a=!0)},detach:()=>{a&&(window.removeEventListener("keydown",l),a=!1)},isAttached:()=>a}};class W2{constructor(e){this.deps=e}eventHandlersInitialized=!1;keyboardAttached=!1;renderFrame=()=>{this.deps.state.needsRedraw&&(this.deps.renderGrid(this.deps.state),this.deps.renderVisibleNotes(this.deps.state),this.deps.renderResizeHandles(this.deps.state),this.deps.updateQueuePlayheadPosition(this.deps.state),this.deps.updateLivePlayheadPosition(this.deps.state),this.deps.state.needsRedraw=!1),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)};startRenderLoop(){this.stopRenderLoop(),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)}stopRenderLoop(){this.deps.state.rafHandle&&(cancelAnimationFrame(this.deps.state.rafHandle),this.deps.state.rafHandle=void 0)}enableInteractivity(){this.deps.state.stage&&(this.eventHandlersInitialized||(this.deps.setupEventHandlers(this.deps.state,this.deps.state.stage),this.eventHandlersInitialized=!0),this.deps.state.stage.listening(!0),this.keyboardAttached||(this.deps.attachKeyboard(),this.keyboardAttached=!0))}disableInteractivity(){this.deps.state.stage&&(this.deps.state.stage.listening(!1),this.deps.state.interaction.isDragging=!1,this.deps.state.interaction.isResizing=!1,this.deps.state.interaction.isMarqueeSelecting=!1,this.deps.state.selection.selectionRect?.visible(!1),this.keyboardAttached&&(this.deps.detachKeyboard(),this.keyboardAttached=!1),this.deps.state.layers.overlay?.batchDraw(),this.deps.syncUiCounters())}mount({width:e,height:n,interactive:i,initialNotes:r}){if(!this.deps.konvaContainer.value){console.error("Konva container ref not found");return}const s=new Bt.Stage({container:this.deps.konvaContainer.value,width:e,height:n});this.deps.state.stage=s,this.deps.state.konvaContainer=this.deps.konvaContainer.value,this.deps.initializeLayers(this.deps.state,s,this.deps.handleCommandStackUpdate),i?this.enableInteractivity():this.disableInteractivity(),r.length>0&&(this.deps.state.notes=new Map(r),this.deps.state.needsRedraw=!0,this.deps.syncUiCounters()),this.startRenderLoop(),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds(),this.deps.handleCommandStackUpdate()}unmount(){this.stopRenderLoop(),this.disableInteractivity(),this.deps.state.stage?.destroy(),this.deps.state.stage=void 0,this.deps.state.konvaContainer=void 0,this.eventHandlersInitialized=!1}setInteractive(e){this.deps.state.stage&&(e?this.enableInteractivity():this.disableInteractivity())}resize(e,n){this.deps.state.stage&&(this.deps.state.stage.width(e),this.deps.state.stage.height(n),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds())}}const j2={key:0,class:"metadata-editor"},Z2={class:"header"},q2={key:0,class:"unsaved-indicator"},K2={key:0},Y2={class:"buttons"},X2=["disabled"],Q2=["disabled"],J2={key:1,class:"warning"},tm=Jr({__name:"NoteMetadataEditor",props:{metadata:{type:null},visible:{type:Boolean},canEdit:{type:Boolean}},emits:["apply","cancel"],setup(t,{emit:e}){const n=t,i=e,r=Jt(""),s=Jt(""),o=se(()=>r.value!==s.value);Ce(()=>[n.metadata,n.canEdit],([c,h])=>{if(h){const d=JSON.stringify(c??{},null,2);r.value=d,s.value=d}else r.value="",s.value=""},{immediate:!0,deep:!0});const a=()=>{try{const c=JSON.parse(r.value||"{}");i("apply",c),s.value=r.value}catch{alert("Invalid JSON format")}},l=()=>{r.value=s.value,i("cancel")};return(c,h)=>c.visible?(Fe(),Ye("div",j2,[pt("div",Z2,[o.value?(Fe(),Ye("div",q2,h[1]||(h[1]=[pt("span",{class:"dot"},null,-1),hs(" Unsaved changes ")]))):sr("",!0)]),c.canEdit?(Fe(),Ye("div",K2,[h[2]||(h[2]=pt("p",{class:"help"},"Edit the selected note metadata as JSON:",-1)),Go(pt("textarea",{"onUpdate:modelValue":h[0]||(h[0]=d=>r.value=d),class:"textarea",placeholder:"{}"},null,512),[[zd,r.value]]),pt("div",Y2,[pt("button",{onClick:a,class:"btn save",disabled:!o.value}," Save ",8,X2),pt("button",{onClick:l,class:"btn cancel",disabled:!o.value}," Cancel ",8,Q2)])])):(Fe(),Ye("div",J2,h[3]||(h[3]=[pt("p",null,"Select exactly one note to edit its metadata.",-1)])))])):sr("",!0)}}),em=".metadata-editor[data-v-18cfcf98]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:6px 16px;margin-top:8px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-18cfcf98]{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}.unsaved-indicator[data-v-18cfcf98]{display:flex;align-items:center;gap:6px;font-size:13px;color:#f39c12;font-weight:500}.dot[data-v-18cfcf98]{width:6px;height:6px;background:#f39c12;border-radius:50%;animation:pulse-18cfcf98 1.5s infinite}@keyframes pulse-18cfcf98{0%,to{opacity:1}50%{opacity:.5}}.help[data-v-18cfcf98]{margin:0 0 4px;color:#666;font-size:14px}.textarea[data-v-18cfcf98]{width:100%;min-height:120px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:14px;line-height:1.3;resize:vertical;margin-bottom:4px}.textarea[data-v-18cfcf98]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 2px #0066ff26}.buttons[data-v-18cfcf98]{display:flex;gap:8px}.btn[data-v-18cfcf98]{padding:4px 12px;border:1px solid;border-radius:4px;cursor:pointer;font-size:14px;transition:all .2s}.btn[data-v-18cfcf98]:disabled{opacity:.5;cursor:not-allowed}.save[data-v-18cfcf98]{background:#28a745;color:#fff;border-color:#28a745}.save[data-v-18cfcf98]:hover:not(:disabled){background:#218838}.cancel[data-v-18cfcf98]{background:#6c757d;color:#fff;border-color:#6c757d}.cancel[data-v-18cfcf98]:hover:not(:disabled){background:#5a6268}.warning[data-v-18cfcf98]{text-align:center;color:#e67e22;padding:8px}",oh=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},nm=oh(tm,[["styles",[em]],["__scopeId","data-v-18cfcf98"]]),im={class:"piano-roll-root"},rm={key:0,class:"control-panel"},sm=["disabled"],om=["disabled"],am=["disabled"],lm=["disabled"],cm={class:"info"},hm={class:"piano-roll-layout"},um={class:"stage-wrapper"},dm={key:1,class:"metadata-editor-wrapper"},fm=oh(Jr({__name:"PianoRollRoot",props:{width:{default:640,type:Number},height:{default:360,type:Number},initialNotes:{default:()=>[],type:Array},syncState:{type:Function},showControlPanel:{type:Boolean,default:!0},interactive:{type:Boolean,default:!0},wsAddress:{type:String}},emits:["notes-update"],setup(t,{expose:e,emit:n}){const i=t,r=an({width:void 0,height:void 0,interactive:void 0,showControlPanel:void 0}),s=se(()=>r.width??i.width),o=se(()=>r.height??i.height),a=se(()=>r.interactive??i.interactive),l=se(()=>r.showControlPanel??i.showControlPanel),c=qh(null),h=n,d=Of();d.viewport=an(d.viewport),d.grid=an(d.grid);const g=Jt(),f=Jt(),p=Jt(),v=Jt(!1),S=Jt(!1),C=Jt(d.grid.subdivision),m=Jt(!1),u=Jt(null),_=Jt(null),y=Jt(d.notes.size),k=Jt(d.selection.selectedIds.size),I=se(()=>a.value),w=se(()=>l.value),x=se(()=>u.value!==null&&I.value),T=se(()=>w.value&&m.value),N=Z=>{if(Z==null)return{};try{return JSON.parse(JSON.stringify(Z))}catch{return Z}},D=()=>{if(y.value=d.notes.size,k.value=d.selection.selectedIds.size,d.selection.selectedIds.size===1){const[Z]=Array.from(d.selection.selectedIds),W=d.notes.get(Z);u.value=W?.id??null,_.value=W?N(W.metadata):{}}else u.value=null,_.value=null},L=()=>{i.syncState?.(d)},U=()=>{U2(d,s.value,o.value,L)},z=()=>{Ws(d,s.value,o.value,L)},X=(Z,W)=>{js(d,Z,W,s.value,o.value,L)},b=(Z,W)=>{Zs(d,Z,W,s.value,o.value,L)},P=()=>L2(d,s.value),M=()=>G2(d,o.value),R=new B2({state:d,horizontalTrack:f,isInteractive:()=>a.value,getViewportRange:P,applyHorizontalZoom:X,enforceScrollBounds:z,notifyViewportChange:L,getFallbackWidth:()=>s.value}),F=new $2({state:d,verticalTrack:p,isInteractive:()=>a.value,getViewportRange:M,applyVerticalZoom:b,enforceScrollBounds:z,notifyViewportChange:L,getFallbackHeight:()=>o.value}),H=se(()=>R.getThumbStyle()),G=se(()=>F.getThumbStyle()),Q=(Z,W)=>{R.startDrag(Z,W)},st=()=>{R.stopDrag()},V=(Z,W)=>{F.startDrag(Z,W)},A=()=>{F.stopDrag()},$=Z=>{R.onTrackPointerDown(Z)},it=Z=>{F.onTrackPointerDown(Z)};Ce(C,Z=>{d.grid.subdivision=Z,d.needsRedraw=!0,i.syncState?.(d)});const ot=(Z={})=>{const W=Z.source??"notes";D();const nt=Array.from(d.notes.entries());h("notes-update",nt),i.syncState?.(d),c.value?.isConnected&&(!Z.suppressWsNotes&&W==="notes"&&c.value.sendNotesUpdate(nt,W),c.value.sendStateUpdate(d,W))};Ce(w,Z=>{Z||(m.value=!1)});const lt=Z=>{if(!u.value)return;const W=u.value,nt=d.notes.get(W);if(!nt)return;const at=Z??{},ht=nt.metadata??{};JSON.stringify(ht)!==JSON.stringify(at)&&d.command.stack?.executeCommand("Edit Note Metadata",()=>{const gt=d.notes.get(W);if(!gt)return;const dt=at&&Object.keys(at).length===0?void 0:at,Pt={...gt,metadata:dt};dt||delete Pt.metadata,d.notes.set(W,Pt),d.needsRedraw=!0})};d.notifyExternalChange=Z=>{ot({source:Z??"other"})};const{undo:E,redo:O,deleteSelected:B,updateCommandStackButtons:j,handleCommandStackUpdate:Y}=V2({state:d,canUndo:v,canRedo:S,emitStateUpdate:ot}),q=H2({state:d,isInteractive:()=>a.value,undo:E,redo:O,deleteSelected:B,updateCommandStackButtons:j,executeOverlapChanges:Vs}),J=new W2({state:d,konvaContainer:g,initializeLayers:b2,setupEventHandlers:T2,renderGrid:y2,renderVisibleNotes:S2,renderResizeHandles:w2,updateQueuePlayheadPosition:C2,updateLivePlayheadPosition:P2,handleCommandStackUpdate:Y,syncUiCounters:D,enforceScrollBounds:z,attachKeyboard:()=>q.attach(),detachKeyboard:()=>q.detach()});Vo(()=>{J.mount({width:s.value,height:o.value,interactive:a.value,initialNotes:i.initialNotes??[]}),i.wsAddress&&(c.value=new h2(i.wsAddress),c.value.setHandlers({onSetNotes:Z=>rt(Z,{suppressWsNotes:!0}),onSetLivePlayhead:Z=>et(Z),onFitZoomToNotes:()=>U(),onGetPlayStartPosition:Z=>{const W=tt();c.value?.sendPlayStartPositionResponse(W,Z)},onSetConfig:Z=>{Z.width!==void 0&&(r.width=Z.width),Z.height!==void 0&&(r.height=Z.height),Z.interactive!==void 0&&(r.interactive=Z.interactive),Z.showControlPanel!==void 0&&(r.showControlPanel=Z.showControlPanel)}}),c.value.connect())}),es(()=>{st(),A(),J.unmount(),c.value?.disconnect()}),Ce(a,Z=>{J.setInteractive(Z),Z||(st(),A())}),Ce(s,Z=>{J.resize(Z,o.value)}),Ce(o,Z=>{J.resize(s.value,Z)});const rt=(Z,W={})=>{const nt=new Set;d.notes.clear(),Z.forEach((at,ht)=>{let gt=at.id||`note_${Date.now()}_${ht}`;for(;nt.has(gt);)gt=`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;nt.add(gt);const dt={...at,id:gt,velocity:at.velocity??100};d.notes.set(gt,dt)}),d.needsRedraw=!0,ot({...W,source:"notes"})},et=Z=>{d.livePlayhead.position=Math.max(0,Math.min(Z,d.grid.maxLength)),d.needsRedraw=!0},tt=()=>d.queuePlayhead.position;return e({setNotes:rt,setLivePlayheadPosition:et,getPlayStartPosition:tt,fitZoomToNotes:U}),(Z,W)=>(Fe(),Ye("div",im,[w.value?(Fe(),Ye("div",rm,[pt("button",{onClick:W[0]||(W[0]=(...nt)=>Ie(E)&&Ie(E)(...nt)),disabled:!I.value||!v.value}," Undo",8,sm),pt("button",{onClick:W[1]||(W[1]=(...nt)=>Ie(O)&&Ie(O)(...nt)),disabled:!I.value||!S.value}," Redo",8,om),W[13]||(W[13]=pt("span",{class:"separator"},"|",-1)),pt("label",null,[W[12]||(W[12]=hs(" Grid: ")),Go(pt("select",{"onUpdate:modelValue":W[2]||(W[2]=nt=>C.value=nt),disabled:!I.value},W[11]||(W[11]=[pt("option",{value:4},"Quarter",-1),pt("option",{value:8},"Eighth",-1),pt("option",{value:16},"16th",-1),pt("option",{value:32},"32nd",-1)]),8,am),[[Ld,C.value,void 0,{number:!0}]])]),W[14]||(W[14]=pt("span",{class:"separator"},"|",-1)),pt("button",{onClick:W[3]||(W[3]=(...nt)=>Ie(B)&&Ie(B)(...nt)),disabled:!I.value||k.value===0},"  Delete ",8,lm),W[15]||(W[15]=pt("span",{class:"separator"},"|",-1)),pt("button",{class:Ve(["metadata-toggle",{active:m.value}]),onClick:W[4]||(W[4]=nt=>m.value=!m.value)},"  Metadata ",2),W[16]||(W[16]=pt("span",{class:"separator"},"|",-1)),pt("span",cm,Ir(y.value)+" notes, "+Ir(k.value)+" selected",1)])):sr("",!0),pt("div",hm,[pt("div",um,[pt("div",{ref_key:"konvaContainer",ref:g,class:Ve(["piano-roll-container",{"is-disabled":!I.value}]),style:Ne({width:s.value+"px",height:o.value+"px"})},null,6),pt("div",{ref_key:"horizontalTrack",ref:f,class:Ve(["scrollbar horizontal",{"is-disabled":!I.value}]),style:Ne({width:s.value+"px"}),onPointerdown:ze($,["self"])},[pt("div",{class:"scrollbar-thumb horizontal-thumb",style:Ne(H.value)},[pt("div",{class:"scrollbar-handle handle-left",onPointerdown:W[5]||(W[5]=ze(nt=>Q("resize-start",nt),["stop","prevent"]))},null,32),pt("div",{class:"scrollbar-body",onPointerdown:W[6]||(W[6]=ze(nt=>Q("move",nt),["stop","prevent"]))},null,32),pt("div",{class:"scrollbar-handle handle-right",onPointerdown:W[7]||(W[7]=ze(nt=>Q("resize-end",nt),["stop","prevent"]))},null,32)],4)],38)]),pt("div",{ref_key:"verticalTrack",ref:p,class:Ve(["scrollbar vertical",{"is-disabled":!I.value}]),style:Ne({height:o.value+"px"}),onPointerdown:ze(it,["self"])},[pt("div",{class:"scrollbar-thumb vertical-thumb",style:Ne(G.value)},[pt("div",{class:"scrollbar-handle handle-top",onPointerdown:W[8]||(W[8]=ze(nt=>V("resize-start",nt),["stop","prevent"]))},null,32),pt("div",{class:"scrollbar-body vertical-body",onPointerdown:W[9]||(W[9]=ze(nt=>V("move",nt),["stop","prevent"]))},null,32),pt("div",{class:"scrollbar-handle handle-bottom",onPointerdown:W[10]||(W[10]=ze(nt=>V("resize-end",nt),["stop","prevent"]))},null,32)],4)],38)]),w.value?(Fe(),Ye("div",dm,[ue(nm,{visible:T.value,metadata:_.value??void 0,"can-edit":x.value,onApply:lt},null,8,["visible","metadata","can-edit"])])):sr("",!0)]))}}),[["styles",[".piano-roll-root[data-v-db274b90]{display:flex;flex-direction:column;align-items:center;gap:20px;padding:20px}.control-panel[data-v-db274b90]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:10px 15px;display:flex;align-items:center;gap:10px;box-shadow:0 2px 10px #0000001a}.control-panel button[data-v-db274b90]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 15px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-db274b90]:hover:not(:disabled){background:#e0e0e0}.control-panel button[data-v-db274b90]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-db274b90]{color:#ccc}.metadata-toggle[data-v-db274b90]{display:flex;align-items:center;gap:6px}.metadata-toggle.active[data-v-db274b90]{background:#d6eaff;border-color:#6aa8ff;color:#0b5394}.info[data-v-db274b90]{color:#666;font-size:14px}.piano-roll-container[data-v-db274b90]{background-color:#fff;border:1px solid black;cursor:default;box-sizing:border-box;border-radius:8px}.piano-roll-container.is-disabled[data-v-db274b90]{pointer-events:none;cursor:not-allowed}.piano-roll-layout[data-v-db274b90]{display:flex;align-items:flex-start;gap:12px}.stage-wrapper[data-v-db274b90]{display:flex;flex-direction:column;gap:12px;align-items:stretch}.scrollbar[data-v-db274b90]{position:relative;background:#f5f5f5;border:1px solid #ccc;border-radius:10px;box-sizing:border-box;user-select:none;touch-action:none}.scrollbar.horizontal[data-v-db274b90]{height:24px}.scrollbar.vertical[data-v-db274b90]{width:24px}.scrollbar.is-disabled[data-v-db274b90]{opacity:.45;pointer-events:none}.scrollbar-thumb[data-v-db274b90]{position:absolute;background:#0000002e;border-radius:6px;display:flex;align-items:center;justify-content:space-between;min-width:16px;min-height:16px;cursor:grab;transition:background .15s ease;box-sizing:border-box}.scrollbar-thumb.horizontal-thumb[data-v-db274b90]{top:0;height:100%;align-items:stretch}.scrollbar-thumb.vertical-thumb[data-v-db274b90]{left:0;width:100%;flex-direction:column;justify-content:space-between;align-items:stretch}.scrollbar-thumb[data-v-db274b90]:hover{background:#00000040}.scrollbar-body[data-v-db274b90]{flex:1;height:100%;cursor:grab}.scrollbar-body.vertical-body[data-v-db274b90]{width:100%}.scrollbar-handle[data-v-db274b90]{background:#00000059;border-radius:4px;flex:0 0 auto}.handle-left[data-v-db274b90],.handle-right[data-v-db274b90]{width:8px;height:100%;cursor:ew-resize}.handle-top[data-v-db274b90],.handle-bottom[data-v-db274b90]{width:100%;height:8px;cursor:ns-resize}label[data-v-db274b90]{display:flex;align-items:center;gap:5px;font-size:14px}select[data-v-db274b90]{padding:3px 8px;border:1px solid #ccc;border-radius:4px;font-size:14px;cursor:pointer}.metadata-editor-wrapper[data-v-db274b90]{width:100%;display:flex;justify-content:center}"]],["__scopeId","data-v-db274b90"]]),ah="piano-roll-component",lh=Od(fm);return customElements.get(ah)||customElements.define(ah,lh),kr.PianoRollElement=lh,Object.defineProperty(kr,Symbol.toStringTag,{value:"Module"}),kr}({});
