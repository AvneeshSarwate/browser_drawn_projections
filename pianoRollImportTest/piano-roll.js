var PianoRollComponent=function(nn){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Gn(t){const e=Object.create(null);for(const i of t.split(","))e[i]=1;return i=>i in e}const vt={},Ie=[],Jt=()=>{},fl=()=>!1,rn=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Un=t=>t.startsWith("onUpdate:"),At=Object.assign,Bn=(t,e)=>{const i=t.indexOf(e);i>-1&&t.splice(i,1)},gl=Object.prototype.hasOwnProperty,_t=(t,e)=>gl.call(t,e),ct=Array.isArray,Oe=t=>Xe(t)==="[object Map]",sn=t=>Xe(t)==="[object Set]",jr=t=>Xe(t)==="[object Date]",ht=t=>typeof t=="function",Rt=t=>typeof t=="string",Zt=t=>typeof t=="symbol",xt=t=>t!==null&&typeof t=="object",Yr=t=>(xt(t)||ht(t))&&ht(t.then)&&ht(t.catch),Xr=Object.prototype.toString,Xe=t=>Xr.call(t),pl=t=>Xe(t).slice(8,-1),on=t=>Xe(t)==="[object Object]",Hn=t=>Rt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,$e=Gn(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),an=t=>{const e=Object.create(null);return i=>e[i]||(e[i]=t(i))},ml=/-(\w)/g,Xt=an(t=>t.replace(ml,(e,i)=>i?i.toUpperCase():"")),_l=/\B([A-Z])/g,Kt=an(t=>t.replace(_l,"-$1").toLowerCase()),$r=an(t=>t.charAt(0).toUpperCase()+t.slice(1)),Vn=an(t=>t?`on${$r(t)}`:""),pe=(t,e)=>!Object.is(t,e),ln=(t,...e)=>{for(let i=0;i<t.length;i++)t[i](...e)},Qr=(t,e,i,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:i})},Jr=t=>{const e=parseFloat(t);return isNaN(e)?t:e},Zr=t=>{const e=Rt(t)?Number(t):NaN;return isNaN(e)?t:e};let ts;const es=()=>ts||(ts=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function me(t){if(ct(t)){const e={};for(let i=0;i<t.length;i++){const n=t[i],s=Rt(n)?Sl(n):me(n);if(s)for(const r in s)e[r]=s[r]}return e}else if(Rt(t)||xt(t))return t}const yl=/;(?![^(]*\))/g,bl=/:([^]+)/,vl=/\/\*[^]*?\*\//g;function Sl(t){const e={};return t.replace(vl,"").split(yl).forEach(i=>{if(i){const n=i.split(bl);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function De(t){let e="";if(Rt(t))e=t;else if(ct(t))for(let i=0;i<t.length;i++){const n=De(t[i]);n&&(e+=n+" ")}else if(xt(t))for(const i in t)t[i]&&(e+=i+" ");return e.trim()}const wl=Gn("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function is(t){return!!t||t===""}function Cl(t,e){if(t.length!==e.length)return!1;let i=!0;for(let n=0;i&&n<t.length;n++)i=cn(t[n],e[n]);return i}function cn(t,e){if(t===e)return!0;let i=jr(t),n=jr(e);if(i||n)return i&&n?t.getTime()===e.getTime():!1;if(i=Zt(t),n=Zt(e),i||n)return t===e;if(i=ct(t),n=ct(e),i||n)return i&&n?Cl(t,e):!1;if(i=xt(t),n=xt(e),i||n){if(!i||!n)return!1;const s=Object.keys(t).length,r=Object.keys(e).length;if(s!==r)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!cn(t[o],e[o]))return!1}}return String(t)===String(e)}function xl(t,e){return t.findIndex(i=>cn(i,e))}const ns=t=>!!(t&&t.__v_isRef===!0),zn=t=>Rt(t)?t:t==null?"":ct(t)||xt(t)&&(t.toString===Xr||!ht(t.toString))?ns(t)?zn(t.value):JSON.stringify(t,rs,2):String(t),rs=(t,e)=>ns(e)?rs(t,e.value):Oe(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((i,[n,s],r)=>(i[qn(n,r)+" =>"]=s,i),{})}:sn(e)?{[`Set(${e.size})`]:[...e.values()].map(i=>qn(i))}:Zt(e)?qn(e):xt(e)&&!ct(e)&&!on(e)?String(e):e,qn=(t,e="")=>{var i;return Zt(t)?`Symbol(${(i=t.description)!=null?i:e})`:t};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let zt;class Pl{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=zt,!e&&zt&&(this.index=(zt.scopes||(zt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].pause();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].resume();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].resume()}}run(e){if(this._active){const i=zt;try{return zt=this,e()}finally{zt=i}}}on(){zt=this}off(){zt=this.parent}stop(e){if(this._active){let i,n;for(i=0,n=this.effects.length;i<n;i++)this.effects[i].stop();for(i=0,n=this.cleanups.length;i<n;i++)this.cleanups[i]();if(this.scopes)for(i=0,n=this.scopes.length;i<n;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function Tl(){return zt}let wt;const Wn=new WeakSet;class ss{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,zt&&zt.active&&zt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Wn.has(this)&&(Wn.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||as(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,us(this),ls(this);const e=wt,i=$t;wt=this,$t=!0;try{return this.fn()}finally{cs(this),wt=e,$t=i,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Xn(e);this.deps=this.depsTail=void 0,us(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Wn.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Yn(this)&&this.run()}get dirty(){return Yn(this)}}let os=0,Qe,Je;function as(t,e=!1){if(t.flags|=8,e){t.next=Je,Je=t;return}t.next=Qe,Qe=t}function Kn(){os++}function jn(){if(--os>0)return;if(Je){let e=Je;for(Je=void 0;e;){const i=e.next;e.next=void 0,e.flags&=-9,e=i}}let t;for(;Qe;){let e=Qe;for(Qe=void 0;e;){const i=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=i}}if(t)throw t}function ls(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function cs(t){let e,i=t.depsTail,n=i;for(;n;){const s=n.prevDep;n.version===-1?(n===i&&(i=s),Xn(n),Rl(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}t.deps=e,t.depsTail=i}function Yn(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(hs(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function hs(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Ze))return;t.globalVersion=Ze;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!Yn(t)){t.flags&=-3;return}const i=wt,n=$t;wt=t,$t=!0;try{ls(t);const s=t.fn(t._value);(e.version===0||pe(s,t._value))&&(t._value=s,e.version++)}catch(s){throw e.version++,s}finally{wt=i,$t=n,cs(t),t.flags&=-3}}function Xn(t,e=!1){const{dep:i,prevSub:n,nextSub:s}=t;if(n&&(n.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=n,t.nextSub=void 0),i.subs===t&&(i.subs=n),!i.subs&&i.computed){i.computed.flags&=-5;for(let r=i.computed.deps;r;r=r.nextDep)Xn(r,!0)}!e&&!--i.sc&&i.map&&i.map.delete(i.key)}function Rl(t){const{prevDep:e,nextDep:i}=t;e&&(e.nextDep=i,t.prevDep=void 0),i&&(i.prevDep=e,t.nextDep=void 0)}let $t=!0;const ds=[];function se(){ds.push($t),$t=!1}function oe(){const t=ds.pop();$t=t===void 0?!0:t}function us(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const i=wt;wt=void 0;try{e()}finally{wt=i}}}let Ze=0;class El{constructor(e,i){this.sub=e,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class $n{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!wt||!$t||wt===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==wt)i=this.activeLink=new El(wt,this),wt.deps?(i.prevDep=wt.depsTail,wt.depsTail.nextDep=i,wt.depsTail=i):wt.deps=wt.depsTail=i,fs(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const n=i.nextDep;n.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=n),i.prevDep=wt.depsTail,i.nextDep=void 0,wt.depsTail.nextDep=i,wt.depsTail=i,wt.deps===i&&(wt.deps=n)}return i}trigger(e){this.version++,Ze++,this.notify(e)}notify(e){Kn();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{jn()}}}function fs(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)fs(n)}const i=t.dep.subs;i!==t&&(t.prevSub=i,i&&(i.nextSub=t)),t.dep.subs=t}}const Qn=new WeakMap,Pe=Symbol(""),Jn=Symbol(""),ti=Symbol("");function kt(t,e,i){if($t&&wt){let n=Qn.get(t);n||Qn.set(t,n=new Map);let s=n.get(i);s||(n.set(i,s=new $n),s.map=n,s.key=i),s.track()}}function ae(t,e,i,n,s,r){const o=Qn.get(t);if(!o){Ze++;return}const a=l=>{l&&l.trigger()};if(Kn(),e==="clear")o.forEach(a);else{const l=ct(t),c=l&&Hn(i);if(l&&i==="length"){const d=Number(n);o.forEach((p,g)=>{(g==="length"||g===ti||!Zt(g)&&g>=d)&&a(p)})}else switch(i!==void 0&&a(o.get(i)),c&&a(o.get(ti)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Pe)),Oe(t)&&a(o.get(Jn)));break;case"delete":l||(a(o.get(Pe)),Oe(t)&&a(o.get(Jn)));break;case"set":Oe(t)&&a(o.get(Pe));break}}jn()}function Le(t){const e=mt(t);return e===t?e:(kt(e,"iterate",ti),Qt(t)?e:e.map(Ot))}function Zn(t){return kt(t=mt(t),"iterate",ti),t}const Al={__proto__:null,[Symbol.iterator](){return tr(this,Symbol.iterator,Ot)},concat(...t){return Le(this).concat(...t.map(e=>ct(e)?Le(e):e))},entries(){return tr(this,"entries",t=>(t[1]=Ot(t[1]),t))},every(t,e){return le(this,"every",t,e,void 0,arguments)},filter(t,e){return le(this,"filter",t,e,i=>i.map(Ot),arguments)},find(t,e){return le(this,"find",t,e,Ot,arguments)},findIndex(t,e){return le(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return le(this,"findLast",t,e,Ot,arguments)},findLastIndex(t,e){return le(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return le(this,"forEach",t,e,void 0,arguments)},includes(...t){return er(this,"includes",t)},indexOf(...t){return er(this,"indexOf",t)},join(t){return Le(this).join(t)},lastIndexOf(...t){return er(this,"lastIndexOf",t)},map(t,e){return le(this,"map",t,e,void 0,arguments)},pop(){return ei(this,"pop")},push(...t){return ei(this,"push",t)},reduce(t,...e){return gs(this,"reduce",t,e)},reduceRight(t,...e){return gs(this,"reduceRight",t,e)},shift(){return ei(this,"shift")},some(t,e){return le(this,"some",t,e,void 0,arguments)},splice(...t){return ei(this,"splice",t)},toReversed(){return Le(this).toReversed()},toSorted(t){return Le(this).toSorted(t)},toSpliced(...t){return Le(this).toSpliced(...t)},unshift(...t){return ei(this,"unshift",t)},values(){return tr(this,"values",Ot)}};function tr(t,e,i){const n=Zn(t),s=n[e]();return n!==t&&!Qt(t)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.value&&(r.value=i(r.value)),r}),s}const Ml=Array.prototype;function le(t,e,i,n,s,r){const o=Zn(t),a=o!==t&&!Qt(t),l=o[e];if(l!==Ml[e]){const p=l.apply(t,r);return a?Ot(p):p}let c=i;o!==t&&(a?c=function(p,g){return i.call(this,Ot(p),g,t)}:i.length>2&&(c=function(p,g){return i.call(this,p,g,t)}));const d=l.call(o,c,n);return a&&s?s(d):d}function gs(t,e,i,n){const s=Zn(t);let r=i;return s!==t&&(Qt(t)?i.length>3&&(r=function(o,a,l){return i.call(this,o,a,l,t)}):r=function(o,a,l){return i.call(this,o,Ot(a),l,t)}),s[e](r,...n)}function er(t,e,i){const n=mt(t);kt(n,"iterate",ti);const s=n[e](...i);return(s===-1||s===!1)&&nr(i[0])?(i[0]=mt(i[0]),n[e](...i)):s}function ei(t,e,i=[]){se(),Kn();const n=mt(t)[e].apply(t,i);return jn(),oe(),n}const Nl=Gn("__proto__,__v_isRef,__isVue"),ps=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Zt));function kl(t){Zt(t)||(t=String(t));const e=mt(this);return kt(e,"has",t),e.hasOwnProperty(t)}class ms{constructor(e=!1,i=!1){this._isReadonly=e,this._isShallow=i}get(e,i,n){const s=this._isReadonly,r=this._isShallow;if(i==="__v_isReactive")return!s;if(i==="__v_isReadonly")return s;if(i==="__v_isShallow")return r;if(i==="__v_raw")return n===(s?r?Ts:Ps:r?xs:Cs).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=ct(e);if(!s){let l;if(o&&(l=Al[i]))return l;if(i==="hasOwnProperty")return kl}const a=Reflect.get(e,i,Nt(e)?e:n);return(Zt(i)?ps.has(i):Nl(i))||(s||kt(e,"get",i),r)?a:Nt(a)?o&&Hn(i)?a:a.value:xt(a)?s?Rs(a):ii(a):a}}class _s extends ms{constructor(e=!1){super(!1,e)}set(e,i,n,s){let r=e[i];if(!this._isShallow){const l=Te(r);if(!Qt(n)&&!Te(n)&&(r=mt(r),n=mt(n)),!ct(e)&&Nt(r)&&!Nt(n))return l?!1:(r.value=n,!0)}const o=ct(e)&&Hn(i)?Number(i)<e.length:_t(e,i),a=Reflect.set(e,i,n,Nt(e)?e:s);return e===mt(s)&&(o?pe(n,r)&&ae(e,"set",i,n):ae(e,"add",i,n)),a}deleteProperty(e,i){const n=_t(e,i);e[i];const s=Reflect.deleteProperty(e,i);return s&&n&&ae(e,"delete",i,void 0),s}has(e,i){const n=Reflect.has(e,i);return(!Zt(i)||!ps.has(i))&&kt(e,"has",i),n}ownKeys(e){return kt(e,"iterate",ct(e)?"length":Pe),Reflect.ownKeys(e)}}class ys extends ms{constructor(e=!1){super(!0,e)}set(e,i){return!0}deleteProperty(e,i){return!0}}const Fl=new _s,Il=new ys,Ol=new _s(!0),Dl=new ys(!0),ir=t=>t,hn=t=>Reflect.getPrototypeOf(t);function dn(t,e,i=!1,n=!1){t=t.__v_raw;const s=mt(t),r=mt(e);i||(pe(e,r)&&kt(s,"get",e),kt(s,"get",r));const{has:o}=hn(s),a=n?ir:i?rr:Ot;if(o.call(s,e))return a(t.get(e));if(o.call(s,r))return a(t.get(r));t!==s&&t.get(e)}function un(t,e=!1){const i=this.__v_raw,n=mt(i),s=mt(t);return e||(pe(t,s)&&kt(n,"has",t),kt(n,"has",s)),t===s?i.has(t):i.has(t)||i.has(s)}function fn(t,e=!1){return t=t.__v_raw,!e&&kt(mt(t),"iterate",Pe),Reflect.get(t,"size",t)}function bs(t,e=!1){!e&&!Qt(t)&&!Te(t)&&(t=mt(t));const i=mt(this);return hn(i).has.call(i,t)||(i.add(t),ae(i,"add",t,t)),this}function vs(t,e,i=!1){!i&&!Qt(e)&&!Te(e)&&(e=mt(e));const n=mt(this),{has:s,get:r}=hn(n);let o=s.call(n,t);o||(t=mt(t),o=s.call(n,t));const a=r.call(n,t);return n.set(t,e),o?pe(e,a)&&ae(n,"set",t,e):ae(n,"add",t,e),this}function Ss(t){const e=mt(this),{has:i,get:n}=hn(e);let s=i.call(e,t);s||(t=mt(t),s=i.call(e,t)),n&&n.call(e,t);const r=e.delete(t);return s&&ae(e,"delete",t,void 0),r}function ws(){const t=mt(this),e=t.size!==0,i=t.clear();return e&&ae(t,"clear",void 0,void 0),i}function gn(t,e){return function(n,s){const r=this,o=r.__v_raw,a=mt(o),l=e?ir:t?rr:Ot;return!t&&kt(a,"iterate",Pe),o.forEach((c,d)=>n.call(s,l(c),l(d),r))}}function pn(t,e,i){return function(...n){const s=this.__v_raw,r=mt(s),o=Oe(r),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=s[t](...n),d=i?ir:e?rr:Ot;return!e&&kt(r,"iterate",l?Jn:Pe),{next(){const{value:p,done:g}=c.next();return g?{value:p,done:g}:{value:a?[d(p[0]),d(p[1])]:d(p),done:g}},[Symbol.iterator](){return this}}}}function _e(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Ll(){const t={get(r){return dn(this,r)},get size(){return fn(this)},has:un,add:bs,set:vs,delete:Ss,clear:ws,forEach:gn(!1,!1)},e={get(r){return dn(this,r,!1,!0)},get size(){return fn(this)},has:un,add(r){return bs.call(this,r,!0)},set(r,o){return vs.call(this,r,o,!0)},delete:Ss,clear:ws,forEach:gn(!1,!0)},i={get(r){return dn(this,r,!0)},get size(){return fn(this,!0)},has(r){return un.call(this,r,!0)},add:_e("add"),set:_e("set"),delete:_e("delete"),clear:_e("clear"),forEach:gn(!0,!1)},n={get(r){return dn(this,r,!0,!0)},get size(){return fn(this,!0)},has(r){return un.call(this,r,!0)},add:_e("add"),set:_e("set"),delete:_e("delete"),clear:_e("clear"),forEach:gn(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=pn(r,!1,!1),i[r]=pn(r,!0,!1),e[r]=pn(r,!1,!0),n[r]=pn(r,!0,!0)}),[t,i,e,n]}const[Gl,Ul,Bl,Hl]=Ll();function mn(t,e){const i=e?t?Hl:Bl:t?Ul:Gl;return(n,s,r)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?n:Reflect.get(_t(i,s)&&s in n?i:n,s,r)}const Vl={get:mn(!1,!1)},zl={get:mn(!1,!0)},ql={get:mn(!0,!1)},Wl={get:mn(!0,!0)},Cs=new WeakMap,xs=new WeakMap,Ps=new WeakMap,Ts=new WeakMap;function Kl(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function jl(t){return t.__v_skip||!Object.isExtensible(t)?0:Kl(pl(t))}function ii(t){return Te(t)?t:_n(t,!1,Fl,Vl,Cs)}function Yl(t){return _n(t,!1,Ol,zl,xs)}function Rs(t){return _n(t,!0,Il,ql,Ps)}function Eu(t){return _n(t,!0,Dl,Wl,Ts)}function _n(t,e,i,n,s){if(!xt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=s.get(t);if(r)return r;const o=jl(t);if(o===0)return t;const a=new Proxy(t,o===2?n:i);return s.set(t,a),a}function ni(t){return Te(t)?ni(t.__v_raw):!!(t&&t.__v_isReactive)}function Te(t){return!!(t&&t.__v_isReadonly)}function Qt(t){return!!(t&&t.__v_isShallow)}function nr(t){return t?!!t.__v_raw:!1}function mt(t){const e=t&&t.__v_raw;return e?mt(e):t}function Xl(t){return!_t(t,"__v_skip")&&Object.isExtensible(t)&&Qr(t,"__v_skip",!0),t}const Ot=t=>xt(t)?ii(t):t,rr=t=>xt(t)?Rs(t):t;function Nt(t){return t?t.__v_isRef===!0:!1}function ye(t){return $l(t,!1)}function $l(t,e){return Nt(t)?t:new Ql(t,e)}class Ql{constructor(e,i){this.dep=new $n,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?e:mt(e),this._value=i?e:Ot(e),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(e){const i=this._rawValue,n=this.__v_isShallow||Qt(e)||Te(e);e=n?e:mt(e),pe(e,i)&&(this._rawValue=e,this._value=n?e:Ot(e),this.dep.trigger())}}function be(t){return Nt(t)?t.value:t}const Jl={get:(t,e,i)=>e==="__v_raw"?t:be(Reflect.get(t,e,i)),set:(t,e,i,n)=>{const s=t[e];return Nt(s)&&!Nt(i)?(s.value=i,!0):Reflect.set(t,e,i,n)}};function Es(t){return ni(t)?t:new Proxy(t,Jl)}class Zl{constructor(e,i,n){this.fn=e,this.setter=i,this._value=void 0,this.dep=new $n(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ze-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&wt!==this)return as(this,!0),!0}get value(){const e=this.dep.track();return hs(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function tc(t,e,i=!1){let n,s;return ht(t)?n=t:(n=t.get,s=t.set),new Zl(n,s,i)}const yn={},bn=new WeakMap;let Re;function ec(t,e=!1,i=Re){if(i){let n=bn.get(i);n||bn.set(i,n=[]),n.push(t)}}function ic(t,e,i=vt){const{immediate:n,deep:s,once:r,scheduler:o,augmentJob:a,call:l}=i,c=_=>s?_:Qt(_)||s===!1||s===0?ce(_,1):ce(_);let d,p,g,u,f=!1,y=!1;if(Nt(t)?(p=()=>t.value,f=Qt(t)):ni(t)?(p=()=>c(t),f=!0):ct(t)?(y=!0,f=t.some(_=>ni(_)||Qt(_)),p=()=>t.map(_=>{if(Nt(_))return _.value;if(ni(_))return c(_);if(ht(_))return l?l(_,2):_()})):ht(t)?e?p=l?()=>l(t,2):t:p=()=>{if(g){se();try{g()}finally{oe()}}const _=Re;Re=d;try{return l?l(t,3,[u]):t(u)}finally{Re=_}}:p=Jt,e&&s){const _=p,v=s===!0?1/0:s;p=()=>ce(_(),v)}const S=Tl(),x=()=>{d.stop(),S&&Bn(S.effects,d)};if(r&&e){const _=e;e=(...v)=>{_(...v),x()}}let m=y?new Array(t.length).fill(yn):yn;const h=_=>{if(!(!(d.flags&1)||!d.dirty&&!_))if(e){const v=d.run();if(s||f||(y?v.some((R,I)=>pe(R,m[I])):pe(v,m))){g&&g();const R=Re;Re=d;try{const I=[v,m===yn?void 0:y&&m[0]===yn?[]:m,u];l?l(e,3,I):e(...I),m=v}finally{Re=R}}}else d.run()};return a&&a(h),d=new ss(p),d.scheduler=o?()=>o(h,!1):h,u=_=>ec(_,!1,d),g=d.onStop=()=>{const _=bn.get(d);if(_){if(l)l(_,4);else for(const v of _)v();bn.delete(d)}},e?n?h(!0):m=d.run():o?o(h.bind(null,!0),!0):d.run(),x.pause=d.pause.bind(d),x.resume=d.resume.bind(d),x.stop=x,x}function ce(t,e=1/0,i){if(e<=0||!xt(t)||t.__v_skip||(i=i||new Set,i.has(t)))return t;if(i.add(t),e--,Nt(t))ce(t.value,e,i);else if(ct(t))for(let n=0;n<t.length;n++)ce(t[n],e,i);else if(sn(t)||Oe(t))t.forEach(n=>{ce(n,e,i)});else if(on(t)){for(const n in t)ce(t[n],e,i);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&ce(t[n],e,i)}return t}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const ri=[];let sr=!1;function Au(t,...e){if(sr)return;sr=!0,se();const i=ri.length?ri[ri.length-1].component:null,n=i&&i.appContext.config.warnHandler,s=nc();if(n)Ge(n,i,11,[t+e.map(r=>{var o,a;return(a=(o=r.toString)==null?void 0:o.call(r))!=null?a:JSON.stringify(r)}).join(""),i&&i.proxy,s.map(({vnode:r})=>`at <${xo(i,r.type)}>`).join(`
`),s]);else{const r=[`[Vue warn]: ${t}`,...e];s.length&&r.push(`
`,...rc(s)),console.warn(...r)}oe(),sr=!1}function nc(){let t=ri[ri.length-1];if(!t)return[];const e=[];for(;t;){const i=e[0];i&&i.vnode===t?i.recurseCount++:e.push({vnode:t,recurseCount:0});const n=t.component&&t.component.parent;t=n&&n.vnode}return e}function rc(t){const e=[];return t.forEach((i,n)=>{e.push(...n===0?[]:[`
`],...sc(i))}),e}function sc({vnode:t,recurseCount:e}){const i=e>0?`... (${e} recursive calls)`:"",n=t.component?t.component.parent==null:!1,s=` at <${xo(t.component,t.type,n)}`,r=">"+i;return t.props?[s,...oc(t.props),r]:[s+r]}function oc(t){const e=[],i=Object.keys(t);return i.slice(0,3).forEach(n=>{e.push(...As(n,t[n]))}),i.length>3&&e.push(" ..."),e}function As(t,e,i){return Rt(e)?(e=JSON.stringify(e),i?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?i?e:[`${t}=${e}`]:Nt(e)?(e=As(t,mt(e.value),!0),i?e:[`${t}=Ref<`,e,">"]):ht(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=mt(e),i?e:[`${t}=`,e])}function Ge(t,e,i,n){try{return n?t(...n):t()}catch(s){vn(s,e,i)}}function te(t,e,i,n){if(ht(t)){const s=Ge(t,e,i,n);return s&&Yr(s)&&s.catch(r=>{vn(r,e,i)}),s}if(ct(t)){const s=[];for(let r=0;r<t.length;r++)s.push(te(t[r],e,i,n));return s}}function vn(t,e,i,n=!0){const s=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||vt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${i}`;for(;a;){const d=a.ec;if(d){for(let p=0;p<d.length;p++)if(d[p](t,l,c)===!1)return}a=a.parent}if(r){se(),Ge(r,null,10,[t,l,c]),oe();return}}ac(t,i,s,n,o)}function ac(t,e,i,n=!0,s=!1){if(s)throw t;console.error(t)}const Dt=[];let ee=-1;const Ue=[];let ve=null,Be=0;const Ms=Promise.resolve();let Sn=null;function or(t){const e=Sn||Ms;return t?e.then(this?t.bind(this):t):e}function lc(t){let e=ee+1,i=Dt.length;for(;e<i;){const n=e+i>>>1,s=Dt[n],r=si(s);r<t||r===t&&s.flags&2?e=n+1:i=n}return e}function ar(t){if(!(t.flags&1)){const e=si(t),i=Dt[Dt.length-1];!i||!(t.flags&2)&&e>=si(i)?Dt.push(t):Dt.splice(lc(e),0,t),t.flags|=1,Ns()}}function Ns(){Sn||(Sn=Ms.then(Is))}function cc(t){ct(t)?Ue.push(...t):ve&&t.id===-1?ve.splice(Be+1,0,t):t.flags&1||(Ue.push(t),t.flags|=1),Ns()}function ks(t,e,i=ee+1){for(;i<Dt.length;i++){const n=Dt[i];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;Dt.splice(i,1),i--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Fs(t){if(Ue.length){const e=[...new Set(Ue)].sort((i,n)=>si(i)-si(n));if(Ue.length=0,ve){ve.push(...e);return}for(ve=e,Be=0;Be<ve.length;Be++){const i=ve[Be];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}ve=null,Be=0}}const si=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Is(t){try{for(ee=0;ee<Dt.length;ee++){const e=Dt[ee];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Ge(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ee<Dt.length;ee++){const e=Dt[ee];e&&(e.flags&=-2)}ee=-1,Dt.length=0,Fs(),Sn=null,(Dt.length||Ue.length)&&Is()}}let jt=null,Os=null;function wn(t){const e=jt;return jt=t,Os=t&&t.type.__scopeId||null,e}function hc(t,e=jt,i){if(!e||t._n)return t;const n=(...s)=>{n._d&&go(-1);const r=wn(e);let o;try{o=t(...s)}finally{wn(r),n._d&&go(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function dc(t,e){if(jt===null)return t;const i=Nn(jt),n=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[r,o,a,l=vt]=e[s];r&&(ht(r)&&(r={mounted:r,updated:r}),r.deep&&ce(o),n.push({dir:r,instance:i,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function Ee(t,e,i,n){const s=t.dirs,r=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];r&&(a.oldValue=r[o].value);let l=a.dir[n];l&&(se(),te(l,i,8,[t.el,a,t,e]),oe())}}const uc=Symbol("_vte"),fc=t=>t.__isTeleport;function lr(t,e){t.shapeFlag&6&&t.component?(t.transition=e,lr(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function Ds(t,e){return ht(t)?At({name:t.name},e,{setup:t}):t}function Ls(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function cr(t,e,i,n,s=!1){if(ct(t)){t.forEach((f,y)=>cr(f,e&&(ct(e)?e[y]:e),i,n,s));return}if(oi(n)&&!s)return;const r=n.shapeFlag&4?Nn(n.component):n.el,o=s?null:r,{i:a,r:l}=t,c=e&&e.r,d=a.refs===vt?a.refs={}:a.refs,p=a.setupState,g=mt(p),u=p===vt?()=>!1:f=>_t(g,f);if(c!=null&&c!==l&&(Rt(c)?(d[c]=null,u(c)&&(p[c]=null)):Nt(c)&&(c.value=null)),ht(l))Ge(l,a,12,[o,d]);else{const f=Rt(l),y=Nt(l);if(f||y){const S=()=>{if(t.f){const x=f?u(l)?p[l]:d[l]:l.value;s?ct(x)&&Bn(x,r):ct(x)?x.includes(r)||x.push(r):f?(d[l]=[r],u(l)&&(p[l]=d[l])):(l.value=[r],t.k&&(d[t.k]=l.value))}else f?(d[l]=o,u(l)&&(p[l]=o)):y&&(l.value=o,t.k&&(d[t.k]=o))};o?(S.id=-1,qt(S,i)):S()}}}const oi=t=>!!t.type.__asyncLoader,Gs=t=>t.type.__isKeepAlive;function gc(t,e){Us(t,"a",e)}function pc(t,e){Us(t,"da",e)}function Us(t,e,i=Gt){const n=t.__wdc||(t.__wdc=()=>{let s=i;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Cn(e,n,i),i){let s=i.parent;for(;s&&s.parent;)Gs(s.parent.vnode)&&mc(n,e,i,s),s=s.parent}}function mc(t,e,i,n){const s=Cn(e,t,n,!0);hr(()=>{Bn(n[e],s)},i)}function Cn(t,e,i=Gt,n=!1){if(i){const s=i[t]||(i[t]=[]),r=e.__weh||(e.__weh=(...o)=>{se();const a=ui(i),l=te(e,i,t,o);return a(),oe(),l});return n?s.unshift(r):s.push(r),r}}const he=t=>(e,i=Gt)=>{(!Mn||t==="sp")&&Cn(t,(...n)=>e(...n),i)},_c=he("bm"),Bs=he("m"),yc=he("bu"),bc=he("u"),vc=he("bum"),hr=he("um"),Sc=he("sp"),wc=he("rtg"),Cc=he("rtc");function xc(t,e=Gt){Cn("ec",t,e)}const Pc=Symbol.for("v-ndc"),dr=t=>t?So(t)?Nn(t):dr(t.parent):null,ai=At(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>dr(t.parent),$root:t=>dr(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>qs(t),$forceUpdate:t=>t.f||(t.f=()=>{ar(t.update)}),$nextTick:t=>t.n||(t.n=or.bind(t.proxy)),$watch:t=>jc.bind(t)}),ur=(t,e)=>t!==vt&&!t.__isScriptSetup&&_t(t,e),Tc={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:i,setupState:n,data:s,props:r,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const u=o[e];if(u!==void 0)switch(u){case 1:return n[e];case 2:return s[e];case 4:return i[e];case 3:return r[e]}else{if(ur(n,e))return o[e]=1,n[e];if(s!==vt&&_t(s,e))return o[e]=2,s[e];if((c=t.propsOptions[0])&&_t(c,e))return o[e]=3,r[e];if(i!==vt&&_t(i,e))return o[e]=4,i[e];fr&&(o[e]=0)}}const d=ai[e];let p,g;if(d)return e==="$attrs"&&kt(t.attrs,"get",""),d(t);if((p=a.__cssModules)&&(p=p[e]))return p;if(i!==vt&&_t(i,e))return o[e]=4,i[e];if(g=l.config.globalProperties,_t(g,e))return g[e]},set({_:t},e,i){const{data:n,setupState:s,ctx:r}=t;return ur(s,e)?(s[e]=i,!0):n!==vt&&_t(n,e)?(n[e]=i,!0):_t(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=i,!0)},has({_:{data:t,setupState:e,accessCache:i,ctx:n,appContext:s,propsOptions:r}},o){let a;return!!i[o]||t!==vt&&_t(t,o)||ur(e,o)||(a=r[0])&&_t(a,o)||_t(n,o)||_t(ai,o)||_t(s.config.globalProperties,o)},defineProperty(t,e,i){return i.get!=null?t._.accessCache[e]=0:_t(i,"value")&&this.set(t,e,i.value,null),Reflect.defineProperty(t,e,i)}};function Hs(t){return ct(t)?t.reduce((e,i)=>(e[i]=null,e),{}):t}let fr=!0;function Rc(t){const e=qs(t),i=t.proxy,n=t.ctx;fr=!1,e.beforeCreate&&Vs(e.beforeCreate,t,"bc");const{data:s,computed:r,methods:o,watch:a,provide:l,inject:c,created:d,beforeMount:p,mounted:g,beforeUpdate:u,updated:f,activated:y,deactivated:S,beforeDestroy:x,beforeUnmount:m,destroyed:h,unmounted:_,render:v,renderTracked:R,renderTriggered:I,errorCaptured:w,serverPrefetch:C,expose:T,inheritAttrs:M,components:D,directives:G,filters:B}=e;if(c&&Ec(c,n,null),o)for(const b in o){const P=o[b];ht(P)&&(n[b]=P.bind(i))}if(s){const b=s.call(i,i);xt(b)&&(t.data=ii(b))}if(fr=!0,r)for(const b in r){const P=r[b],N=ht(P)?P.bind(i,i):ht(P.get)?P.get.bind(i,i):Jt,A=!ht(P)&&ht(P.set)?P.set.bind(i):Jt,O=fi({get:N,set:A});Object.defineProperty(n,b,{enumerable:!0,configurable:!0,get:()=>O.value,set:q=>O.value=q})}if(a)for(const b in a)zs(a[b],n,i,b);if(l){const b=ht(l)?l.call(i):l;Reflect.ownKeys(b).forEach(P=>{Ic(P,b[P])})}d&&Vs(d,t,"c");function $(b,P){ct(P)?P.forEach(N=>b(N.bind(i))):P&&b(P.bind(i))}if($(_c,p),$(Bs,g),$(yc,u),$(bc,f),$(gc,y),$(pc,S),$(xc,w),$(Cc,R),$(wc,I),$(vc,m),$(hr,_),$(Sc,C),ct(T))if(T.length){const b=t.exposed||(t.exposed={});T.forEach(P=>{Object.defineProperty(b,P,{get:()=>i[P],set:N=>i[P]=N})})}else t.exposed||(t.exposed={});v&&t.render===Jt&&(t.render=v),M!=null&&(t.inheritAttrs=M),D&&(t.components=D),G&&(t.directives=G),C&&Ls(t)}function Ec(t,e,i=Jt){ct(t)&&(t=gr(t));for(const n in t){const s=t[n];let r;xt(s)?"default"in s?r=Pn(s.from||n,s.default,!0):r=Pn(s.from||n):r=Pn(s),Nt(r)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[n]=r}}function Vs(t,e,i){te(ct(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,i)}function zs(t,e,i,n){let s=n.includes(".")?lo(i,n):()=>i[n];if(Rt(t)){const r=e[t];ht(r)&&Me(s,r)}else if(ht(t))Me(s,t.bind(i));else if(xt(t))if(ct(t))t.forEach(r=>zs(r,e,i,n));else{const r=ht(t.handler)?t.handler.bind(i):e[t.handler];ht(r)&&Me(s,r,t)}}function qs(t){const e=t.type,{mixins:i,extends:n}=e,{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,a=r.get(e);let l;return a?l=a:!s.length&&!i&&!n?l=e:(l={},s.length&&s.forEach(c=>xn(l,c,o,!0)),xn(l,e,o)),xt(e)&&r.set(e,l),l}function xn(t,e,i,n=!1){const{mixins:s,extends:r}=e;r&&xn(t,r,i,!0),s&&s.forEach(o=>xn(t,o,i,!0));for(const o in e)if(!(n&&o==="expose")){const a=Ac[o]||i&&i[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Ac={data:Ws,props:Ks,emits:Ks,methods:li,computed:li,beforeCreate:Lt,created:Lt,beforeMount:Lt,mounted:Lt,beforeUpdate:Lt,updated:Lt,beforeDestroy:Lt,beforeUnmount:Lt,destroyed:Lt,unmounted:Lt,activated:Lt,deactivated:Lt,errorCaptured:Lt,serverPrefetch:Lt,components:li,directives:li,watch:Nc,provide:Ws,inject:Mc};function Ws(t,e){return e?t?function(){return At(ht(t)?t.call(this,this):t,ht(e)?e.call(this,this):e)}:e:t}function Mc(t,e){return li(gr(t),gr(e))}function gr(t){if(ct(t)){const e={};for(let i=0;i<t.length;i++)e[t[i]]=t[i];return e}return t}function Lt(t,e){return t?[...new Set([].concat(t,e))]:e}function li(t,e){return t?At(Object.create(null),t,e):e}function Ks(t,e){return t?ct(t)&&ct(e)?[...new Set([...t,...e])]:At(Object.create(null),Hs(t),Hs(e??{})):e}function Nc(t,e){if(!t)return e;if(!e)return t;const i=At(Object.create(null),t);for(const n in e)i[n]=Lt(t[n],e[n]);return i}function js(){return{app:null,config:{isNativeTag:fl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let kc=0;function Fc(t,e){return function(n,s=null){ht(n)||(n=At({},n)),s!=null&&!xt(s)&&(s=null);const r=js(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:kc++,_component:n,_props:s,_container:null,_context:r,_instance:null,version:yh,get config(){return r.config},set config(d){},use(d,...p){return o.has(d)||(d&&ht(d.install)?(o.add(d),d.install(c,...p)):ht(d)&&(o.add(d),d(c,...p))),c},mixin(d){return r.mixins.includes(d)||r.mixins.push(d),c},component(d,p){return p?(r.components[d]=p,c):r.components[d]},directive(d,p){return p?(r.directives[d]=p,c):r.directives[d]},mount(d,p,g){if(!l){const u=c._ceVNode||ie(n,s);return u.appContext=r,g===!0?g="svg":g===!1&&(g=void 0),t(u,d,g),l=!0,c._container=d,d.__vue_app__=c,Nn(u.component)}},onUnmount(d){a.push(d)},unmount(){l&&(te(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(d,p){return r.provides[d]=p,c},runWithContext(d){const p=He;He=c;try{return d()}finally{He=p}}};return c}}let He=null;function Ic(t,e){if(Gt){let i=Gt.provides;const n=Gt.parent&&Gt.parent.provides;n===i&&(i=Gt.provides=Object.create(n)),i[t]=e}}function Pn(t,e,i=!1){const n=Gt||jt;if(n||He){const s=He?He._context.provides:n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return i&&ht(e)?e.call(n&&n.proxy):e}}const Ys={},Xs=()=>Object.create(Ys),$s=t=>Object.getPrototypeOf(t)===Ys;function Oc(t,e,i,n=!1){const s={},r=Xs();t.propsDefaults=Object.create(null),Qs(t,e,s,r);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);i?t.props=n?s:Yl(s):t.type.props?t.props=s:t.props=r,t.attrs=r}function Dc(t,e,i,n){const{props:s,attrs:r,vnode:{patchFlag:o}}=t,a=mt(s),[l]=t.propsOptions;let c=!1;if((n||o>0)&&!(o&16)){if(o&8){const d=t.vnode.dynamicProps;for(let p=0;p<d.length;p++){let g=d[p];if(Tn(t.emitsOptions,g))continue;const u=e[g];if(l)if(_t(r,g))u!==r[g]&&(r[g]=u,c=!0);else{const f=Xt(g);s[f]=pr(l,a,f,u,t,!1)}else u!==r[g]&&(r[g]=u,c=!0)}}}else{Qs(t,e,s,r)&&(c=!0);let d;for(const p in a)(!e||!_t(e,p)&&((d=Kt(p))===p||!_t(e,d)))&&(l?i&&(i[p]!==void 0||i[d]!==void 0)&&(s[p]=pr(l,a,p,void 0,t,!0)):delete s[p]);if(r!==a)for(const p in r)(!e||!_t(e,p))&&(delete r[p],c=!0)}c&&ae(t.attrs,"set","")}function Qs(t,e,i,n){const[s,r]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if($e(l))continue;const c=e[l];let d;s&&_t(s,d=Xt(l))?!r||!r.includes(d)?i[d]=c:(a||(a={}))[d]=c:Tn(t.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,o=!0)}if(r){const l=mt(i),c=a||vt;for(let d=0;d<r.length;d++){const p=r[d];i[p]=pr(s,l,p,c[p],t,!_t(c,p))}}return o}function pr(t,e,i,n,s,r){const o=t[i];if(o!=null){const a=_t(o,"default");if(a&&n===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&ht(l)){const{propsDefaults:c}=s;if(i in c)n=c[i];else{const d=ui(s);n=c[i]=l.call(null,e),d()}}else n=l;s.ce&&s.ce._setProp(i,n)}o[0]&&(r&&!a?n=!1:o[1]&&(n===""||n===Kt(i))&&(n=!0))}return n}const Lc=new WeakMap;function Js(t,e,i=!1){const n=i?Lc:e.propsCache,s=n.get(t);if(s)return s;const r=t.props,o={},a=[];let l=!1;if(!ht(t)){const d=p=>{l=!0;const[g,u]=Js(p,e,!0);At(o,g),u&&a.push(...u)};!i&&e.mixins.length&&e.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}if(!r&&!l)return xt(t)&&n.set(t,Ie),Ie;if(ct(r))for(let d=0;d<r.length;d++){const p=Xt(r[d]);Zs(p)&&(o[p]=vt)}else if(r)for(const d in r){const p=Xt(d);if(Zs(p)){const g=r[d],u=o[p]=ct(g)||ht(g)?{type:g}:At({},g),f=u.type;let y=!1,S=!0;if(ct(f))for(let x=0;x<f.length;++x){const m=f[x],h=ht(m)&&m.name;if(h==="Boolean"){y=!0;break}else h==="String"&&(S=!1)}else y=ht(f)&&f.name==="Boolean";u[0]=y,u[1]=S,(y||_t(u,"default"))&&a.push(p)}}const c=[o,a];return xt(t)&&n.set(t,c),c}function Zs(t){return t[0]!=="$"&&!$e(t)}const to=t=>t[0]==="_"||t==="$stable",mr=t=>ct(t)?t.map(ne):[ne(t)],Gc=(t,e,i)=>{if(e._n)return e;const n=hc((...s)=>mr(e(...s)),i);return n._c=!1,n},eo=(t,e,i)=>{const n=t._ctx;for(const s in t){if(to(s))continue;const r=t[s];if(ht(r))e[s]=Gc(s,r,n);else if(r!=null){const o=mr(r);e[s]=()=>o}}},io=(t,e)=>{const i=mr(e);t.slots.default=()=>i},no=(t,e,i)=>{for(const n in e)(i||n!=="_")&&(t[n]=e[n])},Uc=(t,e,i)=>{const n=t.slots=Xs();if(t.vnode.shapeFlag&32){const s=e._;s?(no(n,e,i),i&&Qr(n,"_",s,!0)):eo(e,n)}else e&&io(t,e)},Bc=(t,e,i)=>{const{vnode:n,slots:s}=t;let r=!0,o=vt;if(n.shapeFlag&32){const a=e._;a?i&&a===1?r=!1:no(s,e,i):(r=!e.$stable,eo(e,s)),o=e}else e&&(io(t,e),o={default:1});if(r)for(const a in s)!to(a)&&o[a]==null&&delete s[a]},qt=th;function Hc(t){return Vc(t)}function Vc(t,e){const i=es();i.__VUE__=!0;const{insert:n,remove:s,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:d,parentNode:p,nextSibling:g,setScopeId:u=Jt,insertStaticContent:f}=t,y=(E,F,H,W=null,Y=null,K=null,Z=void 0,it=null,tt=!!F.dynamicChildren)=>{if(E===F)return;E&&!di(E,F)&&(W=k(E),q(E,Y,K,!0),E=null),F.patchFlag===-2&&(tt=!1,F.dynamicChildren=null);const{type:J,ref:st,shapeFlag:rt}=F;switch(J){case Rn:S(E,F,H,W);break;case Ne:x(E,F,H,W);break;case yr:E==null&&m(F,H,W,Z);break;case de:D(E,F,H,W,Y,K,Z,it,tt);break;default:rt&1?v(E,F,H,W,Y,K,Z,it,tt):rt&6?G(E,F,H,W,Y,K,Z,it,tt):(rt&64||rt&128)&&J.process(E,F,H,W,Y,K,Z,it,tt,j)}st!=null&&Y&&cr(st,E&&E.ref,K,F||E,!F)},S=(E,F,H,W)=>{if(E==null)n(F.el=a(F.children),H,W);else{const Y=F.el=E.el;F.children!==E.children&&c(Y,F.children)}},x=(E,F,H,W)=>{E==null?n(F.el=l(F.children||""),H,W):F.el=E.el},m=(E,F,H,W)=>{[E.el,E.anchor]=f(E.children,F,H,W,E.el,E.anchor)},h=({el:E,anchor:F},H,W)=>{let Y;for(;E&&E!==F;)Y=g(E),n(E,H,W),E=Y;n(F,H,W)},_=({el:E,anchor:F})=>{let H;for(;E&&E!==F;)H=g(E),s(E),E=H;s(F)},v=(E,F,H,W,Y,K,Z,it,tt)=>{F.type==="svg"?Z="svg":F.type==="math"&&(Z="mathml"),E==null?R(F,H,W,Y,K,Z,it,tt):C(E,F,Y,K,Z,it,tt)},R=(E,F,H,W,Y,K,Z,it)=>{let tt,J;const{props:st,shapeFlag:rt,transition:ot,dirs:at}=E;if(tt=E.el=o(E.type,K,st&&st.is,st),rt&8?d(tt,E.children):rt&16&&w(E.children,tt,null,W,Y,_r(E,K),Z,it),at&&Ee(E,null,W,"created"),I(tt,E,E.scopeId,Z,W),st){for(const pt in st)pt!=="value"&&!$e(pt)&&r(tt,pt,null,st[pt],K,W);"value"in st&&r(tt,"value",null,st.value,K),(J=st.onVnodeBeforeMount)&&re(J,W,E)}at&&Ee(E,null,W,"beforeMount");const lt=zc(Y,ot);lt&&ot.beforeEnter(tt),n(tt,F,H),((J=st&&st.onVnodeMounted)||lt||at)&&qt(()=>{J&&re(J,W,E),lt&&ot.enter(tt),at&&Ee(E,null,W,"mounted")},Y)},I=(E,F,H,W,Y)=>{if(H&&u(E,H),W)for(let K=0;K<W.length;K++)u(E,W[K]);if(Y){let K=Y.subTree;if(F===K||fo(K.type)&&(K.ssContent===F||K.ssFallback===F)){const Z=Y.vnode;I(E,Z,Z.scopeId,Z.slotScopeIds,Y.parent)}}},w=(E,F,H,W,Y,K,Z,it,tt=0)=>{for(let J=tt;J<E.length;J++){const st=E[J]=it?Se(E[J]):ne(E[J]);y(null,st,F,H,W,Y,K,Z,it)}},C=(E,F,H,W,Y,K,Z)=>{const it=F.el=E.el;let{patchFlag:tt,dynamicChildren:J,dirs:st}=F;tt|=E.patchFlag&16;const rt=E.props||vt,ot=F.props||vt;let at;if(H&&Ae(H,!1),(at=ot.onVnodeBeforeUpdate)&&re(at,H,F,E),st&&Ee(F,E,H,"beforeUpdate"),H&&Ae(H,!0),(rt.innerHTML&&ot.innerHTML==null||rt.textContent&&ot.textContent==null)&&d(it,""),J?T(E.dynamicChildren,J,it,H,W,_r(F,Y),K):Z||P(E,F,it,null,H,W,_r(F,Y),K,!1),tt>0){if(tt&16)M(it,rt,ot,H,Y);else if(tt&2&&rt.class!==ot.class&&r(it,"class",null,ot.class,Y),tt&4&&r(it,"style",rt.style,ot.style,Y),tt&8){const lt=F.dynamicProps;for(let pt=0;pt<lt.length;pt++){const dt=lt[pt],Pt=rt[dt],yt=ot[dt];(yt!==Pt||dt==="value")&&r(it,dt,Pt,yt,Y,H)}}tt&1&&E.children!==F.children&&d(it,F.children)}else!Z&&J==null&&M(it,rt,ot,H,Y);((at=ot.onVnodeUpdated)||st)&&qt(()=>{at&&re(at,H,F,E),st&&Ee(F,E,H,"updated")},W)},T=(E,F,H,W,Y,K,Z)=>{for(let it=0;it<F.length;it++){const tt=E[it],J=F[it],st=tt.el&&(tt.type===de||!di(tt,J)||tt.shapeFlag&70)?p(tt.el):H;y(tt,J,st,null,W,Y,K,Z,!0)}},M=(E,F,H,W,Y)=>{if(F!==H){if(F!==vt)for(const K in F)!$e(K)&&!(K in H)&&r(E,K,F[K],null,Y,W);for(const K in H){if($e(K))continue;const Z=H[K],it=F[K];Z!==it&&K!=="value"&&r(E,K,it,Z,Y,W)}"value"in H&&r(E,"value",F.value,H.value,Y)}},D=(E,F,H,W,Y,K,Z,it,tt)=>{const J=F.el=E?E.el:a(""),st=F.anchor=E?E.anchor:a("");let{patchFlag:rt,dynamicChildren:ot,slotScopeIds:at}=F;at&&(it=it?it.concat(at):at),E==null?(n(J,H,W),n(st,H,W),w(F.children||[],H,st,Y,K,Z,it,tt)):rt>0&&rt&64&&ot&&E.dynamicChildren?(T(E.dynamicChildren,ot,H,Y,K,Z,it),(F.key!=null||Y&&F===Y.subTree)&&ro(E,F,!0)):P(E,F,H,st,Y,K,Z,it,tt)},G=(E,F,H,W,Y,K,Z,it,tt)=>{F.slotScopeIds=it,E==null?F.shapeFlag&512?Y.ctx.activate(F,H,W,Z,tt):B(F,H,W,Y,K,Z,tt):L(E,F,tt)},B=(E,F,H,W,Y,K,Z)=>{const it=E.component=ch(E,W,Y);if(Gs(E)&&(it.ctx.renderer=j),hh(it,!1,Z),it.asyncDep){if(Y&&Y.registerDep(it,$,Z),!E.el){const tt=it.subTree=ie(Ne);x(null,tt,F,H)}}else $(it,E,F,H,Y,K,Z)},L=(E,F,H)=>{const W=F.component=E.component;if(Jc(E,F,H))if(W.asyncDep&&!W.asyncResolved){b(W,F,H);return}else W.next=F,W.update();else F.el=E.el,W.vnode=F},$=(E,F,H,W,Y,K,Z)=>{const it=()=>{if(E.isMounted){let{next:rt,bu:ot,u:at,parent:lt,vnode:pt}=E;{const It=so(E);if(It){rt&&(rt.el=pt.el,b(E,rt,Z)),It.asyncDep.then(()=>{E.isUnmounted||it()});return}}let dt=rt,Pt;Ae(E,!1),rt?(rt.el=pt.el,b(E,rt,Z)):rt=pt,ot&&ln(ot),(Pt=rt.props&&rt.props.onVnodeBeforeUpdate)&&re(Pt,lt,rt,pt),Ae(E,!0);const yt=ho(E),Ct=E.subTree;E.subTree=yt,y(Ct,yt,p(Ct.el),k(Ct),E,Y,K),rt.el=yt.el,dt===null&&Zc(E,yt.el),at&&qt(at,Y),(Pt=rt.props&&rt.props.onVnodeUpdated)&&qt(()=>re(Pt,lt,rt,pt),Y)}else{let rt;const{el:ot,props:at}=F,{bm:lt,m:pt,parent:dt,root:Pt,type:yt}=E,Ct=oi(F);Ae(E,!1),lt&&ln(lt),!Ct&&(rt=at&&at.onVnodeBeforeMount)&&re(rt,dt,F),Ae(E,!0);{Pt.ce&&Pt.ce._injectChildStyle(yt);const It=E.subTree=ho(E);y(null,It,H,W,E,Y,K),F.el=It.el}if(pt&&qt(pt,Y),!Ct&&(rt=at&&at.onVnodeMounted)){const It=F;qt(()=>re(rt,dt,It),Y)}(F.shapeFlag&256||dt&&oi(dt.vnode)&&dt.vnode.shapeFlag&256)&&E.a&&qt(E.a,Y),E.isMounted=!0,F=H=W=null}};E.scope.on();const tt=E.effect=new ss(it);E.scope.off();const J=E.update=tt.run.bind(tt),st=E.job=tt.runIfDirty.bind(tt);st.i=E,st.id=E.uid,tt.scheduler=()=>ar(st),Ae(E,!0),J()},b=(E,F,H)=>{F.component=E;const W=E.vnode.props;E.vnode=F,E.next=null,Dc(E,F.props,W,H),Bc(E,F.children,H),se(),ks(E),oe()},P=(E,F,H,W,Y,K,Z,it,tt=!1)=>{const J=E&&E.children,st=E?E.shapeFlag:0,rt=F.children,{patchFlag:ot,shapeFlag:at}=F;if(ot>0){if(ot&128){A(J,rt,H,W,Y,K,Z,it,tt);return}else if(ot&256){N(J,rt,H,W,Y,K,Z,it,tt);return}}at&8?(st&16&&z(J,Y,K),rt!==J&&d(H,rt)):st&16?at&16?A(J,rt,H,W,Y,K,Z,it,tt):z(J,Y,K,!0):(st&8&&d(H,""),at&16&&w(rt,H,W,Y,K,Z,it,tt))},N=(E,F,H,W,Y,K,Z,it,tt)=>{E=E||Ie,F=F||Ie;const J=E.length,st=F.length,rt=Math.min(J,st);let ot;for(ot=0;ot<rt;ot++){const at=F[ot]=tt?Se(F[ot]):ne(F[ot]);y(E[ot],at,H,null,Y,K,Z,it,tt)}J>st?z(E,Y,K,!0,!1,rt):w(F,H,W,Y,K,Z,it,tt,rt)},A=(E,F,H,W,Y,K,Z,it,tt)=>{let J=0;const st=F.length;let rt=E.length-1,ot=st-1;for(;J<=rt&&J<=ot;){const at=E[J],lt=F[J]=tt?Se(F[J]):ne(F[J]);if(di(at,lt))y(at,lt,H,null,Y,K,Z,it,tt);else break;J++}for(;J<=rt&&J<=ot;){const at=E[rt],lt=F[ot]=tt?Se(F[ot]):ne(F[ot]);if(di(at,lt))y(at,lt,H,null,Y,K,Z,it,tt);else break;rt--,ot--}if(J>rt){if(J<=ot){const at=ot+1,lt=at<st?F[at].el:W;for(;J<=ot;)y(null,F[J]=tt?Se(F[J]):ne(F[J]),H,lt,Y,K,Z,it,tt),J++}}else if(J>ot)for(;J<=rt;)q(E[J],Y,K,!0),J++;else{const at=J,lt=J,pt=new Map;for(J=lt;J<=ot;J++){const Bt=F[J]=tt?Se(F[J]):ne(F[J]);Bt.key!=null&&pt.set(Bt.key,J)}let dt,Pt=0;const yt=ot-lt+1;let Ct=!1,It=0;const xe=new Array(yt);for(J=0;J<yt;J++)xe[J]=0;for(J=at;J<=rt;J++){const Bt=E[J];if(Pt>=yt){q(Bt,Y,K,!0);continue}let Yt;if(Bt.key!=null)Yt=pt.get(Bt.key);else for(dt=lt;dt<=ot;dt++)if(xe[dt-lt]===0&&di(Bt,F[dt])){Yt=dt;break}Yt===void 0?q(Bt,Y,K,!0):(xe[Yt-lt]=J+1,Yt>=It?It=Yt:Ct=!0,y(Bt,F[Yt],H,null,Y,K,Z,it,tt),Pt++)}const Fe=Ct?qc(xe):Ie;for(dt=Fe.length-1,J=yt-1;J>=0;J--){const Bt=lt+J,Yt=F[Bt],dl=Bt+1<st?F[Bt+1].el:W;xe[J]===0?y(null,Yt,H,dl,Y,K,Z,it,tt):Ct&&(dt<0||J!==Fe[dt]?O(Yt,H,dl,2):dt--)}}},O=(E,F,H,W,Y=null)=>{const{el:K,type:Z,transition:it,children:tt,shapeFlag:J}=E;if(J&6){O(E.component.subTree,F,H,W);return}if(J&128){E.suspense.move(F,H,W);return}if(J&64){Z.move(E,F,H,j);return}if(Z===de){n(K,F,H);for(let rt=0;rt<tt.length;rt++)O(tt[rt],F,H,W);n(E.anchor,F,H);return}if(Z===yr){h(E,F,H);return}if(W!==2&&J&1&&it)if(W===0)it.beforeEnter(K),n(K,F,H),qt(()=>it.enter(K),Y);else{const{leave:rt,delayLeave:ot,afterLeave:at}=it,lt=()=>n(K,F,H),pt=()=>{rt(K,()=>{lt(),at&&at()})};ot?ot(K,lt,pt):pt()}else n(K,F,H)},q=(E,F,H,W=!1,Y=!1)=>{const{type:K,props:Z,ref:it,children:tt,dynamicChildren:J,shapeFlag:st,patchFlag:rt,dirs:ot,cacheIndex:at}=E;if(rt===-2&&(Y=!1),it!=null&&cr(it,null,H,E,!0),at!=null&&(F.renderCache[at]=void 0),st&256){F.ctx.deactivate(E);return}const lt=st&1&&ot,pt=!oi(E);let dt;if(pt&&(dt=Z&&Z.onVnodeBeforeUnmount)&&re(dt,F,E),st&6)et(E.component,H,W);else{if(st&128){E.suspense.unmount(H,W);return}lt&&Ee(E,null,F,"beforeUnmount"),st&64?E.type.remove(E,F,H,j,W):J&&!J.hasOnce&&(K!==de||rt>0&&rt&64)?z(J,F,H,!1,!0):(K===de&&rt&384||!Y&&st&16)&&z(tt,F,H),W&&U(E)}(pt&&(dt=Z&&Z.onVnodeUnmounted)||lt)&&qt(()=>{dt&&re(dt,F,E),lt&&Ee(E,null,F,"unmounted")},H)},U=E=>{const{type:F,el:H,anchor:W,transition:Y}=E;if(F===de){Q(H,W);return}if(F===yr){_(E);return}const K=()=>{s(H),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(E.shapeFlag&1&&Y&&!Y.persisted){const{leave:Z,delayLeave:it}=Y,tt=()=>Z(H,K);it?it(E.el,K,tt):tt()}else K()},Q=(E,F)=>{let H;for(;E!==F;)H=g(E),s(E),E=H;s(F)},et=(E,F,H)=>{const{bum:W,scope:Y,job:K,subTree:Z,um:it,m:tt,a:J}=E;oo(tt),oo(J),W&&ln(W),Y.stop(),K&&(K.flags|=8,q(Z,E,F,H)),it&&qt(it,F),qt(()=>{E.isUnmounted=!0},F),F&&F.pendingBranch&&!F.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===F.pendingId&&(F.deps--,F.deps===0&&F.resolve())},z=(E,F,H,W=!1,Y=!1,K=0)=>{for(let Z=K;Z<E.length;Z++)q(E[Z],F,H,W,Y)},k=E=>{if(E.shapeFlag&6)return k(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const F=g(E.anchor||E.el),H=F&&F[uc];return H?g(H):F};let V=!1;const X=(E,F,H)=>{E==null?F._vnode&&q(F._vnode,null,null,!0):y(F._vnode||null,E,F,null,null,null,H),F._vnode=E,V||(V=!0,ks(),Fs(),V=!1)},j={p:y,um:q,m:O,r:U,mt:B,mc:w,pc:P,pbc:T,n:k,o:t};return{render:X,hydrate:void 0,createApp:Fc(X)}}function _r({type:t,props:e},i){return i==="svg"&&t==="foreignObject"||i==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:i}function Ae({effect:t,job:e},i){i?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function zc(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function ro(t,e,i=!1){const n=t.children,s=e.children;if(ct(n)&&ct(s))for(let r=0;r<n.length;r++){const o=n[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=Se(s[r]),a.el=o.el),!i&&a.patchFlag!==-2&&ro(o,a)),a.type===Rn&&(a.el=o.el)}}function qc(t){const e=t.slice(),i=[0];let n,s,r,o,a;const l=t.length;for(n=0;n<l;n++){const c=t[n];if(c!==0){if(s=i[i.length-1],t[s]<c){e[n]=s,i.push(n);continue}for(r=0,o=i.length-1;r<o;)a=r+o>>1,t[i[a]]<c?r=a+1:o=a;c<t[i[r]]&&(r>0&&(e[n]=i[r-1]),i[r]=n)}}for(r=i.length,o=i[r-1];r-- >0;)i[r]=o,o=e[o];return i}function so(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:so(e)}function oo(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Wc=Symbol.for("v-scx"),Kc=()=>Pn(Wc);function Me(t,e,i){return ao(t,e,i)}function ao(t,e,i=vt){const{immediate:n,deep:s,flush:r,once:o}=i,a=At({},i);let l;if(Mn)if(r==="sync"){const g=Kc();l=g.__watcherHandles||(g.__watcherHandles=[])}else if(!e||n)a.once=!0;else{const g=()=>{};return g.stop=Jt,g.resume=Jt,g.pause=Jt,g}const c=Gt;a.call=(g,u,f)=>te(g,c,u,f);let d=!1;r==="post"?a.scheduler=g=>{qt(g,c&&c.suspense)}:r!=="sync"&&(d=!0,a.scheduler=(g,u)=>{u?g():ar(g)}),a.augmentJob=g=>{e&&(g.flags|=4),d&&(g.flags|=2,c&&(g.id=c.uid,g.i=c))};const p=ic(t,e,a);return l&&l.push(p),p}function jc(t,e,i){const n=this.proxy,s=Rt(t)?t.includes(".")?lo(n,t):()=>n[t]:t.bind(n,n);let r;ht(e)?r=e:(r=e.handler,i=e);const o=ui(this),a=ao(s,r.bind(n),i);return o(),a}function lo(t,e){const i=e.split(".");return()=>{let n=t;for(let s=0;s<i.length&&n;s++)n=n[i[s]];return n}}const Yc=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Xt(e)}Modifiers`]||t[`${Kt(e)}Modifiers`];function Xc(t,e,...i){if(t.isUnmounted)return;const n=t.vnode.props||vt;let s=i;const r=e.startsWith("update:"),o=r&&Yc(n,e.slice(7));o&&(o.trim&&(s=i.map(d=>Rt(d)?d.trim():d)),o.number&&(s=i.map(Jr)));let a,l=n[a=Vn(e)]||n[a=Vn(Xt(e))];!l&&r&&(l=n[a=Vn(Kt(e))]),l&&te(l,t,6,s);const c=n[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,te(c,t,6,s)}}function co(t,e,i=!1){const n=e.emitsCache,s=n.get(t);if(s!==void 0)return s;const r=t.emits;let o={},a=!1;if(!ht(t)){const l=c=>{const d=co(c,e,!0);d&&(a=!0,At(o,d))};!i&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(xt(t)&&n.set(t,null),null):(ct(r)?r.forEach(l=>o[l]=null):At(o,r),xt(t)&&n.set(t,o),o)}function Tn(t,e){return!t||!rn(e)?!1:(e=e.slice(2).replace(/Once$/,""),_t(t,e[0].toLowerCase()+e.slice(1))||_t(t,Kt(e))||_t(t,e))}function Mu(){}function ho(t){const{type:e,vnode:i,proxy:n,withProxy:s,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:d,props:p,data:g,setupState:u,ctx:f,inheritAttrs:y}=t,S=wn(t);let x,m;try{if(i.shapeFlag&4){const _=s||n,v=_;x=ne(c.call(v,_,d,p,u,g,f)),m=a}else{const _=e;x=ne(_.length>1?_(p,{attrs:a,slots:o,emit:l}):_(p,null)),m=e.props?a:$c(a)}}catch(_){ci.length=0,vn(_,t,1),x=ie(Ne)}let h=x;if(m&&y!==!1){const _=Object.keys(m),{shapeFlag:v}=h;_.length&&v&7&&(r&&_.some(Un)&&(m=Qc(m,r)),h=Ve(h,m,!1,!0))}return i.dirs&&(h=Ve(h,null,!1,!0),h.dirs=h.dirs?h.dirs.concat(i.dirs):i.dirs),i.transition&&lr(h,i.transition),x=h,wn(S),x}const $c=t=>{let e;for(const i in t)(i==="class"||i==="style"||rn(i))&&((e||(e={}))[i]=t[i]);return e},Qc=(t,e)=>{const i={};for(const n in t)(!Un(n)||!(n.slice(9)in e))&&(i[n]=t[n]);return i};function Jc(t,e,i){const{props:n,children:s,component:r}=t,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(i&&l>=0){if(l&1024)return!0;if(l&16)return n?uo(n,o,c):!!o;if(l&8){const d=e.dynamicProps;for(let p=0;p<d.length;p++){const g=d[p];if(o[g]!==n[g]&&!Tn(c,g))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?uo(n,o,c):!0:!!o;return!1}function uo(t,e,i){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let s=0;s<n.length;s++){const r=n[s];if(e[r]!==t[r]&&!Tn(i,r))return!0}return!1}function Zc({vnode:t,parent:e},i){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=i,e=e.parent;else break}}const fo=t=>t.__isSuspense;function th(t,e){e&&e.pendingBranch?ct(t)?e.effects.push(...t):e.effects.push(t):cc(t)}const de=Symbol.for("v-fgt"),Rn=Symbol.for("v-txt"),Ne=Symbol.for("v-cmt"),yr=Symbol.for("v-stc"),ci=[];let Wt=null;function br(t=!1){ci.push(Wt=t?null:[])}function eh(){ci.pop(),Wt=ci[ci.length-1]||null}let hi=1;function go(t){hi+=t,t<0&&Wt&&(Wt.hasOnce=!0)}function po(t){return t.dynamicChildren=hi>0?Wt||Ie:null,eh(),hi>0&&Wt&&Wt.push(t),t}function mo(t,e,i,n,s,r){return po(bt(t,e,i,n,s,r,!0))}function ih(t,e,i,n,s){return po(ie(t,e,i,n,s,!0))}function _o(t){return t?t.__v_isVNode===!0:!1}function di(t,e){return t.type===e.type&&t.key===e.key}const yo=({key:t})=>t??null,En=({ref:t,ref_key:e,ref_for:i})=>(typeof t=="number"&&(t=""+t),t!=null?Rt(t)||Nt(t)||ht(t)?{i:jt,r:t,k:e,f:!!i}:t:null);function bt(t,e=null,i=null,n=0,s=null,r=t===de?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&yo(e),ref:e&&En(e),scopeId:Os,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:jt};return a?(vr(l,i),r&128&&t.normalize(l)):i&&(l.shapeFlag|=Rt(i)?8:16),hi>0&&!o&&Wt&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&Wt.push(l),l}const ie=nh;function nh(t,e=null,i=null,n=0,s=null,r=!1){if((!t||t===Pc)&&(t=Ne),_o(t)){const a=Ve(t,e,!0);return i&&vr(a,i),hi>0&&!r&&Wt&&(a.shapeFlag&6?Wt[Wt.indexOf(t)]=a:Wt.push(a)),a.patchFlag=-2,a}if(_h(t)&&(t=t.__vccOpts),e){e=rh(e);let{class:a,style:l}=e;a&&!Rt(a)&&(e.class=De(a)),xt(l)&&(nr(l)&&!ct(l)&&(l=At({},l)),e.style=me(l))}const o=Rt(t)?1:fo(t)?128:fc(t)?64:xt(t)?4:ht(t)?2:0;return bt(t,e,i,n,s,o,r,!0)}function rh(t){return t?nr(t)||$s(t)?At({},t):t:null}function Ve(t,e,i=!1,n=!1){const{props:s,ref:r,patchFlag:o,children:a,transition:l}=t,c=e?oh(s||{},e):s,d={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&yo(c),ref:e&&e.ref?i&&r?ct(r)?r.concat(En(e)):[r,En(e)]:En(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==de?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ve(t.ssContent),ssFallback:t.ssFallback&&Ve(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&n&&lr(d,l.clone(d)),d}function bo(t=" ",e=0){return ie(Rn,null,t,e)}function sh(t="",e=!1){return e?(br(),ih(Ne,null,t)):ie(Ne,null,t)}function ne(t){return t==null||typeof t=="boolean"?ie(Ne):ct(t)?ie(de,null,t.slice()):_o(t)?Se(t):ie(Rn,null,String(t))}function Se(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Ve(t)}function vr(t,e){let i=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(ct(e))i=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),vr(t,s()),s._c&&(s._d=!0));return}else{i=32;const s=e._;!s&&!$s(e)?e._ctx=jt:s===3&&jt&&(jt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else ht(e)?(e={default:e,_ctx:jt},i=32):(e=String(e),n&64?(i=16,e=[bo(e)]):i=8);t.children=e,t.shapeFlag|=i}function oh(...t){const e={};for(let i=0;i<t.length;i++){const n=t[i];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=De([e.class,n.class]));else if(s==="style")e.style=me([e.style,n.style]);else if(rn(s)){const r=e[s],o=n[s];o&&r!==o&&!(ct(r)&&r.includes(o))&&(e[s]=r?[].concat(r,o):o)}else s!==""&&(e[s]=n[s])}return e}function re(t,e,i,n=null){te(t,e,7,[i,n])}const ah=js();let lh=0;function ch(t,e,i){const n=t.type,s=(e?e.appContext:t.appContext)||ah,r={uid:lh++,vnode:t,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Pl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Js(n,s),emitsOptions:co(n,s),emit:null,emitted:null,propsDefaults:vt,inheritAttrs:n.inheritAttrs,ctx:vt,data:vt,props:vt,attrs:vt,slots:vt,refs:vt,setupState:vt,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=Xc.bind(null,r),t.ce&&t.ce(r),r}let Gt=null,An,Sr;{const t=es(),e=(i,n)=>{let s;return(s=t[i])||(s=t[i]=[]),s.push(n),r=>{s.length>1?s.forEach(o=>o(r)):s[0](r)}};An=e("__VUE_INSTANCE_SETTERS__",i=>Gt=i),Sr=e("__VUE_SSR_SETTERS__",i=>Mn=i)}const ui=t=>{const e=Gt;return An(t),t.scope.on(),()=>{t.scope.off(),An(e)}},vo=()=>{Gt&&Gt.scope.off(),An(null)};function So(t){return t.vnode.shapeFlag&4}let Mn=!1;function hh(t,e=!1,i=!1){e&&Sr(e);const{props:n,children:s}=t.vnode,r=So(t);Oc(t,n,r,e),Uc(t,s,i);const o=r?dh(t,e):void 0;return e&&Sr(!1),o}function dh(t,e){const i=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Tc);const{setup:n}=i;if(n){const s=t.setupContext=n.length>1?fh(t):null,r=ui(t);se();const o=Ge(n,t,0,[t.props,s]);if(oe(),r(),Yr(o)){if(oi(t)||Ls(t),o.then(vo,vo),e)return o.then(a=>{wo(t,a)}).catch(a=>{vn(a,t,0)});t.asyncDep=o}else wo(t,o)}else Co(t)}function wo(t,e,i){ht(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:xt(e)&&(t.setupState=Es(e)),Co(t)}function Co(t,e,i){const n=t.type;t.render||(t.render=n.render||Jt);{const s=ui(t);se();try{Rc(t)}finally{oe(),s()}}}const uh={get(t,e){return kt(t,"get",""),t[e]}};function fh(t){const e=i=>{t.exposed=i||{}};return{attrs:new Proxy(t.attrs,uh),slots:t.slots,emit:t.emit,expose:e}}function Nn(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Es(Xl(t.exposed)),{get(e,i){if(i in e)return e[i];if(i in ai)return ai[i](t)},has(e,i){return i in e||i in ai}})):t.proxy}const gh=/(?:^|[-_])(\w)/g,ph=t=>t.replace(gh,e=>e.toUpperCase()).replace(/[-_]/g,"");function mh(t,e=!0){return ht(t)?t.displayName||t.name:t.name||e&&t.__name}function xo(t,e,i=!1){let n=mh(e);if(!n&&e.__file){const s=e.__file.match(/([^/\\]+)\.\w+$/);s&&(n=s[1])}if(!n&&t&&t.parent){const s=r=>{for(const o in r)if(r[o]===e)return o};n=s(t.components||t.parent.type.components)||s(t.appContext.components)}return n?ph(n):i?"App":"Anonymous"}function _h(t){return ht(t)&&"__vccOpts"in t}const fi=(t,e)=>tc(t,e,Mn),yh="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let wr;const Po=typeof window<"u"&&window.trustedTypes;if(Po)try{wr=Po.createPolicy("vue",{createHTML:t=>t})}catch{}const To=wr?t=>wr.createHTML(t):t=>t,bh="http://www.w3.org/2000/svg",vh="http://www.w3.org/1998/Math/MathML",ue=typeof document<"u"?document:null,Ro=ue&&ue.createElement("template"),Sh={insert:(t,e,i)=>{e.insertBefore(t,i||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,i,n)=>{const s=e==="svg"?ue.createElementNS(bh,t):e==="mathml"?ue.createElementNS(vh,t):i?ue.createElement(t,{is:i}):ue.createElement(t);return t==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:t=>ue.createTextNode(t),createComment:t=>ue.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ue.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,i,n,s,r){const o=i?i.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),i),!(s===r||!(s=s.nextSibling)););else{Ro.innerHTML=To(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const a=Ro.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,i)}return[o?o.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}},wh=Symbol("_vtc");function Ch(t,e,i){const n=t[wh];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):i?t.setAttribute("class",e):t.className=e}const Eo=Symbol("_vod"),xh=Symbol("_vsh"),Ph=Symbol(""),Th=/(^|;)\s*display\s*:/;function Rh(t,e,i){const n=t.style,s=Rt(i);let r=!1;if(i&&!s){if(e)if(Rt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();i[a]==null&&kn(n,a,"")}else for(const o in e)i[o]==null&&kn(n,o,"");for(const o in i)o==="display"&&(r=!0),kn(n,o,i[o])}else if(s){if(e!==i){const o=n[Ph];o&&(i+=";"+o),n.cssText=i,r=Th.test(i)}}else e&&t.removeAttribute("style");Eo in t&&(t[Eo]=r?n.display:"",t[xh]&&(n.display="none"))}const Ao=/\s*!important$/;function kn(t,e,i){if(ct(i))i.forEach(n=>kn(t,e,n));else if(i==null&&(i=""),e.startsWith("--"))t.setProperty(e,i);else{const n=Eh(t,e);Ao.test(i)?t.setProperty(Kt(n),i.replace(Ao,""),"important"):t[n]=i}}const Mo=["Webkit","Moz","ms"],Cr={};function Eh(t,e){const i=Cr[e];if(i)return i;let n=Xt(e);if(n!=="filter"&&n in t)return Cr[e]=n;n=$r(n);for(let s=0;s<Mo.length;s++){const r=Mo[s]+n;if(r in t)return Cr[e]=r}return e}const No="http://www.w3.org/1999/xlink";function ko(t,e,i,n,s,r=wl(e)){n&&e.startsWith("xlink:")?i==null?t.removeAttributeNS(No,e.slice(6,e.length)):t.setAttributeNS(No,e,i):i==null||r&&!is(i)?t.removeAttribute(e):t.setAttribute(e,r?"":Zt(i)?String(i):i)}function Fo(t,e,i,n){if(e==="innerHTML"||e==="textContent"){i!=null&&(t[e]=e==="innerHTML"?To(i):i);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,a=i==null?t.type==="checkbox"?"on":"":String(i);(o!==a||!("_value"in t))&&(t.value=a),i==null&&t.removeAttribute(e),t._value=i;return}let r=!1;if(i===""||i==null){const o=typeof t[e];o==="boolean"?i=is(i):i==null&&o==="string"?(i="",r=!0):o==="number"&&(i=0,r=!0)}try{t[e]=i}catch{}r&&t.removeAttribute(e)}function Io(t,e,i,n){t.addEventListener(e,i,n)}function Ah(t,e,i,n){t.removeEventListener(e,i,n)}const Oo=Symbol("_vei");function Mh(t,e,i,n,s=null){const r=t[Oo]||(t[Oo]={}),o=r[e];if(n&&o)o.value=n;else{const[a,l]=Nh(e);if(n){const c=r[e]=Ih(n,s);Io(t,a,c,l)}else o&&(Ah(t,a,o,l),r[e]=void 0)}}const Do=/(?:Once|Passive|Capture)$/;function Nh(t){let e;if(Do.test(t)){e={};let n;for(;n=t.match(Do);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Kt(t.slice(2)),e]}let xr=0;const kh=Promise.resolve(),Fh=()=>xr||(kh.then(()=>xr=0),xr=Date.now());function Ih(t,e){const i=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=i.attached)return;te(Oh(n,i.value),e,5,[n])};return i.value=t,i.attached=Fh(),i}function Oh(t,e){if(ct(e)){const i=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{i.call(t),t._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const Lo=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Dh=(t,e,i,n,s,r)=>{const o=s==="svg";e==="class"?Ch(t,n,o):e==="style"?Rh(t,i,n):rn(e)?Un(e)||Mh(t,e,i,n,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Lh(t,e,n,o))?(Fo(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&ko(t,e,n,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Rt(n))?Fo(t,Xt(e),n):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),ko(t,e,n,o))};function Lh(t,e,i,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&Lo(e)&&ht(i));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Lo(e)&&Rt(i)?!1:e in t}const Go={};/*! #__NO_SIDE_EFFECTS__ */function Gh(t,e,i){const n=Ds(t,e);on(n)&&At(n,e);class s extends Pr{constructor(o){super(n,o,i)}}return s.def=n,s}const Uh=typeof HTMLElement<"u"?HTMLElement:class{};class Pr extends Uh{constructor(e,i={},n=zo){super(),this._def=e,this._props=i,this._createApp=n,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&n!==zo?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof Pr){this._parent=e;break}this._instance||(this._resolved?(this._setParent(),this._update()):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._instance.provides=e._instance.provides)}disconnectedCallback(){this._connected=!1,or(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let n=0;n<this.attributes.length;n++)this._setAttr(this.attributes[n].name);this._ob=new MutationObserver(n=>{for(const s of n)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(n,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:r,styles:o}=n;let a;if(r&&!ct(r))for(const l in r){const c=r[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=Zr(this._props[l])),(a||(a=Object.create(null)))[Xt(l)]=!0)}this._numberProps=a,s&&this._resolveProps(n),this.shadowRoot&&this._applyStyles(o),this._mount(n)},i=this._def.__asyncLoader;i?this._pendingResolve=i().then(n=>e(this._def=n,!0)):e(this._def)}_mount(e){this._app=this._createApp(e),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const i=this._instance&&this._instance.exposed;if(i)for(const n in i)_t(this,n)||Object.defineProperty(this,n,{get:()=>be(i[n])})}_resolveProps(e){const{props:i}=e,n=ct(i)?i:Object.keys(i||{});for(const s of Object.keys(this))s[0]!=="_"&&n.includes(s)&&this._setProp(s,this[s]);for(const s of n.map(Xt))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(r){this._setProp(s,r,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const i=this.hasAttribute(e);let n=i?this.getAttribute(e):Go;const s=Xt(e);i&&this._numberProps&&this._numberProps[s]&&(n=Zr(n)),this._setProp(s,n,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,i,n=!0,s=!1){i!==this._props[e]&&(i===Go?delete this._props[e]:(this._props[e]=i,e==="key"&&this._app&&(this._app._ceVNode.key=i)),s&&this._instance&&this._update(),n&&(i===!0?this.setAttribute(Kt(e),""):typeof i=="string"||typeof i=="number"?this.setAttribute(Kt(e),i+""):i||this.removeAttribute(Kt(e))))}_update(){qh(this._createVNode(),this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const i=ie(this._def,At(e,this._props));return this._instance||(i.ce=n=>{this._instance=n,n.ce=this,n.isCE=!0;const s=(r,o)=>{this.dispatchEvent(new CustomEvent(r,on(o[0])?At({detail:o},o[0]):{detail:o}))};n.emit=(r,...o)=>{s(r,o),Kt(r)!==r&&s(Kt(r),o)},this._setParent()}),i}_applyStyles(e,i){if(!e)return;if(i){if(i===this._def||this._styleChildren.has(i))return;this._styleChildren.add(i)}const n=this._nonce;for(let s=e.length-1;s>=0;s--){const r=document.createElement("style");n&&r.setAttribute("nonce",n),r.textContent=e[s],this.shadowRoot.prepend(r)}}_parseSlots(){const e=this._slots={};let i;for(;i=this.firstChild;){const n=i.nodeType===1&&i.getAttribute("slot")||"default";(e[n]||(e[n]=[])).push(i),this.removeChild(i)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),i=this._instance.type.__scopeId;for(let n=0;n<e.length;n++){const s=e[n],r=s.getAttribute("name")||"default",o=this._slots[r],a=s.parentNode;if(o)for(const l of o){if(i&&l.nodeType===1){const c=i+"-s",d=document.createTreeWalker(l,1);l.setAttribute(c,"");let p;for(;p=d.nextNode();)p.setAttribute(c,"")}a.insertBefore(l,s)}else for(;s.firstChild;)a.insertBefore(s.firstChild,s);a.removeChild(s)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}const Uo=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ct(e)?i=>ln(e,i):e},Tr=Symbol("_assign"),Bh={deep:!0,created(t,{value:e,modifiers:{number:i}},n){const s=sn(e);Io(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>i?Jr(Fn(o)):Fn(o));t[Tr](t.multiple?s?new Set(r):r:r[0]),t._assigning=!0,or(()=>{t._assigning=!1})}),t[Tr]=Uo(n)},mounted(t,{value:e}){Bo(t,e)},beforeUpdate(t,e,i){t[Tr]=Uo(i)},updated(t,{value:e}){t._assigning||Bo(t,e)}};function Bo(t,e){const i=t.multiple,n=ct(e);if(!(i&&!n&&!sn(e))){for(let s=0,r=t.options.length;s<r;s++){const o=t.options[s],a=Fn(o);if(i)if(n){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=xl(e,a)>-1}else o.selected=e.has(a);else if(cn(Fn(o),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!i&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Fn(t){return"_value"in t?t._value:t.value}const Hh=["ctrl","shift","alt","meta"],Vh={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Hh.some(i=>t[`${i}Key`]&&!e.includes(i))},we=(t,e)=>{const i=t._withMods||(t._withMods={}),n=e.join(".");return i[n]||(i[n]=(s,...r)=>{for(let o=0;o<e.length;o++){const a=Vh[e[o]];if(a&&a(s,e))return}return t(s,...r)})},zh=At({patchProp:Dh},Sh);let Ho;function Vo(){return Ho||(Ho=Hc(zh))}const qh=(...t)=>{Vo().render(...t)},zo=(...t)=>{const e=Vo().createApp(...t),{mount:i}=e;return e.mount=n=>{const s=Kh(n);if(!s)return;const r=e._component;!ht(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=i(s,!1,Wh(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function Wh(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Kh(t){return Rt(t)?document.querySelector(t):t}var qo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var In={exports:{}},gi={},Rr={},Er={},Wo;function ut(){return Wo||(Wo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function i(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof qo<"u"?qo:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.21",isBrowser:i(),isUnminified:/param/.test(function(s){}.toString()),dblClickWindow:400,getAngle(s){return t.Konva.angleDeg?s*e:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var s;return(s=t.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(s){t.glob.Konva=s}};const n=s=>{t.Konva[s.prototype.getClassName()]=s};t._registerNode=n,t.Konva._injectGlobal(t.Konva)}(Er)),Er}var Ar={},Ko;function Tt(){return Ko||(Ko=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=ut();class i{constructor(_=[1,0,0,1,0,0]){this.dirty=!1,this.m=_&&_.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new i(this.m)}copyInto(_){_.m[0]=this.m[0],_.m[1]=this.m[1],_.m[2]=this.m[2],_.m[3]=this.m[3],_.m[4]=this.m[4],_.m[5]=this.m[5]}point(_){const v=this.m;return{x:v[0]*_.x+v[2]*_.y+v[4],y:v[1]*_.x+v[3]*_.y+v[5]}}translate(_,v){return this.m[4]+=this.m[0]*_+this.m[2]*v,this.m[5]+=this.m[1]*_+this.m[3]*v,this}scale(_,v){return this.m[0]*=_,this.m[1]*=_,this.m[2]*=v,this.m[3]*=v,this}rotate(_){const v=Math.cos(_),R=Math.sin(_),I=this.m[0]*v+this.m[2]*R,w=this.m[1]*v+this.m[3]*R,C=this.m[0]*-R+this.m[2]*v,T=this.m[1]*-R+this.m[3]*v;return this.m[0]=I,this.m[1]=w,this.m[2]=C,this.m[3]=T,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(_,v){const R=this.m[0]+this.m[2]*v,I=this.m[1]+this.m[3]*v,w=this.m[2]+this.m[0]*_,C=this.m[3]+this.m[1]*_;return this.m[0]=R,this.m[1]=I,this.m[2]=w,this.m[3]=C,this}multiply(_){const v=this.m[0]*_.m[0]+this.m[2]*_.m[1],R=this.m[1]*_.m[0]+this.m[3]*_.m[1],I=this.m[0]*_.m[2]+this.m[2]*_.m[3],w=this.m[1]*_.m[2]+this.m[3]*_.m[3],C=this.m[0]*_.m[4]+this.m[2]*_.m[5]+this.m[4],T=this.m[1]*_.m[4]+this.m[3]*_.m[5]+this.m[5];return this.m[0]=v,this.m[1]=R,this.m[2]=I,this.m[3]=w,this.m[4]=C,this.m[5]=T,this}invert(){const _=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),v=this.m[3]*_,R=-this.m[1]*_,I=-this.m[2]*_,w=this.m[0]*_,C=_*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),T=_*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=v,this.m[1]=R,this.m[2]=I,this.m[3]=w,this.m[4]=C,this.m[5]=T,this}getMatrix(){return this.m}decompose(){const _=this.m[0],v=this.m[1],R=this.m[2],I=this.m[3],w=this.m[4],C=this.m[5],T=_*I-v*R,M={x:w,y:C,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(_!=0||v!=0){const D=Math.sqrt(_*_+v*v);M.rotation=v>0?Math.acos(_/D):-Math.acos(_/D),M.scaleX=D,M.scaleY=T/D,M.skewX=(_*R+v*I)/T,M.skewY=0}else if(R!=0||I!=0){const D=Math.sqrt(R*R+I*I);M.rotation=Math.PI/2-(I>0?Math.acos(-R/D):-Math.acos(R/D)),M.scaleX=T/D,M.scaleY=D,M.skewX=0,M.skewY=(_*R+v*I)/T}return M.rotation=t.Util._getRotation(M.rotation),M}}t.Transform=i;const n="[object Array]",s="[object Number]",r="[object String]",o="[object Boolean]",a=Math.PI/180,l=180/Math.PI,c="#",d="",p="0",g="Konva warning: ",u="Konva error: ",f="rgb(",y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let x=[];const m=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(h){setTimeout(h,60)};t.Util={_isElement(h){return!!(h&&h.nodeType==1)},_isFunction(h){return!!(h&&h.constructor&&h.call&&h.apply)},_isPlainObject(h){return!!h&&h.constructor===Object},_isArray(h){return Object.prototype.toString.call(h)===n},_isNumber(h){return Object.prototype.toString.call(h)===s&&!isNaN(h)&&isFinite(h)},_isString(h){return Object.prototype.toString.call(h)===r},_isBoolean(h){return Object.prototype.toString.call(h)===o},isObject(h){return h instanceof Object},isValidSelector(h){if(typeof h!="string")return!1;const _=h[0];return _==="#"||_==="."||_===_.toUpperCase()},_sign(h){return h===0||h>0?1:-1},requestAnimFrame(h){x.push(h),x.length===1&&m(function(){const _=x;x=[],_.forEach(function(v){v()})})},createCanvasElement(){const h=document.createElement("canvas");try{h.style=h.style||{}}catch{}return h},createImageElement(){return document.createElement("img")},_isInDocument(h){for(;h=h.parentNode;)if(h==document)return!0;return!1},_urlToImage(h,_){const v=t.Util.createImageElement();v.onload=function(){_(v)},v.src=h},_rgbToHex(h,_,v){return(16777216+(h<<16)+(_<<8)+v).toString(16).slice(1)},_hexToRgb(h){h=h.replace(c,d);const _=parseInt(h,16);return{r:_>>16&255,g:_>>8&255,b:_&255}},getRandomColor(){let h=(Math.random()*16777215<<0).toString(16);for(;h.length<6;)h=p+h;return c+h},getRGB(h){let _;return h in y?(_=y[h],{r:_[0],g:_[1],b:_[2]}):h[0]===c?this._hexToRgb(h.substring(1)):h.substr(0,4)===f?(_=S.exec(h.replace(/ /g,"")),{r:parseInt(_[1],10),g:parseInt(_[2],10),b:parseInt(_[3],10)}):{r:0,g:0,b:0}},colorToRGBA(h){return h=h||"black",t.Util._namedColorToRBA(h)||t.Util._hex3ColorToRGBA(h)||t.Util._hex4ColorToRGBA(h)||t.Util._hex6ColorToRGBA(h)||t.Util._hex8ColorToRGBA(h)||t.Util._rgbColorToRGBA(h)||t.Util._rgbaColorToRGBA(h)||t.Util._hslColorToRGBA(h)},_namedColorToRBA(h){const _=y[h.toLowerCase()];return _?{r:_[0],g:_[1],b:_[2],a:1}:null},_rgbColorToRGBA(h){if(h.indexOf("rgb(")===0){h=h.match(/rgb\(([^)]+)\)/)[1];const _=h.split(/ *, */).map(Number);return{r:_[0],g:_[1],b:_[2],a:1}}},_rgbaColorToRGBA(h){if(h.indexOf("rgba(")===0){h=h.match(/rgba\(([^)]+)\)/)[1];const _=h.split(/ *, */).map((v,R)=>v.slice(-1)==="%"?R===3?parseInt(v)/100:parseInt(v)/100*255:Number(v));return{r:_[0],g:_[1],b:_[2],a:_[3]}}},_hex8ColorToRGBA(h){if(h[0]==="#"&&h.length===9)return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16),a:parseInt(h.slice(7,9),16)/255}},_hex6ColorToRGBA(h){if(h[0]==="#"&&h.length===7)return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16),a:1}},_hex4ColorToRGBA(h){if(h[0]==="#"&&h.length===5)return{r:parseInt(h[1]+h[1],16),g:parseInt(h[2]+h[2],16),b:parseInt(h[3]+h[3],16),a:parseInt(h[4]+h[4],16)/255}},_hex3ColorToRGBA(h){if(h[0]==="#"&&h.length===4)return{r:parseInt(h[1]+h[1],16),g:parseInt(h[2]+h[2],16),b:parseInt(h[3]+h[3],16),a:1}},_hslColorToRGBA(h){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(h)){const[_,...v]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(h),R=Number(v[0])/360,I=Number(v[1])/100,w=Number(v[2])/100;let C,T,M;if(I===0)return M=w*255,{r:Math.round(M),g:Math.round(M),b:Math.round(M),a:1};w<.5?C=w*(1+I):C=w+I-w*I;const D=2*w-C,G=[0,0,0];for(let B=0;B<3;B++)T=R+.3333333333333333*-(B-1),T<0&&T++,T>1&&T--,6*T<1?M=D+(C-D)*6*T:2*T<1?M=C:3*T<2?M=D+(C-D)*(.6666666666666666-T)*6:M=D,G[B]=M*255;return{r:Math.round(G[0]),g:Math.round(G[1]),b:Math.round(G[2]),a:1}}},haveIntersection(h,_){return!(_.x>h.x+h.width||_.x+_.width<h.x||_.y>h.y+h.height||_.y+_.height<h.y)},cloneObject(h){const _={};for(const v in h)this._isPlainObject(h[v])?_[v]=this.cloneObject(h[v]):this._isArray(h[v])?_[v]=this.cloneArray(h[v]):_[v]=h[v];return _},cloneArray(h){return h.slice(0)},degToRad(h){return h*a},radToDeg(h){return h*l},_degToRad(h){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(h)},_radToDeg(h){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(h)},_getRotation(h){return e.Konva.angleDeg?t.Util.radToDeg(h):h},_capitalize(h){return h.charAt(0).toUpperCase()+h.slice(1)},throw(h){throw new Error(u+h)},error(h){console.error(u+h)},warn(h){e.Konva.showWarnings&&console.warn(g+h)},each(h,_){for(const v in h)_(v,h[v])},_inRange(h,_,v){return _<=h&&h<v},_getProjectionToSegment(h,_,v,R,I,w){let C,T,M;const D=(h-v)*(h-v)+(_-R)*(_-R);if(D==0)C=h,T=_,M=(I-v)*(I-v)+(w-R)*(w-R);else{const G=((I-h)*(v-h)+(w-_)*(R-_))/D;G<0?(C=h,T=_,M=(h-I)*(h-I)+(_-w)*(_-w)):G>1?(C=v,T=R,M=(v-I)*(v-I)+(R-w)*(R-w)):(C=h+G*(v-h),T=_+G*(R-_),M=(C-I)*(C-I)+(T-w)*(T-w))}return[C,T,M]},_getProjectionToLine(h,_,v){const R=t.Util.cloneObject(h);let I=Number.MAX_VALUE;return _.forEach(function(w,C){if(!v&&C===_.length-1)return;const T=_[(C+1)%_.length],M=t.Util._getProjectionToSegment(w.x,w.y,T.x,T.y,h.x,h.y),D=M[0],G=M[1],B=M[2];B<I&&(R.x=D,R.y=G,I=B)}),R},_prepareArrayForTween(h,_,v){const R=[],I=[];if(h.length>_.length){const C=_;_=h,h=C}for(let C=0;C<h.length;C+=2)R.push({x:h[C],y:h[C+1]});for(let C=0;C<_.length;C+=2)I.push({x:_[C],y:_[C+1]});const w=[];return I.forEach(function(C){const T=t.Util._getProjectionToLine(C,R,v);w.push(T.x),w.push(T.y)}),w},_prepareToStringify(h){let _;h.visitedByCircularReferenceRemoval=!0;for(const v in h)if(h.hasOwnProperty(v)&&h[v]&&typeof h[v]=="object"){if(_=Object.getOwnPropertyDescriptor(h,v),h[v].visitedByCircularReferenceRemoval||t.Util._isElement(h[v]))if(_.configurable)delete h[v];else return null;else if(t.Util._prepareToStringify(h[v])===null)if(_.configurable)delete h[v];else return null}return delete h.visitedByCircularReferenceRemoval,h},_assign(h,_){for(const v in _)h[v]=_[v];return h},_getFirstPointerId(h){return h.touches?h.changedTouches[0].identifier:h.pointerId||999},releaseCanvas(...h){e.Konva.releaseCanvasOnDestroy&&h.forEach(_=>{_.width=0,_.height=0})},drawRoundedRectPath(h,_,v,R){let I=0,w=0,C=0,T=0;typeof R=="number"?I=w=C=T=Math.min(R,_/2,v/2):(I=Math.min(R[0]||0,_/2,v/2),w=Math.min(R[1]||0,_/2,v/2),T=Math.min(R[2]||0,_/2,v/2),C=Math.min(R[3]||0,_/2,v/2)),h.moveTo(I,0),h.lineTo(_-w,0),h.arc(_-w,w,w,Math.PI*3/2,0,!1),h.lineTo(_,v-T),h.arc(_-T,v-T,T,0,Math.PI/2,!1),h.lineTo(C,v),h.arc(C,v-C,C,Math.PI/2,Math.PI,!1),h.lineTo(0,I),h.arc(I,I,I,Math.PI,Math.PI*3/2,!1)}}}(Ar)),Ar}var pi={},fe={},ge={},jo;function Yo(){if(jo)return ge;jo=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.HitContext=ge.SceneContext=ge.Context=void 0;const t=Tt(),e=ut();function i(x){const m=[],h=x.length,_=t.Util;for(let v=0;v<h;v++){let R=x[v];_._isNumber(R)?R=Math.round(R*1e3)/1e3:_._isString(R)||(R=R+""),m.push(R)}return m}const n=",",s="(",r=")",o="([",a="])",l=";",c="()",d="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],u=100;let f=class{constructor(m){this.canvas=m,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(m){m.fillEnabled()&&this._fill(m)}_fill(m){}strokeShape(m){m.hasStroke()&&this._stroke(m)}_stroke(m){}fillStrokeShape(m){m.attrs.fillAfterStrokeEnabled?(this.strokeShape(m),this.fillShape(m)):(this.fillShape(m),this.strokeShape(m))}getTrace(m,h){let _=this.traceArr,v=_.length,R="",I,w,C,T;for(I=0;I<v;I++)w=_[I],C=w.method,C?(T=w.args,R+=C,m?R+=c:t.Util._isArray(T[0])?R+=o+T.join(n)+a:(h&&(T=T.map(M=>typeof M=="number"?Math.floor(M):M)),R+=s+T.join(n)+r)):(R+=w.property,m||(R+=d+w.val)),R+=l;return R}clearTrace(){this.traceArr=[]}_trace(m){let h=this.traceArr,_;h.push(m),_=h.length,_>=u&&h.shift()}reset(){const m=this.getCanvas().getPixelRatio();this.setTransform(1*m,0,0,1*m,0,0)}getCanvas(){return this.canvas}clear(m){const h=this.getCanvas();m?this.clearRect(m.x||0,m.y||0,m.width||0,m.height||0):this.clearRect(0,0,h.getWidth()/h.pixelRatio,h.getHeight()/h.pixelRatio)}_applyLineCap(m){const h=m.attrs.lineCap;h&&this.setAttr("lineCap",h)}_applyOpacity(m){const h=m.getAbsoluteOpacity();h!==1&&this.setAttr("globalAlpha",h)}_applyLineJoin(m){const h=m.attrs.lineJoin;h&&this.setAttr("lineJoin",h)}setAttr(m,h){this._context[m]=h}arc(m,h,_,v,R,I){this._context.arc(m,h,_,v,R,I)}arcTo(m,h,_,v,R){this._context.arcTo(m,h,_,v,R)}beginPath(){this._context.beginPath()}bezierCurveTo(m,h,_,v,R,I){this._context.bezierCurveTo(m,h,_,v,R,I)}clearRect(m,h,_,v){this._context.clearRect(m,h,_,v)}clip(...m){this._context.clip.apply(this._context,m)}closePath(){this._context.closePath()}createImageData(m,h){const _=arguments;if(_.length===2)return this._context.createImageData(m,h);if(_.length===1)return this._context.createImageData(m)}createLinearGradient(m,h,_,v){return this._context.createLinearGradient(m,h,_,v)}createPattern(m,h){return this._context.createPattern(m,h)}createRadialGradient(m,h,_,v,R,I){return this._context.createRadialGradient(m,h,_,v,R,I)}drawImage(m,h,_,v,R,I,w,C,T){const M=arguments,D=this._context;M.length===3?D.drawImage(m,h,_):M.length===5?D.drawImage(m,h,_,v,R):M.length===9&&D.drawImage(m,h,_,v,R,I,w,C,T)}ellipse(m,h,_,v,R,I,w,C){this._context.ellipse(m,h,_,v,R,I,w,C)}isPointInPath(m,h,_,v){return _?this._context.isPointInPath(_,m,h,v):this._context.isPointInPath(m,h,v)}fill(...m){this._context.fill.apply(this._context,m)}fillRect(m,h,_,v){this._context.fillRect(m,h,_,v)}strokeRect(m,h,_,v){this._context.strokeRect(m,h,_,v)}fillText(m,h,_,v){v?this._context.fillText(m,h,_,v):this._context.fillText(m,h,_)}measureText(m){return this._context.measureText(m)}getImageData(m,h,_,v){return this._context.getImageData(m,h,_,v)}lineTo(m,h){this._context.lineTo(m,h)}moveTo(m,h){this._context.moveTo(m,h)}rect(m,h,_,v){this._context.rect(m,h,_,v)}roundRect(m,h,_,v,R){this._context.roundRect(m,h,_,v,R)}putImageData(m,h,_){this._context.putImageData(m,h,_)}quadraticCurveTo(m,h,_,v){this._context.quadraticCurveTo(m,h,_,v)}restore(){this._context.restore()}rotate(m){this._context.rotate(m)}save(){this._context.save()}scale(m,h){this._context.scale(m,h)}setLineDash(m){this._context.setLineDash?this._context.setLineDash(m):"mozDash"in this._context?this._context.mozDash=m:"webkitLineDash"in this._context&&(this._context.webkitLineDash=m)}getLineDash(){return this._context.getLineDash()}setTransform(m,h,_,v,R,I){this._context.setTransform(m,h,_,v,R,I)}stroke(m){m?this._context.stroke(m):this._context.stroke()}strokeText(m,h,_,v){this._context.strokeText(m,h,_,v)}transform(m,h,_,v,R,I){this._context.transform(m,h,_,v,R,I)}translate(m,h){this._context.translate(m,h)}_enableTrace(){let m=this,h=p.length,_=this.setAttr,v,R;const I=function(w){let C=m[w],T;m[w]=function(){return R=i(Array.prototype.slice.call(arguments,0)),T=C.apply(m,arguments),m._trace({method:w,args:R}),T}};for(v=0;v<h;v++)I(p[v]);m.setAttr=function(){_.apply(m,arguments);const w=arguments[0];let C=arguments[1];(w==="shadowOffsetX"||w==="shadowOffsetY"||w==="shadowBlur")&&(C=C/this.canvas.getPixelRatio()),m._trace({property:w,val:C})}}_applyGlobalCompositeOperation(m){const h=m.attrs.globalCompositeOperation;!h||h==="source-over"||this.setAttr("globalCompositeOperation",h)}};ge.Context=f,g.forEach(function(x){Object.defineProperty(f.prototype,x,{get(){return this._context[x]},set(m){this._context[x]=m}})});class y extends f{constructor(m,{willReadFrequently:h=!1}={}){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:h})}_fillColor(m){const h=m.fill();this.setAttr("fillStyle",h),m._fillFunc(this)}_fillPattern(m){this.setAttr("fillStyle",m._getFillPattern()),m._fillFunc(this)}_fillLinearGradient(m){const h=m._getLinearGradient();h&&(this.setAttr("fillStyle",h),m._fillFunc(this))}_fillRadialGradient(m){const h=m._getRadialGradient();h&&(this.setAttr("fillStyle",h),m._fillFunc(this))}_fill(m){const h=m.fill(),_=m.getFillPriority();if(h&&_==="color"){this._fillColor(m);return}const v=m.getFillPatternImage();if(v&&_==="pattern"){this._fillPattern(m);return}const R=m.getFillLinearGradientColorStops();if(R&&_==="linear-gradient"){this._fillLinearGradient(m);return}const I=m.getFillRadialGradientColorStops();if(I&&_==="radial-gradient"){this._fillRadialGradient(m);return}h?this._fillColor(m):v?this._fillPattern(m):R?this._fillLinearGradient(m):I&&this._fillRadialGradient(m)}_strokeLinearGradient(m){const h=m.getStrokeLinearGradientStartPoint(),_=m.getStrokeLinearGradientEndPoint(),v=m.getStrokeLinearGradientColorStops(),R=this.createLinearGradient(h.x,h.y,_.x,_.y);if(v){for(let I=0;I<v.length;I+=2)R.addColorStop(v[I],v[I+1]);this.setAttr("strokeStyle",R)}}_stroke(m){const h=m.dash(),_=m.getStrokeScaleEnabled();if(m.hasStroke()){if(!_){this.save();const R=this.getCanvas().getPixelRatio();this.setTransform(R,0,0,R,0,0)}this._applyLineCap(m),h&&m.dashEnabled()&&(this.setLineDash(h),this.setAttr("lineDashOffset",m.dashOffset())),this.setAttr("lineWidth",m.strokeWidth()),m.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),m.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(m):this.setAttr("strokeStyle",m.stroke()),m._strokeFunc(this),_||this.restore()}}_applyShadow(m){var h,_,v;const R=(h=m.getShadowRGBA())!==null&&h!==void 0?h:"black",I=(_=m.getShadowBlur())!==null&&_!==void 0?_:5,w=(v=m.getShadowOffset())!==null&&v!==void 0?v:{x:0,y:0},C=m.getAbsoluteScale(),T=this.canvas.getPixelRatio(),M=C.x*T,D=C.y*T;this.setAttr("shadowColor",R),this.setAttr("shadowBlur",I*Math.min(Math.abs(M),Math.abs(D))),this.setAttr("shadowOffsetX",w.x*M),this.setAttr("shadowOffsetY",w.y*D)}}ge.SceneContext=y;class S extends f{constructor(m){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:!0})}_fill(m){this.save(),this.setAttr("fillStyle",m.colorKey),m._fillFuncHit(this),this.restore()}strokeShape(m){m.hasHitStroke()&&this._stroke(m)}_stroke(m){if(m.hasHitStroke()){const h=m.getStrokeScaleEnabled();if(!h){this.save();const R=this.getCanvas().getPixelRatio();this.setTransform(R,0,0,R,0,0)}this._applyLineCap(m);const _=m.hitStrokeWidth(),v=_==="auto"?m.strokeWidth():_;this.setAttr("lineWidth",v),this.setAttr("strokeStyle",m.colorKey),m._strokeFuncHit(this),h||this.restore()}}}return ge.HitContext=S,ge}var Xo;function On(){if(Xo)return fe;Xo=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.HitCanvas=fe.SceneCanvas=fe.Canvas=void 0;const t=Tt(),e=Yo(),i=ut();let n;function s(){if(n)return n;const l=t.Util.createCanvasElement(),c=l.getContext("2d");return n=function(){const d=i.Konva._global.devicePixelRatio||1,p=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;return d/p}(),t.Util.releaseCanvas(l),n}let r=class{constructor(c){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const p=(c||{}).pixelRatio||i.Konva.pixelRatio||s();this.pixelRatio=p,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(c){const d=this.pixelRatio;this.pixelRatio=c,this.setSize(this.getWidth()/d,this.getHeight()/d)}setWidth(c){this.width=this._canvas.width=c*this.pixelRatio,this._canvas.style.width=c+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}setHeight(c){this.height=this._canvas.height=c*this.pixelRatio,this._canvas.style.height=c+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}getWidth(){return this.width}getHeight(){return this.height}setSize(c,d){this.setWidth(c||0),this.setHeight(d||0)}toDataURL(c,d){try{return this._canvas.toDataURL(c,d)}catch{try{return this._canvas.toDataURL()}catch(g){return t.Util.error("Unable to get data URL. "+g.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};fe.Canvas=r;class o extends r{constructor(c={width:0,height:0,willReadFrequently:!1}){super(c),this.context=new e.SceneContext(this,{willReadFrequently:c.willReadFrequently}),this.setSize(c.width,c.height)}}fe.SceneCanvas=o;class a extends r{constructor(c={width:0,height:0}){super(c),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(c.width,c.height)}}return fe.HitCanvas=a,fe}var Mr={},$o;function Nr(){return $o||($o=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=ut(),i=Tt();t.DD={get isDragging(){let n=!1;return t.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return t.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];t.DD._dragElements.forEach((r,o)=>{const{node:a}=r,l=a.getStage();l.setPointersPositions(n),r.pointerId===void 0&&(r.pointerId=i.Util._getFirstPointerId(n));const c=l._changedPointerPositions.find(d=>d.id===r.pointerId);if(c){if(r.dragStatus!=="dragging"){const d=a.dragDistance();if(Math.max(Math.abs(c.x-r.startPointerPos.x),Math.abs(c.y-r.startPointerPos.y))<d||(a.startDrag({evt:n}),!a.isDragging()))return}a._setDragPosition(n,r),s.push(a)}}),s.forEach(r=>{r.fire("dragmove",{type:"dragmove",target:r,evt:n},!0)})},_endDragBefore(n){const s=[];t.DD._dragElements.forEach(r=>{const{node:o}=r,a=o.getStage();if(n&&a.setPointersPositions(n),!a._changedPointerPositions.find(d=>d.id===r.pointerId))return;(r.dragStatus==="dragging"||r.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,r.dragStatus="stopped");const c=r.node.getLayer()||r.node instanceof e.Konva.Stage&&r.node;c&&s.indexOf(c)===-1&&s.push(c)}),s.forEach(r=>{r.draw()})},_endDragAfter(n){t.DD._dragElements.forEach((s,r)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&t.DD._dragElements.delete(r)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))}(Mr)),Mr}var kr={},Ht={},Qo;function gt(){if(Qo)return Ht;Qo=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.RGBComponent=n,Ht.alphaComponent=s,Ht.getNumberValidator=r,Ht.getNumberOrArrayOfNumbersValidator=o,Ht.getNumberOrAutoValidator=a,Ht.getStringValidator=l,Ht.getStringOrGradientValidator=c,Ht.getFunctionValidator=d,Ht.getNumberArrayValidator=p,Ht.getBooleanValidator=g,Ht.getComponentValidator=u;const t=ut(),e=Tt();function i(f){return e.Util._isString(f)?'"'+f+'"':Object.prototype.toString.call(f)==="[object Number]"||e.Util._isBoolean(f)?f:Object.prototype.toString.call(f)}function n(f){return f>255?255:f<0?0:Math.round(f)}function s(f){return f>1?1:f<1e-4?1e-4:f}function r(){if(t.Konva.isUnminified)return function(f,y){return e.Util._isNumber(f)||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a number.'),f}}function o(f){if(t.Konva.isUnminified)return function(y,S){let x=e.Util._isNumber(y),m=e.Util._isArray(y)&&y.length==f;return!x&&!m&&e.Util.warn(i(y)+' is a not valid value for "'+S+'" attribute. The value should be a number or Array<number>('+f+")"),y}}function a(){if(t.Konva.isUnminified)return function(f,y){return e.Util._isNumber(f)||f==="auto"||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a number or "auto".'),f}}function l(){if(t.Konva.isUnminified)return function(f,y){return e.Util._isString(f)||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a string.'),f}}function c(){if(t.Konva.isUnminified)return function(f,y){const S=e.Util._isString(f),x=Object.prototype.toString.call(f)==="[object CanvasGradient]"||f&&f.addColorStop;return S||x||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a string or a native gradient.'),f}}function d(){if(t.Konva.isUnminified)return function(f,y){return e.Util._isFunction(f)||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a function.'),f}}function p(){if(t.Konva.isUnminified)return function(f,y){const S=Int8Array?Object.getPrototypeOf(Int8Array):null;return S&&f instanceof S||(e.Util._isArray(f)?f.forEach(function(x){e.Util._isNumber(x)||e.Util.warn('"'+y+'" attribute has non numeric element '+x+". Make sure that all elements are numbers.")}):e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a array of numbers.')),f}}function g(){if(t.Konva.isUnminified)return function(f,y){return f===!0||f===!1||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a boolean.'),f}}function u(f){if(t.Konva.isUnminified)return function(y,S){return y==null||e.Util.isObject(y)||e.Util.warn(i(y)+' is a not valid value for "'+S+'" attribute. The value should be an object with properties '+f),y}}return Ht}var Jo;function ft(){return Jo||(Jo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Tt(),i=gt(),n="get",s="set";t.Factory={addGetterSetter(r,o,a,l,c){t.Factory.addGetter(r,o,a),t.Factory.addSetter(r,o,l,c),t.Factory.addOverloadedGetterSetter(r,o)},addGetter(r,o,a){const l=n+e.Util._capitalize(o);r.prototype[l]=r.prototype[l]||function(){const c=this.attrs[o];return c===void 0?a:c}},addSetter(r,o,a,l){const c=s+e.Util._capitalize(o);r.prototype[c]||t.Factory.overWriteSetter(r,o,a,l)},overWriteSetter(r,o,a,l){const c=s+e.Util._capitalize(o);r.prototype[c]=function(d){return a&&d!==void 0&&d!==null&&(d=a.call(this,d,o)),this._setAttr(o,d),l&&l.call(this),this}},addComponentsGetterSetter(r,o,a,l,c){const d=a.length,p=e.Util._capitalize,g=n+p(o),u=s+p(o);r.prototype[g]=function(){const y={};for(let S=0;S<d;S++){const x=a[S];y[x]=this.getAttr(o+p(x))}return y};const f=(0,i.getComponentValidator)(a);r.prototype[u]=function(y){const S=this.attrs[o];l&&(y=l.call(this,y,o)),f&&f.call(this,y,o);for(const x in y)y.hasOwnProperty(x)&&this._setAttr(o+p(x),y[x]);return y||a.forEach(x=>{this._setAttr(o+p(x),void 0)}),this._fireChangeEvent(o,S,y),c&&c.call(this),this},t.Factory.addOverloadedGetterSetter(r,o)},addOverloadedGetterSetter(r,o){const a=e.Util._capitalize(o),l=s+a,c=n+a;r.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(r,o,a,l){e.Util.error("Adding deprecated "+o);const c=n+e.Util._capitalize(o),d=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";r.prototype[c]=function(){e.Util.error(d);const p=this.attrs[o];return p===void 0?a:p},t.Factory.addSetter(r,o,l,function(){e.Util.error(d)}),t.Factory.addOverloadedGetterSetter(r,o)},backCompat(r,o){e.Util.each(o,function(a,l){const c=r.prototype[l],d=n+e.Util._capitalize(a),p=s+e.Util._capitalize(a);function g(){c.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}r.prototype[a]=g,r.prototype[d]=g,r.prototype[p]=g})},afterSetFilter(){this._filterUpToDate=!1}}}(kr)),kr}var Zo;function Et(){if(Zo)return pi;Zo=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Node=void 0;const t=On(),e=Nr(),i=ft(),n=ut(),s=Tt(),r=gt(),o="absoluteOpacity",a="allEventListeners",l="absoluteTransform",c="absoluteScale",d="canvas",p="Change",g="children",u="konva",f="listening",y="mouseenter",S="mouseleave",x="pointerenter",m="pointerleave",h="touchenter",_="touchleave",v="set",R="Shape",I=" ",w="stage",C="transform",T="Stage",M="visible",D=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(I);let G=1,B=class Kr{constructor(b){this._id=G++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(b),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(b){(b===C||b===l)&&this._cache.get(b)?this._cache.get(b).dirty=!0:b?this._cache.delete(b):this._cache.clear()}_getCache(b,P){let N=this._cache.get(b);return(N===void 0||(b===C||b===l)&&N.dirty===!0)&&(N=P.call(this),this._cache.set(b,N)),N}_calculate(b,P,N){if(!this._attachedDepsListeners.get(b)){const A=P.map(O=>O+"Change.konva").join(I);this.on(A,()=>{this._clearCache(b)}),this._attachedDepsListeners.set(b,!0)}return this._getCache(b,N)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(b){this._clearCache(b),b===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(d)){const{scene:b,filter:P,hit:N,buffer:A}=this._cache.get(d);s.Util.releaseCanvas(b,P,N,A),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(b){const P=b||{};let N={};(P.x===void 0||P.y===void 0||P.width===void 0||P.height===void 0)&&(N=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let A=Math.ceil(P.width||N.width),O=Math.ceil(P.height||N.height),q=P.pixelRatio,U=P.x===void 0?Math.floor(N.x):P.x,Q=P.y===void 0?Math.floor(N.y):P.y,et=P.offset||0,z=P.drawBorder||!1,k=P.hitCanvasPixelRatio||1;if(!A||!O){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const V=Math.abs(Math.round(N.x)-U)>.5?1:0,X=Math.abs(Math.round(N.y)-Q)>.5?1:0;A+=et*2+V,O+=et*2+X,U-=et,Q-=et;const j=new t.SceneCanvas({pixelRatio:q,width:A,height:O}),nt=new t.SceneCanvas({pixelRatio:q,width:0,height:0,willReadFrequently:!0}),E=new t.HitCanvas({pixelRatio:k,width:A,height:O}),F=j.getContext(),H=E.getContext(),W=new t.SceneCanvas({width:j.width/j.pixelRatio+Math.abs(U),height:j.height/j.pixelRatio+Math.abs(Q),pixelRatio:j.pixelRatio}),Y=W.getContext();return E.isCache=!0,j.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,P.imageSmoothingEnabled===!1&&(j.getContext()._context.imageSmoothingEnabled=!1,nt.getContext()._context.imageSmoothingEnabled=!1),F.save(),H.save(),Y.save(),F.translate(-U,-Q),H.translate(-U,-Q),Y.translate(-U,-Q),W.x=U,W.y=Q,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this.drawScene(j,this,W),this.drawHit(E,this),this._isUnderCache=!1,F.restore(),H.restore(),z&&(F.save(),F.beginPath(),F.rect(0,0,A,O),F.closePath(),F.setAttr("strokeStyle","red"),F.setAttr("lineWidth",5),F.stroke(),F.restore()),this._cache.set(d,{scene:j,filter:nt,hit:E,buffer:W,x:U,y:Q}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(b){throw new Error('abstract "getClientRect" method call')}_transformedRect(b,P){const N=[{x:b.x,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x+b.width,y:b.y+b.height},{x:b.x,y:b.y+b.height}];let A=1/0,O=1/0,q=-1/0,U=-1/0;const Q=this.getAbsoluteTransform(P);return N.forEach(function(et){const z=Q.point(et);A===void 0&&(A=q=z.x,O=U=z.y),A=Math.min(A,z.x),O=Math.min(O,z.y),q=Math.max(q,z.x),U=Math.max(U,z.y)}),{x:A,y:O,width:q-A,height:U-O}}_drawCachedSceneCanvas(b){b.save(),b._applyOpacity(this),b._applyGlobalCompositeOperation(this);const P=this._getCanvasCache();b.translate(P.x,P.y);const N=this._getCachedSceneCanvas(),A=N.pixelRatio;b.drawImage(N._canvas,0,0,N.width/A,N.height/A),b.restore()}_drawCachedHitCanvas(b){const P=this._getCanvasCache(),N=P.hit;b.save(),b.translate(P.x,P.y),b.drawImage(N._canvas,0,0,N.width/N.pixelRatio,N.height/N.pixelRatio),b.restore()}_getCachedSceneCanvas(){let b=this.filters(),P=this._getCanvasCache(),N=P.scene,A=P.filter,O=A.getContext(),q,U,Q,et;if(b){if(!this._filterUpToDate){const z=N.pixelRatio;A.setSize(N.width/N.pixelRatio,N.height/N.pixelRatio);try{for(q=b.length,O.clear(),O.drawImage(N._canvas,0,0,N.getWidth()/z,N.getHeight()/z),U=O.getImageData(0,0,A.getWidth(),A.getHeight()),Q=0;Q<q;Q++){if(et=b[Q],typeof et!="function"){s.Util.error("Filter should be type of function, but got "+typeof et+" instead. Please check correct filters");continue}et.call(this,U),O.putImageData(U,0,0)}}catch(k){s.Util.error("Unable to apply filter. "+k.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return A}return N}on(b,P){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const N=b.split(I);for(let A=0;A<N.length;A++){const q=N[A].split("."),U=q[0],Q=q[1]||"";this.eventListeners[U]||(this.eventListeners[U]=[]),this.eventListeners[U].push({name:Q,handler:P})}return this}off(b,P){let N=(b||"").split(I),A=N.length,O,q,U,Q,et,z;if(this._cache&&this._cache.delete(a),!b)for(q in this.eventListeners)this._off(q);for(O=0;O<A;O++)if(U=N[O],Q=U.split("."),et=Q[0],z=Q[1],et)this.eventListeners[et]&&this._off(et,z,P);else for(q in this.eventListeners)this._off(q,z,P);return this}dispatchEvent(b){const P={target:this,type:b.type,evt:b};return this.fire(b.type,P),this}addEventListener(b,P){return this.on(b,function(N){P.call(this,N.evt)}),this}removeEventListener(b){return this.off(b),this}_delegate(b,P,N){const A=this;this.on(b,function(O){const q=O.target.findAncestors(P,!0,A);for(let U=0;U<q.length;U++)O=s.Util.cloneObject(O),O.currentTarget=q[U],N.call(q[U],O)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(w),this._clearSelfAndDescendantCache(M),this._clearSelfAndDescendantCache(f)}_remove(){this._clearCaches();const b=this.getParent();b&&b.children&&(b.children.splice(this.index,1),b._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(b){const P="get"+s.Util._capitalize(b);return s.Util._isFunction(this[P])?this[P]():this.attrs[b]}getAncestors(){let b=this.getParent(),P=[];for(;b;)P.push(b),b=b.getParent();return P}getAttrs(){return this.attrs||{}}setAttrs(b){return this._batchTransformChanges(()=>{let P,N;if(!b)return this;for(P in b)P!==g&&(N=v+s.Util._capitalize(P),s.Util._isFunction(this[N])?this[N](b[P]):this._setAttr(P,b[P]))}),this}isListening(){return this._getCache(f,this._isListening)}_isListening(b){if(!this.listening())return!1;const N=this.getParent();return N&&N!==b&&this!==b?N._isListening(b):!0}isVisible(){return this._getCache(M,this._isVisible)}_isVisible(b){if(!this.visible())return!1;const N=this.getParent();return N&&N!==b&&this!==b?N._isVisible(b):!0}shouldDrawHit(b,P=!1){if(b)return this._isVisible(b)&&this._isListening(b);const N=this.getLayer();let A=!1;e.DD._dragElements.forEach(q=>{q.dragStatus==="dragging"&&(q.node.nodeType==="Stage"||q.node.getLayer()===N)&&(A=!0)});const O=!P&&!n.Konva.hitOnDragEnabled&&(A||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!O}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let b=this.getDepth(),P=this,N=0,A,O,q,U;function Q(z){for(A=[],O=z.length,q=0;q<O;q++)U=z[q],N++,U.nodeType!==R&&(A=A.concat(U.getChildren().slice())),U._id===P._id&&(q=O);A.length>0&&A[0].getDepth()<=b&&Q(A)}const et=this.getStage();return P.nodeType!==T&&et&&Q(et.getChildren()),N}getDepth(){let b=0,P=this.parent;for(;P;)b++,P=P.parent;return b}_batchTransformChanges(b){this._batchingTransformChange=!0,b(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(C),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(b){return this._batchTransformChanges(()=>{this.x(b.x),this.y(b.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const b=this.getStage();if(!b)return null;const P=b.getPointerPosition();if(!P)return null;const N=this.getAbsoluteTransform().copy();return N.invert(),N.point(P)}getAbsolutePosition(b){let P=!1,N=this.parent;for(;N;){if(N.isCached()){P=!0;break}N=N.parent}P&&!b&&(b=!0);const A=this.getAbsoluteTransform(b).getMatrix(),O=new s.Transform,q=this.offset();return O.m=A.slice(),O.translate(q.x,q.y),O.getTranslation()}setAbsolutePosition(b){const{x:P,y:N,...A}=this._clearTransform();this.attrs.x=P,this.attrs.y=N,this._clearCache(C);const O=this._getAbsoluteTransform().copy();return O.invert(),O.translate(b.x,b.y),b={x:this.attrs.x+O.getTranslation().x,y:this.attrs.y+O.getTranslation().y},this._setTransform(A),this.setPosition({x:b.x,y:b.y}),this._clearCache(C),this._clearSelfAndDescendantCache(l),this}_setTransform(b){let P;for(P in b)this.attrs[P]=b[P]}_clearTransform(){const b={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,b}move(b){let P=b.x,N=b.y,A=this.x(),O=this.y();return P!==void 0&&(A+=P),N!==void 0&&(O+=N),this.setPosition({x:A,y:O}),this}_eachAncestorReverse(b,P){let N=[],A=this.getParent(),O,q;if(!(P&&P._id===this._id)){for(N.unshift(this);A&&(!P||A._id!==P._id);)N.unshift(A),A=A.parent;for(O=N.length,q=0;q<O;q++)b(N[q])}}rotate(b){return this.rotation(this.rotation()+b),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const b=this.index,P=this.parent.getChildren().length;return b<P-1?(this.parent.children.splice(b,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const b=this.index,P=this.parent.getChildren().length;return b<P-1?(this.parent.children.splice(b,1),this.parent.children.splice(b+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const b=this.index;return b>0?(this.parent.children.splice(b,1),this.parent.children.splice(b-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const b=this.index;return b>0?(this.parent.children.splice(b,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(b){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(b<0||b>=this.parent.children.length)&&s.Util.warn("Unexpected value "+b+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const P=this.index;return this.parent.children.splice(P,1),this.parent.children.splice(b,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let b=this.opacity();const P=this.getParent();return P&&!P._isUnderCache&&(b*=P.getAbsoluteOpacity()),b}moveTo(b){return this.getParent()!==b&&(this._remove(),b.add(this)),this}toObject(){let b=this.getAttrs(),P,N,A,O,q;const U={attrs:{},className:this.getClassName()};for(P in b)N=b[P],q=s.Util.isObject(N)&&!s.Util._isPlainObject(N)&&!s.Util._isArray(N),!q&&(A=typeof this[P]=="function"&&this[P],delete b[P],O=A?A.call(this):null,b[P]=N,O!==N&&(U.attrs[P]=N));return s.Util._prepareToStringify(U)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(b,P,N){const A=[];P&&this._isMatch(b)&&A.push(this);let O=this.parent;for(;O;){if(O===N)return A;O._isMatch(b)&&A.push(O),O=O.parent}return A}isAncestorOf(b){return!1}findAncestor(b,P,N){return this.findAncestors(b,P,N)[0]}_isMatch(b){if(!b)return!1;if(typeof b=="function")return b(this);let P=b.replace(/ /g,"").split(","),N=P.length,A,O;for(A=0;A<N;A++)if(O=P[A],s.Util.isValidSelector(O)||(s.Util.warn('Selector "'+O+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),O.charAt(0)==="#"){if(this.id()===O.slice(1))return!0}else if(O.charAt(0)==="."){if(this.hasName(O.slice(1)))return!0}else if(this.className===O||this.nodeType===O)return!0;return!1}getLayer(){const b=this.getParent();return b?b.getLayer():null}getStage(){return this._getCache(w,this._getStage)}_getStage(){const b=this.getParent();return b?b.getStage():null}fire(b,P={},N){return P.target=P.target||this,N?this._fireAndBubble(b,P):this._fire(b,P),this}getAbsoluteTransform(b){return b?this._getAbsoluteTransform(b):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(b){let P;if(b)return P=new s.Transform,this._eachAncestorReverse(function(N){const A=N.transformsEnabled();A==="all"?P.multiply(N.getTransform()):A==="position"&&P.translate(N.x()-N.offsetX(),N.y()-N.offsetY())},b),P;{P=this._cache.get(l)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(P):P.reset();const N=this.transformsEnabled();if(N==="all")P.multiply(this.getTransform());else if(N==="position"){const A=this.attrs.x||0,O=this.attrs.y||0,q=this.attrs.offsetX||0,U=this.attrs.offsetY||0;P.translate(A-q,O-U)}return P.dirty=!1,P}}getAbsoluteScale(b){let P=this;for(;P;)P._isUnderCache&&(b=P),P=P.getParent();const A=this.getAbsoluteTransform(b).decompose();return{x:A.scaleX,y:A.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(C,this._getTransform)}_getTransform(){var b,P;const N=this._cache.get(C)||new s.Transform;N.reset();const A=this.x(),O=this.y(),q=n.Konva.getAngle(this.rotation()),U=(b=this.attrs.scaleX)!==null&&b!==void 0?b:1,Q=(P=this.attrs.scaleY)!==null&&P!==void 0?P:1,et=this.attrs.skewX||0,z=this.attrs.skewY||0,k=this.attrs.offsetX||0,V=this.attrs.offsetY||0;return(A!==0||O!==0)&&N.translate(A,O),q!==0&&N.rotate(q),(et!==0||z!==0)&&N.skew(et,z),(U!==1||Q!==1)&&N.scale(U,Q),(k!==0||V!==0)&&N.translate(-1*k,-1*V),N.dirty=!1,N}clone(b){let P=s.Util.cloneObject(this.attrs),N,A,O,q,U;for(N in b)P[N]=b[N];const Q=new this.constructor(P);for(N in this.eventListeners)for(A=this.eventListeners[N],O=A.length,q=0;q<O;q++)U=A[q],U.name.indexOf(u)<0&&(Q.eventListeners[N]||(Q.eventListeners[N]=[]),Q.eventListeners[N].push(U));return Q}_toKonvaCanvas(b){b=b||{};const P=this.getClientRect(),N=this.getStage(),A=b.x!==void 0?b.x:Math.floor(P.x),O=b.y!==void 0?b.y:Math.floor(P.y),q=b.pixelRatio||1,U=new t.SceneCanvas({width:b.width||Math.ceil(P.width)||(N?N.width():0),height:b.height||Math.ceil(P.height)||(N?N.height():0),pixelRatio:q}),Q=U.getContext(),et=new t.SceneCanvas({width:U.width/U.pixelRatio+Math.abs(A),height:U.height/U.pixelRatio+Math.abs(O),pixelRatio:U.pixelRatio});return b.imageSmoothingEnabled===!1&&(Q._context.imageSmoothingEnabled=!1),Q.save(),(A||O)&&Q.translate(-1*A,-1*O),this.drawScene(U,void 0,et),Q.restore(),U}toCanvas(b){return this._toKonvaCanvas(b)._canvas}toDataURL(b){b=b||{};const P=b.mimeType||null,N=b.quality||null,A=this._toKonvaCanvas(b).toDataURL(P,N);return b.callback&&b.callback(A),A}toImage(b){return new Promise((P,N)=>{try{const A=b?.callback;A&&delete b.callback,s.Util._urlToImage(this.toDataURL(b),function(O){P(O),A?.(O)})}catch(A){N(A)}})}toBlob(b){return new Promise((P,N)=>{try{const A=b?.callback;A&&delete b.callback,this.toCanvas(b).toBlob(O=>{P(O),A?.(O)},b?.mimeType,b?.quality)}catch(A){N(A)}})}setSize(b){return this.width(b.width),this.height(b.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(b,P,N){let A=this.eventListeners[b],O,q,U;for(O=0;O<A.length;O++)if(q=A[O].name,U=A[O].handler,(q!=="konva"||P==="konva")&&(!P||q===P)&&(!N||N===U)){if(A.splice(O,1),A.length===0){delete this.eventListeners[b];break}O--}}_fireChangeEvent(b,P,N){this._fire(b+p,{oldVal:P,newVal:N})}addName(b){if(!this.hasName(b)){const P=this.name(),N=P?P+" "+b:b;this.name(N)}return this}hasName(b){if(!b)return!1;const P=this.name();return P?(P||"").split(/\s/g).indexOf(b)!==-1:!1}removeName(b){const P=(this.name()||"").split(/\s/g),N=P.indexOf(b);return N!==-1&&(P.splice(N,1),this.name(P.join(" "))),this}setAttr(b,P){const N=this[v+s.Util._capitalize(b)];return s.Util._isFunction(N)?N.call(this,P):this._setAttr(b,P),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const b=this.getLayer()||this.getStage();b?.batchDraw()}}_setAttr(b,P){const N=this.attrs[b];N===P&&!s.Util.isObject(P)||(P==null?delete this.attrs[b]:this.attrs[b]=P,this._shouldFireChangeEvents&&this._fireChangeEvent(b,N,P),this._requestDraw())}_setComponentAttr(b,P,N){let A;N!==void 0&&(A=this.attrs[b],A||(this.attrs[b]=this.getAttr(b)),this.attrs[b][P]=N,this._fireChangeEvent(b,A,N))}_fireAndBubble(b,P,N){P&&this.nodeType===R&&(P.target=this);const A=[y,S,x,m,h,_];if(!(A.indexOf(b)!==-1&&(N&&(this===N||this.isAncestorOf&&this.isAncestorOf(N))||this.nodeType==="Stage"&&!N))){this._fire(b,P);const q=A.indexOf(b)!==-1&&N&&N.isAncestorOf&&N.isAncestorOf(this)&&!N.isAncestorOf(this.parent);(P&&!P.cancelBubble||!P)&&this.parent&&this.parent.isListening()&&!q&&(N&&N.parent?this._fireAndBubble.call(this.parent,b,P,N):this._fireAndBubble.call(this.parent,b,P))}}_getProtoListeners(b){var P,N,A;const O=(P=this._cache.get(a))!==null&&P!==void 0?P:{};let q=O?.[b];if(q===void 0){q=[];let U=Object.getPrototypeOf(this);for(;U;){const Q=(A=(N=U.eventListeners)===null||N===void 0?void 0:N[b])!==null&&A!==void 0?A:[];q.push(...Q),U=Object.getPrototypeOf(U)}O[b]=q,this._cache.set(a,O)}return q}_fire(b,P){P=P||{},P.currentTarget=this,P.type=b;const N=this._getProtoListeners(b);if(N)for(let O=0;O<N.length;O++)N[O].handler.call(this,P);const A=this.eventListeners[b];if(A)for(let O=0;O<A.length;O++)A[O].handler.call(this,P)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(b){const P=b?b.pointerId:void 0,N=this.getStage(),A=this.getAbsolutePosition();if(!N)return;const O=N._getPointerById(P)||N._changedPointerPositions[0]||A;e.DD._dragElements.set(this._id,{node:this,startPointerPos:O,offset:{x:O.x-A.x,y:O.y-A.y},dragStatus:"ready",pointerId:P})}startDrag(b,P=!0){e.DD._dragElements.has(this._id)||this._createDragElement(b);const N=e.DD._dragElements.get(this._id);N.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:b&&b.evt},P)}_setDragPosition(b,P){const N=this.getStage()._getPointerById(P.pointerId);if(!N)return;let A={x:N.x-P.offset.x,y:N.y-P.offset.y};const O=this.dragBoundFunc();if(O!==void 0){const q=O.call(this,A,b);q?A=q:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==A.x||this._lastPos.y!==A.y)&&(this.setAbsolutePosition(A),this._requestDraw()),this._lastPos=A}stopDrag(b){const P=e.DD._dragElements.get(this._id);P&&(P.dragStatus="stopped"),e.DD._endDragBefore(b),e.DD._endDragAfter(b)}setDraggable(b){this._setAttr("draggable",b),this._dragChange()}isDragging(){const b=e.DD._dragElements.get(this._id);return b?b.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(b){if(!(!(b.evt.button!==void 0)||n.Konva.dragButtons.indexOf(b.evt.button)>=0)||this.isDragging())return;let A=!1;e.DD._dragElements.forEach(O=>{this.isAncestorOf(O.node)&&(A=!0)}),A||this._createDragElement(b)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const P=e.DD._dragElements.get(this._id),N=P&&P.dragStatus==="dragging",A=P&&P.dragStatus==="ready";N?this.stopDrag():A&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(b={x:0,y:0}){const P=this.getStage();if(!P)return!1;const N={x:-b.x,y:-b.y,width:P.width()+2*b.x,height:P.height()+2*b.y};return s.Util.haveIntersection(N,this.getClientRect())}static create(b,P){return s.Util._isString(b)&&(b=JSON.parse(b)),this._createNode(b,P)}static _createNode(b,P){let N=Kr.prototype.getClassName.call(b),A=b.children,O,q,U;P&&(b.attrs.container=P),n.Konva[N]||(s.Util.warn('Can not find a node with class name "'+N+'". Fallback to "Shape".'),N="Shape");const Q=n.Konva[N];if(O=new Q(b.attrs),A)for(q=A.length,U=0;U<q;U++)O.add(Kr._createNode(A[U]));return O}};pi.Node=B,B.prototype.nodeType="Node",B.prototype._attrsAffectingSize=[],B.prototype.eventListeners={},B.prototype.on.call(B.prototype,D,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(C),this._clearSelfAndDescendantCache(l)}),B.prototype.on.call(B.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(M)}),B.prototype.on.call(B.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(f)}),B.prototype.on.call(B.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const L=i.Factory.addGetterSetter;return L(B,"zIndex"),L(B,"absolutePosition"),L(B,"position"),L(B,"x",0,(0,r.getNumberValidator)()),L(B,"y",0,(0,r.getNumberValidator)()),L(B,"globalCompositeOperation","source-over",(0,r.getStringValidator)()),L(B,"opacity",1,(0,r.getNumberValidator)()),L(B,"name","",(0,r.getStringValidator)()),L(B,"id","",(0,r.getStringValidator)()),L(B,"rotation",0,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(B,"scale",["x","y"]),L(B,"scaleX",1,(0,r.getNumberValidator)()),L(B,"scaleY",1,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(B,"skew",["x","y"]),L(B,"skewX",0,(0,r.getNumberValidator)()),L(B,"skewY",0,(0,r.getNumberValidator)()),i.Factory.addComponentsGetterSetter(B,"offset",["x","y"]),L(B,"offsetX",0,(0,r.getNumberValidator)()),L(B,"offsetY",0,(0,r.getNumberValidator)()),L(B,"dragDistance",void 0,(0,r.getNumberValidator)()),L(B,"width",0,(0,r.getNumberValidator)()),L(B,"height",0,(0,r.getNumberValidator)()),L(B,"listening",!0,(0,r.getBooleanValidator)()),L(B,"preventDefault",!0,(0,r.getBooleanValidator)()),L(B,"filters",void 0,function($){return this._filterUpToDate=!1,$}),L(B,"visible",!0,(0,r.getBooleanValidator)()),L(B,"transformsEnabled","all",(0,r.getStringValidator)()),L(B,"size"),L(B,"dragBoundFunc"),L(B,"draggable",!1,(0,r.getBooleanValidator)()),i.Factory.backCompat(B,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),pi}var mi={},ta;function Dn(){if(ta)return mi;ta=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.Container=void 0;const t=ft(),e=Et(),i=gt();let n=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(r){const o=this.children||[];return r?o.filter(r):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(r=>{r.parent=null,r.index=0,r.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(r=>{r.parent=null,r.index=0,r.destroy()}),this.children=[],this._requestDraw(),this}add(...r){if(r.length===0)return this;if(r.length>1){for(let a=0;a<r.length;a++)this.add(r[a]);return this}const o=r[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(r){return this._generalFind(r,!1)}findOne(r){const o=this._generalFind(r,!0);return o.length>0?o[0]:void 0}_generalFind(r,o){const a=[];return this._descendants(l=>{const c=l._isMatch(r);return c&&a.push(l),!!(c&&o)}),a}_descendants(r){let o=!1;const a=this.getChildren();for(const l of a){if(o=r(l),o)return!0;if(l.hasChildren()&&(o=l._descendants(r),o))return!0}return!1}toObject(){const r=e.Node.prototype.toObject.call(this);return r.children=[],this.getChildren().forEach(o=>{r.children.push(o.toObject())}),r}isAncestorOf(r){let o=r.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(r){const o=e.Node.prototype.clone.call(this,r);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(r){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(r)&&o.push(a)}),o}_clearSelfAndDescendantCache(r){var o;super._clearSelfAndDescendantCache(r),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(r)}))}_setChildrenIndices(){var r;(r=this.children)===null||r===void 0||r.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(r,o,a){const l=this.getLayer(),c=r||l&&l.getCanvas(),d=c&&c.getContext(),p=this._getCanvasCache(),g=p&&p.scene,u=c&&c.isCache;if(!this.isVisible()&&!u)return this;if(g){d.save();const f=this.getAbsoluteTransform(o).getMatrix();d.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(d),d.restore()}else this._drawChildren("drawScene",c,o,a);return this}drawHit(r,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),l=r||a&&a.hitCanvas,c=l&&l.getContext(),d=this._getCanvasCache();if(d&&d.hit){c.save();const g=this.getAbsoluteTransform(o).getMatrix();c.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",l,o);return this}_drawChildren(r,o,a,l){var c;const d=o&&o.getContext(),p=this.clipWidth(),g=this.clipHeight(),u=this.clipFunc(),f=typeof p=="number"&&typeof g=="number"||u,y=a===this;if(f){d.save();const x=this.getAbsoluteTransform(a);let m=x.getMatrix();d.transform(m[0],m[1],m[2],m[3],m[4],m[5]),d.beginPath();let h;if(u)h=u.call(this,d,this);else{const _=this.clipX(),v=this.clipY();d.rect(_||0,v||0,p,g)}d.clip.apply(d,h),m=x.copy().invert().getMatrix(),d.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const S=!y&&this.globalCompositeOperation()!=="source-over"&&r==="drawScene";S&&(d.save(),d._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(x){x[r](o,a,l)}),S&&d.restore(),f&&d.restore()}getClientRect(r={}){var o;const a=r.skipTransform,l=r.relativeTo;let c,d,p,g,u={x:1/0,y:1/0,width:0,height:0};const f=this;(o=this.children)===null||o===void 0||o.forEach(function(x){if(!x.visible())return;const m=x.getClientRect({relativeTo:f,skipShadow:r.skipShadow,skipStroke:r.skipStroke});m.width===0&&m.height===0||(c===void 0?(c=m.x,d=m.y,p=m.x+m.width,g=m.y+m.height):(c=Math.min(c,m.x),d=Math.min(d,m.y),p=Math.max(p,m.x+m.width),g=Math.max(g,m.y+m.height)))});const y=this.find("Shape");let S=!1;for(let x=0;x<y.length;x++)if(y[x]._isVisible(this)){S=!0;break}return S&&c!==void 0?u={x:c,y:d,width:p-c,height:g-d}:u={x:0,y:0,width:0,height:0},a?u:this._transformedRect(u,l)}};return mi.Container=n,t.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(n,"clipX",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipY",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipWidth",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipHeight",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipFunc"),mi}var Fr={},Ce={},ea;function ia(){if(ea)return Ce;ea=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.getCapturedShape=n,Ce.createEvent=s,Ce.hasPointerCapture=r,Ce.setPointerCapture=o,Ce.releaseCapture=a;const t=ut(),e=new Map,i=t.Konva._global.PointerEvent!==void 0;function n(l){return e.get(l)}function s(l){return{evt:l,pointerId:l.pointerId}}function r(l,c){return e.get(l)===c}function o(l,c){a(l),c.getStage()&&(e.set(l,c),i&&c._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function a(l,c){const d=e.get(l);if(!d)return;const p=d.getStage();p&&p.content,e.delete(l),i&&d._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return Ce}var na;function Yh(){return na||(na=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Tt(),i=ft(),n=Dn(),s=ut(),r=On(),o=Nr(),a=ut(),l=ia(),c="Stage",d="string",p="px",g="mouseout",u="mouseleave",f="mouseover",y="mouseenter",S="mousemove",x="mousedown",m="mouseup",h="pointermove",_="pointerdown",v="pointerup",R="pointercancel",I="lostpointercapture",w="pointerout",C="pointerleave",T="pointerover",M="pointerenter",D="contextmenu",G="touchstart",B="touchend",L="touchmove",$="touchcancel",b="wheel",P=5,N=[[y,"_pointerenter"],[x,"_pointerdown"],[S,"_pointermove"],[m,"_pointerup"],[u,"_pointerleave"],[G,"_pointerdown"],[L,"_pointermove"],[B,"_pointerup"],[$,"_pointercancel"],[f,"_pointerover"],[b,"_wheel"],[D,"_contextmenu"],[_,"_pointerdown"],[h,"_pointermove"],[v,"_pointerup"],[R,"_pointercancel"],[C,"_pointerleave"],[I,"_lostpointercapture"]],A={mouse:{[w]:g,[C]:u,[T]:f,[M]:y,[h]:S,[_]:x,[v]:m,[R]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[w]:"touchout",[C]:"touchleave",[T]:"touchover",[M]:"touchenter",[h]:L,[_]:G,[v]:B,[R]:$,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[w]:w,[C]:C,[T]:T,[M]:M,[h]:h,[_]:_,[v]:v,[R]:R,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},O=z=>z.indexOf("pointer")>=0?"pointer":z.indexOf("touch")>=0?"touch":"mouse",q=z=>{const k=O(z);if(k==="pointer")return s.Konva.pointerEventsEnabled&&A.pointer;if(k==="touch")return A.touch;if(k==="mouse")return A.mouse};function U(z={}){return(z.clipFunc||z.clipWidth||z.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),z}const Q="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class et extends n.Container{constructor(k){super(U(k)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{U(this.attrs)}),this._checkVisibility()}_validateAdd(k){const V=k.getType()==="Layer",X=k.getType()==="FastLayer";V||X||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const k=this.visible()?"":"none";this.content.style.display=k}setContainer(k){if(typeof k===d){let V;if(k.charAt(0)==="."){const X=k.slice(1);k=document.getElementsByClassName(X)[0]}else k.charAt(0)!=="#"?V=k:V=k.slice(1),k=document.getElementById(V);if(!k)throw"Can not find container in document with id "+V}return this._setAttr("container",k),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),k.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const k=this.children,V=k.length;for(let X=0;X<V;X++)k[X].clear();return this}clone(k){return k||(k={}),k.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,k)}destroy(){super.destroy();const k=this.content;k&&e.Util._isInDocument(k)&&this.container().removeChild(k);const V=t.stages.indexOf(this);return V>-1&&t.stages.splice(V,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const k=this._pointerPositions[0]||this._changedPointerPositions[0];return k?{x:k.x,y:k.y}:(e.Util.warn(Q),null)}_getPointerById(k){return this._pointerPositions.find(V=>V.id===k)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(k){k=k||{},k.x=k.x||0,k.y=k.y||0,k.width=k.width||this.width(),k.height=k.height||this.height();const V=new r.SceneCanvas({width:k.width,height:k.height,pixelRatio:k.pixelRatio||1}),X=V.getContext()._context,j=this.children;return(k.x||k.y)&&X.translate(-1*k.x,-1*k.y),j.forEach(function(nt){if(!nt.isVisible())return;const E=nt._toKonvaCanvas(k);X.drawImage(E._canvas,k.x,k.y,E.getWidth()/E.getPixelRatio(),E.getHeight()/E.getPixelRatio())}),V}getIntersection(k){if(!k)return null;const V=this.children,X=V.length,j=X-1;for(let nt=j;nt>=0;nt--){const E=V[nt].getIntersection(k);if(E)return E}return null}_resizeDOM(){const k=this.width(),V=this.height();this.content&&(this.content.style.width=k+p,this.content.style.height=V+p),this.bufferCanvas.setSize(k,V),this.bufferHitCanvas.setSize(k,V),this.children.forEach(X=>{X.setSize({width:k,height:V}),X.draw()})}add(k,...V){if(arguments.length>1){for(let j=0;j<arguments.length;j++)this.add(arguments[j]);return this}super.add(k);const X=this.children.length;return X>P&&e.Util.warn("The stage has "+X+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),k.setSize({width:this.width(),height:this.height()}),k.draw(),s.Konva.isBrowser&&this.content.appendChild(k.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(k){return l.hasPointerCapture(k,this)}setPointerCapture(k){l.setPointerCapture(k,this)}releaseCapture(k){l.releaseCapture(k,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&N.forEach(([k,V])=>{this.content.addEventListener(k,X=>{this[V](X)},{passive:!1})})}_pointerenter(k){this.setPointersPositions(k);const V=q(k.type);V&&this._fire(V.pointerenter,{evt:k,target:this,currentTarget:this})}_pointerover(k){this.setPointersPositions(k);const V=q(k.type);V&&this._fire(V.pointerover,{evt:k,target:this,currentTarget:this})}_getTargetShape(k){let V=this[k+"targetShape"];return V&&!V.getStage()&&(V=null),V}_pointerleave(k){const V=q(k.type),X=O(k.type);if(!V)return;this.setPointersPositions(k);const j=this._getTargetShape(X),nt=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;j&&nt?(j._fireAndBubble(V.pointerout,{evt:k}),j._fireAndBubble(V.pointerleave,{evt:k}),this._fire(V.pointerleave,{evt:k,target:this,currentTarget:this}),this[X+"targetShape"]=null):nt&&(this._fire(V.pointerleave,{evt:k,target:this,currentTarget:this}),this._fire(V.pointerout,{evt:k,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(k){const V=q(k.type),X=O(k.type);if(!V)return;this.setPointersPositions(k);let j=!1;this._changedPointerPositions.forEach(nt=>{const E=this.getIntersection(nt);if(o.DD.justDragged=!1,s.Konva["_"+X+"ListenClick"]=!0,!E||!E.isListening()){this[X+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&E.setPointerCapture(nt.id),this[X+"ClickStartShape"]=E,E._fireAndBubble(V.pointerdown,{evt:k,pointerId:nt.id}),j=!0;const F=k.type.indexOf("touch")>=0;E.preventDefault()&&k.cancelable&&F&&k.preventDefault()}),j||this._fire(V.pointerdown,{evt:k,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(k){const V=q(k.type),X=O(k.type);if(!V||(s.Konva.isDragging()&&o.DD.node.preventDefault()&&k.cancelable&&k.preventDefault(),this.setPointersPositions(k),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const nt={};let E=!1;const F=this._getTargetShape(X);this._changedPointerPositions.forEach(H=>{const W=l.getCapturedShape(H.id)||this.getIntersection(H),Y=H.id,K={evt:k,pointerId:Y},Z=F!==W;if(Z&&F&&(F._fireAndBubble(V.pointerout,{...K},W),F._fireAndBubble(V.pointerleave,{...K},W)),W){if(nt[W._id])return;nt[W._id]=!0}W&&W.isListening()?(E=!0,Z&&(W._fireAndBubble(V.pointerover,{...K},F),W._fireAndBubble(V.pointerenter,{...K},F),this[X+"targetShape"]=W),W._fireAndBubble(V.pointermove,{...K})):F&&(this._fire(V.pointerover,{evt:k,target:this,currentTarget:this,pointerId:Y}),this[X+"targetShape"]=null)}),E||this._fire(V.pointermove,{evt:k,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(k){const V=q(k.type),X=O(k.type);if(!V)return;this.setPointersPositions(k);const j=this[X+"ClickStartShape"],nt=this[X+"ClickEndShape"],E={};let F=!1;this._changedPointerPositions.forEach(H=>{const W=l.getCapturedShape(H.id)||this.getIntersection(H);if(W){if(W.releaseCapture(H.id),E[W._id])return;E[W._id]=!0}const Y=H.id,K={evt:k,pointerId:Y};let Z=!1;s.Konva["_"+X+"InDblClickWindow"]?(Z=!0,clearTimeout(this[X+"DblTimeout"])):o.DD.justDragged||(s.Konva["_"+X+"InDblClickWindow"]=!0,clearTimeout(this[X+"DblTimeout"])),this[X+"DblTimeout"]=setTimeout(function(){s.Konva["_"+X+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),W&&W.isListening()?(F=!0,this[X+"ClickEndShape"]=W,W._fireAndBubble(V.pointerup,{...K}),s.Konva["_"+X+"ListenClick"]&&j&&j===W&&(W._fireAndBubble(V.pointerclick,{...K}),Z&&nt&&nt===W&&W._fireAndBubble(V.pointerdblclick,{...K}))):(this[X+"ClickEndShape"]=null,s.Konva["_"+X+"ListenClick"]&&this._fire(V.pointerclick,{evt:k,target:this,currentTarget:this,pointerId:Y}),Z&&this._fire(V.pointerdblclick,{evt:k,target:this,currentTarget:this,pointerId:Y}))}),F||this._fire(V.pointerup,{evt:k,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+X+"ListenClick"]=!1,k.cancelable&&X!=="touch"&&X!=="pointer"&&k.preventDefault()}_contextmenu(k){this.setPointersPositions(k);const V=this.getIntersection(this.getPointerPosition());V&&V.isListening()?V._fireAndBubble(D,{evt:k}):this._fire(D,{evt:k,target:this,currentTarget:this})}_wheel(k){this.setPointersPositions(k);const V=this.getIntersection(this.getPointerPosition());V&&V.isListening()?V._fireAndBubble(b,{evt:k}):this._fire(b,{evt:k,target:this,currentTarget:this})}_pointercancel(k){this.setPointersPositions(k);const V=l.getCapturedShape(k.pointerId)||this.getIntersection(this.getPointerPosition());V&&V._fireAndBubble(v,l.createEvent(k)),l.releaseCapture(k.pointerId)}_lostpointercapture(k){l.releaseCapture(k.pointerId)}setPointersPositions(k){const V=this._getContentPosition();let X=null,j=null;k=k||window.event,k.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(k.touches,nt=>{this._pointerPositions.push({id:nt.identifier,x:(nt.clientX-V.left)/V.scaleX,y:(nt.clientY-V.top)/V.scaleY})}),Array.prototype.forEach.call(k.changedTouches||k.touches,nt=>{this._changedPointerPositions.push({id:nt.identifier,x:(nt.clientX-V.left)/V.scaleX,y:(nt.clientY-V.top)/V.scaleY})})):(X=(k.clientX-V.left)/V.scaleX,j=(k.clientY-V.top)/V.scaleY,this.pointerPos={x:X,y:j},this._pointerPositions=[{x:X,y:j,id:e.Util._getFirstPointerId(k)}],this._changedPointerPositions=[{x:X,y:j,id:e.Util._getFirstPointerId(k)}])}_setPointerPosition(k){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(k)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const k=this.content.getBoundingClientRect();return{top:k.top,left:k.left,scaleX:k.width/this.content.clientWidth||1,scaleY:k.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new r.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new r.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const k=this.container();if(!k)throw"Stage has no container. A container is required.";k.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),k.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(k){k.batchDraw()}),this}}t.Stage=et,et.prototype.nodeType=c,(0,a._registerNode)(et),i.Factory.addGetterSetter(et,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(z=>{z.batchDraw()})})}(Fr)),Fr}var _i={},Ir={},ra;function Mt(){return ra||(ra=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=ut(),i=Tt(),n=ft(),s=Et(),r=gt(),o=ut(),a=ia(),l="hasShadow",c="shadowRGBA",d="patternImage",p="linearGradient",g="radialGradient";let u;function f(){return u||(u=i.Util.createCanvasElement().getContext("2d"),u)}t.shapes={};function y(C){const T=this.attrs.fillRule;T?C.fill(T):C.fill()}function S(C){C.stroke()}function x(C){const T=this.attrs.fillRule;T?C.fill(T):C.fill()}function m(C){C.stroke()}function h(){this._clearCache(l)}function _(){this._clearCache(c)}function v(){this._clearCache(d)}function R(){this._clearCache(p)}function I(){this._clearCache(g)}class w extends s.Node{constructor(T){super(T);let M;for(;M=i.Util.getRandomColor(),!(M&&!(M in t.shapes)););this.colorKey=M,t.shapes[M]=this}getContext(){return i.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return i.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const M=f().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(M&&M.setTransform){const D=new i.Transform;D.translate(this.fillPatternX(),this.fillPatternY()),D.rotate(e.Konva.getAngle(this.fillPatternRotation())),D.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),D.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const G=D.getMatrix(),B=typeof DOMMatrix>"u"?{a:G[0],b:G[1],c:G[2],d:G[3],e:G[4],f:G[5]}:new DOMMatrix(G);M.setTransform(B)}return M}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const T=this.fillLinearGradientColorStops();if(T){const M=f(),D=this.fillLinearGradientStartPoint(),G=this.fillLinearGradientEndPoint(),B=M.createLinearGradient(D.x,D.y,G.x,G.y);for(let L=0;L<T.length;L+=2)B.addColorStop(T[L],T[L+1]);return B}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const T=this.fillRadialGradientColorStops();if(T){const M=f(),D=this.fillRadialGradientStartPoint(),G=this.fillRadialGradientEndPoint(),B=M.createRadialGradient(D.x,D.y,this.fillRadialGradientStartRadius(),G.x,G.y,this.fillRadialGradientEndRadius());for(let L=0;L<T.length;L+=2)B.addColorStop(T[L],T[L+1]);return B}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const T=i.Util.colorToRGBA(this.shadowColor());if(T)return"rgba("+T.r+","+T.g+","+T.b+","+T.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const T=this.hitStrokeWidth();return T==="auto"?this.hasStroke():this.strokeEnabled()&&!!T}intersects(T){const M=this.getStage();if(!M)return!1;const D=M.bufferHitCanvas;return D.getContext().clear(),this.drawHit(D,void 0,!0),D.context.getImageData(Math.round(T.x),Math.round(T.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(T){var M;if(!((M=this.attrs.perfectDrawEnabled)!==null&&M!==void 0?M:!0))return!1;const G=T||this.hasFill(),B=this.hasStroke(),L=this.getAbsoluteOpacity()!==1;if(G&&B&&L)return!0;const $=this.hasShadow(),b=this.shadowForStrokeEnabled();return!!(G&&B&&$&&b)}setStrokeHitEnabled(T){i.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),T?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const T=this.size();return{x:this._centroid?-T.width/2:0,y:this._centroid?-T.height/2:0,width:T.width,height:T.height}}getClientRect(T={}){let M=!1,D=this.getParent();for(;D;){if(D.isCached()){M=!0;break}D=D.getParent()}const G=T.skipTransform,B=T.relativeTo||M&&this.getStage()||void 0,L=this.getSelfRect(),b=!T.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,P=L.width+b,N=L.height+b,A=!T.skipShadow&&this.hasShadow(),O=A?this.shadowOffsetX():0,q=A?this.shadowOffsetY():0,U=P+Math.abs(O),Q=N+Math.abs(q),et=A&&this.shadowBlur()||0,z=U+et*2,k=Q+et*2,V={width:z,height:k,x:-(b/2+et)+Math.min(O,0)+L.x,y:-(b/2+et)+Math.min(q,0)+L.y};return G?V:this._transformedRect(V,B)}drawScene(T,M,D){const G=this.getLayer(),B=T||G.getCanvas(),L=B.getContext(),$=this._getCanvasCache(),b=this.getSceneFunc(),P=this.hasShadow();let N;const A=M===this;if(!this.isVisible()&&!A)return this;if($){L.save();const O=this.getAbsoluteTransform(M).getMatrix();return L.transform(O[0],O[1],O[2],O[3],O[4],O[5]),this._drawCachedSceneCanvas(L),L.restore(),this}if(!b)return this;if(L.save(),this._useBufferCanvas()){N=this.getStage();const O=D||N.bufferCanvas,q=O.getContext();q.clear(),q.save(),q._applyLineJoin(this);const U=this.getAbsoluteTransform(M).getMatrix();q.transform(U[0],U[1],U[2],U[3],U[4],U[5]),b.call(this,q,this),q.restore();const Q=O.pixelRatio;P&&L._applyShadow(this),L._applyOpacity(this),L._applyGlobalCompositeOperation(this),L.drawImage(O._canvas,O.x||0,O.y||0,O.width/Q,O.height/Q)}else{if(L._applyLineJoin(this),!A){const O=this.getAbsoluteTransform(M).getMatrix();L.transform(O[0],O[1],O[2],O[3],O[4],O[5]),L._applyOpacity(this),L._applyGlobalCompositeOperation(this)}P&&L._applyShadow(this),b.call(this,L,this)}return L.restore(),this}drawHit(T,M,D=!1){if(!this.shouldDrawHit(M,D))return this;const G=this.getLayer(),B=T||G.hitCanvas,L=B&&B.getContext(),$=this.hitFunc()||this.sceneFunc(),b=this._getCanvasCache(),P=b&&b.hit;if(this.colorKey||i.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),P){L.save();const A=this.getAbsoluteTransform(M).getMatrix();return L.transform(A[0],A[1],A[2],A[3],A[4],A[5]),this._drawCachedHitCanvas(L),L.restore(),this}if(!$)return this;if(L.save(),L._applyLineJoin(this),!(this===M)){const A=this.getAbsoluteTransform(M).getMatrix();L.transform(A[0],A[1],A[2],A[3],A[4],A[5])}return $.call(this,L,this),L.restore(),this}drawHitFromCache(T=0){const M=this._getCanvasCache(),D=this._getCachedSceneCanvas(),G=M.hit,B=G.getContext(),L=G.getWidth(),$=G.getHeight();B.clear(),B.drawImage(D._canvas,0,0,L,$);try{const b=B.getImageData(0,0,L,$),P=b.data,N=P.length,A=i.Util._hexToRgb(this.colorKey);for(let O=0;O<N;O+=4)P[O+3]>T?(P[O]=A.r,P[O+1]=A.g,P[O+2]=A.b,P[O+3]=255):P[O+3]=0;B.putImageData(b,0,0)}catch(b){i.Util.error("Unable to draw hit graph from cached scene canvas. "+b.message)}return this}hasPointerCapture(T){return a.hasPointerCapture(T,this)}setPointerCapture(T){a.setPointerCapture(T,this)}releaseCapture(T){a.releaseCapture(T,this)}}t.Shape=w,w.prototype._fillFunc=y,w.prototype._strokeFunc=S,w.prototype._fillFuncHit=x,w.prototype._strokeFuncHit=m,w.prototype._centroid=!1,w.prototype.nodeType="Shape",(0,o._registerNode)(w),w.prototype.eventListeners={},w.prototype.on.call(w.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",h),w.prototype.on.call(w.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),w.prototype.on.call(w.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",v),w.prototype.on.call(w.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",R),w.prototype.on.call(w.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",I),n.Factory.addGetterSetter(w,"stroke",void 0,(0,r.getStringOrGradientValidator)()),n.Factory.addGetterSetter(w,"strokeWidth",2,(0,r.getNumberValidator)()),n.Factory.addGetterSetter(w,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(w,"hitStrokeWidth","auto",(0,r.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(w,"strokeHitEnabled",!0,(0,r.getBooleanValidator)()),n.Factory.addGetterSetter(w,"perfectDrawEnabled",!0,(0,r.getBooleanValidator)()),n.Factory.addGetterSetter(w,"shadowForStrokeEnabled",!0,(0,r.getBooleanValidator)()),n.Factory.addGetterSetter(w,"lineJoin"),n.Factory.addGetterSetter(w,"lineCap"),n.Factory.addGetterSetter(w,"sceneFunc"),n.Factory.addGetterSetter(w,"hitFunc"),n.Factory.addGetterSetter(w,"dash"),n.Factory.addGetterSetter(w,"dashOffset",0,(0,r.getNumberValidator)()),n.Factory.addGetterSetter(w,"shadowColor",void 0,(0,r.getStringValidator)()),n.Factory.addGetterSetter(w,"shadowBlur",0,(0,r.getNumberValidator)()),n.Factory.addGetterSetter(w,"shadowOpacity",1,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(w,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(w,"shadowOffsetX",0,(0,r.getNumberValidator)()),n.Factory.addGetterSetter(w,"shadowOffsetY",0,(0,r.getNumberValidator)()),n.Factory.addGetterSetter(w,"fillPatternImage"),n.Factory.addGetterSetter(w,"fill",void 0,(0,r.getStringOrGradientValidator)()),n.Factory.addGetterSetter(w,"fillPatternX",0,(0,r.getNumberValidator)()),n.Factory.addGetterSetter(w,"fillPatternY",0,(0,r.getNumberValidator)()),n.Factory.addGetterSetter(w,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(w,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(w,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(w,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(w,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(w,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(w,"fillEnabled",!0),n.Factory.addGetterSetter(w,"strokeEnabled",!0),n.Factory.addGetterSetter(w,"shadowEnabled",!0),n.Factory.addGetterSetter(w,"dashEnabled",!0),n.Factory.addGetterSetter(w,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(w,"fillPriority","color"),n.Factory.addComponentsGetterSetter(w,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(w,"fillPatternOffsetX",0,(0,r.getNumberValidator)()),n.Factory.addGetterSetter(w,"fillPatternOffsetY",0,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(w,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(w,"fillPatternScaleX",1,(0,r.getNumberValidator)()),n.Factory.addGetterSetter(w,"fillPatternScaleY",1,(0,r.getNumberValidator)()),n.Factory.addComponentsGetterSetter(w,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(w,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(w,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(w,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(w,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(w,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(w,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(w,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(w,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(w,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(w,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(w,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(w,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(w,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(w,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(w,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(w,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(w,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(w,"fillPatternRotation",0),n.Factory.addGetterSetter(w,"fillRule",void 0,(0,r.getStringValidator)()),n.Factory.backCompat(w,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(Ir)),Ir}var sa;function oa(){if(sa)return _i;sa=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.Layer=void 0;const t=Tt(),e=Dn(),i=Et(),n=ft(),s=On(),r=gt(),o=Mt(),a=ut(),l="#",c="beforeDraw",d="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=p.length;let u=class extends e.Container{constructor(y){super(y),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(y){return this.getContext().clear(y),this.getHitCanvas().getContext().clear(y),this}setZIndex(y){super.setZIndex(y);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),y<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[y+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){i.Node.prototype.moveToTop.call(this);const y=this.getStage();return y&&y.content&&(y.content.removeChild(this.getNativeCanvasElement()),y.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!i.Node.prototype.moveUp.call(this))return!1;const S=this.getStage();return!S||!S.content?!1:(S.content.removeChild(this.getNativeCanvasElement()),this.index<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[this.index+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(i.Node.prototype.moveDown.call(this)){const y=this.getStage();if(y){const S=y.children;y.content&&(y.content.removeChild(this.getNativeCanvasElement()),y.content.insertBefore(this.getNativeCanvasElement(),S[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(i.Node.prototype.moveToBottom.call(this)){const y=this.getStage();if(y){const S=y.children;y.content&&(y.content.removeChild(this.getNativeCanvasElement()),y.content.insertBefore(this.getNativeCanvasElement(),S[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const y=this.getNativeCanvasElement();return i.Node.prototype.remove.call(this),y&&y.parentNode&&t.Util._isInDocument(y)&&y.parentNode.removeChild(y),this}getStage(){return this.parent}setSize({width:y,height:S}){return this.canvas.setSize(y,S),this.hitCanvas.setSize(y,S),this._setSmoothEnabled(),this}_validateAdd(y){const S=y.getType();S!=="Group"&&S!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(y){return y=y||{},y.width=y.width||this.getWidth(),y.height=y.height||this.getHeight(),y.x=y.x!==void 0?y.x:this.x(),y.y=y.y!==void 0?y.y:this.y(),i.Node.prototype._toKonvaCanvas.call(this,y)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(y){if(!this.isListening()||!this.isVisible())return null;let S=1,x=!1;for(;;){for(let m=0;m<g;m++){const h=p[m],_=this._getIntersection({x:y.x+h.x*S,y:y.y+h.y*S}),v=_.shape;if(v)return v;if(x=!!_.antialiased,!_.antialiased)break}if(x)S+=1;else return null}}_getIntersection(y){const S=this.hitCanvas.pixelRatio,x=this.hitCanvas.context.getImageData(Math.round(y.x*S),Math.round(y.y*S),1,1).data,m=x[3];if(m===255){const h=t.Util._rgbToHex(x[0],x[1],x[2]),_=o.shapes[l+h];return _?{shape:_}:{antialiased:!0}}else if(m>0)return{antialiased:!0};return{}}drawScene(y,S,x){const m=this.getLayer(),h=y||m&&m.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&h.getContext().clear(),e.Container.prototype.drawScene.call(this,h,S,x),this._fire(d,{node:this}),this}drawHit(y,S){const x=this.getLayer(),m=y||x&&x.hitCanvas;return x&&x.clearBeforeDraw()&&x.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,m,S),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(y){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(y)}getHitGraphEnabled(y){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const y=this.parent;!!this.hitCanvas._canvas.parentNode?y.content.removeChild(this.hitCanvas._canvas):y.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return _i.Layer=u,u.prototype.nodeType="Layer",(0,a._registerNode)(u),n.Factory.addGetterSetter(u,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(u,"clearBeforeDraw",!0),n.Factory.addGetterSetter(u,"hitGraphEnabled",!0,(0,r.getBooleanValidator)()),_i}var yi={},aa;function Xh(){if(aa)return yi;aa=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.FastLayer=void 0;const t=Tt(),e=oa(),i=ut();let n=class extends e.Layer{constructor(r){super(r),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return yi.FastLayer=n,n.prototype.nodeType="FastLayer",(0,i._registerNode)(n),yi}var bi={},la;function Or(){if(la)return bi;la=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.Group=void 0;const t=Tt(),e=Dn(),i=ut();let n=class extends e.Container{_validateAdd(r){const o=r.getType();o!=="Group"&&o!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return bi.Group=n,n.prototype.nodeType="Group",(0,i._registerNode)(n),bi}var vi={},ca;function Dr(){if(ca)return vi;ca=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.Animation=void 0;const t=ut(),e=Tt(),i=function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}}();let n=class Ye{constructor(r,o){this.id=Ye.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:i(),frameRate:0},this.func=r,this.setLayers(o)}setLayers(r){let o=[];return r&&(o=Array.isArray(r)?r:[r]),this.layers=o,this}getLayers(){return this.layers}addLayer(r){const o=this.layers,a=o.length;for(let l=0;l<a;l++)if(o[l]._id===r._id)return!1;return this.layers.push(r),!0}isRunning(){const o=Ye.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=i(),Ye._addAnimation(this),this}stop(){return Ye._removeAnimation(this),this}_updateFrameObject(r){this.frame.timeDiff=r-this.frame.lastTime,this.frame.lastTime=r,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(r){this.animations.push(r),this._handleAnimation()}static _removeAnimation(r){const o=r.id,a=this.animations,l=a.length;for(let c=0;c<l;c++)if(a[c].id===o){this.animations.splice(c,1);break}}static _runFrames(){const r={},o=this.animations;for(let a=0;a<o.length;a++){const l=o[a],c=l.layers,d=l.func;l._updateFrameObject(i());const p=c.length;let g;if(d?g=d.call(l,l.frame)!==!1:g=!0,!!g)for(let u=0;u<p;u++){const f=c[u];f._id!==void 0&&(r[f._id]=f)}}for(const a in r)r.hasOwnProperty(a)&&r[a].batchDraw()}static _animationLoop(){const r=Ye;r.animations.length?(r._runFrames(),e.Util.requestAnimFrame(r._animationLoop)):r.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return vi.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,vi}var Lr={},ha;function $h(){return ha||(ha=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Tt(),i=Dr(),n=Et(),s=ut(),r={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,l=3,c=["fill","stroke","shadowColor"];let d=0;class p{constructor(f,y,S,x,m,h,_){this.prop=f,this.propFunc=y,this.begin=x,this._pos=x,this.duration=h,this._change=0,this.prevPos=0,this.yoyo=_,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=S,this._change=m-this.begin,this.pause()}fire(f){const y=this[f];y&&y()}setTime(f){f>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():f<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=f,this.update())}getTime(){return this._time}setPosition(f){this.prevPos=this._pos,this.propFunc(f),this._pos=f}getPosition(f){return f===void 0&&(f=this._time),this.func(f,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(f){this.pause(),this._time=f,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const f=this.getTimer()-this._startTime;this.state===a?this.setTime(f):this.state===l&&this.setTime(this.duration-f)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(f){const y=this,S=f.node,x=S._id,m=f.easing||t.Easings.Linear,h=!!f.yoyo;let _,v;typeof f.duration>"u"?_=.3:f.duration===0?_=.001:_=f.duration,this.node=S,this._id=d++;const R=S.getLayer()||(S instanceof s.Konva.Stage?S.getLayers():null);R||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new i.Animation(function(){y.tween.onEnterFrame()},R),this.tween=new p(v,function(I){y._tweenFunc(I)},m,0,1,_*1e3,h),this._addListeners(),g.attrs[x]||(g.attrs[x]={}),g.attrs[x][this._id]||(g.attrs[x][this._id]={}),g.tweens[x]||(g.tweens[x]={});for(v in f)r[v]===void 0&&this._addAttr(v,f[v]);this.reset(),this.onFinish=f.onFinish,this.onReset=f.onReset,this.onUpdate=f.onUpdate}_addAttr(f,y){const S=this.node,x=S._id;let m,h,_,v,R;const I=g.tweens[x][f];I&&delete g.attrs[x][I][f];let w=S.getAttr(f);if(e.Util._isArray(y))if(m=[],h=Math.max(y.length,w.length),f==="points"&&y.length!==w.length&&(y.length>w.length?(v=w,w=e.Util._prepareArrayForTween(w,y,S.closed())):(_=y,y=e.Util._prepareArrayForTween(y,w,S.closed()))),f.indexOf("fill")===0)for(let C=0;C<h;C++)if(C%2===0)m.push(y[C]-w[C]);else{const T=e.Util.colorToRGBA(w[C]);R=e.Util.colorToRGBA(y[C]),w[C]=T,m.push({r:R.r-T.r,g:R.g-T.g,b:R.b-T.b,a:R.a-T.a})}else for(let C=0;C<h;C++)m.push(y[C]-w[C]);else c.indexOf(f)!==-1?(w=e.Util.colorToRGBA(w),R=e.Util.colorToRGBA(y),m={r:R.r-w.r,g:R.g-w.g,b:R.b-w.b,a:R.a-w.a}):m=y-w;g.attrs[x][this._id][f]={start:w,diff:m,end:y,trueEnd:_,trueStart:v},g.tweens[x][f]=this._id}_tweenFunc(f){const y=this.node,S=g.attrs[y._id][this._id];let x,m,h,_,v,R,I,w;for(x in S){if(m=S[x],h=m.start,_=m.diff,w=m.end,e.Util._isArray(h))if(v=[],I=Math.max(h.length,w.length),x.indexOf("fill")===0)for(R=0;R<I;R++)R%2===0?v.push((h[R]||0)+_[R]*f):v.push("rgba("+Math.round(h[R].r+_[R].r*f)+","+Math.round(h[R].g+_[R].g*f)+","+Math.round(h[R].b+_[R].b*f)+","+(h[R].a+_[R].a*f)+")");else for(R=0;R<I;R++)v.push((h[R]||0)+_[R]*f);else c.indexOf(x)!==-1?v="rgba("+Math.round(h.r+_.r*f)+","+Math.round(h.g+_.g*f)+","+Math.round(h.b+_.b*f)+","+(h.a+_.a*f)+")":v=h+_*f;y.setAttr(x,v)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const f=this.node,y=g.attrs[f._id][this._id];y.points&&y.points.trueEnd&&f.setAttr("points",y.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const f=this.node,y=g.attrs[f._id][this._id];y.points&&y.points.trueStart&&f.points(y.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(f){return this.tween.seek(f*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const f=this.node._id,y=this._id,S=g.tweens[f];this.pause(),this.anim&&this.anim.stop();for(const x in S)delete g.tweens[f][x];delete g.attrs[f][y],Object.keys(g.tweens[f]).length===0&&delete g.tweens[f],Object.keys(g.attrs[f]).length===0&&delete g.attrs[f]}}t.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(u){const f=u.onFinish;u.node=this,u.onFinish=function(){this.destroy(),f&&f()},new g(u).play()},t.Easings={BackEaseIn(u,f,y,S){return y*(u/=S)*u*(2.70158*u-1.70158)+f},BackEaseOut(u,f,y,S){return y*((u=u/S-1)*u*(2.70158*u+1.70158)+1)+f},BackEaseInOut(u,f,y,S){let x=1.70158;return(u/=S/2)<1?y/2*(u*u*(((x*=1.525)+1)*u-x))+f:y/2*((u-=2)*u*(((x*=1.525)+1)*u+x)+2)+f},ElasticEaseIn(u,f,y,S,x,m){let h=0;return u===0?f:(u/=S)===1?f+y:(m||(m=S*.3),!x||x<Math.abs(y)?(x=y,h=m/4):h=m/(2*Math.PI)*Math.asin(y/x),-(x*Math.pow(2,10*(u-=1))*Math.sin((u*S-h)*(2*Math.PI)/m))+f)},ElasticEaseOut(u,f,y,S,x,m){let h=0;return u===0?f:(u/=S)===1?f+y:(m||(m=S*.3),!x||x<Math.abs(y)?(x=y,h=m/4):h=m/(2*Math.PI)*Math.asin(y/x),x*Math.pow(2,-10*u)*Math.sin((u*S-h)*(2*Math.PI)/m)+y+f)},ElasticEaseInOut(u,f,y,S,x,m){let h=0;return u===0?f:(u/=S/2)===2?f+y:(m||(m=S*.44999999999999996),!x||x<Math.abs(y)?(x=y,h=m/4):h=m/(2*Math.PI)*Math.asin(y/x),u<1?-.5*(x*Math.pow(2,10*(u-=1))*Math.sin((u*S-h)*(2*Math.PI)/m))+f:x*Math.pow(2,-10*(u-=1))*Math.sin((u*S-h)*(2*Math.PI)/m)*.5+y+f)},BounceEaseOut(u,f,y,S){return(u/=S)<.36363636363636365?y*(7.5625*u*u)+f:u<.7272727272727273?y*(7.5625*(u-=.5454545454545454)*u+.75)+f:u<.9090909090909091?y*(7.5625*(u-=.8181818181818182)*u+.9375)+f:y*(7.5625*(u-=.9545454545454546)*u+.984375)+f},BounceEaseIn(u,f,y,S){return y-t.Easings.BounceEaseOut(S-u,0,y,S)+f},BounceEaseInOut(u,f,y,S){return u<S/2?t.Easings.BounceEaseIn(u*2,0,y,S)*.5+f:t.Easings.BounceEaseOut(u*2-S,0,y,S)*.5+y*.5+f},EaseIn(u,f,y,S){return y*(u/=S)*u+f},EaseOut(u,f,y,S){return-y*(u/=S)*(u-2)+f},EaseInOut(u,f,y,S){return(u/=S/2)<1?y/2*u*u+f:-y/2*(--u*(u-2)-1)+f},StrongEaseIn(u,f,y,S){return y*(u/=S)*u*u*u*u+f},StrongEaseOut(u,f,y,S){return y*((u=u/S-1)*u*u*u*u+1)+f},StrongEaseInOut(u,f,y,S){return(u/=S/2)<1?y/2*u*u*u*u*u+f:y/2*((u-=2)*u*u*u*u+2)+f},Linear(u,f,y,S){return y*u/S+f}}}(Lr)),Lr}var da;function Qh(){return da||(da=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=ut(),i=Tt(),n=Et(),s=Dn(),r=Yh(),o=oa(),a=Xh(),l=Or(),c=Nr(),d=Mt(),p=Dr(),g=$h(),u=Yo(),f=On();t.Konva=i.Util._assign(e.Konva,{Util:i.Util,Transform:i.Transform,Node:n.Node,Container:s.Container,Stage:r.Stage,stages:r.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:c.DD,Shape:d.Shape,shapes:d.shapes,Animation:p.Animation,Tween:g.Tween,Easings:g.Easings,Context:u.Context,Canvas:f.Canvas}),t.default=t.Konva}(Rr)),Rr}var Si={},ua;function Jh(){if(ua)return Si;ua=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.Arc=void 0;const t=ft(),e=Mt(),i=ut(),n=gt(),s=ut();let r=class extends e.Shape{_sceneFunc(a){const l=i.Konva.getAngle(this.angle()),c=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,c),a.arc(0,0,this.innerRadius(),l,0,!c),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),c=this.clockwise(),d=i.Konva.getAngle(c?360-this.angle():this.angle()),p=Math.cos(Math.min(d,Math.PI)),g=1,u=Math.sin(Math.min(Math.max(Math.PI,d),3*Math.PI/2)),f=Math.sin(Math.min(d,Math.PI/2)),y=p*(p>0?a:l),S=g*l,x=u*(u>0?a:l),m=f*(f>0?l:a);return{x:y,y:c?-1*m:x,width:S-y,height:m-x}}};return Si.Arc=r,r.prototype._centroid=!0,r.prototype.className="Arc",r.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"angle",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"clockwise",!1,(0,n.getBooleanValidator)()),Si}var wi={},Ci={},fa;function ga(){if(fa)return Ci;fa=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.Line=void 0;const t=ft(),e=ut(),i=Mt(),n=gt();function s(a,l,c,d,p,g,u){const f=Math.sqrt(Math.pow(c-a,2)+Math.pow(d-l,2)),y=Math.sqrt(Math.pow(p-c,2)+Math.pow(g-d,2)),S=u*f/(f+y),x=u*y/(f+y),m=c-S*(p-a),h=d-S*(g-l),_=c+x*(p-a),v=d+x*(g-l);return[m,h,_,v]}function r(a,l){const c=a.length,d=[];for(let p=2;p<c-2;p+=2){const g=s(a[p-2],a[p-1],a[p],a[p+1],a[p+2],a[p+3],l);isNaN(g[0])||(d.push(g[0]),d.push(g[1]),d.push(a[p]),d.push(a[p+1]),d.push(g[2]),d.push(g[3]))}return d}let o=class extends i.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const c=this.points(),d=c.length,p=this.tension(),g=this.closed(),u=this.bezier();if(!d)return;let f=0;if(l.beginPath(),l.moveTo(c[0],c[1]),p!==0&&d>4){const y=this.getTensionPoints(),S=y.length;for(f=g?0:4,g||l.quadraticCurveTo(y[0],y[1],y[2],y[3]);f<S-2;)l.bezierCurveTo(y[f++],y[f++],y[f++],y[f++],y[f++],y[f++]);g||l.quadraticCurveTo(y[S-2],y[S-1],c[d-2],c[d-1])}else if(u)for(f=2;f<d;)l.bezierCurveTo(c[f++],c[f++],c[f++],c[f++],c[f++],c[f++]);else for(f=2;f<d;f+=2)l.lineTo(c[f],c[f+1]);g?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():r(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),c=l.length,d=this.tension(),p=s(l[c-2],l[c-1],l[0],l[1],l[2],l[3],d),g=s(l[c-4],l[c-3],l[c-2],l[c-1],l[0],l[1],d),u=r(l,d);return[p[2],p[3]].concat(u).concat([g[0],g[1],l[c-2],l[c-1],g[2],g[3],p[0],p[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let c=l[0],d=l[0],p=l[1],g=l[1],u,f;for(let y=0;y<l.length/2;y++)u=l[y*2],f=l[y*2+1],c=Math.min(c,u),d=Math.max(d,u),p=Math.min(p,f),g=Math.max(g,f);return{x:c,y:p,width:d-c,height:g-p}}};return Ci.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),t.Factory.addGetterSetter(o,"closed",!1),t.Factory.addGetterSetter(o,"bezier",!1),t.Factory.addGetterSetter(o,"tension",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(o,"points",[],(0,n.getNumberArrayValidator)()),Ci}var xi={},Gr={},pa;function Zh(){return pa||(pa=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,l)=>{let c,d;const g=l/2;c=0;for(let u=0;u<20;u++)d=g*t.tValues[20][u]+g,c+=t.cValues[20][u]*n(o,a,d);return g*c};t.getCubicArcLength=e;const i=(o,a,l)=>{l===void 0&&(l=1);const c=o[0]-2*o[1]+o[2],d=a[0]-2*a[1]+a[2],p=2*o[1]-2*o[0],g=2*a[1]-2*a[0],u=4*(c*c+d*d),f=4*(c*p+d*g),y=p*p+g*g;if(u===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const S=f/(2*u),x=y/u,m=l+S,h=x-S*S,_=m*m+h>0?Math.sqrt(m*m+h):0,v=S*S+h>0?Math.sqrt(S*S+h):0,R=S+Math.sqrt(S*S+h)!==0?h*Math.log(Math.abs((m+_)/(S+v))):0;return Math.sqrt(u)/2*(m*_-S*v+R)};t.getQuadraticArcLength=i;function n(o,a,l){const c=s(1,l,o),d=s(1,l,a),p=c*c+d*d;return Math.sqrt(p)}const s=(o,a,l)=>{const c=l.length-1;let d,p;if(c===0)return 0;if(o===0){p=0;for(let g=0;g<=c;g++)p+=t.binomialCoefficients[c][g]*Math.pow(1-a,c-g)*Math.pow(a,g)*l[g];return p}else{d=new Array(c);for(let g=0;g<c;g++)d[g]=c*(l[g+1]-l[g]);return s(o-1,a,d)}},r=(o,a,l)=>{let c=1,d=o/a,p=(o-l(d))/a,g=0;for(;c>.001;){const u=l(d+p),f=Math.abs(o-u)/a;if(f<c)c=f,d+=p;else{const y=l(d-p),S=Math.abs(o-y)/a;S<c?(c=S,d-=p):p/=2}if(g++,g>500)break}return d};t.t2length=r}(Gr)),Gr}var ma;function Ur(){if(ma)return xi;ma=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.Path=void 0;const t=ft(),e=ut(),i=Mt(),n=Zh();let s=class Vt extends i.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Vt.parsePathData(this.data()),this.pathLength=Vt.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let l=!1;for(let c=0;c<a.length;c++){const d=a[c].command,p=a[c].points;switch(d){case"L":o.lineTo(p[0],p[1]);break;case"M":o.moveTo(p[0],p[1]);break;case"C":o.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":o.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":const g=p[0],u=p[1],f=p[2],y=p[3],S=p[4],x=p[5],m=p[6],h=p[7],_=f>y?f:y,v=f>y?1:f/y,R=f>y?y/f:1;o.translate(g,u),o.rotate(m),o.scale(v,R),o.arc(0,0,_,S,S+x,1-h),o.scale(1/v,1/R),o.rotate(-m),o.translate(-g,-u);break;case"z":l=!0,o.closePath();break}}!l&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],y=u.points[5],S=u.points[4]+y;let x=Math.PI/180;if(Math.abs(f-S)<x&&(x=Math.abs(f-S)),y<0)for(let m=f-x;m>S;m-=x){const h=Vt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],m,0);o.push(h.x,h.y)}else for(let m=f+x;m<S;m+=x){const h=Vt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],m,0);o.push(h.x,h.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const y=Vt.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);o.push(y.x,y.y)}else o=o.concat(u.points)});let a=o[0],l=o[0],c=o[1],d=o[1],p,g;for(let u=0;u<o.length/2;u++)p=o[u*2],g=o[u*2+1],isNaN(p)||(a=Math.min(a,p),l=Math.max(l,p)),isNaN(g)||(c=Math.min(c,g),d=Math.max(d,g));return{x:a,y:c,width:l-a,height:d-c}}getLength(){return this.pathLength}getPointAtLength(o){return Vt.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,l,c){return Math.sqrt((l-o)*(l-o)+(c-a)*(c-a))}static getPathLength(o){let a=0;for(let l=0;l<o.length;++l)a+=o[l].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let l,c=0,d=a.length;if(!d)return null;for(;c<d&&o>a[c].pathLength;)o-=a[c].pathLength,++c;if(c===d)return l=a[c-1].points.slice(-2),{x:l[0],y:l[1]};if(o<.01)return a[c].command==="M"?(l=a[c].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[c].start.x,y:a[c].start.y};const p=a[c],g=p.points;switch(p.command){case"L":return Vt.getPointOnLine(o,p.start.x,p.start.y,g[0],g[1]);case"C":return Vt.getPointOnCubicBezier((0,n.t2length)(o,Vt.getPathLength(a),_=>(0,n.getCubicArcLength)([p.start.x,g[0],g[2],g[4]],[p.start.y,g[1],g[3],g[5]],_)),p.start.x,p.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return Vt.getPointOnQuadraticBezier((0,n.t2length)(o,Vt.getPathLength(a),_=>(0,n.getQuadraticArcLength)([p.start.x,g[0],g[2]],[p.start.y,g[1],g[3]],_)),p.start.x,p.start.y,g[0],g[1],g[2],g[3]);case"A":const u=g[0],f=g[1],y=g[2],S=g[3],x=g[5],m=g[6];let h=g[4];return h+=x*o/p.pathLength,Vt.getPointOnEllipticalArc(u,f,y,S,h,m)}return null}static getPointOnLine(o,a,l,c,d,p,g){p=p??a,g=g??l;const u=this.getLineLength(a,l,c,d);if(u<1e-10)return{x:a,y:l};if(c===a)return{x:p,y:g+(d>l?o:-o)};const f=(d-l)/(c-a),y=Math.sqrt(o*o/(1+f*f))*(c<a?-1:1),S=f*y;if(Math.abs(g-l-f*(p-a))<1e-10)return{x:p+y,y:g+S};const x=((p-a)*(c-a)+(g-l)*(d-l))/(u*u),m=a+x*(c-a),h=l+x*(d-l),_=this.getLineLength(p,g,m,h),v=Math.sqrt(o*o-_*_),R=Math.sqrt(v*v/(1+f*f))*(c<a?-1:1),I=f*R;return{x:m+R,y:h+I}}static getPointOnCubicBezier(o,a,l,c,d,p,g,u,f){function y(v){return v*v*v}function S(v){return 3*v*v*(1-v)}function x(v){return 3*v*(1-v)*(1-v)}function m(v){return(1-v)*(1-v)*(1-v)}const h=u*y(o)+p*S(o)+c*x(o)+a*m(o),_=f*y(o)+g*S(o)+d*x(o)+l*m(o);return{x:h,y:_}}static getPointOnQuadraticBezier(o,a,l,c,d,p,g){function u(m){return m*m}function f(m){return 2*m*(1-m)}function y(m){return(1-m)*(1-m)}const S=p*u(o)+c*f(o)+a*y(o),x=g*u(o)+d*f(o)+l*y(o);return{x:S,y:x}}static getPointOnEllipticalArc(o,a,l,c,d,p){const g=Math.cos(p),u=Math.sin(p),f={x:l*Math.cos(d),y:c*Math.sin(d)};return{x:o+(f.x*g-f.y*u),y:a+(f.x*u+f.y*g)}}static parsePathData(o){if(!o)return[];let a=o;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let S=0;S<l.length;S++)a=a.replace(new RegExp(l[S],"g"),"|"+l[S]);const c=a.split("|"),d=[],p=[];let g=0,u=0;const f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let y;for(let S=1;S<c.length;S++){let x=c[S],m=x.charAt(0);for(x=x.slice(1),p.length=0;y=f.exec(x);)p.push(y[0]);const h=[];for(let _=0,v=p.length;_<v;_++){if(p[_]==="00"){h.push(0,0);continue}const R=parseFloat(p[_]);isNaN(R)?h.push(0):h.push(R)}for(;h.length>0&&!isNaN(h[0]);){let _="",v=[];const R=g,I=u;let w,C,T,M,D,G,B,L,$,b;switch(m){case"l":g+=h.shift(),u+=h.shift(),_="L",v.push(g,u);break;case"L":g=h.shift(),u=h.shift(),v.push(g,u);break;case"m":const P=h.shift(),N=h.shift();if(g+=P,u+=N,_="M",d.length>2&&d[d.length-1].command==="z"){for(let A=d.length-2;A>=0;A--)if(d[A].command==="M"){g=d[A].points[0]+P,u=d[A].points[1]+N;break}}v.push(g,u),m="l";break;case"M":g=h.shift(),u=h.shift(),_="M",v.push(g,u),m="L";break;case"h":g+=h.shift(),_="L",v.push(g,u);break;case"H":g=h.shift(),_="L",v.push(g,u);break;case"v":u+=h.shift(),_="L",v.push(g,u);break;case"V":u=h.shift(),_="L",v.push(g,u);break;case"C":v.push(h.shift(),h.shift(),h.shift(),h.shift()),g=h.shift(),u=h.shift(),v.push(g,u);break;case"c":v.push(g+h.shift(),u+h.shift(),g+h.shift(),u+h.shift()),g+=h.shift(),u+=h.shift(),_="C",v.push(g,u);break;case"S":C=g,T=u,w=d[d.length-1],w.command==="C"&&(C=g+(g-w.points[2]),T=u+(u-w.points[3])),v.push(C,T,h.shift(),h.shift()),g=h.shift(),u=h.shift(),_="C",v.push(g,u);break;case"s":C=g,T=u,w=d[d.length-1],w.command==="C"&&(C=g+(g-w.points[2]),T=u+(u-w.points[3])),v.push(C,T,g+h.shift(),u+h.shift()),g+=h.shift(),u+=h.shift(),_="C",v.push(g,u);break;case"Q":v.push(h.shift(),h.shift()),g=h.shift(),u=h.shift(),v.push(g,u);break;case"q":v.push(g+h.shift(),u+h.shift()),g+=h.shift(),u+=h.shift(),_="Q",v.push(g,u);break;case"T":C=g,T=u,w=d[d.length-1],w.command==="Q"&&(C=g+(g-w.points[0]),T=u+(u-w.points[1])),g=h.shift(),u=h.shift(),_="Q",v.push(C,T,g,u);break;case"t":C=g,T=u,w=d[d.length-1],w.command==="Q"&&(C=g+(g-w.points[0]),T=u+(u-w.points[1])),g+=h.shift(),u+=h.shift(),_="Q",v.push(C,T,g,u);break;case"A":M=h.shift(),D=h.shift(),G=h.shift(),B=h.shift(),L=h.shift(),$=g,b=u,g=h.shift(),u=h.shift(),_="A",v=this.convertEndpointToCenterParameterization($,b,g,u,B,L,M,D,G);break;case"a":M=h.shift(),D=h.shift(),G=h.shift(),B=h.shift(),L=h.shift(),$=g,b=u,g+=h.shift(),u+=h.shift(),_="A",v=this.convertEndpointToCenterParameterization($,b,g,u,B,L,M,D,G);break}d.push({command:_||m,points:v,start:{x:R,y:I},pathLength:this.calcLength(R,I,_||m,v)})}(m==="z"||m==="Z")&&d.push({command:"z",points:[],start:void 0,pathLength:0})}return d}static calcLength(o,a,l,c){let d,p,g,u;const f=Vt;switch(l){case"L":return f.getLineLength(o,a,c[0],c[1]);case"C":return(0,n.getCubicArcLength)([o,c[0],c[2],c[4]],[a,c[1],c[3],c[5]],1);case"Q":return(0,n.getQuadraticArcLength)([o,c[0],c[2]],[a,c[1],c[3]],1);case"A":d=0;const y=c[4],S=c[5],x=c[4]+S;let m=Math.PI/180;if(Math.abs(y-x)<m&&(m=Math.abs(y-x)),p=f.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],y,0),S<0)for(u=y-m;u>x;u-=m)g=f.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],u,0),d+=f.getLineLength(p.x,p.y,g.x,g.y),p=g;else for(u=y+m;u<x;u+=m)g=f.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],u,0),d+=f.getLineLength(p.x,p.y,g.x,g.y),p=g;return g=f.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],x,0),d+=f.getLineLength(p.x,p.y,g.x,g.y),d}return 0}static convertEndpointToCenterParameterization(o,a,l,c,d,p,g,u,f){const y=f*(Math.PI/180),S=Math.cos(y)*(o-l)/2+Math.sin(y)*(a-c)/2,x=-1*Math.sin(y)*(o-l)/2+Math.cos(y)*(a-c)/2,m=S*S/(g*g)+x*x/(u*u);m>1&&(g*=Math.sqrt(m),u*=Math.sqrt(m));let h=Math.sqrt((g*g*(u*u)-g*g*(x*x)-u*u*(S*S))/(g*g*(x*x)+u*u*(S*S)));d===p&&(h*=-1),isNaN(h)&&(h=0);const _=h*g*x/u,v=h*-u*S/g,R=(o+l)/2+Math.cos(y)*_-Math.sin(y)*v,I=(a+c)/2+Math.sin(y)*_+Math.cos(y)*v,w=function(L){return Math.sqrt(L[0]*L[0]+L[1]*L[1])},C=function(L,$){return(L[0]*$[0]+L[1]*$[1])/(w(L)*w($))},T=function(L,$){return(L[0]*$[1]<L[1]*$[0]?-1:1)*Math.acos(C(L,$))},M=T([1,0],[(S-_)/g,(x-v)/u]),D=[(S-_)/g,(x-v)/u],G=[(-1*S-_)/g,(-1*x-v)/u];let B=T(D,G);return C(D,G)<=-1&&(B=Math.PI),C(D,G)>=1&&(B=0),p===0&&B>0&&(B=B-2*Math.PI),p===1&&B<0&&(B=B+2*Math.PI),[R,I,g,u,M,B,y,p]}};return xi.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(s),t.Factory.addGetterSetter(s,"data"),xi}var _a;function td(){if(_a)return wi;_a=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.Arrow=void 0;const t=ft(),e=ga(),i=gt(),n=ut(),s=Ur();let r=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,c=this.points();let d=c;const p=this.tension()!==0&&c.length>4;p&&(d=this.getTensionPoints());const g=this.pointerLength(),u=c.length;let f,y;if(p){const m=[d[d.length-4],d[d.length-3],d[d.length-2],d[d.length-1],c[u-2],c[u-1]],h=s.Path.calcLength(d[d.length-4],d[d.length-3],"C",m),_=s.Path.getPointOnQuadraticBezier(Math.min(1,1-g/h),m[0],m[1],m[2],m[3],m[4],m[5]);f=c[u-2]-_.x,y=c[u-1]-_.y}else f=c[u-2]-c[u-4],y=c[u-1]-c[u-3];const S=(Math.atan2(y,f)+l)%l,x=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(c[u-2],c[u-1]),a.rotate(S),a.moveTo(0,0),a.lineTo(-g,x/2),a.lineTo(-g,-x/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(c[0],c[1]),p?(f=(d[0]+d[2])/2-c[0],y=(d[1]+d[3])/2-c[1]):(f=c[2]-c[0],y=c[3]-c[1]),a.rotate((Math.atan2(-y,-f)+l)%l),a.moveTo(0,0),a.lineTo(-g,x/2),a.lineTo(-g,-x/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return wi.Arrow=r,r.prototype.className="Arrow",(0,n._registerNode)(r),t.Factory.addGetterSetter(r,"pointerLength",10,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"pointerWidth",10,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"pointerAtBeginning",!1),t.Factory.addGetterSetter(r,"pointerAtEnding",!0),wi}var Pi={},ya;function ed(){if(ya)return Pi;ya=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.Circle=void 0;const t=ft(),e=Mt(),i=gt(),n=ut();let s=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}};return Pi.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,i.getNumberValidator)()),Pi}var Ti={},ba;function id(){if(ba)return Ti;ba=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.Ellipse=void 0;const t=ft(),e=Mt(),i=gt(),n=ut();let s=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),l=this.radiusY();o.beginPath(),o.save(),a!==l&&o.scale(1,l/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return Ti.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(s),t.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),t.Factory.addGetterSetter(s,"radiusX",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"radiusY",0,(0,i.getNumberValidator)()),Ti}var Ri={},va;function nd(){if(va)return Ri;va=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.Image=void 0;const t=Tt(),e=ft(),i=Mt(),n=ut(),s=gt();let r=class ul extends i.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),c=this.getHeight(),d=this.cornerRadius(),p=this.attrs.image;let g;if(p){const u=this.attrs.cropWidth,f=this.attrs.cropHeight;u&&f?g=[p,this.cropX(),this.cropY(),u,f,0,0,l,c]:g=[p,0,0,l,c]}(this.hasFill()||this.hasStroke()||d)&&(a.beginPath(),d?t.Util.drawRoundedRectPath(a,l,c,d):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)),p&&(d&&a.clip(),a.drawImage.apply(a,g))}_hitFunc(a){const l=this.width(),c=this.height(),d=this.cornerRadius();a.beginPath(),d?t.Util.drawRoundedRectPath(a,l,c,d):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,c=null){const d=t.Util.createImageElement();d.onload=function(){const p=new ul({image:d});l(p)},d.onerror=c,d.crossOrigin="Anonymous",d.src=a}};return Ri.Image=r,r.prototype.className="Image",(0,n._registerNode)(r),e.Factory.addGetterSetter(r,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(r,"image"),e.Factory.addComponentsGetterSetter(r,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(r,"cropX",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropY",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropWidth",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(r,"cropHeight",0,(0,s.getNumberValidator)()),Ri}var ke={},Sa;function rd(){if(Sa)return ke;Sa=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.Tag=ke.Label=void 0;const t=ft(),e=Mt(),i=Or(),n=gt(),s=ut(),r=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",l="up",c="right",d="down",p="left",g=r.length;let u=class extends i.Group{constructor(S){super(S),this.on("add.konva",function(x){this._addListeners(x.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(S){let x=this,m;const h=function(){x._sync()};for(m=0;m<g;m++)S.on(r[m]+o,h)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let S=this.getText(),x=this.getTag(),m,h,_,v,R,I,w;if(S&&x){switch(m=S.width(),h=S.height(),_=x.pointerDirection(),v=x.pointerWidth(),w=x.pointerHeight(),R=0,I=0,_){case l:R=m/2,I=-1*w;break;case c:R=m+v,I=h/2;break;case d:R=m/2,I=h+w;break;case p:R=-1*v,I=h/2;break}x.setAttrs({x:-1*R,y:-1*I,width:m,height:h}),S.setAttrs({x:-1*R,y:-1*I})}}};ke.Label=u,u.prototype.className="Label",(0,s._registerNode)(u);class f extends e.Shape{_sceneFunc(S){const x=this.width(),m=this.height(),h=this.pointerDirection(),_=this.pointerWidth(),v=this.pointerHeight(),R=this.cornerRadius();let I=0,w=0,C=0,T=0;typeof R=="number"?I=w=C=T=Math.min(R,x/2,m/2):(I=Math.min(R[0]||0,x/2,m/2),w=Math.min(R[1]||0,x/2,m/2),T=Math.min(R[2]||0,x/2,m/2),C=Math.min(R[3]||0,x/2,m/2)),S.beginPath(),S.moveTo(I,0),h===l&&(S.lineTo((x-_)/2,0),S.lineTo(x/2,-1*v),S.lineTo((x+_)/2,0)),S.lineTo(x-w,0),S.arc(x-w,w,w,Math.PI*3/2,0,!1),h===c&&(S.lineTo(x,(m-v)/2),S.lineTo(x+_,m/2),S.lineTo(x,(m+v)/2)),S.lineTo(x,m-T),S.arc(x-T,m-T,T,0,Math.PI/2,!1),h===d&&(S.lineTo((x+_)/2,m),S.lineTo(x/2,m+v),S.lineTo((x-_)/2,m)),S.lineTo(C,m),S.arc(C,m-C,C,Math.PI/2,Math.PI,!1),h===p&&(S.lineTo(0,(m+v)/2),S.lineTo(-1*_,m/2),S.lineTo(0,(m-v)/2)),S.lineTo(0,I),S.arc(I,I,I,Math.PI,Math.PI*3/2,!1),S.closePath(),S.fillStrokeShape(this)}getSelfRect(){let S=0,x=0,m=this.pointerWidth(),h=this.pointerHeight(),_=this.pointerDirection(),v=this.width(),R=this.height();return _===l?(x-=h,R+=h):_===d?R+=h:_===p?(S-=m*1.5,v+=m):_===c&&(v+=m*1.5),{x:S,y:x,width:v,height:R}}}return ke.Tag=f,f.prototype.className="Tag",(0,s._registerNode)(f),t.Factory.addGetterSetter(f,"pointerDirection",a),t.Factory.addGetterSetter(f,"pointerWidth",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(f,"pointerHeight",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(f,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),ke}var Ei={},wa;function Ca(){if(wa)return Ei;wa=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.Rect=void 0;const t=ft(),e=Mt(),i=ut(),n=Tt(),s=gt();let r=class extends e.Shape{_sceneFunc(a){const l=this.cornerRadius(),c=this.width(),d=this.height();a.beginPath(),l?n.Util.drawRoundedRectPath(a,c,d,l):a.rect(0,0,c,d),a.closePath(),a.fillStrokeShape(this)}};return Ei.Rect=r,r.prototype.className="Rect",(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),Ei}var Ai={},xa;function sd(){if(xa)return Ai;xa=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.RegularPolygon=void 0;const t=ft(),e=Mt(),i=gt(),n=ut();let s=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)o.lineTo(a[l].x,a[l].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let c=0;c<o;c++)l.push({x:a*Math.sin(c*2*Math.PI/o),y:-1*a*Math.cos(c*2*Math.PI/o)});return l}getSelfRect(){const o=this._getPoints();let a=o[0].x,l=o[0].y,c=o[0].x,d=o[0].y;return o.forEach(p=>{a=Math.min(a,p.x),l=Math.max(l,p.x),c=Math.min(c,p.y),d=Math.max(d,p.y)}),{x:a,y:c,width:l-a,height:d-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return Ai.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"sides",0,(0,i.getNumberValidator)()),Ai}var Mi={},Pa;function od(){if(Pa)return Mi;Pa=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.Ring=void 0;const t=ft(),e=Mt(),i=gt(),n=ut(),s=Math.PI*2;let r=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,s,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),s,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return Mi.Ring=r,r.prototype.className="Ring",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(r),t.Factory.addGetterSetter(r,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,i.getNumberValidator)()),Mi}var Ni={},Ta;function ad(){if(Ta)return Ni;Ta=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.Sprite=void 0;const t=ft(),e=Mt(),i=Dr(),n=gt(),s=ut();let r=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new i.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),c=this.frameIndex(),d=c*4,p=this.animations()[l],g=this.frameOffsets(),u=p[d+0],f=p[d+1],y=p[d+2],S=p[d+3],x=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,y,S),a.closePath(),a.fillStrokeShape(this)),x)if(g){const m=g[l],h=c*2;a.drawImage(x,u,f,y,S,m[h+0],m[h+1],y,S)}else a.drawImage(x,u,f,y,S,0,0,y,S)}_hitFunc(a){const l=this.animation(),c=this.frameIndex(),d=c*4,p=this.animations()[l],g=this.frameOffsets(),u=p[d+2],f=p[d+3];if(a.beginPath(),g){const y=g[l],S=c*2;a.rect(y[S+0],y[S+1],u,f)}else a.rect(0,0,u,f);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),c=this.animations(),d=c[l],p=d.length/4;a<p-1?this.frameIndex(a+1):this.frameIndex(0)}};return Ni.Sprite=r,r.prototype.className="Sprite",(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"animation"),t.Factory.addGetterSetter(r,"animations"),t.Factory.addGetterSetter(r,"frameOffsets"),t.Factory.addGetterSetter(r,"image"),t.Factory.addGetterSetter(r,"frameIndex",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"frameRate",17,(0,n.getNumberValidator)()),t.Factory.backCompat(r,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Ni}var ki={},Ra;function ld(){if(Ra)return ki;Ra=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.Star=void 0;const t=ft(),e=Mt(),i=gt(),n=ut();let s=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),l=this.outerRadius(),c=this.numPoints();o.beginPath(),o.moveTo(0,0-l);for(let d=1;d<c*2;d++){const p=d%2===0?l:a,g=p*Math.sin(d*Math.PI/c),u=-1*p*Math.cos(d*Math.PI/c);o.lineTo(g,u)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return ki.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(s),t.Factory.addGetterSetter(s,"numPoints",5,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,i.getNumberValidator)()),ki}var ze={},Ea;function Aa(){if(Ea)return ze;Ea=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.Text=void 0,ze.stringToArray=o;const t=Tt(),e=ft(),i=Mt(),n=ut(),s=gt(),r=ut();function o(q){return[...q].reduce((U,Q,et,z)=>{if(/\p{Emoji}/u.test(Q)){const k=z[et+1];k&&/\p{Emoji_Modifier}|\u200D/u.test(k)?(U.push(Q+k),z[et+1]=""):U.push(Q)}else/\p{Regional_Indicator}{2}/u.test(Q+(z[et+1]||""))?U.push(Q+z[et+1]):et>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(Q)?U[U.length-1]+=Q:Q&&U.push(Q);return U},[])}const a="auto",l="center",c="inherit",d="justify",p="Change.konva",g="2d",u="-",f="left",y="text",S="Text",x="top",m="bottom",h="middle",_="normal",v="px ",R=" ",I="right",w="rtl",C="word",T="char",M="none",D="…",G=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],B=G.length;function L(q){return q.split(",").map(U=>{U=U.trim();const Q=U.indexOf(" ")>=0,et=U.indexOf('"')>=0||U.indexOf("'")>=0;return Q&&!et&&(U=`"${U}"`),U}).join(", ")}let $;function b(){return $||($=t.Util.createCanvasElement().getContext(g),$)}function P(q){q.fillText(this._partialText,this._partialTextX,this._partialTextY)}function N(q){q.setAttr("miterLimit",2),q.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function A(q){return q=q||{},!q.fillLinearGradientColorStops&&!q.fillRadialGradientColorStops&&!q.fillPatternImage&&(q.fill=q.fill||"black"),q}let O=class extends i.Shape{constructor(U){super(A(U)),this._partialTextX=0,this._partialTextY=0;for(let Q=0;Q<B;Q++)this.on(G[Q]+p,this._setTextData);this._setTextData()}_sceneFunc(U){const Q=this.textArr,et=Q.length;if(!this.text())return;let z=this.padding(),k=this.fontSize(),V=this.lineHeight()*k,X=this.verticalAlign(),j=this.direction(),nt=0,E=this.align(),F=this.getWidth(),H=this.letterSpacing(),W=this.fill(),Y=this.textDecoration(),K=Y.indexOf("underline")!==-1,Z=Y.indexOf("line-through")!==-1,it;j=j===c?U.direction:j;let tt=V/2,J=h;if(n.Konva._fixTextRendering){const st=this.measureSize("M");J="alphabetic",tt=(st.fontBoundingBoxAscent-st.fontBoundingBoxDescent)/2+V/2}for(j===w&&U.setAttr("direction",j),U.setAttr("font",this._getContextFont()),U.setAttr("textBaseline",J),U.setAttr("textAlign",f),X===h?nt=(this.getHeight()-et*V-z*2)/2:X===m&&(nt=this.getHeight()-et*V-z*2),U.translate(z,nt+z),it=0;it<et;it++){let st=0,rt=0;const ot=Q[it],at=ot.text,lt=ot.width,pt=ot.lastInParagraph;if(U.save(),E===I?st+=F-lt-z*2:E===l&&(st+=(F-lt-z*2)/2),K){U.save(),U.beginPath();const dt=n.Konva._fixTextRendering?Math.round(k/4):Math.round(k/2),Pt=st,yt=tt+rt+dt;U.moveTo(Pt,yt);const Ct=E===d&&!pt?F-z*2:lt;U.lineTo(Pt+Math.round(Ct),yt),U.lineWidth=k/15;const It=this._getLinearGradient();U.strokeStyle=It||W,U.stroke(),U.restore()}if(Z){U.save(),U.beginPath();const dt=n.Konva._fixTextRendering?-Math.round(k/4):0;U.moveTo(st,tt+rt+dt);const Pt=E===d&&!pt?F-z*2:lt;U.lineTo(st+Math.round(Pt),tt+rt+dt),U.lineWidth=k/15;const yt=this._getLinearGradient();U.strokeStyle=yt||W,U.stroke(),U.restore()}if(j!==w&&(H!==0||E===d)){const dt=at.split(" ").length-1,Pt=o(at);for(let yt=0;yt<Pt.length;yt++){const Ct=Pt[yt];Ct===" "&&!pt&&E===d&&(st+=(F-z*2-lt)/dt),this._partialTextX=st,this._partialTextY=tt+rt,this._partialText=Ct,U.fillStrokeShape(this),st+=this.measureSize(Ct).width+H}}else H!==0&&U.setAttr("letterSpacing",`${H}px`),this._partialTextX=st,this._partialTextY=tt+rt,this._partialText=at,U.fillStrokeShape(this);U.restore(),et>1&&(tt+=V)}}_hitFunc(U){const Q=this.getWidth(),et=this.getHeight();U.beginPath(),U.rect(0,0,Q,et),U.closePath(),U.fillStrokeShape(this)}setText(U){const Q=t.Util._isString(U)?U:U==null?"":U+"";return this._setAttr(y,Q),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(U){var Q,et,z,k,V,X,j,nt,E,F,H;let W=b(),Y=this.fontSize(),K;W.save(),W.font=this._getContextFont(),K=W.measureText(U),W.restore();const Z=Y/100;return{actualBoundingBoxAscent:(Q=K.actualBoundingBoxAscent)!==null&&Q!==void 0?Q:71.58203125*Z,actualBoundingBoxDescent:(et=K.actualBoundingBoxDescent)!==null&&et!==void 0?et:0,actualBoundingBoxLeft:(z=K.actualBoundingBoxLeft)!==null&&z!==void 0?z:-7.421875*Z,actualBoundingBoxRight:(k=K.actualBoundingBoxRight)!==null&&k!==void 0?k:75.732421875*Z,alphabeticBaseline:(V=K.alphabeticBaseline)!==null&&V!==void 0?V:0,emHeightAscent:(X=K.emHeightAscent)!==null&&X!==void 0?X:100*Z,emHeightDescent:(j=K.emHeightDescent)!==null&&j!==void 0?j:-20*Z,fontBoundingBoxAscent:(nt=K.fontBoundingBoxAscent)!==null&&nt!==void 0?nt:91*Z,fontBoundingBoxDescent:(E=K.fontBoundingBoxDescent)!==null&&E!==void 0?E:21*Z,hangingBaseline:(F=K.hangingBaseline)!==null&&F!==void 0?F:72.80000305175781*Z,ideographicBaseline:(H=K.ideographicBaseline)!==null&&H!==void 0?H:-21*Z,width:K.width,height:Y}}_getContextFont(){return this.fontStyle()+R+this.fontVariant()+R+(this.fontSize()+v)+L(this.fontFamily())}_addTextLine(U){this.align()===d&&(U=U.trim());const et=this._getTextWidth(U);return this.textArr.push({text:U,width:et,lastInParagraph:!1})}_getTextWidth(U){const Q=this.letterSpacing(),et=U.length;return b().measureText(U).width+Q*et}_setTextData(){let U=this.text().split(`
`),Q=+this.fontSize(),et=0,z=this.lineHeight()*Q,k=this.attrs.width,V=this.attrs.height,X=k!==a&&k!==void 0,j=V!==a&&V!==void 0,nt=this.padding(),E=k-nt*2,F=V-nt*2,H=0,W=this.wrap(),Y=W!==M,K=W!==T&&Y,Z=this.ellipsis();this.textArr=[],b().font=this._getContextFont();const it=Z?this._getTextWidth(D):0;for(let tt=0,J=U.length;tt<J;++tt){let st=U[tt],rt=this._getTextWidth(st);if(X&&rt>E)for(;st.length>0;){let ot=0,at=o(st).length,lt="",pt=0;for(;ot<at;){const dt=ot+at>>>1,Pt=o(st),yt=Pt.slice(0,dt+1).join(""),Ct=this._getTextWidth(yt);(Z&&j&&H+z>F?Ct+it:Ct)<=E?(ot=dt+1,lt=yt,pt=Ct):at=dt}if(lt){if(K){const yt=o(st),Ct=o(lt),It=yt[Ct.length],xe=It===R||It===u;let Fe;if(xe&&pt<=E)Fe=Ct.length;else{const Bt=Ct.lastIndexOf(R),Yt=Ct.lastIndexOf(u);Fe=Math.max(Bt,Yt)+1}Fe>0&&(ot=Fe,lt=yt.slice(0,ot).join(""),pt=this._getTextWidth(lt))}if(lt=lt.trimRight(),this._addTextLine(lt),et=Math.max(et,pt),H+=z,this._shouldHandleEllipsis(H)){this._tryToAddEllipsisToLastLine();break}if(st=o(st).slice(ot).join("").trimLeft(),st.length>0&&(rt=this._getTextWidth(st),rt<=E)){this._addTextLine(st),H+=z,et=Math.max(et,rt);break}}else break}else this._addTextLine(st),H+=z,et=Math.max(et,rt),this._shouldHandleEllipsis(H)&&tt<J-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),j&&H+z>F)break}this.textHeight=Q,this.textWidth=et}_shouldHandleEllipsis(U){const Q=+this.fontSize(),et=this.lineHeight()*Q,z=this.attrs.height,k=z!==a&&z!==void 0,V=this.padding(),X=z-V*2;return!(this.wrap()!==M)||k&&U+et>X}_tryToAddEllipsisToLastLine(){const U=this.attrs.width,Q=U!==a&&U!==void 0,et=this.padding(),z=U-et*2,k=this.ellipsis(),V=this.textArr[this.textArr.length-1];!V||!k||(Q&&(this._getTextWidth(V.text+D)<z||(V.text=V.text.slice(0,V.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(V.text+D))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const U=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,Q=this.hasShadow();return U&&Q?!0:super._useBufferCanvas()}};return ze.Text=O,O.prototype._fillFunc=P,O.prototype._strokeFunc=N,O.prototype.className=S,O.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,r._registerNode)(O),e.Factory.overWriteSetter(O,"width",(0,s.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(O,"height",(0,s.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(O,"direction",c),e.Factory.addGetterSetter(O,"fontFamily","Arial"),e.Factory.addGetterSetter(O,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"fontStyle",_),e.Factory.addGetterSetter(O,"fontVariant",_),e.Factory.addGetterSetter(O,"padding",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"align",f),e.Factory.addGetterSetter(O,"verticalAlign",x),e.Factory.addGetterSetter(O,"lineHeight",1,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"wrap",C),e.Factory.addGetterSetter(O,"ellipsis",!1,(0,s.getBooleanValidator)()),e.Factory.addGetterSetter(O,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"text","",(0,s.getStringValidator)()),e.Factory.addGetterSetter(O,"textDecoration",""),ze}var Fi={},Ma;function cd(){if(Ma)return Fi;Ma=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.TextPath=void 0;const t=Tt(),e=ft(),i=Mt(),n=Ur(),s=Aa(),r=gt(),o=ut(),a="",l="normal";function c(g){g.fillText(this.partialText,0,0)}function d(g){g.strokeText(this.partialText,0,0)}let p=class extends i.Shape{constructor(u){super(u),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(u){if(!this.attrs.data)return null;const f=this.pathLength;return u-1>f?null:n.Path.getPointAtLengthOfDataArray(u,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(u){u.setAttr("font",this._getContextFont()),u.setAttr("textBaseline",this.textBaseline()),u.setAttr("textAlign","left"),u.save();const f=this.textDecoration(),y=this.fill(),S=this.fontSize(),x=this.glyphInfo;f==="underline"&&u.beginPath();for(let m=0;m<x.length;m++){u.save();const h=x[m].p0;u.translate(h.x,h.y),u.rotate(x[m].rotation),this.partialText=x[m].text,u.fillStrokeShape(this),f==="underline"&&(m===0&&u.moveTo(0,S/2+1),u.lineTo(S,S/2+1)),u.restore()}f==="underline"&&(u.strokeStyle=y,u.lineWidth=S/20,u.stroke()),u.restore()}_hitFunc(u){u.beginPath();const f=this.glyphInfo;if(f.length>=1){const y=f[0].p0;u.moveTo(y.x,y.y)}for(let y=0;y<f.length;y++){const S=f[y].p1;u.lineTo(S.x,S.y)}u.setAttr("lineWidth",this.fontSize()),u.setAttr("strokeStyle",this.colorKey),u.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(u){return s.Text.prototype.setText.call(this,u)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(u){const y=this.dummyCanvas.getContext("2d");y.save(),y.font=this._getContextFont();const S=y.measureText(u);return y.restore(),{width:S.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:u,height:f}=this._getTextSize(this.attrs.text);if(this.textWidth=u,this.textHeight=f,this.glyphInfo=[],!this.attrs.data)return null;const y=this.letterSpacing(),S=this.align(),x=this.kerningFunc(),m=Math.max(this.textWidth+((this.attrs.text||"").length-1)*y,0);let h=0;S==="center"&&(h=Math.max(0,this.pathLength/2-m/2)),S==="right"&&(h=Math.max(0,this.pathLength-m));const _=(0,s.stringToArray)(this.text());let v=h;for(let R=0;R<_.length;R++){const I=this._getPointAtLength(v);if(!I)return;let w=this._getTextSize(_[R]).width+y;if(_[R]===" "&&S==="justify"){const B=this.text().split(" ").length-1;w+=(this.pathLength-m)/B}const C=this._getPointAtLength(v+w);if(!C)return;const T=n.Path.getLineLength(I.x,I.y,C.x,C.y);let M=0;if(x)try{M=x(_[R-1],_[R])*this.fontSize()}catch{M=0}I.x+=M,C.x+=M,this.textWidth+=M;const D=n.Path.getPointOnLine(M+T/2,I.x,I.y,C.x,C.y),G=Math.atan2(C.y-I.y,C.x-I.x);this.glyphInfo.push({transposeX:D.x,transposeY:D.y,text:_[R],rotation:G,p0:I,p1:C}),v+=w}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const u=[];this.glyphInfo.forEach(function(v){u.push(v.p0.x),u.push(v.p0.y),u.push(v.p1.x),u.push(v.p1.y)});let f=u[0]||0,y=u[0]||0,S=u[1]||0,x=u[1]||0,m,h;for(let v=0;v<u.length/2;v++)m=u[v*2],h=u[v*2+1],f=Math.min(f,m),y=Math.max(y,m),S=Math.min(S,h),x=Math.max(x,h);const _=this.fontSize();return{x:f-_/2,y:S-_/2,width:y-f+_,height:x-S+_}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Fi.TextPath=p,p.prototype._fillFunc=c,p.prototype._strokeFunc=d,p.prototype._fillFuncHit=c,p.prototype._strokeFuncHit=d,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(p),e.Factory.addGetterSetter(p,"data"),e.Factory.addGetterSetter(p,"fontFamily","Arial"),e.Factory.addGetterSetter(p,"fontSize",12,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(p,"fontStyle",l),e.Factory.addGetterSetter(p,"align","left"),e.Factory.addGetterSetter(p,"letterSpacing",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(p,"textBaseline","middle"),e.Factory.addGetterSetter(p,"fontVariant",l),e.Factory.addGetterSetter(p,"text",a),e.Factory.addGetterSetter(p,"textDecoration",""),e.Factory.addGetterSetter(p,"kerningFunc",void 0),Fi}var Ii={},Na;function hd(){if(Na)return Ii;Na=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.Transformer=void 0;const t=Tt(),e=ft(),i=Et(),n=Mt(),s=Ca(),r=Or(),o=ut(),a=gt(),l=ut(),c="tr-konva",d=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(w=>w+`.${c}`).join(" "),p="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],u={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},f="ontouchstart"in o.Konva._global;function y(w,C,T){if(w==="rotater")return T;C+=t.Util.degToRad(u[w]||0);const M=(t.Util.radToDeg(C)%360+360)%360;return t.Util._inRange(M,337.5,360)||t.Util._inRange(M,0,22.5)?"ns-resize":t.Util._inRange(M,22.5,67.5)?"nesw-resize":t.Util._inRange(M,67.5,112.5)?"ew-resize":t.Util._inRange(M,112.5,157.5)?"nwse-resize":t.Util._inRange(M,157.5,202.5)?"ns-resize":t.Util._inRange(M,202.5,247.5)?"nesw-resize":t.Util._inRange(M,247.5,292.5)?"ew-resize":t.Util._inRange(M,292.5,337.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+M),"pointer")}const S=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function x(w){return{x:w.x+w.width/2*Math.cos(w.rotation)+w.height/2*Math.sin(-w.rotation),y:w.y+w.height/2*Math.cos(w.rotation)+w.width/2*Math.sin(w.rotation)}}function m(w,C,T){const M=T.x+(w.x-T.x)*Math.cos(C)-(w.y-T.y)*Math.sin(C),D=T.y+(w.x-T.x)*Math.sin(C)+(w.y-T.y)*Math.cos(C);return{...w,rotation:w.rotation+C,x:M,y:D}}function h(w,C){const T=x(w);return m(w,C,T)}function _(w,C,T){let M=C;for(let D=0;D<w.length;D++){const G=o.Konva.getAngle(w[D]),B=Math.abs(G-C)%(Math.PI*2);Math.min(B,Math.PI*2-B)<T&&(M=G)}return M}let v=0,R=class extends r.Group{constructor(C){super(C),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(C){return this.setNode(C),this}setNode(C){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([C])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(C=[]){this._nodes&&this._nodes.length&&this.detach();const T=C.filter(D=>D.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=C=T,C.length===1&&this.useSingleNodeRotation()?this.rotation(C[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(D=>{const G=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(D._attrsAffectingSize.length){const B=D._attrsAffectingSize.map(L=>L+"Change."+this._getEventNamespace()).join(" ");D.on(B,G)}D.on(g.map(B=>B+`.${this._getEventNamespace()}`).join(" "),G),D.on(`absoluteTransformChange.${this._getEventNamespace()}`,G),this._proxyDrag(D)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(C){let T;C.on(`dragstart.${this._getEventNamespace()}`,M=>{T=C.getAbsolutePosition(),!this.isDragging()&&C!==this.findOne(".back")&&this.startDrag(M,!1)}),C.on(`dragmove.${this._getEventNamespace()}`,M=>{if(!T)return;const D=C.getAbsolutePosition(),G=D.x-T.x,B=D.y-T.y;this.nodes().forEach(L=>{if(L===C||L.isDragging())return;const $=L.getAbsolutePosition();L.setAbsolutePosition({x:$.x+G,y:$.y+B}),L.startDrag(M)}),T=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(C=>{C.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(C,T=this.rotation(),M){const D=C.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),G=C.getAbsoluteScale(M),B=C.getAbsolutePosition(M),L=D.x*G.x-C.offsetX()*G.x,$=D.y*G.y-C.offsetY()*G.y,b=(o.Konva.getAngle(C.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),P={x:B.x+L*Math.cos(b)+$*Math.sin(-b),y:B.y+$*Math.cos(b)+L*Math.sin(b),width:D.width*G.x,height:D.height*G.y,rotation:b};return m(P,-o.Konva.getAngle(T),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const T=[];this.nodes().map(b=>{const P=b.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),N=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}],A=b.getAbsoluteTransform();N.forEach(function(O){const q=A.point(O);T.push(q)})});const M=new t.Transform;M.rotate(-o.Konva.getAngle(this.rotation()));let D=1/0,G=1/0,B=-1/0,L=-1/0;T.forEach(function(b){const P=M.point(b);D===void 0&&(D=B=P.x,G=L=P.y),D=Math.min(D,P.x),G=Math.min(G,P.y),B=Math.max(B,P.x),L=Math.max(L,P.y)}),M.invert();const $=M.point({x:D,y:G});return{x:$.x,y:$.y,width:B-D,height:L-G,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S.forEach(C=>{this._createAnchor(C)}),this._createAnchor("rotater")}_createAnchor(C){const T=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:C+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:f?10:"auto"}),M=this;T.on("mousedown touchstart",function(D){M._handleMouseDown(D)}),T.on("dragstart",D=>{T.stopDrag(),D.cancelBubble=!0}),T.on("dragend",D=>{D.cancelBubble=!0}),T.on("mouseenter",()=>{const D=o.Konva.getAngle(this.rotation()),G=this.rotateAnchorCursor(),B=y(C,D,G);T.getStage().content&&(T.getStage().content.style.cursor=B),this._cursorChange=!0}),T.on("mouseout",()=>{T.getStage().content&&(T.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(T)}_createBack(){const C=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(T,M){const D=M.getParent(),G=D.padding();T.beginPath(),T.rect(-G,-G,M.width()+G*2,M.height()+G*2),T.moveTo(M.width()/2,-G),D.rotateEnabled()&&D.rotateLineVisible()&&T.lineTo(M.width()/2,-D.rotateAnchorOffset()*t.Util._sign(M.height())-G),T.fillStrokeShape(M)},hitFunc:(T,M)=>{if(!this.shouldOverdrawWholeArea())return;const D=this.padding();T.beginPath(),T.rect(-D,-D,M.width()+D*2,M.height()+D*2),T.fillStrokeShape(M)}});this.add(C),this._proxyDrag(C),C.on("dragstart",T=>{T.cancelBubble=!0}),C.on("dragmove",T=>{T.cancelBubble=!0}),C.on("dragend",T=>{T.cancelBubble=!0}),this.on("dragmove",T=>{this.update()})}_handleMouseDown(C){if(this._transforming)return;this._movingAnchorName=C.target.name().split(" ")[0];const T=this._getNodeRect(),M=T.width,D=T.height,G=Math.sqrt(Math.pow(M,2)+Math.pow(D,2));this.sin=Math.abs(D/G),this.cos=Math.abs(M/G),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const B=C.target.getAbsolutePosition(),L=C.target.getStage().getPointerPosition();this._anchorDragOffset={x:L.x-B.x,y:L.y-B.y},v++,this._fire("transformstart",{evt:C.evt,target:this.getNode()}),this._nodes.forEach($=>{$._fire("transformstart",{evt:C.evt,target:$})})}_handleMouseMove(C){let T,M,D;const G=this.findOne("."+this._movingAnchorName),B=G.getStage();B.setPointersPositions(C);const L=B.getPointerPosition();let $={x:L.x-this._anchorDragOffset.x,y:L.y-this._anchorDragOffset.y};const b=G.getAbsolutePosition();this.anchorDragBoundFunc()&&($=this.anchorDragBoundFunc()(b,$,C)),G.setAbsolutePosition($);const P=G.getAbsolutePosition();if(b.x===P.x&&b.y===P.y)return;if(this._movingAnchorName==="rotater"){const z=this._getNodeRect();T=G.x()-z.width/2,M=-G.y()+z.height/2;let k=Math.atan2(-M,T)+Math.PI/2;z.height<0&&(k-=Math.PI);const X=o.Konva.getAngle(this.rotation())+k,j=o.Konva.getAngle(this.rotationSnapTolerance()),E=_(this.rotationSnaps(),X,j)-z.rotation,F=h(z,E);this._fitNodesInto(F,C);return}const N=this.shiftBehavior();let A;N==="inverted"?A=this.keepRatio()&&!C.shiftKey:N==="none"?A=this.keepRatio():A=this.keepRatio()||C.shiftKey;let O=this.centeredScaling()||C.altKey;if(this._movingAnchorName==="top-left"){if(A){const z=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};D=Math.sqrt(Math.pow(z.x-G.x(),2)+Math.pow(z.y-G.y(),2));const k=this.findOne(".top-left").x()>z.x?-1:1,V=this.findOne(".top-left").y()>z.y?-1:1;T=D*this.cos*k,M=D*this.sin*V,this.findOne(".top-left").x(z.x-T),this.findOne(".top-left").y(z.y-M)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(G.y());else if(this._movingAnchorName==="top-right"){if(A){const z=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};D=Math.sqrt(Math.pow(G.x()-z.x,2)+Math.pow(z.y-G.y(),2));const k=this.findOne(".top-right").x()<z.x?-1:1,V=this.findOne(".top-right").y()>z.y?-1:1;T=D*this.cos*k,M=D*this.sin*V,this.findOne(".top-right").x(z.x+T),this.findOne(".top-right").y(z.y-M)}var q=G.position();this.findOne(".top-left").y(q.y),this.findOne(".bottom-right").x(q.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(G.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(G.x());else if(this._movingAnchorName==="bottom-left"){if(A){const z=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};D=Math.sqrt(Math.pow(z.x-G.x(),2)+Math.pow(G.y()-z.y,2));const k=z.x<G.x()?-1:1,V=G.y()<z.y?-1:1;T=D*this.cos*k,M=D*this.sin*V,G.x(z.x-T),G.y(z.y+M)}q=G.position(),this.findOne(".top-left").x(q.x),this.findOne(".bottom-right").y(q.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(G.y());else if(this._movingAnchorName==="bottom-right"){if(A){const z=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};D=Math.sqrt(Math.pow(G.x()-z.x,2)+Math.pow(G.y()-z.y,2));const k=this.findOne(".bottom-right").x()<z.x?-1:1,V=this.findOne(".bottom-right").y()<z.y?-1:1;T=D*this.cos*k,M=D*this.sin*V,this.findOne(".bottom-right").x(z.x+T),this.findOne(".bottom-right").y(z.y+M)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(O=this.centeredScaling()||C.altKey,O){const z=this.findOne(".top-left"),k=this.findOne(".bottom-right"),V=z.x(),X=z.y(),j=this.getWidth()-k.x(),nt=this.getHeight()-k.y();k.move({x:-V,y:-X}),z.move({x:j,y:nt})}const U=this.findOne(".top-left").getAbsolutePosition();T=U.x,M=U.y;const Q=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),et=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:T,y:M,width:Q,height:et,rotation:o.Konva.getAngle(this.rotation())},C)}_handleMouseUp(C){this._removeEvents(C)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(C){var T;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const M=this.getNode();v--,this._fire("transformend",{evt:C,target:M}),(T=this.getLayer())===null||T===void 0||T.batchDraw(),M&&this._nodes.forEach(D=>{var G;D._fire("transformend",{evt:C,target:D}),(G=D.getLayer())===null||G===void 0||G.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(C,T){const M=this._getNodeRect(),D=1;if(t.Util._inRange(C.width,-this.padding()*2-D,D)){this.update();return}if(t.Util._inRange(C.height,-this.padding()*2-D,D)){this.update();return}const G=new t.Transform;if(G.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&C.width<0&&this._movingAnchorName.indexOf("left")>=0){const A=G.point({x:-this.padding()*2,y:0});C.x+=A.x,C.y+=A.y,C.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y}else if(this._movingAnchorName&&C.width<0&&this._movingAnchorName.indexOf("right")>=0){const A=G.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,C.width+=this.padding()*2}if(this._movingAnchorName&&C.height<0&&this._movingAnchorName.indexOf("top")>=0){const A=G.point({x:0,y:-this.padding()*2});C.x+=A.x,C.y+=A.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,C.height+=this.padding()*2}else if(this._movingAnchorName&&C.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const A=G.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,C.height+=this.padding()*2}if(this.boundBoxFunc()){const A=this.boundBoxFunc()(M,C);A?C=A:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const B=1e7,L=new t.Transform;L.translate(M.x,M.y),L.rotate(M.rotation),L.scale(M.width/B,M.height/B);const $=new t.Transform,b=C.width/B,P=C.height/B;this.flipEnabled()===!1?($.translate(C.x,C.y),$.rotate(C.rotation),$.translate(C.width<0?C.width:0,C.height<0?C.height:0),$.scale(Math.abs(b),Math.abs(P))):($.translate(C.x,C.y),$.rotate(C.rotation),$.scale(b,P));const N=$.multiply(L.invert());this._nodes.forEach(A=>{var O;const q=A.getParent().getAbsoluteTransform(),U=A.getTransform().copy();U.translate(A.offsetX(),A.offsetY());const Q=new t.Transform;Q.multiply(q.copy().invert()).multiply(N).multiply(q).multiply(U);const et=Q.decompose();A.setAttrs(et),(O=A.getLayer())===null||O===void 0||O.batchDraw()}),this.rotation(t.Util._getRotation(C.rotation)),this._nodes.forEach(A=>{this._fire("transform",{evt:T,target:A}),A._fire("transform",{evt:T,target:A})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(C,T){this.findOne(C).setAttrs(T)}update(){var C;const T=this._getNodeRect();this.rotation(t.Util._getRotation(T.rotation));const M=T.width,D=T.height,G=this.enabledAnchors(),B=this.resizeEnabled(),L=this.padding(),$=this.anchorSize(),b=this.find("._anchor");b.forEach(N=>{N.setAttrs({width:$,height:$,offsetX:$/2,offsetY:$/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:$/2+L,offsetY:$/2+L,visible:B&&G.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:M/2,y:0,offsetY:$/2+L,visible:B&&G.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:M,y:0,offsetX:$/2-L,offsetY:$/2+L,visible:B&&G.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:D/2,offsetX:$/2+L,visible:B&&G.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:M,y:D/2,offsetX:$/2-L,visible:B&&G.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:D,offsetX:$/2+L,offsetY:$/2-L,visible:B&&G.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:M/2,y:D,offsetY:$/2-L,visible:B&&G.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:M,y:D,offsetX:$/2-L,offsetY:$/2-L,visible:B&&G.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:M/2,y:-this.rotateAnchorOffset()*t.Util._sign(D)-L,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:M,height:D,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const P=this.anchorStyleFunc();P&&b.forEach(N=>{P(N)}),(C=this.getLayer())===null||C===void 0||C.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const C=this.findOne("."+this._movingAnchorName);C&&C.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),r.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return i.Node.prototype.toObject.call(this)}clone(C){return i.Node.prototype.clone.call(this,C)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Ii.Transformer=R,R.isTransforming=()=>v>0;function I(w){return w instanceof Array||t.Util.warn("enabledAnchors value should be an array"),w instanceof Array&&w.forEach(function(C){S.indexOf(C)===-1&&t.Util.warn("Unknown anchor name: "+C+". Available names are: "+S.join(", "))}),w||[]}return R.prototype.className="Transformer",(0,l._registerNode)(R),e.Factory.addGetterSetter(R,"enabledAnchors",S,I),e.Factory.addGetterSetter(R,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(R,"resizeEnabled",!0),e.Factory.addGetterSetter(R,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(R,"rotateEnabled",!0),e.Factory.addGetterSetter(R,"rotateLineVisible",!0),e.Factory.addGetterSetter(R,"rotationSnaps",[]),e.Factory.addGetterSetter(R,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(R,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(R,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(R,"borderEnabled",!0),e.Factory.addGetterSetter(R,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(R,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(R,"anchorFill","white"),e.Factory.addGetterSetter(R,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(R,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(R,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(R,"borderDash"),e.Factory.addGetterSetter(R,"keepRatio",!0),e.Factory.addGetterSetter(R,"shiftBehavior","default"),e.Factory.addGetterSetter(R,"centeredScaling",!1),e.Factory.addGetterSetter(R,"ignoreStroke",!1),e.Factory.addGetterSetter(R,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(R,"nodes"),e.Factory.addGetterSetter(R,"node"),e.Factory.addGetterSetter(R,"boundBoxFunc"),e.Factory.addGetterSetter(R,"anchorDragBoundFunc"),e.Factory.addGetterSetter(R,"anchorStyleFunc"),e.Factory.addGetterSetter(R,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(R,"useSingleNodeRotation",!0),e.Factory.backCompat(R,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Ii}var Oi={},ka;function dd(){if(ka)return Oi;ka=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.Wedge=void 0;const t=ft(),e=Mt(),i=ut(),n=gt(),s=ut();let r=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,i.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return Oi.Wedge=r,r.prototype.className="Wedge",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"angle",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"clockwise",!1),t.Factory.backCompat(r,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Oi}var Di={},Fa;function ud(){if(Fa)return Di;Fa=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.Blur=void 0;const t=ft(),e=Et(),i=gt();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],r=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(l,c){const d=l.data,p=l.width,g=l.height;let u,f,y,S,x,m,h,_,v,R,I,w,C,T,M,D,G,B,L,$;const b=c+c+1,P=p-1,N=g-1,A=c+1,O=A*(A+1)/2,q=new n,U=s[c],Q=r[c];let et=null,z=q,k=null,V=null;for(let X=1;X<b;X++)z=z.next=new n,X===A&&(et=z);z.next=q,y=f=0;for(let X=0;X<g;X++){w=C=T=M=S=x=m=h=0,_=A*(D=d[f]),v=A*(G=d[f+1]),R=A*(B=d[f+2]),I=A*(L=d[f+3]),S+=O*D,x+=O*G,m+=O*B,h+=O*L,z=q;for(let j=0;j<A;j++)z.r=D,z.g=G,z.b=B,z.a=L,z=z.next;for(let j=1;j<A;j++)u=f+((P<j?P:j)<<2),S+=(z.r=D=d[u])*($=A-j),x+=(z.g=G=d[u+1])*$,m+=(z.b=B=d[u+2])*$,h+=(z.a=L=d[u+3])*$,w+=D,C+=G,T+=B,M+=L,z=z.next;k=q,V=et;for(let j=0;j<p;j++)d[f+3]=L=h*U>>Q,L!==0?(L=255/L,d[f]=(S*U>>Q)*L,d[f+1]=(x*U>>Q)*L,d[f+2]=(m*U>>Q)*L):d[f]=d[f+1]=d[f+2]=0,S-=_,x-=v,m-=R,h-=I,_-=k.r,v-=k.g,R-=k.b,I-=k.a,u=y+((u=j+c+1)<P?u:P)<<2,w+=k.r=d[u],C+=k.g=d[u+1],T+=k.b=d[u+2],M+=k.a=d[u+3],S+=w,x+=C,m+=T,h+=M,k=k.next,_+=D=V.r,v+=G=V.g,R+=B=V.b,I+=L=V.a,w-=D,C-=G,T-=B,M-=L,V=V.next,f+=4;y+=p}for(let X=0;X<p;X++){C=T=M=w=x=m=h=S=0,f=X<<2,_=A*(D=d[f]),v=A*(G=d[f+1]),R=A*(B=d[f+2]),I=A*(L=d[f+3]),S+=O*D,x+=O*G,m+=O*B,h+=O*L,z=q;for(let nt=0;nt<A;nt++)z.r=D,z.g=G,z.b=B,z.a=L,z=z.next;let j=p;for(let nt=1;nt<=c;nt++)f=j+X<<2,S+=(z.r=D=d[f])*($=A-nt),x+=(z.g=G=d[f+1])*$,m+=(z.b=B=d[f+2])*$,h+=(z.a=L=d[f+3])*$,w+=D,C+=G,T+=B,M+=L,z=z.next,nt<N&&(j+=p);f=X,k=q,V=et;for(let nt=0;nt<g;nt++)u=f<<2,d[u+3]=L=h*U>>Q,L>0?(L=255/L,d[u]=(S*U>>Q)*L,d[u+1]=(x*U>>Q)*L,d[u+2]=(m*U>>Q)*L):d[u]=d[u+1]=d[u+2]=0,S-=_,x-=v,m-=R,h-=I,_-=k.r,v-=k.g,R-=k.b,I-=k.a,u=X+((u=nt+A)<N?u:N)*p<<2,S+=w+=k.r=d[u],x+=C+=k.g=d[u+1],m+=T+=k.b=d[u+2],h+=M+=k.a=d[u+3],k=k.next,_+=D=V.r,v+=G=V.g,R+=B=V.b,I+=L=V.a,w-=D,C-=G,T-=B,M-=L,V=V.next,f+=p}}const a=function(c){const d=Math.round(this.blurRadius());d>0&&o(c,d)};return Di.Blur=a,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Di}var Li={},Ia;function fd(){if(Ia)return Li;Ia=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.Brighten=void 0;const t=ft(),e=Et(),i=gt(),n=function(s){const r=this.brightness()*255,o=s.data,a=o.length;for(let l=0;l<a;l+=4)o[l]+=r,o[l+1]+=r,o[l+2]+=r};return Li.Brighten=n,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Li}var Gi={},Oa;function gd(){if(Oa)return Gi;Oa=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.Contrast=void 0;const t=ft(),e=Et(),i=gt(),n=function(s){const r=Math.pow((this.contrast()+100)/100,2),o=s.data,a=o.length;let l=150,c=150,d=150;for(let p=0;p<a;p+=4)l=o[p],c=o[p+1],d=o[p+2],l/=255,l-=.5,l*=r,l+=.5,l*=255,c/=255,c-=.5,c*=r,c+=.5,c*=255,d/=255,d-=.5,d*=r,d+=.5,d*=255,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,d=d<0?0:d>255?255:d,o[p]=l,o[p+1]=c,o[p+2]=d};return Gi.Contrast=n,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Gi}var Ui={},Da;function pd(){if(Da)return Ui;Da=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.Emboss=void 0;const t=ft(),e=Et(),i=Tt(),n=gt(),s=function(r){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),c=this.embossBlend(),d=r.data,p=r.width,g=r.height,u=p*4;let f=0,y=0,S=g;switch(l){case"top-left":f=-1,y=-1;break;case"top":f=-1,y=0;break;case"top-right":f=-1,y=1;break;case"right":f=0,y=1;break;case"bottom-right":f=1,y=1;break;case"bottom":f=1,y=0;break;case"bottom-left":f=1,y=-1;break;case"left":f=0,y=-1;break;default:i.Util.error("Unknown emboss direction: "+l)}do{const x=(S-1)*u;let m=f;S+m<1&&(m=0),S+m>g&&(m=0);const h=(S-1+m)*p*4;let _=p;do{const v=x+(_-1)*4;let R=y;_+R<1&&(R=0),_+R>p&&(R=0);const I=h+(_-1+R)*4,w=d[v]-d[I],C=d[v+1]-d[I+1],T=d[v+2]-d[I+2];let M=w;const D=M>0?M:-M,G=C>0?C:-C,B=T>0?T:-T;if(G>D&&(M=C),B>D&&(M=T),M*=o,c){const L=d[v]+M,$=d[v+1]+M,b=d[v+2]+M;d[v]=L>255?255:L<0?0:L,d[v+1]=$>255?255:$<0?0:$,d[v+2]=b>255?255:b<0?0:b}else{let L=a-M;L<0?L=0:L>255&&(L=255),d[v]=d[v+1]=d[v+2]=L}}while(--_)}while(--S)};return Ui.Emboss=s,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),Ui}var Bi={},La;function md(){if(La)return Bi;La=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.Enhance=void 0;const t=ft(),e=Et(),i=gt();function n(r,o,a,l,c){const d=a-o,p=c-l;if(d===0)return l+p/2;if(p===0)return l;let g=(r-o)/d;return g=p*g+l,g}const s=function(r){const o=r.data,a=o.length;let l=o[0],c=l,d,p=o[1],g=p,u,f=o[2],y=f,S;const x=this.enhance();if(x===0)return;for(let w=0;w<a;w+=4)d=o[w+0],d<l?l=d:d>c&&(c=d),u=o[w+1],u<p?p=u:u>g&&(g=u),S=o[w+2],S<f?f=S:S>y&&(y=S);c===l&&(c=255,l=0),g===p&&(g=255,p=0),y===f&&(y=255,f=0);let m,h,_,v,R,I;if(x>0)m=c+x*(255-c),h=l-x*(l-0),_=g+x*(255-g),v=p-x*(p-0),R=y+x*(255-y),I=f-x*(f-0);else{const w=(c+l)*.5;m=c+x*(c-w),h=l+x*(l-w);const C=(g+p)*.5;_=g+x*(g-C),v=p+x*(p-C);const T=(y+f)*.5;R=y+x*(y-T),I=f+x*(f-T)}for(let w=0;w<a;w+=4)o[w+0]=n(o[w+0],l,c,h,m),o[w+1]=n(o[w+1],p,g,v,_),o[w+2]=n(o[w+2],f,y,I,R)};return Bi.Enhance=s,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Bi}var Hi={},Ga;function _d(){if(Ga)return Hi;Ga=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.Grayscale=void 0;const t=function(e){const i=e.data,n=i.length;for(let s=0;s<n;s+=4){const r=.34*i[s]+.5*i[s+1]+.16*i[s+2];i[s]=r,i[s+1]=r,i[s+2]=r}};return Hi.Grayscale=t,Hi}var Vi={},Ua;function yd(){if(Ua)return Vi;Ua=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.HSL=void 0;const t=ft(),e=Et(),i=gt();t.Factory.addGetterSetter(e.Node,"hue",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter);const n=function(s){const r=s.data,o=r.length,a=1,l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,d=this.luminance()*127,p=a*l*Math.cos(c*Math.PI/180),g=a*l*Math.sin(c*Math.PI/180),u=.299*a+.701*p+.167*g,f=.587*a-.587*p+.33*g,y=.114*a-.114*p-.497*g,S=.299*a-.299*p-.328*g,x=.587*a+.413*p+.035*g,m=.114*a-.114*p+.293*g,h=.299*a-.3*p+1.25*g,_=.587*a-.586*p-1.05*g,v=.114*a+.886*p-.2*g;let R,I,w,C;for(let T=0;T<o;T+=4)R=r[T+0],I=r[T+1],w=r[T+2],C=r[T+3],r[T+0]=u*R+f*I+y*w+d,r[T+1]=S*R+x*I+m*w+d,r[T+2]=h*R+_*I+v*w+d,r[T+3]=C};return Vi.HSL=n,Vi}var zi={},Ba;function bd(){if(Ba)return zi;Ba=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.HSV=void 0;const t=ft(),e=Et(),i=gt(),n=function(s){const r=s.data,o=r.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,d=a*l*Math.cos(c*Math.PI/180),p=a*l*Math.sin(c*Math.PI/180),g=.299*a+.701*d+.167*p,u=.587*a-.587*d+.33*p,f=.114*a-.114*d-.497*p,y=.299*a-.299*d-.328*p,S=.587*a+.413*d+.035*p,x=.114*a-.114*d+.293*p,m=.299*a-.3*d+1.25*p,h=.587*a-.586*d-1.05*p,_=.114*a+.886*d-.2*p;for(let v=0;v<o;v+=4){const R=r[v+0],I=r[v+1],w=r[v+2],C=r[v+3];r[v+0]=g*R+u*I+f*w,r[v+1]=y*R+S*I+x*w,r[v+2]=m*R+h*I+_*w,r[v+3]=C}};return zi.HSV=n,t.Factory.addGetterSetter(e.Node,"hue",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),zi}var qi={},Ha;function vd(){if(Ha)return qi;Ha=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.Invert=void 0;const t=function(e){const i=e.data,n=i.length;for(let s=0;s<n;s+=4)i[s]=255-i[s],i[s+1]=255-i[s+1],i[s+2]=255-i[s+2]};return qi.Invert=t,qi}var Wi={},Va;function Sd(){if(Va)return Wi;Va=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.Kaleidoscope=void 0;const t=ft(),e=Et(),i=Tt(),n=gt(),s=function(a,l,c){const d=a.data,p=l.data,g=a.width,u=a.height,f=c.polarCenterX||g/2,y=c.polarCenterY||u/2;let S=Math.sqrt(f*f+y*y),x=g-f,m=u-y;const h=Math.sqrt(x*x+m*m);S=h>S?h:S;const _=u,v=g,R=360/v*Math.PI/180;for(let I=0;I<v;I+=1){const w=Math.sin(I*R),C=Math.cos(I*R);for(let T=0;T<_;T+=1){x=Math.floor(f+S*T/_*C),m=Math.floor(y+S*T/_*w);let M=(m*g+x)*4;const D=d[M+0],G=d[M+1],B=d[M+2],L=d[M+3];M=(I+T*g)*4,p[M+0]=D,p[M+1]=G,p[M+2]=B,p[M+3]=L}}},r=function(a,l,c){const d=a.data,p=l.data,g=a.width,u=a.height,f=c.polarCenterX||g/2,y=c.polarCenterY||u/2;let S=Math.sqrt(f*f+y*y),x=g-f,m=u-y;const h=Math.sqrt(x*x+m*m);S=h>S?h:S;const _=u,v=g,R=0;let I,w;for(x=0;x<g;x+=1)for(m=0;m<u;m+=1){const C=x-f,T=m-y,M=Math.sqrt(C*C+T*T)*_/S;let D=(Math.atan2(T,C)*180/Math.PI+360+R)%360;D=D*v/360,I=Math.floor(D),w=Math.floor(M);let G=(w*g+I)*4;const B=d[G+0],L=d[G+1],$=d[G+2],b=d[G+3];G=(m*g+x)*4,p[G+0]=B,p[G+1]=L,p[G+2]=$,p[G+3]=b}},o=function(a){const l=a.width,c=a.height;let d,p,g,u,f,y,S,x,m,h,_=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),R=Math.floor(l*(v%360)/360);if(_<1)return;const I=i.Util.createCanvasElement();I.width=l,I.height=c;const w=I.getContext("2d").getImageData(0,0,l,c);i.Util.releaseCanvas(I),s(a,w,{polarCenterX:l/2,polarCenterY:c/2});let C=l/Math.pow(2,_);for(;C<=8;)C=C*2,_-=1;C=Math.ceil(C);let T=C,M=0,D=T,G=1;for(R+C>l&&(M=T,D=0,G=-1),p=0;p<c;p+=1)for(d=M;d!==D;d+=G)g=Math.round(d+R)%l,m=(l*p+g)*4,f=w.data[m+0],y=w.data[m+1],S=w.data[m+2],x=w.data[m+3],h=(l*p+d)*4,w.data[h+0]=f,w.data[h+1]=y,w.data[h+2]=S,w.data[h+3]=x;for(p=0;p<c;p+=1)for(T=Math.floor(C),u=0;u<_;u+=1){for(d=0;d<T+1;d+=1)m=(l*p+d)*4,f=w.data[m+0],y=w.data[m+1],S=w.data[m+2],x=w.data[m+3],h=(l*p+T*2-d-1)*4,w.data[h+0]=f,w.data[h+1]=y,w.data[h+2]=S,w.data[h+3]=x;T*=2}r(w,a,{})};return Wi.Kaleidoscope=o,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Wi}var Ki={},za;function wd(){if(za)return Ki;za=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.Mask=void 0;const t=ft(),e=Et(),i=gt();function n(g,u,f){let y=(f*g.width+u)*4;const S=[];return S.push(g.data[y++],g.data[y++],g.data[y++],g.data[y++]),S}function s(g,u){return Math.sqrt(Math.pow(g[0]-u[0],2)+Math.pow(g[1]-u[1],2)+Math.pow(g[2]-u[2],2))}function r(g){const u=[0,0,0];for(let f=0;f<g.length;f++)u[0]+=g[f][0],u[1]+=g[f][1],u[2]+=g[f][2];return u[0]/=g.length,u[1]/=g.length,u[2]/=g.length,u}function o(g,u){const f=n(g,0,0),y=n(g,g.width-1,0),S=n(g,0,g.height-1),x=n(g,g.width-1,g.height-1),m=u||10;if(s(f,y)<m&&s(y,x)<m&&s(x,S)<m&&s(S,f)<m){const h=r([y,f,x,S]),_=[];for(let v=0;v<g.width*g.height;v++){const R=s(h,[g.data[v*4],g.data[v*4+1],g.data[v*4+2]]);_[v]=R<m?0:255}return _}}function a(g,u){for(let f=0;f<g.width*g.height;f++)g.data[4*f+3]=u[f]}function l(g,u,f){const y=[1,1,1,1,0,1,1,1,1],S=Math.round(Math.sqrt(y.length)),x=Math.floor(S/2),m=[];for(let h=0;h<f;h++)for(let _=0;_<u;_++){const v=h*u+_;let R=0;for(let I=0;I<S;I++)for(let w=0;w<S;w++){const C=h+I-x,T=_+w-x;if(C>=0&&C<f&&T>=0&&T<u){const M=C*u+T,D=y[I*S+w];R+=g[M]*D}}m[v]=R===2040?255:0}return m}function c(g,u,f){const y=[1,1,1,1,1,1,1,1,1],S=Math.round(Math.sqrt(y.length)),x=Math.floor(S/2),m=[];for(let h=0;h<f;h++)for(let _=0;_<u;_++){const v=h*u+_;let R=0;for(let I=0;I<S;I++)for(let w=0;w<S;w++){const C=h+I-x,T=_+w-x;if(C>=0&&C<f&&T>=0&&T<u){const M=C*u+T,D=y[I*S+w];R+=g[M]*D}}m[v]=R>=1020?255:0}return m}function d(g,u,f){const y=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],S=Math.round(Math.sqrt(y.length)),x=Math.floor(S/2),m=[];for(let h=0;h<f;h++)for(let _=0;_<u;_++){const v=h*u+_;let R=0;for(let I=0;I<S;I++)for(let w=0;w<S;w++){const C=h+I-x,T=_+w-x;if(C>=0&&C<f&&T>=0&&T<u){const M=C*u+T,D=y[I*S+w];R+=g[M]*D}}m[v]=R}return m}const p=function(g){const u=this.threshold();let f=o(g,u);return f&&(f=l(f,g.width,g.height),f=c(f,g.width,g.height),f=d(f,g.width,g.height),a(g,f)),g};return Ki.Mask=p,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Ki}var ji={},qa;function Cd(){if(qa)return ji;qa=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.Noise=void 0;const t=ft(),e=Et(),i=gt(),n=function(s){const r=this.noise()*255,o=s.data,a=o.length,l=r/2;for(let c=0;c<a;c+=4)o[c+0]+=l-2*l*Math.random(),o[c+1]+=l-2*l*Math.random(),o[c+2]+=l-2*l*Math.random()};return ji.Noise=n,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),ji}var Yi={},Wa;function xd(){if(Wa)return Yi;Wa=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.Pixelate=void 0;const t=ft(),e=Tt(),i=Et(),n=gt(),s=function(r){let o=Math.ceil(this.pixelSize()),a=r.width,l=r.height,c=Math.ceil(a/o),d=Math.ceil(l/o),p=r.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let g=0;g<c;g+=1)for(let u=0;u<d;u+=1){let f=0,y=0,S=0,x=0;const m=g*o,h=m+o,_=u*o,v=_+o;let R=0;for(let I=m;I<h;I+=1)if(!(I>=a))for(let w=_;w<v;w+=1){if(w>=l)continue;const C=(a*w+I)*4;f+=p[C+0],y+=p[C+1],S+=p[C+2],x+=p[C+3],R+=1}f=f/R,y=y/R,S=S/R,x=x/R;for(let I=m;I<h;I+=1)if(!(I>=a))for(let w=_;w<v;w+=1){if(w>=l)continue;const C=(a*w+I)*4;p[C+0]=f,p[C+1]=y,p[C+2]=S,p[C+3]=x}}};return Yi.Pixelate=s,t.Factory.addGetterSetter(i.Node,"pixelSize",8,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Yi}var Xi={},Ka;function Pd(){if(Ka)return Xi;Ka=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.Posterize=void 0;const t=ft(),e=Et(),i=gt(),n=function(s){const r=Math.round(this.levels()*254)+1,o=s.data,a=o.length,l=255/r;for(let c=0;c<a;c+=1)o[c]=Math.floor(o[c]/l)*l};return Xi.Posterize=n,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Xi}var $i={},ja;function Td(){if(ja)return $i;ja=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.RGB=void 0;const t=ft(),e=Et(),i=gt(),n=function(s){const r=s.data,o=r.length,a=this.red(),l=this.green(),c=this.blue();for(let d=0;d<o;d+=4){const p=(.34*r[d]+.5*r[d+1]+.16*r[d+2])/255;r[d]=p*a,r[d+1]=p*l,r[d+2]=p*c,r[d+3]=r[d+3]}};return $i.RGB=n,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,i.RGBComponent,t.Factory.afterSetFilter),$i}var Qi={},Ya;function Rd(){if(Ya)return Qi;Ya=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.RGBA=void 0;const t=ft(),e=Et(),i=gt(),n=function(s){const r=s.data,o=r.length,a=this.red(),l=this.green(),c=this.blue(),d=this.alpha();for(let p=0;p<o;p+=4){const g=1-d;r[p]=a*d+r[p]*g,r[p+1]=l*d+r[p+1]*g,r[p+2]=c*d+r[p+2]*g}};return Qi.RGBA=n,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,i.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),Qi}var Ji={},Xa;function Ed(){if(Xa)return Ji;Xa=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.Sepia=void 0;const t=function(e){const i=e.data,n=i.length;for(let s=0;s<n;s+=4){const r=i[s+0],o=i[s+1],a=i[s+2];i[s+0]=Math.min(255,r*.393+o*.769+a*.189),i[s+1]=Math.min(255,r*.349+o*.686+a*.168),i[s+2]=Math.min(255,r*.272+o*.534+a*.131)}};return Ji.Sepia=t,Ji}var Zi={},$a;function Ad(){if($a)return Zi;$a=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.Solarize=void 0;const t=function(e){const i=e.data,n=e.width,s=e.height,r=n*4;let o=s;do{const a=(o-1)*r;let l=n;do{const c=a+(l-1)*4;let d=i[c],p=i[c+1],g=i[c+2];d>127&&(d=255-d),p>127&&(p=255-p),g>127&&(g=255-g),i[c]=d,i[c+1]=p,i[c+2]=g}while(--l)}while(--o)};return Zi.Solarize=t,Zi}var tn={},Qa;function Md(){if(Qa)return tn;Qa=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.Threshold=void 0;const t=ft(),e=Et(),i=gt(),n=function(s){const r=this.threshold()*255,o=s.data,a=o.length;for(let l=0;l<a;l+=1)o[l]=o[l]<r?0:255};return tn.Threshold=n,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),tn}var Ja;function Nd(){if(Ja)return gi;Ja=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.Konva=void 0;const t=Qh(),e=Jh(),i=td(),n=ed(),s=id(),r=nd(),o=rd(),a=ga(),l=Ur(),c=Ca(),d=sd(),p=od(),g=ad(),u=ld(),f=Aa(),y=cd(),S=hd(),x=dd(),m=ud(),h=fd(),_=gd(),v=pd(),R=md(),I=_d(),w=yd(),C=bd(),T=vd(),M=Sd(),D=wd(),G=Cd(),B=xd(),L=Pd(),$=Td(),b=Rd(),P=Ed(),N=Ad(),A=Md();return gi.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:i.Arrow,Circle:n.Circle,Ellipse:s.Ellipse,Image:r.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:l.Path,Rect:c.Rect,RegularPolygon:d.RegularPolygon,Ring:p.Ring,Sprite:g.Sprite,Star:u.Star,Text:f.Text,TextPath:y.TextPath,Transformer:S.Transformer,Wedge:x.Wedge,Filters:{Blur:m.Blur,Brighten:h.Brighten,Contrast:_.Contrast,Emboss:v.Emboss,Enhance:R.Enhance,Grayscale:I.Grayscale,HSL:w.HSL,HSV:C.HSV,Invert:T.Invert,Kaleidoscope:M.Kaleidoscope,Mask:D.Mask,Noise:G.Noise,Pixelate:B.Pixelate,Posterize:L.Posterize,RGB:$.RGB,RGBA:b.RGBA,Sepia:P.Sepia,Solarize:N.Solarize,Threshold:A.Threshold}}),gi}var kd=In.exports,Za;function Fd(){if(Za)return In.exports;Za=1,Object.defineProperty(kd,"__esModule",{value:!0});const t=Nd();return In.exports=t.Konva,In.exports}var Id=Fd();const Ft=jh(Id),Od=()=>({stage:void 0,konvaContainer:void 0,notes:new Map,selection:{selectedIds:new Set,selectionRect:void 0},viewport:{scrollX:0,scrollY:55*20,zoomX:1,zoomY:1},grid:{quarterNoteWidth:120,noteHeight:20,baseQuarterNoteWidth:120,baseNoteHeight:20,subdivision:16,numMeasures:100,timeSignature:4,maxLength:64,backgroundColor1:"#ddd",backgroundColor2:"#bbb",noteColor:"#f23",selectedNoteColor:"#2ee"},interaction:{isDragging:!1,dragStartPos:void 0,draggedNoteInitialStates:new Map,quantDragActivated:!1,dragBeforeState:void 0,isResizing:!1,resizeTargetId:void 0,resizeIsEnd:!1,resizeInitialStates:new Map,quantResizeActivated:!1,resizeBeforeState:void 0,isMarqueeSelecting:!1,marqueeStart:void 0,marqueeCurrent:void 0,marqueeIsShift:!1,hiddenNoteIds:new Set,truncatedNotes:new Map,createEmptyOverlapAdjustments:()=>({toDelete:new Set,toTruncate:new Map})},command:{stack:void 0},layers:{grid:void 0,notes:void 0,overlay:void 0},renderCache:{grid:{lastScrollX:-1,lastScrollY:-1,lastSubdivision:-1,lastQuarterNoteWidth:-1,lastNoteHeight:-1}},needsRedraw:!1,rafHandle:void 0,queuePlayhead:{position:0,element:void 0},livePlayhead:{position:0,element:void 0},notifyExternalChange:void 0}),Dd=(t="note_")=>`${t}${Date.now()}_${Math.random().toString(36).substr(2,9)}`;function tl(t,e){const{scrollX:i,scrollY:n}=e.viewport,{quarterNoteWidth:s,noteHeight:r}=e.grid,o=t.x+i,a=t.y+n,l=o/s;return{pitch:127-Math.floor(a/r),position:l}}function Ln(t,e,i){const{scrollX:n,scrollY:s}=i.viewport,{quarterNoteWidth:r,noteHeight:o}=i.grid,a=e*r,l=(127-t)*o;return{x:a-n,y:l-s}}function el(t,e){const i=e/4;return Math.floor(t*i)/i}function il(t){return t.grid.quarterNoteWidth*(4/t.grid.subdivision)}function nl(t,e){const{scrollX:i,scrollY:n}=e.viewport,{quarterNoteWidth:s,noteHeight:r}=e.grid,o=e.stage;if(!o)return!1;const a=o.width(),l=o.height(),c=i/s,d=(i+a)/s,p=Math.floor(n/r),g=Math.ceil((n+l)/r),u=t.position+t.duration,f=127-t.pitch;return!(u<c||t.position>d||f<p||f>g)}function Ld(t,e){const{scrollX:i,scrollY:n}=t.viewport,{quarterNoteWidth:s,noteHeight:r}=t.grid,o=[];return t.notes.forEach((a,l)=>{const c=Ln(a.pitch,a.position,t),d=a.duration*s,p=c.x+d,g=c.y+r,u=e.x+e.width,f=e.y+e.height;!(p<e.x||c.x>u||g<e.y||c.y>f)&&o.push(l)}),o}function rl(t,e){const i=new Set(e);if(i.size===0)return t.interaction.createEmptyOverlapAdjustments();const n=new Set,s=new Map;return i.forEach(r=>{const o=t.notes.get(r);if(!o)return;const a=o.position+o.duration;t.notes.forEach((l,c)=>{if(i.has(c)||l.pitch!==o.pitch)return;const d=l.position+l.duration;if(l.position<o.position&&o.position<d){const p=o.position-l.position;p>0?n.has(c)||s.set(c,p):(n.add(c),s.delete(c))}else o.position<=l.position&&l.position<a&&(n.add(c),s.delete(c))})}),n.size===0&&s.size===0?t.interaction.createEmptyOverlapAdjustments():{toDelete:n,toTruncate:s}}function sl(t){t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear();const e=rl(t,t.selection.selectedIds);e.toDelete.forEach(i=>t.interaction.hiddenNoteIds.add(i)),e.toTruncate.forEach((i,n)=>t.interaction.truncatedNotes.set(n,i))}function Gd(t,e,i){return t.interaction.truncatedNotes.get(e)??i}function Br(t,e){let i=null,n=!1;if(!e&&(t.interaction.hiddenNoteIds.size>0||t.interaction.truncatedNotes.size>0))i={toDelete:new Set(t.interaction.hiddenNoteIds),toTruncate:new Map(t.interaction.truncatedNotes)},n=!0;else{const s=e??t.selection.selectedIds;i=rl(t,s)}return i.toDelete.size===0&&i.toTruncate.size===0?(n||(t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear()),i):(i.toDelete.forEach(s=>{t.notes.delete(s),t.selection.selectedIds.delete(s)}),i.toTruncate.forEach((s,r)=>{const o=t.notes.get(r);o&&(o.duration=Math.max(s,0))}),t.needsRedraw=!0,n||(t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear()),i)}function ol(t){t.interaction.truncatedNotes.clear(),t.interaction.hiddenNoteIds.clear()}function Ud(t){let i=null;for(const n of t.selection.selectedIds){const s=t.notes.get(n);if(!s)continue;let r=1/0,o=null;if(t.notes.forEach((a,l)=>{if(t.selection.selectedIds.has(l))return;const c=Math.abs(s.position-a.position);c<r&&c<.1&&(r=c,o=a.position)}),o!==null){i=o-s.position;break}}i!==null&&t.selection.selectedIds.forEach(n=>{const s=t.notes.get(n);s&&(s.position+=i)})}const Bd=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function al(t){return Bd[t%12]+(Math.floor(t/12)-2)}class Hd{constructor(e,i,n){this.captureState=e,this.restoreState=i,this.onChangeCallback=n}stack=[];currentIndex=-1;onChangeCallback;executeCommand(e,i){const n=this.captureState();i();const s=this.captureState();n!==s&&this.pushCommand(e,n,s)}pushCommand(e,i,n){this.stack=this.stack.slice(0,this.currentIndex+1),this.stack.push({name:e,beforeState:i,afterState:n}),this.currentIndex++,this.onChangeCallback?.()}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.stack.length-1}undo(){if(!this.canUndo())return;const e=this.stack[this.currentIndex];this.restoreState(e.beforeState),this.currentIndex--,this.onChangeCallback?.()}redo(){if(!this.canRedo())return;this.currentIndex++;const e=this.stack[this.currentIndex];this.restoreState(e.afterState),this.onChangeCallback?.()}clear(){this.stack=[],this.currentIndex=-1,this.onChangeCallback?.()}}function en(t){return JSON.stringify({notes:Array.from(t.notes.entries()),selection:Array.from(t.selection.selectedIds)})}function Vd(t,e){const i=JSON.parse(e);t.notes=new Map(i.notes),t.selection.selectedIds=new Set(i.selection),t.needsRedraw=!0}function zd(t,e){if(t.size!==e.size)return!0;for(const i of t)if(!e.has(i))return!0;return!1}function Hr(t,e){const i=new Set(t.selection.selectedIds);e();const n=zd(i,t.selection.selectedIds);return n&&t.notifyExternalChange?.(),n}function qd(t,e,i){const n=new Ft.Layer({listening:!1,name:"grid-layer"});e.add(n),t.layers.grid=n;const s=new Ft.Layer({name:"notes-layer"});e.add(s),t.layers.notes=s;const r=new Ft.Layer({name:"overlay-layer"});e.add(r),t.layers.overlay=r,t.selection.selectionRect=new Ft.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),r.add(t.selection.selectionRect);const o=128*t.grid.noteHeight;t.queuePlayhead.element=new Ft.Line({points:[0,0,0,o],stroke:"#00ff00",strokeWidth:2,listening:!1}),r.add(t.queuePlayhead.element),t.livePlayhead.element=new Ft.Line({points:[0,0,0,o],stroke:"#ff8800",strokeWidth:2,listening:!1}),r.add(t.livePlayhead.element),t.command.stack=new Hd(()=>en(t),a=>Vd(t,a),()=>{t.needsRedraw=!0,i?.()})}function Wd(t){const e=t.layers.grid;if(!e||!t.stage)return;const i=t.renderCache.grid;if(i.lastScrollX===t.viewport.scrollX&&i.lastScrollY===t.viewport.scrollY&&i.lastSubdivision===t.grid.subdivision&&i.lastQuarterNoteWidth===t.grid.quarterNoteWidth&&i.lastNoteHeight===t.grid.noteHeight)return;i.lastScrollX=t.viewport.scrollX,i.lastScrollY=t.viewport.scrollY,i.lastSubdivision=t.grid.subdivision,i.lastQuarterNoteWidth=t.grid.quarterNoteWidth,i.lastNoteHeight=t.grid.noteHeight,e.destroyChildren();const{scrollX:n,scrollY:s}=t.viewport,{quarterNoteWidth:r,noteHeight:o,numMeasures:a,timeSignature:l}=t.grid,c=t.stage,d=c.width(),p=c.height(),g=128*o,u=l*4,f=r*u,y=Math.floor(n/f),S=Math.ceil((n+d)/f);for(let I=y;I<=S&&I<a;I++){const w=I%2===0?t.grid.backgroundColor1:t.grid.backgroundColor2,C=I*f-n;e.add(new Ft.Rect({x:C,y:-s,width:f,height:g,fill:w,listening:!1}))}const x=a*u*(t.grid.subdivision/4),m=r*(4/t.grid.subdivision),h=Math.floor(n/m),_=Math.ceil((n+d)/m);for(let I=h;I<=_&&I<x;I++){const w=I*m-n,T=I*m%r===0?1.8:1;e.add(new Ft.Line({points:[w,-s,w,g-s],stroke:"#000",strokeWidth:T,listening:!1}))}const v=Math.floor(s/o),R=Math.ceil((s+p)/o);for(let I=v;I<=R&&I<128;I++){const w=I*o-s;e.add(new Ft.Line({points:[0-n,w,a*f-n,w],stroke:"#000",strokeWidth:1,listening:!1}))}e.batchDraw()}function Kd(t){const e=t.layers.notes;if(!e||!t.stage)return;e.destroyChildren();const{scrollX:i,scrollY:n}=t.viewport,{quarterNoteWidth:s,noteHeight:r}=t.grid,o=[],a=[];t.notes.forEach((l,c)=>{nl(l,t)&&(t.selection.selectedIds.has(c)?a.push([c,l]):o.push([c,l]))}),o.forEach(([l,c])=>{const d=Ln(c.pitch,c.position,t),g=Gd(t,l,c.duration)*s,u=t.interaction.hiddenNoteIds.has(l),f=new Ft.Rect({x:d.x,y:d.y,width:g,height:r,fill:t.grid.noteColor,stroke:"#000",strokeWidth:1,opacity:u?.3:1,listening:!0});f.setAttr("noteId",l),e.add(f);const y=al(c.pitch),S=new Ft.Text({x:d.x+4,y:d.y+2,text:y,fontSize:14,fill:"#000",listening:!1});e.add(S)}),a.forEach(([l,c])=>{const d=Ln(c.pitch,c.position,t),p=c.duration*s,g=t.interaction.hiddenNoteIds.has(l),u=new Ft.Rect({x:d.x,y:d.y,width:p,height:r,fill:t.grid.selectedNoteColor,stroke:"#000",strokeWidth:1,opacity:g?.3:1,listening:!0});u.setAttr("noteId",l),e.add(u);const f=al(c.pitch),y=new Ft.Text({x:d.x+4,y:d.y+2,text:f,fontSize:14,fill:"#000",listening:!1});e.add(y)}),e.batchDraw()}function jd(t){const e=t.layers.notes;if(!e)return;const{quarterNoteWidth:i,noteHeight:n}=t.grid,s=5;e.find(".resize-handle").forEach(r=>r.destroy()),t.selection.selectedIds.forEach(r=>{const o=t.notes.get(r);if(!o||!nl(o,t))return;const a=Ln(o.pitch,o.position,t),l=o.duration*i,c=new Ft.Circle({x:a.x,y:a.y+n/2,radius:s,fill:"#000",listening:!0,name:"resize-handle"});c.setAttr("handleNoteId",r),c.setAttr("handleIsEnd",!1),e.add(c);const d=new Ft.Circle({x:a.x+l,y:a.y+n/2,radius:s,fill:"#000",listening:!0,name:"resize-handle"});d.setAttr("handleNoteId",r),d.setAttr("handleIsEnd",!0),e.add(d)}),e.batchDraw()}function Yd(t){if(!t.selection.selectionRect||!t.interaction.marqueeStart||!t.interaction.marqueeCurrent)return;const e=t.interaction.marqueeStart,i=t.interaction.marqueeCurrent,n=Math.min(e.x,i.x),s=Math.min(e.y,i.y),r=Math.abs(i.x-e.x),o=Math.abs(i.y-e.y);t.selection.selectionRect.setAttrs({x:n,y:s,width:r,height:o,visible:r>5||o>5}),t.layers.overlay?.batchDraw()}function Xd(t){if(!t.queuePlayhead.element)return;const{scrollX:e}=t.viewport,i=t.queuePlayhead.position*t.grid.quarterNoteWidth-e;t.queuePlayhead.element.x(i),t.layers.overlay?.batchDraw()}function $d(t){if(!t.livePlayhead.element)return;const{scrollX:e}=t.viewport,i=t.livePlayhead.position*t.grid.quarterNoteWidth-e;t.livePlayhead.element.x(i),t.layers.overlay?.batchDraw()}function Qd(t,e){t.layers.notes;const i=t.layers.grid;e.on("dblclick",n=>{if(n.target===e||n.target.getLayer()===i){const s=e.getPointerPosition();if(!s)return;const{pitch:r,position:o}=tl(s,t),a=el(o,t.grid.subdivision),l=Math.round(r);t.command.stack?.executeCommand("Add Note",()=>{const c={id:Dd(),pitch:l,position:a,duration:4/t.grid.subdivision,velocity:.8};t.notes.set(c.id,c),t.needsRedraw=!0})}}),e.on("mousedown touchstart",n=>{const s=n.target,r=s.getAttr?.("handleNoteId");if(r){const a=s.getAttr("handleIsEnd");eu(t,e,r,a);return}const o=s.getAttr?.("noteId");if(o){const a=n.evt.shiftKey||n.evt.ctrlKey,l=t.selection.selectedIds.has(o);Hr(t,()=>{a?l?t.selection.selectedIds.delete(o):t.selection.selectedIds.add(o):(!l||t.selection.selectedIds.size>1)&&(t.selection.selectedIds.clear(),t.selection.selectedIds.add(o))}),Jd(t,e),t.needsRedraw=!0;return}if(s===e||s.getLayer()===i){const a=e.getPointerPosition();if(!a)return;t.interaction.isMarqueeSelecting=!0,t.interaction.marqueeStart=a,t.interaction.marqueeCurrent=a,t.interaction.marqueeIsShift=n.evt.shiftKey||n.evt.ctrlKey,t.interaction.marqueeIsShift||Hr(t,()=>{t.selection.selectedIds.clear()}),t.needsRedraw=!0}}),e.on("mousemove touchmove",n=>{const s=e.getPointerPosition();if(s){if(t.interaction.isDragging){Zd(t,e);return}if(t.interaction.isResizing){iu(t,e);return}if(t.interaction.isMarqueeSelecting){t.interaction.marqueeCurrent=s,Yd(t);const r={x:Math.min(t.interaction.marqueeStart.x,s.x),y:Math.min(t.interaction.marqueeStart.y,s.y),width:Math.abs(s.x-t.interaction.marqueeStart.x),height:Math.abs(s.y-t.interaction.marqueeStart.y)},o=Ld(t,r);Hr(t,()=>{t.interaction.marqueeIsShift?o.forEach(a=>{t.selection.selectedIds.add(a)}):(t.selection.selectedIds.clear(),o.forEach(a=>{t.selection.selectedIds.add(a)}))}),t.needsRedraw=!0}}}),e.on("mouseup touchend",n=>{if(t.interaction.isDragging){tu(t);return}if(t.interaction.isResizing){nu(t);return}if(t.interaction.isMarqueeSelecting){const s=t.interaction.marqueeStart&&t.interaction.marqueeCurrent&&Math.abs(t.interaction.marqueeStart.x-t.interaction.marqueeCurrent.x)<5&&Math.abs(t.interaction.marqueeStart.y-t.interaction.marqueeCurrent.y)<5;if(t.interaction.isMarqueeSelecting=!1,t.selection.selectionRect&&(t.selection.selectionRect.visible(!1),t.layers.overlay?.batchDraw()),s&&n.target===e||n.target.getLayer()===i){const r=e.getPointerPosition();if(r){const{position:o}=tl(r,t),a=el(o,t.grid.subdivision);t.queuePlayhead.position=Math.max(0,Math.min(a,t.grid.maxLength)),t.needsRedraw=!0,t.notifyExternalChange?.()}}}})}function Jd(t,e){const i=e.getPointerPosition();i&&(t.interaction.isDragging=!0,t.interaction.dragStartPos=i,t.interaction.quantDragActivated=!1,t.interaction.dragBeforeState=en(t),t.interaction.draggedNoteInitialStates.clear(),t.selection.selectedIds.forEach(n=>{const s=t.notes.get(n);s&&t.interaction.draggedNoteInitialStates.set(n,{position:s.position,pitch:s.pitch})}))}function Zd(t,e){const i=e.getPointerPosition();if(!i||!t.interaction.dragStartPos)return;const n=i.x-t.interaction.dragStartPos.x,s=i.y-t.interaction.dragStartPos.y,r=il(t);let o;Math.abs(n)<r*.9&&!t.interaction.quantDragActivated?o=n:(o=Math.round(n/r)*r,t.interaction.quantDragActivated=!0);const a=Math.round(s/t.grid.noteHeight);t.interaction.draggedNoteInitialStates.forEach((l,c)=>{const d=t.notes.get(c);d&&(d.position=l.position+o/t.grid.quarterNoteWidth,d.pitch=Math.max(0,Math.min(127,l.pitch-a)))}),Ud(t),sl(t),t.needsRedraw=!0}function tu(t){Br(t);const e=en(t);t.interaction.dragBeforeState&&t.interaction.dragBeforeState!==e&&t.command.stack?.pushCommand("Move Notes",t.interaction.dragBeforeState,e),t.interaction.isDragging=!1,ol(t),t.needsRedraw=!0}function eu(t,e,i,n){const s=e.getPointerPosition();s&&(t.interaction.isResizing=!0,t.interaction.resizeTargetId=i,t.interaction.resizeIsEnd=n,t.interaction.quantResizeActivated=!1,t.interaction.dragStartPos=s,t.interaction.resizeBeforeState=en(t),t.interaction.resizeInitialStates.clear(),t.selection.selectedIds.forEach(r=>{const o=t.notes.get(r);o&&t.interaction.resizeInitialStates.set(r,{position:o.position,duration:o.duration})}))}function iu(t,e){const i=e.getPointerPosition();if(!i||!t.interaction.dragStartPos)return;const n=i.x-t.interaction.dragStartPos.x,s=il(t);let r;Math.abs(n)<s*.9&&!t.interaction.quantResizeActivated?r=n:(r=Math.round(n/s)*s,t.interaction.quantResizeActivated=!0);const o=r/t.grid.quarterNoteWidth;t.interaction.resizeInitialStates.forEach((a,l)=>{const c=t.notes.get(l);c&&(t.interaction.resizeIsEnd?c.duration=Math.max(.25,a.duration+o):(c.position=a.position+o,c.duration=Math.max(.25,a.duration-o)))}),sl(t),t.needsRedraw=!0}function nu(t){Br(t);const e=en(t);t.interaction.resizeBeforeState&&t.interaction.resizeBeforeState!==e&&t.command.stack?.pushCommand("Resize Notes",t.interaction.resizeBeforeState,e),t.interaction.isResizing=!1,ol(t),t.needsRedraw=!0}const qe=.25,We=1,Ut=128,ll=4,cl=12,ru=55,St=(t,e,i)=>i<e?e:Math.min(Math.max(t,e),i),Ke=(t,e)=>t.stage?.width()??e,je=(t,e)=>t.stage?.height()??e,su=t=>t.grid.maxLength*t.grid.quarterNoteWidth,ou=t=>Ut*t.grid.noteHeight,au=(t,e)=>{t.grid.quarterNoteWidth=e,t.viewport.zoomX=e/t.grid.baseQuarterNoteWidth},lu=(t,e)=>{t.grid.noteHeight=e,t.viewport.zoomY=e/t.grid.baseNoteHeight},cu=(t,e)=>{const i=t.grid.quarterNoteWidth,n=Ke(t,e),s=i===0?0:t.viewport.scrollX/i,r=s+n/(i||1);return{startQuarter:s,endQuarter:r}},hu=(t,e)=>{const i=t.grid.noteHeight,n=je(t,e),s=i===0?0:t.viewport.scrollY/i,r=s+n/(i||1);return{topIndex:s,bottomIndex:r}},Vr=(t,e,i,n)=>{const s=Ke(t,e),r=je(t,i),o=Math.max(0,su(t)-s),a=St(t.viewport.scrollX,0,o);a!==t.viewport.scrollX&&(t.viewport.scrollX=a,t.needsRedraw=!0,n());const l=Math.max(0,ou(t)-r),c=St(t.viewport.scrollY,0,l);c!==t.viewport.scrollY&&(t.viewport.scrollY=c,t.needsRedraw=!0,n())},zr=(t,e,i,n,s,r)=>{if(!Number.isFinite(e)||e<=0)return;au(t,e);const a=Ke(t,n)/t.grid.quarterNoteWidth,l=Math.max(0,t.grid.maxLength-a),c=St(i,0,l);t.viewport.scrollX=c*t.grid.quarterNoteWidth,Vr(t,n,s,r),t.needsRedraw=!0,r()},qr=(t,e,i,n,s,r)=>{if(!Number.isFinite(e)||e<=0)return;lu(t,e);const a=je(t,s)/t.grid.noteHeight,l=Math.max(0,Ut-a),c=St(i,0,l);t.viewport.scrollY=c*t.grid.noteHeight,Vr(t,n,s,r),t.needsRedraw=!0,r()},du=(t,e,i,n)=>{const s=Ke(t,e),r=je(t,i);if(s<=0||r<=0)return;const o=Array.from(t.notes.values());if(o.length===0){const D=s/ll;zr(t,D,0,e,i,n);const G=cl,B=r/G,L=127-ru,$=Math.max(0,Ut-G),b=St(L-(G-1),0,$);qr(t,B,b,e,i,n);return}const a=o.reduce((M,D)=>Math.min(M,D.position),Number.POSITIVE_INFINITY),l=o.reduce((M,D)=>Math.max(M,D.position+D.duration),Number.NEGATIVE_INFINITY),c=Math.max(l-a,0),d=Math.max(c,ll),p=s/d,g=Math.max(0,t.grid.maxLength-d),u=Math.max(d-c,0),f=a-u/2,y=St(f,0,g);zr(t,p,y,e,i,n);const S=o.reduce((M,D)=>Math.max(M,D.pitch),Number.NEGATIVE_INFINITY),x=o.reduce((M,D)=>Math.min(M,D.pitch),Number.POSITIVE_INFINITY),m=127-S,h=127-x,_=Math.max(h-m+1,1),v=Math.max(_,cl),R=r/v,I=Math.max(v-_,0),w=m-I/2,C=Math.max(0,Ut-v),T=St(w,0,C);qr(t,R,T,e,i,n)};class uu{constructor(e){this.options=e}dragState=null;getThumbMetrics=()=>{const e=this.options.state.grid.maxLength;if(e<=0)return{start:0,size:1};const i=this.options.state.grid.quarterNoteWidth,n=Ke(this.options.state,this.options.getFallbackWidth());if(i<=0||n<=0)return{start:0,size:1};const s=this.options.state.viewport.scrollX/i,r=n/i,o=Math.min(1,r/e);if(o>=1)return{start:0,size:1};const a=s/e;return{start:St(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:e,size:i}=this.getThumbMetrics(),n=St(i,0,1),s=Math.min(1,Math.max(n,.01));return{left:`${St(e,0,1-s)*100}%`,width:`${s*100}%`}};startDrag=(e,i)=>{if(!this.options.isInteractive())return;const n=this.options.horizontalTrack.value;if(!n)return;this.stopDrag();const s=n.getBoundingClientRect();if(s.width<=0)return;const{startQuarter:r,endQuarter:o}=this.options.getViewportRange(),a=Math.max(qe,o-r),l=Ke(this.options.state,this.options.getFallbackWidth()),c=this.options.state.grid.maxLength;if(l<=0||c<=0)return;const d=r/c,p=o/c;let g=0;e==="resize-start"?g=i.clientX-(s.left+d*s.width):e==="resize-end"&&(g=i.clientX-(s.left+p*s.width)),this.dragState={mode:e,pointerId:i.pointerId,pointerStart:i.clientX,trackRect:s,startQuarter:r,endQuarter:o,anchorQuarter:e==="resize-start"?o:r,spanQuarter:a,stageWidth:l,pointerOffset:g},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),i.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=e=>{const i=this.dragState;if(!i||e.pointerId!==i.pointerId)return;const n=this.options.state.grid.maxLength,s=i.trackRect;if(n<=0||s.width<=0||i.stageWidth<=0)return;if(e.preventDefault(),i.mode==="move"){const c=(e.clientX-i.pointerStart)/s.width*n,d=Math.max(0,n-i.spanQuarter),p=St(i.startQuarter+c,0,d);this.options.state.viewport.scrollX=p*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const r=St(e.clientX,s.left,s.right),a=(St(r-i.pointerOffset,s.left,s.right)-s.left)/s.width;if(i.mode==="resize-start"){let l=a*n;const c=i.anchorQuarter-qe;l=St(l,0,Math.max(0,c));const d=Math.max(qe,i.anchorQuarter-l),p=i.stageWidth/d;this.options.applyHorizontalZoom(p,l),i.startQuarter=l,i.spanQuarter=d;return}if(i.mode==="resize-end"){let l=a*n;const c=i.anchorQuarter+qe;l=St(l,Math.min(c,n),n);const d=Math.max(qe,l-i.anchorQuarter),p=i.stageWidth/d;this.options.applyHorizontalZoom(p,i.anchorQuarter),i.endQuarter=l,i.spanQuarter=d}};onTrackPointerDown=e=>{if(!this.options.isInteractive())return;const i=this.options.horizontalTrack.value;if(!i)return;const n=i.getBoundingClientRect();if(n.width<=0)return;const s=St((e.clientX-n.left)/n.width,0,1),{startQuarter:r,endQuarter:o}=this.options.getViewportRange(),a=Math.max(qe,o-r),l=this.options.state.grid.maxLength,c=Math.max(0,l-a),d=St(s*l-a/2,0,c);this.options.state.viewport.scrollX=d*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}class fu{constructor(e){this.options=e}dragState=null;getThumbMetrics=()=>{const e=Ut,i=this.options.state.grid.noteHeight,n=je(this.options.state,this.options.getFallbackHeight());if(i<=0||n<=0)return{start:0,size:1};const s=this.options.state.viewport.scrollY/i,r=n/i,o=Math.min(1,r/e);if(o>=1)return{start:0,size:1};const a=s/e;return{start:St(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:e,size:i}=this.getThumbMetrics(),n=St(i,0,1),s=Math.min(1,Math.max(n,.01));return{top:`${St(e,0,1-s)*100}%`,height:`${s*100}%`}};startDrag=(e,i)=>{if(!this.options.isInteractive())return;const n=this.options.verticalTrack.value;if(!n)return;this.stopDrag();const s=n.getBoundingClientRect();if(s.height<=0)return;const{topIndex:r,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(We,o-r),l=je(this.options.state,this.options.getFallbackHeight());if(l<=0)return;const c=r/Ut,d=o/Ut;let p=0;e==="resize-start"?p=i.clientY-(s.top+c*s.height):e==="resize-end"&&(p=i.clientY-(s.top+d*s.height)),this.dragState={mode:e,pointerId:i.pointerId,pointerStart:i.clientY,trackRect:s,topIndex:r,bottomIndex:o,anchorIndex:e==="resize-start"?o:r,span:a,stageHeight:l,pointerOffset:p},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),i.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=e=>{const i=this.dragState;if(!i||e.pointerId!==i.pointerId)return;const n=i.trackRect;if(n.height<=0||i.stageHeight<=0)return;if(e.preventDefault(),i.mode==="move"){const l=(e.clientY-i.pointerStart)/n.height*Ut,c=Math.max(0,Ut-i.span),d=St(i.topIndex+l,0,c);this.options.state.viewport.scrollY=d*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const s=St(e.clientY,n.top,n.bottom),o=(St(s-i.pointerOffset,n.top,n.bottom)-n.top)/n.height;if(i.mode==="resize-start"){let a=o*Ut;const l=i.anchorIndex-We;a=St(a,0,Math.max(0,l));const c=Math.max(We,i.anchorIndex-a),d=i.stageHeight/c;this.options.applyVerticalZoom(d,a),i.topIndex=a,i.span=c;return}if(i.mode==="resize-end"){let a=o*Ut;const l=i.anchorIndex+We;a=St(a,Math.min(l,Ut),Ut);const c=Math.max(We,a-i.anchorIndex),d=i.stageHeight/c;this.options.applyVerticalZoom(d,i.anchorIndex),i.bottomIndex=a,i.span=c}};onTrackPointerDown=e=>{if(!this.options.isInteractive())return;const i=this.options.verticalTrack.value;if(!i)return;const n=i.getBoundingClientRect();if(n.height<=0)return;const s=St((e.clientY-n.top)/n.height,0,1),{topIndex:r,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(We,o-r),l=Math.max(0,Ut-a),c=St(s*Ut-a/2,0,l);this.options.state.viewport.scrollY=c*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}const gu=({state:t,canUndo:e,canRedo:i,emitStateUpdate:n})=>{const s=()=>{e.value=t.command.stack?.canUndo()??!1,i.value=t.command.stack?.canRedo()??!1};return{undo:()=>{t.command.stack?.undo(),s()},redo:()=>{t.command.stack?.redo(),s()},deleteSelected:()=>{t.selection.selectedIds.size!==0&&(t.command.stack?.executeCommand("Delete Selected",()=>{t.selection.selectedIds.forEach(c=>t.notes.delete(c)),t.selection.selectedIds.clear(),t.needsRedraw=!0}),s())},updateCommandStackButtons:s,handleCommandStackUpdate:()=>{s(),n()}}},pu=({state:t,isInteractive:e,undo:i,redo:n,deleteSelected:s,updateCommandStackButtons:r,executeOverlapChanges:o})=>{let a=!1;const l=p=>{if(e()){if((p.metaKey||p.ctrlKey)&&p.key==="z"&&!p.shiftKey){p.preventDefault(),i();return}if((p.metaKey||p.ctrlKey)&&p.key==="z"&&p.shiftKey){p.preventDefault(),n();return}if(p.key==="Backspace"||p.key==="Delete"){p.preventDefault(),s();return}if(p.key.startsWith("Arrow")&&t.selection.selectedIds.size>0){p.preventDefault(),t.command.stack?.executeCommand("Move Selection",()=>{t.selection.selectedIds.forEach(g=>{const u=t.notes.get(g);if(u)switch(p.key){case"ArrowUp":u.pitch=Math.min(127,u.pitch+1);break;case"ArrowDown":u.pitch=Math.max(0,u.pitch-1);break;case"ArrowLeft":u.position=Math.max(0,u.position-.25);break;case"ArrowRight":u.position+=.25;break}}),o(t,t.selection.selectedIds),t.needsRedraw=!0}),r();return}if((p.metaKey||p.ctrlKey)&&p.key==="c"&&t.selection.selectedIds.size>0){p.preventDefault();const g=Array.from(t.selection.selectedIds).map(f=>{const y=t.notes.get(f);return y?{...y}:null}).filter(f=>f!==null);if(g.length===0)return;const u=Math.min(...g.map(f=>f.position));sessionStorage.setItem("copiedPianoRollNotes",JSON.stringify({notes:g.map(f=>({...f,position:f.position-u}))}));return}if((p.metaKey||p.ctrlKey)&&p.key==="v"){p.preventDefault();const g=sessionStorage.getItem("copiedPianoRollNotes");if(!g)return;try{const{notes:u}=JSON.parse(g);t.command.stack?.executeCommand("Paste Notes",()=>{t.selection.selectedIds.clear(),u.forEach(f=>{const y={...f,id:`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,position:t.queuePlayhead.position+f.position};t.notes.set(y.id,y),t.selection.selectedIds.add(y.id)}),o(t,t.selection.selectedIds),t.needsRedraw=!0}),r()}catch(u){console.error("Failed to paste notes",u)}}}};return{attach:()=>{a||(window.addEventListener("keydown",l),a=!0)},detach:()=>{a&&(window.removeEventListener("keydown",l),a=!1)},isAttached:()=>a}};class mu{constructor(e){this.deps=e}eventHandlersInitialized=!1;keyboardAttached=!1;renderFrame=()=>{this.deps.state.needsRedraw&&(this.deps.renderGrid(this.deps.state),this.deps.renderVisibleNotes(this.deps.state),this.deps.renderResizeHandles(this.deps.state),this.deps.updateQueuePlayheadPosition(this.deps.state),this.deps.updateLivePlayheadPosition(this.deps.state),this.deps.state.needsRedraw=!1),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)};startRenderLoop(){this.stopRenderLoop(),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)}stopRenderLoop(){this.deps.state.rafHandle&&(cancelAnimationFrame(this.deps.state.rafHandle),this.deps.state.rafHandle=void 0)}enableInteractivity(){this.deps.state.stage&&(this.eventHandlersInitialized||(this.deps.setupEventHandlers(this.deps.state,this.deps.state.stage),this.eventHandlersInitialized=!0),this.deps.state.stage.listening(!0),this.keyboardAttached||(this.deps.attachKeyboard(),this.keyboardAttached=!0))}disableInteractivity(){this.deps.state.stage&&(this.deps.state.stage.listening(!1),this.deps.state.interaction.isDragging=!1,this.deps.state.interaction.isResizing=!1,this.deps.state.interaction.isMarqueeSelecting=!1,this.deps.state.selection.selectionRect?.visible(!1),this.keyboardAttached&&(this.deps.detachKeyboard(),this.keyboardAttached=!1),this.deps.state.layers.overlay?.batchDraw(),this.deps.syncUiCounters())}mount({width:e,height:i,interactive:n,initialNotes:s}){if(!this.deps.konvaContainer.value){console.error("Konva container ref not found");return}const r=new Ft.Stage({container:this.deps.konvaContainer.value,width:e,height:i});this.deps.state.stage=r,this.deps.state.konvaContainer=this.deps.konvaContainer.value,this.deps.initializeLayers(this.deps.state,r,this.deps.handleCommandStackUpdate),n?this.enableInteractivity():this.disableInteractivity(),s.length>0&&(this.deps.state.notes=new Map(s),this.deps.state.needsRedraw=!0,this.deps.syncUiCounters()),this.startRenderLoop(),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds(),this.deps.handleCommandStackUpdate()}unmount(){this.stopRenderLoop(),this.disableInteractivity(),this.deps.state.stage?.destroy(),this.deps.state.stage=void 0,this.deps.state.konvaContainer=void 0,this.eventHandlersInitialized=!1}setInteractive(e){this.deps.state.stage&&(e?this.enableInteractivity():this.disableInteractivity())}resize(e,i){this.deps.state.stage&&(this.deps.state.stage.width(e),this.deps.state.stage.height(i),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds())}}const _u={class:"piano-roll-root"},yu={key:0,class:"control-panel"},bu=["disabled"],vu=["disabled"],Su=["disabled"],wu=["disabled"],Cu={class:"info"},xu={class:"piano-roll-layout"},Pu={class:"stage-wrapper"},Tu=((t,e)=>{const i=t.__vccOpts||t;for(const[n,s]of e)i[n]=s;return i})(Ds({__name:"PianoRollRoot",props:{width:{default:640,type:Number},height:{default:360,type:Number},initialNotes:{default:()=>[],type:Array},syncState:{type:Function},showControlPanel:{type:Boolean,default:!0},interactive:{type:Boolean,default:!0}},emits:["notes-update"],setup(t,{expose:e,emit:i}){const n=t,s=i,r=Od();r.viewport=ii(r.viewport),r.grid=ii(r.grid);const o=ye(),a=ye(),l=ye(),c=ye(!1),d=ye(!1),p=ye(r.grid.subdivision),g=ye(r.notes.size),u=ye(r.selection.selectedIds.size),f=fi(()=>n.interactive),y=fi(()=>n.showControlPanel),S=()=>{g.value=r.notes.size,u.value=r.selection.selectedIds.size},x=()=>{n.syncState?.(r)},m=()=>{du(r,n.width,n.height,x)},h=()=>{Vr(r,n.width,n.height,x)},_=(X,j)=>{zr(r,X,j,n.width,n.height,x)},v=(X,j)=>{qr(r,X,j,n.width,n.height,x)},R=()=>cu(r,n.width),I=()=>hu(r,n.height),w=new uu({state:r,horizontalTrack:a,isInteractive:()=>n.interactive,getViewportRange:R,applyHorizontalZoom:_,enforceScrollBounds:h,notifyViewportChange:x,getFallbackWidth:()=>n.width}),C=new fu({state:r,verticalTrack:l,isInteractive:()=>n.interactive,getViewportRange:I,applyVerticalZoom:v,enforceScrollBounds:h,notifyViewportChange:x,getFallbackHeight:()=>n.height}),T=fi(()=>w.getThumbStyle()),M=fi(()=>C.getThumbStyle()),D=(X,j)=>{w.startDrag(X,j)},G=()=>{w.stopDrag()},B=(X,j)=>{C.startDrag(X,j)},L=()=>{C.stopDrag()},$=X=>{w.onTrackPointerDown(X)},b=X=>{C.onTrackPointerDown(X)};Me(p,X=>{r.grid.subdivision=X,r.needsRedraw=!0,n.syncState?.(r)});const P=()=>{S(),s("notes-update",Array.from(r.notes.entries())),n.syncState?.(r)};r.notifyExternalChange=()=>{P()};const{undo:N,redo:A,deleteSelected:O,updateCommandStackButtons:q,handleCommandStackUpdate:U}=gu({state:r,canUndo:c,canRedo:d,emitStateUpdate:P}),Q=pu({state:r,isInteractive:()=>n.interactive,undo:N,redo:A,deleteSelected:O,updateCommandStackButtons:q,executeOverlapChanges:Br}),et=new mu({state:r,konvaContainer:o,initializeLayers:qd,setupEventHandlers:Qd,renderGrid:Wd,renderVisibleNotes:Kd,renderResizeHandles:jd,updateQueuePlayheadPosition:Xd,updateLivePlayheadPosition:$d,handleCommandStackUpdate:U,syncUiCounters:S,enforceScrollBounds:h,attachKeyboard:()=>Q.attach(),detachKeyboard:()=>Q.detach()});return Bs(()=>{et.mount({width:n.width,height:n.height,interactive:n.interactive,initialNotes:n.initialNotes??[]})}),hr(()=>{G(),L(),et.unmount()}),Me(()=>n.interactive,X=>{et.setInteractive(X),X||(G(),L())}),Me(()=>n.width,X=>{et.resize(X,n.height)}),Me(()=>n.height,X=>{et.resize(n.width,X)}),e({setNotes:X=>{const j=new Set;r.notes.clear(),X.forEach((nt,E)=>{let F=nt.id||`note_${Date.now()}_${E}`;for(;j.has(F);)F=`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;j.add(F);const H={...nt,id:F,velocity:nt.velocity??100};r.notes.set(F,H)}),r.needsRedraw=!0,P()},setLivePlayheadPosition:X=>{r.livePlayhead.position=Math.max(0,Math.min(X,r.grid.maxLength)),r.needsRedraw=!0},getPlayStartPosition:()=>r.queuePlayhead.position,fitZoomToNotes:m}),(X,j)=>(br(),mo("div",_u,[y.value?(br(),mo("div",yu,[bt("button",{onClick:j[0]||(j[0]=(...nt)=>be(N)&&be(N)(...nt)),disabled:!f.value||!c.value},"↶ Undo",8,bu),bt("button",{onClick:j[1]||(j[1]=(...nt)=>be(A)&&be(A)(...nt)),disabled:!f.value||!d.value},"↷ Redo",8,vu),j[12]||(j[12]=bt("span",{class:"separator"},"|",-1)),bt("label",null,[j[11]||(j[11]=bo(" Grid: ")),dc(bt("select",{"onUpdate:modelValue":j[2]||(j[2]=nt=>p.value=nt),disabled:!f.value},j[10]||(j[10]=[bt("option",{value:4},"Quarter",-1),bt("option",{value:8},"Eighth",-1),bt("option",{value:16},"16th",-1),bt("option",{value:32},"32nd",-1)]),8,Su),[[Bh,p.value,void 0,{number:!0}]])]),j[13]||(j[13]=bt("span",{class:"separator"},"|",-1)),bt("button",{onClick:j[3]||(j[3]=(...nt)=>be(O)&&be(O)(...nt)),disabled:!f.value||u.value===0}," 🗑️ Delete ",8,wu),j[14]||(j[14]=bt("span",{class:"separator"},"|",-1)),bt("span",Cu,zn(g.value)+" notes, "+zn(u.value)+" selected",1)])):sh("",!0),bt("div",xu,[bt("div",Pu,[bt("div",{ref_key:"konvaContainer",ref:o,class:De(["piano-roll-container",{"is-disabled":!f.value}]),style:me({width:n.width+"px",height:n.height+"px"})},null,6),bt("div",{ref_key:"horizontalTrack",ref:a,class:De(["scrollbar horizontal",{"is-disabled":!f.value}]),style:me({width:n.width+"px"}),onPointerdown:we($,["self"])},[bt("div",{class:"scrollbar-thumb horizontal-thumb",style:me(T.value)},[bt("div",{class:"scrollbar-handle handle-left",onPointerdown:j[4]||(j[4]=we(nt=>D("resize-start",nt),["stop","prevent"]))},null,32),bt("div",{class:"scrollbar-body",onPointerdown:j[5]||(j[5]=we(nt=>D("move",nt),["stop","prevent"]))},null,32),bt("div",{class:"scrollbar-handle handle-right",onPointerdown:j[6]||(j[6]=we(nt=>D("resize-end",nt),["stop","prevent"]))},null,32)],4)],38)]),bt("div",{ref_key:"verticalTrack",ref:l,class:De(["scrollbar vertical",{"is-disabled":!f.value}]),style:me({height:n.height+"px"}),onPointerdown:we(b,["self"])},[bt("div",{class:"scrollbar-thumb vertical-thumb",style:me(M.value)},[bt("div",{class:"scrollbar-handle handle-top",onPointerdown:j[7]||(j[7]=we(nt=>B("resize-start",nt),["stop","prevent"]))},null,32),bt("div",{class:"scrollbar-body vertical-body",onPointerdown:j[8]||(j[8]=we(nt=>B("move",nt),["stop","prevent"]))},null,32),bt("div",{class:"scrollbar-handle handle-bottom",onPointerdown:j[9]||(j[9]=we(nt=>B("resize-end",nt),["stop","prevent"]))},null,32)],4)],38)])]))}}),[["styles",[".piano-roll-root[data-v-9da72c53]{display:flex;flex-direction:column;align-items:center;gap:20px;padding:20px}.control-panel[data-v-9da72c53]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:10px 15px;display:flex;align-items:center;gap:10px;box-shadow:0 2px 10px #0000001a}.control-panel button[data-v-9da72c53]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 15px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-9da72c53]:hover:not(:disabled){background:#e0e0e0}.control-panel button[data-v-9da72c53]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-9da72c53]{color:#ccc}.info[data-v-9da72c53]{color:#666;font-size:14px}.piano-roll-container[data-v-9da72c53]{background-color:#fff;border:1px solid black;cursor:default;box-sizing:border-box;border-radius:8px}.piano-roll-container.is-disabled[data-v-9da72c53]{pointer-events:none;cursor:not-allowed}.piano-roll-layout[data-v-9da72c53]{display:flex;align-items:flex-start;gap:12px}.stage-wrapper[data-v-9da72c53]{display:flex;flex-direction:column;gap:12px;align-items:stretch}.scrollbar[data-v-9da72c53]{position:relative;background:#f5f5f5;border:1px solid #ccc;border-radius:10px;box-sizing:border-box;user-select:none;touch-action:none}.scrollbar.horizontal[data-v-9da72c53]{height:24px}.scrollbar.vertical[data-v-9da72c53]{width:24px}.scrollbar.is-disabled[data-v-9da72c53]{opacity:.45;pointer-events:none}.scrollbar-thumb[data-v-9da72c53]{position:absolute;background:#0000002e;border-radius:6px;display:flex;align-items:center;justify-content:space-between;min-width:16px;min-height:16px;cursor:grab;transition:background .15s ease;box-sizing:border-box}.scrollbar-thumb.horizontal-thumb[data-v-9da72c53]{top:0;height:100%;align-items:stretch}.scrollbar-thumb.vertical-thumb[data-v-9da72c53]{left:0;width:100%;flex-direction:column;justify-content:space-between;align-items:stretch}.scrollbar-thumb[data-v-9da72c53]:hover{background:#00000040}.scrollbar-body[data-v-9da72c53]{flex:1;height:100%;cursor:grab}.scrollbar-body.vertical-body[data-v-9da72c53]{width:100%}.scrollbar-handle[data-v-9da72c53]{background:#00000059;border-radius:4px;flex:0 0 auto}.handle-left[data-v-9da72c53],.handle-right[data-v-9da72c53]{width:8px;height:100%;cursor:ew-resize}.handle-top[data-v-9da72c53],.handle-bottom[data-v-9da72c53]{width:100%;height:8px;cursor:ns-resize}label[data-v-9da72c53]{display:flex;align-items:center;gap:5px;font-size:14px}select[data-v-9da72c53]{padding:3px 8px;border:1px solid #ccc;border-radius:4px;font-size:14px;cursor:pointer}"]],["__scopeId","data-v-9da72c53"]]),hl="piano-roll-component",Wr=Gh(Tu);return customElements.get(hl)||customElements.define(hl,Wr),nn.PianoRollElement=Wr,nn.default=Wr,Object.defineProperties(nn,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),nn}({});
