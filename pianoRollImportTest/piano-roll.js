var PianoRollComponent=function(tn){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Ln(t){const e=Object.create(null);for(const i of t.split(","))e[i]=1;return i=>i in e}const wt={},Oe=[],Zt=()=>{},ul=()=>!1,en=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Gn=t=>t.startsWith("onUpdate:"),Nt=Object.assign,Un=(t,e)=>{const i=t.indexOf(e);i>-1&&t.splice(i,1)},fl=Object.prototype.hasOwnProperty,St=(t,e)=>fl.call(t,e),gt=Array.isArray,De=t=>Ye(t)==="[object Map]",nn=t=>Ye(t)==="[object Set]",qr=t=>Ye(t)==="[object Date]",pt=t=>typeof t=="function",Et=t=>typeof t=="string",te=t=>typeof t=="symbol",Rt=t=>t!==null&&typeof t=="object",Wr=t=>(Rt(t)||pt(t))&&pt(t.then)&&pt(t.catch),Kr=Object.prototype.toString,Ye=t=>Kr.call(t),gl=t=>Ye(t).slice(8,-1),rn=t=>Ye(t)==="[object Object]",Bn=t=>Et(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Xe=Ln(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),sn=t=>{const e=Object.create(null);return i=>e[i]||(e[i]=t(i))},pl=/-(\w)/g,$t=sn(t=>t.replace(pl,(e,i)=>i?i.toUpperCase():"")),ml=/\B([A-Z])/g,Yt=sn(t=>t.replace(ml,"-$1").toLowerCase()),jr=sn(t=>t.charAt(0).toUpperCase()+t.slice(1)),Hn=sn(t=>t?`on${jr(t)}`:""),ye=(t,e)=>!Object.is(t,e),on=(t,...e)=>{for(let i=0;i<t.length;i++)t[i](...e)},Yr=(t,e,i,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:i})},Xr=t=>{const e=parseFloat(t);return isNaN(e)?t:e},$r=t=>{const e=Et(t)?Number(t):NaN;return isNaN(e)?t:e};let Qr;const Jr=()=>Qr||(Qr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function be(t){if(gt(t)){const e={};for(let i=0;i<t.length;i++){const r=t[i],s=Et(r)?vl(r):be(r);if(s)for(const n in s)e[n]=s[n]}return e}else if(Et(t)||Rt(t))return t}const _l=/;(?![^(]*\))/g,yl=/:([^]+)/,bl=/\/\*[^]*?\*\//g;function vl(t){const e={};return t.replace(bl,"").split(_l).forEach(i=>{if(i){const r=i.split(yl);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Le(t){let e="";if(Et(t))e=t;else if(gt(t))for(let i=0;i<t.length;i++){const r=Le(t[i]);r&&(e+=r+" ")}else if(Rt(t))for(const i in t)t[i]&&(e+=i+" ");return e.trim()}const Sl=Ln("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Zr(t){return!!t||t===""}function Cl(t,e){if(t.length!==e.length)return!1;let i=!0;for(let r=0;i&&r<t.length;r++)i=an(t[r],e[r]);return i}function an(t,e){if(t===e)return!0;let i=qr(t),r=qr(e);if(i||r)return i&&r?t.getTime()===e.getTime():!1;if(i=te(t),r=te(e),i||r)return t===e;if(i=gt(t),r=gt(e),i||r)return i&&r?Cl(t,e):!1;if(i=Rt(t),r=Rt(e),i||r){if(!i||!r)return!1;const s=Object.keys(t).length,n=Object.keys(e).length;if(s!==n)return!1;for(const o in t){const a=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(a&&!c||!a&&c||!an(t[o],e[o]))return!1}}return String(t)===String(e)}function xl(t,e){return t.findIndex(i=>an(i,e))}const ts=t=>!!(t&&t.__v_isRef===!0),Vn=t=>Et(t)?t:t==null?"":gt(t)||Rt(t)&&(t.toString===Kr||!pt(t.toString))?ts(t)?Vn(t.value):JSON.stringify(t,es,2):String(t),es=(t,e)=>ts(e)?es(t,e.value):De(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((i,[r,s],n)=>(i[zn(r,n)+" =>"]=s,i),{})}:nn(e)?{[`Set(${e.size})`]:[...e.values()].map(i=>zn(i))}:te(e)?zn(e):Rt(e)&&!gt(e)&&!rn(e)?String(e):e,zn=(t,e="")=>{var i;return te(t)?`Symbol(${(i=t.description)!=null?i:e})`:t};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Wt;class wl{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Wt,!e&&Wt&&(this.index=(Wt.scopes||(Wt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].pause();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].resume();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].resume()}}run(e){if(this._active){const i=Wt;try{return Wt=this,e()}finally{Wt=i}}}on(){Wt=this}off(){Wt=this.parent}stop(e){if(this._active){let i,r;for(i=0,r=this.effects.length;i<r;i++)this.effects[i].stop();for(i=0,r=this.cleanups.length;i<r;i++)this.cleanups[i]();if(this.scopes)for(i=0,r=this.scopes.length;i<r;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function Pl(){return Wt}let Pt;const qn=new WeakSet;class is{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Wt&&Wt.active&&Wt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,qn.has(this)&&(qn.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||rs(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,cs(this),ss(this);const e=Pt,i=Qt;Pt=this,Qt=!0;try{return this.fn()}finally{os(this),Pt=e,Qt=i,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Yn(e);this.deps=this.depsTail=void 0,cs(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?qn.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){jn(this)&&this.run()}get dirty(){return jn(this)}}let ns=0,$e,Qe;function rs(t,e=!1){if(t.flags|=8,e){t.next=Qe,Qe=t;return}t.next=$e,$e=t}function Wn(){ns++}function Kn(){if(--ns>0)return;if(Qe){let e=Qe;for(Qe=void 0;e;){const i=e.next;e.next=void 0,e.flags&=-9,e=i}}let t;for(;$e;){let e=$e;for($e=void 0;e;){const i=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=i}}if(t)throw t}function ss(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function os(t){let e,i=t.depsTail,r=i;for(;r;){const s=r.prevDep;r.version===-1?(r===i&&(i=s),Yn(r),Rl(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}t.deps=e,t.depsTail=i}function jn(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(as(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function as(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Je))return;t.globalVersion=Je;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!jn(t)){t.flags&=-3;return}const i=Pt,r=Qt;Pt=t,Qt=!0;try{ss(t);const s=t.fn(t._value);(e.version===0||ye(s,t._value))&&(t._value=s,e.version++)}catch(s){throw e.version++,s}finally{Pt=i,Qt=r,os(t),t.flags&=-3}}function Yn(t,e=!1){const{dep:i,prevSub:r,nextSub:s}=t;if(r&&(r.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=r,t.nextSub=void 0),i.subs===t&&(i.subs=r),!i.subs&&i.computed){i.computed.flags&=-5;for(let n=i.computed.deps;n;n=n.nextDep)Yn(n,!0)}!e&&!--i.sc&&i.map&&i.map.delete(i.key)}function Rl(t){const{prevDep:e,nextDep:i}=t;e&&(e.nextDep=i,t.prevDep=void 0),i&&(i.prevDep=e,t.nextDep=void 0)}let Qt=!0;const ls=[];function le(){ls.push(Qt),Qt=!1}function ce(){const t=ls.pop();Qt=t===void 0?!0:t}function cs(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const i=Pt;Pt=void 0;try{e()}finally{Pt=i}}}let Je=0;class Tl{constructor(e,i){this.sub=e,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Xn{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Pt||!Qt||Pt===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==Pt)i=this.activeLink=new Tl(Pt,this),Pt.deps?(i.prevDep=Pt.depsTail,Pt.depsTail.nextDep=i,Pt.depsTail=i):Pt.deps=Pt.depsTail=i,hs(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const r=i.nextDep;r.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=r),i.prevDep=Pt.depsTail,i.nextDep=void 0,Pt.depsTail.nextDep=i,Pt.depsTail=i,Pt.deps===i&&(Pt.deps=r)}return i}trigger(e){this.version++,Je++,this.notify(e)}notify(e){Wn();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{Kn()}}}function hs(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)hs(r)}const i=t.dep.subs;i!==t&&(t.prevSub=i,i&&(i.nextSub=t)),t.dep.subs=t}}const $n=new WeakMap,Re=Symbol(""),Qn=Symbol(""),Ze=Symbol("");function Ot(t,e,i){if(Qt&&Pt){let r=$n.get(t);r||$n.set(t,r=new Map);let s=r.get(i);s||(r.set(i,s=new Xn),s.map=r,s.key=i),s.track()}}function he(t,e,i,r,s,n){const o=$n.get(t);if(!o){Je++;return}const a=c=>{c&&c.trigger()};if(Wn(),e==="clear")o.forEach(a);else{const c=gt(t),d=c&&Bn(i);if(c&&i==="length"){const h=Number(r);o.forEach((m,p)=>{(p==="length"||p===Ze||!te(p)&&p>=h)&&a(m)})}else switch(i!==void 0&&a(o.get(i)),d&&a(o.get(Ze)),e){case"add":c?d&&a(o.get("length")):(a(o.get(Re)),De(t)&&a(o.get(Qn)));break;case"delete":c||(a(o.get(Re)),De(t)&&a(o.get(Qn)));break;case"set":De(t)&&a(o.get(Re));break}}Kn()}function Ge(t){const e=vt(t);return e===t?e:(Ot(e,"iterate",Ze),Jt(t)?e:e.map(Lt))}function Jn(t){return Ot(t=vt(t),"iterate",Ze),t}const El={__proto__:null,[Symbol.iterator](){return Zn(this,Symbol.iterator,Lt)},concat(...t){return Ge(this).concat(...t.map(e=>gt(e)?Ge(e):e))},entries(){return Zn(this,"entries",t=>(t[1]=Lt(t[1]),t))},every(t,e){return de(this,"every",t,e,void 0,arguments)},filter(t,e){return de(this,"filter",t,e,i=>i.map(Lt),arguments)},find(t,e){return de(this,"find",t,e,Lt,arguments)},findIndex(t,e){return de(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return de(this,"findLast",t,e,Lt,arguments)},findLastIndex(t,e){return de(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return de(this,"forEach",t,e,void 0,arguments)},includes(...t){return tr(this,"includes",t)},indexOf(...t){return tr(this,"indexOf",t)},join(t){return Ge(this).join(t)},lastIndexOf(...t){return tr(this,"lastIndexOf",t)},map(t,e){return de(this,"map",t,e,void 0,arguments)},pop(){return ti(this,"pop")},push(...t){return ti(this,"push",t)},reduce(t,...e){return ds(this,"reduce",t,e)},reduceRight(t,...e){return ds(this,"reduceRight",t,e)},shift(){return ti(this,"shift")},some(t,e){return de(this,"some",t,e,void 0,arguments)},splice(...t){return ti(this,"splice",t)},toReversed(){return Ge(this).toReversed()},toSorted(t){return Ge(this).toSorted(t)},toSpliced(...t){return Ge(this).toSpliced(...t)},unshift(...t){return ti(this,"unshift",t)},values(){return Zn(this,"values",Lt)}};function Zn(t,e,i){const r=Jn(t),s=r[e]();return r!==t&&!Jt(t)&&(s._next=s.next,s.next=()=>{const n=s._next();return n.value&&(n.value=i(n.value)),n}),s}const Al=Array.prototype;function de(t,e,i,r,s,n){const o=Jn(t),a=o!==t&&!Jt(t),c=o[e];if(c!==Al[e]){const m=c.apply(t,n);return a?Lt(m):m}let d=i;o!==t&&(a?d=function(m,p){return i.call(this,Lt(m),p,t)}:i.length>2&&(d=function(m,p){return i.call(this,m,p,t)}));const h=c.call(o,d,r);return a&&s?s(h):h}function ds(t,e,i,r){const s=Jn(t);let n=i;return s!==t&&(Jt(t)?i.length>3&&(n=function(o,a,c){return i.call(this,o,a,c,t)}):n=function(o,a,c){return i.call(this,o,Lt(a),c,t)}),s[e](n,...r)}function tr(t,e,i){const r=vt(t);Ot(r,"iterate",Ze);const s=r[e](...i);return(s===-1||s===!1)&&ir(i[0])?(i[0]=vt(i[0]),r[e](...i)):s}function ti(t,e,i=[]){le(),Wn();const r=vt(t)[e].apply(t,i);return Kn(),ce(),r}const Ml=Ln("__proto__,__v_isRef,__isVue"),us=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(te));function Nl(t){te(t)||(t=String(t));const e=vt(this);return Ot(e,"has",t),e.hasOwnProperty(t)}class fs{constructor(e=!1,i=!1){this._isReadonly=e,this._isShallow=i}get(e,i,r){const s=this._isReadonly,n=this._isShallow;if(i==="__v_isReactive")return!s;if(i==="__v_isReadonly")return s;if(i==="__v_isShallow")return n;if(i==="__v_raw")return r===(s?n?xs:Cs:n?Ss:vs).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=gt(e);if(!s){let c;if(o&&(c=El[i]))return c;if(i==="hasOwnProperty")return Nl}const a=Reflect.get(e,i,kt(e)?e:r);return(te(i)?us.has(i):Ml(i))||(s||Ot(e,"get",i),n)?a:kt(a)?o&&Bn(i)?a:a.value:Rt(a)?s?ws(a):ei(a):a}}class gs extends fs{constructor(e=!1){super(!1,e)}set(e,i,r,s){let n=e[i];if(!this._isShallow){const c=Te(n);if(!Jt(r)&&!Te(r)&&(n=vt(n),r=vt(r)),!gt(e)&&kt(n)&&!kt(r))return c?!1:(n.value=r,!0)}const o=gt(e)&&Bn(i)?Number(i)<e.length:St(e,i),a=Reflect.set(e,i,r,kt(e)?e:s);return e===vt(s)&&(o?ye(r,n)&&he(e,"set",i,r):he(e,"add",i,r)),a}deleteProperty(e,i){const r=St(e,i);e[i];const s=Reflect.deleteProperty(e,i);return s&&r&&he(e,"delete",i,void 0),s}has(e,i){const r=Reflect.has(e,i);return(!te(i)||!us.has(i))&&Ot(e,"has",i),r}ownKeys(e){return Ot(e,"iterate",gt(e)?"length":Re),Reflect.ownKeys(e)}}class ps extends fs{constructor(e=!1){super(!0,e)}set(e,i){return!0}deleteProperty(e,i){return!0}}const Fl=new gs,kl=new ps,Il=new gs(!0),Ol=new ps(!0),er=t=>t,ln=t=>Reflect.getPrototypeOf(t);function cn(t,e,i=!1,r=!1){t=t.__v_raw;const s=vt(t),n=vt(e);i||(ye(e,n)&&Ot(s,"get",e),Ot(s,"get",n));const{has:o}=ln(s),a=r?er:i?nr:Lt;if(o.call(s,e))return a(t.get(e));if(o.call(s,n))return a(t.get(n));t!==s&&t.get(e)}function hn(t,e=!1){const i=this.__v_raw,r=vt(i),s=vt(t);return e||(ye(t,s)&&Ot(r,"has",t),Ot(r,"has",s)),t===s?i.has(t):i.has(t)||i.has(s)}function dn(t,e=!1){return t=t.__v_raw,!e&&Ot(vt(t),"iterate",Re),Reflect.get(t,"size",t)}function ms(t,e=!1){!e&&!Jt(t)&&!Te(t)&&(t=vt(t));const i=vt(this);return ln(i).has.call(i,t)||(i.add(t),he(i,"add",t,t)),this}function _s(t,e,i=!1){!i&&!Jt(e)&&!Te(e)&&(e=vt(e));const r=vt(this),{has:s,get:n}=ln(r);let o=s.call(r,t);o||(t=vt(t),o=s.call(r,t));const a=n.call(r,t);return r.set(t,e),o?ye(e,a)&&he(r,"set",t,e):he(r,"add",t,e),this}function ys(t){const e=vt(this),{has:i,get:r}=ln(e);let s=i.call(e,t);s||(t=vt(t),s=i.call(e,t)),r&&r.call(e,t);const n=e.delete(t);return s&&he(e,"delete",t,void 0),n}function bs(){const t=vt(this),e=t.size!==0,i=t.clear();return e&&he(t,"clear",void 0,void 0),i}function un(t,e){return function(r,s){const n=this,o=n.__v_raw,a=vt(o),c=e?er:t?nr:Lt;return!t&&Ot(a,"iterate",Re),o.forEach((d,h)=>r.call(s,c(d),c(h),n))}}function fn(t,e,i){return function(...r){const s=this.__v_raw,n=vt(s),o=De(n),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,d=s[t](...r),h=i?er:e?nr:Lt;return!e&&Ot(n,"iterate",c?Qn:Re),{next(){const{value:m,done:p}=d.next();return p?{value:m,done:p}:{value:a?[h(m[0]),h(m[1])]:h(m),done:p}},[Symbol.iterator](){return this}}}}function ve(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Dl(){const t={get(n){return cn(this,n)},get size(){return dn(this)},has:hn,add:ms,set:_s,delete:ys,clear:bs,forEach:un(!1,!1)},e={get(n){return cn(this,n,!1,!0)},get size(){return dn(this)},has:hn,add(n){return ms.call(this,n,!0)},set(n,o){return _s.call(this,n,o,!0)},delete:ys,clear:bs,forEach:un(!1,!0)},i={get(n){return cn(this,n,!0)},get size(){return dn(this,!0)},has(n){return hn.call(this,n,!0)},add:ve("add"),set:ve("set"),delete:ve("delete"),clear:ve("clear"),forEach:un(!0,!1)},r={get(n){return cn(this,n,!0,!0)},get size(){return dn(this,!0)},has(n){return hn.call(this,n,!0)},add:ve("add"),set:ve("set"),delete:ve("delete"),clear:ve("clear"),forEach:un(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{t[n]=fn(n,!1,!1),i[n]=fn(n,!0,!1),e[n]=fn(n,!1,!0),r[n]=fn(n,!0,!0)}),[t,i,e,r]}const[Ll,Gl,Ul,Bl]=Dl();function gn(t,e){const i=e?t?Bl:Ul:t?Gl:Ll;return(r,s,n)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(St(i,s)&&s in r?i:r,s,n)}const Hl={get:gn(!1,!1)},Vl={get:gn(!1,!0)},zl={get:gn(!0,!1)},ql={get:gn(!0,!0)},vs=new WeakMap,Ss=new WeakMap,Cs=new WeakMap,xs=new WeakMap;function Wl(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Kl(t){return t.__v_skip||!Object.isExtensible(t)?0:Wl(gl(t))}function ei(t){return Te(t)?t:pn(t,!1,Fl,Hl,vs)}function jl(t){return pn(t,!1,Il,Vl,Ss)}function ws(t){return pn(t,!0,kl,zl,Cs)}function Pu(t){return pn(t,!0,Ol,ql,xs)}function pn(t,e,i,r,s){if(!Rt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const n=s.get(t);if(n)return n;const o=Kl(t);if(o===0)return t;const a=new Proxy(t,o===2?r:i);return s.set(t,a),a}function ii(t){return Te(t)?ii(t.__v_raw):!!(t&&t.__v_isReactive)}function Te(t){return!!(t&&t.__v_isReadonly)}function Jt(t){return!!(t&&t.__v_isShallow)}function ir(t){return t?!!t.__v_raw:!1}function vt(t){const e=t&&t.__v_raw;return e?vt(e):t}function Yl(t){return!St(t,"__v_skip")&&Object.isExtensible(t)&&Yr(t,"__v_skip",!0),t}const Lt=t=>Rt(t)?ei(t):t,nr=t=>Rt(t)?ws(t):t;function kt(t){return t?t.__v_isRef===!0:!1}function ee(t){return Xl(t,!1)}function Xl(t,e){return kt(t)?t:new $l(t,e)}class $l{constructor(e,i){this.dep=new Xn,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?e:vt(e),this._value=i?e:Lt(e),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(e){const i=this._rawValue,r=this.__v_isShallow||Jt(e)||Te(e);e=r?e:vt(e),ye(e,i)&&(this._rawValue=e,this._value=r?e:Lt(e),this.dep.trigger())}}function Ps(t){return kt(t)?t.value:t}const Ql={get:(t,e,i)=>e==="__v_raw"?t:Ps(Reflect.get(t,e,i)),set:(t,e,i,r)=>{const s=t[e];return kt(s)&&!kt(i)?(s.value=i,!0):Reflect.set(t,e,i,r)}};function Rs(t){return ii(t)?t:new Proxy(t,Ql)}class Jl{constructor(e,i,r){this.fn=e,this.setter=i,this._value=void 0,this.dep=new Xn(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Je-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Pt!==this)return rs(this,!0),!0}get value(){const e=this.dep.track();return as(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Zl(t,e,i=!1){let r,s;return pt(t)?r=t:(r=t.get,s=t.set),new Jl(r,s,i)}const mn={},_n=new WeakMap;let Ee;function tc(t,e=!1,i=Ee){if(i){let r=_n.get(i);r||_n.set(i,r=[]),r.push(t)}}function ec(t,e,i=wt){const{immediate:r,deep:s,once:n,scheduler:o,augmentJob:a,call:c}=i,d=_=>s?_:Jt(_)||s===!1||s===0?ue(_,1):ue(_);let h,m,p,u,f=!1,y=!1;if(kt(t)?(m=()=>t.value,f=Jt(t)):ii(t)?(m=()=>d(t),f=!0):gt(t)?(y=!0,f=t.some(_=>ii(_)||Jt(_)),m=()=>t.map(_=>{if(kt(_))return _.value;if(ii(_))return d(_);if(pt(_))return c?c(_,2):_()})):pt(t)?e?m=c?()=>c(t,2):t:m=()=>{if(p){le();try{p()}finally{ce()}}const _=Ee;Ee=h;try{return c?c(t,3,[u]):t(u)}finally{Ee=_}}:m=Zt,e&&s){const _=m,v=s===!0?1/0:s;m=()=>ue(_(),v)}const S=Pl(),w=()=>{h.stop(),S&&Un(S.effects,h)};if(n&&e){const _=e;e=(...v)=>{_(...v),w()}}let g=y?new Array(t.length).fill(mn):mn;const l=_=>{if(!(!(h.flags&1)||!h.dirty&&!_))if(e){const v=h.run();if(s||f||(y?v.some((T,I)=>ye(T,g[I])):ye(v,g))){p&&p();const T=Ee;Ee=h;try{const I=[v,g===mn?void 0:y&&g[0]===mn?[]:g,u];c?c(e,3,I):e(...I),g=v}finally{Ee=T}}}else h.run()};return a&&a(l),h=new is(m),h.scheduler=o?()=>o(l,!1):l,u=_=>tc(_,!1,h),p=h.onStop=()=>{const _=_n.get(h);if(_){if(c)c(_,4);else for(const v of _)v();_n.delete(h)}},e?r?l(!0):g=h.run():o?o(l.bind(null,!0),!0):h.run(),w.pause=h.pause.bind(h),w.resume=h.resume.bind(h),w.stop=w,w}function ue(t,e=1/0,i){if(e<=0||!Rt(t)||t.__v_skip||(i=i||new Set,i.has(t)))return t;if(i.add(t),e--,kt(t))ue(t.value,e,i);else if(gt(t))for(let r=0;r<t.length;r++)ue(t[r],e,i);else if(nn(t)||De(t))t.forEach(r=>{ue(r,e,i)});else if(rn(t)){for(const r in t)ue(t[r],e,i);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&ue(t[r],e,i)}return t}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const ni=[];let rr=!1;function Ru(t,...e){if(rr)return;rr=!0,le();const i=ni.length?ni[ni.length-1].component:null,r=i&&i.appContext.config.warnHandler,s=ic();if(r)Ue(r,i,11,[t+e.map(n=>{var o,a;return(a=(o=n.toString)==null?void 0:o.call(n))!=null?a:JSON.stringify(n)}).join(""),i&&i.proxy,s.map(({vnode:n})=>`at <${Co(i,n.type)}>`).join(`
`),s]);else{const n=[`[Vue warn]: ${t}`,...e];s.length&&n.push(`
`,...nc(s)),console.warn(...n)}ce(),rr=!1}function ic(){let t=ni[ni.length-1];if(!t)return[];const e=[];for(;t;){const i=e[0];i&&i.vnode===t?i.recurseCount++:e.push({vnode:t,recurseCount:0});const r=t.component&&t.component.parent;t=r&&r.vnode}return e}function nc(t){const e=[];return t.forEach((i,r)=>{e.push(...r===0?[]:[`
`],...rc(i))}),e}function rc({vnode:t,recurseCount:e}){const i=e>0?`... (${e} recursive calls)`:"",r=t.component?t.component.parent==null:!1,s=` at <${Co(t.component,t.type,r)}`,n=">"+i;return t.props?[s,...sc(t.props),n]:[s+n]}function sc(t){const e=[],i=Object.keys(t);return i.slice(0,3).forEach(r=>{e.push(...Ts(r,t[r]))}),i.length>3&&e.push(" ..."),e}function Ts(t,e,i){return Et(e)?(e=JSON.stringify(e),i?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?i?e:[`${t}=${e}`]:kt(e)?(e=Ts(t,vt(e.value),!0),i?e:[`${t}=Ref<`,e,">"]):pt(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=vt(e),i?e:[`${t}=`,e])}function Ue(t,e,i,r){try{return r?t(...r):t()}catch(s){yn(s,e,i)}}function ie(t,e,i,r){if(pt(t)){const s=Ue(t,e,i,r);return s&&Wr(s)&&s.catch(n=>{yn(n,e,i)}),s}if(gt(t)){const s=[];for(let n=0;n<t.length;n++)s.push(ie(t[n],e,i,r));return s}}function yn(t,e,i,r=!0){const s=e?e.vnode:null,{errorHandler:n,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||wt;if(e){let a=e.parent;const c=e.proxy,d=`https://vuejs.org/error-reference/#runtime-${i}`;for(;a;){const h=a.ec;if(h){for(let m=0;m<h.length;m++)if(h[m](t,c,d)===!1)return}a=a.parent}if(n){le(),Ue(n,null,10,[t,c,d]),ce();return}}oc(t,i,s,r,o)}function oc(t,e,i,r=!0,s=!1){if(s)throw t;console.error(t)}const Gt=[];let ne=-1;const Be=[];let Se=null,He=0;const Es=Promise.resolve();let bn=null;function sr(t){const e=bn||Es;return t?e.then(this?t.bind(this):t):e}function ac(t){let e=ne+1,i=Gt.length;for(;e<i;){const r=e+i>>>1,s=Gt[r],n=ri(s);n<t||n===t&&s.flags&2?e=r+1:i=r}return e}function or(t){if(!(t.flags&1)){const e=ri(t),i=Gt[Gt.length-1];!i||!(t.flags&2)&&e>=ri(i)?Gt.push(t):Gt.splice(ac(e),0,t),t.flags|=1,As()}}function As(){bn||(bn=Es.then(Fs))}function lc(t){gt(t)?Be.push(...t):Se&&t.id===-1?Se.splice(He+1,0,t):t.flags&1||(Be.push(t),t.flags|=1),As()}function Ms(t,e,i=ne+1){for(;i<Gt.length;i++){const r=Gt[i];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;Gt.splice(i,1),i--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Ns(t){if(Be.length){const e=[...new Set(Be)].sort((i,r)=>ri(i)-ri(r));if(Be.length=0,Se){Se.push(...e);return}for(Se=e,He=0;He<Se.length;He++){const i=Se[He];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}Se=null,He=0}}const ri=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Fs(t){try{for(ne=0;ne<Gt.length;ne++){const e=Gt[ne];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Ue(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ne<Gt.length;ne++){const e=Gt[ne];e&&(e.flags&=-2)}ne=-1,Gt.length=0,Ns(),bn=null,(Gt.length||Be.length)&&Fs()}}let Xt=null,ks=null;function vn(t){const e=Xt;return Xt=t,ks=t&&t.type.__scopeId||null,e}function cc(t,e=Xt,i){if(!e||t._n)return t;const r=(...s)=>{r._d&&uo(-1);const n=vn(e);let o;try{o=t(...s)}finally{vn(n),r._d&&uo(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function hc(t,e){if(Xt===null)return t;const i=An(Xt),r=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[n,o,a,c=wt]=e[s];n&&(pt(n)&&(n={mounted:n,updated:n}),n.deep&&ue(o),r.push({dir:n,instance:i,value:o,oldValue:void 0,arg:a,modifiers:c}))}return t}function Ae(t,e,i,r){const s=t.dirs,n=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];n&&(a.oldValue=n[o].value);let c=a.dir[r];c&&(le(),ie(c,i,8,[t.el,a,t,e]),ce())}}const dc=Symbol("_vte"),uc=t=>t.__isTeleport;function ar(t,e){t.shapeFlag&6&&t.component?(t.transition=e,ar(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function Is(t,e){return pt(t)?Nt({name:t.name},e,{setup:t}):t}function Os(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function lr(t,e,i,r,s=!1){if(gt(t)){t.forEach((f,y)=>lr(f,e&&(gt(e)?e[y]:e),i,r,s));return}if(si(r)&&!s)return;const n=r.shapeFlag&4?An(r.component):r.el,o=s?null:n,{i:a,r:c}=t,d=e&&e.r,h=a.refs===wt?a.refs={}:a.refs,m=a.setupState,p=vt(m),u=m===wt?()=>!1:f=>St(p,f);if(d!=null&&d!==c&&(Et(d)?(h[d]=null,u(d)&&(m[d]=null)):kt(d)&&(d.value=null)),pt(c))Ue(c,a,12,[o,h]);else{const f=Et(c),y=kt(c);if(f||y){const S=()=>{if(t.f){const w=f?u(c)?m[c]:h[c]:c.value;s?gt(w)&&Un(w,n):gt(w)?w.includes(n)||w.push(n):f?(h[c]=[n],u(c)&&(m[c]=h[c])):(c.value=[n],t.k&&(h[t.k]=c.value))}else f?(h[c]=o,u(c)&&(m[c]=o)):y&&(c.value=o,t.k&&(h[t.k]=o))};o?(S.id=-1,Kt(S,i)):S()}}}const si=t=>!!t.type.__asyncLoader,Ds=t=>t.type.__isKeepAlive;function fc(t,e){Ls(t,"a",e)}function gc(t,e){Ls(t,"da",e)}function Ls(t,e,i=Bt){const r=t.__wdc||(t.__wdc=()=>{let s=i;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Sn(e,r,i),i){let s=i.parent;for(;s&&s.parent;)Ds(s.parent.vnode)&&pc(r,e,i,s),s=s.parent}}function pc(t,e,i,r){const s=Sn(e,t,r,!0);cr(()=>{Un(r[e],s)},i)}function Sn(t,e,i=Bt,r=!1){if(i){const s=i[t]||(i[t]=[]),n=e.__weh||(e.__weh=(...o)=>{le();const a=di(i),c=ie(e,i,t,o);return a(),ce(),c});return r?s.unshift(n):s.push(n),n}}const fe=t=>(e,i=Bt)=>{(!En||t==="sp")&&Sn(t,(...r)=>e(...r),i)},mc=fe("bm"),Gs=fe("m"),_c=fe("bu"),yc=fe("u"),bc=fe("bum"),cr=fe("um"),vc=fe("sp"),Sc=fe("rtg"),Cc=fe("rtc");function xc(t,e=Bt){Sn("ec",t,e)}const wc=Symbol.for("v-ndc"),hr=t=>t?bo(t)?An(t):hr(t.parent):null,oi=Nt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>hr(t.parent),$root:t=>hr(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Vs(t),$forceUpdate:t=>t.f||(t.f=()=>{or(t.update)}),$nextTick:t=>t.n||(t.n=sr.bind(t.proxy)),$watch:t=>Kc.bind(t)}),dr=(t,e)=>t!==wt&&!t.__isScriptSetup&&St(t,e),Pc={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:i,setupState:r,data:s,props:n,accessCache:o,type:a,appContext:c}=t;let d;if(e[0]!=="$"){const u=o[e];if(u!==void 0)switch(u){case 1:return r[e];case 2:return s[e];case 4:return i[e];case 3:return n[e]}else{if(dr(r,e))return o[e]=1,r[e];if(s!==wt&&St(s,e))return o[e]=2,s[e];if((d=t.propsOptions[0])&&St(d,e))return o[e]=3,n[e];if(i!==wt&&St(i,e))return o[e]=4,i[e];ur&&(o[e]=0)}}const h=oi[e];let m,p;if(h)return e==="$attrs"&&Ot(t.attrs,"get",""),h(t);if((m=a.__cssModules)&&(m=m[e]))return m;if(i!==wt&&St(i,e))return o[e]=4,i[e];if(p=c.config.globalProperties,St(p,e))return p[e]},set({_:t},e,i){const{data:r,setupState:s,ctx:n}=t;return dr(s,e)?(s[e]=i,!0):r!==wt&&St(r,e)?(r[e]=i,!0):St(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(n[e]=i,!0)},has({_:{data:t,setupState:e,accessCache:i,ctx:r,appContext:s,propsOptions:n}},o){let a;return!!i[o]||t!==wt&&St(t,o)||dr(e,o)||(a=n[0])&&St(a,o)||St(r,o)||St(oi,o)||St(s.config.globalProperties,o)},defineProperty(t,e,i){return i.get!=null?t._.accessCache[e]=0:St(i,"value")&&this.set(t,e,i.value,null),Reflect.defineProperty(t,e,i)}};function Us(t){return gt(t)?t.reduce((e,i)=>(e[i]=null,e),{}):t}let ur=!0;function Rc(t){const e=Vs(t),i=t.proxy,r=t.ctx;ur=!1,e.beforeCreate&&Bs(e.beforeCreate,t,"bc");const{data:s,computed:n,methods:o,watch:a,provide:c,inject:d,created:h,beforeMount:m,mounted:p,beforeUpdate:u,updated:f,activated:y,deactivated:S,beforeDestroy:w,beforeUnmount:g,destroyed:l,unmounted:_,render:v,renderTracked:T,renderTriggered:I,errorCaptured:C,serverPrefetch:x,expose:R,inheritAttrs:F,components:D,directives:B,filters:V}=e;if(d&&Tc(d,r,null),o)for(const b in o){const P=o[b];pt(P)&&(r[b]=P.bind(i))}if(s){const b=s.call(i,i);Rt(b)&&(t.data=ei(b))}if(ur=!0,n)for(const b in n){const P=n[b],N=pt(P)?P.bind(i,i):pt(P.get)?P.get.bind(i,i):Zt,A=!pt(P)&&pt(P.set)?P.set.bind(i):Zt,O=ke({get:N,set:A});Object.defineProperty(r,b,{enumerable:!0,configurable:!0,get:()=>O.value,set:j=>O.value=j})}if(a)for(const b in a)Hs(a[b],r,i,b);if(c){const b=pt(c)?c.call(i):c;Reflect.ownKeys(b).forEach(P=>{kc(P,b[P])})}h&&Bs(h,t,"c");function Q(b,P){gt(P)?P.forEach(N=>b(N.bind(i))):P&&b(P.bind(i))}if(Q(mc,m),Q(Gs,p),Q(_c,u),Q(yc,f),Q(fc,y),Q(gc,S),Q(xc,C),Q(Cc,T),Q(Sc,I),Q(bc,g),Q(cr,_),Q(vc,x),gt(R))if(R.length){const b=t.exposed||(t.exposed={});R.forEach(P=>{Object.defineProperty(b,P,{get:()=>i[P],set:N=>i[P]=N})})}else t.exposed||(t.exposed={});v&&t.render===Zt&&(t.render=v),F!=null&&(t.inheritAttrs=F),D&&(t.components=D),B&&(t.directives=B),x&&Os(t)}function Tc(t,e,i=Zt){gt(t)&&(t=fr(t));for(const r in t){const s=t[r];let n;Rt(s)?"default"in s?n=xn(s.from||r,s.default,!0):n=xn(s.from||r):n=xn(s),kt(n)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>n.value,set:o=>n.value=o}):e[r]=n}}function Bs(t,e,i){ie(gt(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,i)}function Hs(t,e,i,r){let s=r.includes(".")?oo(i,r):()=>i[r];if(Et(t)){const n=e[t];pt(n)&&Ne(s,n)}else if(pt(t))Ne(s,t.bind(i));else if(Rt(t))if(gt(t))t.forEach(n=>Hs(n,e,i,r));else{const n=pt(t.handler)?t.handler.bind(i):e[t.handler];pt(n)&&Ne(s,n,t)}}function Vs(t){const e=t.type,{mixins:i,extends:r}=e,{mixins:s,optionsCache:n,config:{optionMergeStrategies:o}}=t.appContext,a=n.get(e);let c;return a?c=a:!s.length&&!i&&!r?c=e:(c={},s.length&&s.forEach(d=>Cn(c,d,o,!0)),Cn(c,e,o)),Rt(e)&&n.set(e,c),c}function Cn(t,e,i,r=!1){const{mixins:s,extends:n}=e;n&&Cn(t,n,i,!0),s&&s.forEach(o=>Cn(t,o,i,!0));for(const o in e)if(!(r&&o==="expose")){const a=Ec[o]||i&&i[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Ec={data:zs,props:qs,emits:qs,methods:ai,computed:ai,beforeCreate:Ut,created:Ut,beforeMount:Ut,mounted:Ut,beforeUpdate:Ut,updated:Ut,beforeDestroy:Ut,beforeUnmount:Ut,destroyed:Ut,unmounted:Ut,activated:Ut,deactivated:Ut,errorCaptured:Ut,serverPrefetch:Ut,components:ai,directives:ai,watch:Mc,provide:zs,inject:Ac};function zs(t,e){return e?t?function(){return Nt(pt(t)?t.call(this,this):t,pt(e)?e.call(this,this):e)}:e:t}function Ac(t,e){return ai(fr(t),fr(e))}function fr(t){if(gt(t)){const e={};for(let i=0;i<t.length;i++)e[t[i]]=t[i];return e}return t}function Ut(t,e){return t?[...new Set([].concat(t,e))]:e}function ai(t,e){return t?Nt(Object.create(null),t,e):e}function qs(t,e){return t?gt(t)&&gt(e)?[...new Set([...t,...e])]:Nt(Object.create(null),Us(t),Us(e??{})):e}function Mc(t,e){if(!t)return e;if(!e)return t;const i=Nt(Object.create(null),t);for(const r in e)i[r]=Ut(t[r],e[r]);return i}function Ws(){return{app:null,config:{isNativeTag:ul,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Nc=0;function Fc(t,e){return function(r,s=null){pt(r)||(r=Nt({},r)),s!=null&&!Rt(s)&&(s=null);const n=Ws(),o=new WeakSet,a=[];let c=!1;const d=n.app={_uid:Nc++,_component:r,_props:s,_container:null,_context:n,_instance:null,version:_h,get config(){return n.config},set config(h){},use(h,...m){return o.has(h)||(h&&pt(h.install)?(o.add(h),h.install(d,...m)):pt(h)&&(o.add(h),h(d,...m))),d},mixin(h){return n.mixins.includes(h)||n.mixins.push(h),d},component(h,m){return m?(n.components[h]=m,d):n.components[h]},directive(h,m){return m?(n.directives[h]=m,d):n.directives[h]},mount(h,m,p){if(!c){const u=d._ceVNode||re(r,s);return u.appContext=n,p===!0?p="svg":p===!1&&(p=void 0),t(u,h,p),c=!0,d._container=h,h.__vue_app__=d,An(u.component)}},onUnmount(h){a.push(h)},unmount(){c&&(ie(a,d._instance,16),t(null,d._container),delete d._container.__vue_app__)},provide(h,m){return n.provides[h]=m,d},runWithContext(h){const m=Ve;Ve=d;try{return h()}finally{Ve=m}}};return d}}let Ve=null;function kc(t,e){if(Bt){let i=Bt.provides;const r=Bt.parent&&Bt.parent.provides;r===i&&(i=Bt.provides=Object.create(r)),i[t]=e}}function xn(t,e,i=!1){const r=Bt||Xt;if(r||Ve){const s=Ve?Ve._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return i&&pt(e)?e.call(r&&r.proxy):e}}const Ks={},js=()=>Object.create(Ks),Ys=t=>Object.getPrototypeOf(t)===Ks;function Ic(t,e,i,r=!1){const s={},n=js();t.propsDefaults=Object.create(null),Xs(t,e,s,n);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);i?t.props=r?s:jl(s):t.type.props?t.props=s:t.props=n,t.attrs=n}function Oc(t,e,i,r){const{props:s,attrs:n,vnode:{patchFlag:o}}=t,a=vt(s),[c]=t.propsOptions;let d=!1;if((r||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let m=0;m<h.length;m++){let p=h[m];if(wn(t.emitsOptions,p))continue;const u=e[p];if(c)if(St(n,p))u!==n[p]&&(n[p]=u,d=!0);else{const f=$t(p);s[f]=gr(c,a,f,u,t,!1)}else u!==n[p]&&(n[p]=u,d=!0)}}}else{Xs(t,e,s,n)&&(d=!0);let h;for(const m in a)(!e||!St(e,m)&&((h=Yt(m))===m||!St(e,h)))&&(c?i&&(i[m]!==void 0||i[h]!==void 0)&&(s[m]=gr(c,a,m,void 0,t,!0)):delete s[m]);if(n!==a)for(const m in n)(!e||!St(e,m))&&(delete n[m],d=!0)}d&&he(t.attrs,"set","")}function Xs(t,e,i,r){const[s,n]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(Xe(c))continue;const d=e[c];let h;s&&St(s,h=$t(c))?!n||!n.includes(h)?i[h]=d:(a||(a={}))[h]=d:wn(t.emitsOptions,c)||(!(c in r)||d!==r[c])&&(r[c]=d,o=!0)}if(n){const c=vt(i),d=a||wt;for(let h=0;h<n.length;h++){const m=n[h];i[m]=gr(s,c,m,d[m],t,!St(d,m))}}return o}function gr(t,e,i,r,s,n){const o=t[i];if(o!=null){const a=St(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&pt(c)){const{propsDefaults:d}=s;if(i in d)r=d[i];else{const h=di(s);r=d[i]=c.call(null,e),h()}}else r=c;s.ce&&s.ce._setProp(i,r)}o[0]&&(n&&!a?r=!1:o[1]&&(r===""||r===Yt(i))&&(r=!0))}return r}const Dc=new WeakMap;function $s(t,e,i=!1){const r=i?Dc:e.propsCache,s=r.get(t);if(s)return s;const n=t.props,o={},a=[];let c=!1;if(!pt(t)){const h=m=>{c=!0;const[p,u]=$s(m,e,!0);Nt(o,p),u&&a.push(...u)};!i&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!n&&!c)return Rt(t)&&r.set(t,Oe),Oe;if(gt(n))for(let h=0;h<n.length;h++){const m=$t(n[h]);Qs(m)&&(o[m]=wt)}else if(n)for(const h in n){const m=$t(h);if(Qs(m)){const p=n[h],u=o[m]=gt(p)||pt(p)?{type:p}:Nt({},p),f=u.type;let y=!1,S=!0;if(gt(f))for(let w=0;w<f.length;++w){const g=f[w],l=pt(g)&&g.name;if(l==="Boolean"){y=!0;break}else l==="String"&&(S=!1)}else y=pt(f)&&f.name==="Boolean";u[0]=y,u[1]=S,(y||St(u,"default"))&&a.push(m)}}const d=[o,a];return Rt(t)&&r.set(t,d),d}function Qs(t){return t[0]!=="$"&&!Xe(t)}const Js=t=>t[0]==="_"||t==="$stable",pr=t=>gt(t)?t.map(se):[se(t)],Lc=(t,e,i)=>{if(e._n)return e;const r=cc((...s)=>pr(e(...s)),i);return r._c=!1,r},Zs=(t,e,i)=>{const r=t._ctx;for(const s in t){if(Js(s))continue;const n=t[s];if(pt(n))e[s]=Lc(s,n,r);else if(n!=null){const o=pr(n);e[s]=()=>o}}},to=(t,e)=>{const i=pr(e);t.slots.default=()=>i},eo=(t,e,i)=>{for(const r in e)(i||r!=="_")&&(t[r]=e[r])},Gc=(t,e,i)=>{const r=t.slots=js();if(t.vnode.shapeFlag&32){const s=e._;s?(eo(r,e,i),i&&Yr(r,"_",s,!0)):Zs(e,r)}else e&&to(t,e)},Uc=(t,e,i)=>{const{vnode:r,slots:s}=t;let n=!0,o=wt;if(r.shapeFlag&32){const a=e._;a?i&&a===1?n=!1:eo(s,e,i):(n=!e.$stable,Zs(e,s)),o=e}else e&&(to(t,e),o={default:1});if(n)for(const a in s)!Js(a)&&o[a]==null&&delete s[a]},Kt=Zc;function Bc(t){return Hc(t)}function Hc(t,e){const i=Jr();i.__VUE__=!0;const{insert:r,remove:s,patchProp:n,createElement:o,createText:a,createComment:c,setText:d,setElementText:h,parentNode:m,nextSibling:p,setScopeId:u=Zt,insertStaticContent:f}=t,y=(E,k,z,Y=null,$=null,X=null,tt=void 0,rt=null,it=!!k.dynamicChildren)=>{if(E===k)return;E&&!hi(E,k)&&(Y=M(E),j(E,$,X,!0),E=null),k.patchFlag===-2&&(it=!1,k.dynamicChildren=null);const{type:Z,ref:ct,shapeFlag:at}=k;switch(Z){case Pn:S(E,k,z,Y);break;case Fe:w(E,k,z,Y);break;case _r:E==null&&g(k,z,Y,tt);break;case ge:D(E,k,z,Y,$,X,tt,rt,it);break;default:at&1?v(E,k,z,Y,$,X,tt,rt,it):at&6?B(E,k,z,Y,$,X,tt,rt,it):(at&64||at&128)&&Z.process(E,k,z,Y,$,X,tt,rt,it,lt)}ct!=null&&$&&lr(ct,E&&E.ref,X,k||E,!k)},S=(E,k,z,Y)=>{if(E==null)r(k.el=a(k.children),z,Y);else{const $=k.el=E.el;k.children!==E.children&&d($,k.children)}},w=(E,k,z,Y)=>{E==null?r(k.el=c(k.children||""),z,Y):k.el=E.el},g=(E,k,z,Y)=>{[E.el,E.anchor]=f(E.children,k,z,Y,E.el,E.anchor)},l=({el:E,anchor:k},z,Y)=>{let $;for(;E&&E!==k;)$=p(E),r(E,z,Y),E=$;r(k,z,Y)},_=({el:E,anchor:k})=>{let z;for(;E&&E!==k;)z=p(E),s(E),E=z;s(k)},v=(E,k,z,Y,$,X,tt,rt,it)=>{k.type==="svg"?tt="svg":k.type==="math"&&(tt="mathml"),E==null?T(k,z,Y,$,X,tt,rt,it):x(E,k,$,X,tt,rt,it)},T=(E,k,z,Y,$,X,tt,rt)=>{let it,Z;const{props:ct,shapeFlag:at,transition:H,dirs:U}=E;if(it=E.el=o(E.type,X,ct&&ct.is,ct),at&8?h(it,E.children):at&16&&C(E.children,it,null,Y,$,mr(E,X),tt,rt),U&&Ae(E,null,Y,"created"),I(it,E,E.scopeId,tt,Y),ct){for(const et in ct)et!=="value"&&!Xe(et)&&n(it,et,null,ct[et],X,Y);"value"in ct&&n(it,"value",null,ct.value,X),(Z=ct.onVnodeBeforeMount)&&oe(Z,Y,E)}U&&Ae(E,null,Y,"beforeMount");const K=Vc($,H);K&&H.beforeEnter(it),r(it,k,z),((Z=ct&&ct.onVnodeMounted)||K||U)&&Kt(()=>{Z&&oe(Z,Y,E),K&&H.enter(it),U&&Ae(E,null,Y,"mounted")},$)},I=(E,k,z,Y,$)=>{if(z&&u(E,z),Y)for(let X=0;X<Y.length;X++)u(E,Y[X]);if($){let X=$.subTree;if(k===X||ho(X.type)&&(X.ssContent===k||X.ssFallback===k)){const tt=$.vnode;I(E,tt,tt.scopeId,tt.slotScopeIds,$.parent)}}},C=(E,k,z,Y,$,X,tt,rt,it=0)=>{for(let Z=it;Z<E.length;Z++){const ct=E[Z]=rt?Ce(E[Z]):se(E[Z]);y(null,ct,k,z,Y,$,X,tt,rt)}},x=(E,k,z,Y,$,X,tt)=>{const rt=k.el=E.el;let{patchFlag:it,dynamicChildren:Z,dirs:ct}=k;it|=E.patchFlag&16;const at=E.props||wt,H=k.props||wt;let U;if(z&&Me(z,!1),(U=H.onVnodeBeforeUpdate)&&oe(U,z,k,E),ct&&Ae(k,E,z,"beforeUpdate"),z&&Me(z,!0),(at.innerHTML&&H.innerHTML==null||at.textContent&&H.textContent==null)&&h(rt,""),Z?R(E.dynamicChildren,Z,rt,z,Y,mr(k,$),X):tt||P(E,k,rt,null,z,Y,mr(k,$),X,!1),it>0){if(it&16)F(rt,at,H,z,$);else if(it&2&&at.class!==H.class&&n(rt,"class",null,H.class,$),it&4&&n(rt,"style",at.style,H.style,$),it&8){const K=k.dynamicProps;for(let et=0;et<K.length;et++){const st=K[et],ut=at[st],ht=H[st];(ht!==ut||st==="value")&&n(rt,st,ut,ht,$,z)}}it&1&&E.children!==k.children&&h(rt,k.children)}else!tt&&Z==null&&F(rt,at,H,z,$);((U=H.onVnodeUpdated)||ct)&&Kt(()=>{U&&oe(U,z,k,E),ct&&Ae(k,E,z,"updated")},Y)},R=(E,k,z,Y,$,X,tt)=>{for(let rt=0;rt<k.length;rt++){const it=E[rt],Z=k[rt],ct=it.el&&(it.type===ge||!hi(it,Z)||it.shapeFlag&70)?m(it.el):z;y(it,Z,ct,null,Y,$,X,tt,!0)}},F=(E,k,z,Y,$)=>{if(k!==z){if(k!==wt)for(const X in k)!Xe(X)&&!(X in z)&&n(E,X,k[X],null,$,Y);for(const X in z){if(Xe(X))continue;const tt=z[X],rt=k[X];tt!==rt&&X!=="value"&&n(E,X,rt,tt,$,Y)}"value"in z&&n(E,"value",k.value,z.value,$)}},D=(E,k,z,Y,$,X,tt,rt,it)=>{const Z=k.el=E?E.el:a(""),ct=k.anchor=E?E.anchor:a("");let{patchFlag:at,dynamicChildren:H,slotScopeIds:U}=k;U&&(rt=rt?rt.concat(U):U),E==null?(r(Z,z,Y),r(ct,z,Y),C(k.children||[],z,ct,$,X,tt,rt,it)):at>0&&at&64&&H&&E.dynamicChildren?(R(E.dynamicChildren,H,z,$,X,tt,rt),(k.key!=null||$&&k===$.subTree)&&io(E,k,!0)):P(E,k,z,ct,$,X,tt,rt,it)},B=(E,k,z,Y,$,X,tt,rt,it)=>{k.slotScopeIds=rt,E==null?k.shapeFlag&512?$.ctx.activate(k,z,Y,tt,it):V(k,z,Y,$,X,tt,it):L(E,k,it)},V=(E,k,z,Y,$,X,tt)=>{const rt=E.component=lh(E,Y,$);if(Ds(E)&&(rt.ctx.renderer=lt),ch(rt,!1,tt),rt.asyncDep){if($&&$.registerDep(rt,Q,tt),!E.el){const it=rt.subTree=re(Fe);w(null,it,k,z)}}else Q(rt,E,k,z,$,X,tt)},L=(E,k,z)=>{const Y=k.component=E.component;if(Qc(E,k,z))if(Y.asyncDep&&!Y.asyncResolved){b(Y,k,z);return}else Y.next=k,Y.update();else k.el=E.el,Y.vnode=k},Q=(E,k,z,Y,$,X,tt)=>{const rt=()=>{if(E.isMounted){let{next:at,bu:H,u:U,parent:K,vnode:et}=E;{const _t=no(E);if(_t){at&&(at.el=et.el,b(E,at,tt)),_t.asyncDep.then(()=>{E.isUnmounted||rt()});return}}let st=at,ut;Me(E,!1),at?(at.el=et.el,b(E,at,tt)):at=et,H&&on(H),(ut=at.props&&at.props.onVnodeBeforeUpdate)&&oe(ut,K,at,et),Me(E,!0);const ht=lo(E),ft=E.subTree;E.subTree=ht,y(ft,ht,m(ft.el),M(ft),E,$,X),at.el=ht.el,st===null&&Jc(E,ht.el),U&&Kt(U,$),(ut=at.props&&at.props.onVnodeUpdated)&&Kt(()=>oe(ut,K,at,et),$)}else{let at;const{el:H,props:U}=k,{bm:K,m:et,parent:st,root:ut,type:ht}=E,ft=si(k);Me(E,!1),K&&on(K),!ft&&(at=U&&U.onVnodeBeforeMount)&&oe(at,st,k),Me(E,!0);{ut.ce&&ut.ce._injectChildStyle(ht);const _t=E.subTree=lo(E);y(null,_t,z,Y,E,$,X),k.el=_t.el}if(et&&Kt(et,$),!ft&&(at=U&&U.onVnodeMounted)){const _t=k;Kt(()=>oe(at,st,_t),$)}(k.shapeFlag&256||st&&si(st.vnode)&&st.vnode.shapeFlag&256)&&E.a&&Kt(E.a,$),E.isMounted=!0,k=z=Y=null}};E.scope.on();const it=E.effect=new is(rt);E.scope.off();const Z=E.update=it.run.bind(it),ct=E.job=it.runIfDirty.bind(it);ct.i=E,ct.id=E.uid,it.scheduler=()=>or(ct),Me(E,!0),Z()},b=(E,k,z)=>{k.component=E;const Y=E.vnode.props;E.vnode=k,E.next=null,Oc(E,k.props,Y,z),Uc(E,k.children,z),le(),Ms(E),ce()},P=(E,k,z,Y,$,X,tt,rt,it=!1)=>{const Z=E&&E.children,ct=E?E.shapeFlag:0,at=k.children,{patchFlag:H,shapeFlag:U}=k;if(H>0){if(H&128){A(Z,at,z,Y,$,X,tt,rt,it);return}else if(H&256){N(Z,at,z,Y,$,X,tt,rt,it);return}}U&8?(ct&16&&W(Z,$,X),at!==Z&&h(z,at)):ct&16?U&16?A(Z,at,z,Y,$,X,tt,rt,it):W(Z,$,X,!0):(ct&8&&h(z,""),U&16&&C(at,z,Y,$,X,tt,rt,it))},N=(E,k,z,Y,$,X,tt,rt,it)=>{E=E||Oe,k=k||Oe;const Z=E.length,ct=k.length,at=Math.min(Z,ct);let H;for(H=0;H<at;H++){const U=k[H]=it?Ce(k[H]):se(k[H]);y(E[H],U,z,null,$,X,tt,rt,it)}Z>ct?W(E,$,X,!0,!1,at):C(k,z,Y,$,X,tt,rt,it,at)},A=(E,k,z,Y,$,X,tt,rt,it)=>{let Z=0;const ct=k.length;let at=E.length-1,H=ct-1;for(;Z<=at&&Z<=H;){const U=E[Z],K=k[Z]=it?Ce(k[Z]):se(k[Z]);if(hi(U,K))y(U,K,z,null,$,X,tt,rt,it);else break;Z++}for(;Z<=at&&Z<=H;){const U=E[at],K=k[H]=it?Ce(k[H]):se(k[H]);if(hi(U,K))y(U,K,z,null,$,X,tt,rt,it);else break;at--,H--}if(Z>at){if(Z<=H){const U=H+1,K=U<ct?k[U].el:Y;for(;Z<=H;)y(null,k[Z]=it?Ce(k[Z]):se(k[Z]),z,K,$,X,tt,rt,it),Z++}}else if(Z>H)for(;Z<=at;)j(E[Z],$,X,!0),Z++;else{const U=Z,K=Z,et=new Map;for(Z=K;Z<=H;Z++){const It=k[Z]=it?Ce(k[Z]):se(k[Z]);It.key!=null&&et.set(It.key,Z)}let st,ut=0;const ht=H-K+1;let ft=!1,_t=0;const Ct=new Array(ht);for(Z=0;Z<ht;Z++)Ct[Z]=0;for(Z=U;Z<=at;Z++){const It=E[Z];if(ut>=ht){j(It,$,X,!0);continue}let zt;if(It.key!=null)zt=et.get(It.key);else for(st=K;st<=H;st++)if(Ct[st-K]===0&&hi(It,k[st])){zt=st;break}zt===void 0?j(It,$,X,!0):(Ct[zt-K]=Z+1,zt>=_t?_t=zt:ft=!0,y(It,k[zt],z,null,$,X,tt,rt,it),ut++)}const Mt=ft?zc(Ct):Oe;for(st=Mt.length-1,Z=ht-1;Z>=0;Z--){const It=K+Z,zt=k[It],Dn=It+1<ct?k[It+1].el:Y;Ct[Z]===0?y(null,zt,z,Dn,$,X,tt,rt,it):ft&&(st<0||Z!==Mt[st]?O(zt,z,Dn,2):st--)}}},O=(E,k,z,Y,$=null)=>{const{el:X,type:tt,transition:rt,children:it,shapeFlag:Z}=E;if(Z&6){O(E.component.subTree,k,z,Y);return}if(Z&128){E.suspense.move(k,z,Y);return}if(Z&64){tt.move(E,k,z,lt);return}if(tt===ge){r(X,k,z);for(let at=0;at<it.length;at++)O(it[at],k,z,Y);r(E.anchor,k,z);return}if(tt===_r){l(E,k,z);return}if(Y!==2&&Z&1&&rt)if(Y===0)rt.beforeEnter(X),r(X,k,z),Kt(()=>rt.enter(X),$);else{const{leave:at,delayLeave:H,afterLeave:U}=rt,K=()=>r(X,k,z),et=()=>{at(X,()=>{K(),U&&U()})};H?H(X,K,et):et()}else r(X,k,z)},j=(E,k,z,Y=!1,$=!1)=>{const{type:X,props:tt,ref:rt,children:it,dynamicChildren:Z,shapeFlag:ct,patchFlag:at,dirs:H,cacheIndex:U}=E;if(at===-2&&($=!1),rt!=null&&lr(rt,null,z,E,!0),U!=null&&(k.renderCache[U]=void 0),ct&256){k.ctx.deactivate(E);return}const K=ct&1&&H,et=!si(E);let st;if(et&&(st=tt&&tt.onVnodeBeforeUnmount)&&oe(st,k,E),ct&6)ot(E.component,z,Y);else{if(ct&128){E.suspense.unmount(z,Y);return}K&&Ae(E,null,k,"beforeUnmount"),ct&64?E.type.remove(E,k,z,lt,Y):Z&&!Z.hasOnce&&(X!==ge||at>0&&at&64)?W(Z,k,z,!1,!0):(X===ge&&at&384||!$&&ct&16)&&W(it,k,z),Y&&G(E)}(et&&(st=tt&&tt.onVnodeUnmounted)||K)&&Kt(()=>{st&&oe(st,k,E),K&&Ae(E,null,k,"unmounted")},z)},G=E=>{const{type:k,el:z,anchor:Y,transition:$}=E;if(k===ge){J(z,Y);return}if(k===_r){_(E);return}const X=()=>{s(z),$&&!$.persisted&&$.afterLeave&&$.afterLeave()};if(E.shapeFlag&1&&$&&!$.persisted){const{leave:tt,delayLeave:rt}=$,it=()=>tt(z,X);rt?rt(E.el,X,it):it()}else X()},J=(E,k)=>{let z;for(;E!==k;)z=p(E),s(E),E=z;s(k)},ot=(E,k,z)=>{const{bum:Y,scope:$,job:X,subTree:tt,um:rt,m:it,a:Z}=E;ro(it),ro(Z),Y&&on(Y),$.stop(),X&&(X.flags|=8,j(tt,E,k,z)),rt&&Kt(rt,k),Kt(()=>{E.isUnmounted=!0},k),k&&k.pendingBranch&&!k.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===k.pendingId&&(k.deps--,k.deps===0&&k.resolve())},W=(E,k,z,Y=!1,$=!1,X=0)=>{for(let tt=X;tt<E.length;tt++)j(E[tt],k,z,Y,$)},M=E=>{if(E.shapeFlag&6)return M(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const k=p(E.anchor||E.el),z=k&&k[dc];return z?p(z):k};let q=!1;const nt=(E,k,z)=>{E==null?k._vnode&&j(k._vnode,null,null,!0):y(k._vnode||null,E,k,null,null,null,z),k._vnode=E,q||(q=!0,Ms(),Ns(),q=!1)},lt={p:y,um:j,m:O,r:G,mt:V,mc:C,pc:P,pbc:R,n:M,o:t};return{render:nt,hydrate:void 0,createApp:Fc(nt)}}function mr({type:t,props:e},i){return i==="svg"&&t==="foreignObject"||i==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:i}function Me({effect:t,job:e},i){i?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Vc(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function io(t,e,i=!1){const r=t.children,s=e.children;if(gt(r)&&gt(s))for(let n=0;n<r.length;n++){const o=r[n];let a=s[n];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[n]=Ce(s[n]),a.el=o.el),!i&&a.patchFlag!==-2&&io(o,a)),a.type===Pn&&(a.el=o.el)}}function zc(t){const e=t.slice(),i=[0];let r,s,n,o,a;const c=t.length;for(r=0;r<c;r++){const d=t[r];if(d!==0){if(s=i[i.length-1],t[s]<d){e[r]=s,i.push(r);continue}for(n=0,o=i.length-1;n<o;)a=n+o>>1,t[i[a]]<d?n=a+1:o=a;d<t[i[n]]&&(n>0&&(e[r]=i[n-1]),i[n]=r)}}for(n=i.length,o=i[n-1];n-- >0;)i[n]=o,o=e[o];return i}function no(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:no(e)}function ro(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const qc=Symbol.for("v-scx"),Wc=()=>xn(qc);function Ne(t,e,i){return so(t,e,i)}function so(t,e,i=wt){const{immediate:r,deep:s,flush:n,once:o}=i,a=Nt({},i);let c;if(En)if(n==="sync"){const p=Wc();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!e||r)a.once=!0;else{const p=()=>{};return p.stop=Zt,p.resume=Zt,p.pause=Zt,p}const d=Bt;a.call=(p,u,f)=>ie(p,d,u,f);let h=!1;n==="post"?a.scheduler=p=>{Kt(p,d&&d.suspense)}:n!=="sync"&&(h=!0,a.scheduler=(p,u)=>{u?p():or(p)}),a.augmentJob=p=>{e&&(p.flags|=4),h&&(p.flags|=2,d&&(p.id=d.uid,p.i=d))};const m=ec(t,e,a);return c&&c.push(m),m}function Kc(t,e,i){const r=this.proxy,s=Et(t)?t.includes(".")?oo(r,t):()=>r[t]:t.bind(r,r);let n;pt(e)?n=e:(n=e.handler,i=e);const o=di(this),a=so(s,n.bind(r),i);return o(),a}function oo(t,e){const i=e.split(".");return()=>{let r=t;for(let s=0;s<i.length&&r;s++)r=r[i[s]];return r}}const jc=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${$t(e)}Modifiers`]||t[`${Yt(e)}Modifiers`];function Yc(t,e,...i){if(t.isUnmounted)return;const r=t.vnode.props||wt;let s=i;const n=e.startsWith("update:"),o=n&&jc(r,e.slice(7));o&&(o.trim&&(s=i.map(h=>Et(h)?h.trim():h)),o.number&&(s=i.map(Xr)));let a,c=r[a=Hn(e)]||r[a=Hn($t(e))];!c&&n&&(c=r[a=Hn(Yt(e))]),c&&ie(c,t,6,s);const d=r[a+"Once"];if(d){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,ie(d,t,6,s)}}function ao(t,e,i=!1){const r=e.emitsCache,s=r.get(t);if(s!==void 0)return s;const n=t.emits;let o={},a=!1;if(!pt(t)){const c=d=>{const h=ao(d,e,!0);h&&(a=!0,Nt(o,h))};!i&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!n&&!a?(Rt(t)&&r.set(t,null),null):(gt(n)?n.forEach(c=>o[c]=null):Nt(o,n),Rt(t)&&r.set(t,o),o)}function wn(t,e){return!t||!en(e)?!1:(e=e.slice(2).replace(/Once$/,""),St(t,e[0].toLowerCase()+e.slice(1))||St(t,Yt(e))||St(t,e))}function Tu(){}function lo(t){const{type:e,vnode:i,proxy:r,withProxy:s,propsOptions:[n],slots:o,attrs:a,emit:c,render:d,renderCache:h,props:m,data:p,setupState:u,ctx:f,inheritAttrs:y}=t,S=vn(t);let w,g;try{if(i.shapeFlag&4){const _=s||r,v=_;w=se(d.call(v,_,h,m,u,p,f)),g=a}else{const _=e;w=se(_.length>1?_(m,{attrs:a,slots:o,emit:c}):_(m,null)),g=e.props?a:Xc(a)}}catch(_){li.length=0,yn(_,t,1),w=re(Fe)}let l=w;if(g&&y!==!1){const _=Object.keys(g),{shapeFlag:v}=l;_.length&&v&7&&(n&&_.some(Gn)&&(g=$c(g,n)),l=ze(l,g,!1,!0))}return i.dirs&&(l=ze(l,null,!1,!0),l.dirs=l.dirs?l.dirs.concat(i.dirs):i.dirs),i.transition&&ar(l,i.transition),w=l,vn(S),w}const Xc=t=>{let e;for(const i in t)(i==="class"||i==="style"||en(i))&&((e||(e={}))[i]=t[i]);return e},$c=(t,e)=>{const i={};for(const r in t)(!Gn(r)||!(r.slice(9)in e))&&(i[r]=t[r]);return i};function Qc(t,e,i){const{props:r,children:s,component:n}=t,{props:o,children:a,patchFlag:c}=e,d=n.emitsOptions;if(e.dirs||e.transition)return!0;if(i&&c>=0){if(c&1024)return!0;if(c&16)return r?co(r,o,d):!!o;if(c&8){const h=e.dynamicProps;for(let m=0;m<h.length;m++){const p=h[m];if(o[p]!==r[p]&&!wn(d,p))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?co(r,o,d):!0:!!o;return!1}function co(t,e,i){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const n=r[s];if(e[n]!==t[n]&&!wn(i,n))return!0}return!1}function Jc({vnode:t,parent:e},i){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=i,e=e.parent;else break}}const ho=t=>t.__isSuspense;function Zc(t,e){e&&e.pendingBranch?gt(t)?e.effects.push(...t):e.effects.push(t):lc(t)}const ge=Symbol.for("v-fgt"),Pn=Symbol.for("v-txt"),Fe=Symbol.for("v-cmt"),_r=Symbol.for("v-stc"),li=[];let jt=null;function yr(t=!1){li.push(jt=t?null:[])}function th(){li.pop(),jt=li[li.length-1]||null}let ci=1;function uo(t){ci+=t,t<0&&jt&&(jt.hasOnce=!0)}function fo(t){return t.dynamicChildren=ci>0?jt||Oe:null,th(),ci>0&&jt&&jt.push(t),t}function go(t,e,i,r,s,n){return fo(xt(t,e,i,r,s,n,!0))}function eh(t,e,i,r,s){return fo(re(t,e,i,r,s,!0))}function po(t){return t?t.__v_isVNode===!0:!1}function hi(t,e){return t.type===e.type&&t.key===e.key}const mo=({key:t})=>t??null,Rn=({ref:t,ref_key:e,ref_for:i})=>(typeof t=="number"&&(t=""+t),t!=null?Et(t)||kt(t)||pt(t)?{i:Xt,r:t,k:e,f:!!i}:t:null);function xt(t,e=null,i=null,r=0,s=null,n=t===ge?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&mo(e),ref:e&&Rn(e),scopeId:ks,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Xt};return a?(br(c,i),n&128&&t.normalize(c)):i&&(c.shapeFlag|=Et(i)?8:16),ci>0&&!o&&jt&&(c.patchFlag>0||n&6)&&c.patchFlag!==32&&jt.push(c),c}const re=ih;function ih(t,e=null,i=null,r=0,s=null,n=!1){if((!t||t===wc)&&(t=Fe),po(t)){const a=ze(t,e,!0);return i&&br(a,i),ci>0&&!n&&jt&&(a.shapeFlag&6?jt[jt.indexOf(t)]=a:jt.push(a)),a.patchFlag=-2,a}if(mh(t)&&(t=t.__vccOpts),e){e=nh(e);let{class:a,style:c}=e;a&&!Et(a)&&(e.class=Le(a)),Rt(c)&&(ir(c)&&!gt(c)&&(c=Nt({},c)),e.style=be(c))}const o=Et(t)?1:ho(t)?128:uc(t)?64:Rt(t)?4:pt(t)?2:0;return xt(t,e,i,r,s,o,n,!0)}function nh(t){return t?ir(t)||Ys(t)?Nt({},t):t:null}function ze(t,e,i=!1,r=!1){const{props:s,ref:n,patchFlag:o,children:a,transition:c}=t,d=e?sh(s||{},e):s,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:d,key:d&&mo(d),ref:e&&e.ref?i&&n?gt(n)?n.concat(Rn(e)):[n,Rn(e)]:Rn(e):n,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==ge?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&ze(t.ssContent),ssFallback:t.ssFallback&&ze(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&r&&ar(h,c.clone(h)),h}function _o(t=" ",e=0){return re(Pn,null,t,e)}function rh(t="",e=!1){return e?(yr(),eh(Fe,null,t)):re(Fe,null,t)}function se(t){return t==null||typeof t=="boolean"?re(Fe):gt(t)?re(ge,null,t.slice()):po(t)?Ce(t):re(Pn,null,String(t))}function Ce(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:ze(t)}function br(t,e){let i=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(gt(e))i=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),br(t,s()),s._c&&(s._d=!0));return}else{i=32;const s=e._;!s&&!Ys(e)?e._ctx=Xt:s===3&&Xt&&(Xt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else pt(e)?(e={default:e,_ctx:Xt},i=32):(e=String(e),r&64?(i=16,e=[_o(e)]):i=8);t.children=e,t.shapeFlag|=i}function sh(...t){const e={};for(let i=0;i<t.length;i++){const r=t[i];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=Le([e.class,r.class]));else if(s==="style")e.style=be([e.style,r.style]);else if(en(s)){const n=e[s],o=r[s];o&&n!==o&&!(gt(n)&&n.includes(o))&&(e[s]=n?[].concat(n,o):o)}else s!==""&&(e[s]=r[s])}return e}function oe(t,e,i,r=null){ie(t,e,7,[i,r])}const oh=Ws();let ah=0;function lh(t,e,i){const r=t.type,s=(e?e.appContext:t.appContext)||oh,n={uid:ah++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new wl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:$s(r,s),emitsOptions:ao(r,s),emit:null,emitted:null,propsDefaults:wt,inheritAttrs:r.inheritAttrs,ctx:wt,data:wt,props:wt,attrs:wt,slots:wt,refs:wt,setupState:wt,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=e?e.root:n,n.emit=Yc.bind(null,n),t.ce&&t.ce(n),n}let Bt=null,Tn,vr;{const t=Jr(),e=(i,r)=>{let s;return(s=t[i])||(s=t[i]=[]),s.push(r),n=>{s.length>1?s.forEach(o=>o(n)):s[0](n)}};Tn=e("__VUE_INSTANCE_SETTERS__",i=>Bt=i),vr=e("__VUE_SSR_SETTERS__",i=>En=i)}const di=t=>{const e=Bt;return Tn(t),t.scope.on(),()=>{t.scope.off(),Tn(e)}},yo=()=>{Bt&&Bt.scope.off(),Tn(null)};function bo(t){return t.vnode.shapeFlag&4}let En=!1;function ch(t,e=!1,i=!1){e&&vr(e);const{props:r,children:s}=t.vnode,n=bo(t);Ic(t,r,n,e),Gc(t,s,i);const o=n?hh(t,e):void 0;return e&&vr(!1),o}function hh(t,e){const i=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Pc);const{setup:r}=i;if(r){const s=t.setupContext=r.length>1?uh(t):null,n=di(t);le();const o=Ue(r,t,0,[t.props,s]);if(ce(),n(),Wr(o)){if(si(t)||Os(t),o.then(yo,yo),e)return o.then(a=>{vo(t,a)}).catch(a=>{yn(a,t,0)});t.asyncDep=o}else vo(t,o)}else So(t)}function vo(t,e,i){pt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Rt(e)&&(t.setupState=Rs(e)),So(t)}function So(t,e,i){const r=t.type;t.render||(t.render=r.render||Zt);{const s=di(t);le();try{Rc(t)}finally{ce(),s()}}}const dh={get(t,e){return Ot(t,"get",""),t[e]}};function uh(t){const e=i=>{t.exposed=i||{}};return{attrs:new Proxy(t.attrs,dh),slots:t.slots,emit:t.emit,expose:e}}function An(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Rs(Yl(t.exposed)),{get(e,i){if(i in e)return e[i];if(i in oi)return oi[i](t)},has(e,i){return i in e||i in oi}})):t.proxy}const fh=/(?:^|[-_])(\w)/g,gh=t=>t.replace(fh,e=>e.toUpperCase()).replace(/[-_]/g,"");function ph(t,e=!0){return pt(t)?t.displayName||t.name:t.name||e&&t.__name}function Co(t,e,i=!1){let r=ph(e);if(!r&&e.__file){const s=e.__file.match(/([^/\\]+)\.\w+$/);s&&(r=s[1])}if(!r&&t&&t.parent){const s=n=>{for(const o in n)if(n[o]===e)return o};r=s(t.components||t.parent.type.components)||s(t.appContext.components)}return r?gh(r):i?"App":"Anonymous"}function mh(t){return pt(t)&&"__vccOpts"in t}const ke=(t,e)=>Zl(t,e,En),_h="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Sr;const xo=typeof window<"u"&&window.trustedTypes;if(xo)try{Sr=xo.createPolicy("vue",{createHTML:t=>t})}catch{}const wo=Sr?t=>Sr.createHTML(t):t=>t,yh="http://www.w3.org/2000/svg",bh="http://www.w3.org/1998/Math/MathML",pe=typeof document<"u"?document:null,Po=pe&&pe.createElement("template"),vh={insert:(t,e,i)=>{e.insertBefore(t,i||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,i,r)=>{const s=e==="svg"?pe.createElementNS(yh,t):e==="mathml"?pe.createElementNS(bh,t):i?pe.createElement(t,{is:i}):pe.createElement(t);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>pe.createTextNode(t),createComment:t=>pe.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>pe.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,i,r,s,n){const o=i?i.previousSibling:e.lastChild;if(s&&(s===n||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),i),!(s===n||!(s=s.nextSibling)););else{Po.innerHTML=wo(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const a=Po.content;if(r==="svg"||r==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,i)}return[o?o.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}},Sh=Symbol("_vtc");function Ch(t,e,i){const r=t[Sh];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):i?t.setAttribute("class",e):t.className=e}const Ro=Symbol("_vod"),xh=Symbol("_vsh"),wh=Symbol(""),Ph=/(^|;)\s*display\s*:/;function Rh(t,e,i){const r=t.style,s=Et(i);let n=!1;if(i&&!s){if(e)if(Et(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();i[a]==null&&Mn(r,a,"")}else for(const o in e)i[o]==null&&Mn(r,o,"");for(const o in i)o==="display"&&(n=!0),Mn(r,o,i[o])}else if(s){if(e!==i){const o=r[wh];o&&(i+=";"+o),r.cssText=i,n=Ph.test(i)}}else e&&t.removeAttribute("style");Ro in t&&(t[Ro]=n?r.display:"",t[xh]&&(r.display="none"))}const To=/\s*!important$/;function Mn(t,e,i){if(gt(i))i.forEach(r=>Mn(t,e,r));else if(i==null&&(i=""),e.startsWith("--"))t.setProperty(e,i);else{const r=Th(t,e);To.test(i)?t.setProperty(Yt(r),i.replace(To,""),"important"):t[r]=i}}const Eo=["Webkit","Moz","ms"],Cr={};function Th(t,e){const i=Cr[e];if(i)return i;let r=$t(e);if(r!=="filter"&&r in t)return Cr[e]=r;r=jr(r);for(let s=0;s<Eo.length;s++){const n=Eo[s]+r;if(n in t)return Cr[e]=n}return e}const Ao="http://www.w3.org/1999/xlink";function Mo(t,e,i,r,s,n=Sl(e)){r&&e.startsWith("xlink:")?i==null?t.removeAttributeNS(Ao,e.slice(6,e.length)):t.setAttributeNS(Ao,e,i):i==null||n&&!Zr(i)?t.removeAttribute(e):t.setAttribute(e,n?"":te(i)?String(i):i)}function No(t,e,i,r){if(e==="innerHTML"||e==="textContent"){i!=null&&(t[e]=e==="innerHTML"?wo(i):i);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,a=i==null?t.type==="checkbox"?"on":"":String(i);(o!==a||!("_value"in t))&&(t.value=a),i==null&&t.removeAttribute(e),t._value=i;return}let n=!1;if(i===""||i==null){const o=typeof t[e];o==="boolean"?i=Zr(i):i==null&&o==="string"?(i="",n=!0):o==="number"&&(i=0,n=!0)}try{t[e]=i}catch{}n&&t.removeAttribute(e)}function Fo(t,e,i,r){t.addEventListener(e,i,r)}function Eh(t,e,i,r){t.removeEventListener(e,i,r)}const ko=Symbol("_vei");function Ah(t,e,i,r,s=null){const n=t[ko]||(t[ko]={}),o=n[e];if(r&&o)o.value=r;else{const[a,c]=Mh(e);if(r){const d=n[e]=kh(r,s);Fo(t,a,d,c)}else o&&(Eh(t,a,o,c),n[e]=void 0)}}const Io=/(?:Once|Passive|Capture)$/;function Mh(t){let e;if(Io.test(t)){e={};let r;for(;r=t.match(Io);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Yt(t.slice(2)),e]}let xr=0;const Nh=Promise.resolve(),Fh=()=>xr||(Nh.then(()=>xr=0),xr=Date.now());function kh(t,e){const i=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=i.attached)return;ie(Ih(r,i.value),e,5,[r])};return i.value=t,i.attached=Fh(),i}function Ih(t,e){if(gt(e)){const i=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{i.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Oo=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Oh=(t,e,i,r,s,n)=>{const o=s==="svg";e==="class"?Ch(t,r,o):e==="style"?Rh(t,i,r):en(e)?Gn(e)||Ah(t,e,i,r,n):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Dh(t,e,r,o))?(No(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Mo(t,e,r,o,n,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Et(r))?No(t,$t(e),r):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),Mo(t,e,r,o))};function Dh(t,e,i,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&Oo(e)&&pt(i));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Oo(e)&&Et(i)?!1:e in t}const Do={};/*! #__NO_SIDE_EFFECTS__ */function Lh(t,e,i){const r=Is(t,e);rn(r)&&Nt(r,e);class s extends wr{constructor(o){super(r,o,i)}}return s.def=r,s}const Gh=typeof HTMLElement<"u"?HTMLElement:class{};class wr extends Gh{constructor(e,i={},r=Ho){super(),this._def=e,this._props=i,this._createApp=r,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&r!==Ho?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof wr){this._parent=e;break}this._instance||(this._resolved?(this._setParent(),this._update()):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._instance.provides=e._instance.provides)}disconnectedCallback(){this._connected=!1,sr(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let r=0;r<this.attributes.length;r++)this._setAttr(this.attributes[r].name);this._ob=new MutationObserver(r=>{for(const s of r)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(r,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:n,styles:o}=r;let a;if(n&&!gt(n))for(const c in n){const d=n[c];(d===Number||d&&d.type===Number)&&(c in this._props&&(this._props[c]=$r(this._props[c])),(a||(a=Object.create(null)))[$t(c)]=!0)}this._numberProps=a,s&&this._resolveProps(r),this.shadowRoot&&this._applyStyles(o),this._mount(r)},i=this._def.__asyncLoader;i?this._pendingResolve=i().then(r=>e(this._def=r,!0)):e(this._def)}_mount(e){this._app=this._createApp(e),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const i=this._instance&&this._instance.exposed;if(i)for(const r in i)St(this,r)||Object.defineProperty(this,r,{get:()=>Ps(i[r])})}_resolveProps(e){const{props:i}=e,r=gt(i)?i:Object.keys(i||{});for(const s of Object.keys(this))s[0]!=="_"&&r.includes(s)&&this._setProp(s,this[s]);for(const s of r.map($t))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(n){this._setProp(s,n,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const i=this.hasAttribute(e);let r=i?this.getAttribute(e):Do;const s=$t(e);i&&this._numberProps&&this._numberProps[s]&&(r=$r(r)),this._setProp(s,r,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,i,r=!0,s=!1){i!==this._props[e]&&(i===Do?delete this._props[e]:(this._props[e]=i,e==="key"&&this._app&&(this._app._ceVNode.key=i)),s&&this._instance&&this._update(),r&&(i===!0?this.setAttribute(Yt(e),""):typeof i=="string"||typeof i=="number"?this.setAttribute(Yt(e),i+""):i||this.removeAttribute(Yt(e))))}_update(){zh(this._createVNode(),this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const i=re(this._def,Nt(e,this._props));return this._instance||(i.ce=r=>{this._instance=r,r.ce=this,r.isCE=!0;const s=(n,o)=>{this.dispatchEvent(new CustomEvent(n,rn(o[0])?Nt({detail:o},o[0]):{detail:o}))};r.emit=(n,...o)=>{s(n,o),Yt(n)!==n&&s(Yt(n),o)},this._setParent()}),i}_applyStyles(e,i){if(!e)return;if(i){if(i===this._def||this._styleChildren.has(i))return;this._styleChildren.add(i)}const r=this._nonce;for(let s=e.length-1;s>=0;s--){const n=document.createElement("style");r&&n.setAttribute("nonce",r),n.textContent=e[s],this.shadowRoot.prepend(n)}}_parseSlots(){const e=this._slots={};let i;for(;i=this.firstChild;){const r=i.nodeType===1&&i.getAttribute("slot")||"default";(e[r]||(e[r]=[])).push(i),this.removeChild(i)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),i=this._instance.type.__scopeId;for(let r=0;r<e.length;r++){const s=e[r],n=s.getAttribute("name")||"default",o=this._slots[n],a=s.parentNode;if(o)for(const c of o){if(i&&c.nodeType===1){const d=i+"-s",h=document.createTreeWalker(c,1);c.setAttribute(d,"");let m;for(;m=h.nextNode();)m.setAttribute(d,"")}a.insertBefore(c,s)}else for(;s.firstChild;)a.insertBefore(s.firstChild,s);a.removeChild(s)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}const Lo=t=>{const e=t.props["onUpdate:modelValue"]||!1;return gt(e)?i=>on(e,i):e},Pr=Symbol("_assign"),Uh={deep:!0,created(t,{value:e,modifiers:{number:i}},r){const s=nn(e);Fo(t,"change",()=>{const n=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>i?Xr(Nn(o)):Nn(o));t[Pr](t.multiple?s?new Set(n):n:n[0]),t._assigning=!0,sr(()=>{t._assigning=!1})}),t[Pr]=Lo(r)},mounted(t,{value:e}){Go(t,e)},beforeUpdate(t,e,i){t[Pr]=Lo(i)},updated(t,{value:e}){t._assigning||Go(t,e)}};function Go(t,e){const i=t.multiple,r=gt(e);if(!(i&&!r&&!nn(e))){for(let s=0,n=t.options.length;s<n;s++){const o=t.options[s],a=Nn(o);if(i)if(r){const c=typeof a;c==="string"||c==="number"?o.selected=e.some(d=>String(d)===String(a)):o.selected=xl(e,a)>-1}else o.selected=e.has(a);else if(an(Nn(o),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!i&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Nn(t){return"_value"in t?t._value:t.value}const Bh=["ctrl","shift","alt","meta"],Hh={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Bh.some(i=>t[`${i}Key`]&&!e.includes(i))},xe=(t,e)=>{const i=t._withMods||(t._withMods={}),r=e.join(".");return i[r]||(i[r]=(s,...n)=>{for(let o=0;o<e.length;o++){const a=Hh[e[o]];if(a&&a(s,e))return}return t(s,...n)})},Vh=Nt({patchProp:Oh},vh);let Uo;function Bo(){return Uo||(Uo=Bc(Vh))}const zh=(...t)=>{Bo().render(...t)},Ho=(...t)=>{const e=Bo().createApp(...t),{mount:i}=e;return e.mount=r=>{const s=Wh(r);if(!s)return;const n=e._component;!pt(n)&&!n.render&&!n.template&&(n.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=i(s,!1,qh(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function qh(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Wh(t){return Et(t)?document.querySelector(t):t}var Vo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Kh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Fn={exports:{}},ui={},Rr={},Tr={},zo;function mt(){return zo||(zo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function i(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Vo<"u"?Vo:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.21",isBrowser:i(),isUnminified:/param/.test(function(s){}.toString()),dblClickWindow:400,getAngle(s){return t.Konva.angleDeg?s*e:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var s;return(s=t.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(s){t.glob.Konva=s}};const r=s=>{t.Konva[s.prototype.getClassName()]=s};t._registerNode=r,t.Konva._injectGlobal(t.Konva)}(Tr)),Tr}var Er={},qo;function Tt(){return qo||(qo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=mt();class i{constructor(_=[1,0,0,1,0,0]){this.dirty=!1,this.m=_&&_.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new i(this.m)}copyInto(_){_.m[0]=this.m[0],_.m[1]=this.m[1],_.m[2]=this.m[2],_.m[3]=this.m[3],_.m[4]=this.m[4],_.m[5]=this.m[5]}point(_){const v=this.m;return{x:v[0]*_.x+v[2]*_.y+v[4],y:v[1]*_.x+v[3]*_.y+v[5]}}translate(_,v){return this.m[4]+=this.m[0]*_+this.m[2]*v,this.m[5]+=this.m[1]*_+this.m[3]*v,this}scale(_,v){return this.m[0]*=_,this.m[1]*=_,this.m[2]*=v,this.m[3]*=v,this}rotate(_){const v=Math.cos(_),T=Math.sin(_),I=this.m[0]*v+this.m[2]*T,C=this.m[1]*v+this.m[3]*T,x=this.m[0]*-T+this.m[2]*v,R=this.m[1]*-T+this.m[3]*v;return this.m[0]=I,this.m[1]=C,this.m[2]=x,this.m[3]=R,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(_,v){const T=this.m[0]+this.m[2]*v,I=this.m[1]+this.m[3]*v,C=this.m[2]+this.m[0]*_,x=this.m[3]+this.m[1]*_;return this.m[0]=T,this.m[1]=I,this.m[2]=C,this.m[3]=x,this}multiply(_){const v=this.m[0]*_.m[0]+this.m[2]*_.m[1],T=this.m[1]*_.m[0]+this.m[3]*_.m[1],I=this.m[0]*_.m[2]+this.m[2]*_.m[3],C=this.m[1]*_.m[2]+this.m[3]*_.m[3],x=this.m[0]*_.m[4]+this.m[2]*_.m[5]+this.m[4],R=this.m[1]*_.m[4]+this.m[3]*_.m[5]+this.m[5];return this.m[0]=v,this.m[1]=T,this.m[2]=I,this.m[3]=C,this.m[4]=x,this.m[5]=R,this}invert(){const _=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),v=this.m[3]*_,T=-this.m[1]*_,I=-this.m[2]*_,C=this.m[0]*_,x=_*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),R=_*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=v,this.m[1]=T,this.m[2]=I,this.m[3]=C,this.m[4]=x,this.m[5]=R,this}getMatrix(){return this.m}decompose(){const _=this.m[0],v=this.m[1],T=this.m[2],I=this.m[3],C=this.m[4],x=this.m[5],R=_*I-v*T,F={x:C,y:x,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(_!=0||v!=0){const D=Math.sqrt(_*_+v*v);F.rotation=v>0?Math.acos(_/D):-Math.acos(_/D),F.scaleX=D,F.scaleY=R/D,F.skewX=(_*T+v*I)/R,F.skewY=0}else if(T!=0||I!=0){const D=Math.sqrt(T*T+I*I);F.rotation=Math.PI/2-(I>0?Math.acos(-T/D):-Math.acos(T/D)),F.scaleX=R/D,F.scaleY=D,F.skewX=0,F.skewY=(_*T+v*I)/R}return F.rotation=t.Util._getRotation(F.rotation),F}}t.Transform=i;const r="[object Array]",s="[object Number]",n="[object String]",o="[object Boolean]",a=Math.PI/180,c=180/Math.PI,d="#",h="",m="0",p="Konva warning: ",u="Konva error: ",f="rgb(",y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let w=[];const g=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(l){setTimeout(l,60)};t.Util={_isElement(l){return!!(l&&l.nodeType==1)},_isFunction(l){return!!(l&&l.constructor&&l.call&&l.apply)},_isPlainObject(l){return!!l&&l.constructor===Object},_isArray(l){return Object.prototype.toString.call(l)===r},_isNumber(l){return Object.prototype.toString.call(l)===s&&!isNaN(l)&&isFinite(l)},_isString(l){return Object.prototype.toString.call(l)===n},_isBoolean(l){return Object.prototype.toString.call(l)===o},isObject(l){return l instanceof Object},isValidSelector(l){if(typeof l!="string")return!1;const _=l[0];return _==="#"||_==="."||_===_.toUpperCase()},_sign(l){return l===0||l>0?1:-1},requestAnimFrame(l){w.push(l),w.length===1&&g(function(){const _=w;w=[],_.forEach(function(v){v()})})},createCanvasElement(){const l=document.createElement("canvas");try{l.style=l.style||{}}catch{}return l},createImageElement(){return document.createElement("img")},_isInDocument(l){for(;l=l.parentNode;)if(l==document)return!0;return!1},_urlToImage(l,_){const v=t.Util.createImageElement();v.onload=function(){_(v)},v.src=l},_rgbToHex(l,_,v){return(16777216+(l<<16)+(_<<8)+v).toString(16).slice(1)},_hexToRgb(l){l=l.replace(d,h);const _=parseInt(l,16);return{r:_>>16&255,g:_>>8&255,b:_&255}},getRandomColor(){let l=(Math.random()*16777215<<0).toString(16);for(;l.length<6;)l=m+l;return d+l},getRGB(l){let _;return l in y?(_=y[l],{r:_[0],g:_[1],b:_[2]}):l[0]===d?this._hexToRgb(l.substring(1)):l.substr(0,4)===f?(_=S.exec(l.replace(/ /g,"")),{r:parseInt(_[1],10),g:parseInt(_[2],10),b:parseInt(_[3],10)}):{r:0,g:0,b:0}},colorToRGBA(l){return l=l||"black",t.Util._namedColorToRBA(l)||t.Util._hex3ColorToRGBA(l)||t.Util._hex4ColorToRGBA(l)||t.Util._hex6ColorToRGBA(l)||t.Util._hex8ColorToRGBA(l)||t.Util._rgbColorToRGBA(l)||t.Util._rgbaColorToRGBA(l)||t.Util._hslColorToRGBA(l)},_namedColorToRBA(l){const _=y[l.toLowerCase()];return _?{r:_[0],g:_[1],b:_[2],a:1}:null},_rgbColorToRGBA(l){if(l.indexOf("rgb(")===0){l=l.match(/rgb\(([^)]+)\)/)[1];const _=l.split(/ *, */).map(Number);return{r:_[0],g:_[1],b:_[2],a:1}}},_rgbaColorToRGBA(l){if(l.indexOf("rgba(")===0){l=l.match(/rgba\(([^)]+)\)/)[1];const _=l.split(/ *, */).map((v,T)=>v.slice(-1)==="%"?T===3?parseInt(v)/100:parseInt(v)/100*255:Number(v));return{r:_[0],g:_[1],b:_[2],a:_[3]}}},_hex8ColorToRGBA(l){if(l[0]==="#"&&l.length===9)return{r:parseInt(l.slice(1,3),16),g:parseInt(l.slice(3,5),16),b:parseInt(l.slice(5,7),16),a:parseInt(l.slice(7,9),16)/255}},_hex6ColorToRGBA(l){if(l[0]==="#"&&l.length===7)return{r:parseInt(l.slice(1,3),16),g:parseInt(l.slice(3,5),16),b:parseInt(l.slice(5,7),16),a:1}},_hex4ColorToRGBA(l){if(l[0]==="#"&&l.length===5)return{r:parseInt(l[1]+l[1],16),g:parseInt(l[2]+l[2],16),b:parseInt(l[3]+l[3],16),a:parseInt(l[4]+l[4],16)/255}},_hex3ColorToRGBA(l){if(l[0]==="#"&&l.length===4)return{r:parseInt(l[1]+l[1],16),g:parseInt(l[2]+l[2],16),b:parseInt(l[3]+l[3],16),a:1}},_hslColorToRGBA(l){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(l)){const[_,...v]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(l),T=Number(v[0])/360,I=Number(v[1])/100,C=Number(v[2])/100;let x,R,F;if(I===0)return F=C*255,{r:Math.round(F),g:Math.round(F),b:Math.round(F),a:1};C<.5?x=C*(1+I):x=C+I-C*I;const D=2*C-x,B=[0,0,0];for(let V=0;V<3;V++)R=T+.3333333333333333*-(V-1),R<0&&R++,R>1&&R--,6*R<1?F=D+(x-D)*6*R:2*R<1?F=x:3*R<2?F=D+(x-D)*(.6666666666666666-R)*6:F=D,B[V]=F*255;return{r:Math.round(B[0]),g:Math.round(B[1]),b:Math.round(B[2]),a:1}}},haveIntersection(l,_){return!(_.x>l.x+l.width||_.x+_.width<l.x||_.y>l.y+l.height||_.y+_.height<l.y)},cloneObject(l){const _={};for(const v in l)this._isPlainObject(l[v])?_[v]=this.cloneObject(l[v]):this._isArray(l[v])?_[v]=this.cloneArray(l[v]):_[v]=l[v];return _},cloneArray(l){return l.slice(0)},degToRad(l){return l*a},radToDeg(l){return l*c},_degToRad(l){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(l)},_radToDeg(l){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(l)},_getRotation(l){return e.Konva.angleDeg?t.Util.radToDeg(l):l},_capitalize(l){return l.charAt(0).toUpperCase()+l.slice(1)},throw(l){throw new Error(u+l)},error(l){console.error(u+l)},warn(l){e.Konva.showWarnings&&console.warn(p+l)},each(l,_){for(const v in l)_(v,l[v])},_inRange(l,_,v){return _<=l&&l<v},_getProjectionToSegment(l,_,v,T,I,C){let x,R,F;const D=(l-v)*(l-v)+(_-T)*(_-T);if(D==0)x=l,R=_,F=(I-v)*(I-v)+(C-T)*(C-T);else{const B=((I-l)*(v-l)+(C-_)*(T-_))/D;B<0?(x=l,R=_,F=(l-I)*(l-I)+(_-C)*(_-C)):B>1?(x=v,R=T,F=(v-I)*(v-I)+(T-C)*(T-C)):(x=l+B*(v-l),R=_+B*(T-_),F=(x-I)*(x-I)+(R-C)*(R-C))}return[x,R,F]},_getProjectionToLine(l,_,v){const T=t.Util.cloneObject(l);let I=Number.MAX_VALUE;return _.forEach(function(C,x){if(!v&&x===_.length-1)return;const R=_[(x+1)%_.length],F=t.Util._getProjectionToSegment(C.x,C.y,R.x,R.y,l.x,l.y),D=F[0],B=F[1],V=F[2];V<I&&(T.x=D,T.y=B,I=V)}),T},_prepareArrayForTween(l,_,v){const T=[],I=[];if(l.length>_.length){const x=_;_=l,l=x}for(let x=0;x<l.length;x+=2)T.push({x:l[x],y:l[x+1]});for(let x=0;x<_.length;x+=2)I.push({x:_[x],y:_[x+1]});const C=[];return I.forEach(function(x){const R=t.Util._getProjectionToLine(x,T,v);C.push(R.x),C.push(R.y)}),C},_prepareToStringify(l){let _;l.visitedByCircularReferenceRemoval=!0;for(const v in l)if(l.hasOwnProperty(v)&&l[v]&&typeof l[v]=="object"){if(_=Object.getOwnPropertyDescriptor(l,v),l[v].visitedByCircularReferenceRemoval||t.Util._isElement(l[v]))if(_.configurable)delete l[v];else return null;else if(t.Util._prepareToStringify(l[v])===null)if(_.configurable)delete l[v];else return null}return delete l.visitedByCircularReferenceRemoval,l},_assign(l,_){for(const v in _)l[v]=_[v];return l},_getFirstPointerId(l){return l.touches?l.changedTouches[0].identifier:l.pointerId||999},releaseCanvas(...l){e.Konva.releaseCanvasOnDestroy&&l.forEach(_=>{_.width=0,_.height=0})},drawRoundedRectPath(l,_,v,T){let I=0,C=0,x=0,R=0;typeof T=="number"?I=C=x=R=Math.min(T,_/2,v/2):(I=Math.min(T[0]||0,_/2,v/2),C=Math.min(T[1]||0,_/2,v/2),R=Math.min(T[2]||0,_/2,v/2),x=Math.min(T[3]||0,_/2,v/2)),l.moveTo(I,0),l.lineTo(_-C,0),l.arc(_-C,C,C,Math.PI*3/2,0,!1),l.lineTo(_,v-R),l.arc(_-R,v-R,R,0,Math.PI/2,!1),l.lineTo(x,v),l.arc(x,v-x,x,Math.PI/2,Math.PI,!1),l.lineTo(0,I),l.arc(I,I,I,Math.PI,Math.PI*3/2,!1)}}}(Er)),Er}var fi={},me={},_e={},Wo;function Ko(){if(Wo)return _e;Wo=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.HitContext=_e.SceneContext=_e.Context=void 0;const t=Tt(),e=mt();function i(w){const g=[],l=w.length,_=t.Util;for(let v=0;v<l;v++){let T=w[v];_._isNumber(T)?T=Math.round(T*1e3)/1e3:_._isString(T)||(T=T+""),g.push(T)}return g}const r=",",s="(",n=")",o="([",a="])",c=";",d="()",h="=",m=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],p=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],u=100;let f=class{constructor(g){this.canvas=g,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(g){g.fillEnabled()&&this._fill(g)}_fill(g){}strokeShape(g){g.hasStroke()&&this._stroke(g)}_stroke(g){}fillStrokeShape(g){g.attrs.fillAfterStrokeEnabled?(this.strokeShape(g),this.fillShape(g)):(this.fillShape(g),this.strokeShape(g))}getTrace(g,l){let _=this.traceArr,v=_.length,T="",I,C,x,R;for(I=0;I<v;I++)C=_[I],x=C.method,x?(R=C.args,T+=x,g?T+=d:t.Util._isArray(R[0])?T+=o+R.join(r)+a:(l&&(R=R.map(F=>typeof F=="number"?Math.floor(F):F)),T+=s+R.join(r)+n)):(T+=C.property,g||(T+=h+C.val)),T+=c;return T}clearTrace(){this.traceArr=[]}_trace(g){let l=this.traceArr,_;l.push(g),_=l.length,_>=u&&l.shift()}reset(){const g=this.getCanvas().getPixelRatio();this.setTransform(1*g,0,0,1*g,0,0)}getCanvas(){return this.canvas}clear(g){const l=this.getCanvas();g?this.clearRect(g.x||0,g.y||0,g.width||0,g.height||0):this.clearRect(0,0,l.getWidth()/l.pixelRatio,l.getHeight()/l.pixelRatio)}_applyLineCap(g){const l=g.attrs.lineCap;l&&this.setAttr("lineCap",l)}_applyOpacity(g){const l=g.getAbsoluteOpacity();l!==1&&this.setAttr("globalAlpha",l)}_applyLineJoin(g){const l=g.attrs.lineJoin;l&&this.setAttr("lineJoin",l)}setAttr(g,l){this._context[g]=l}arc(g,l,_,v,T,I){this._context.arc(g,l,_,v,T,I)}arcTo(g,l,_,v,T){this._context.arcTo(g,l,_,v,T)}beginPath(){this._context.beginPath()}bezierCurveTo(g,l,_,v,T,I){this._context.bezierCurveTo(g,l,_,v,T,I)}clearRect(g,l,_,v){this._context.clearRect(g,l,_,v)}clip(...g){this._context.clip.apply(this._context,g)}closePath(){this._context.closePath()}createImageData(g,l){const _=arguments;if(_.length===2)return this._context.createImageData(g,l);if(_.length===1)return this._context.createImageData(g)}createLinearGradient(g,l,_,v){return this._context.createLinearGradient(g,l,_,v)}createPattern(g,l){return this._context.createPattern(g,l)}createRadialGradient(g,l,_,v,T,I){return this._context.createRadialGradient(g,l,_,v,T,I)}drawImage(g,l,_,v,T,I,C,x,R){const F=arguments,D=this._context;F.length===3?D.drawImage(g,l,_):F.length===5?D.drawImage(g,l,_,v,T):F.length===9&&D.drawImage(g,l,_,v,T,I,C,x,R)}ellipse(g,l,_,v,T,I,C,x){this._context.ellipse(g,l,_,v,T,I,C,x)}isPointInPath(g,l,_,v){return _?this._context.isPointInPath(_,g,l,v):this._context.isPointInPath(g,l,v)}fill(...g){this._context.fill.apply(this._context,g)}fillRect(g,l,_,v){this._context.fillRect(g,l,_,v)}strokeRect(g,l,_,v){this._context.strokeRect(g,l,_,v)}fillText(g,l,_,v){v?this._context.fillText(g,l,_,v):this._context.fillText(g,l,_)}measureText(g){return this._context.measureText(g)}getImageData(g,l,_,v){return this._context.getImageData(g,l,_,v)}lineTo(g,l){this._context.lineTo(g,l)}moveTo(g,l){this._context.moveTo(g,l)}rect(g,l,_,v){this._context.rect(g,l,_,v)}roundRect(g,l,_,v,T){this._context.roundRect(g,l,_,v,T)}putImageData(g,l,_){this._context.putImageData(g,l,_)}quadraticCurveTo(g,l,_,v){this._context.quadraticCurveTo(g,l,_,v)}restore(){this._context.restore()}rotate(g){this._context.rotate(g)}save(){this._context.save()}scale(g,l){this._context.scale(g,l)}setLineDash(g){this._context.setLineDash?this._context.setLineDash(g):"mozDash"in this._context?this._context.mozDash=g:"webkitLineDash"in this._context&&(this._context.webkitLineDash=g)}getLineDash(){return this._context.getLineDash()}setTransform(g,l,_,v,T,I){this._context.setTransform(g,l,_,v,T,I)}stroke(g){g?this._context.stroke(g):this._context.stroke()}strokeText(g,l,_,v){this._context.strokeText(g,l,_,v)}transform(g,l,_,v,T,I){this._context.transform(g,l,_,v,T,I)}translate(g,l){this._context.translate(g,l)}_enableTrace(){let g=this,l=m.length,_=this.setAttr,v,T;const I=function(C){let x=g[C],R;g[C]=function(){return T=i(Array.prototype.slice.call(arguments,0)),R=x.apply(g,arguments),g._trace({method:C,args:T}),R}};for(v=0;v<l;v++)I(m[v]);g.setAttr=function(){_.apply(g,arguments);const C=arguments[0];let x=arguments[1];(C==="shadowOffsetX"||C==="shadowOffsetY"||C==="shadowBlur")&&(x=x/this.canvas.getPixelRatio()),g._trace({property:C,val:x})}}_applyGlobalCompositeOperation(g){const l=g.attrs.globalCompositeOperation;!l||l==="source-over"||this.setAttr("globalCompositeOperation",l)}};_e.Context=f,p.forEach(function(w){Object.defineProperty(f.prototype,w,{get(){return this._context[w]},set(g){this._context[w]=g}})});class y extends f{constructor(g,{willReadFrequently:l=!1}={}){super(g),this._context=g._canvas.getContext("2d",{willReadFrequently:l})}_fillColor(g){const l=g.fill();this.setAttr("fillStyle",l),g._fillFunc(this)}_fillPattern(g){this.setAttr("fillStyle",g._getFillPattern()),g._fillFunc(this)}_fillLinearGradient(g){const l=g._getLinearGradient();l&&(this.setAttr("fillStyle",l),g._fillFunc(this))}_fillRadialGradient(g){const l=g._getRadialGradient();l&&(this.setAttr("fillStyle",l),g._fillFunc(this))}_fill(g){const l=g.fill(),_=g.getFillPriority();if(l&&_==="color"){this._fillColor(g);return}const v=g.getFillPatternImage();if(v&&_==="pattern"){this._fillPattern(g);return}const T=g.getFillLinearGradientColorStops();if(T&&_==="linear-gradient"){this._fillLinearGradient(g);return}const I=g.getFillRadialGradientColorStops();if(I&&_==="radial-gradient"){this._fillRadialGradient(g);return}l?this._fillColor(g):v?this._fillPattern(g):T?this._fillLinearGradient(g):I&&this._fillRadialGradient(g)}_strokeLinearGradient(g){const l=g.getStrokeLinearGradientStartPoint(),_=g.getStrokeLinearGradientEndPoint(),v=g.getStrokeLinearGradientColorStops(),T=this.createLinearGradient(l.x,l.y,_.x,_.y);if(v){for(let I=0;I<v.length;I+=2)T.addColorStop(v[I],v[I+1]);this.setAttr("strokeStyle",T)}}_stroke(g){const l=g.dash(),_=g.getStrokeScaleEnabled();if(g.hasStroke()){if(!_){this.save();const T=this.getCanvas().getPixelRatio();this.setTransform(T,0,0,T,0,0)}this._applyLineCap(g),l&&g.dashEnabled()&&(this.setLineDash(l),this.setAttr("lineDashOffset",g.dashOffset())),this.setAttr("lineWidth",g.strokeWidth()),g.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),g.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(g):this.setAttr("strokeStyle",g.stroke()),g._strokeFunc(this),_||this.restore()}}_applyShadow(g){var l,_,v;const T=(l=g.getShadowRGBA())!==null&&l!==void 0?l:"black",I=(_=g.getShadowBlur())!==null&&_!==void 0?_:5,C=(v=g.getShadowOffset())!==null&&v!==void 0?v:{x:0,y:0},x=g.getAbsoluteScale(),R=this.canvas.getPixelRatio(),F=x.x*R,D=x.y*R;this.setAttr("shadowColor",T),this.setAttr("shadowBlur",I*Math.min(Math.abs(F),Math.abs(D))),this.setAttr("shadowOffsetX",C.x*F),this.setAttr("shadowOffsetY",C.y*D)}}_e.SceneContext=y;class S extends f{constructor(g){super(g),this._context=g._canvas.getContext("2d",{willReadFrequently:!0})}_fill(g){this.save(),this.setAttr("fillStyle",g.colorKey),g._fillFuncHit(this),this.restore()}strokeShape(g){g.hasHitStroke()&&this._stroke(g)}_stroke(g){if(g.hasHitStroke()){const l=g.getStrokeScaleEnabled();if(!l){this.save();const T=this.getCanvas().getPixelRatio();this.setTransform(T,0,0,T,0,0)}this._applyLineCap(g);const _=g.hitStrokeWidth(),v=_==="auto"?g.strokeWidth():_;this.setAttr("lineWidth",v),this.setAttr("strokeStyle",g.colorKey),g._strokeFuncHit(this),l||this.restore()}}}return _e.HitContext=S,_e}var jo;function kn(){if(jo)return me;jo=1,Object.defineProperty(me,"__esModule",{value:!0}),me.HitCanvas=me.SceneCanvas=me.Canvas=void 0;const t=Tt(),e=Ko(),i=mt();let r;function s(){if(r)return r;const c=t.Util.createCanvasElement(),d=c.getContext("2d");return r=function(){const h=i.Konva._global.devicePixelRatio||1,m=d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1;return h/m}(),t.Util.releaseCanvas(c),r}let n=class{constructor(d){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const m=(d||{}).pixelRatio||i.Konva.pixelRatio||s();this.pixelRatio=m,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(d){const h=this.pixelRatio;this.pixelRatio=d,this.setSize(this.getWidth()/h,this.getHeight()/h)}setWidth(d){this.width=this._canvas.width=d*this.pixelRatio,this._canvas.style.width=d+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}setHeight(d){this.height=this._canvas.height=d*this.pixelRatio,this._canvas.style.height=d+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}getWidth(){return this.width}getHeight(){return this.height}setSize(d,h){this.setWidth(d||0),this.setHeight(h||0)}toDataURL(d,h){try{return this._canvas.toDataURL(d,h)}catch{try{return this._canvas.toDataURL()}catch(p){return t.Util.error("Unable to get data URL. "+p.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};me.Canvas=n;class o extends n{constructor(d={width:0,height:0,willReadFrequently:!1}){super(d),this.context=new e.SceneContext(this,{willReadFrequently:d.willReadFrequently}),this.setSize(d.width,d.height)}}me.SceneCanvas=o;class a extends n{constructor(d={width:0,height:0}){super(d),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(d.width,d.height)}}return me.HitCanvas=a,me}var Ar={},Yo;function Mr(){return Yo||(Yo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=mt(),i=Tt();t.DD={get isDragging(){let r=!1;return t.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return t.DD._dragElements.forEach(s=>{r=s.node}),r},_dragElements:new Map,_drag(r){const s=[];t.DD._dragElements.forEach((n,o)=>{const{node:a}=n,c=a.getStage();c.setPointersPositions(r),n.pointerId===void 0&&(n.pointerId=i.Util._getFirstPointerId(r));const d=c._changedPointerPositions.find(h=>h.id===n.pointerId);if(d){if(n.dragStatus!=="dragging"){const h=a.dragDistance();if(Math.max(Math.abs(d.x-n.startPointerPos.x),Math.abs(d.y-n.startPointerPos.y))<h||(a.startDrag({evt:r}),!a.isDragging()))return}a._setDragPosition(r,n),s.push(a)}}),s.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:r},!0)})},_endDragBefore(r){const s=[];t.DD._dragElements.forEach(n=>{const{node:o}=n,a=o.getStage();if(r&&a.setPointersPositions(r),!a._changedPointerPositions.find(h=>h.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,n.dragStatus="stopped");const d=n.node.getLayer()||n.node instanceof e.Konva.Stage&&n.node;d&&s.indexOf(d)===-1&&s.push(d)}),s.forEach(n=>{n.draw()})},_endDragAfter(r){t.DD._dragElements.forEach((s,n)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:r},!0),s.dragStatus!=="dragging"&&t.DD._dragElements.delete(n)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))}(Ar)),Ar}var Nr={},Vt={},Xo;function bt(){if(Xo)return Vt;Xo=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.RGBComponent=r,Vt.alphaComponent=s,Vt.getNumberValidator=n,Vt.getNumberOrArrayOfNumbersValidator=o,Vt.getNumberOrAutoValidator=a,Vt.getStringValidator=c,Vt.getStringOrGradientValidator=d,Vt.getFunctionValidator=h,Vt.getNumberArrayValidator=m,Vt.getBooleanValidator=p,Vt.getComponentValidator=u;const t=mt(),e=Tt();function i(f){return e.Util._isString(f)?'"'+f+'"':Object.prototype.toString.call(f)==="[object Number]"||e.Util._isBoolean(f)?f:Object.prototype.toString.call(f)}function r(f){return f>255?255:f<0?0:Math.round(f)}function s(f){return f>1?1:f<1e-4?1e-4:f}function n(){if(t.Konva.isUnminified)return function(f,y){return e.Util._isNumber(f)||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a number.'),f}}function o(f){if(t.Konva.isUnminified)return function(y,S){let w=e.Util._isNumber(y),g=e.Util._isArray(y)&&y.length==f;return!w&&!g&&e.Util.warn(i(y)+' is a not valid value for "'+S+'" attribute. The value should be a number or Array<number>('+f+")"),y}}function a(){if(t.Konva.isUnminified)return function(f,y){return e.Util._isNumber(f)||f==="auto"||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a number or "auto".'),f}}function c(){if(t.Konva.isUnminified)return function(f,y){return e.Util._isString(f)||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a string.'),f}}function d(){if(t.Konva.isUnminified)return function(f,y){const S=e.Util._isString(f),w=Object.prototype.toString.call(f)==="[object CanvasGradient]"||f&&f.addColorStop;return S||w||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a string or a native gradient.'),f}}function h(){if(t.Konva.isUnminified)return function(f,y){return e.Util._isFunction(f)||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a function.'),f}}function m(){if(t.Konva.isUnminified)return function(f,y){const S=Int8Array?Object.getPrototypeOf(Int8Array):null;return S&&f instanceof S||(e.Util._isArray(f)?f.forEach(function(w){e.Util._isNumber(w)||e.Util.warn('"'+y+'" attribute has non numeric element '+w+". Make sure that all elements are numbers.")}):e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a array of numbers.')),f}}function p(){if(t.Konva.isUnminified)return function(f,y){return f===!0||f===!1||e.Util.warn(i(f)+' is a not valid value for "'+y+'" attribute. The value should be a boolean.'),f}}function u(f){if(t.Konva.isUnminified)return function(y,S){return y==null||e.Util.isObject(y)||e.Util.warn(i(y)+' is a not valid value for "'+S+'" attribute. The value should be an object with properties '+f),y}}return Vt}var $o;function yt(){return $o||($o=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Tt(),i=bt(),r="get",s="set";t.Factory={addGetterSetter(n,o,a,c,d){t.Factory.addGetter(n,o,a),t.Factory.addSetter(n,o,c,d),t.Factory.addOverloadedGetterSetter(n,o)},addGetter(n,o,a){const c=r+e.Util._capitalize(o);n.prototype[c]=n.prototype[c]||function(){const d=this.attrs[o];return d===void 0?a:d}},addSetter(n,o,a,c){const d=s+e.Util._capitalize(o);n.prototype[d]||t.Factory.overWriteSetter(n,o,a,c)},overWriteSetter(n,o,a,c){const d=s+e.Util._capitalize(o);n.prototype[d]=function(h){return a&&h!==void 0&&h!==null&&(h=a.call(this,h,o)),this._setAttr(o,h),c&&c.call(this),this}},addComponentsGetterSetter(n,o,a,c,d){const h=a.length,m=e.Util._capitalize,p=r+m(o),u=s+m(o);n.prototype[p]=function(){const y={};for(let S=0;S<h;S++){const w=a[S];y[w]=this.getAttr(o+m(w))}return y};const f=(0,i.getComponentValidator)(a);n.prototype[u]=function(y){const S=this.attrs[o];c&&(y=c.call(this,y,o)),f&&f.call(this,y,o);for(const w in y)y.hasOwnProperty(w)&&this._setAttr(o+m(w),y[w]);return y||a.forEach(w=>{this._setAttr(o+m(w),void 0)}),this._fireChangeEvent(o,S,y),d&&d.call(this),this},t.Factory.addOverloadedGetterSetter(n,o)},addOverloadedGetterSetter(n,o){const a=e.Util._capitalize(o),c=s+a,d=r+a;n.prototype[o]=function(){return arguments.length?(this[c](arguments[0]),this):this[d]()}},addDeprecatedGetterSetter(n,o,a,c){e.Util.error("Adding deprecated "+o);const d=r+e.Util._capitalize(o),h=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";n.prototype[d]=function(){e.Util.error(h);const m=this.attrs[o];return m===void 0?a:m},t.Factory.addSetter(n,o,c,function(){e.Util.error(h)}),t.Factory.addOverloadedGetterSetter(n,o)},backCompat(n,o){e.Util.each(o,function(a,c){const d=n.prototype[c],h=r+e.Util._capitalize(a),m=s+e.Util._capitalize(a);function p(){d.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}n.prototype[a]=p,n.prototype[h]=p,n.prototype[m]=p})},afterSetFilter(){this._filterUpToDate=!1}}}(Nr)),Nr}var Qo;function At(){if(Qo)return fi;Qo=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.Node=void 0;const t=kn(),e=Mr(),i=yt(),r=mt(),s=Tt(),n=bt(),o="absoluteOpacity",a="allEventListeners",c="absoluteTransform",d="absoluteScale",h="canvas",m="Change",p="children",u="konva",f="listening",y="mouseenter",S="mouseleave",w="pointerenter",g="pointerleave",l="touchenter",_="touchleave",v="set",T="Shape",I=" ",C="stage",x="transform",R="Stage",F="visible",D=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(I);let B=1,V=class zr{constructor(b){this._id=B++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(b),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(b){(b===x||b===c)&&this._cache.get(b)?this._cache.get(b).dirty=!0:b?this._cache.delete(b):this._cache.clear()}_getCache(b,P){let N=this._cache.get(b);return(N===void 0||(b===x||b===c)&&N.dirty===!0)&&(N=P.call(this),this._cache.set(b,N)),N}_calculate(b,P,N){if(!this._attachedDepsListeners.get(b)){const A=P.map(O=>O+"Change.konva").join(I);this.on(A,()=>{this._clearCache(b)}),this._attachedDepsListeners.set(b,!0)}return this._getCache(b,N)}_getCanvasCache(){return this._cache.get(h)}_clearSelfAndDescendantCache(b){this._clearCache(b),b===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(h)){const{scene:b,filter:P,hit:N,buffer:A}=this._cache.get(h);s.Util.releaseCanvas(b,P,N,A),this._cache.delete(h)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(b){const P=b||{};let N={};(P.x===void 0||P.y===void 0||P.width===void 0||P.height===void 0)&&(N=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let A=Math.ceil(P.width||N.width),O=Math.ceil(P.height||N.height),j=P.pixelRatio,G=P.x===void 0?Math.floor(N.x):P.x,J=P.y===void 0?Math.floor(N.y):P.y,ot=P.offset||0,W=P.drawBorder||!1,M=P.hitCanvasPixelRatio||1;if(!A||!O){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const q=Math.abs(Math.round(N.x)-G)>.5?1:0,nt=Math.abs(Math.round(N.y)-J)>.5?1:0;A+=ot*2+q,O+=ot*2+nt,G-=ot,J-=ot;const lt=new t.SceneCanvas({pixelRatio:j,width:A,height:O}),dt=new t.SceneCanvas({pixelRatio:j,width:0,height:0,willReadFrequently:!0}),E=new t.HitCanvas({pixelRatio:M,width:A,height:O}),k=lt.getContext(),z=E.getContext(),Y=new t.SceneCanvas({width:lt.width/lt.pixelRatio+Math.abs(G),height:lt.height/lt.pixelRatio+Math.abs(J),pixelRatio:lt.pixelRatio}),$=Y.getContext();return E.isCache=!0,lt.isCache=!0,this._cache.delete(h),this._filterUpToDate=!1,P.imageSmoothingEnabled===!1&&(lt.getContext()._context.imageSmoothingEnabled=!1,dt.getContext()._context.imageSmoothingEnabled=!1),k.save(),z.save(),$.save(),k.translate(-G,-J),z.translate(-G,-J),$.translate(-G,-J),Y.x=G,Y.y=J,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(d),this.drawScene(lt,this,Y),this.drawHit(E,this),this._isUnderCache=!1,k.restore(),z.restore(),W&&(k.save(),k.beginPath(),k.rect(0,0,A,O),k.closePath(),k.setAttr("strokeStyle","red"),k.setAttr("lineWidth",5),k.stroke(),k.restore()),this._cache.set(h,{scene:lt,filter:dt,hit:E,buffer:Y,x:G,y:J}),this._requestDraw(),this}isCached(){return this._cache.has(h)}getClientRect(b){throw new Error('abstract "getClientRect" method call')}_transformedRect(b,P){const N=[{x:b.x,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x+b.width,y:b.y+b.height},{x:b.x,y:b.y+b.height}];let A=1/0,O=1/0,j=-1/0,G=-1/0;const J=this.getAbsoluteTransform(P);return N.forEach(function(ot){const W=J.point(ot);A===void 0&&(A=j=W.x,O=G=W.y),A=Math.min(A,W.x),O=Math.min(O,W.y),j=Math.max(j,W.x),G=Math.max(G,W.y)}),{x:A,y:O,width:j-A,height:G-O}}_drawCachedSceneCanvas(b){b.save(),b._applyOpacity(this),b._applyGlobalCompositeOperation(this);const P=this._getCanvasCache();b.translate(P.x,P.y);const N=this._getCachedSceneCanvas(),A=N.pixelRatio;b.drawImage(N._canvas,0,0,N.width/A,N.height/A),b.restore()}_drawCachedHitCanvas(b){const P=this._getCanvasCache(),N=P.hit;b.save(),b.translate(P.x,P.y),b.drawImage(N._canvas,0,0,N.width/N.pixelRatio,N.height/N.pixelRatio),b.restore()}_getCachedSceneCanvas(){let b=this.filters(),P=this._getCanvasCache(),N=P.scene,A=P.filter,O=A.getContext(),j,G,J,ot;if(b){if(!this._filterUpToDate){const W=N.pixelRatio;A.setSize(N.width/N.pixelRatio,N.height/N.pixelRatio);try{for(j=b.length,O.clear(),O.drawImage(N._canvas,0,0,N.getWidth()/W,N.getHeight()/W),G=O.getImageData(0,0,A.getWidth(),A.getHeight()),J=0;J<j;J++){if(ot=b[J],typeof ot!="function"){s.Util.error("Filter should be type of function, but got "+typeof ot+" instead. Please check correct filters");continue}ot.call(this,G),O.putImageData(G,0,0)}}catch(M){s.Util.error("Unable to apply filter. "+M.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return A}return N}on(b,P){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const N=b.split(I);for(let A=0;A<N.length;A++){const j=N[A].split("."),G=j[0],J=j[1]||"";this.eventListeners[G]||(this.eventListeners[G]=[]),this.eventListeners[G].push({name:J,handler:P})}return this}off(b,P){let N=(b||"").split(I),A=N.length,O,j,G,J,ot,W;if(this._cache&&this._cache.delete(a),!b)for(j in this.eventListeners)this._off(j);for(O=0;O<A;O++)if(G=N[O],J=G.split("."),ot=J[0],W=J[1],ot)this.eventListeners[ot]&&this._off(ot,W,P);else for(j in this.eventListeners)this._off(j,W,P);return this}dispatchEvent(b){const P={target:this,type:b.type,evt:b};return this.fire(b.type,P),this}addEventListener(b,P){return this.on(b,function(N){P.call(this,N.evt)}),this}removeEventListener(b){return this.off(b),this}_delegate(b,P,N){const A=this;this.on(b,function(O){const j=O.target.findAncestors(P,!0,A);for(let G=0;G<j.length;G++)O=s.Util.cloneObject(O),O.currentTarget=j[G],N.call(j[G],O)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(d),this._clearSelfAndDescendantCache(C),this._clearSelfAndDescendantCache(F),this._clearSelfAndDescendantCache(f)}_remove(){this._clearCaches();const b=this.getParent();b&&b.children&&(b.children.splice(this.index,1),b._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(b){const P="get"+s.Util._capitalize(b);return s.Util._isFunction(this[P])?this[P]():this.attrs[b]}getAncestors(){let b=this.getParent(),P=[];for(;b;)P.push(b),b=b.getParent();return P}getAttrs(){return this.attrs||{}}setAttrs(b){return this._batchTransformChanges(()=>{let P,N;if(!b)return this;for(P in b)P!==p&&(N=v+s.Util._capitalize(P),s.Util._isFunction(this[N])?this[N](b[P]):this._setAttr(P,b[P]))}),this}isListening(){return this._getCache(f,this._isListening)}_isListening(b){if(!this.listening())return!1;const N=this.getParent();return N&&N!==b&&this!==b?N._isListening(b):!0}isVisible(){return this._getCache(F,this._isVisible)}_isVisible(b){if(!this.visible())return!1;const N=this.getParent();return N&&N!==b&&this!==b?N._isVisible(b):!0}shouldDrawHit(b,P=!1){if(b)return this._isVisible(b)&&this._isListening(b);const N=this.getLayer();let A=!1;e.DD._dragElements.forEach(j=>{j.dragStatus==="dragging"&&(j.node.nodeType==="Stage"||j.node.getLayer()===N)&&(A=!0)});const O=!P&&!r.Konva.hitOnDragEnabled&&(A||r.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!O}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let b=this.getDepth(),P=this,N=0,A,O,j,G;function J(W){for(A=[],O=W.length,j=0;j<O;j++)G=W[j],N++,G.nodeType!==T&&(A=A.concat(G.getChildren().slice())),G._id===P._id&&(j=O);A.length>0&&A[0].getDepth()<=b&&J(A)}const ot=this.getStage();return P.nodeType!==R&&ot&&J(ot.getChildren()),N}getDepth(){let b=0,P=this.parent;for(;P;)b++,P=P.parent;return b}_batchTransformChanges(b){this._batchingTransformChange=!0,b(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(x),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(b){return this._batchTransformChanges(()=>{this.x(b.x),this.y(b.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const b=this.getStage();if(!b)return null;const P=b.getPointerPosition();if(!P)return null;const N=this.getAbsoluteTransform().copy();return N.invert(),N.point(P)}getAbsolutePosition(b){let P=!1,N=this.parent;for(;N;){if(N.isCached()){P=!0;break}N=N.parent}P&&!b&&(b=!0);const A=this.getAbsoluteTransform(b).getMatrix(),O=new s.Transform,j=this.offset();return O.m=A.slice(),O.translate(j.x,j.y),O.getTranslation()}setAbsolutePosition(b){const{x:P,y:N,...A}=this._clearTransform();this.attrs.x=P,this.attrs.y=N,this._clearCache(x);const O=this._getAbsoluteTransform().copy();return O.invert(),O.translate(b.x,b.y),b={x:this.attrs.x+O.getTranslation().x,y:this.attrs.y+O.getTranslation().y},this._setTransform(A),this.setPosition({x:b.x,y:b.y}),this._clearCache(x),this._clearSelfAndDescendantCache(c),this}_setTransform(b){let P;for(P in b)this.attrs[P]=b[P]}_clearTransform(){const b={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,b}move(b){let P=b.x,N=b.y,A=this.x(),O=this.y();return P!==void 0&&(A+=P),N!==void 0&&(O+=N),this.setPosition({x:A,y:O}),this}_eachAncestorReverse(b,P){let N=[],A=this.getParent(),O,j;if(!(P&&P._id===this._id)){for(N.unshift(this);A&&(!P||A._id!==P._id);)N.unshift(A),A=A.parent;for(O=N.length,j=0;j<O;j++)b(N[j])}}rotate(b){return this.rotation(this.rotation()+b),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const b=this.index,P=this.parent.getChildren().length;return b<P-1?(this.parent.children.splice(b,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const b=this.index,P=this.parent.getChildren().length;return b<P-1?(this.parent.children.splice(b,1),this.parent.children.splice(b+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const b=this.index;return b>0?(this.parent.children.splice(b,1),this.parent.children.splice(b-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const b=this.index;return b>0?(this.parent.children.splice(b,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(b){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(b<0||b>=this.parent.children.length)&&s.Util.warn("Unexpected value "+b+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const P=this.index;return this.parent.children.splice(P,1),this.parent.children.splice(b,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let b=this.opacity();const P=this.getParent();return P&&!P._isUnderCache&&(b*=P.getAbsoluteOpacity()),b}moveTo(b){return this.getParent()!==b&&(this._remove(),b.add(this)),this}toObject(){let b=this.getAttrs(),P,N,A,O,j;const G={attrs:{},className:this.getClassName()};for(P in b)N=b[P],j=s.Util.isObject(N)&&!s.Util._isPlainObject(N)&&!s.Util._isArray(N),!j&&(A=typeof this[P]=="function"&&this[P],delete b[P],O=A?A.call(this):null,b[P]=N,O!==N&&(G.attrs[P]=N));return s.Util._prepareToStringify(G)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(b,P,N){const A=[];P&&this._isMatch(b)&&A.push(this);let O=this.parent;for(;O;){if(O===N)return A;O._isMatch(b)&&A.push(O),O=O.parent}return A}isAncestorOf(b){return!1}findAncestor(b,P,N){return this.findAncestors(b,P,N)[0]}_isMatch(b){if(!b)return!1;if(typeof b=="function")return b(this);let P=b.replace(/ /g,"").split(","),N=P.length,A,O;for(A=0;A<N;A++)if(O=P[A],s.Util.isValidSelector(O)||(s.Util.warn('Selector "'+O+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),O.charAt(0)==="#"){if(this.id()===O.slice(1))return!0}else if(O.charAt(0)==="."){if(this.hasName(O.slice(1)))return!0}else if(this.className===O||this.nodeType===O)return!0;return!1}getLayer(){const b=this.getParent();return b?b.getLayer():null}getStage(){return this._getCache(C,this._getStage)}_getStage(){const b=this.getParent();return b?b.getStage():null}fire(b,P={},N){return P.target=P.target||this,N?this._fireAndBubble(b,P):this._fire(b,P),this}getAbsoluteTransform(b){return b?this._getAbsoluteTransform(b):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(b){let P;if(b)return P=new s.Transform,this._eachAncestorReverse(function(N){const A=N.transformsEnabled();A==="all"?P.multiply(N.getTransform()):A==="position"&&P.translate(N.x()-N.offsetX(),N.y()-N.offsetY())},b),P;{P=this._cache.get(c)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(P):P.reset();const N=this.transformsEnabled();if(N==="all")P.multiply(this.getTransform());else if(N==="position"){const A=this.attrs.x||0,O=this.attrs.y||0,j=this.attrs.offsetX||0,G=this.attrs.offsetY||0;P.translate(A-j,O-G)}return P.dirty=!1,P}}getAbsoluteScale(b){let P=this;for(;P;)P._isUnderCache&&(b=P),P=P.getParent();const A=this.getAbsoluteTransform(b).decompose();return{x:A.scaleX,y:A.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(x,this._getTransform)}_getTransform(){var b,P;const N=this._cache.get(x)||new s.Transform;N.reset();const A=this.x(),O=this.y(),j=r.Konva.getAngle(this.rotation()),G=(b=this.attrs.scaleX)!==null&&b!==void 0?b:1,J=(P=this.attrs.scaleY)!==null&&P!==void 0?P:1,ot=this.attrs.skewX||0,W=this.attrs.skewY||0,M=this.attrs.offsetX||0,q=this.attrs.offsetY||0;return(A!==0||O!==0)&&N.translate(A,O),j!==0&&N.rotate(j),(ot!==0||W!==0)&&N.skew(ot,W),(G!==1||J!==1)&&N.scale(G,J),(M!==0||q!==0)&&N.translate(-1*M,-1*q),N.dirty=!1,N}clone(b){let P=s.Util.cloneObject(this.attrs),N,A,O,j,G;for(N in b)P[N]=b[N];const J=new this.constructor(P);for(N in this.eventListeners)for(A=this.eventListeners[N],O=A.length,j=0;j<O;j++)G=A[j],G.name.indexOf(u)<0&&(J.eventListeners[N]||(J.eventListeners[N]=[]),J.eventListeners[N].push(G));return J}_toKonvaCanvas(b){b=b||{};const P=this.getClientRect(),N=this.getStage(),A=b.x!==void 0?b.x:Math.floor(P.x),O=b.y!==void 0?b.y:Math.floor(P.y),j=b.pixelRatio||1,G=new t.SceneCanvas({width:b.width||Math.ceil(P.width)||(N?N.width():0),height:b.height||Math.ceil(P.height)||(N?N.height():0),pixelRatio:j}),J=G.getContext(),ot=new t.SceneCanvas({width:G.width/G.pixelRatio+Math.abs(A),height:G.height/G.pixelRatio+Math.abs(O),pixelRatio:G.pixelRatio});return b.imageSmoothingEnabled===!1&&(J._context.imageSmoothingEnabled=!1),J.save(),(A||O)&&J.translate(-1*A,-1*O),this.drawScene(G,void 0,ot),J.restore(),G}toCanvas(b){return this._toKonvaCanvas(b)._canvas}toDataURL(b){b=b||{};const P=b.mimeType||null,N=b.quality||null,A=this._toKonvaCanvas(b).toDataURL(P,N);return b.callback&&b.callback(A),A}toImage(b){return new Promise((P,N)=>{try{const A=b?.callback;A&&delete b.callback,s.Util._urlToImage(this.toDataURL(b),function(O){P(O),A?.(O)})}catch(A){N(A)}})}toBlob(b){return new Promise((P,N)=>{try{const A=b?.callback;A&&delete b.callback,this.toCanvas(b).toBlob(O=>{P(O),A?.(O)},b?.mimeType,b?.quality)}catch(A){N(A)}})}setSize(b){return this.width(b.width),this.height(b.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():r.Konva.dragDistance}_off(b,P,N){let A=this.eventListeners[b],O,j,G;for(O=0;O<A.length;O++)if(j=A[O].name,G=A[O].handler,(j!=="konva"||P==="konva")&&(!P||j===P)&&(!N||N===G)){if(A.splice(O,1),A.length===0){delete this.eventListeners[b];break}O--}}_fireChangeEvent(b,P,N){this._fire(b+m,{oldVal:P,newVal:N})}addName(b){if(!this.hasName(b)){const P=this.name(),N=P?P+" "+b:b;this.name(N)}return this}hasName(b){if(!b)return!1;const P=this.name();return P?(P||"").split(/\s/g).indexOf(b)!==-1:!1}removeName(b){const P=(this.name()||"").split(/\s/g),N=P.indexOf(b);return N!==-1&&(P.splice(N,1),this.name(P.join(" "))),this}setAttr(b,P){const N=this[v+s.Util._capitalize(b)];return s.Util._isFunction(N)?N.call(this,P):this._setAttr(b,P),this}_requestDraw(){if(r.Konva.autoDrawEnabled){const b=this.getLayer()||this.getStage();b?.batchDraw()}}_setAttr(b,P){const N=this.attrs[b];N===P&&!s.Util.isObject(P)||(P==null?delete this.attrs[b]:this.attrs[b]=P,this._shouldFireChangeEvents&&this._fireChangeEvent(b,N,P),this._requestDraw())}_setComponentAttr(b,P,N){let A;N!==void 0&&(A=this.attrs[b],A||(this.attrs[b]=this.getAttr(b)),this.attrs[b][P]=N,this._fireChangeEvent(b,A,N))}_fireAndBubble(b,P,N){P&&this.nodeType===T&&(P.target=this);const A=[y,S,w,g,l,_];if(!(A.indexOf(b)!==-1&&(N&&(this===N||this.isAncestorOf&&this.isAncestorOf(N))||this.nodeType==="Stage"&&!N))){this._fire(b,P);const j=A.indexOf(b)!==-1&&N&&N.isAncestorOf&&N.isAncestorOf(this)&&!N.isAncestorOf(this.parent);(P&&!P.cancelBubble||!P)&&this.parent&&this.parent.isListening()&&!j&&(N&&N.parent?this._fireAndBubble.call(this.parent,b,P,N):this._fireAndBubble.call(this.parent,b,P))}}_getProtoListeners(b){var P,N,A;const O=(P=this._cache.get(a))!==null&&P!==void 0?P:{};let j=O?.[b];if(j===void 0){j=[];let G=Object.getPrototypeOf(this);for(;G;){const J=(A=(N=G.eventListeners)===null||N===void 0?void 0:N[b])!==null&&A!==void 0?A:[];j.push(...J),G=Object.getPrototypeOf(G)}O[b]=j,this._cache.set(a,O)}return j}_fire(b,P){P=P||{},P.currentTarget=this,P.type=b;const N=this._getProtoListeners(b);if(N)for(let O=0;O<N.length;O++)N[O].handler.call(this,P);const A=this.eventListeners[b];if(A)for(let O=0;O<A.length;O++)A[O].handler.call(this,P)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(b){const P=b?b.pointerId:void 0,N=this.getStage(),A=this.getAbsolutePosition();if(!N)return;const O=N._getPointerById(P)||N._changedPointerPositions[0]||A;e.DD._dragElements.set(this._id,{node:this,startPointerPos:O,offset:{x:O.x-A.x,y:O.y-A.y},dragStatus:"ready",pointerId:P})}startDrag(b,P=!0){e.DD._dragElements.has(this._id)||this._createDragElement(b);const N=e.DD._dragElements.get(this._id);N.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:b&&b.evt},P)}_setDragPosition(b,P){const N=this.getStage()._getPointerById(P.pointerId);if(!N)return;let A={x:N.x-P.offset.x,y:N.y-P.offset.y};const O=this.dragBoundFunc();if(O!==void 0){const j=O.call(this,A,b);j?A=j:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==A.x||this._lastPos.y!==A.y)&&(this.setAbsolutePosition(A),this._requestDraw()),this._lastPos=A}stopDrag(b){const P=e.DD._dragElements.get(this._id);P&&(P.dragStatus="stopped"),e.DD._endDragBefore(b),e.DD._endDragAfter(b)}setDraggable(b){this._setAttr("draggable",b),this._dragChange()}isDragging(){const b=e.DD._dragElements.get(this._id);return b?b.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(b){if(!(!(b.evt.button!==void 0)||r.Konva.dragButtons.indexOf(b.evt.button)>=0)||this.isDragging())return;let A=!1;e.DD._dragElements.forEach(O=>{this.isAncestorOf(O.node)&&(A=!0)}),A||this._createDragElement(b)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const P=e.DD._dragElements.get(this._id),N=P&&P.dragStatus==="dragging",A=P&&P.dragStatus==="ready";N?this.stopDrag():A&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(b={x:0,y:0}){const P=this.getStage();if(!P)return!1;const N={x:-b.x,y:-b.y,width:P.width()+2*b.x,height:P.height()+2*b.y};return s.Util.haveIntersection(N,this.getClientRect())}static create(b,P){return s.Util._isString(b)&&(b=JSON.parse(b)),this._createNode(b,P)}static _createNode(b,P){let N=zr.prototype.getClassName.call(b),A=b.children,O,j,G;P&&(b.attrs.container=P),r.Konva[N]||(s.Util.warn('Can not find a node with class name "'+N+'". Fallback to "Shape".'),N="Shape");const J=r.Konva[N];if(O=new J(b.attrs),A)for(j=A.length,G=0;G<j;G++)O.add(zr._createNode(A[G]));return O}};fi.Node=V,V.prototype.nodeType="Node",V.prototype._attrsAffectingSize=[],V.prototype.eventListeners={},V.prototype.on.call(V.prototype,D,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(x),this._clearSelfAndDescendantCache(c)}),V.prototype.on.call(V.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(F)}),V.prototype.on.call(V.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(f)}),V.prototype.on.call(V.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const L=i.Factory.addGetterSetter;return L(V,"zIndex"),L(V,"absolutePosition"),L(V,"position"),L(V,"x",0,(0,n.getNumberValidator)()),L(V,"y",0,(0,n.getNumberValidator)()),L(V,"globalCompositeOperation","source-over",(0,n.getStringValidator)()),L(V,"opacity",1,(0,n.getNumberValidator)()),L(V,"name","",(0,n.getStringValidator)()),L(V,"id","",(0,n.getStringValidator)()),L(V,"rotation",0,(0,n.getNumberValidator)()),i.Factory.addComponentsGetterSetter(V,"scale",["x","y"]),L(V,"scaleX",1,(0,n.getNumberValidator)()),L(V,"scaleY",1,(0,n.getNumberValidator)()),i.Factory.addComponentsGetterSetter(V,"skew",["x","y"]),L(V,"skewX",0,(0,n.getNumberValidator)()),L(V,"skewY",0,(0,n.getNumberValidator)()),i.Factory.addComponentsGetterSetter(V,"offset",["x","y"]),L(V,"offsetX",0,(0,n.getNumberValidator)()),L(V,"offsetY",0,(0,n.getNumberValidator)()),L(V,"dragDistance",void 0,(0,n.getNumberValidator)()),L(V,"width",0,(0,n.getNumberValidator)()),L(V,"height",0,(0,n.getNumberValidator)()),L(V,"listening",!0,(0,n.getBooleanValidator)()),L(V,"preventDefault",!0,(0,n.getBooleanValidator)()),L(V,"filters",void 0,function(Q){return this._filterUpToDate=!1,Q}),L(V,"visible",!0,(0,n.getBooleanValidator)()),L(V,"transformsEnabled","all",(0,n.getStringValidator)()),L(V,"size"),L(V,"dragBoundFunc"),L(V,"draggable",!1,(0,n.getBooleanValidator)()),i.Factory.backCompat(V,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),fi}var gi={},Jo;function In(){if(Jo)return gi;Jo=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.Container=void 0;const t=yt(),e=At(),i=bt();let r=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(n){const o=this.children||[];return n?o.filter(n):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(n=>{n.parent=null,n.index=0,n.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(n=>{n.parent=null,n.index=0,n.destroy()}),this.children=[],this._requestDraw(),this}add(...n){if(n.length===0)return this;if(n.length>1){for(let a=0;a<n.length;a++)this.add(n[a]);return this}const o=n[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(n){return this._generalFind(n,!1)}findOne(n){const o=this._generalFind(n,!0);return o.length>0?o[0]:void 0}_generalFind(n,o){const a=[];return this._descendants(c=>{const d=c._isMatch(n);return d&&a.push(c),!!(d&&o)}),a}_descendants(n){let o=!1;const a=this.getChildren();for(const c of a){if(o=n(c),o)return!0;if(c.hasChildren()&&(o=c._descendants(n),o))return!0}return!1}toObject(){const n=e.Node.prototype.toObject.call(this);return n.children=[],this.getChildren().forEach(o=>{n.children.push(o.toObject())}),n}isAncestorOf(n){let o=n.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(n){const o=e.Node.prototype.clone.call(this,n);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(n){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(n)&&o.push(a)}),o}_clearSelfAndDescendantCache(n){var o;super._clearSelfAndDescendantCache(n),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(n)}))}_setChildrenIndices(){var n;(n=this.children)===null||n===void 0||n.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(n,o,a){const c=this.getLayer(),d=n||c&&c.getCanvas(),h=d&&d.getContext(),m=this._getCanvasCache(),p=m&&m.scene,u=d&&d.isCache;if(!this.isVisible()&&!u)return this;if(p){h.save();const f=this.getAbsoluteTransform(o).getMatrix();h.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(h),h.restore()}else this._drawChildren("drawScene",d,o,a);return this}drawHit(n,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),c=n||a&&a.hitCanvas,d=c&&c.getContext(),h=this._getCanvasCache();if(h&&h.hit){d.save();const p=this.getAbsoluteTransform(o).getMatrix();d.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedHitCanvas(d),d.restore()}else this._drawChildren("drawHit",c,o);return this}_drawChildren(n,o,a,c){var d;const h=o&&o.getContext(),m=this.clipWidth(),p=this.clipHeight(),u=this.clipFunc(),f=typeof m=="number"&&typeof p=="number"||u,y=a===this;if(f){h.save();const w=this.getAbsoluteTransform(a);let g=w.getMatrix();h.transform(g[0],g[1],g[2],g[3],g[4],g[5]),h.beginPath();let l;if(u)l=u.call(this,h,this);else{const _=this.clipX(),v=this.clipY();h.rect(_||0,v||0,m,p)}h.clip.apply(h,l),g=w.copy().invert().getMatrix(),h.transform(g[0],g[1],g[2],g[3],g[4],g[5])}const S=!y&&this.globalCompositeOperation()!=="source-over"&&n==="drawScene";S&&(h.save(),h._applyGlobalCompositeOperation(this)),(d=this.children)===null||d===void 0||d.forEach(function(w){w[n](o,a,c)}),S&&h.restore(),f&&h.restore()}getClientRect(n={}){var o;const a=n.skipTransform,c=n.relativeTo;let d,h,m,p,u={x:1/0,y:1/0,width:0,height:0};const f=this;(o=this.children)===null||o===void 0||o.forEach(function(w){if(!w.visible())return;const g=w.getClientRect({relativeTo:f,skipShadow:n.skipShadow,skipStroke:n.skipStroke});g.width===0&&g.height===0||(d===void 0?(d=g.x,h=g.y,m=g.x+g.width,p=g.y+g.height):(d=Math.min(d,g.x),h=Math.min(h,g.y),m=Math.max(m,g.x+g.width),p=Math.max(p,g.y+g.height)))});const y=this.find("Shape");let S=!1;for(let w=0;w<y.length;w++)if(y[w]._isVisible(this)){S=!0;break}return S&&d!==void 0?u={x:d,y:h,width:m-d,height:p-h}:u={x:0,y:0,width:0,height:0},a?u:this._transformedRect(u,c)}};return gi.Container=r,t.Factory.addComponentsGetterSetter(r,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(r,"clipX",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clipY",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clipWidth",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clipHeight",void 0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(r,"clipFunc"),gi}var Fr={},we={},Zo;function ta(){if(Zo)return we;Zo=1,Object.defineProperty(we,"__esModule",{value:!0}),we.getCapturedShape=r,we.createEvent=s,we.hasPointerCapture=n,we.setPointerCapture=o,we.releaseCapture=a;const t=mt(),e=new Map,i=t.Konva._global.PointerEvent!==void 0;function r(c){return e.get(c)}function s(c){return{evt:c,pointerId:c.pointerId}}function n(c,d){return e.get(c)===d}function o(c,d){a(c),d.getStage()&&(e.set(c,d),i&&d._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function a(c,d){const h=e.get(c);if(!h)return;const m=h.getStage();m&&m.content,e.delete(c),i&&h._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return we}var ea;function jh(){return ea||(ea=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Tt(),i=yt(),r=In(),s=mt(),n=kn(),o=Mr(),a=mt(),c=ta(),d="Stage",h="string",m="px",p="mouseout",u="mouseleave",f="mouseover",y="mouseenter",S="mousemove",w="mousedown",g="mouseup",l="pointermove",_="pointerdown",v="pointerup",T="pointercancel",I="lostpointercapture",C="pointerout",x="pointerleave",R="pointerover",F="pointerenter",D="contextmenu",B="touchstart",V="touchend",L="touchmove",Q="touchcancel",b="wheel",P=5,N=[[y,"_pointerenter"],[w,"_pointerdown"],[S,"_pointermove"],[g,"_pointerup"],[u,"_pointerleave"],[B,"_pointerdown"],[L,"_pointermove"],[V,"_pointerup"],[Q,"_pointercancel"],[f,"_pointerover"],[b,"_wheel"],[D,"_contextmenu"],[_,"_pointerdown"],[l,"_pointermove"],[v,"_pointerup"],[T,"_pointercancel"],[x,"_pointerleave"],[I,"_lostpointercapture"]],A={mouse:{[C]:p,[x]:u,[R]:f,[F]:y,[l]:S,[_]:w,[v]:g,[T]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[x]:"touchleave",[R]:"touchover",[F]:"touchenter",[l]:L,[_]:B,[v]:V,[T]:Q,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[x]:x,[R]:R,[F]:F,[l]:l,[_]:_,[v]:v,[T]:T,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},O=W=>W.indexOf("pointer")>=0?"pointer":W.indexOf("touch")>=0?"touch":"mouse",j=W=>{const M=O(W);if(M==="pointer")return s.Konva.pointerEventsEnabled&&A.pointer;if(M==="touch")return A.touch;if(M==="mouse")return A.mouse};function G(W={}){return(W.clipFunc||W.clipWidth||W.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),W}const J="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class ot extends r.Container{constructor(M){super(G(M)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{G(this.attrs)}),this._checkVisibility()}_validateAdd(M){const q=M.getType()==="Layer",nt=M.getType()==="FastLayer";q||nt||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const M=this.visible()?"":"none";this.content.style.display=M}setContainer(M){if(typeof M===h){let q;if(M.charAt(0)==="."){const nt=M.slice(1);M=document.getElementsByClassName(nt)[0]}else M.charAt(0)!=="#"?q=M:q=M.slice(1),M=document.getElementById(q);if(!M)throw"Can not find container in document with id "+q}return this._setAttr("container",M),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),M.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const M=this.children,q=M.length;for(let nt=0;nt<q;nt++)M[nt].clear();return this}clone(M){return M||(M={}),M.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,M)}destroy(){super.destroy();const M=this.content;M&&e.Util._isInDocument(M)&&this.container().removeChild(M);const q=t.stages.indexOf(this);return q>-1&&t.stages.splice(q,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const M=this._pointerPositions[0]||this._changedPointerPositions[0];return M?{x:M.x,y:M.y}:(e.Util.warn(J),null)}_getPointerById(M){return this._pointerPositions.find(q=>q.id===M)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(M){M=M||{},M.x=M.x||0,M.y=M.y||0,M.width=M.width||this.width(),M.height=M.height||this.height();const q=new n.SceneCanvas({width:M.width,height:M.height,pixelRatio:M.pixelRatio||1}),nt=q.getContext()._context,lt=this.children;return(M.x||M.y)&&nt.translate(-1*M.x,-1*M.y),lt.forEach(function(dt){if(!dt.isVisible())return;const E=dt._toKonvaCanvas(M);nt.drawImage(E._canvas,M.x,M.y,E.getWidth()/E.getPixelRatio(),E.getHeight()/E.getPixelRatio())}),q}getIntersection(M){if(!M)return null;const q=this.children,nt=q.length,lt=nt-1;for(let dt=lt;dt>=0;dt--){const E=q[dt].getIntersection(M);if(E)return E}return null}_resizeDOM(){const M=this.width(),q=this.height();this.content&&(this.content.style.width=M+m,this.content.style.height=q+m),this.bufferCanvas.setSize(M,q),this.bufferHitCanvas.setSize(M,q),this.children.forEach(nt=>{nt.setSize({width:M,height:q}),nt.draw()})}add(M,...q){if(arguments.length>1){for(let lt=0;lt<arguments.length;lt++)this.add(arguments[lt]);return this}super.add(M);const nt=this.children.length;return nt>P&&e.Util.warn("The stage has "+nt+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),M.setSize({width:this.width(),height:this.height()}),M.draw(),s.Konva.isBrowser&&this.content.appendChild(M.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(M){return c.hasPointerCapture(M,this)}setPointerCapture(M){c.setPointerCapture(M,this)}releaseCapture(M){c.releaseCapture(M,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&N.forEach(([M,q])=>{this.content.addEventListener(M,nt=>{this[q](nt)},{passive:!1})})}_pointerenter(M){this.setPointersPositions(M);const q=j(M.type);q&&this._fire(q.pointerenter,{evt:M,target:this,currentTarget:this})}_pointerover(M){this.setPointersPositions(M);const q=j(M.type);q&&this._fire(q.pointerover,{evt:M,target:this,currentTarget:this})}_getTargetShape(M){let q=this[M+"targetShape"];return q&&!q.getStage()&&(q=null),q}_pointerleave(M){const q=j(M.type),nt=O(M.type);if(!q)return;this.setPointersPositions(M);const lt=this._getTargetShape(nt),dt=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;lt&&dt?(lt._fireAndBubble(q.pointerout,{evt:M}),lt._fireAndBubble(q.pointerleave,{evt:M}),this._fire(q.pointerleave,{evt:M,target:this,currentTarget:this}),this[nt+"targetShape"]=null):dt&&(this._fire(q.pointerleave,{evt:M,target:this,currentTarget:this}),this._fire(q.pointerout,{evt:M,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(M){const q=j(M.type),nt=O(M.type);if(!q)return;this.setPointersPositions(M);let lt=!1;this._changedPointerPositions.forEach(dt=>{const E=this.getIntersection(dt);if(o.DD.justDragged=!1,s.Konva["_"+nt+"ListenClick"]=!0,!E||!E.isListening()){this[nt+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&E.setPointerCapture(dt.id),this[nt+"ClickStartShape"]=E,E._fireAndBubble(q.pointerdown,{evt:M,pointerId:dt.id}),lt=!0;const k=M.type.indexOf("touch")>=0;E.preventDefault()&&M.cancelable&&k&&M.preventDefault()}),lt||this._fire(q.pointerdown,{evt:M,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(M){const q=j(M.type),nt=O(M.type);if(!q||(s.Konva.isDragging()&&o.DD.node.preventDefault()&&M.cancelable&&M.preventDefault(),this.setPointersPositions(M),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const dt={};let E=!1;const k=this._getTargetShape(nt);this._changedPointerPositions.forEach(z=>{const Y=c.getCapturedShape(z.id)||this.getIntersection(z),$=z.id,X={evt:M,pointerId:$},tt=k!==Y;if(tt&&k&&(k._fireAndBubble(q.pointerout,{...X},Y),k._fireAndBubble(q.pointerleave,{...X},Y)),Y){if(dt[Y._id])return;dt[Y._id]=!0}Y&&Y.isListening()?(E=!0,tt&&(Y._fireAndBubble(q.pointerover,{...X},k),Y._fireAndBubble(q.pointerenter,{...X},k),this[nt+"targetShape"]=Y),Y._fireAndBubble(q.pointermove,{...X})):k&&(this._fire(q.pointerover,{evt:M,target:this,currentTarget:this,pointerId:$}),this[nt+"targetShape"]=null)}),E||this._fire(q.pointermove,{evt:M,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(M){const q=j(M.type),nt=O(M.type);if(!q)return;this.setPointersPositions(M);const lt=this[nt+"ClickStartShape"],dt=this[nt+"ClickEndShape"],E={};let k=!1;this._changedPointerPositions.forEach(z=>{const Y=c.getCapturedShape(z.id)||this.getIntersection(z);if(Y){if(Y.releaseCapture(z.id),E[Y._id])return;E[Y._id]=!0}const $=z.id,X={evt:M,pointerId:$};let tt=!1;s.Konva["_"+nt+"InDblClickWindow"]?(tt=!0,clearTimeout(this[nt+"DblTimeout"])):o.DD.justDragged||(s.Konva["_"+nt+"InDblClickWindow"]=!0,clearTimeout(this[nt+"DblTimeout"])),this[nt+"DblTimeout"]=setTimeout(function(){s.Konva["_"+nt+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),Y&&Y.isListening()?(k=!0,this[nt+"ClickEndShape"]=Y,Y._fireAndBubble(q.pointerup,{...X}),s.Konva["_"+nt+"ListenClick"]&&lt&&lt===Y&&(Y._fireAndBubble(q.pointerclick,{...X}),tt&&dt&&dt===Y&&Y._fireAndBubble(q.pointerdblclick,{...X}))):(this[nt+"ClickEndShape"]=null,s.Konva["_"+nt+"ListenClick"]&&this._fire(q.pointerclick,{evt:M,target:this,currentTarget:this,pointerId:$}),tt&&this._fire(q.pointerdblclick,{evt:M,target:this,currentTarget:this,pointerId:$}))}),k||this._fire(q.pointerup,{evt:M,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+nt+"ListenClick"]=!1,M.cancelable&&nt!=="touch"&&nt!=="pointer"&&M.preventDefault()}_contextmenu(M){this.setPointersPositions(M);const q=this.getIntersection(this.getPointerPosition());q&&q.isListening()?q._fireAndBubble(D,{evt:M}):this._fire(D,{evt:M,target:this,currentTarget:this})}_wheel(M){this.setPointersPositions(M);const q=this.getIntersection(this.getPointerPosition());q&&q.isListening()?q._fireAndBubble(b,{evt:M}):this._fire(b,{evt:M,target:this,currentTarget:this})}_pointercancel(M){this.setPointersPositions(M);const q=c.getCapturedShape(M.pointerId)||this.getIntersection(this.getPointerPosition());q&&q._fireAndBubble(v,c.createEvent(M)),c.releaseCapture(M.pointerId)}_lostpointercapture(M){c.releaseCapture(M.pointerId)}setPointersPositions(M){const q=this._getContentPosition();let nt=null,lt=null;M=M||window.event,M.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(M.touches,dt=>{this._pointerPositions.push({id:dt.identifier,x:(dt.clientX-q.left)/q.scaleX,y:(dt.clientY-q.top)/q.scaleY})}),Array.prototype.forEach.call(M.changedTouches||M.touches,dt=>{this._changedPointerPositions.push({id:dt.identifier,x:(dt.clientX-q.left)/q.scaleX,y:(dt.clientY-q.top)/q.scaleY})})):(nt=(M.clientX-q.left)/q.scaleX,lt=(M.clientY-q.top)/q.scaleY,this.pointerPos={x:nt,y:lt},this._pointerPositions=[{x:nt,y:lt,id:e.Util._getFirstPointerId(M)}],this._changedPointerPositions=[{x:nt,y:lt,id:e.Util._getFirstPointerId(M)}])}_setPointerPosition(M){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(M)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const M=this.content.getBoundingClientRect();return{top:M.top,left:M.left,scaleX:M.width/this.content.clientWidth||1,scaleY:M.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new n.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new n.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const M=this.container();if(!M)throw"Stage has no container. A container is required.";M.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),M.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(M){M.batchDraw()}),this}}t.Stage=ot,ot.prototype.nodeType=d,(0,a._registerNode)(ot),i.Factory.addGetterSetter(ot,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(W=>{W.batchDraw()})})}(Fr)),Fr}var pi={},kr={},ia;function Ft(){return ia||(ia=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=mt(),i=Tt(),r=yt(),s=At(),n=bt(),o=mt(),a=ta(),c="hasShadow",d="shadowRGBA",h="patternImage",m="linearGradient",p="radialGradient";let u;function f(){return u||(u=i.Util.createCanvasElement().getContext("2d"),u)}t.shapes={};function y(x){const R=this.attrs.fillRule;R?x.fill(R):x.fill()}function S(x){x.stroke()}function w(x){const R=this.attrs.fillRule;R?x.fill(R):x.fill()}function g(x){x.stroke()}function l(){this._clearCache(c)}function _(){this._clearCache(d)}function v(){this._clearCache(h)}function T(){this._clearCache(m)}function I(){this._clearCache(p)}class C extends s.Node{constructor(R){super(R);let F;for(;F=i.Util.getRandomColor(),!(F&&!(F in t.shapes)););this.colorKey=F,t.shapes[F]=this}getContext(){return i.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return i.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const F=f().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(F&&F.setTransform){const D=new i.Transform;D.translate(this.fillPatternX(),this.fillPatternY()),D.rotate(e.Konva.getAngle(this.fillPatternRotation())),D.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),D.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const B=D.getMatrix(),V=typeof DOMMatrix>"u"?{a:B[0],b:B[1],c:B[2],d:B[3],e:B[4],f:B[5]}:new DOMMatrix(B);F.setTransform(V)}return F}}_getLinearGradient(){return this._getCache(m,this.__getLinearGradient)}__getLinearGradient(){const R=this.fillLinearGradientColorStops();if(R){const F=f(),D=this.fillLinearGradientStartPoint(),B=this.fillLinearGradientEndPoint(),V=F.createLinearGradient(D.x,D.y,B.x,B.y);for(let L=0;L<R.length;L+=2)V.addColorStop(R[L],R[L+1]);return V}}_getRadialGradient(){return this._getCache(p,this.__getRadialGradient)}__getRadialGradient(){const R=this.fillRadialGradientColorStops();if(R){const F=f(),D=this.fillRadialGradientStartPoint(),B=this.fillRadialGradientEndPoint(),V=F.createRadialGradient(D.x,D.y,this.fillRadialGradientStartRadius(),B.x,B.y,this.fillRadialGradientEndRadius());for(let L=0;L<R.length;L+=2)V.addColorStop(R[L],R[L+1]);return V}}getShadowRGBA(){return this._getCache(d,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const R=i.Util.colorToRGBA(this.shadowColor());if(R)return"rgba("+R.r+","+R.g+","+R.b+","+R.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const R=this.hitStrokeWidth();return R==="auto"?this.hasStroke():this.strokeEnabled()&&!!R}intersects(R){const F=this.getStage();if(!F)return!1;const D=F.bufferHitCanvas;return D.getContext().clear(),this.drawHit(D,void 0,!0),D.context.getImageData(Math.round(R.x),Math.round(R.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(R){var F;if(!((F=this.attrs.perfectDrawEnabled)!==null&&F!==void 0?F:!0))return!1;const B=R||this.hasFill(),V=this.hasStroke(),L=this.getAbsoluteOpacity()!==1;if(B&&V&&L)return!0;const Q=this.hasShadow(),b=this.shadowForStrokeEnabled();return!!(B&&V&&Q&&b)}setStrokeHitEnabled(R){i.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),R?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const R=this.size();return{x:this._centroid?-R.width/2:0,y:this._centroid?-R.height/2:0,width:R.width,height:R.height}}getClientRect(R={}){let F=!1,D=this.getParent();for(;D;){if(D.isCached()){F=!0;break}D=D.getParent()}const B=R.skipTransform,V=R.relativeTo||F&&this.getStage()||void 0,L=this.getSelfRect(),b=!R.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,P=L.width+b,N=L.height+b,A=!R.skipShadow&&this.hasShadow(),O=A?this.shadowOffsetX():0,j=A?this.shadowOffsetY():0,G=P+Math.abs(O),J=N+Math.abs(j),ot=A&&this.shadowBlur()||0,W=G+ot*2,M=J+ot*2,q={width:W,height:M,x:-(b/2+ot)+Math.min(O,0)+L.x,y:-(b/2+ot)+Math.min(j,0)+L.y};return B?q:this._transformedRect(q,V)}drawScene(R,F,D){const B=this.getLayer(),V=R||B.getCanvas(),L=V.getContext(),Q=this._getCanvasCache(),b=this.getSceneFunc(),P=this.hasShadow();let N;const A=F===this;if(!this.isVisible()&&!A)return this;if(Q){L.save();const O=this.getAbsoluteTransform(F).getMatrix();return L.transform(O[0],O[1],O[2],O[3],O[4],O[5]),this._drawCachedSceneCanvas(L),L.restore(),this}if(!b)return this;if(L.save(),this._useBufferCanvas()){N=this.getStage();const O=D||N.bufferCanvas,j=O.getContext();j.clear(),j.save(),j._applyLineJoin(this);const G=this.getAbsoluteTransform(F).getMatrix();j.transform(G[0],G[1],G[2],G[3],G[4],G[5]),b.call(this,j,this),j.restore();const J=O.pixelRatio;P&&L._applyShadow(this),L._applyOpacity(this),L._applyGlobalCompositeOperation(this),L.drawImage(O._canvas,O.x||0,O.y||0,O.width/J,O.height/J)}else{if(L._applyLineJoin(this),!A){const O=this.getAbsoluteTransform(F).getMatrix();L.transform(O[0],O[1],O[2],O[3],O[4],O[5]),L._applyOpacity(this),L._applyGlobalCompositeOperation(this)}P&&L._applyShadow(this),b.call(this,L,this)}return L.restore(),this}drawHit(R,F,D=!1){if(!this.shouldDrawHit(F,D))return this;const B=this.getLayer(),V=R||B.hitCanvas,L=V&&V.getContext(),Q=this.hitFunc()||this.sceneFunc(),b=this._getCanvasCache(),P=b&&b.hit;if(this.colorKey||i.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),P){L.save();const A=this.getAbsoluteTransform(F).getMatrix();return L.transform(A[0],A[1],A[2],A[3],A[4],A[5]),this._drawCachedHitCanvas(L),L.restore(),this}if(!Q)return this;if(L.save(),L._applyLineJoin(this),!(this===F)){const A=this.getAbsoluteTransform(F).getMatrix();L.transform(A[0],A[1],A[2],A[3],A[4],A[5])}return Q.call(this,L,this),L.restore(),this}drawHitFromCache(R=0){const F=this._getCanvasCache(),D=this._getCachedSceneCanvas(),B=F.hit,V=B.getContext(),L=B.getWidth(),Q=B.getHeight();V.clear(),V.drawImage(D._canvas,0,0,L,Q);try{const b=V.getImageData(0,0,L,Q),P=b.data,N=P.length,A=i.Util._hexToRgb(this.colorKey);for(let O=0;O<N;O+=4)P[O+3]>R?(P[O]=A.r,P[O+1]=A.g,P[O+2]=A.b,P[O+3]=255):P[O+3]=0;V.putImageData(b,0,0)}catch(b){i.Util.error("Unable to draw hit graph from cached scene canvas. "+b.message)}return this}hasPointerCapture(R){return a.hasPointerCapture(R,this)}setPointerCapture(R){a.setPointerCapture(R,this)}releaseCapture(R){a.releaseCapture(R,this)}}t.Shape=C,C.prototype._fillFunc=y,C.prototype._strokeFunc=S,C.prototype._fillFuncHit=w,C.prototype._strokeFuncHit=g,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,o._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",l),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",v),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",T),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",I),r.Factory.addGetterSetter(C,"stroke",void 0,(0,n.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"strokeWidth",2,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,n.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,n.getBooleanValidator)()),r.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,n.getBooleanValidator)()),r.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,n.getBooleanValidator)()),r.Factory.addGetterSetter(C,"lineJoin"),r.Factory.addGetterSetter(C,"lineCap"),r.Factory.addGetterSetter(C,"sceneFunc"),r.Factory.addGetterSetter(C,"hitFunc"),r.Factory.addGetterSetter(C,"dash"),r.Factory.addGetterSetter(C,"dashOffset",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowColor",void 0,(0,n.getStringValidator)()),r.Factory.addGetterSetter(C,"shadowBlur",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOpacity",1,(0,n.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternImage"),r.Factory.addGetterSetter(C,"fill",void 0,(0,n.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"fillPatternX",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternY",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(C,"fillEnabled",!0),r.Factory.addGetterSetter(C,"strokeEnabled",!0),r.Factory.addGetterSetter(C,"shadowEnabled",!0),r.Factory.addGetterSetter(C,"dashEnabled",!0),r.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(C,"fillPriority","color"),r.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,n.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,n.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(C,"fillPatternRotation",0),r.Factory.addGetterSetter(C,"fillRule",void 0,(0,n.getStringValidator)()),r.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(kr)),kr}var na;function ra(){if(na)return pi;na=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Layer=void 0;const t=Tt(),e=In(),i=At(),r=yt(),s=kn(),n=bt(),o=Ft(),a=mt(),c="#",d="beforeDraw",h="draw",m=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],p=m.length;let u=class extends e.Container{constructor(y){super(y),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(y){return this.getContext().clear(y),this.getHitCanvas().getContext().clear(y),this}setZIndex(y){super.setZIndex(y);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),y<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[y+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){i.Node.prototype.moveToTop.call(this);const y=this.getStage();return y&&y.content&&(y.content.removeChild(this.getNativeCanvasElement()),y.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!i.Node.prototype.moveUp.call(this))return!1;const S=this.getStage();return!S||!S.content?!1:(S.content.removeChild(this.getNativeCanvasElement()),this.index<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[this.index+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(i.Node.prototype.moveDown.call(this)){const y=this.getStage();if(y){const S=y.children;y.content&&(y.content.removeChild(this.getNativeCanvasElement()),y.content.insertBefore(this.getNativeCanvasElement(),S[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(i.Node.prototype.moveToBottom.call(this)){const y=this.getStage();if(y){const S=y.children;y.content&&(y.content.removeChild(this.getNativeCanvasElement()),y.content.insertBefore(this.getNativeCanvasElement(),S[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const y=this.getNativeCanvasElement();return i.Node.prototype.remove.call(this),y&&y.parentNode&&t.Util._isInDocument(y)&&y.parentNode.removeChild(y),this}getStage(){return this.parent}setSize({width:y,height:S}){return this.canvas.setSize(y,S),this.hitCanvas.setSize(y,S),this._setSmoothEnabled(),this}_validateAdd(y){const S=y.getType();S!=="Group"&&S!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(y){return y=y||{},y.width=y.width||this.getWidth(),y.height=y.height||this.getHeight(),y.x=y.x!==void 0?y.x:this.x(),y.y=y.y!==void 0?y.y:this.y(),i.Node.prototype._toKonvaCanvas.call(this,y)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(y){if(!this.isListening()||!this.isVisible())return null;let S=1,w=!1;for(;;){for(let g=0;g<p;g++){const l=m[g],_=this._getIntersection({x:y.x+l.x*S,y:y.y+l.y*S}),v=_.shape;if(v)return v;if(w=!!_.antialiased,!_.antialiased)break}if(w)S+=1;else return null}}_getIntersection(y){const S=this.hitCanvas.pixelRatio,w=this.hitCanvas.context.getImageData(Math.round(y.x*S),Math.round(y.y*S),1,1).data,g=w[3];if(g===255){const l=t.Util._rgbToHex(w[0],w[1],w[2]),_=o.shapes[c+l];return _?{shape:_}:{antialiased:!0}}else if(g>0)return{antialiased:!0};return{}}drawScene(y,S,w){const g=this.getLayer(),l=y||g&&g.getCanvas();return this._fire(d,{node:this}),this.clearBeforeDraw()&&l.getContext().clear(),e.Container.prototype.drawScene.call(this,l,S,w),this._fire(h,{node:this}),this}drawHit(y,S){const w=this.getLayer(),g=y||w&&w.hitCanvas;return w&&w.clearBeforeDraw()&&w.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,g,S),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(y){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(y)}getHitGraphEnabled(y){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const y=this.parent;!!this.hitCanvas._canvas.parentNode?y.content.removeChild(this.hitCanvas._canvas):y.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return pi.Layer=u,u.prototype.nodeType="Layer",(0,a._registerNode)(u),r.Factory.addGetterSetter(u,"imageSmoothingEnabled",!0),r.Factory.addGetterSetter(u,"clearBeforeDraw",!0),r.Factory.addGetterSetter(u,"hitGraphEnabled",!0,(0,n.getBooleanValidator)()),pi}var mi={},sa;function Yh(){if(sa)return mi;sa=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.FastLayer=void 0;const t=Tt(),e=ra(),i=mt();let r=class extends e.Layer{constructor(n){super(n),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return mi.FastLayer=r,r.prototype.nodeType="FastLayer",(0,i._registerNode)(r),mi}var _i={},oa;function Ir(){if(oa)return _i;oa=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.Group=void 0;const t=Tt(),e=In(),i=mt();let r=class extends e.Container{_validateAdd(n){const o=n.getType();o!=="Group"&&o!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return _i.Group=r,r.prototype.nodeType="Group",(0,i._registerNode)(r),_i}var yi={},aa;function Or(){if(aa)return yi;aa=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.Animation=void 0;const t=mt(),e=Tt(),i=function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}}();let r=class je{constructor(n,o){this.id=je.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:i(),frameRate:0},this.func=n,this.setLayers(o)}setLayers(n){let o=[];return n&&(o=Array.isArray(n)?n:[n]),this.layers=o,this}getLayers(){return this.layers}addLayer(n){const o=this.layers,a=o.length;for(let c=0;c<a;c++)if(o[c]._id===n._id)return!1;return this.layers.push(n),!0}isRunning(){const o=je.animations,a=o.length;for(let c=0;c<a;c++)if(o[c].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=i(),je._addAnimation(this),this}stop(){return je._removeAnimation(this),this}_updateFrameObject(n){this.frame.timeDiff=n-this.frame.lastTime,this.frame.lastTime=n,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(n){this.animations.push(n),this._handleAnimation()}static _removeAnimation(n){const o=n.id,a=this.animations,c=a.length;for(let d=0;d<c;d++)if(a[d].id===o){this.animations.splice(d,1);break}}static _runFrames(){const n={},o=this.animations;for(let a=0;a<o.length;a++){const c=o[a],d=c.layers,h=c.func;c._updateFrameObject(i());const m=d.length;let p;if(h?p=h.call(c,c.frame)!==!1:p=!0,!!p)for(let u=0;u<m;u++){const f=d[u];f._id!==void 0&&(n[f._id]=f)}}for(const a in n)n.hasOwnProperty(a)&&n[a].batchDraw()}static _animationLoop(){const n=je;n.animations.length?(n._runFrames(),e.Util.requestAnimFrame(n._animationLoop)):n.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return yi.Animation=r,r.animations=[],r.animIdCounter=0,r.animRunning=!1,yi}var Dr={},la;function Xh(){return la||(la=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Tt(),i=Or(),r=At(),s=mt(),n={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,c=3,d=["fill","stroke","shadowColor"];let h=0;class m{constructor(f,y,S,w,g,l,_){this.prop=f,this.propFunc=y,this.begin=w,this._pos=w,this.duration=l,this._change=0,this.prevPos=0,this.yoyo=_,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=S,this._change=g-this.begin,this.pause()}fire(f){const y=this[f];y&&y()}setTime(f){f>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():f<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=f,this.update())}getTime(){return this._time}setPosition(f){this.prevPos=this._pos,this.propFunc(f),this._pos=f}getPosition(f){return f===void 0&&(f=this._time),this.func(f,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(f){this.pause(),this._time=f,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const f=this.getTimer()-this._startTime;this.state===a?this.setTime(f):this.state===c&&this.setTime(this.duration-f)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class p{constructor(f){const y=this,S=f.node,w=S._id,g=f.easing||t.Easings.Linear,l=!!f.yoyo;let _,v;typeof f.duration>"u"?_=.3:f.duration===0?_=.001:_=f.duration,this.node=S,this._id=h++;const T=S.getLayer()||(S instanceof s.Konva.Stage?S.getLayers():null);T||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new i.Animation(function(){y.tween.onEnterFrame()},T),this.tween=new m(v,function(I){y._tweenFunc(I)},g,0,1,_*1e3,l),this._addListeners(),p.attrs[w]||(p.attrs[w]={}),p.attrs[w][this._id]||(p.attrs[w][this._id]={}),p.tweens[w]||(p.tweens[w]={});for(v in f)n[v]===void 0&&this._addAttr(v,f[v]);this.reset(),this.onFinish=f.onFinish,this.onReset=f.onReset,this.onUpdate=f.onUpdate}_addAttr(f,y){const S=this.node,w=S._id;let g,l,_,v,T;const I=p.tweens[w][f];I&&delete p.attrs[w][I][f];let C=S.getAttr(f);if(e.Util._isArray(y))if(g=[],l=Math.max(y.length,C.length),f==="points"&&y.length!==C.length&&(y.length>C.length?(v=C,C=e.Util._prepareArrayForTween(C,y,S.closed())):(_=y,y=e.Util._prepareArrayForTween(y,C,S.closed()))),f.indexOf("fill")===0)for(let x=0;x<l;x++)if(x%2===0)g.push(y[x]-C[x]);else{const R=e.Util.colorToRGBA(C[x]);T=e.Util.colorToRGBA(y[x]),C[x]=R,g.push({r:T.r-R.r,g:T.g-R.g,b:T.b-R.b,a:T.a-R.a})}else for(let x=0;x<l;x++)g.push(y[x]-C[x]);else d.indexOf(f)!==-1?(C=e.Util.colorToRGBA(C),T=e.Util.colorToRGBA(y),g={r:T.r-C.r,g:T.g-C.g,b:T.b-C.b,a:T.a-C.a}):g=y-C;p.attrs[w][this._id][f]={start:C,diff:g,end:y,trueEnd:_,trueStart:v},p.tweens[w][f]=this._id}_tweenFunc(f){const y=this.node,S=p.attrs[y._id][this._id];let w,g,l,_,v,T,I,C;for(w in S){if(g=S[w],l=g.start,_=g.diff,C=g.end,e.Util._isArray(l))if(v=[],I=Math.max(l.length,C.length),w.indexOf("fill")===0)for(T=0;T<I;T++)T%2===0?v.push((l[T]||0)+_[T]*f):v.push("rgba("+Math.round(l[T].r+_[T].r*f)+","+Math.round(l[T].g+_[T].g*f)+","+Math.round(l[T].b+_[T].b*f)+","+(l[T].a+_[T].a*f)+")");else for(T=0;T<I;T++)v.push((l[T]||0)+_[T]*f);else d.indexOf(w)!==-1?v="rgba("+Math.round(l.r+_.r*f)+","+Math.round(l.g+_.g*f)+","+Math.round(l.b+_.b*f)+","+(l.a+_.a*f)+")":v=l+_*f;y.setAttr(w,v)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const f=this.node,y=p.attrs[f._id][this._id];y.points&&y.points.trueEnd&&f.setAttr("points",y.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const f=this.node,y=p.attrs[f._id][this._id];y.points&&y.points.trueStart&&f.points(y.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(f){return this.tween.seek(f*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const f=this.node._id,y=this._id,S=p.tweens[f];this.pause(),this.anim&&this.anim.stop();for(const w in S)delete p.tweens[f][w];delete p.attrs[f][y],Object.keys(p.tweens[f]).length===0&&delete p.tweens[f],Object.keys(p.attrs[f]).length===0&&delete p.attrs[f]}}t.Tween=p,p.attrs={},p.tweens={},r.Node.prototype.to=function(u){const f=u.onFinish;u.node=this,u.onFinish=function(){this.destroy(),f&&f()},new p(u).play()},t.Easings={BackEaseIn(u,f,y,S){return y*(u/=S)*u*(2.70158*u-1.70158)+f},BackEaseOut(u,f,y,S){return y*((u=u/S-1)*u*(2.70158*u+1.70158)+1)+f},BackEaseInOut(u,f,y,S){let w=1.70158;return(u/=S/2)<1?y/2*(u*u*(((w*=1.525)+1)*u-w))+f:y/2*((u-=2)*u*(((w*=1.525)+1)*u+w)+2)+f},ElasticEaseIn(u,f,y,S,w,g){let l=0;return u===0?f:(u/=S)===1?f+y:(g||(g=S*.3),!w||w<Math.abs(y)?(w=y,l=g/4):l=g/(2*Math.PI)*Math.asin(y/w),-(w*Math.pow(2,10*(u-=1))*Math.sin((u*S-l)*(2*Math.PI)/g))+f)},ElasticEaseOut(u,f,y,S,w,g){let l=0;return u===0?f:(u/=S)===1?f+y:(g||(g=S*.3),!w||w<Math.abs(y)?(w=y,l=g/4):l=g/(2*Math.PI)*Math.asin(y/w),w*Math.pow(2,-10*u)*Math.sin((u*S-l)*(2*Math.PI)/g)+y+f)},ElasticEaseInOut(u,f,y,S,w,g){let l=0;return u===0?f:(u/=S/2)===2?f+y:(g||(g=S*.44999999999999996),!w||w<Math.abs(y)?(w=y,l=g/4):l=g/(2*Math.PI)*Math.asin(y/w),u<1?-.5*(w*Math.pow(2,10*(u-=1))*Math.sin((u*S-l)*(2*Math.PI)/g))+f:w*Math.pow(2,-10*(u-=1))*Math.sin((u*S-l)*(2*Math.PI)/g)*.5+y+f)},BounceEaseOut(u,f,y,S){return(u/=S)<.36363636363636365?y*(7.5625*u*u)+f:u<.7272727272727273?y*(7.5625*(u-=.5454545454545454)*u+.75)+f:u<.9090909090909091?y*(7.5625*(u-=.8181818181818182)*u+.9375)+f:y*(7.5625*(u-=.9545454545454546)*u+.984375)+f},BounceEaseIn(u,f,y,S){return y-t.Easings.BounceEaseOut(S-u,0,y,S)+f},BounceEaseInOut(u,f,y,S){return u<S/2?t.Easings.BounceEaseIn(u*2,0,y,S)*.5+f:t.Easings.BounceEaseOut(u*2-S,0,y,S)*.5+y*.5+f},EaseIn(u,f,y,S){return y*(u/=S)*u+f},EaseOut(u,f,y,S){return-y*(u/=S)*(u-2)+f},EaseInOut(u,f,y,S){return(u/=S/2)<1?y/2*u*u+f:-y/2*(--u*(u-2)-1)+f},StrongEaseIn(u,f,y,S){return y*(u/=S)*u*u*u*u+f},StrongEaseOut(u,f,y,S){return y*((u=u/S-1)*u*u*u*u+1)+f},StrongEaseInOut(u,f,y,S){return(u/=S/2)<1?y/2*u*u*u*u*u+f:y/2*((u-=2)*u*u*u*u+2)+f},Linear(u,f,y,S){return y*u/S+f}}}(Dr)),Dr}var ca;function $h(){return ca||(ca=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=mt(),i=Tt(),r=At(),s=In(),n=jh(),o=ra(),a=Yh(),c=Ir(),d=Mr(),h=Ft(),m=Or(),p=Xh(),u=Ko(),f=kn();t.Konva=i.Util._assign(e.Konva,{Util:i.Util,Transform:i.Transform,Node:r.Node,Container:s.Container,Stage:n.Stage,stages:n.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:c.Group,DD:d.DD,Shape:h.Shape,shapes:h.shapes,Animation:m.Animation,Tween:p.Tween,Easings:p.Easings,Context:u.Context,Canvas:f.Canvas}),t.default=t.Konva}(Rr)),Rr}var bi={},ha;function Qh(){if(ha)return bi;ha=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.Arc=void 0;const t=yt(),e=Ft(),i=mt(),r=bt(),s=mt();let n=class extends e.Shape{_sceneFunc(a){const c=i.Konva.getAngle(this.angle()),d=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,c,d),a.arc(0,0,this.innerRadius(),c,0,!d),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),c=this.outerRadius(),d=this.clockwise(),h=i.Konva.getAngle(d?360-this.angle():this.angle()),m=Math.cos(Math.min(h,Math.PI)),p=1,u=Math.sin(Math.min(Math.max(Math.PI,h),3*Math.PI/2)),f=Math.sin(Math.min(h,Math.PI/2)),y=m*(m>0?a:c),S=p*c,w=u*(u>0?a:c),g=f*(f>0?c:a);return{x:y,y:d?-1*g:w,width:S-y,height:g-w}}};return bi.Arc=n,n.prototype._centroid=!0,n.prototype.className="Arc",n.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(n),t.Factory.addGetterSetter(n,"innerRadius",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"outerRadius",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"angle",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"clockwise",!1,(0,r.getBooleanValidator)()),bi}var vi={},Si={},da;function ua(){if(da)return Si;da=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.Line=void 0;const t=yt(),e=mt(),i=Ft(),r=bt();function s(a,c,d,h,m,p,u){const f=Math.sqrt(Math.pow(d-a,2)+Math.pow(h-c,2)),y=Math.sqrt(Math.pow(m-d,2)+Math.pow(p-h,2)),S=u*f/(f+y),w=u*y/(f+y),g=d-S*(m-a),l=h-S*(p-c),_=d+w*(m-a),v=h+w*(p-c);return[g,l,_,v]}function n(a,c){const d=a.length,h=[];for(let m=2;m<d-2;m+=2){const p=s(a[m-2],a[m-1],a[m],a[m+1],a[m+2],a[m+3],c);isNaN(p[0])||(h.push(p[0]),h.push(p[1]),h.push(a[m]),h.push(a[m+1]),h.push(p[2]),h.push(p[3]))}return h}let o=class extends i.Shape{constructor(c){super(c),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(c){const d=this.points(),h=d.length,m=this.tension(),p=this.closed(),u=this.bezier();if(!h)return;let f=0;if(c.beginPath(),c.moveTo(d[0],d[1]),m!==0&&h>4){const y=this.getTensionPoints(),S=y.length;for(f=p?0:4,p||c.quadraticCurveTo(y[0],y[1],y[2],y[3]);f<S-2;)c.bezierCurveTo(y[f++],y[f++],y[f++],y[f++],y[f++],y[f++]);p||c.quadraticCurveTo(y[S-2],y[S-1],d[h-2],d[h-1])}else if(u)for(f=2;f<h;)c.bezierCurveTo(d[f++],d[f++],d[f++],d[f++],d[f++],d[f++]);else for(f=2;f<h;f+=2)c.lineTo(d[f],d[f+1]);p?(c.closePath(),c.fillStrokeShape(this)):c.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():n(this.points(),this.tension())}_getTensionPointsClosed(){const c=this.points(),d=c.length,h=this.tension(),m=s(c[d-2],c[d-1],c[0],c[1],c[2],c[3],h),p=s(c[d-4],c[d-3],c[d-2],c[d-1],c[0],c[1],h),u=n(c,h);return[m[2],m[3]].concat(u).concat([p[0],p[1],c[d-2],c[d-1],p[2],p[3],m[0],m[1],c[0],c[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let c=this.points();if(c.length<4)return{x:c[0]||0,y:c[1]||0,width:0,height:0};this.tension()!==0?c=[c[0],c[1],...this._getTensionPoints(),c[c.length-2],c[c.length-1]]:c=this.points();let d=c[0],h=c[0],m=c[1],p=c[1],u,f;for(let y=0;y<c.length/2;y++)u=c[y*2],f=c[y*2+1],d=Math.min(d,u),h=Math.max(h,u),m=Math.min(m,f),p=Math.max(p,f);return{x:d,y:m,width:h-d,height:p-m}}};return Si.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),t.Factory.addGetterSetter(o,"closed",!1),t.Factory.addGetterSetter(o,"bezier",!1),t.Factory.addGetterSetter(o,"tension",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(o,"points",[],(0,r.getNumberArrayValidator)()),Si}var Ci={},Lr={},fa;function Jh(){return fa||(fa=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,c)=>{let d,h;const p=c/2;d=0;for(let u=0;u<20;u++)h=p*t.tValues[20][u]+p,d+=t.cValues[20][u]*r(o,a,h);return p*d};t.getCubicArcLength=e;const i=(o,a,c)=>{c===void 0&&(c=1);const d=o[0]-2*o[1]+o[2],h=a[0]-2*a[1]+a[2],m=2*o[1]-2*o[0],p=2*a[1]-2*a[0],u=4*(d*d+h*h),f=4*(d*m+h*p),y=m*m+p*p;if(u===0)return c*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const S=f/(2*u),w=y/u,g=c+S,l=w-S*S,_=g*g+l>0?Math.sqrt(g*g+l):0,v=S*S+l>0?Math.sqrt(S*S+l):0,T=S+Math.sqrt(S*S+l)!==0?l*Math.log(Math.abs((g+_)/(S+v))):0;return Math.sqrt(u)/2*(g*_-S*v+T)};t.getQuadraticArcLength=i;function r(o,a,c){const d=s(1,c,o),h=s(1,c,a),m=d*d+h*h;return Math.sqrt(m)}const s=(o,a,c)=>{const d=c.length-1;let h,m;if(d===0)return 0;if(o===0){m=0;for(let p=0;p<=d;p++)m+=t.binomialCoefficients[d][p]*Math.pow(1-a,d-p)*Math.pow(a,p)*c[p];return m}else{h=new Array(d);for(let p=0;p<d;p++)h[p]=d*(c[p+1]-c[p]);return s(o-1,a,h)}},n=(o,a,c)=>{let d=1,h=o/a,m=(o-c(h))/a,p=0;for(;d>.001;){const u=c(h+m),f=Math.abs(o-u)/a;if(f<d)d=f,h+=m;else{const y=c(h-m),S=Math.abs(o-y)/a;S<d?(d=S,h-=m):m/=2}if(p++,p>500)break}return h};t.t2length=n}(Lr)),Lr}var ga;function Gr(){if(ga)return Ci;ga=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.Path=void 0;const t=yt(),e=mt(),i=Ft(),r=Jh();let s=class qt extends i.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=qt.parsePathData(this.data()),this.pathLength=qt.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let c=!1;for(let d=0;d<a.length;d++){const h=a[d].command,m=a[d].points;switch(h){case"L":o.lineTo(m[0],m[1]);break;case"M":o.moveTo(m[0],m[1]);break;case"C":o.bezierCurveTo(m[0],m[1],m[2],m[3],m[4],m[5]);break;case"Q":o.quadraticCurveTo(m[0],m[1],m[2],m[3]);break;case"A":const p=m[0],u=m[1],f=m[2],y=m[3],S=m[4],w=m[5],g=m[6],l=m[7],_=f>y?f:y,v=f>y?1:f/y,T=f>y?y/f:1;o.translate(p,u),o.rotate(g),o.scale(v,T),o.arc(0,0,_,S,S+w,1-l),o.scale(1/v,1/T),o.rotate(-g),o.translate(-p,-u);break;case"z":c=!0,o.closePath();break}}!c&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],y=u.points[5],S=u.points[4]+y;let w=Math.PI/180;if(Math.abs(f-S)<w&&(w=Math.abs(f-S)),y<0)for(let g=f-w;g>S;g-=w){const l=qt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);o.push(l.x,l.y)}else for(let g=f+w;g<S;g+=w){const l=qt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);o.push(l.x,l.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const y=qt.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);o.push(y.x,y.y)}else o=o.concat(u.points)});let a=o[0],c=o[0],d=o[1],h=o[1],m,p;for(let u=0;u<o.length/2;u++)m=o[u*2],p=o[u*2+1],isNaN(m)||(a=Math.min(a,m),c=Math.max(c,m)),isNaN(p)||(d=Math.min(d,p),h=Math.max(h,p));return{x:a,y:d,width:c-a,height:h-d}}getLength(){return this.pathLength}getPointAtLength(o){return qt.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,c,d){return Math.sqrt((c-o)*(c-o)+(d-a)*(d-a))}static getPathLength(o){let a=0;for(let c=0;c<o.length;++c)a+=o[c].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let c,d=0,h=a.length;if(!h)return null;for(;d<h&&o>a[d].pathLength;)o-=a[d].pathLength,++d;if(d===h)return c=a[d-1].points.slice(-2),{x:c[0],y:c[1]};if(o<.01)return a[d].command==="M"?(c=a[d].points.slice(0,2),{x:c[0],y:c[1]}):{x:a[d].start.x,y:a[d].start.y};const m=a[d],p=m.points;switch(m.command){case"L":return qt.getPointOnLine(o,m.start.x,m.start.y,p[0],p[1]);case"C":return qt.getPointOnCubicBezier((0,r.t2length)(o,qt.getPathLength(a),_=>(0,r.getCubicArcLength)([m.start.x,p[0],p[2],p[4]],[m.start.y,p[1],p[3],p[5]],_)),m.start.x,m.start.y,p[0],p[1],p[2],p[3],p[4],p[5]);case"Q":return qt.getPointOnQuadraticBezier((0,r.t2length)(o,qt.getPathLength(a),_=>(0,r.getQuadraticArcLength)([m.start.x,p[0],p[2]],[m.start.y,p[1],p[3]],_)),m.start.x,m.start.y,p[0],p[1],p[2],p[3]);case"A":const u=p[0],f=p[1],y=p[2],S=p[3],w=p[5],g=p[6];let l=p[4];return l+=w*o/m.pathLength,qt.getPointOnEllipticalArc(u,f,y,S,l,g)}return null}static getPointOnLine(o,a,c,d,h,m,p){m=m??a,p=p??c;const u=this.getLineLength(a,c,d,h);if(u<1e-10)return{x:a,y:c};if(d===a)return{x:m,y:p+(h>c?o:-o)};const f=(h-c)/(d-a),y=Math.sqrt(o*o/(1+f*f))*(d<a?-1:1),S=f*y;if(Math.abs(p-c-f*(m-a))<1e-10)return{x:m+y,y:p+S};const w=((m-a)*(d-a)+(p-c)*(h-c))/(u*u),g=a+w*(d-a),l=c+w*(h-c),_=this.getLineLength(m,p,g,l),v=Math.sqrt(o*o-_*_),T=Math.sqrt(v*v/(1+f*f))*(d<a?-1:1),I=f*T;return{x:g+T,y:l+I}}static getPointOnCubicBezier(o,a,c,d,h,m,p,u,f){function y(v){return v*v*v}function S(v){return 3*v*v*(1-v)}function w(v){return 3*v*(1-v)*(1-v)}function g(v){return(1-v)*(1-v)*(1-v)}const l=u*y(o)+m*S(o)+d*w(o)+a*g(o),_=f*y(o)+p*S(o)+h*w(o)+c*g(o);return{x:l,y:_}}static getPointOnQuadraticBezier(o,a,c,d,h,m,p){function u(g){return g*g}function f(g){return 2*g*(1-g)}function y(g){return(1-g)*(1-g)}const S=m*u(o)+d*f(o)+a*y(o),w=p*u(o)+h*f(o)+c*y(o);return{x:S,y:w}}static getPointOnEllipticalArc(o,a,c,d,h,m){const p=Math.cos(m),u=Math.sin(m),f={x:c*Math.cos(h),y:d*Math.sin(h)};return{x:o+(f.x*p-f.y*u),y:a+(f.x*u+f.y*p)}}static parsePathData(o){if(!o)return[];let a=o;const c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let S=0;S<c.length;S++)a=a.replace(new RegExp(c[S],"g"),"|"+c[S]);const d=a.split("|"),h=[],m=[];let p=0,u=0;const f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let y;for(let S=1;S<d.length;S++){let w=d[S],g=w.charAt(0);for(w=w.slice(1),m.length=0;y=f.exec(w);)m.push(y[0]);const l=[];for(let _=0,v=m.length;_<v;_++){if(m[_]==="00"){l.push(0,0);continue}const T=parseFloat(m[_]);isNaN(T)?l.push(0):l.push(T)}for(;l.length>0&&!isNaN(l[0]);){let _="",v=[];const T=p,I=u;let C,x,R,F,D,B,V,L,Q,b;switch(g){case"l":p+=l.shift(),u+=l.shift(),_="L",v.push(p,u);break;case"L":p=l.shift(),u=l.shift(),v.push(p,u);break;case"m":const P=l.shift(),N=l.shift();if(p+=P,u+=N,_="M",h.length>2&&h[h.length-1].command==="z"){for(let A=h.length-2;A>=0;A--)if(h[A].command==="M"){p=h[A].points[0]+P,u=h[A].points[1]+N;break}}v.push(p,u),g="l";break;case"M":p=l.shift(),u=l.shift(),_="M",v.push(p,u),g="L";break;case"h":p+=l.shift(),_="L",v.push(p,u);break;case"H":p=l.shift(),_="L",v.push(p,u);break;case"v":u+=l.shift(),_="L",v.push(p,u);break;case"V":u=l.shift(),_="L",v.push(p,u);break;case"C":v.push(l.shift(),l.shift(),l.shift(),l.shift()),p=l.shift(),u=l.shift(),v.push(p,u);break;case"c":v.push(p+l.shift(),u+l.shift(),p+l.shift(),u+l.shift()),p+=l.shift(),u+=l.shift(),_="C",v.push(p,u);break;case"S":x=p,R=u,C=h[h.length-1],C.command==="C"&&(x=p+(p-C.points[2]),R=u+(u-C.points[3])),v.push(x,R,l.shift(),l.shift()),p=l.shift(),u=l.shift(),_="C",v.push(p,u);break;case"s":x=p,R=u,C=h[h.length-1],C.command==="C"&&(x=p+(p-C.points[2]),R=u+(u-C.points[3])),v.push(x,R,p+l.shift(),u+l.shift()),p+=l.shift(),u+=l.shift(),_="C",v.push(p,u);break;case"Q":v.push(l.shift(),l.shift()),p=l.shift(),u=l.shift(),v.push(p,u);break;case"q":v.push(p+l.shift(),u+l.shift()),p+=l.shift(),u+=l.shift(),_="Q",v.push(p,u);break;case"T":x=p,R=u,C=h[h.length-1],C.command==="Q"&&(x=p+(p-C.points[0]),R=u+(u-C.points[1])),p=l.shift(),u=l.shift(),_="Q",v.push(x,R,p,u);break;case"t":x=p,R=u,C=h[h.length-1],C.command==="Q"&&(x=p+(p-C.points[0]),R=u+(u-C.points[1])),p+=l.shift(),u+=l.shift(),_="Q",v.push(x,R,p,u);break;case"A":F=l.shift(),D=l.shift(),B=l.shift(),V=l.shift(),L=l.shift(),Q=p,b=u,p=l.shift(),u=l.shift(),_="A",v=this.convertEndpointToCenterParameterization(Q,b,p,u,V,L,F,D,B);break;case"a":F=l.shift(),D=l.shift(),B=l.shift(),V=l.shift(),L=l.shift(),Q=p,b=u,p+=l.shift(),u+=l.shift(),_="A",v=this.convertEndpointToCenterParameterization(Q,b,p,u,V,L,F,D,B);break}h.push({command:_||g,points:v,start:{x:T,y:I},pathLength:this.calcLength(T,I,_||g,v)})}(g==="z"||g==="Z")&&h.push({command:"z",points:[],start:void 0,pathLength:0})}return h}static calcLength(o,a,c,d){let h,m,p,u;const f=qt;switch(c){case"L":return f.getLineLength(o,a,d[0],d[1]);case"C":return(0,r.getCubicArcLength)([o,d[0],d[2],d[4]],[a,d[1],d[3],d[5]],1);case"Q":return(0,r.getQuadraticArcLength)([o,d[0],d[2]],[a,d[1],d[3]],1);case"A":h=0;const y=d[4],S=d[5],w=d[4]+S;let g=Math.PI/180;if(Math.abs(y-w)<g&&(g=Math.abs(y-w)),m=f.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],y,0),S<0)for(u=y-g;u>w;u-=g)p=f.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],u,0),h+=f.getLineLength(m.x,m.y,p.x,p.y),m=p;else for(u=y+g;u<w;u+=g)p=f.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],u,0),h+=f.getLineLength(m.x,m.y,p.x,p.y),m=p;return p=f.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],w,0),h+=f.getLineLength(m.x,m.y,p.x,p.y),h}return 0}static convertEndpointToCenterParameterization(o,a,c,d,h,m,p,u,f){const y=f*(Math.PI/180),S=Math.cos(y)*(o-c)/2+Math.sin(y)*(a-d)/2,w=-1*Math.sin(y)*(o-c)/2+Math.cos(y)*(a-d)/2,g=S*S/(p*p)+w*w/(u*u);g>1&&(p*=Math.sqrt(g),u*=Math.sqrt(g));let l=Math.sqrt((p*p*(u*u)-p*p*(w*w)-u*u*(S*S))/(p*p*(w*w)+u*u*(S*S)));h===m&&(l*=-1),isNaN(l)&&(l=0);const _=l*p*w/u,v=l*-u*S/p,T=(o+c)/2+Math.cos(y)*_-Math.sin(y)*v,I=(a+d)/2+Math.sin(y)*_+Math.cos(y)*v,C=function(L){return Math.sqrt(L[0]*L[0]+L[1]*L[1])},x=function(L,Q){return(L[0]*Q[0]+L[1]*Q[1])/(C(L)*C(Q))},R=function(L,Q){return(L[0]*Q[1]<L[1]*Q[0]?-1:1)*Math.acos(x(L,Q))},F=R([1,0],[(S-_)/p,(w-v)/u]),D=[(S-_)/p,(w-v)/u],B=[(-1*S-_)/p,(-1*w-v)/u];let V=R(D,B);return x(D,B)<=-1&&(V=Math.PI),x(D,B)>=1&&(V=0),m===0&&V>0&&(V=V-2*Math.PI),m===1&&V<0&&(V=V+2*Math.PI),[T,I,p,u,F,V,y,m]}};return Ci.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(s),t.Factory.addGetterSetter(s,"data"),Ci}var pa;function Zh(){if(pa)return vi;pa=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.Arrow=void 0;const t=yt(),e=ua(),i=bt(),r=mt(),s=Gr();let n=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const c=Math.PI*2,d=this.points();let h=d;const m=this.tension()!==0&&d.length>4;m&&(h=this.getTensionPoints());const p=this.pointerLength(),u=d.length;let f,y;if(m){const g=[h[h.length-4],h[h.length-3],h[h.length-2],h[h.length-1],d[u-2],d[u-1]],l=s.Path.calcLength(h[h.length-4],h[h.length-3],"C",g),_=s.Path.getPointOnQuadraticBezier(Math.min(1,1-p/l),g[0],g[1],g[2],g[3],g[4],g[5]);f=d[u-2]-_.x,y=d[u-1]-_.y}else f=d[u-2]-d[u-4],y=d[u-1]-d[u-3];const S=(Math.atan2(y,f)+c)%c,w=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(d[u-2],d[u-1]),a.rotate(S),a.moveTo(0,0),a.lineTo(-p,w/2),a.lineTo(-p,-w/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(d[0],d[1]),m?(f=(h[0]+h[2])/2-d[0],y=(h[1]+h[3])/2-d[1]):(f=d[2]-d[0],y=d[3]-d[1]),a.rotate((Math.atan2(-y,-f)+c)%c),a.moveTo(0,0),a.lineTo(-p,w/2),a.lineTo(-p,-w/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const c=this.dashEnabled();c&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),c&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),c=this.pointerWidth()/2;return{x:a.x,y:a.y-c,width:a.width,height:a.height+c*2}}};return vi.Arrow=n,n.prototype.className="Arrow",(0,r._registerNode)(n),t.Factory.addGetterSetter(n,"pointerLength",10,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(n,"pointerWidth",10,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(n,"pointerAtBeginning",!1),t.Factory.addGetterSetter(n,"pointerAtEnding",!0),vi}var xi={},ma;function td(){if(ma)return xi;ma=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.Circle=void 0;const t=yt(),e=Ft(),i=bt(),r=mt();let s=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}};return xi.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,i.getNumberValidator)()),xi}var wi={},_a;function ed(){if(_a)return wi;_a=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.Ellipse=void 0;const t=yt(),e=Ft(),i=bt(),r=mt();let s=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),c=this.radiusY();o.beginPath(),o.save(),a!==c&&o.scale(1,c/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return wi.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,r._registerNode)(s),t.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),t.Factory.addGetterSetter(s,"radiusX",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"radiusY",0,(0,i.getNumberValidator)()),wi}var Pi={},ya;function id(){if(ya)return Pi;ya=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.Image=void 0;const t=Tt(),e=yt(),i=Ft(),r=mt(),s=bt();let n=class dl extends i.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",c=>{this._removeImageLoad(c.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),c=this.hasShadow();return a&&c?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const c=this.getWidth(),d=this.getHeight(),h=this.cornerRadius(),m=this.attrs.image;let p;if(m){const u=this.attrs.cropWidth,f=this.attrs.cropHeight;u&&f?p=[m,this.cropX(),this.cropY(),u,f,0,0,c,d]:p=[m,0,0,c,d]}(this.hasFill()||this.hasStroke()||h)&&(a.beginPath(),h?t.Util.drawRoundedRectPath(a,c,d,h):a.rect(0,0,c,d),a.closePath(),a.fillStrokeShape(this)),m&&(h&&a.clip(),a.drawImage.apply(a,p))}_hitFunc(a){const c=this.width(),d=this.height(),h=this.cornerRadius();a.beginPath(),h?t.Util.drawRoundedRectPath(a,c,d,h):a.rect(0,0,c,d),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,c;return(a=this.attrs.width)!==null&&a!==void 0?a:(c=this.image())===null||c===void 0?void 0:c.width}getHeight(){var a,c;return(a=this.attrs.height)!==null&&a!==void 0?a:(c=this.image())===null||c===void 0?void 0:c.height}static fromURL(a,c,d=null){const h=t.Util.createImageElement();h.onload=function(){const m=new dl({image:h});c(m)},h.onerror=d,h.crossOrigin="Anonymous",h.src=a}};return Pi.Image=n,n.prototype.className="Image",(0,r._registerNode)(n),e.Factory.addGetterSetter(n,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(n,"image"),e.Factory.addComponentsGetterSetter(n,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(n,"cropX",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(n,"cropY",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(n,"cropWidth",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(n,"cropHeight",0,(0,s.getNumberValidator)()),Pi}var Ie={},ba;function nd(){if(ba)return Ie;ba=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.Tag=Ie.Label=void 0;const t=yt(),e=Ft(),i=Ir(),r=bt(),s=mt(),n=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",c="up",d="right",h="down",m="left",p=n.length;let u=class extends i.Group{constructor(S){super(S),this.on("add.konva",function(w){this._addListeners(w.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(S){let w=this,g;const l=function(){w._sync()};for(g=0;g<p;g++)S.on(n[g]+o,l)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let S=this.getText(),w=this.getTag(),g,l,_,v,T,I,C;if(S&&w){switch(g=S.width(),l=S.height(),_=w.pointerDirection(),v=w.pointerWidth(),C=w.pointerHeight(),T=0,I=0,_){case c:T=g/2,I=-1*C;break;case d:T=g+v,I=l/2;break;case h:T=g/2,I=l+C;break;case m:T=-1*v,I=l/2;break}w.setAttrs({x:-1*T,y:-1*I,width:g,height:l}),S.setAttrs({x:-1*T,y:-1*I})}}};Ie.Label=u,u.prototype.className="Label",(0,s._registerNode)(u);class f extends e.Shape{_sceneFunc(S){const w=this.width(),g=this.height(),l=this.pointerDirection(),_=this.pointerWidth(),v=this.pointerHeight(),T=this.cornerRadius();let I=0,C=0,x=0,R=0;typeof T=="number"?I=C=x=R=Math.min(T,w/2,g/2):(I=Math.min(T[0]||0,w/2,g/2),C=Math.min(T[1]||0,w/2,g/2),R=Math.min(T[2]||0,w/2,g/2),x=Math.min(T[3]||0,w/2,g/2)),S.beginPath(),S.moveTo(I,0),l===c&&(S.lineTo((w-_)/2,0),S.lineTo(w/2,-1*v),S.lineTo((w+_)/2,0)),S.lineTo(w-C,0),S.arc(w-C,C,C,Math.PI*3/2,0,!1),l===d&&(S.lineTo(w,(g-v)/2),S.lineTo(w+_,g/2),S.lineTo(w,(g+v)/2)),S.lineTo(w,g-R),S.arc(w-R,g-R,R,0,Math.PI/2,!1),l===h&&(S.lineTo((w+_)/2,g),S.lineTo(w/2,g+v),S.lineTo((w-_)/2,g)),S.lineTo(x,g),S.arc(x,g-x,x,Math.PI/2,Math.PI,!1),l===m&&(S.lineTo(0,(g+v)/2),S.lineTo(-1*_,g/2),S.lineTo(0,(g-v)/2)),S.lineTo(0,I),S.arc(I,I,I,Math.PI,Math.PI*3/2,!1),S.closePath(),S.fillStrokeShape(this)}getSelfRect(){let S=0,w=0,g=this.pointerWidth(),l=this.pointerHeight(),_=this.pointerDirection(),v=this.width(),T=this.height();return _===c?(w-=l,T+=l):_===h?T+=l:_===m?(S-=g*1.5,v+=g):_===d&&(v+=g*1.5),{x:S,y:w,width:v,height:T}}}return Ie.Tag=f,f.prototype.className="Tag",(0,s._registerNode)(f),t.Factory.addGetterSetter(f,"pointerDirection",a),t.Factory.addGetterSetter(f,"pointerWidth",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(f,"pointerHeight",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(f,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),Ie}var Ri={},va;function Sa(){if(va)return Ri;va=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.Rect=void 0;const t=yt(),e=Ft(),i=mt(),r=Tt(),s=bt();let n=class extends e.Shape{_sceneFunc(a){const c=this.cornerRadius(),d=this.width(),h=this.height();a.beginPath(),c?r.Util.drawRoundedRectPath(a,d,h,c):a.rect(0,0,d,h),a.closePath(),a.fillStrokeShape(this)}};return Ri.Rect=n,n.prototype.className="Rect",(0,i._registerNode)(n),t.Factory.addGetterSetter(n,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),Ri}var Ti={},Ca;function rd(){if(Ca)return Ti;Ca=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.RegularPolygon=void 0;const t=yt(),e=Ft(),i=bt(),r=mt();let s=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let c=1;c<a.length;c++)o.lineTo(a[c].x,a[c].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,c=[];for(let d=0;d<o;d++)c.push({x:a*Math.sin(d*2*Math.PI/o),y:-1*a*Math.cos(d*2*Math.PI/o)});return c}getSelfRect(){const o=this._getPoints();let a=o[0].x,c=o[0].y,d=o[0].x,h=o[0].y;return o.forEach(m=>{a=Math.min(a,m.x),c=Math.max(c,m.x),d=Math.min(d,m.y),h=Math.max(h,m.y)}),{x:a,y:d,width:c-a,height:h-d}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return Ti.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"sides",0,(0,i.getNumberValidator)()),Ti}var Ei={},xa;function sd(){if(xa)return Ei;xa=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.Ring=void 0;const t=yt(),e=Ft(),i=bt(),r=mt(),s=Math.PI*2;let n=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,s,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),s,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return Ei.Ring=n,n.prototype.className="Ring",n.prototype._centroid=!0,n.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,r._registerNode)(n),t.Factory.addGetterSetter(n,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(n,"outerRadius",0,(0,i.getNumberValidator)()),Ei}var Ai={},wa;function od(){if(wa)return Ai;wa=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.Sprite=void 0;const t=yt(),e=Ft(),i=Or(),r=bt(),s=mt();let n=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new i.Animation(()=>{const c=this._updated;return this._updated=!1,c}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const c=this.animation(),d=this.frameIndex(),h=d*4,m=this.animations()[c],p=this.frameOffsets(),u=m[h+0],f=m[h+1],y=m[h+2],S=m[h+3],w=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,y,S),a.closePath(),a.fillStrokeShape(this)),w)if(p){const g=p[c],l=d*2;a.drawImage(w,u,f,y,S,g[l+0],g[l+1],y,S)}else a.drawImage(w,u,f,y,S,0,0,y,S)}_hitFunc(a){const c=this.animation(),d=this.frameIndex(),h=d*4,m=this.animations()[c],p=this.frameOffsets(),u=m[h+2],f=m[h+3];if(a.beginPath(),p){const y=p[c],S=d*2;a.rect(y[S+0],y[S+1],u,f)}else a.rect(0,0,u,f);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),c=this.animation(),d=this.animations(),h=d[c],m=h.length/4;a<m-1?this.frameIndex(a+1):this.frameIndex(0)}};return Ai.Sprite=n,n.prototype.className="Sprite",(0,s._registerNode)(n),t.Factory.addGetterSetter(n,"animation"),t.Factory.addGetterSetter(n,"animations"),t.Factory.addGetterSetter(n,"frameOffsets"),t.Factory.addGetterSetter(n,"image"),t.Factory.addGetterSetter(n,"frameIndex",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"frameRate",17,(0,r.getNumberValidator)()),t.Factory.backCompat(n,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Ai}var Mi={},Pa;function ad(){if(Pa)return Mi;Pa=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.Star=void 0;const t=yt(),e=Ft(),i=bt(),r=mt();let s=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),c=this.outerRadius(),d=this.numPoints();o.beginPath(),o.moveTo(0,0-c);for(let h=1;h<d*2;h++){const m=h%2===0?c:a,p=m*Math.sin(h*Math.PI/d),u=-1*m*Math.cos(h*Math.PI/d);o.lineTo(p,u)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return Mi.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"numPoints",5,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,i.getNumberValidator)()),Mi}var qe={},Ra;function Ta(){if(Ra)return qe;Ra=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.Text=void 0,qe.stringToArray=o;const t=Tt(),e=yt(),i=Ft(),r=mt(),s=bt(),n=mt();function o(j){return[...j].reduce((G,J,ot,W)=>{if(/\p{Emoji}/u.test(J)){const M=W[ot+1];M&&/\p{Emoji_Modifier}|\u200D/u.test(M)?(G.push(J+M),W[ot+1]=""):G.push(J)}else/\p{Regional_Indicator}{2}/u.test(J+(W[ot+1]||""))?G.push(J+W[ot+1]):ot>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(J)?G[G.length-1]+=J:J&&G.push(J);return G},[])}const a="auto",c="center",d="inherit",h="justify",m="Change.konva",p="2d",u="-",f="left",y="text",S="Text",w="top",g="bottom",l="middle",_="normal",v="px ",T=" ",I="right",C="rtl",x="word",R="char",F="none",D="…",B=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],V=B.length;function L(j){return j.split(",").map(G=>{G=G.trim();const J=G.indexOf(" ")>=0,ot=G.indexOf('"')>=0||G.indexOf("'")>=0;return J&&!ot&&(G=`"${G}"`),G}).join(", ")}let Q;function b(){return Q||(Q=t.Util.createCanvasElement().getContext(p),Q)}function P(j){j.fillText(this._partialText,this._partialTextX,this._partialTextY)}function N(j){j.setAttr("miterLimit",2),j.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function A(j){return j=j||{},!j.fillLinearGradientColorStops&&!j.fillRadialGradientColorStops&&!j.fillPatternImage&&(j.fill=j.fill||"black"),j}let O=class extends i.Shape{constructor(G){super(A(G)),this._partialTextX=0,this._partialTextY=0;for(let J=0;J<V;J++)this.on(B[J]+m,this._setTextData);this._setTextData()}_sceneFunc(G){const J=this.textArr,ot=J.length;if(!this.text())return;let W=this.padding(),M=this.fontSize(),q=this.lineHeight()*M,nt=this.verticalAlign(),lt=this.direction(),dt=0,E=this.align(),k=this.getWidth(),z=this.letterSpacing(),Y=this.fill(),$=this.textDecoration(),X=$.indexOf("underline")!==-1,tt=$.indexOf("line-through")!==-1,rt;lt=lt===d?G.direction:lt;let it=q/2,Z=l;if(r.Konva._fixTextRendering){const ct=this.measureSize("M");Z="alphabetic",it=(ct.fontBoundingBoxAscent-ct.fontBoundingBoxDescent)/2+q/2}for(lt===C&&G.setAttr("direction",lt),G.setAttr("font",this._getContextFont()),G.setAttr("textBaseline",Z),G.setAttr("textAlign",f),nt===l?dt=(this.getHeight()-ot*q-W*2)/2:nt===g&&(dt=this.getHeight()-ot*q-W*2),G.translate(W,dt+W),rt=0;rt<ot;rt++){let ct=0,at=0;const H=J[rt],U=H.text,K=H.width,et=H.lastInParagraph;if(G.save(),E===I?ct+=k-K-W*2:E===c&&(ct+=(k-K-W*2)/2),X){G.save(),G.beginPath();const st=r.Konva._fixTextRendering?Math.round(M/4):Math.round(M/2),ut=ct,ht=it+at+st;G.moveTo(ut,ht);const ft=E===h&&!et?k-W*2:K;G.lineTo(ut+Math.round(ft),ht),G.lineWidth=M/15;const _t=this._getLinearGradient();G.strokeStyle=_t||Y,G.stroke(),G.restore()}if(tt){G.save(),G.beginPath();const st=r.Konva._fixTextRendering?-Math.round(M/4):0;G.moveTo(ct,it+at+st);const ut=E===h&&!et?k-W*2:K;G.lineTo(ct+Math.round(ut),it+at+st),G.lineWidth=M/15;const ht=this._getLinearGradient();G.strokeStyle=ht||Y,G.stroke(),G.restore()}if(lt!==C&&(z!==0||E===h)){const st=U.split(" ").length-1,ut=o(U);for(let ht=0;ht<ut.length;ht++){const ft=ut[ht];ft===" "&&!et&&E===h&&(ct+=(k-W*2-K)/st),this._partialTextX=ct,this._partialTextY=it+at,this._partialText=ft,G.fillStrokeShape(this),ct+=this.measureSize(ft).width+z}}else z!==0&&G.setAttr("letterSpacing",`${z}px`),this._partialTextX=ct,this._partialTextY=it+at,this._partialText=U,G.fillStrokeShape(this);G.restore(),ot>1&&(it+=q)}}_hitFunc(G){const J=this.getWidth(),ot=this.getHeight();G.beginPath(),G.rect(0,0,J,ot),G.closePath(),G.fillStrokeShape(this)}setText(G){const J=t.Util._isString(G)?G:G==null?"":G+"";return this._setAttr(y,J),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(G){var J,ot,W,M,q,nt,lt,dt,E,k,z;let Y=b(),$=this.fontSize(),X;Y.save(),Y.font=this._getContextFont(),X=Y.measureText(G),Y.restore();const tt=$/100;return{actualBoundingBoxAscent:(J=X.actualBoundingBoxAscent)!==null&&J!==void 0?J:71.58203125*tt,actualBoundingBoxDescent:(ot=X.actualBoundingBoxDescent)!==null&&ot!==void 0?ot:0,actualBoundingBoxLeft:(W=X.actualBoundingBoxLeft)!==null&&W!==void 0?W:-7.421875*tt,actualBoundingBoxRight:(M=X.actualBoundingBoxRight)!==null&&M!==void 0?M:75.732421875*tt,alphabeticBaseline:(q=X.alphabeticBaseline)!==null&&q!==void 0?q:0,emHeightAscent:(nt=X.emHeightAscent)!==null&&nt!==void 0?nt:100*tt,emHeightDescent:(lt=X.emHeightDescent)!==null&&lt!==void 0?lt:-20*tt,fontBoundingBoxAscent:(dt=X.fontBoundingBoxAscent)!==null&&dt!==void 0?dt:91*tt,fontBoundingBoxDescent:(E=X.fontBoundingBoxDescent)!==null&&E!==void 0?E:21*tt,hangingBaseline:(k=X.hangingBaseline)!==null&&k!==void 0?k:72.80000305175781*tt,ideographicBaseline:(z=X.ideographicBaseline)!==null&&z!==void 0?z:-21*tt,width:X.width,height:$}}_getContextFont(){return this.fontStyle()+T+this.fontVariant()+T+(this.fontSize()+v)+L(this.fontFamily())}_addTextLine(G){this.align()===h&&(G=G.trim());const ot=this._getTextWidth(G);return this.textArr.push({text:G,width:ot,lastInParagraph:!1})}_getTextWidth(G){const J=this.letterSpacing(),ot=G.length;return b().measureText(G).width+J*ot}_setTextData(){let G=this.text().split(`
`),J=+this.fontSize(),ot=0,W=this.lineHeight()*J,M=this.attrs.width,q=this.attrs.height,nt=M!==a&&M!==void 0,lt=q!==a&&q!==void 0,dt=this.padding(),E=M-dt*2,k=q-dt*2,z=0,Y=this.wrap(),$=Y!==F,X=Y!==R&&$,tt=this.ellipsis();this.textArr=[],b().font=this._getContextFont();const rt=tt?this._getTextWidth(D):0;for(let it=0,Z=G.length;it<Z;++it){let ct=G[it],at=this._getTextWidth(ct);if(nt&&at>E)for(;ct.length>0;){let H=0,U=o(ct).length,K="",et=0;for(;H<U;){const st=H+U>>>1,ut=o(ct),ht=ut.slice(0,st+1).join(""),ft=this._getTextWidth(ht);(tt&&lt&&z+W>k?ft+rt:ft)<=E?(H=st+1,K=ht,et=ft):U=st}if(K){if(X){const ht=o(ct),ft=o(K),_t=ht[ft.length],Ct=_t===T||_t===u;let Mt;if(Ct&&et<=E)Mt=ft.length;else{const It=ft.lastIndexOf(T),zt=ft.lastIndexOf(u);Mt=Math.max(It,zt)+1}Mt>0&&(H=Mt,K=ht.slice(0,H).join(""),et=this._getTextWidth(K))}if(K=K.trimRight(),this._addTextLine(K),ot=Math.max(ot,et),z+=W,this._shouldHandleEllipsis(z)){this._tryToAddEllipsisToLastLine();break}if(ct=o(ct).slice(H).join("").trimLeft(),ct.length>0&&(at=this._getTextWidth(ct),at<=E)){this._addTextLine(ct),z+=W,ot=Math.max(ot,at);break}}else break}else this._addTextLine(ct),z+=W,ot=Math.max(ot,at),this._shouldHandleEllipsis(z)&&it<Z-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),lt&&z+W>k)break}this.textHeight=J,this.textWidth=ot}_shouldHandleEllipsis(G){const J=+this.fontSize(),ot=this.lineHeight()*J,W=this.attrs.height,M=W!==a&&W!==void 0,q=this.padding(),nt=W-q*2;return!(this.wrap()!==F)||M&&G+ot>nt}_tryToAddEllipsisToLastLine(){const G=this.attrs.width,J=G!==a&&G!==void 0,ot=this.padding(),W=G-ot*2,M=this.ellipsis(),q=this.textArr[this.textArr.length-1];!q||!M||(J&&(this._getTextWidth(q.text+D)<W||(q.text=q.text.slice(0,q.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(q.text+D))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const G=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,J=this.hasShadow();return G&&J?!0:super._useBufferCanvas()}};return qe.Text=O,O.prototype._fillFunc=P,O.prototype._strokeFunc=N,O.prototype.className=S,O.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,n._registerNode)(O),e.Factory.overWriteSetter(O,"width",(0,s.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(O,"height",(0,s.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(O,"direction",d),e.Factory.addGetterSetter(O,"fontFamily","Arial"),e.Factory.addGetterSetter(O,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"fontStyle",_),e.Factory.addGetterSetter(O,"fontVariant",_),e.Factory.addGetterSetter(O,"padding",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"align",f),e.Factory.addGetterSetter(O,"verticalAlign",w),e.Factory.addGetterSetter(O,"lineHeight",1,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"wrap",x),e.Factory.addGetterSetter(O,"ellipsis",!1,(0,s.getBooleanValidator)()),e.Factory.addGetterSetter(O,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(O,"text","",(0,s.getStringValidator)()),e.Factory.addGetterSetter(O,"textDecoration",""),qe}var Ni={},Ea;function ld(){if(Ea)return Ni;Ea=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.TextPath=void 0;const t=Tt(),e=yt(),i=Ft(),r=Gr(),s=Ta(),n=bt(),o=mt(),a="",c="normal";function d(p){p.fillText(this.partialText,0,0)}function h(p){p.strokeText(this.partialText,0,0)}let m=class extends i.Shape{constructor(u){super(u),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return r.Path.getPathLength(this.dataArray)}_getPointAtLength(u){if(!this.attrs.data)return null;const f=this.pathLength;return u-1>f?null:r.Path.getPointAtLengthOfDataArray(u,this.dataArray)}_readDataAttribute(){this.dataArray=r.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(u){u.setAttr("font",this._getContextFont()),u.setAttr("textBaseline",this.textBaseline()),u.setAttr("textAlign","left"),u.save();const f=this.textDecoration(),y=this.fill(),S=this.fontSize(),w=this.glyphInfo;f==="underline"&&u.beginPath();for(let g=0;g<w.length;g++){u.save();const l=w[g].p0;u.translate(l.x,l.y),u.rotate(w[g].rotation),this.partialText=w[g].text,u.fillStrokeShape(this),f==="underline"&&(g===0&&u.moveTo(0,S/2+1),u.lineTo(S,S/2+1)),u.restore()}f==="underline"&&(u.strokeStyle=y,u.lineWidth=S/20,u.stroke()),u.restore()}_hitFunc(u){u.beginPath();const f=this.glyphInfo;if(f.length>=1){const y=f[0].p0;u.moveTo(y.x,y.y)}for(let y=0;y<f.length;y++){const S=f[y].p1;u.lineTo(S.x,S.y)}u.setAttr("lineWidth",this.fontSize()),u.setAttr("strokeStyle",this.colorKey),u.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(u){return s.Text.prototype.setText.call(this,u)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(u){const y=this.dummyCanvas.getContext("2d");y.save(),y.font=this._getContextFont();const S=y.measureText(u);return y.restore(),{width:S.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:u,height:f}=this._getTextSize(this.attrs.text);if(this.textWidth=u,this.textHeight=f,this.glyphInfo=[],!this.attrs.data)return null;const y=this.letterSpacing(),S=this.align(),w=this.kerningFunc(),g=Math.max(this.textWidth+((this.attrs.text||"").length-1)*y,0);let l=0;S==="center"&&(l=Math.max(0,this.pathLength/2-g/2)),S==="right"&&(l=Math.max(0,this.pathLength-g));const _=(0,s.stringToArray)(this.text());let v=l;for(let T=0;T<_.length;T++){const I=this._getPointAtLength(v);if(!I)return;let C=this._getTextSize(_[T]).width+y;if(_[T]===" "&&S==="justify"){const V=this.text().split(" ").length-1;C+=(this.pathLength-g)/V}const x=this._getPointAtLength(v+C);if(!x)return;const R=r.Path.getLineLength(I.x,I.y,x.x,x.y);let F=0;if(w)try{F=w(_[T-1],_[T])*this.fontSize()}catch{F=0}I.x+=F,x.x+=F,this.textWidth+=F;const D=r.Path.getPointOnLine(F+R/2,I.x,I.y,x.x,x.y),B=Math.atan2(x.y-I.y,x.x-I.x);this.glyphInfo.push({transposeX:D.x,transposeY:D.y,text:_[T],rotation:B,p0:I,p1:x}),v+=C}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const u=[];this.glyphInfo.forEach(function(v){u.push(v.p0.x),u.push(v.p0.y),u.push(v.p1.x),u.push(v.p1.y)});let f=u[0]||0,y=u[0]||0,S=u[1]||0,w=u[1]||0,g,l;for(let v=0;v<u.length/2;v++)g=u[v*2],l=u[v*2+1],f=Math.min(f,g),y=Math.max(y,g),S=Math.min(S,l),w=Math.max(w,l);const _=this.fontSize();return{x:f-_/2,y:S-_/2,width:y-f+_,height:w-S+_}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Ni.TextPath=m,m.prototype._fillFunc=d,m.prototype._strokeFunc=h,m.prototype._fillFuncHit=d,m.prototype._strokeFuncHit=h,m.prototype.className="TextPath",m.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(m),e.Factory.addGetterSetter(m,"data"),e.Factory.addGetterSetter(m,"fontFamily","Arial"),e.Factory.addGetterSetter(m,"fontSize",12,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(m,"fontStyle",c),e.Factory.addGetterSetter(m,"align","left"),e.Factory.addGetterSetter(m,"letterSpacing",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(m,"textBaseline","middle"),e.Factory.addGetterSetter(m,"fontVariant",c),e.Factory.addGetterSetter(m,"text",a),e.Factory.addGetterSetter(m,"textDecoration",""),e.Factory.addGetterSetter(m,"kerningFunc",void 0),Ni}var Fi={},Aa;function cd(){if(Aa)return Fi;Aa=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.Transformer=void 0;const t=Tt(),e=yt(),i=At(),r=Ft(),s=Sa(),n=Ir(),o=mt(),a=bt(),c=mt(),d="tr-konva",h=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(C=>C+`.${d}`).join(" "),m="nodesRect",p=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],u={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},f="ontouchstart"in o.Konva._global;function y(C,x,R){if(C==="rotater")return R;x+=t.Util.degToRad(u[C]||0);const F=(t.Util.radToDeg(x)%360+360)%360;return t.Util._inRange(F,337.5,360)||t.Util._inRange(F,0,22.5)?"ns-resize":t.Util._inRange(F,22.5,67.5)?"nesw-resize":t.Util._inRange(F,67.5,112.5)?"ew-resize":t.Util._inRange(F,112.5,157.5)?"nwse-resize":t.Util._inRange(F,157.5,202.5)?"ns-resize":t.Util._inRange(F,202.5,247.5)?"nesw-resize":t.Util._inRange(F,247.5,292.5)?"ew-resize":t.Util._inRange(F,292.5,337.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+F),"pointer")}const S=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function w(C){return{x:C.x+C.width/2*Math.cos(C.rotation)+C.height/2*Math.sin(-C.rotation),y:C.y+C.height/2*Math.cos(C.rotation)+C.width/2*Math.sin(C.rotation)}}function g(C,x,R){const F=R.x+(C.x-R.x)*Math.cos(x)-(C.y-R.y)*Math.sin(x),D=R.y+(C.x-R.x)*Math.sin(x)+(C.y-R.y)*Math.cos(x);return{...C,rotation:C.rotation+x,x:F,y:D}}function l(C,x){const R=w(C);return g(C,x,R)}function _(C,x,R){let F=x;for(let D=0;D<C.length;D++){const B=o.Konva.getAngle(C[D]),V=Math.abs(B-x)%(Math.PI*2);Math.min(V,Math.PI*2-V)<R&&(F=B)}return F}let v=0,T=class extends n.Group{constructor(x){super(x),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(h,this.update),this.getNode()&&this.update()}attachTo(x){return this.setNode(x),this}setNode(x){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([x])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return d+this._id}setNodes(x=[]){this._nodes&&this._nodes.length&&this.detach();const R=x.filter(D=>D.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=x=R,x.length===1&&this.useSingleNodeRotation()?this.rotation(x[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(D=>{const B=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(D._attrsAffectingSize.length){const V=D._attrsAffectingSize.map(L=>L+"Change."+this._getEventNamespace()).join(" ");D.on(V,B)}D.on(p.map(V=>V+`.${this._getEventNamespace()}`).join(" "),B),D.on(`absoluteTransformChange.${this._getEventNamespace()}`,B),this._proxyDrag(D)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(x){let R;x.on(`dragstart.${this._getEventNamespace()}`,F=>{R=x.getAbsolutePosition(),!this.isDragging()&&x!==this.findOne(".back")&&this.startDrag(F,!1)}),x.on(`dragmove.${this._getEventNamespace()}`,F=>{if(!R)return;const D=x.getAbsolutePosition(),B=D.x-R.x,V=D.y-R.y;this.nodes().forEach(L=>{if(L===x||L.isDragging())return;const Q=L.getAbsolutePosition();L.setAbsolutePosition({x:Q.x+B,y:Q.y+V}),L.startDrag(F)}),R=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(x=>{x.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(m),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(m,this.__getNodeRect)}__getNodeShape(x,R=this.rotation(),F){const D=x.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),B=x.getAbsoluteScale(F),V=x.getAbsolutePosition(F),L=D.x*B.x-x.offsetX()*B.x,Q=D.y*B.y-x.offsetY()*B.y,b=(o.Konva.getAngle(x.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),P={x:V.x+L*Math.cos(b)+Q*Math.sin(-b),y:V.y+Q*Math.cos(b)+L*Math.sin(b),width:D.width*B.x,height:D.height*B.y,rotation:b};return g(P,-o.Konva.getAngle(R),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const R=[];this.nodes().map(b=>{const P=b.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),N=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}],A=b.getAbsoluteTransform();N.forEach(function(O){const j=A.point(O);R.push(j)})});const F=new t.Transform;F.rotate(-o.Konva.getAngle(this.rotation()));let D=1/0,B=1/0,V=-1/0,L=-1/0;R.forEach(function(b){const P=F.point(b);D===void 0&&(D=V=P.x,B=L=P.y),D=Math.min(D,P.x),B=Math.min(B,P.y),V=Math.max(V,P.x),L=Math.max(L,P.y)}),F.invert();const Q=F.point({x:D,y:B});return{x:Q.x,y:Q.y,width:V-D,height:L-B,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S.forEach(x=>{this._createAnchor(x)}),this._createAnchor("rotater")}_createAnchor(x){const R=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:x+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:f?10:"auto"}),F=this;R.on("mousedown touchstart",function(D){F._handleMouseDown(D)}),R.on("dragstart",D=>{R.stopDrag(),D.cancelBubble=!0}),R.on("dragend",D=>{D.cancelBubble=!0}),R.on("mouseenter",()=>{const D=o.Konva.getAngle(this.rotation()),B=this.rotateAnchorCursor(),V=y(x,D,B);R.getStage().content&&(R.getStage().content.style.cursor=V),this._cursorChange=!0}),R.on("mouseout",()=>{R.getStage().content&&(R.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(R)}_createBack(){const x=new r.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(R,F){const D=F.getParent(),B=D.padding();R.beginPath(),R.rect(-B,-B,F.width()+B*2,F.height()+B*2),R.moveTo(F.width()/2,-B),D.rotateEnabled()&&D.rotateLineVisible()&&R.lineTo(F.width()/2,-D.rotateAnchorOffset()*t.Util._sign(F.height())-B),R.fillStrokeShape(F)},hitFunc:(R,F)=>{if(!this.shouldOverdrawWholeArea())return;const D=this.padding();R.beginPath(),R.rect(-D,-D,F.width()+D*2,F.height()+D*2),R.fillStrokeShape(F)}});this.add(x),this._proxyDrag(x),x.on("dragstart",R=>{R.cancelBubble=!0}),x.on("dragmove",R=>{R.cancelBubble=!0}),x.on("dragend",R=>{R.cancelBubble=!0}),this.on("dragmove",R=>{this.update()})}_handleMouseDown(x){if(this._transforming)return;this._movingAnchorName=x.target.name().split(" ")[0];const R=this._getNodeRect(),F=R.width,D=R.height,B=Math.sqrt(Math.pow(F,2)+Math.pow(D,2));this.sin=Math.abs(D/B),this.cos=Math.abs(F/B),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const V=x.target.getAbsolutePosition(),L=x.target.getStage().getPointerPosition();this._anchorDragOffset={x:L.x-V.x,y:L.y-V.y},v++,this._fire("transformstart",{evt:x.evt,target:this.getNode()}),this._nodes.forEach(Q=>{Q._fire("transformstart",{evt:x.evt,target:Q})})}_handleMouseMove(x){let R,F,D;const B=this.findOne("."+this._movingAnchorName),V=B.getStage();V.setPointersPositions(x);const L=V.getPointerPosition();let Q={x:L.x-this._anchorDragOffset.x,y:L.y-this._anchorDragOffset.y};const b=B.getAbsolutePosition();this.anchorDragBoundFunc()&&(Q=this.anchorDragBoundFunc()(b,Q,x)),B.setAbsolutePosition(Q);const P=B.getAbsolutePosition();if(b.x===P.x&&b.y===P.y)return;if(this._movingAnchorName==="rotater"){const W=this._getNodeRect();R=B.x()-W.width/2,F=-B.y()+W.height/2;let M=Math.atan2(-F,R)+Math.PI/2;W.height<0&&(M-=Math.PI);const nt=o.Konva.getAngle(this.rotation())+M,lt=o.Konva.getAngle(this.rotationSnapTolerance()),E=_(this.rotationSnaps(),nt,lt)-W.rotation,k=l(W,E);this._fitNodesInto(k,x);return}const N=this.shiftBehavior();let A;N==="inverted"?A=this.keepRatio()&&!x.shiftKey:N==="none"?A=this.keepRatio():A=this.keepRatio()||x.shiftKey;let O=this.centeredScaling()||x.altKey;if(this._movingAnchorName==="top-left"){if(A){const W=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};D=Math.sqrt(Math.pow(W.x-B.x(),2)+Math.pow(W.y-B.y(),2));const M=this.findOne(".top-left").x()>W.x?-1:1,q=this.findOne(".top-left").y()>W.y?-1:1;R=D*this.cos*M,F=D*this.sin*q,this.findOne(".top-left").x(W.x-R),this.findOne(".top-left").y(W.y-F)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(B.y());else if(this._movingAnchorName==="top-right"){if(A){const W=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};D=Math.sqrt(Math.pow(B.x()-W.x,2)+Math.pow(W.y-B.y(),2));const M=this.findOne(".top-right").x()<W.x?-1:1,q=this.findOne(".top-right").y()>W.y?-1:1;R=D*this.cos*M,F=D*this.sin*q,this.findOne(".top-right").x(W.x+R),this.findOne(".top-right").y(W.y-F)}var j=B.position();this.findOne(".top-left").y(j.y),this.findOne(".bottom-right").x(j.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(B.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(B.x());else if(this._movingAnchorName==="bottom-left"){if(A){const W=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};D=Math.sqrt(Math.pow(W.x-B.x(),2)+Math.pow(B.y()-W.y,2));const M=W.x<B.x()?-1:1,q=B.y()<W.y?-1:1;R=D*this.cos*M,F=D*this.sin*q,B.x(W.x-R),B.y(W.y+F)}j=B.position(),this.findOne(".top-left").x(j.x),this.findOne(".bottom-right").y(j.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(B.y());else if(this._movingAnchorName==="bottom-right"){if(A){const W=O?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};D=Math.sqrt(Math.pow(B.x()-W.x,2)+Math.pow(B.y()-W.y,2));const M=this.findOne(".bottom-right").x()<W.x?-1:1,q=this.findOne(".bottom-right").y()<W.y?-1:1;R=D*this.cos*M,F=D*this.sin*q,this.findOne(".bottom-right").x(W.x+R),this.findOne(".bottom-right").y(W.y+F)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(O=this.centeredScaling()||x.altKey,O){const W=this.findOne(".top-left"),M=this.findOne(".bottom-right"),q=W.x(),nt=W.y(),lt=this.getWidth()-M.x(),dt=this.getHeight()-M.y();M.move({x:-q,y:-nt}),W.move({x:lt,y:dt})}const G=this.findOne(".top-left").getAbsolutePosition();R=G.x,F=G.y;const J=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),ot=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:R,y:F,width:J,height:ot,rotation:o.Konva.getAngle(this.rotation())},x)}_handleMouseUp(x){this._removeEvents(x)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(x){var R;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const F=this.getNode();v--,this._fire("transformend",{evt:x,target:F}),(R=this.getLayer())===null||R===void 0||R.batchDraw(),F&&this._nodes.forEach(D=>{var B;D._fire("transformend",{evt:x,target:D}),(B=D.getLayer())===null||B===void 0||B.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(x,R){const F=this._getNodeRect(),D=1;if(t.Util._inRange(x.width,-this.padding()*2-D,D)){this.update();return}if(t.Util._inRange(x.height,-this.padding()*2-D,D)){this.update();return}const B=new t.Transform;if(B.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&x.width<0&&this._movingAnchorName.indexOf("left")>=0){const A=B.point({x:-this.padding()*2,y:0});x.x+=A.x,x.y+=A.y,x.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y}else if(this._movingAnchorName&&x.width<0&&this._movingAnchorName.indexOf("right")>=0){const A=B.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,x.width+=this.padding()*2}if(this._movingAnchorName&&x.height<0&&this._movingAnchorName.indexOf("top")>=0){const A=B.point({x:0,y:-this.padding()*2});x.x+=A.x,x.y+=A.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,x.height+=this.padding()*2}else if(this._movingAnchorName&&x.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const A=B.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=A.x,this._anchorDragOffset.y-=A.y,x.height+=this.padding()*2}if(this.boundBoxFunc()){const A=this.boundBoxFunc()(F,x);A?x=A:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const V=1e7,L=new t.Transform;L.translate(F.x,F.y),L.rotate(F.rotation),L.scale(F.width/V,F.height/V);const Q=new t.Transform,b=x.width/V,P=x.height/V;this.flipEnabled()===!1?(Q.translate(x.x,x.y),Q.rotate(x.rotation),Q.translate(x.width<0?x.width:0,x.height<0?x.height:0),Q.scale(Math.abs(b),Math.abs(P))):(Q.translate(x.x,x.y),Q.rotate(x.rotation),Q.scale(b,P));const N=Q.multiply(L.invert());this._nodes.forEach(A=>{var O;const j=A.getParent().getAbsoluteTransform(),G=A.getTransform().copy();G.translate(A.offsetX(),A.offsetY());const J=new t.Transform;J.multiply(j.copy().invert()).multiply(N).multiply(j).multiply(G);const ot=J.decompose();A.setAttrs(ot),(O=A.getLayer())===null||O===void 0||O.batchDraw()}),this.rotation(t.Util._getRotation(x.rotation)),this._nodes.forEach(A=>{this._fire("transform",{evt:R,target:A}),A._fire("transform",{evt:R,target:A})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(x,R){this.findOne(x).setAttrs(R)}update(){var x;const R=this._getNodeRect();this.rotation(t.Util._getRotation(R.rotation));const F=R.width,D=R.height,B=this.enabledAnchors(),V=this.resizeEnabled(),L=this.padding(),Q=this.anchorSize(),b=this.find("._anchor");b.forEach(N=>{N.setAttrs({width:Q,height:Q,offsetX:Q/2,offsetY:Q/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:Q/2+L,offsetY:Q/2+L,visible:V&&B.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:F/2,y:0,offsetY:Q/2+L,visible:V&&B.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:F,y:0,offsetX:Q/2-L,offsetY:Q/2+L,visible:V&&B.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:D/2,offsetX:Q/2+L,visible:V&&B.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:F,y:D/2,offsetX:Q/2-L,visible:V&&B.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:D,offsetX:Q/2+L,offsetY:Q/2-L,visible:V&&B.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:F/2,y:D,offsetY:Q/2-L,visible:V&&B.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:F,y:D,offsetX:Q/2-L,offsetY:Q/2-L,visible:V&&B.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:F/2,y:-this.rotateAnchorOffset()*t.Util._sign(D)-L,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:F,height:D,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const P=this.anchorStyleFunc();P&&b.forEach(N=>{P(N)}),(x=this.getLayer())===null||x===void 0||x.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const x=this.findOne("."+this._movingAnchorName);x&&x.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),n.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return i.Node.prototype.toObject.call(this)}clone(x){return i.Node.prototype.clone.call(this,x)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Fi.Transformer=T,T.isTransforming=()=>v>0;function I(C){return C instanceof Array||t.Util.warn("enabledAnchors value should be an array"),C instanceof Array&&C.forEach(function(x){S.indexOf(x)===-1&&t.Util.warn("Unknown anchor name: "+x+". Available names are: "+S.join(", "))}),C||[]}return T.prototype.className="Transformer",(0,c._registerNode)(T),e.Factory.addGetterSetter(T,"enabledAnchors",S,I),e.Factory.addGetterSetter(T,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(T,"resizeEnabled",!0),e.Factory.addGetterSetter(T,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(T,"rotateEnabled",!0),e.Factory.addGetterSetter(T,"rotateLineVisible",!0),e.Factory.addGetterSetter(T,"rotationSnaps",[]),e.Factory.addGetterSetter(T,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(T,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(T,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(T,"borderEnabled",!0),e.Factory.addGetterSetter(T,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(T,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(T,"anchorFill","white"),e.Factory.addGetterSetter(T,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(T,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(T,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(T,"borderDash"),e.Factory.addGetterSetter(T,"keepRatio",!0),e.Factory.addGetterSetter(T,"shiftBehavior","default"),e.Factory.addGetterSetter(T,"centeredScaling",!1),e.Factory.addGetterSetter(T,"ignoreStroke",!1),e.Factory.addGetterSetter(T,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(T,"nodes"),e.Factory.addGetterSetter(T,"node"),e.Factory.addGetterSetter(T,"boundBoxFunc"),e.Factory.addGetterSetter(T,"anchorDragBoundFunc"),e.Factory.addGetterSetter(T,"anchorStyleFunc"),e.Factory.addGetterSetter(T,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(T,"useSingleNodeRotation",!0),e.Factory.backCompat(T,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Fi}var ki={},Ma;function hd(){if(Ma)return ki;Ma=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.Wedge=void 0;const t=yt(),e=Ft(),i=mt(),r=bt(),s=mt();let n=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,i.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return ki.Wedge=n,n.prototype.className="Wedge",n.prototype._centroid=!0,n.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(n),t.Factory.addGetterSetter(n,"radius",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"angle",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"clockwise",!1),t.Factory.backCompat(n,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),ki}var Ii={},Na;function dd(){if(Na)return Ii;Na=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.Blur=void 0;const t=yt(),e=At(),i=bt();function r(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],n=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(c,d){const h=c.data,m=c.width,p=c.height;let u,f,y,S,w,g,l,_,v,T,I,C,x,R,F,D,B,V,L,Q;const b=d+d+1,P=m-1,N=p-1,A=d+1,O=A*(A+1)/2,j=new r,G=s[d],J=n[d];let ot=null,W=j,M=null,q=null;for(let nt=1;nt<b;nt++)W=W.next=new r,nt===A&&(ot=W);W.next=j,y=f=0;for(let nt=0;nt<p;nt++){C=x=R=F=S=w=g=l=0,_=A*(D=h[f]),v=A*(B=h[f+1]),T=A*(V=h[f+2]),I=A*(L=h[f+3]),S+=O*D,w+=O*B,g+=O*V,l+=O*L,W=j;for(let lt=0;lt<A;lt++)W.r=D,W.g=B,W.b=V,W.a=L,W=W.next;for(let lt=1;lt<A;lt++)u=f+((P<lt?P:lt)<<2),S+=(W.r=D=h[u])*(Q=A-lt),w+=(W.g=B=h[u+1])*Q,g+=(W.b=V=h[u+2])*Q,l+=(W.a=L=h[u+3])*Q,C+=D,x+=B,R+=V,F+=L,W=W.next;M=j,q=ot;for(let lt=0;lt<m;lt++)h[f+3]=L=l*G>>J,L!==0?(L=255/L,h[f]=(S*G>>J)*L,h[f+1]=(w*G>>J)*L,h[f+2]=(g*G>>J)*L):h[f]=h[f+1]=h[f+2]=0,S-=_,w-=v,g-=T,l-=I,_-=M.r,v-=M.g,T-=M.b,I-=M.a,u=y+((u=lt+d+1)<P?u:P)<<2,C+=M.r=h[u],x+=M.g=h[u+1],R+=M.b=h[u+2],F+=M.a=h[u+3],S+=C,w+=x,g+=R,l+=F,M=M.next,_+=D=q.r,v+=B=q.g,T+=V=q.b,I+=L=q.a,C-=D,x-=B,R-=V,F-=L,q=q.next,f+=4;y+=m}for(let nt=0;nt<m;nt++){x=R=F=C=w=g=l=S=0,f=nt<<2,_=A*(D=h[f]),v=A*(B=h[f+1]),T=A*(V=h[f+2]),I=A*(L=h[f+3]),S+=O*D,w+=O*B,g+=O*V,l+=O*L,W=j;for(let dt=0;dt<A;dt++)W.r=D,W.g=B,W.b=V,W.a=L,W=W.next;let lt=m;for(let dt=1;dt<=d;dt++)f=lt+nt<<2,S+=(W.r=D=h[f])*(Q=A-dt),w+=(W.g=B=h[f+1])*Q,g+=(W.b=V=h[f+2])*Q,l+=(W.a=L=h[f+3])*Q,C+=D,x+=B,R+=V,F+=L,W=W.next,dt<N&&(lt+=m);f=nt,M=j,q=ot;for(let dt=0;dt<p;dt++)u=f<<2,h[u+3]=L=l*G>>J,L>0?(L=255/L,h[u]=(S*G>>J)*L,h[u+1]=(w*G>>J)*L,h[u+2]=(g*G>>J)*L):h[u]=h[u+1]=h[u+2]=0,S-=_,w-=v,g-=T,l-=I,_-=M.r,v-=M.g,T-=M.b,I-=M.a,u=nt+((u=dt+A)<N?u:N)*m<<2,S+=C+=M.r=h[u],w+=x+=M.g=h[u+1],g+=R+=M.b=h[u+2],l+=F+=M.a=h[u+3],M=M.next,_+=D=q.r,v+=B=q.g,T+=V=q.b,I+=L=q.a,C-=D,x-=B,R-=V,F-=L,q=q.next,f+=m}}const a=function(d){const h=Math.round(this.blurRadius());h>0&&o(d,h)};return Ii.Blur=a,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Ii}var Oi={},Fa;function ud(){if(Fa)return Oi;Fa=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.Brighten=void 0;const t=yt(),e=At(),i=bt(),r=function(s){const n=this.brightness()*255,o=s.data,a=o.length;for(let c=0;c<a;c+=4)o[c]+=n,o[c+1]+=n,o[c+2]+=n};return Oi.Brighten=r,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Oi}var Di={},ka;function fd(){if(ka)return Di;ka=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.Contrast=void 0;const t=yt(),e=At(),i=bt(),r=function(s){const n=Math.pow((this.contrast()+100)/100,2),o=s.data,a=o.length;let c=150,d=150,h=150;for(let m=0;m<a;m+=4)c=o[m],d=o[m+1],h=o[m+2],c/=255,c-=.5,c*=n,c+=.5,c*=255,d/=255,d-=.5,d*=n,d+=.5,d*=255,h/=255,h-=.5,h*=n,h+=.5,h*=255,c=c<0?0:c>255?255:c,d=d<0?0:d>255?255:d,h=h<0?0:h>255?255:h,o[m]=c,o[m+1]=d,o[m+2]=h};return Di.Contrast=r,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Di}var Li={},Ia;function gd(){if(Ia)return Li;Ia=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.Emboss=void 0;const t=yt(),e=At(),i=Tt(),r=bt(),s=function(n){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,c=this.embossDirection(),d=this.embossBlend(),h=n.data,m=n.width,p=n.height,u=m*4;let f=0,y=0,S=p;switch(c){case"top-left":f=-1,y=-1;break;case"top":f=-1,y=0;break;case"top-right":f=-1,y=1;break;case"right":f=0,y=1;break;case"bottom-right":f=1,y=1;break;case"bottom":f=1,y=0;break;case"bottom-left":f=1,y=-1;break;case"left":f=0,y=-1;break;default:i.Util.error("Unknown emboss direction: "+c)}do{const w=(S-1)*u;let g=f;S+g<1&&(g=0),S+g>p&&(g=0);const l=(S-1+g)*m*4;let _=m;do{const v=w+(_-1)*4;let T=y;_+T<1&&(T=0),_+T>m&&(T=0);const I=l+(_-1+T)*4,C=h[v]-h[I],x=h[v+1]-h[I+1],R=h[v+2]-h[I+2];let F=C;const D=F>0?F:-F,B=x>0?x:-x,V=R>0?R:-R;if(B>D&&(F=x),V>D&&(F=R),F*=o,d){const L=h[v]+F,Q=h[v+1]+F,b=h[v+2]+F;h[v]=L>255?255:L<0?0:L,h[v+1]=Q>255?255:Q<0?0:Q,h[v+2]=b>255?255:b<0?0:b}else{let L=a-F;L<0?L=0:L>255&&(L=255),h[v]=h[v+1]=h[v+2]=L}}while(--_)}while(--S)};return Li.Emboss=s,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),Li}var Gi={},Oa;function pd(){if(Oa)return Gi;Oa=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.Enhance=void 0;const t=yt(),e=At(),i=bt();function r(n,o,a,c,d){const h=a-o,m=d-c;if(h===0)return c+m/2;if(m===0)return c;let p=(n-o)/h;return p=m*p+c,p}const s=function(n){const o=n.data,a=o.length;let c=o[0],d=c,h,m=o[1],p=m,u,f=o[2],y=f,S;const w=this.enhance();if(w===0)return;for(let C=0;C<a;C+=4)h=o[C+0],h<c?c=h:h>d&&(d=h),u=o[C+1],u<m?m=u:u>p&&(p=u),S=o[C+2],S<f?f=S:S>y&&(y=S);d===c&&(d=255,c=0),p===m&&(p=255,m=0),y===f&&(y=255,f=0);let g,l,_,v,T,I;if(w>0)g=d+w*(255-d),l=c-w*(c-0),_=p+w*(255-p),v=m-w*(m-0),T=y+w*(255-y),I=f-w*(f-0);else{const C=(d+c)*.5;g=d+w*(d-C),l=c+w*(c-C);const x=(p+m)*.5;_=p+w*(p-x),v=m+w*(m-x);const R=(y+f)*.5;T=y+w*(y-R),I=f+w*(f-R)}for(let C=0;C<a;C+=4)o[C+0]=r(o[C+0],c,d,l,g),o[C+1]=r(o[C+1],m,p,v,_),o[C+2]=r(o[C+2],f,y,I,T)};return Gi.Enhance=s,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Gi}var Ui={},Da;function md(){if(Da)return Ui;Da=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.Grayscale=void 0;const t=function(e){const i=e.data,r=i.length;for(let s=0;s<r;s+=4){const n=.34*i[s]+.5*i[s+1]+.16*i[s+2];i[s]=n,i[s+1]=n,i[s+2]=n}};return Ui.Grayscale=t,Ui}var Bi={},La;function _d(){if(La)return Bi;La=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.HSL=void 0;const t=yt(),e=At(),i=bt();t.Factory.addGetterSetter(e.Node,"hue",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter);const r=function(s){const n=s.data,o=n.length,a=1,c=Math.pow(2,this.saturation()),d=Math.abs(this.hue()+360)%360,h=this.luminance()*127,m=a*c*Math.cos(d*Math.PI/180),p=a*c*Math.sin(d*Math.PI/180),u=.299*a+.701*m+.167*p,f=.587*a-.587*m+.33*p,y=.114*a-.114*m-.497*p,S=.299*a-.299*m-.328*p,w=.587*a+.413*m+.035*p,g=.114*a-.114*m+.293*p,l=.299*a-.3*m+1.25*p,_=.587*a-.586*m-1.05*p,v=.114*a+.886*m-.2*p;let T,I,C,x;for(let R=0;R<o;R+=4)T=n[R+0],I=n[R+1],C=n[R+2],x=n[R+3],n[R+0]=u*T+f*I+y*C+h,n[R+1]=S*T+w*I+g*C+h,n[R+2]=l*T+_*I+v*C+h,n[R+3]=x};return Bi.HSL=r,Bi}var Hi={},Ga;function yd(){if(Ga)return Hi;Ga=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.HSV=void 0;const t=yt(),e=At(),i=bt(),r=function(s){const n=s.data,o=n.length,a=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),d=Math.abs(this.hue()+360)%360,h=a*c*Math.cos(d*Math.PI/180),m=a*c*Math.sin(d*Math.PI/180),p=.299*a+.701*h+.167*m,u=.587*a-.587*h+.33*m,f=.114*a-.114*h-.497*m,y=.299*a-.299*h-.328*m,S=.587*a+.413*h+.035*m,w=.114*a-.114*h+.293*m,g=.299*a-.3*h+1.25*m,l=.587*a-.586*h-1.05*m,_=.114*a+.886*h-.2*m;for(let v=0;v<o;v+=4){const T=n[v+0],I=n[v+1],C=n[v+2],x=n[v+3];n[v+0]=p*T+u*I+f*C,n[v+1]=y*T+S*I+w*C,n[v+2]=g*T+l*I+_*C,n[v+3]=x}};return Hi.HSV=r,t.Factory.addGetterSetter(e.Node,"hue",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Hi}var Vi={},Ua;function bd(){if(Ua)return Vi;Ua=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.Invert=void 0;const t=function(e){const i=e.data,r=i.length;for(let s=0;s<r;s+=4)i[s]=255-i[s],i[s+1]=255-i[s+1],i[s+2]=255-i[s+2]};return Vi.Invert=t,Vi}var zi={},Ba;function vd(){if(Ba)return zi;Ba=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.Kaleidoscope=void 0;const t=yt(),e=At(),i=Tt(),r=bt(),s=function(a,c,d){const h=a.data,m=c.data,p=a.width,u=a.height,f=d.polarCenterX||p/2,y=d.polarCenterY||u/2;let S=Math.sqrt(f*f+y*y),w=p-f,g=u-y;const l=Math.sqrt(w*w+g*g);S=l>S?l:S;const _=u,v=p,T=360/v*Math.PI/180;for(let I=0;I<v;I+=1){const C=Math.sin(I*T),x=Math.cos(I*T);for(let R=0;R<_;R+=1){w=Math.floor(f+S*R/_*x),g=Math.floor(y+S*R/_*C);let F=(g*p+w)*4;const D=h[F+0],B=h[F+1],V=h[F+2],L=h[F+3];F=(I+R*p)*4,m[F+0]=D,m[F+1]=B,m[F+2]=V,m[F+3]=L}}},n=function(a,c,d){const h=a.data,m=c.data,p=a.width,u=a.height,f=d.polarCenterX||p/2,y=d.polarCenterY||u/2;let S=Math.sqrt(f*f+y*y),w=p-f,g=u-y;const l=Math.sqrt(w*w+g*g);S=l>S?l:S;const _=u,v=p,T=0;let I,C;for(w=0;w<p;w+=1)for(g=0;g<u;g+=1){const x=w-f,R=g-y,F=Math.sqrt(x*x+R*R)*_/S;let D=(Math.atan2(R,x)*180/Math.PI+360+T)%360;D=D*v/360,I=Math.floor(D),C=Math.floor(F);let B=(C*p+I)*4;const V=h[B+0],L=h[B+1],Q=h[B+2],b=h[B+3];B=(g*p+w)*4,m[B+0]=V,m[B+1]=L,m[B+2]=Q,m[B+3]=b}},o=function(a){const c=a.width,d=a.height;let h,m,p,u,f,y,S,w,g,l,_=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),T=Math.floor(c*(v%360)/360);if(_<1)return;const I=i.Util.createCanvasElement();I.width=c,I.height=d;const C=I.getContext("2d").getImageData(0,0,c,d);i.Util.releaseCanvas(I),s(a,C,{polarCenterX:c/2,polarCenterY:d/2});let x=c/Math.pow(2,_);for(;x<=8;)x=x*2,_-=1;x=Math.ceil(x);let R=x,F=0,D=R,B=1;for(T+x>c&&(F=R,D=0,B=-1),m=0;m<d;m+=1)for(h=F;h!==D;h+=B)p=Math.round(h+T)%c,g=(c*m+p)*4,f=C.data[g+0],y=C.data[g+1],S=C.data[g+2],w=C.data[g+3],l=(c*m+h)*4,C.data[l+0]=f,C.data[l+1]=y,C.data[l+2]=S,C.data[l+3]=w;for(m=0;m<d;m+=1)for(R=Math.floor(x),u=0;u<_;u+=1){for(h=0;h<R+1;h+=1)g=(c*m+h)*4,f=C.data[g+0],y=C.data[g+1],S=C.data[g+2],w=C.data[g+3],l=(c*m+R*2-h-1)*4,C.data[l+0]=f,C.data[l+1]=y,C.data[l+2]=S,C.data[l+3]=w;R*=2}n(C,a,{})};return zi.Kaleidoscope=o,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),zi}var qi={},Ha;function Sd(){if(Ha)return qi;Ha=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.Mask=void 0;const t=yt(),e=At(),i=bt();function r(p,u,f){let y=(f*p.width+u)*4;const S=[];return S.push(p.data[y++],p.data[y++],p.data[y++],p.data[y++]),S}function s(p,u){return Math.sqrt(Math.pow(p[0]-u[0],2)+Math.pow(p[1]-u[1],2)+Math.pow(p[2]-u[2],2))}function n(p){const u=[0,0,0];for(let f=0;f<p.length;f++)u[0]+=p[f][0],u[1]+=p[f][1],u[2]+=p[f][2];return u[0]/=p.length,u[1]/=p.length,u[2]/=p.length,u}function o(p,u){const f=r(p,0,0),y=r(p,p.width-1,0),S=r(p,0,p.height-1),w=r(p,p.width-1,p.height-1),g=u||10;if(s(f,y)<g&&s(y,w)<g&&s(w,S)<g&&s(S,f)<g){const l=n([y,f,w,S]),_=[];for(let v=0;v<p.width*p.height;v++){const T=s(l,[p.data[v*4],p.data[v*4+1],p.data[v*4+2]]);_[v]=T<g?0:255}return _}}function a(p,u){for(let f=0;f<p.width*p.height;f++)p.data[4*f+3]=u[f]}function c(p,u,f){const y=[1,1,1,1,0,1,1,1,1],S=Math.round(Math.sqrt(y.length)),w=Math.floor(S/2),g=[];for(let l=0;l<f;l++)for(let _=0;_<u;_++){const v=l*u+_;let T=0;for(let I=0;I<S;I++)for(let C=0;C<S;C++){const x=l+I-w,R=_+C-w;if(x>=0&&x<f&&R>=0&&R<u){const F=x*u+R,D=y[I*S+C];T+=p[F]*D}}g[v]=T===2040?255:0}return g}function d(p,u,f){const y=[1,1,1,1,1,1,1,1,1],S=Math.round(Math.sqrt(y.length)),w=Math.floor(S/2),g=[];for(let l=0;l<f;l++)for(let _=0;_<u;_++){const v=l*u+_;let T=0;for(let I=0;I<S;I++)for(let C=0;C<S;C++){const x=l+I-w,R=_+C-w;if(x>=0&&x<f&&R>=0&&R<u){const F=x*u+R,D=y[I*S+C];T+=p[F]*D}}g[v]=T>=1020?255:0}return g}function h(p,u,f){const y=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],S=Math.round(Math.sqrt(y.length)),w=Math.floor(S/2),g=[];for(let l=0;l<f;l++)for(let _=0;_<u;_++){const v=l*u+_;let T=0;for(let I=0;I<S;I++)for(let C=0;C<S;C++){const x=l+I-w,R=_+C-w;if(x>=0&&x<f&&R>=0&&R<u){const F=x*u+R,D=y[I*S+C];T+=p[F]*D}}g[v]=T}return g}const m=function(p){const u=this.threshold();let f=o(p,u);return f&&(f=c(f,p.width,p.height),f=d(f,p.width,p.height),f=h(f,p.width,p.height),a(p,f)),p};return qi.Mask=m,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),qi}var Wi={},Va;function Cd(){if(Va)return Wi;Va=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.Noise=void 0;const t=yt(),e=At(),i=bt(),r=function(s){const n=this.noise()*255,o=s.data,a=o.length,c=n/2;for(let d=0;d<a;d+=4)o[d+0]+=c-2*c*Math.random(),o[d+1]+=c-2*c*Math.random(),o[d+2]+=c-2*c*Math.random()};return Wi.Noise=r,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Wi}var Ki={},za;function xd(){if(za)return Ki;za=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.Pixelate=void 0;const t=yt(),e=Tt(),i=At(),r=bt(),s=function(n){let o=Math.ceil(this.pixelSize()),a=n.width,c=n.height,d=Math.ceil(a/o),h=Math.ceil(c/o),m=n.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let p=0;p<d;p+=1)for(let u=0;u<h;u+=1){let f=0,y=0,S=0,w=0;const g=p*o,l=g+o,_=u*o,v=_+o;let T=0;for(let I=g;I<l;I+=1)if(!(I>=a))for(let C=_;C<v;C+=1){if(C>=c)continue;const x=(a*C+I)*4;f+=m[x+0],y+=m[x+1],S+=m[x+2],w+=m[x+3],T+=1}f=f/T,y=y/T,S=S/T,w=w/T;for(let I=g;I<l;I+=1)if(!(I>=a))for(let C=_;C<v;C+=1){if(C>=c)continue;const x=(a*C+I)*4;m[x+0]=f,m[x+1]=y,m[x+2]=S,m[x+3]=w}}};return Ki.Pixelate=s,t.Factory.addGetterSetter(i.Node,"pixelSize",8,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),Ki}var ji={},qa;function wd(){if(qa)return ji;qa=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.Posterize=void 0;const t=yt(),e=At(),i=bt(),r=function(s){const n=Math.round(this.levels()*254)+1,o=s.data,a=o.length,c=255/n;for(let d=0;d<a;d+=1)o[d]=Math.floor(o[d]/c)*c};return ji.Posterize=r,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),ji}var Yi={},Wa;function Pd(){if(Wa)return Yi;Wa=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.RGB=void 0;const t=yt(),e=At(),i=bt(),r=function(s){const n=s.data,o=n.length,a=this.red(),c=this.green(),d=this.blue();for(let h=0;h<o;h+=4){const m=(.34*n[h]+.5*n[h+1]+.16*n[h+2])/255;n[h]=m*a,n[h+1]=m*c,n[h+2]=m*d,n[h+3]=n[h+3]}};return Yi.RGB=r,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,i.RGBComponent,t.Factory.afterSetFilter),Yi}var Xi={},Ka;function Rd(){if(Ka)return Xi;Ka=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.RGBA=void 0;const t=yt(),e=At(),i=bt(),r=function(s){const n=s.data,o=n.length,a=this.red(),c=this.green(),d=this.blue(),h=this.alpha();for(let m=0;m<o;m+=4){const p=1-h;n[m]=a*h+n[m]*p,n[m+1]=c*h+n[m+1]*p,n[m+2]=d*h+n[m+2]*p}};return Xi.RGBA=r,t.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),t.Factory.addGetterSetter(e.Node,"blue",0,i.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),Xi}var $i={},ja;function Td(){if(ja)return $i;ja=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.Sepia=void 0;const t=function(e){const i=e.data,r=i.length;for(let s=0;s<r;s+=4){const n=i[s+0],o=i[s+1],a=i[s+2];i[s+0]=Math.min(255,n*.393+o*.769+a*.189),i[s+1]=Math.min(255,n*.349+o*.686+a*.168),i[s+2]=Math.min(255,n*.272+o*.534+a*.131)}};return $i.Sepia=t,$i}var Qi={},Ya;function Ed(){if(Ya)return Qi;Ya=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.Solarize=void 0;const t=function(e){const i=e.data,r=e.width,s=e.height,n=r*4;let o=s;do{const a=(o-1)*n;let c=r;do{const d=a+(c-1)*4;let h=i[d],m=i[d+1],p=i[d+2];h>127&&(h=255-h),m>127&&(m=255-m),p>127&&(p=255-p),i[d]=h,i[d+1]=m,i[d+2]=p}while(--c)}while(--o)};return Qi.Solarize=t,Qi}var Ji={},Xa;function Ad(){if(Xa)return Ji;Xa=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.Threshold=void 0;const t=yt(),e=At(),i=bt(),r=function(s){const n=this.threshold()*255,o=s.data,a=o.length;for(let c=0;c<a;c+=1)o[c]=o[c]<n?0:255};return Ji.Threshold=r,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Ji}var $a;function Md(){if($a)return ui;$a=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Konva=void 0;const t=$h(),e=Qh(),i=Zh(),r=td(),s=ed(),n=id(),o=nd(),a=ua(),c=Gr(),d=Sa(),h=rd(),m=sd(),p=od(),u=ad(),f=Ta(),y=ld(),S=cd(),w=hd(),g=dd(),l=ud(),_=fd(),v=gd(),T=pd(),I=md(),C=_d(),x=yd(),R=bd(),F=vd(),D=Sd(),B=Cd(),V=xd(),L=wd(),Q=Pd(),b=Rd(),P=Td(),N=Ed(),A=Ad();return ui.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:i.Arrow,Circle:r.Circle,Ellipse:s.Ellipse,Image:n.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:c.Path,Rect:d.Rect,RegularPolygon:h.RegularPolygon,Ring:m.Ring,Sprite:p.Sprite,Star:u.Star,Text:f.Text,TextPath:y.TextPath,Transformer:S.Transformer,Wedge:w.Wedge,Filters:{Blur:g.Blur,Brighten:l.Brighten,Contrast:_.Contrast,Emboss:v.Emboss,Enhance:T.Enhance,Grayscale:I.Grayscale,HSL:C.HSL,HSV:x.HSV,Invert:R.Invert,Kaleidoscope:F.Kaleidoscope,Mask:D.Mask,Noise:B.Noise,Pixelate:V.Pixelate,Posterize:L.Posterize,RGB:Q.RGB,RGBA:b.RGBA,Sepia:P.Sepia,Solarize:N.Solarize,Threshold:A.Threshold}}),ui}var Nd=Fn.exports,Qa;function Fd(){if(Qa)return Fn.exports;Qa=1,Object.defineProperty(Nd,"__esModule",{value:!0});const t=Md();return Fn.exports=t.Konva,Fn.exports}var kd=Fd();const Dt=Kh(kd),Id=()=>({stage:void 0,konvaContainer:void 0,notes:new Map,selection:{selectedIds:new Set,selectionRect:void 0},viewport:{scrollX:0,scrollY:55*20,zoomX:1,zoomY:1},grid:{quarterNoteWidth:120,noteHeight:20,baseQuarterNoteWidth:120,baseNoteHeight:20,subdivision:16,numMeasures:100,timeSignature:4,maxLength:64,backgroundColor1:"#ddd",backgroundColor2:"#bbb",noteColor:"#f23",selectedNoteColor:"#2ee"},interaction:{isDragging:!1,dragStartPos:void 0,draggedNoteInitialStates:new Map,quantDragActivated:!1,dragBeforeState:void 0,isResizing:!1,resizeTargetId:void 0,resizeIsEnd:!1,resizeInitialStates:new Map,quantResizeActivated:!1,resizeBeforeState:void 0,isMarqueeSelecting:!1,marqueeStart:void 0,marqueeCurrent:void 0,marqueeIsShift:!1,hiddenNoteIds:new Set,truncatedNotes:new Map},command:{stack:void 0},layers:{grid:void 0,notes:void 0,overlay:void 0},renderCache:{grid:{lastScrollX:-1,lastScrollY:-1,lastSubdivision:-1,lastQuarterNoteWidth:-1,lastNoteHeight:-1}},needsRedraw:!1,rafHandle:void 0,queuePlayhead:{position:0,element:void 0},livePlayhead:{position:0,element:void 0},notifyExternalChange:void 0}),Od=(t="note_")=>`${t}${Date.now()}_${Math.random().toString(36).substr(2,9)}`;function Ja(t,e){const{scrollX:i,scrollY:r}=e.viewport,{quarterNoteWidth:s,noteHeight:n}=e.grid,o=t.x+i,a=t.y+r,c=o/s;return{pitch:127-Math.floor(a/n),position:c}}function On(t,e,i){const{scrollX:r,scrollY:s}=i.viewport,{quarterNoteWidth:n,noteHeight:o}=i.grid,a=e*n,c=(127-t)*o;return{x:a-r,y:c-s}}function Za(t,e){const i=e/4;return Math.floor(t*i)/i}function tl(t){return t.grid.quarterNoteWidth*(4/t.grid.subdivision)}function el(t,e){const{scrollX:i,scrollY:r}=e.viewport,{quarterNoteWidth:s,noteHeight:n}=e.grid,o=e.stage;if(!o)return!1;const a=o.width(),c=o.height(),d=i/s,h=(i+a)/s,m=Math.floor(r/n),p=Math.ceil((r+c)/n),u=t.position+t.duration,f=127-t.pitch;return!(u<d||t.position>h||f<m||f>p)}function Dd(t,e){const{scrollX:i,scrollY:r}=t.viewport,{quarterNoteWidth:s,noteHeight:n}=t.grid,o=[];return t.notes.forEach((a,c)=>{const d=On(a.pitch,a.position,t),h=a.duration*s,m=d.x+h,p=d.y+n,u=e.x+e.width,f=e.y+e.height;!(m<e.x||d.x>u||p<e.y||d.y>f)&&o.push(c)}),o}function il(t){t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear(),t.selection.selectedIds.forEach(e=>{const i=t.notes.get(e);if(!i)return;const r=i.position+i.duration;t.notes.forEach((s,n)=>{if(t.selection.selectedIds.has(n)||s.pitch!==i.pitch)return;const o=s.position+s.duration;if(s.position<i.position&&i.position<o){const a=i.position-s.position;t.interaction.truncatedNotes.set(n,a)}else i.position<=s.position&&s.position<r&&t.interaction.hiddenNoteIds.add(n)})})}function Ld(t,e,i){return t.interaction.truncatedNotes.get(e)??i}function nl(t){t.interaction.hiddenNoteIds.forEach(e=>{t.notes.delete(e)}),t.interaction.truncatedNotes.forEach((e,i)=>{const r=t.notes.get(i);r&&(r.duration=e)})}function rl(t){t.interaction.truncatedNotes.clear(),t.interaction.hiddenNoteIds.clear()}function Gd(t){let i=null;for(const r of t.selection.selectedIds){const s=t.notes.get(r);if(!s)continue;let n=1/0,o=null;if(t.notes.forEach((a,c)=>{if(t.selection.selectedIds.has(c))return;const d=Math.abs(s.position-a.position);d<n&&d<.1&&(n=d,o=a.position)}),o!==null){i=o-s.position;break}}i!==null&&t.selection.selectedIds.forEach(r=>{const s=t.notes.get(r);s&&(s.position+=i)})}const Ud=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function sl(t){return Ud[t%12]+(Math.floor(t/12)-2)}class Bd{constructor(e,i,r){this.captureState=e,this.restoreState=i,this.onChangeCallback=r}stack=[];currentIndex=-1;onChangeCallback;executeCommand(e,i){const r=this.captureState();i();const s=this.captureState();r!==s&&this.pushCommand(e,r,s)}pushCommand(e,i,r){this.stack=this.stack.slice(0,this.currentIndex+1),this.stack.push({name:e,beforeState:i,afterState:r}),this.currentIndex++,this.onChangeCallback?.()}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.stack.length-1}undo(){if(!this.canUndo())return;const e=this.stack[this.currentIndex];this.restoreState(e.beforeState),this.currentIndex--,this.onChangeCallback?.()}redo(){if(!this.canRedo())return;this.currentIndex++;const e=this.stack[this.currentIndex];this.restoreState(e.afterState),this.onChangeCallback?.()}clear(){this.stack=[],this.currentIndex=-1,this.onChangeCallback?.()}}function Zi(t){return JSON.stringify({notes:Array.from(t.notes.entries()),selection:Array.from(t.selection.selectedIds)})}function Hd(t,e){const i=JSON.parse(e);t.notes=new Map(i.notes),t.selection.selectedIds=new Set(i.selection),t.needsRedraw=!0}function Vd(t,e){if(t.size!==e.size)return!0;for(const i of t)if(!e.has(i))return!0;return!1}function Ur(t,e){const i=new Set(t.selection.selectedIds);e();const r=Vd(i,t.selection.selectedIds);return r&&t.notifyExternalChange?.(),r}function zd(t,e,i){const r=new Dt.Layer({listening:!1,name:"grid-layer"});e.add(r),t.layers.grid=r;const s=new Dt.Layer({name:"notes-layer"});e.add(s),t.layers.notes=s;const n=new Dt.Layer({name:"overlay-layer"});e.add(n),t.layers.overlay=n,t.selection.selectionRect=new Dt.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),n.add(t.selection.selectionRect);const o=128*t.grid.noteHeight;t.queuePlayhead.element=new Dt.Line({points:[0,0,0,o],stroke:"#00ff00",strokeWidth:2,listening:!1}),n.add(t.queuePlayhead.element),t.livePlayhead.element=new Dt.Line({points:[0,0,0,o],stroke:"#ff8800",strokeWidth:2,listening:!1}),n.add(t.livePlayhead.element),t.command.stack=new Bd(()=>Zi(t),a=>Hd(t,a),()=>{t.needsRedraw=!0,i?.()})}function qd(t){const e=t.layers.grid;if(!e||!t.stage)return;const i=t.renderCache.grid;if(i.lastScrollX===t.viewport.scrollX&&i.lastScrollY===t.viewport.scrollY&&i.lastSubdivision===t.grid.subdivision&&i.lastQuarterNoteWidth===t.grid.quarterNoteWidth&&i.lastNoteHeight===t.grid.noteHeight)return;i.lastScrollX=t.viewport.scrollX,i.lastScrollY=t.viewport.scrollY,i.lastSubdivision=t.grid.subdivision,i.lastQuarterNoteWidth=t.grid.quarterNoteWidth,i.lastNoteHeight=t.grid.noteHeight,e.destroyChildren();const{scrollX:r,scrollY:s}=t.viewport,{quarterNoteWidth:n,noteHeight:o,numMeasures:a,timeSignature:c}=t.grid,d=t.stage,h=d.width(),m=d.height(),p=128*o,u=c*4,f=n*u,y=Math.floor(r/f),S=Math.ceil((r+h)/f);for(let I=y;I<=S&&I<a;I++){const C=I%2===0?t.grid.backgroundColor1:t.grid.backgroundColor2,x=I*f-r;e.add(new Dt.Rect({x,y:-s,width:f,height:p,fill:C,listening:!1}))}const w=a*u*(t.grid.subdivision/4),g=n*(4/t.grid.subdivision),l=Math.floor(r/g),_=Math.ceil((r+h)/g);for(let I=l;I<=_&&I<w;I++){const C=I*g-r,R=I*g%n===0?1.8:1;e.add(new Dt.Line({points:[C,-s,C,p-s],stroke:"#000",strokeWidth:R,listening:!1}))}const v=Math.floor(s/o),T=Math.ceil((s+m)/o);for(let I=v;I<=T&&I<128;I++){const C=I*o-s;e.add(new Dt.Line({points:[0-r,C,a*f-r,C],stroke:"#000",strokeWidth:1,listening:!1}))}e.batchDraw()}function Wd(t){const e=t.layers.notes;if(!e||!t.stage)return;e.destroyChildren();const{scrollX:i,scrollY:r}=t.viewport,{quarterNoteWidth:s,noteHeight:n}=t.grid,o=[],a=[];t.notes.forEach((c,d)=>{el(c,t)&&(t.selection.selectedIds.has(d)?a.push([d,c]):o.push([d,c]))}),o.forEach(([c,d])=>{const h=On(d.pitch,d.position,t),p=Ld(t,c,d.duration)*s,u=t.interaction.hiddenNoteIds.has(c),f=new Dt.Rect({x:h.x,y:h.y,width:p,height:n,fill:t.grid.noteColor,stroke:"#000",strokeWidth:1,opacity:u?.3:1,listening:!0});f.setAttr("noteId",c),e.add(f);const y=sl(d.pitch),S=new Dt.Text({x:h.x+4,y:h.y+2,text:y,fontSize:14,fill:"#000",listening:!1});e.add(S)}),a.forEach(([c,d])=>{const h=On(d.pitch,d.position,t),m=d.duration*s,p=t.interaction.hiddenNoteIds.has(c),u=new Dt.Rect({x:h.x,y:h.y,width:m,height:n,fill:t.grid.selectedNoteColor,stroke:"#000",strokeWidth:1,opacity:p?.3:1,listening:!0});u.setAttr("noteId",c),e.add(u);const f=sl(d.pitch),y=new Dt.Text({x:h.x+4,y:h.y+2,text:f,fontSize:14,fill:"#000",listening:!1});e.add(y)}),e.batchDraw()}function Kd(t){const e=t.layers.notes;if(!e)return;const{quarterNoteWidth:i,noteHeight:r}=t.grid,s=5;e.find(".resize-handle").forEach(n=>n.destroy()),t.selection.selectedIds.forEach(n=>{const o=t.notes.get(n);if(!o||!el(o,t))return;const a=On(o.pitch,o.position,t),c=o.duration*i,d=new Dt.Circle({x:a.x,y:a.y+r/2,radius:s,fill:"#000",listening:!0,name:"resize-handle"});d.setAttr("handleNoteId",n),d.setAttr("handleIsEnd",!1),e.add(d);const h=new Dt.Circle({x:a.x+c,y:a.y+r/2,radius:s,fill:"#000",listening:!0,name:"resize-handle"});h.setAttr("handleNoteId",n),h.setAttr("handleIsEnd",!0),e.add(h)}),e.batchDraw()}function jd(t){if(!t.selection.selectionRect||!t.interaction.marqueeStart||!t.interaction.marqueeCurrent)return;const e=t.interaction.marqueeStart,i=t.interaction.marqueeCurrent,r=Math.min(e.x,i.x),s=Math.min(e.y,i.y),n=Math.abs(i.x-e.x),o=Math.abs(i.y-e.y);t.selection.selectionRect.setAttrs({x:r,y:s,width:n,height:o,visible:n>5||o>5}),t.layers.overlay?.batchDraw()}function Yd(t){if(!t.queuePlayhead.element)return;const{scrollX:e}=t.viewport,i=t.queuePlayhead.position*t.grid.quarterNoteWidth-e;t.queuePlayhead.element.x(i),t.layers.overlay?.batchDraw()}function Xd(t){if(!t.livePlayhead.element)return;const{scrollX:e}=t.viewport,i=t.livePlayhead.position*t.grid.quarterNoteWidth-e;t.livePlayhead.element.x(i),t.layers.overlay?.batchDraw()}function $d(t,e){t.layers.notes;const i=t.layers.grid;e.on("dblclick",r=>{if(r.target===e||r.target.getLayer()===i){const s=e.getPointerPosition();if(!s)return;const{pitch:n,position:o}=Ja(s,t),a=Za(o,t.grid.subdivision),c=Math.round(n);t.command.stack?.executeCommand("Add Note",()=>{const d={id:Od(),pitch:c,position:a,duration:4/t.grid.subdivision,velocity:.8};t.notes.set(d.id,d),t.needsRedraw=!0})}}),e.on("mousedown touchstart",r=>{const s=r.target,n=s.getAttr?.("handleNoteId");if(n){const a=s.getAttr("handleIsEnd");tu(t,e,n,a);return}const o=s.getAttr?.("noteId");if(o){const a=r.evt.shiftKey||r.evt.ctrlKey,c=t.selection.selectedIds.has(o);Ur(t,()=>{a?c?t.selection.selectedIds.delete(o):t.selection.selectedIds.add(o):(!c||t.selection.selectedIds.size>1)&&(t.selection.selectedIds.clear(),t.selection.selectedIds.add(o))}),Qd(t,e),t.needsRedraw=!0;return}if(s===e||s.getLayer()===i){const a=e.getPointerPosition();if(!a)return;t.interaction.isMarqueeSelecting=!0,t.interaction.marqueeStart=a,t.interaction.marqueeCurrent=a,t.interaction.marqueeIsShift=r.evt.shiftKey||r.evt.ctrlKey,t.interaction.marqueeIsShift||Ur(t,()=>{t.selection.selectedIds.clear()}),t.needsRedraw=!0}}),e.on("mousemove touchmove",r=>{const s=e.getPointerPosition();if(s){if(t.interaction.isDragging){Jd(t,e);return}if(t.interaction.isResizing){eu(t,e);return}if(t.interaction.isMarqueeSelecting){t.interaction.marqueeCurrent=s,jd(t);const n={x:Math.min(t.interaction.marqueeStart.x,s.x),y:Math.min(t.interaction.marqueeStart.y,s.y),width:Math.abs(s.x-t.interaction.marqueeStart.x),height:Math.abs(s.y-t.interaction.marqueeStart.y)},o=Dd(t,n);Ur(t,()=>{t.interaction.marqueeIsShift?o.forEach(a=>{t.selection.selectedIds.add(a)}):(t.selection.selectedIds.clear(),o.forEach(a=>{t.selection.selectedIds.add(a)}))}),t.needsRedraw=!0}}}),e.on("mouseup touchend",r=>{if(t.interaction.isDragging){Zd(t);return}if(t.interaction.isResizing){iu(t);return}if(t.interaction.isMarqueeSelecting){const s=t.interaction.marqueeStart&&t.interaction.marqueeCurrent&&Math.abs(t.interaction.marqueeStart.x-t.interaction.marqueeCurrent.x)<5&&Math.abs(t.interaction.marqueeStart.y-t.interaction.marqueeCurrent.y)<5;if(t.interaction.isMarqueeSelecting=!1,t.selection.selectionRect&&(t.selection.selectionRect.visible(!1),t.layers.overlay?.batchDraw()),s&&r.target===e||r.target.getLayer()===i){const n=e.getPointerPosition();if(n){const{position:o}=Ja(n,t),a=Za(o,t.grid.subdivision);t.queuePlayhead.position=Math.max(0,Math.min(a,t.grid.maxLength)),t.needsRedraw=!0,t.notifyExternalChange?.()}}}})}function Qd(t,e){const i=e.getPointerPosition();i&&(t.interaction.isDragging=!0,t.interaction.dragStartPos=i,t.interaction.quantDragActivated=!1,t.interaction.dragBeforeState=Zi(t),t.interaction.draggedNoteInitialStates.clear(),t.selection.selectedIds.forEach(r=>{const s=t.notes.get(r);s&&t.interaction.draggedNoteInitialStates.set(r,{position:s.position,pitch:s.pitch})}))}function Jd(t,e){const i=e.getPointerPosition();if(!i||!t.interaction.dragStartPos)return;const r=i.x-t.interaction.dragStartPos.x,s=i.y-t.interaction.dragStartPos.y,n=tl(t);let o;Math.abs(r)<n*.9&&!t.interaction.quantDragActivated?o=r:(o=Math.round(r/n)*n,t.interaction.quantDragActivated=!0);const a=Math.round(s/t.grid.noteHeight);t.interaction.draggedNoteInitialStates.forEach((c,d)=>{const h=t.notes.get(d);h&&(h.position=c.position+o/t.grid.quarterNoteWidth,h.pitch=Math.max(0,Math.min(127,c.pitch-a)))}),Gd(t),il(t),t.needsRedraw=!0}function Zd(t){nl(t);const e=Zi(t);t.interaction.dragBeforeState&&t.interaction.dragBeforeState!==e&&t.command.stack?.pushCommand("Move Notes",t.interaction.dragBeforeState,e),t.interaction.isDragging=!1,rl(t),t.needsRedraw=!0}function tu(t,e,i,r){const s=e.getPointerPosition();s&&(t.interaction.isResizing=!0,t.interaction.resizeTargetId=i,t.interaction.resizeIsEnd=r,t.interaction.quantResizeActivated=!1,t.interaction.dragStartPos=s,t.interaction.resizeBeforeState=Zi(t),t.interaction.resizeInitialStates.clear(),t.selection.selectedIds.forEach(n=>{const o=t.notes.get(n);o&&t.interaction.resizeInitialStates.set(n,{position:o.position,duration:o.duration})}))}function eu(t,e){const i=e.getPointerPosition();if(!i||!t.interaction.dragStartPos)return;const r=i.x-t.interaction.dragStartPos.x,s=tl(t);let n;Math.abs(r)<s*.9&&!t.interaction.quantResizeActivated?n=r:(n=Math.round(r/s)*s,t.interaction.quantResizeActivated=!0);const o=n/t.grid.quarterNoteWidth;t.interaction.resizeInitialStates.forEach((a,c)=>{const d=t.notes.get(c);d&&(t.interaction.resizeIsEnd?d.duration=Math.max(.25,a.duration+o):(d.position=a.position+o,d.duration=Math.max(.25,a.duration-o)))}),il(t),t.needsRedraw=!0}function iu(t){nl(t);const e=Zi(t);t.interaction.resizeBeforeState&&t.interaction.resizeBeforeState!==e&&t.command.stack?.pushCommand("Resize Notes",t.interaction.resizeBeforeState,e),t.interaction.isResizing=!1,rl(t),t.needsRedraw=!0}const nu={class:"piano-roll-root"},ru={key:0,class:"control-panel"},su=["disabled"],ou=["disabled"],au=["disabled"],lu=["disabled"],cu={class:"info"},hu={class:"piano-roll-layout"},du={class:"stage-wrapper"},We=.25,Ke=1,Ht=128,ol=4,al=12,uu=55,fu=((t,e)=>{const i=t.__vccOpts||t;for(const[r,s]of e)i[r]=s;return i})(Is({__name:"PianoRollRoot",props:{width:{default:640,type:Number},height:{default:360,type:Number},initialNotes:{default:()=>[],type:Array},syncState:{type:Function},showControlPanel:{type:Boolean,default:!0},interactive:{type:Boolean,default:!0}},emits:["notes-update"],setup(t,{expose:e,emit:i}){const r=t,s=i,n=Id();n.viewport=ei(n.viewport),n.grid=ei(n.grid);const o=ee(),a=ee(),c=ee(),d=ee(!1),h=ee(!1),m=ee(n.grid.subdivision),p=ee(n.notes.size),u=ee(n.selection.selectedIds.size),f=ke(()=>r.interactive),y=ke(()=>r.showControlPanel);let S=!1,w=!1;const g=()=>{p.value=n.notes.size,u.value=n.selection.selectedIds.size},l=(H,U,K)=>K<U?U:Math.min(Math.max(H,U),K),_=()=>n.stage?.width()??r.width,v=()=>n.stage?.height()??r.height,T=()=>n.grid.maxLength*n.grid.quarterNoteWidth,I=()=>Ht*n.grid.noteHeight,C=H=>{n.grid.quarterNoteWidth=H,n.viewport.zoomX=H/n.grid.baseQuarterNoteWidth},x=H=>{n.grid.noteHeight=H,n.viewport.zoomY=H/n.grid.baseNoteHeight},R=()=>{const H=n.grid.quarterNoteWidth,U=_(),K=H===0?0:n.viewport.scrollX/H,et=K+U/(H||1);return{startQuarter:K,endQuarter:et}},F=()=>{const H=n.grid.noteHeight,U=v(),K=H===0?0:n.viewport.scrollY/H,et=K+U/(H||1);return{topIndex:K,bottomIndex:et}},D=()=>{const H=_(),U=v(),K=Math.max(0,T()-H),et=l(n.viewport.scrollX,0,K);et!==n.viewport.scrollX&&(n.viewport.scrollX=et,n.needsRedraw=!0,Q());const st=Math.max(0,I()-U),ut=l(n.viewport.scrollY,0,st);ut!==n.viewport.scrollY&&(n.viewport.scrollY=ut,n.needsRedraw=!0,Q())},B=(H,U)=>{if(!Number.isFinite(H)||H<=0)return;C(H);const et=_()/n.grid.quarterNoteWidth,st=Math.max(0,n.grid.maxLength-et),ut=l(U,0,st);n.viewport.scrollX=ut*n.grid.quarterNoteWidth,D(),n.needsRedraw=!0,Q()},V=(H,U)=>{if(!Number.isFinite(H)||H<=0)return;x(H);const et=v()/n.grid.noteHeight,st=Math.max(0,Ht-et),ut=l(U,0,st);n.viewport.scrollY=ut*n.grid.noteHeight,D(),n.needsRedraw=!0,Q()},L=()=>{const H=_(),U=v();if(H<=0||U<=0)return;const K=Array.from(n.notes.values());if(K.length===0){const ae=H/ol;B(ae,0);const Vr=al,vu=U/Vr,Su=127-uu,Cu=Math.max(0,Ht-Vr),xu=l(Su-(Vr-1),0,Cu);V(vu,xu);return}const et=K.reduce((Pe,ae)=>Math.min(Pe,ae.position),Number.POSITIVE_INFINITY),st=K.reduce((Pe,ae)=>Math.max(Pe,ae.position+ae.duration),Number.NEGATIVE_INFINITY),ut=Math.max(st-et,0),ht=Math.max(ut,ol),ft=H/ht,_t=Math.max(0,n.grid.maxLength-ht),Ct=Math.max(ht-ut,0),Mt=et-Ct/2,It=l(Mt,0,_t);B(ft,It);const zt=K.reduce((Pe,ae)=>Math.max(Pe,ae.pitch),Number.NEGATIVE_INFINITY),Dn=K.reduce((Pe,ae)=>Math.min(Pe,ae.pitch),Number.POSITIVE_INFINITY),cl=127-zt,gu=127-Dn,hl=Math.max(gu-cl+1,1),Hr=Math.max(hl,al),pu=U/Hr,mu=Math.max(Hr-hl,0),_u=cl-mu/2,yu=Math.max(0,Ht-Hr),bu=l(_u,0,yu);V(pu,bu)},Q=()=>{r.syncState?.(n)},b=ke(()=>{const H=n.grid.maxLength;if(H<=0)return{start:0,size:1};const U=n.grid.quarterNoteWidth,K=_();if(U<=0||K<=0)return{start:0,size:1};const et=n.viewport.scrollX/U,st=K/U,ut=Math.min(1,st/H);if(ut>=1)return{start:0,size:1};const ht=et/H;return{start:l(ht,0,1-ut),size:ut}}),P=ke(()=>{const H=Ht,U=n.grid.noteHeight,K=v();if(U<=0||K<=0)return{start:0,size:1};const et=n.viewport.scrollY/U,st=K/U,ut=Math.min(1,st/H);if(ut>=1)return{start:0,size:1};const ht=et/H;return{start:l(ht,0,1-ut),size:ut}}),N=ke(()=>{const{start:H,size:U}=b.value,K=l(U,0,1),et=Math.min(1,Math.max(K,.01));return{left:`${l(H,0,1-et)*100}%`,width:`${et*100}%`}}),A=ke(()=>{const{start:H,size:U}=P.value,K=l(U,0,1),et=Math.min(1,Math.max(K,.01));return{top:`${l(H,0,1-et)*100}%`,height:`${et*100}%`}}),O=ee(null),j=ee(null),G=()=>{O.value&&(window.removeEventListener("pointermove",M),window.removeEventListener("pointerup",G),O.value=null)},J=()=>{j.value&&(window.removeEventListener("pointermove",q),window.removeEventListener("pointerup",J),j.value=null)},ot=(H,U)=>{if(!r.interactive||!a.value)return;G();const K=a.value.getBoundingClientRect();if(K.width<=0)return;const{startQuarter:et,endQuarter:st}=R(),ut=Math.max(We,st-et),ht=_(),ft=n.grid.maxLength;if(ht<=0||ft<=0)return;const _t=et/ft,Ct=st/ft;let Mt=0;H==="resize-start"?Mt=U.clientX-(K.left+_t*K.width):H==="resize-end"&&(Mt=U.clientX-(K.left+Ct*K.width)),O.value={mode:H,pointerId:U.pointerId,pointerStart:U.clientX,trackRect:K,startQuarter:et,endQuarter:st,anchorQuarter:H==="resize-start"?st:et,spanQuarter:ut,stageWidth:ht,pointerOffset:Mt},window.addEventListener("pointermove",M),window.addEventListener("pointerup",G),U.preventDefault()},W=(H,U)=>{if(!r.interactive||!c.value)return;J();const K=c.value.getBoundingClientRect();if(K.height<=0)return;const{topIndex:et,bottomIndex:st}=F(),ut=Math.max(Ke,st-et),ht=v();if(ht<=0)return;const ft=et/Ht,_t=st/Ht;let Ct=0;H==="resize-start"?Ct=U.clientY-(K.top+ft*K.height):H==="resize-end"&&(Ct=U.clientY-(K.top+_t*K.height)),j.value={mode:H,pointerId:U.pointerId,pointerStart:U.clientY,trackRect:K,topIndex:et,bottomIndex:st,anchorIndex:H==="resize-start"?st:et,span:ut,stageHeight:ht,pointerOffset:Ct},window.addEventListener("pointermove",q),window.addEventListener("pointerup",J),U.preventDefault()},M=H=>{const U=O.value;if(!U||H.pointerId!==U.pointerId)return;const K=n.grid.maxLength,et=U.trackRect;if(K<=0||et.width<=0||U.stageWidth<=0)return;if(H.preventDefault(),U.mode==="move"){const _t=(H.clientX-U.pointerStart)/et.width*K,Ct=Math.max(0,K-U.spanQuarter),Mt=l(U.startQuarter+_t,0,Ct);n.viewport.scrollX=Mt*n.grid.quarterNoteWidth,D(),n.needsRedraw=!0,Q();return}const st=l(H.clientX,et.left,et.right),ht=(l(st-U.pointerOffset,et.left,et.right)-et.left)/et.width;if(U.mode==="resize-start"){let ft=ht*K;const _t=U.anchorQuarter-We;ft=l(ft,0,Math.max(0,_t));const Ct=Math.max(We,U.anchorQuarter-ft),Mt=U.stageWidth/Ct;B(Mt,ft),U.startQuarter=ft,U.spanQuarter=Ct;return}if(U.mode==="resize-end"){let ft=ht*K;const _t=U.anchorQuarter+We;ft=l(ft,Math.min(_t,K),K);const Ct=Math.max(We,ft-U.anchorQuarter),Mt=U.stageWidth/Ct;B(Mt,U.anchorQuarter),U.endQuarter=ft,U.spanQuarter=Ct}},q=H=>{const U=j.value;if(!U||H.pointerId!==U.pointerId)return;const K=U.trackRect;if(K.height<=0||U.stageHeight<=0)return;if(H.preventDefault(),U.mode==="move"){const ft=(H.clientY-U.pointerStart)/K.height*Ht,_t=Math.max(0,Ht-U.span),Ct=l(U.topIndex+ft,0,_t);n.viewport.scrollY=Ct*n.grid.noteHeight,D(),n.needsRedraw=!0,Q();return}const et=l(H.clientY,K.top,K.bottom),ut=(l(et-U.pointerOffset,K.top,K.bottom)-K.top)/K.height;if(U.mode==="resize-start"){let ht=ut*Ht;const ft=U.anchorIndex-Ke;ht=l(ht,0,Math.max(0,ft));const _t=Math.max(Ke,U.anchorIndex-ht),Ct=U.stageHeight/_t;V(Ct,ht),U.topIndex=ht,U.span=_t;return}if(U.mode==="resize-end"){let ht=ut*Ht;const ft=U.anchorIndex+Ke;ht=l(ht,Math.min(ft,Ht),Ht);const _t=Math.max(Ke,ht-U.anchorIndex),Ct=U.stageHeight/_t;V(Ct,U.anchorIndex),U.bottomIndex=ht,U.span=_t}},nt=H=>{if(!r.interactive||!a.value)return;const U=a.value.getBoundingClientRect();if(U.width<=0)return;const K=l((H.clientX-U.left)/U.width,0,1),{startQuarter:et,endQuarter:st}=R(),ut=Math.max(We,st-et),ht=n.grid.maxLength,ft=Math.max(0,ht-ut),_t=l(K*ht-ut/2,0,ft);n.viewport.scrollX=_t*n.grid.quarterNoteWidth,D(),n.needsRedraw=!0,Q()},lt=H=>{if(!r.interactive||!c.value)return;const U=c.value.getBoundingClientRect();if(U.height<=0)return;const K=l((H.clientY-U.top)/U.height,0,1),{topIndex:et,bottomIndex:st}=F(),ut=Math.max(Ke,st-et),ht=Math.max(0,Ht-ut),ft=l(K*Ht-ut/2,0,ht);n.viewport.scrollY=ft*n.grid.noteHeight,D(),n.needsRedraw=!0,Q()};Ne(m,H=>{n.grid.subdivision=H,n.needsRedraw=!0,r.syncState?.(n)});const dt=()=>{n.command.stack?.undo(),k()},E=()=>{n.command.stack?.redo(),k()},k=()=>{d.value=n.command.stack?.canUndo()??!1,h.value=n.command.stack?.canRedo()??!1},z=()=>{k(),X()},Y=()=>{n.selection.selectedIds.size!==0&&(n.command.stack?.executeCommand("Delete Selected",()=>{n.selection.selectedIds.forEach(H=>n.notes.delete(H)),n.selection.selectedIds.clear(),n.needsRedraw=!0}),k())},$=()=>{n.needsRedraw&&(qd(n),Wd(n),Kd(n),Yd(n),Xd(n),n.needsRedraw=!1),n.rafHandle=requestAnimationFrame($)},X=()=>{g(),s("notes-update",Array.from(n.notes.entries())),r.syncState?.(n)};n.notifyExternalChange=()=>{X()};const tt=H=>{if(r.interactive){if((H.metaKey||H.ctrlKey)&&H.key==="z"&&!H.shiftKey&&(H.preventDefault(),dt()),(H.metaKey||H.ctrlKey)&&H.key==="z"&&H.shiftKey&&(H.preventDefault(),E()),(H.key==="Backspace"||H.key==="Delete")&&(H.preventDefault(),Y()),H.key.startsWith("Arrow")&&n.selection.selectedIds.size>0&&(H.preventDefault(),n.command.stack?.executeCommand("Move Selection",()=>{n.selection.selectedIds.forEach(U=>{const K=n.notes.get(U);if(K)switch(H.key){case"ArrowUp":K.pitch=Math.min(127,K.pitch+1);break;case"ArrowDown":K.pitch=Math.max(0,K.pitch-1);break;case"ArrowLeft":K.position=Math.max(0,K.position-.25);break;case"ArrowRight":K.position+=.25;break}}),n.needsRedraw=!0}),k()),(H.metaKey||H.ctrlKey)&&H.key==="c"&&n.selection.selectedIds.size>0){H.preventDefault();const U=Array.from(n.selection.selectedIds).map(et=>{const st=n.notes.get(et);return st?{...st}:null}).filter(et=>et!==null),K=Math.min(...U.map(et=>et.position));sessionStorage.setItem("copiedPianoRollNotes",JSON.stringify({notes:U.map(et=>({...et,position:et.position-K}))}))}if((H.metaKey||H.ctrlKey)&&H.key==="v"){H.preventDefault();const U=sessionStorage.getItem("copiedPianoRollNotes");if(!U)return;try{const{notes:K}=JSON.parse(U);n.command.stack?.executeCommand("Paste Notes",()=>{n.selection.selectedIds.clear(),K.forEach(et=>{const st={...et,id:`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,position:n.queuePlayhead.position+et.position};n.notes.set(st.id,st),n.selection.selectedIds.add(st.id)}),n.needsRedraw=!0}),k()}catch(K){console.error("Failed to paste notes",K)}}}},rt=()=>{n.stage&&(S||($d(n,n.stage),S=!0),n.stage.listening(!0),w||(window.addEventListener("keydown",tt),w=!0))},it=()=>{n.stage&&(n.stage.listening(!1),n.interaction.isDragging=!1,n.interaction.isResizing=!1,n.interaction.isMarqueeSelecting=!1,n.selection.selectionRect?.visible(!1),w&&(window.removeEventListener("keydown",tt),w=!1),n.layers.overlay?.batchDraw(),g())};return Gs(()=>{if(!o.value){console.error("Konva container ref not found");return}const H=new Dt.Stage({container:o.value,width:r.width,height:r.height});n.stage=H,n.konvaContainer=o.value,zd(n,H,z),r.interactive?rt():it(),r.initialNotes&&r.initialNotes.length>0&&(n.notes=new Map(r.initialNotes),n.needsRedraw=!0,g()),n.rafHandle=requestAnimationFrame($),n.needsRedraw=!0,D(),z()}),cr(()=>{G(),J(),n.rafHandle&&cancelAnimationFrame(n.rafHandle),it(),n.stage?.destroy()}),Ne(()=>r.interactive,H=>{n.stage&&(H?rt():(it(),G(),J()))}),Ne(()=>r.width,H=>{n.stage&&(n.stage.width(H),n.needsRedraw=!0,D())}),Ne(()=>r.height,H=>{n.stage&&(n.stage.height(H),n.needsRedraw=!0,D())}),e({setNotes:H=>{const U=new Set;n.notes.clear(),H.forEach((K,et)=>{let st=K.id||`note_${Date.now()}_${et}`;for(;U.has(st);)st=`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;U.add(st);const ut={...K,id:st,velocity:K.velocity??100};n.notes.set(st,ut)}),n.needsRedraw=!0,X()},setLivePlayheadPosition:H=>{n.livePlayhead.position=Math.max(0,Math.min(H,n.grid.maxLength)),n.needsRedraw=!0},getPlayStartPosition:()=>n.queuePlayhead.position,fitZoomToNotes:L}),(H,U)=>(yr(),go("div",nu,[y.value?(yr(),go("div",ru,[xt("button",{onClick:dt,disabled:!f.value||!d.value},"↶ Undo",8,su),xt("button",{onClick:E,disabled:!f.value||!h.value},"↷ Redo",8,ou),U[9]||(U[9]=xt("span",{class:"separator"},"|",-1)),xt("label",null,[U[8]||(U[8]=_o(" Grid: ")),hc(xt("select",{"onUpdate:modelValue":U[0]||(U[0]=K=>m.value=K),disabled:!f.value},U[7]||(U[7]=[xt("option",{value:4},"Quarter",-1),xt("option",{value:8},"Eighth",-1),xt("option",{value:16},"16th",-1),xt("option",{value:32},"32nd",-1)]),8,au),[[Uh,m.value,void 0,{number:!0}]])]),U[10]||(U[10]=xt("span",{class:"separator"},"|",-1)),xt("button",{onClick:Y,disabled:!f.value||u.value===0}," 🗑️ Delete ",8,lu),U[11]||(U[11]=xt("span",{class:"separator"},"|",-1)),xt("span",cu,Vn(p.value)+" notes, "+Vn(u.value)+" selected",1)])):rh("",!0),xt("div",hu,[xt("div",du,[xt("div",{ref_key:"konvaContainer",ref:o,class:Le(["piano-roll-container",{"is-disabled":!f.value}]),style:be({width:r.width+"px",height:r.height+"px"})},null,6),xt("div",{ref_key:"horizontalTrack",ref:a,class:Le(["scrollbar horizontal",{"is-disabled":!f.value}]),style:be({width:r.width+"px"}),onPointerdown:xe(nt,["self"])},[xt("div",{class:"scrollbar-thumb horizontal-thumb",style:be(N.value)},[xt("div",{class:"scrollbar-handle handle-left",onPointerdown:U[1]||(U[1]=xe(K=>ot("resize-start",K),["stop","prevent"]))},null,32),xt("div",{class:"scrollbar-body",onPointerdown:U[2]||(U[2]=xe(K=>ot("move",K),["stop","prevent"]))},null,32),xt("div",{class:"scrollbar-handle handle-right",onPointerdown:U[3]||(U[3]=xe(K=>ot("resize-end",K),["stop","prevent"]))},null,32)],4)],38)]),xt("div",{ref_key:"verticalTrack",ref:c,class:Le(["scrollbar vertical",{"is-disabled":!f.value}]),style:be({height:r.height+"px"}),onPointerdown:xe(lt,["self"])},[xt("div",{class:"scrollbar-thumb vertical-thumb",style:be(A.value)},[xt("div",{class:"scrollbar-handle handle-top",onPointerdown:U[4]||(U[4]=xe(K=>W("resize-start",K),["stop","prevent"]))},null,32),xt("div",{class:"scrollbar-body vertical-body",onPointerdown:U[5]||(U[5]=xe(K=>W("move",K),["stop","prevent"]))},null,32),xt("div",{class:"scrollbar-handle handle-bottom",onPointerdown:U[6]||(U[6]=xe(K=>W("resize-end",K),["stop","prevent"]))},null,32)],4)],38)])]))}}),[["styles",[".piano-roll-root[data-v-d53e4043]{display:flex;flex-direction:column;align-items:center;gap:20px;padding:20px}.control-panel[data-v-d53e4043]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:10px 15px;display:flex;align-items:center;gap:10px;box-shadow:0 2px 10px #0000001a}.control-panel button[data-v-d53e4043]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:5px 15px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-d53e4043]:hover:not(:disabled){background:#e0e0e0}.control-panel button[data-v-d53e4043]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-d53e4043]{color:#ccc}.info[data-v-d53e4043]{color:#666;font-size:14px}.piano-roll-container[data-v-d53e4043]{background-color:#fff;border:1px solid black;cursor:default;box-sizing:border-box;border-radius:8px}.piano-roll-container.is-disabled[data-v-d53e4043]{pointer-events:none;cursor:not-allowed}.piano-roll-layout[data-v-d53e4043]{display:flex;align-items:flex-start;gap:12px}.stage-wrapper[data-v-d53e4043]{display:flex;flex-direction:column;gap:12px;align-items:stretch}.scrollbar[data-v-d53e4043]{position:relative;background:#f5f5f5;border:1px solid #ccc;border-radius:10px;box-sizing:border-box;user-select:none;touch-action:none}.scrollbar.horizontal[data-v-d53e4043]{height:24px}.scrollbar.vertical[data-v-d53e4043]{width:24px}.scrollbar.is-disabled[data-v-d53e4043]{opacity:.45;pointer-events:none}.scrollbar-thumb[data-v-d53e4043]{position:absolute;background:#0000002e;border-radius:6px;display:flex;align-items:center;justify-content:space-between;min-width:16px;min-height:16px;cursor:grab;transition:background .15s ease;box-sizing:border-box}.scrollbar-thumb.horizontal-thumb[data-v-d53e4043]{top:0;height:100%;align-items:stretch}.scrollbar-thumb.vertical-thumb[data-v-d53e4043]{left:0;width:100%;flex-direction:column;justify-content:space-between;align-items:stretch}.scrollbar-thumb[data-v-d53e4043]:hover{background:#00000040}.scrollbar-body[data-v-d53e4043]{flex:1;height:100%;cursor:grab}.scrollbar-body.vertical-body[data-v-d53e4043]{width:100%}.scrollbar-handle[data-v-d53e4043]{background:#00000059;border-radius:4px;flex:0 0 auto}.handle-left[data-v-d53e4043],.handle-right[data-v-d53e4043]{width:8px;height:100%;cursor:ew-resize}.handle-top[data-v-d53e4043],.handle-bottom[data-v-d53e4043]{width:100%;height:8px;cursor:ns-resize}label[data-v-d53e4043]{display:flex;align-items:center;gap:5px;font-size:14px}select[data-v-d53e4043]{padding:3px 8px;border:1px solid #ccc;border-radius:4px;font-size:14px;cursor:pointer}"]],["__scopeId","data-v-d53e4043"]]),ll="piano-roll-component",Br=Lh(fu);return customElements.get(ll)||customElements.define(ll,Br),tn.PianoRollElement=Br,tn.default=Br,Object.defineProperties(tn,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),tn}({});
