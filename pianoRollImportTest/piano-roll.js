var PianoRollComponent=function(Nr){"use strict";/**
* @vue/shared v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Mr(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Tt={},an=[],pe=()=>{},yh=()=>!1,Di=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Ir=t=>t.startsWith("onUpdate:"),$t=Object.assign,Or=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},bh=Object.prototype.hasOwnProperty,Ct=(t,e)=>bh.call(t,e),ft=Array.isArray,ln=t=>Rn(t)==="[object Map]",zi=t=>Rn(t)==="[object Set]",to=t=>Rn(t)==="[object Date]",gt=t=>typeof t=="function",Lt=t=>typeof t=="string",me=t=>typeof t=="symbol",Mt=t=>t!==null&&typeof t=="object",eo=t=>(Mt(t)||gt(t))&&gt(t.then)&&gt(t.catch),no=Object.prototype.toString,Rn=t=>no.call(t),Sh=t=>Rn(t).slice(8,-1),Li=t=>Rn(t)==="[object Object]",Fr=t=>Lt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,An=Mr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Gi=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},wh=/-(\w)/g,ce=Gi(t=>t.replace(wh,(e,n)=>n?n.toUpperCase():"")),xh=/\B([A-Z])/g,oe=Gi(t=>t.replace(xh,"-$1").toLowerCase()),io=Gi(t=>t.charAt(0).toUpperCase()+t.slice(1)),Dr=Gi(t=>t?`on${io(t)}`:""),Oe=(t,e)=>!Object.is(t,e),Ui=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},ro=(t,e,n,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:n})},Bi=t=>{const e=parseFloat(t);return isNaN(e)?t:e},so=t=>{const e=Lt(t)?Number(t):NaN;return isNaN(e)?t:e};let oo;const ao=()=>oo||(oo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function we(t){if(ft(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],r=Lt(i)?kh(i):we(i);if(r)for(const s in r)e[s]=r[s]}return e}else if(Lt(t)||Mt(t))return t}const Ch=/;(?![^(]*\))/g,Ph=/:([^]+)/,Th=/\/\*[^]*?\*\//g;function kh(t){const e={};return t.replace(Th,"").split(Ch).forEach(n=>{if(n){const i=n.split(Ph);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function Ze(t){let e="";if(Lt(t))e=t;else if(ft(t))for(let n=0;n<t.length;n++){const i=Ze(t[n]);i&&(e+=i+" ")}else if(Mt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Eh=Mr("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function lo(t){return!!t||t===""}function Rh(t,e){if(t.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<t.length;i++)n=$i(t[i],e[i]);return n}function $i(t,e){if(t===e)return!0;let n=to(t),i=to(e);if(n||i)return n&&i?t.getTime()===e.getTime():!1;if(n=me(t),i=me(e),n||i)return t===e;if(n=ft(t),i=ft(e),n||i)return n&&i?Rh(t,e):!1;if(n=Mt(t),i=Mt(e),n||i){if(!n||!i)return!1;const r=Object.keys(t).length,s=Object.keys(e).length;if(r!==s)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!$i(t[o],e[o]))return!1}}return String(t)===String(e)}function Ah(t,e){return t.findIndex(n=>$i(n,e))}const co=t=>!!(t&&t.__v_isRef===!0),zr=t=>Lt(t)?t:t==null?"":ft(t)||Mt(t)&&(t.toString===no||!gt(t.toString))?co(t)?zr(t.value):JSON.stringify(t,ho,2):String(t),ho=(t,e)=>co(e)?ho(t,e.value):ln(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,r],s)=>(n[Lr(i,s)+" =>"]=r,n),{})}:zi(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Lr(n))}:me(e)?Lr(e):Mt(e)&&!ft(e)&&!Li(e)?String(e):e,Lr=(t,e="")=>{var n;return me(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ne;class Nh{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ne,!e&&ne&&(this.index=(ne.scopes||(ne.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=ne;try{return ne=this,e()}finally{ne=n}}}on(){ne=this}off(){ne=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function Mh(){return ne}let Rt;const Gr=new WeakSet;class uo{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ne&&ne.active&&ne.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Gr.has(this)&&(Gr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||go(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,yo(this),po(this);const e=Rt,n=he;Rt=this,he=!0;try{return this.fn()}finally{mo(this),Rt=e,he=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Vr(e);this.deps=this.depsTail=void 0,yo(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Gr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){$r(this)&&this.run()}get dirty(){return $r(this)}}let fo=0,Nn,Mn;function go(t,e=!1){if(t.flags|=8,e){t.next=Mn,Mn=t;return}t.next=Nn,Nn=t}function Ur(){fo++}function Br(){if(--fo>0)return;if(Mn){let e=Mn;for(Mn=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Nn;){let e=Nn;for(Nn=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){t||(t=i)}e=n}}if(t)throw t}function po(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function mo(t){let e,n=t.depsTail,i=n;for(;i;){const r=i.prevDep;i.version===-1?(i===n&&(n=r),Vr(i),Ih(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}t.deps=e,t.depsTail=n}function $r(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(_o(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function _o(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===In))return;t.globalVersion=In;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!$r(t)){t.flags&=-3;return}const n=Rt,i=he;Rt=t,he=!0;try{po(t);const r=t.fn(t._value);(e.version===0||Oe(r,t._value))&&(t._value=r,e.version++)}catch(r){throw e.version++,r}finally{Rt=n,he=i,mo(t),t.flags&=-3}}function Vr(t,e=!1){const{dep:n,prevSub:i,nextSub:r}=t;if(i&&(i.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=i,t.nextSub=void 0),n.subs===t&&(n.subs=i),!n.subs&&n.computed){n.computed.flags&=-5;for(let s=n.computed.deps;s;s=s.nextDep)Vr(s,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function Ih(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let he=!0;const vo=[];function xe(){vo.push(he),he=!1}function Ce(){const t=vo.pop();he=t===void 0?!0:t}function yo(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Rt;Rt=void 0;try{e()}finally{Rt=n}}}let In=0;class Oh{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Hr{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!Rt||!he||Rt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Rt)n=this.activeLink=new Oh(Rt,this),Rt.deps?(n.prevDep=Rt.depsTail,Rt.depsTail.nextDep=n,Rt.depsTail=n):Rt.deps=Rt.depsTail=n,bo(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=Rt.depsTail,n.nextDep=void 0,Rt.depsTail.nextDep=n,Rt.depsTail=n,Rt.deps===n&&(Rt.deps=i)}return n}trigger(e){this.version++,In++,this.notify(e)}notify(e){Ur();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Br()}}}function bo(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)bo(i)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Wr=new WeakMap,qe=Symbol(""),jr=Symbol(""),On=Symbol("");function Wt(t,e,n){if(he&&Rt){let i=Wr.get(t);i||Wr.set(t,i=new Map);let r=i.get(n);r||(i.set(n,r=new Hr),r.map=i,r.key=n),r.track()}}function Pe(t,e,n,i,r,s){const o=Wr.get(t);if(!o){In++;return}const a=l=>{l&&l.trigger()};if(Ur(),e==="clear")o.forEach(a);else{const l=ft(t),c=l&&Fr(n);if(l&&n==="length"){const h=Number(i);o.forEach((g,f)=>{(f==="length"||f===On||!me(f)&&f>=h)&&a(g)})}else switch(n!==void 0&&a(o.get(n)),c&&a(o.get(On)),e){case"add":l?c&&a(o.get("length")):(a(o.get(qe)),ln(t)&&a(o.get(jr)));break;case"delete":l||(a(o.get(qe)),ln(t)&&a(o.get(jr)));break;case"set":ln(t)&&a(o.get(qe));break}}Br()}function cn(t){const e=wt(t);return e===t?e:(Wt(e,"iterate",On),ue(t)?e:e.map(Zt))}function Zr(t){return Wt(t=wt(t),"iterate",On),t}const Fh={__proto__:null,[Symbol.iterator](){return qr(this,Symbol.iterator,Zt)},concat(...t){return cn(this).concat(...t.map(e=>ft(e)?cn(e):e))},entries(){return qr(this,"entries",t=>(t[1]=Zt(t[1]),t))},every(t,e){return Te(this,"every",t,e,void 0,arguments)},filter(t,e){return Te(this,"filter",t,e,n=>n.map(Zt),arguments)},find(t,e){return Te(this,"find",t,e,Zt,arguments)},findIndex(t,e){return Te(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Te(this,"findLast",t,e,Zt,arguments)},findLastIndex(t,e){return Te(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Te(this,"forEach",t,e,void 0,arguments)},includes(...t){return Kr(this,"includes",t)},indexOf(...t){return Kr(this,"indexOf",t)},join(t){return cn(this).join(t)},lastIndexOf(...t){return Kr(this,"lastIndexOf",t)},map(t,e){return Te(this,"map",t,e,void 0,arguments)},pop(){return Fn(this,"pop")},push(...t){return Fn(this,"push",t)},reduce(t,...e){return So(this,"reduce",t,e)},reduceRight(t,...e){return So(this,"reduceRight",t,e)},shift(){return Fn(this,"shift")},some(t,e){return Te(this,"some",t,e,void 0,arguments)},splice(...t){return Fn(this,"splice",t)},toReversed(){return cn(this).toReversed()},toSorted(t){return cn(this).toSorted(t)},toSpliced(...t){return cn(this).toSpliced(...t)},unshift(...t){return Fn(this,"unshift",t)},values(){return qr(this,"values",Zt)}};function qr(t,e,n){const i=Zr(t),r=i[e]();return i!==t&&!ue(t)&&(r._next=r.next,r.next=()=>{const s=r._next();return s.value&&(s.value=n(s.value)),s}),r}const Dh=Array.prototype;function Te(t,e,n,i,r,s){const o=Zr(t),a=o!==t&&!ue(t),l=o[e];if(l!==Dh[e]){const g=l.apply(t,s);return a?Zt(g):g}let c=n;o!==t&&(a?c=function(g,f){return n.call(this,Zt(g),f,t)}:n.length>2&&(c=function(g,f){return n.call(this,g,f,t)}));const h=l.call(o,c,i);return a&&r?r(h):h}function So(t,e,n,i){const r=Zr(t);let s=n;return r!==t&&(ue(t)?n.length>3&&(s=function(o,a,l){return n.call(this,o,a,l,t)}):s=function(o,a,l){return n.call(this,o,Zt(a),l,t)}),r[e](s,...i)}function Kr(t,e,n){const i=wt(t);Wt(i,"iterate",On);const r=i[e](...n);return(r===-1||r===!1)&&Xr(n[0])?(n[0]=wt(n[0]),i[e](...n)):r}function Fn(t,e,n=[]){xe(),Ur();const i=wt(t)[e].apply(t,n);return Br(),Ce(),i}const zh=Mr("__proto__,__v_isRef,__isVue"),wo=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(me));function Lh(t){me(t)||(t=String(t));const e=wt(this);return Wt(e,"has",t),e.hasOwnProperty(t)}class xo{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,i){const r=this._isReadonly,s=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return s;if(n==="__v_raw")return i===(r?s?Io:Mo:s?No:Ao).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=ft(e);if(!r){let l;if(o&&(l=Fh[n]))return l;if(n==="hasOwnProperty")return Lh}const a=Reflect.get(e,n,Ht(e)?e:i);return(me(n)?wo.has(n):zh(n))||(r||Wt(e,"get",n),s)?a:Ht(a)?o&&Fr(n)?a:a.value:Mt(a)?r?Oo(a):hn(a):a}}class Co extends xo{constructor(e=!1){super(!1,e)}set(e,n,i,r){let s=e[n];if(!this._isShallow){const l=Ke(s);if(!ue(i)&&!Ke(i)&&(s=wt(s),i=wt(i)),!ft(e)&&Ht(s)&&!Ht(i))return l?!1:(s.value=i,!0)}const o=ft(e)&&Fr(n)?Number(n)<e.length:Ct(e,n),a=Reflect.set(e,n,i,Ht(e)?e:r);return e===wt(r)&&(o?Oe(i,s)&&Pe(e,"set",n,i):Pe(e,"add",n,i)),a}deleteProperty(e,n){const i=Ct(e,n);e[n];const r=Reflect.deleteProperty(e,n);return r&&i&&Pe(e,"delete",n,void 0),r}has(e,n){const i=Reflect.has(e,n);return(!me(n)||!wo.has(n))&&Wt(e,"has",n),i}ownKeys(e){return Wt(e,"iterate",ft(e)?"length":qe),Reflect.ownKeys(e)}}class Po extends xo{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Gh=new Co,Uh=new Po,Bh=new Co(!0),$h=new Po(!0),Yr=t=>t,Vi=t=>Reflect.getPrototypeOf(t);function Hi(t,e,n=!1,i=!1){t=t.__v_raw;const r=wt(t),s=wt(e);n||(Oe(e,s)&&Wt(r,"get",e),Wt(r,"get",s));const{has:o}=Vi(r),a=i?Yr:n?Qr:Zt;if(o.call(r,e))return a(t.get(e));if(o.call(r,s))return a(t.get(s));t!==r&&t.get(e)}function Wi(t,e=!1){const n=this.__v_raw,i=wt(n),r=wt(t);return e||(Oe(t,r)&&Wt(i,"has",t),Wt(i,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function ji(t,e=!1){return t=t.__v_raw,!e&&Wt(wt(t),"iterate",qe),Reflect.get(t,"size",t)}function To(t,e=!1){!e&&!ue(t)&&!Ke(t)&&(t=wt(t));const n=wt(this);return Vi(n).has.call(n,t)||(n.add(t),Pe(n,"add",t,t)),this}function ko(t,e,n=!1){!n&&!ue(e)&&!Ke(e)&&(e=wt(e));const i=wt(this),{has:r,get:s}=Vi(i);let o=r.call(i,t);o||(t=wt(t),o=r.call(i,t));const a=s.call(i,t);return i.set(t,e),o?Oe(e,a)&&Pe(i,"set",t,e):Pe(i,"add",t,e),this}function Eo(t){const e=wt(this),{has:n,get:i}=Vi(e);let r=n.call(e,t);r||(t=wt(t),r=n.call(e,t)),i&&i.call(e,t);const s=e.delete(t);return r&&Pe(e,"delete",t,void 0),s}function Ro(){const t=wt(this),e=t.size!==0,n=t.clear();return e&&Pe(t,"clear",void 0,void 0),n}function Zi(t,e){return function(i,r){const s=this,o=s.__v_raw,a=wt(o),l=e?Yr:t?Qr:Zt;return!t&&Wt(a,"iterate",qe),o.forEach((c,h)=>i.call(r,l(c),l(h),s))}}function qi(t,e,n){return function(...i){const r=this.__v_raw,s=wt(r),o=ln(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=r[t](...i),h=n?Yr:e?Qr:Zt;return!e&&Wt(s,"iterate",l?jr:qe),{next(){const{value:g,done:f}=c.next();return f?{value:g,done:f}:{value:a?[h(g[0]),h(g[1])]:h(g),done:f}},[Symbol.iterator](){return this}}}}function Fe(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Vh(){const t={get(s){return Hi(this,s)},get size(){return ji(this)},has:Wi,add:To,set:ko,delete:Eo,clear:Ro,forEach:Zi(!1,!1)},e={get(s){return Hi(this,s,!1,!0)},get size(){return ji(this)},has:Wi,add(s){return To.call(this,s,!0)},set(s,o){return ko.call(this,s,o,!0)},delete:Eo,clear:Ro,forEach:Zi(!1,!0)},n={get(s){return Hi(this,s,!0)},get size(){return ji(this,!0)},has(s){return Wi.call(this,s,!0)},add:Fe("add"),set:Fe("set"),delete:Fe("delete"),clear:Fe("clear"),forEach:Zi(!0,!1)},i={get(s){return Hi(this,s,!0,!0)},get size(){return ji(this,!0)},has(s){return Wi.call(this,s,!0)},add:Fe("add"),set:Fe("set"),delete:Fe("delete"),clear:Fe("clear"),forEach:Zi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=qi(s,!1,!1),n[s]=qi(s,!0,!1),e[s]=qi(s,!1,!0),i[s]=qi(s,!0,!0)}),[t,n,e,i]}const[Hh,Wh,jh,Zh]=Vh();function Ki(t,e){const n=e?t?Zh:jh:t?Wh:Hh;return(i,r,s)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?i:Reflect.get(Ct(n,r)&&r in i?n:i,r,s)}const qh={get:Ki(!1,!1)},Kh={get:Ki(!1,!0)},Yh={get:Ki(!0,!1)},Xh={get:Ki(!0,!0)},Ao=new WeakMap,No=new WeakMap,Mo=new WeakMap,Io=new WeakMap;function Qh(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Jh(t){return t.__v_skip||!Object.isExtensible(t)?0:Qh(Sh(t))}function hn(t){return Ke(t)?t:Yi(t,!1,Gh,qh,Ao)}function tu(t){return Yi(t,!1,Bh,Kh,No)}function Oo(t){return Yi(t,!0,Uh,Yh,Mo)}function xm(t){return Yi(t,!0,$h,Xh,Io)}function Yi(t,e,n,i,r){if(!Mt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=r.get(t);if(s)return s;const o=Jh(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return r.set(t,a),a}function Dn(t){return Ke(t)?Dn(t.__v_raw):!!(t&&t.__v_isReactive)}function Ke(t){return!!(t&&t.__v_isReadonly)}function ue(t){return!!(t&&t.__v_isShallow)}function Xr(t){return t?!!t.__v_raw:!1}function wt(t){const e=t&&t.__v_raw;return e?wt(e):t}function eu(t){return!Ct(t,"__v_skip")&&Object.isExtensible(t)&&ro(t,"__v_skip",!0),t}const Zt=t=>Mt(t)?hn(t):t,Qr=t=>Mt(t)?Oo(t):t;function Ht(t){return t?t.__v_isRef===!0:!1}function qt(t){return Fo(t,!1)}function nu(t){return Fo(t,!0)}function Fo(t,e){return Ht(t)?t:new iu(t,e)}class iu{constructor(e,n){this.dep=new Hr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:wt(e),this._value=n?e:Zt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,i=this.__v_isShallow||ue(e)||Ke(e);e=i?e:wt(e),Oe(e,n)&&(this._rawValue=e,this._value=i?e:Zt(e),this.dep.trigger())}}function De(t){return Ht(t)?t.value:t}const ru={get:(t,e,n)=>e==="__v_raw"?t:De(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const r=t[e];return Ht(r)&&!Ht(n)?(r.value=n,!0):Reflect.set(t,e,n,i)}};function Do(t){return Dn(t)?t:new Proxy(t,ru)}class su{constructor(e,n,i){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Hr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=In-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Rt!==this)return go(this,!0),!0}get value(){const e=this.dep.track();return _o(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function ou(t,e,n=!1){let i,r;return gt(t)?i=t:(i=t.get,r=t.set),new su(i,r,n)}const Xi={},Qi=new WeakMap;let Ye;function au(t,e=!1,n=Ye){if(n){let i=Qi.get(n);i||Qi.set(n,i=[]),i.push(t)}}function lu(t,e,n=Tt){const{immediate:i,deep:r,once:s,scheduler:o,augmentJob:a,call:l}=n,c=_=>r?_:ue(_)||r===!1||r===0?ke(_,1):ke(_);let h,g,f,d,p=!1,v=!1;if(Ht(t)?(g=()=>t.value,p=ue(t)):Dn(t)?(g=()=>c(t),p=!0):ft(t)?(v=!0,p=t.some(_=>Dn(_)||ue(_)),g=()=>t.map(_=>{if(Ht(_))return _.value;if(Dn(_))return c(_);if(gt(_))return l?l(_,2):_()})):gt(t)?e?g=l?()=>l(t,2):t:g=()=>{if(f){xe();try{f()}finally{Ce()}}const _=Ye;Ye=h;try{return l?l(t,3,[d]):t(d)}finally{Ye=_}}:g=pe,e&&r){const _=g,S=r===!0?1/0:r;g=()=>ke(_(),S)}const w=Mh(),x=()=>{h.stop(),w&&Or(w.effects,h)};if(s&&e){const _=e;e=(...S)=>{_(...S),x()}}let m=v?new Array(t.length).fill(Xi):Xi;const u=_=>{if(!(!(h.flags&1)||!h.dirty&&!_))if(e){const S=h.run();if(r||p||(v?S.some((k,O)=>Oe(k,m[O])):Oe(S,m))){f&&f();const k=Ye;Ye=h;try{const O=[S,m===Xi?void 0:v&&m[0]===Xi?[]:m,d];l?l(e,3,O):e(...O),m=S}finally{Ye=k}}}else h.run()};return a&&a(u),h=new uo(g),h.scheduler=o?()=>o(u,!1):u,d=_=>au(_,!1,h),f=h.onStop=()=>{const _=Qi.get(h);if(_){if(l)l(_,4);else for(const S of _)S();Qi.delete(h)}},e?i?u(!0):m=h.run():o?o(u.bind(null,!0),!0):h.run(),x.pause=h.pause.bind(h),x.resume=h.resume.bind(h),x.stop=x,x}function ke(t,e=1/0,n){if(e<=0||!Mt(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,Ht(t))ke(t.value,e,n);else if(ft(t))for(let i=0;i<t.length;i++)ke(t[i],e,n);else if(zi(t)||ln(t))t.forEach(i=>{ke(i,e,n)});else if(Li(t)){for(const i in t)ke(t[i],e,n);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&ke(t[i],e,n)}return t}/**
* @vue/runtime-core v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const zn=[];let Jr=!1;function Cm(t,...e){if(Jr)return;Jr=!0,xe();const n=zn.length?zn[zn.length-1].component:null,i=n&&n.appContext.config.warnHandler,r=cu();if(i)un(i,n,11,[t+e.map(s=>{var o,a;return(a=(o=s.toString)==null?void 0:o.call(s))!=null?a:JSON.stringify(s)}).join(""),n&&n.proxy,r.map(({vnode:s})=>`at <${Ra(n,s.type)}>`).join(`
`),r]);else{const s=[`[Vue warn]: ${t}`,...e];r.length&&s.push(`
`,...hu(r)),console.warn(...s)}Ce(),Jr=!1}function cu(){let t=zn[zn.length-1];if(!t)return[];const e=[];for(;t;){const n=e[0];n&&n.vnode===t?n.recurseCount++:e.push({vnode:t,recurseCount:0});const i=t.component&&t.component.parent;t=i&&i.vnode}return e}function hu(t){const e=[];return t.forEach((n,i)=>{e.push(...i===0?[]:[`
`],...uu(n))}),e}function uu({vnode:t,recurseCount:e}){const n=e>0?`... (${e} recursive calls)`:"",i=t.component?t.component.parent==null:!1,r=` at <${Ra(t.component,t.type,i)}`,s=">"+n;return t.props?[r,...du(t.props),s]:[r+s]}function du(t){const e=[],n=Object.keys(t);return n.slice(0,3).forEach(i=>{e.push(...zo(i,t[i]))}),n.length>3&&e.push(" ..."),e}function zo(t,e,n){return Lt(e)?(e=JSON.stringify(e),n?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?n?e:[`${t}=${e}`]:Ht(e)?(e=zo(t,wt(e.value),!0),n?e:[`${t}=Ref<`,e,">"]):gt(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=wt(e),n?e:[`${t}=`,e])}function un(t,e,n,i){try{return i?t(...i):t()}catch(r){Ji(r,e,n)}}function _e(t,e,n,i){if(gt(t)){const r=un(t,e,n,i);return r&&eo(r)&&r.catch(s=>{Ji(s,e,n)}),r}if(ft(t)){const r=[];for(let s=0;s<t.length;s++)r.push(_e(t[s],e,n,i));return r}}function Ji(t,e,n,i=!0){const r=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Tt;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let g=0;g<h.length;g++)if(h[g](t,l,c)===!1)return}a=a.parent}if(s){xe(),un(s,null,10,[t,l,c]),Ce();return}}fu(t,n,r,i,o)}function fu(t,e,n,i=!0,r=!1){if(r)throw t;console.error(t)}const Kt=[];let ve=-1;const dn=[];let ze=null,fn=0;const Lo=Promise.resolve();let tr=null;function ts(t){const e=tr||Lo;return t?e.then(this?t.bind(this):t):e}function gu(t){let e=ve+1,n=Kt.length;for(;e<n;){const i=e+n>>>1,r=Kt[i],s=Ln(r);s<t||s===t&&r.flags&2?e=i+1:n=i}return e}function es(t){if(!(t.flags&1)){const e=Ln(t),n=Kt[Kt.length-1];!n||!(t.flags&2)&&e>=Ln(n)?Kt.push(t):Kt.splice(gu(e),0,t),t.flags|=1,Go()}}function Go(){tr||(tr=Lo.then($o))}function pu(t){ft(t)?dn.push(...t):ze&&t.id===-1?ze.splice(fn+1,0,t):t.flags&1||(dn.push(t),t.flags|=1),Go()}function Uo(t,e,n=ve+1){for(;n<Kt.length;n++){const i=Kt[n];if(i&&i.flags&2){if(t&&i.id!==t.uid)continue;Kt.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Bo(t){if(dn.length){const e=[...new Set(dn)].sort((n,i)=>Ln(n)-Ln(i));if(dn.length=0,ze){ze.push(...e);return}for(ze=e,fn=0;fn<ze.length;fn++){const n=ze[fn];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}ze=null,fn=0}}const Ln=t=>t.id==null?t.flags&2?-1:1/0:t.id;function $o(t){try{for(ve=0;ve<Kt.length;ve++){const e=Kt[ve];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),un(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ve<Kt.length;ve++){const e=Kt[ve];e&&(e.flags&=-2)}ve=-1,Kt.length=0,Bo(),tr=null,(Kt.length||dn.length)&&$o()}}let ae=null,Vo=null;function er(t){const e=ae;return ae=t,Vo=t&&t.type.__scopeId||null,e}function mu(t,e=ae,n){if(!e||t._n)return t;const i=(...r)=>{i._d&&Sa(-1);const s=er(e);let o;try{o=t(...r)}finally{er(s),i._d&&Sa(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Ho(t,e){if(ae===null)return t;const n=ur(ae),i=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[s,o,a,l=Tt]=e[r];s&&(gt(s)&&(s={mounted:s,updated:s}),s.deep&&ke(o),i.push({dir:s,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function Xe(t,e,n,i){const r=t.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(xe(),_e(l,n,8,[t.el,a,t,e]),Ce())}}const _u=Symbol("_vte"),vu=t=>t.__isTeleport;function ns(t,e){t.shapeFlag&6&&t.component?(t.transition=e,ns(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function is(t,e){return gt(t)?$t({name:t.name},e,{setup:t}):t}function Wo(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function rs(t,e,n,i,r=!1){if(ft(t)){t.forEach((p,v)=>rs(p,e&&(ft(e)?e[v]:e),n,i,r));return}if(Gn(i)&&!r)return;const s=i.shapeFlag&4?ur(i.component):i.el,o=r?null:s,{i:a,r:l}=t,c=e&&e.r,h=a.refs===Tt?a.refs={}:a.refs,g=a.setupState,f=wt(g),d=g===Tt?()=>!1:p=>Ct(f,p);if(c!=null&&c!==l&&(Lt(c)?(h[c]=null,d(c)&&(g[c]=null)):Ht(c)&&(c.value=null)),gt(l))un(l,a,12,[o,h]);else{const p=Lt(l),v=Ht(l);if(p||v){const w=()=>{if(t.f){const x=p?d(l)?g[l]:h[l]:l.value;r?ft(x)&&Or(x,s):ft(x)?x.includes(s)||x.push(s):p?(h[l]=[s],d(l)&&(g[l]=h[l])):(l.value=[s],t.k&&(h[t.k]=l.value))}else p?(h[l]=o,d(l)&&(g[l]=o)):v&&(l.value=o,t.k&&(h[t.k]=o))};o?(w.id=-1,ie(w,n)):w()}}}const Gn=t=>!!t.type.__asyncLoader,jo=t=>t.type.__isKeepAlive;function yu(t,e){Zo(t,"a",e)}function bu(t,e){Zo(t,"da",e)}function Zo(t,e,n=Xt){const i=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(nr(e,i,n),n){let r=n.parent;for(;r&&r.parent;)jo(r.parent.vnode)&&Su(i,e,n,r),r=r.parent}}function Su(t,e,n,i){const r=nr(e,t,i,!0);ss(()=>{Or(i[e],r)},n)}function nr(t,e,n=Xt,i=!1){if(n){const r=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...o)=>{xe();const a=Wn(n),l=_e(e,n,t,o);return a(),Ce(),l});return i?r.unshift(s):r.push(s),s}}const Ee=t=>(e,n=Xt)=>{(!hr||t==="sp")&&nr(t,(...i)=>e(...i),n)},wu=Ee("bm"),qo=Ee("m"),xu=Ee("bu"),Cu=Ee("u"),Pu=Ee("bum"),ss=Ee("um"),Tu=Ee("sp"),ku=Ee("rtg"),Eu=Ee("rtc");function Ru(t,e=Xt){nr("ec",t,e)}const Au=Symbol.for("v-ndc"),os=t=>t?Ta(t)?ur(t):os(t.parent):null,Un=$t(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>os(t.parent),$root:t=>os(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Qo(t),$forceUpdate:t=>t.f||(t.f=()=>{es(t.update)}),$nextTick:t=>t.n||(t.n=ts.bind(t.proxy)),$watch:t=>Qu.bind(t)}),as=(t,e)=>t!==Tt&&!t.__isScriptSetup&&Ct(t,e),Nu={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const d=o[e];if(d!==void 0)switch(d){case 1:return i[e];case 2:return r[e];case 4:return n[e];case 3:return s[e]}else{if(as(i,e))return o[e]=1,i[e];if(r!==Tt&&Ct(r,e))return o[e]=2,r[e];if((c=t.propsOptions[0])&&Ct(c,e))return o[e]=3,s[e];if(n!==Tt&&Ct(n,e))return o[e]=4,n[e];ls&&(o[e]=0)}}const h=Un[e];let g,f;if(h)return e==="$attrs"&&Wt(t.attrs,"get",""),h(t);if((g=a.__cssModules)&&(g=g[e]))return g;if(n!==Tt&&Ct(n,e))return o[e]=4,n[e];if(f=l.config.globalProperties,Ct(f,e))return f[e]},set({_:t},e,n){const{data:i,setupState:r,ctx:s}=t;return as(r,e)?(r[e]=n,!0):i!==Tt&&Ct(i,e)?(i[e]=n,!0):Ct(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!n[o]||t!==Tt&&Ct(t,o)||as(e,o)||(a=s[0])&&Ct(a,o)||Ct(i,o)||Ct(Un,o)||Ct(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ct(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Ko(t){return ft(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let ls=!0;function Mu(t){const e=Qo(t),n=t.proxy,i=t.ctx;ls=!1,e.beforeCreate&&Yo(e.beforeCreate,t,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:g,mounted:f,beforeUpdate:d,updated:p,activated:v,deactivated:w,beforeDestroy:x,beforeUnmount:m,destroyed:u,unmounted:_,render:S,renderTracked:k,renderTriggered:O,errorCaptured:b,serverPrefetch:C,expose:T,inheritAttrs:A,components:D,directives:L,filters:U}=e;if(c&&Iu(c,i,null),o)for(const y in o){const P=o[y];gt(P)&&(i[y]=P.bind(n))}if(r){const y=r.call(n,n);Mt(y)&&(t.data=hn(y))}if(ls=!0,s)for(const y in s){const P=s[y],M=gt(P)?P.bind(n,n):gt(P.get)?P.get.bind(n,n):pe,R=!gt(P)&&gt(P.set)?P.set.bind(n):pe,F=Dt({get:M,set:R});Object.defineProperty(i,y,{enumerable:!0,configurable:!0,get:()=>F.value,set:H=>F.value=H})}if(a)for(const y in a)Xo(a[y],i,n,y);if(l){const y=gt(l)?l.call(n):l;Reflect.ownKeys(y).forEach(P=>{Gu(P,y[P])})}h&&Yo(h,t,"c");function K(y,P){ft(P)?P.forEach(M=>y(M.bind(n))):P&&y(P.bind(n))}if(K(wu,g),K(qo,f),K(xu,d),K(Cu,p),K(yu,v),K(bu,w),K(Ru,b),K(Eu,k),K(ku,O),K(Pu,m),K(ss,_),K(Tu,C),ft(T))if(T.length){const y=t.exposed||(t.exposed={});T.forEach(P=>{Object.defineProperty(y,P,{get:()=>n[P],set:M=>n[P]=M})})}else t.exposed||(t.exposed={});S&&t.render===pe&&(t.render=S),A!=null&&(t.inheritAttrs=A),D&&(t.components=D),L&&(t.directives=L),C&&Wo(t)}function Iu(t,e,n=pe){ft(t)&&(t=cs(t));for(const i in t){const r=t[i];let s;Mt(r)?"default"in r?s=rr(r.from||i,r.default,!0):s=rr(r.from||i):s=rr(r),Ht(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[i]=s}}function Yo(t,e,n){_e(ft(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function Xo(t,e,n,i){let r=i.includes(".")?ma(n,i):()=>n[i];if(Lt(t)){const s=e[t];gt(s)&&Le(r,s)}else if(gt(t))Le(r,t.bind(n));else if(Mt(t))if(ft(t))t.forEach(s=>Xo(s,e,n,i));else{const s=gt(t.handler)?t.handler.bind(n):e[t.handler];gt(s)&&Le(r,s,t)}}function Qo(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!n&&!i?l=e:(l={},r.length&&r.forEach(c=>ir(l,c,o,!0)),ir(l,e,o)),Mt(e)&&s.set(e,l),l}function ir(t,e,n,i=!1){const{mixins:r,extends:s}=e;s&&ir(t,s,n,!0),r&&r.forEach(o=>ir(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=Ou[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Ou={data:Jo,props:ta,emits:ta,methods:Bn,computed:Bn,beforeCreate:Yt,created:Yt,beforeMount:Yt,mounted:Yt,beforeUpdate:Yt,updated:Yt,beforeDestroy:Yt,beforeUnmount:Yt,destroyed:Yt,unmounted:Yt,activated:Yt,deactivated:Yt,errorCaptured:Yt,serverPrefetch:Yt,components:Bn,directives:Bn,watch:Du,provide:Jo,inject:Fu};function Jo(t,e){return e?t?function(){return $t(gt(t)?t.call(this,this):t,gt(e)?e.call(this,this):e)}:e:t}function Fu(t,e){return Bn(cs(t),cs(e))}function cs(t){if(ft(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Yt(t,e){return t?[...new Set([].concat(t,e))]:e}function Bn(t,e){return t?$t(Object.create(null),t,e):e}function ta(t,e){return t?ft(t)&&ft(e)?[...new Set([...t,...e])]:$t(Object.create(null),Ko(t),Ko(e??{})):e}function Du(t,e){if(!t)return e;if(!e)return t;const n=$t(Object.create(null),t);for(const i in e)n[i]=Yt(t[i],e[i]);return n}function ea(){return{app:null,config:{isNativeTag:yh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let zu=0;function Lu(t,e){return function(i,r=null){gt(i)||(i=$t({},i)),r!=null&&!Mt(r)&&(r=null);const s=ea(),o=new WeakSet,a=[];let l=!1;const c=s.app={_uid:zu++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:wd,get config(){return s.config},set config(h){},use(h,...g){return o.has(h)||(h&&gt(h.install)?(o.add(h),h.install(c,...g)):gt(h)&&(o.add(h),h(c,...g))),c},mixin(h){return s.mixins.includes(h)||s.mixins.push(h),c},component(h,g){return g?(s.components[h]=g,c):s.components[h]},directive(h,g){return g?(s.directives[h]=g,c):s.directives[h]},mount(h,g,f){if(!l){const d=c._ceVNode||de(i,r);return d.appContext=s,f===!0?f="svg":f===!1&&(f=void 0),t(d,h,f),l=!0,c._container=h,h.__vue_app__=c,ur(d.component)}},onUnmount(h){a.push(h)},unmount(){l&&(_e(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(h,g){return s.provides[h]=g,c},runWithContext(h){const g=gn;gn=c;try{return h()}finally{gn=g}}};return c}}let gn=null;function Gu(t,e){if(Xt){let n=Xt.provides;const i=Xt.parent&&Xt.parent.provides;i===n&&(n=Xt.provides=Object.create(i)),n[t]=e}}function rr(t,e,n=!1){const i=Xt||ae;if(i||gn){const r=gn?gn._context.provides:i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return n&&gt(e)?e.call(i&&i.proxy):e}}const na={},ia=()=>Object.create(na),ra=t=>Object.getPrototypeOf(t)===na;function Uu(t,e,n,i=!1){const r={},s=ia();t.propsDefaults=Object.create(null),sa(t,e,r,s);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=i?r:tu(r):t.type.props?t.props=r:t.props=s,t.attrs=s}function Bu(t,e,n,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=t,a=wt(r),[l]=t.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let g=0;g<h.length;g++){let f=h[g];if(sr(t.emitsOptions,f))continue;const d=e[f];if(l)if(Ct(s,f))d!==s[f]&&(s[f]=d,c=!0);else{const p=ce(f);r[p]=hs(l,a,p,d,t,!1)}else d!==s[f]&&(s[f]=d,c=!0)}}}else{sa(t,e,r,s)&&(c=!0);let h;for(const g in a)(!e||!Ct(e,g)&&((h=oe(g))===g||!Ct(e,h)))&&(l?n&&(n[g]!==void 0||n[h]!==void 0)&&(r[g]=hs(l,a,g,void 0,t,!0)):delete r[g]);if(s!==a)for(const g in s)(!e||!Ct(e,g))&&(delete s[g],c=!0)}c&&Pe(t.attrs,"set","")}function sa(t,e,n,i){const[r,s]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(An(l))continue;const c=e[l];let h;r&&Ct(r,h=ce(l))?!s||!s.includes(h)?n[h]=c:(a||(a={}))[h]=c:sr(t.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(s){const l=wt(n),c=a||Tt;for(let h=0;h<s.length;h++){const g=s[h];n[g]=hs(r,l,g,c[g],t,!Ct(c,g))}}return o}function hs(t,e,n,i,r,s){const o=t[n];if(o!=null){const a=Ct(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&gt(l)){const{propsDefaults:c}=r;if(n in c)i=c[n];else{const h=Wn(r);i=c[n]=l.call(null,e),h()}}else i=l;r.ce&&r.ce._setProp(n,i)}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===oe(n))&&(i=!0))}return i}const $u=new WeakMap;function oa(t,e,n=!1){const i=n?$u:e.propsCache,r=i.get(t);if(r)return r;const s=t.props,o={},a=[];let l=!1;if(!gt(t)){const h=g=>{l=!0;const[f,d]=oa(g,e,!0);$t(o,f),d&&a.push(...d)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!s&&!l)return Mt(t)&&i.set(t,an),an;if(ft(s))for(let h=0;h<s.length;h++){const g=ce(s[h]);aa(g)&&(o[g]=Tt)}else if(s)for(const h in s){const g=ce(h);if(aa(g)){const f=s[h],d=o[g]=ft(f)||gt(f)?{type:f}:$t({},f),p=d.type;let v=!1,w=!0;if(ft(p))for(let x=0;x<p.length;++x){const m=p[x],u=gt(m)&&m.name;if(u==="Boolean"){v=!0;break}else u==="String"&&(w=!1)}else v=gt(p)&&p.name==="Boolean";d[0]=v,d[1]=w,(v||Ct(d,"default"))&&a.push(g)}}const c=[o,a];return Mt(t)&&i.set(t,c),c}function aa(t){return t[0]!=="$"&&!An(t)}const la=t=>t[0]==="_"||t==="$stable",us=t=>ft(t)?t.map(ye):[ye(t)],Vu=(t,e,n)=>{if(e._n)return e;const i=mu((...r)=>us(e(...r)),n);return i._c=!1,i},ca=(t,e,n)=>{const i=t._ctx;for(const r in t){if(la(r))continue;const s=t[r];if(gt(s))e[r]=Vu(r,s,i);else if(s!=null){const o=us(s);e[r]=()=>o}}},ha=(t,e)=>{const n=us(e);t.slots.default=()=>n},ua=(t,e,n)=>{for(const i in e)(n||i!=="_")&&(t[i]=e[i])},Hu=(t,e,n)=>{const i=t.slots=ia();if(t.vnode.shapeFlag&32){const r=e._;r?(ua(i,e,n),n&&ro(i,"_",r,!0)):ca(e,i)}else e&&ha(t,e)},Wu=(t,e,n)=>{const{vnode:i,slots:r}=t;let s=!0,o=Tt;if(i.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:ua(r,e,n):(s=!e.$stable,ca(e,r)),o=e}else e&&(ha(t,e),o={default:1});if(s)for(const a in r)!la(a)&&o[a]==null&&delete r[a]},ie=sd;function ju(t){return Zu(t)}function Zu(t,e){const n=ao();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:g,nextSibling:f,setScopeId:d=pe,insertStaticContent:p}=t,v=(E,I,B,W=null,q=null,j=null,Q=void 0,et=null,J=!!I.dynamicChildren)=>{if(E===I)return;E&&!Hn(E,I)&&(W=N(E),H(E,q,j,!0),E=null),I.patchFlag===-2&&(J=!1,I.dynamicChildren=null);const{type:X,ref:at,shapeFlag:nt}=I;switch(X){case or:w(E,I,B,W);break;case Je:x(E,I,B,W);break;case fs:E==null&&m(I,B,W,Q);break;case Re:D(E,I,B,W,q,j,Q,et,J);break;default:nt&1?S(E,I,B,W,q,j,Q,et,J):nt&6?L(E,I,B,W,q,j,Q,et,J):(nt&64||nt&128)&&X.process(E,I,B,W,q,j,Q,et,J,st)}at!=null&&q&&rs(at,E&&E.ref,j,I||E,!I)},w=(E,I,B,W)=>{if(E==null)i(I.el=a(I.children),B,W);else{const q=I.el=E.el;I.children!==E.children&&c(q,I.children)}},x=(E,I,B,W)=>{E==null?i(I.el=l(I.children||""),B,W):I.el=E.el},m=(E,I,B,W)=>{[E.el,E.anchor]=p(E.children,I,B,W,E.el,E.anchor)},u=({el:E,anchor:I},B,W)=>{let q;for(;E&&E!==I;)q=f(E),i(E,B,W),E=q;i(I,B,W)},_=({el:E,anchor:I})=>{let B;for(;E&&E!==I;)B=f(E),r(E),E=B;r(I)},S=(E,I,B,W,q,j,Q,et,J)=>{I.type==="svg"?Q="svg":I.type==="math"&&(Q="mathml"),E==null?k(I,B,W,q,j,Q,et,J):C(E,I,q,j,Q,et,J)},k=(E,I,B,W,q,j,Q,et)=>{let J,X;const{props:at,shapeFlag:nt,transition:lt,dirs:ut}=E;if(J=E.el=o(E.type,j,at&&at.is,at),nt&8?h(J,E.children):nt&16&&b(E.children,J,null,W,q,ds(E,j),Q,et),ut&&Xe(E,null,W,"created"),O(J,E,E.scopeId,Q,W),at){for(const _t in at)_t!=="value"&&!An(_t)&&s(J,_t,null,at[_t],j,W);"value"in at&&s(J,"value",null,at.value,j),(X=at.onVnodeBeforeMount)&&be(X,W,E)}ut&&Xe(E,null,W,"beforeMount");const dt=qu(q,lt);dt&&lt.beforeEnter(J),i(J,I,B),((X=at&&at.onVnodeMounted)||dt||ut)&&ie(()=>{X&&be(X,W,E),dt&&lt.enter(J),ut&&Xe(E,null,W,"mounted")},q)},O=(E,I,B,W,q)=>{if(B&&d(E,B),W)for(let j=0;j<W.length;j++)d(E,W[j]);if(q){let j=q.subTree;if(I===j||ba(j.type)&&(j.ssContent===I||j.ssFallback===I)){const Q=q.vnode;O(E,Q,Q.scopeId,Q.slotScopeIds,q.parent)}}},b=(E,I,B,W,q,j,Q,et,J=0)=>{for(let X=J;X<E.length;X++){const at=E[X]=et?Ue(E[X]):ye(E[X]);v(null,at,I,B,W,q,j,Q,et)}},C=(E,I,B,W,q,j,Q)=>{const et=I.el=E.el;let{patchFlag:J,dynamicChildren:X,dirs:at}=I;J|=E.patchFlag&16;const nt=E.props||Tt,lt=I.props||Tt;let ut;if(B&&Qe(B,!1),(ut=lt.onVnodeBeforeUpdate)&&be(ut,B,I,E),at&&Xe(I,E,B,"beforeUpdate"),B&&Qe(B,!0),(nt.innerHTML&&lt.innerHTML==null||nt.textContent&&lt.textContent==null)&&h(et,""),X?T(E.dynamicChildren,X,et,B,W,ds(I,q),j):Q||P(E,I,et,null,B,W,ds(I,q),j,!1),J>0){if(J&16)A(et,nt,lt,B,q);else if(J&2&&nt.class!==lt.class&&s(et,"class",null,lt.class,q),J&4&&s(et,"style",nt.style,lt.style,q),J&8){const dt=I.dynamicProps;for(let _t=0;_t<dt.length;_t++){const pt=dt[_t],At=nt[pt],xt=lt[pt];(xt!==At||pt==="value")&&s(et,pt,At,xt,q,B)}}J&1&&E.children!==I.children&&h(et,I.children)}else!Q&&X==null&&A(et,nt,lt,B,q);((ut=lt.onVnodeUpdated)||at)&&ie(()=>{ut&&be(ut,B,I,E),at&&Xe(I,E,B,"updated")},W)},T=(E,I,B,W,q,j,Q)=>{for(let et=0;et<I.length;et++){const J=E[et],X=I[et],at=J.el&&(J.type===Re||!Hn(J,X)||J.shapeFlag&70)?g(J.el):B;v(J,X,at,null,W,q,j,Q,!0)}},A=(E,I,B,W,q)=>{if(I!==B){if(I!==Tt)for(const j in I)!An(j)&&!(j in B)&&s(E,j,I[j],null,q,W);for(const j in B){if(An(j))continue;const Q=B[j],et=I[j];Q!==et&&j!=="value"&&s(E,j,et,Q,q,W)}"value"in B&&s(E,"value",I.value,B.value,q)}},D=(E,I,B,W,q,j,Q,et,J)=>{const X=I.el=E?E.el:a(""),at=I.anchor=E?E.anchor:a("");let{patchFlag:nt,dynamicChildren:lt,slotScopeIds:ut}=I;ut&&(et=et?et.concat(ut):ut),E==null?(i(X,B,W),i(at,B,W),b(I.children||[],B,at,q,j,Q,et,J)):nt>0&&nt&64&&lt&&E.dynamicChildren?(T(E.dynamicChildren,lt,B,q,j,Q,et),(I.key!=null||q&&I===q.subTree)&&da(E,I,!0)):P(E,I,B,at,q,j,Q,et,J)},L=(E,I,B,W,q,j,Q,et,J)=>{I.slotScopeIds=et,E==null?I.shapeFlag&512?q.ctx.activate(I,B,W,Q,J):U(I,B,W,q,j,Q,J):z(E,I,J)},U=(E,I,B,W,q,j,Q)=>{const et=E.component=fd(E,W,q);if(jo(E)&&(et.ctx.renderer=st),gd(et,!1,Q),et.asyncDep){if(q&&q.registerDep(et,K,Q),!E.el){const J=et.subTree=de(Je);x(null,J,I,B)}}else K(et,E,I,B,q,j,Q)},z=(E,I,B)=>{const W=I.component=E.component;if(id(E,I,B))if(W.asyncDep&&!W.asyncResolved){y(W,I,B);return}else W.next=I,W.update();else I.el=E.el,W.vnode=I},K=(E,I,B,W,q,j,Q)=>{const et=()=>{if(E.isMounted){let{next:nt,bu:lt,u:ut,parent:dt,vnode:_t}=E;{const Bt=fa(E);if(Bt){nt&&(nt.el=_t.el,y(E,nt,Q)),Bt.asyncDep.then(()=>{E.isUnmounted||et()});return}}let pt=nt,At;Qe(E,!1),nt?(nt.el=_t.el,y(E,nt,Q)):nt=_t,lt&&Ui(lt),(At=nt.props&&nt.props.onVnodeBeforeUpdate)&&be(At,dt,nt,_t),Qe(E,!0);const xt=va(E),Pt=E.subTree;E.subTree=xt,v(Pt,xt,g(Pt.el),N(Pt),E,q,j),nt.el=xt.el,pt===null&&rd(E,xt.el),ut&&ie(ut,q),(At=nt.props&&nt.props.onVnodeUpdated)&&ie(()=>be(At,dt,nt,_t),q)}else{let nt;const{el:lt,props:ut}=I,{bm:dt,m:_t,parent:pt,root:At,type:xt}=E,Pt=Gn(I);Qe(E,!1),dt&&Ui(dt),!Pt&&(nt=ut&&ut.onVnodeBeforeMount)&&be(nt,pt,I),Qe(E,!0);{At.ce&&At.ce._injectChildStyle(xt);const Bt=E.subTree=va(E);v(null,Bt,B,W,E,q,j),I.el=Bt.el}if(_t&&ie(_t,q),!Pt&&(nt=ut&&ut.onVnodeMounted)){const Bt=I;ie(()=>be(nt,pt,Bt),q)}(I.shapeFlag&256||pt&&Gn(pt.vnode)&&pt.vnode.shapeFlag&256)&&E.a&&ie(E.a,q),E.isMounted=!0,I=B=W=null}};E.scope.on();const J=E.effect=new uo(et);E.scope.off();const X=E.update=J.run.bind(J),at=E.job=J.runIfDirty.bind(J);at.i=E,at.id=E.uid,J.scheduler=()=>es(at),Qe(E,!0),X()},y=(E,I,B)=>{I.component=E;const W=E.vnode.props;E.vnode=I,E.next=null,Bu(E,I.props,W,B),Wu(E,I.children,B),xe(),Uo(E),Ce()},P=(E,I,B,W,q,j,Q,et,J=!1)=>{const X=E&&E.children,at=E?E.shapeFlag:0,nt=I.children,{patchFlag:lt,shapeFlag:ut}=I;if(lt>0){if(lt&128){R(X,nt,B,W,q,j,Q,et,J);return}else if(lt&256){M(X,nt,B,W,q,j,Q,et,J);return}}ut&8?(at&16&&V(X,q,j),nt!==X&&h(B,nt)):at&16?ut&16?R(X,nt,B,W,q,j,Q,et,J):V(X,q,j,!0):(at&8&&h(B,""),ut&16&&b(nt,B,W,q,j,Q,et,J))},M=(E,I,B,W,q,j,Q,et,J)=>{E=E||an,I=I||an;const X=E.length,at=I.length,nt=Math.min(X,at);let lt;for(lt=0;lt<nt;lt++){const ut=I[lt]=J?Ue(I[lt]):ye(I[lt]);v(E[lt],ut,B,null,q,j,Q,et,J)}X>at?V(E,q,j,!0,!1,nt):b(I,B,W,q,j,Q,et,J,nt)},R=(E,I,B,W,q,j,Q,et,J)=>{let X=0;const at=I.length;let nt=E.length-1,lt=at-1;for(;X<=nt&&X<=lt;){const ut=E[X],dt=I[X]=J?Ue(I[X]):ye(I[X]);if(Hn(ut,dt))v(ut,dt,B,null,q,j,Q,et,J);else break;X++}for(;X<=nt&&X<=lt;){const ut=E[nt],dt=I[lt]=J?Ue(I[lt]):ye(I[lt]);if(Hn(ut,dt))v(ut,dt,B,null,q,j,Q,et,J);else break;nt--,lt--}if(X>nt){if(X<=lt){const ut=lt+1,dt=ut<at?I[ut].el:W;for(;X<=lt;)v(null,I[X]=J?Ue(I[X]):ye(I[X]),B,dt,q,j,Q,et,J),X++}}else if(X>lt)for(;X<=nt;)H(E[X],q,j,!0),X++;else{const ut=X,dt=X,_t=new Map;for(X=dt;X<=lt;X++){const ot=I[X]=J?Ue(I[X]):ye(I[X]);ot.key!=null&&_t.set(ot.key,X)}let pt,At=0;const xt=lt-dt+1;let Pt=!1,Bt=0;const fe=new Array(xt);for(X=0;X<xt;X++)fe[X]=0;for(X=ut;X<=nt;X++){const ot=E[X];if(At>=xt){H(ot,q,j,!0);continue}let rt;if(ot.key!=null)rt=_t.get(ot.key);else for(pt=dt;pt<=lt;pt++)if(fe[pt-dt]===0&&Hn(ot,I[pt])){rt=pt;break}rt===void 0?H(ot,q,j,!0):(fe[rt-dt]=X+1,rt>=Bt?Bt=rt:Pt=!0,v(ot,I[rt],B,null,q,j,Q,et,J),At++)}const Se=Pt?Ku(fe):an;for(pt=Se.length-1,X=xt-1;X>=0;X--){const ot=dt+X,rt=I[ot],St=ot+1<at?I[ot+1].el:W;fe[X]===0?v(null,rt,B,St,q,j,Q,et,J):Pt&&(pt<0||X!==Se[pt]?F(rt,B,St,2):pt--)}}},F=(E,I,B,W,q=null)=>{const{el:j,type:Q,transition:et,children:J,shapeFlag:X}=E;if(X&6){F(E.component.subTree,I,B,W);return}if(X&128){E.suspense.move(I,B,W);return}if(X&64){Q.move(E,I,B,st);return}if(Q===Re){i(j,I,B);for(let nt=0;nt<J.length;nt++)F(J[nt],I,B,W);i(E.anchor,I,B);return}if(Q===fs){u(E,I,B);return}if(W!==2&&X&1&&et)if(W===0)et.beforeEnter(j),i(j,I,B),ie(()=>et.enter(j),q);else{const{leave:nt,delayLeave:lt,afterLeave:ut}=et,dt=()=>i(j,I,B),_t=()=>{nt(j,()=>{dt(),ut&&ut()})};lt?lt(j,dt,_t):_t()}else i(j,I,B)},H=(E,I,B,W=!1,q=!1)=>{const{type:j,props:Q,ref:et,children:J,dynamicChildren:X,shapeFlag:at,patchFlag:nt,dirs:lt,cacheIndex:ut}=E;if(nt===-2&&(q=!1),et!=null&&rs(et,null,B,E,!0),ut!=null&&(I.renderCache[ut]=void 0),at&256){I.ctx.deactivate(E);return}const dt=at&1&&lt,_t=!Gn(E);let pt;if(_t&&(pt=Q&&Q.onVnodeBeforeUnmount)&&be(pt,I,E),at&6)it(E.component,B,W);else{if(at&128){E.suspense.unmount(B,W);return}dt&&Xe(E,null,I,"beforeUnmount"),at&64?E.type.remove(E,I,B,st,W):X&&!X.hasOnce&&(j!==Re||nt>0&&nt&64)?V(X,I,B,!1,!0):(j===Re&&nt&384||!q&&at&16)&&V(J,I,B),W&&G(E)}(_t&&(pt=Q&&Q.onVnodeUnmounted)||dt)&&ie(()=>{pt&&be(pt,I,E),dt&&Xe(E,null,I,"unmounted")},B)},G=E=>{const{type:I,el:B,anchor:W,transition:q}=E;if(I===Re){Y(B,W);return}if(I===fs){_(E);return}const j=()=>{r(B),q&&!q.persisted&&q.afterLeave&&q.afterLeave()};if(E.shapeFlag&1&&q&&!q.persisted){const{leave:Q,delayLeave:et}=q,J=()=>Q(B,j);et?et(E.el,j,J):J()}else j()},Y=(E,I)=>{let B;for(;E!==I;)B=f(E),r(E),E=B;r(I)},it=(E,I,B)=>{const{bum:W,scope:q,job:j,subTree:Q,um:et,m:J,a:X}=E;ga(J),ga(X),W&&Ui(W),q.stop(),j&&(j.flags|=8,H(Q,E,I,B)),et&&ie(et,I),ie(()=>{E.isUnmounted=!0},I),I&&I.pendingBranch&&!I.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===I.pendingId&&(I.deps--,I.deps===0&&I.resolve())},V=(E,I,B,W=!1,q=!1,j=0)=>{for(let Q=j;Q<E.length;Q++)H(E[Q],I,B,W,q)},N=E=>{if(E.shapeFlag&6)return N(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const I=f(E.anchor||E.el),B=I&&I[_u];return B?f(B):I};let $=!1;const tt=(E,I,B)=>{E==null?I._vnode&&H(I._vnode,null,null,!0):v(I._vnode||null,E,I,null,null,null,B),I._vnode=E,$||($=!0,Uo(),Bo(),$=!1)},st={p:v,um:H,m:F,r:G,mt:U,mc:b,pc:P,pbc:T,n:N,o:t};return{render:tt,hydrate:void 0,createApp:Lu(tt)}}function ds({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Qe({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function qu(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function da(t,e,n=!1){const i=t.children,r=e.children;if(ft(i)&&ft(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=Ue(r[s]),a.el=o.el),!n&&a.patchFlag!==-2&&da(o,a)),a.type===or&&(a.el=o.el)}}function Ku(t){const e=t.slice(),n=[0];let i,r,s,o,a;const l=t.length;for(i=0;i<l;i++){const c=t[i];if(c!==0){if(r=n[n.length-1],t[r]<c){e[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,t[n[a]]<c?s=a+1:o=a;c<t[n[s]]&&(s>0&&(e[i]=n[s-1]),n[s]=i)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=e[o];return n}function fa(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:fa(e)}function ga(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Yu=Symbol.for("v-scx"),Xu=()=>rr(Yu);function Le(t,e,n){return pa(t,e,n)}function pa(t,e,n=Tt){const{immediate:i,deep:r,flush:s,once:o}=n,a=$t({},n);let l;if(hr)if(s==="sync"){const f=Xu();l=f.__watcherHandles||(f.__watcherHandles=[])}else if(!e||i)a.once=!0;else{const f=()=>{};return f.stop=pe,f.resume=pe,f.pause=pe,f}const c=Xt;a.call=(f,d,p)=>_e(f,c,d,p);let h=!1;s==="post"?a.scheduler=f=>{ie(f,c&&c.suspense)}:s!=="sync"&&(h=!0,a.scheduler=(f,d)=>{d?f():es(f)}),a.augmentJob=f=>{e&&(f.flags|=4),h&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const g=lu(t,e,a);return l&&l.push(g),g}function Qu(t,e,n){const i=this.proxy,r=Lt(t)?t.includes(".")?ma(i,t):()=>i[t]:t.bind(i,i);let s;gt(e)?s=e:(s=e.handler,n=e);const o=Wn(this),a=pa(r,s.bind(i),n);return o(),a}function ma(t,e){const n=e.split(".");return()=>{let i=t;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}const Ju=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${ce(e)}Modifiers`]||t[`${oe(e)}Modifiers`];function td(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||Tt;let r=n;const s=e.startsWith("update:"),o=s&&Ju(i,e.slice(7));o&&(o.trim&&(r=n.map(h=>Lt(h)?h.trim():h)),o.number&&(r=n.map(Bi)));let a,l=i[a=Dr(e)]||i[a=Dr(ce(e))];!l&&s&&(l=i[a=Dr(oe(e))]),l&&_e(l,t,6,r);const c=i[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,_e(c,t,6,r)}}function _a(t,e,n=!1){const i=e.emitsCache,r=i.get(t);if(r!==void 0)return r;const s=t.emits;let o={},a=!1;if(!gt(t)){const l=c=>{const h=_a(c,e,!0);h&&(a=!0,$t(o,h))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!s&&!a?(Mt(t)&&i.set(t,null),null):(ft(s)?s.forEach(l=>o[l]=null):$t(o,s),Mt(t)&&i.set(t,o),o)}function sr(t,e){return!t||!Di(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ct(t,e[0].toLowerCase()+e.slice(1))||Ct(t,oe(e))||Ct(t,e))}function Pm(){}function va(t){const{type:e,vnode:n,proxy:i,withProxy:r,propsOptions:[s],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:g,data:f,setupState:d,ctx:p,inheritAttrs:v}=t,w=er(t);let x,m;try{if(n.shapeFlag&4){const _=r||i,S=_;x=ye(c.call(S,_,h,g,d,f,p)),m=a}else{const _=e;x=ye(_.length>1?_(g,{attrs:a,slots:o,emit:l}):_(g,null)),m=e.props?a:ed(a)}}catch(_){$n.length=0,Ji(_,t,1),x=de(Je)}let u=x;if(m&&v!==!1){const _=Object.keys(m),{shapeFlag:S}=u;_.length&&S&7&&(s&&_.some(Ir)&&(m=nd(m,s)),u=pn(u,m,!1,!0))}return n.dirs&&(u=pn(u,null,!1,!0),u.dirs=u.dirs?u.dirs.concat(n.dirs):n.dirs),n.transition&&ns(u,n.transition),x=u,er(w),x}const ed=t=>{let e;for(const n in t)(n==="class"||n==="style"||Di(n))&&((e||(e={}))[n]=t[n]);return e},nd=(t,e)=>{const n={};for(const i in t)(!Ir(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function id(t,e,n){const{props:i,children:r,component:s}=t,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?ya(i,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let g=0;g<h.length;g++){const f=h[g];if(o[f]!==i[f]&&!sr(c,f))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?ya(i,o,c):!0:!!o;return!1}function ya(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==t[s]&&!sr(n,s))return!0}return!1}function rd({vnode:t,parent:e},n){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=n,e=e.parent;else break}}const ba=t=>t.__isSuspense;function sd(t,e){e&&e.pendingBranch?ft(t)?e.effects.push(...t):e.effects.push(t):pu(t)}const Re=Symbol.for("v-fgt"),or=Symbol.for("v-txt"),Je=Symbol.for("v-cmt"),fs=Symbol.for("v-stc"),$n=[];let re=null;function Ge(t=!1){$n.push(re=t?null:[])}function od(){$n.pop(),re=$n[$n.length-1]||null}let Vn=1;function Sa(t){Vn+=t,t<0&&re&&(re.hasOnce=!0)}function wa(t){return t.dynamicChildren=Vn>0?re||an:null,od(),Vn>0&&re&&re.push(t),t}function tn(t,e,n,i,r,s){return wa(mt(t,e,n,i,r,s,!0))}function ad(t,e,n,i,r){return wa(de(t,e,n,i,r,!0))}function xa(t){return t?t.__v_isVNode===!0:!1}function Hn(t,e){return t.type===e.type&&t.key===e.key}const Ca=({key:t})=>t??null,ar=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Lt(t)||Ht(t)||gt(t)?{i:ae,r:t,k:e,f:!!n}:t:null);function mt(t,e=null,n=null,i=0,r=null,s=t===Re?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Ca(e),ref:e&&ar(e),scopeId:Vo,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:ae};return a?(ps(l,n),s&128&&t.normalize(l)):n&&(l.shapeFlag|=Lt(n)?8:16),Vn>0&&!o&&re&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&re.push(l),l}const de=ld;function ld(t,e=null,n=null,i=0,r=null,s=!1){if((!t||t===Au)&&(t=Je),xa(t)){const a=pn(t,e,!0);return n&&ps(a,n),Vn>0&&!s&&re&&(a.shapeFlag&6?re[re.indexOf(t)]=a:re.push(a)),a.patchFlag=-2,a}if(Sd(t)&&(t=t.__vccOpts),e){e=cd(e);let{class:a,style:l}=e;a&&!Lt(a)&&(e.class=Ze(a)),Mt(l)&&(Xr(l)&&!ft(l)&&(l=$t({},l)),e.style=we(l))}const o=Lt(t)?1:ba(t)?128:vu(t)?64:Mt(t)?4:gt(t)?2:0;return mt(t,e,n,i,r,o,s,!0)}function cd(t){return t?Xr(t)||ra(t)?$t({},t):t:null}function pn(t,e,n=!1,i=!1){const{props:r,ref:s,patchFlag:o,children:a,transition:l}=t,c=e?hd(r||{},e):r,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&Ca(c),ref:e&&e.ref?n&&s?ft(s)?s.concat(ar(e)):[s,ar(e)]:ar(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Re?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&pn(t.ssContent),ssFallback:t.ssFallback&&pn(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&i&&ns(h,l.clone(h)),h}function gs(t=" ",e=0){return de(or,null,t,e)}function lr(t="",e=!1){return e?(Ge(),ad(Je,null,t)):de(Je,null,t)}function ye(t){return t==null||typeof t=="boolean"?de(Je):ft(t)?de(Re,null,t.slice()):xa(t)?Ue(t):de(or,null,String(t))}function Ue(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:pn(t)}function ps(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(ft(e))n=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),ps(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!ra(e)?e._ctx=ae:r===3&&ae&&(ae.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else gt(e)?(e={default:e,_ctx:ae},n=32):(e=String(e),i&64?(n=16,e=[gs(e)]):n=8);t.children=e,t.shapeFlag|=n}function hd(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=Ze([e.class,i.class]));else if(r==="style")e.style=we([e.style,i.style]);else if(Di(r)){const s=e[r],o=i[r];o&&s!==o&&!(ft(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function be(t,e,n,i=null){_e(t,e,7,[n,i])}const ud=ea();let dd=0;function fd(t,e,n){const i=t.type,r=(e?e.appContext:t.appContext)||ud,s={uid:dd++,vnode:t,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Nh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:oa(i,r),emitsOptions:_a(i,r),emit:null,emitted:null,propsDefaults:Tt,inheritAttrs:i.inheritAttrs,ctx:Tt,data:Tt,props:Tt,attrs:Tt,slots:Tt,refs:Tt,setupState:Tt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=td.bind(null,s),t.ce&&t.ce(s),s}let Xt=null,cr,ms;{const t=ao(),e=(n,i)=>{let r;return(r=t[n])||(r=t[n]=[]),r.push(i),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};cr=e("__VUE_INSTANCE_SETTERS__",n=>Xt=n),ms=e("__VUE_SSR_SETTERS__",n=>hr=n)}const Wn=t=>{const e=Xt;return cr(t),t.scope.on(),()=>{t.scope.off(),cr(e)}},Pa=()=>{Xt&&Xt.scope.off(),cr(null)};function Ta(t){return t.vnode.shapeFlag&4}let hr=!1;function gd(t,e=!1,n=!1){e&&ms(e);const{props:i,children:r}=t.vnode,s=Ta(t);Uu(t,i,s,e),Hu(t,r,n);const o=s?pd(t,e):void 0;return e&&ms(!1),o}function pd(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Nu);const{setup:i}=n;if(i){const r=t.setupContext=i.length>1?_d(t):null,s=Wn(t);xe();const o=un(i,t,0,[t.props,r]);if(Ce(),s(),eo(o)){if(Gn(t)||Wo(t),o.then(Pa,Pa),e)return o.then(a=>{ka(t,a)}).catch(a=>{Ji(a,t,0)});t.asyncDep=o}else ka(t,o)}else Ea(t)}function ka(t,e,n){gt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Mt(e)&&(t.setupState=Do(e)),Ea(t)}function Ea(t,e,n){const i=t.type;t.render||(t.render=i.render||pe);{const r=Wn(t);xe();try{Mu(t)}finally{Ce(),r()}}}const md={get(t,e){return Wt(t,"get",""),t[e]}};function _d(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,md),slots:t.slots,emit:t.emit,expose:e}}function ur(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Do(eu(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Un)return Un[n](t)},has(e,n){return n in e||n in Un}})):t.proxy}const vd=/(?:^|[-_])(\w)/g,yd=t=>t.replace(vd,e=>e.toUpperCase()).replace(/[-_]/g,"");function bd(t,e=!0){return gt(t)?t.displayName||t.name:t.name||e&&t.__name}function Ra(t,e,n=!1){let i=bd(e);if(!i&&e.__file){const r=e.__file.match(/([^/\\]+)\.\w+$/);r&&(i=r[1])}if(!i&&t&&t.parent){const r=s=>{for(const o in s)if(s[o]===e)return o};i=r(t.components||t.parent.type.components)||r(t.appContext.components)}return i?yd(i):n?"App":"Anonymous"}function Sd(t){return gt(t)&&"__vccOpts"in t}const Dt=(t,e)=>ou(t,e,hr),wd="3.5.11";/**
* @vue/runtime-dom v3.5.11
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let _s;const Aa=typeof window<"u"&&window.trustedTypes;if(Aa)try{_s=Aa.createPolicy("vue",{createHTML:t=>t})}catch{}const Na=_s?t=>_s.createHTML(t):t=>t,xd="http://www.w3.org/2000/svg",Cd="http://www.w3.org/1998/Math/MathML",Ae=typeof document<"u"?document:null,Ma=Ae&&Ae.createElement("template"),Pd={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const r=e==="svg"?Ae.createElementNS(xd,t):e==="mathml"?Ae.createElementNS(Cd,t):n?Ae.createElement(t,{is:n}):Ae.createElement(t);return t==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:t=>Ae.createTextNode(t),createComment:t=>Ae.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ae.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,r,s){const o=n?n.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{Ma.innerHTML=Na(i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t);const a=Ma.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},Td=Symbol("_vtc");function kd(t,e,n){const i=t[Td];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Ia=Symbol("_vod"),Ed=Symbol("_vsh"),Rd=Symbol(""),Ad=/(^|;)\s*display\s*:/;function Nd(t,e,n){const i=t.style,r=Lt(n);let s=!1;if(n&&!r){if(e)if(Lt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&dr(i,a,"")}else for(const o in e)n[o]==null&&dr(i,o,"");for(const o in n)o==="display"&&(s=!0),dr(i,o,n[o])}else if(r){if(e!==n){const o=i[Rd];o&&(n+=";"+o),i.cssText=n,s=Ad.test(n)}}else e&&t.removeAttribute("style");Ia in t&&(t[Ia]=s?i.display:"",t[Ed]&&(i.display="none"))}const Oa=/\s*!important$/;function dr(t,e,n){if(ft(n))n.forEach(i=>dr(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=Md(t,e);Oa.test(n)?t.setProperty(oe(i),n.replace(Oa,""),"important"):t[i]=n}}const Fa=["Webkit","Moz","ms"],vs={};function Md(t,e){const n=vs[e];if(n)return n;let i=ce(e);if(i!=="filter"&&i in t)return vs[e]=i;i=io(i);for(let r=0;r<Fa.length;r++){const s=Fa[r]+i;if(s in t)return vs[e]=s}return e}const Da="http://www.w3.org/1999/xlink";function za(t,e,n,i,r,s=Eh(e)){i&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Da,e.slice(6,e.length)):t.setAttributeNS(Da,e,n):n==null||s&&!lo(n)?t.removeAttribute(e):t.setAttribute(e,s?"":me(n)?String(n):n)}function La(t,e,n,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Na(n):n);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const o=r==="OPTION"?t.getAttribute("value")||"":t.value,a=n==null?t.type==="checkbox"?"on":"":String(n);(o!==a||!("_value"in t))&&(t.value=a),n==null&&t.removeAttribute(e),t._value=n;return}let s=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=lo(n):n==null&&o==="string"?(n="",s=!0):o==="number"&&(n=0,s=!0)}try{t[e]=n}catch{}s&&t.removeAttribute(e)}function en(t,e,n,i){t.addEventListener(e,n,i)}function Id(t,e,n,i){t.removeEventListener(e,n,i)}const Ga=Symbol("_vei");function Od(t,e,n,i,r=null){const s=t[Ga]||(t[Ga]={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=Fd(e);if(i){const c=s[e]=Ld(i,r);en(t,a,c,l)}else o&&(Id(t,a,o,l),s[e]=void 0)}}const Ua=/(?:Once|Passive|Capture)$/;function Fd(t){let e;if(Ua.test(t)){e={};let i;for(;i=t.match(Ua);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):oe(t.slice(2)),e]}let ys=0;const Dd=Promise.resolve(),zd=()=>ys||(Dd.then(()=>ys=0),ys=Date.now());function Ld(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;_e(Gd(i,n.value),e,5,[i])};return n.value=t,n.attached=zd(),n}function Gd(t,e){if(ft(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const Ba=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Ud=(t,e,n,i,r,s)=>{const o=r==="svg";e==="class"?kd(t,i,o):e==="style"?Nd(t,n,i):Di(e)?Ir(e)||Od(t,e,n,i,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Bd(t,e,i,o))?(La(t,e,i),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&za(t,e,i,o,s,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Lt(i))?La(t,ce(e),i):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),za(t,e,i,o))};function Bd(t,e,n,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&Ba(e)&&gt(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Ba(e)&&Lt(n)?!1:e in t}const $a={};/*! #__NO_SIDE_EFFECTS__ */function $d(t,e,n){const i=is(t,e);Li(i)&&$t(i,e);class r extends bs{constructor(o){super(i,o,n)}}return r.def=i,r}const Vd=typeof HTMLElement<"u"?HTMLElement:class{};class bs extends Vd{constructor(e,n={},i=Za){super(),this._def=e,this._props=n,this._createApp=i,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&i!==Za?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this,this._def.__asyncLoader||this._resolveProps(this._def)}connectedCallback(){if(!this.isConnected)return;this.shadowRoot||this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof bs){this._parent=e;break}this._instance||(this._resolved?(this._setParent(),this._update()):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._instance.provides=e._instance.provides)}disconnectedCallback(){this._connected=!1,ts(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const r of i)this._setAttr(r.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(i,r=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:s,styles:o}=i;let a;if(s&&!ft(s))for(const l in s){const c=s[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=so(this._props[l])),(a||(a=Object.create(null)))[ce(l)]=!0)}this._numberProps=a,r&&this._resolveProps(i),this.shadowRoot&&this._applyStyles(o),this._mount(i)},n=this._def.__asyncLoader;n?this._pendingResolve=n().then(i=>e(this._def=i,!0)):e(this._def)}_mount(e){this._app=this._createApp(e),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const n=this._instance&&this._instance.exposed;if(n)for(const i in n)Ct(this,i)||Object.defineProperty(this,i,{get:()=>De(n[i])})}_resolveProps(e){const{props:n}=e,i=ft(n)?n:Object.keys(n||{});for(const r of Object.keys(this))r[0]!=="_"&&i.includes(r)&&this._setProp(r,this[r]);for(const r of i.map(ce))Object.defineProperty(this,r,{get(){return this._getProp(r)},set(s){this._setProp(r,s,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const n=this.hasAttribute(e);let i=n?this.getAttribute(e):$a;const r=ce(e);n&&this._numberProps&&this._numberProps[r]&&(i=so(i)),this._setProp(r,i,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,n,i=!0,r=!1){n!==this._props[e]&&(n===$a?delete this._props[e]:(this._props[e]=n,e==="key"&&this._app&&(this._app._ceVNode.key=n)),r&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(oe(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(oe(e),n+""):n||this.removeAttribute(oe(e))))}_update(){Yd(this._createVNode(),this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const n=de(this._def,$t(e,this._props));return this._instance||(n.ce=i=>{this._instance=i,i.ce=this,i.isCE=!0;const r=(s,o)=>{this.dispatchEvent(new CustomEvent(s,Li(o[0])?$t({detail:o},o[0]):{detail:o}))};i.emit=(s,...o)=>{r(s,o),oe(s)!==s&&r(oe(s),o)},this._setParent()}),n}_applyStyles(e,n){if(!e)return;if(n){if(n===this._def||this._styleChildren.has(n))return;this._styleChildren.add(n)}const i=this._nonce;for(let r=e.length-1;r>=0;r--){const s=document.createElement("style");i&&s.setAttribute("nonce",i),s.textContent=e[r],this.shadowRoot.prepend(s)}}_parseSlots(){const e=this._slots={};let n;for(;n=this.firstChild;){const i=n.nodeType===1&&n.getAttribute("slot")||"default";(e[i]||(e[i]=[])).push(n),this.removeChild(n)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),n=this._instance.type.__scopeId;for(let i=0;i<e.length;i++){const r=e[i],s=r.getAttribute("name")||"default",o=this._slots[s],a=r.parentNode;if(o)for(const l of o){if(n&&l.nodeType===1){const c=n+"-s",h=document.createTreeWalker(l,1);l.setAttribute(c,"");let g;for(;g=h.nextNode();)g.setAttribute(c,"")}a.insertBefore(l,r)}else for(;r.firstChild;)a.insertBefore(r.firstChild,r);a.removeChild(r)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}const fr=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ft(e)?n=>Ui(e,n):e};function Hd(t){t.target.composing=!0}function Va(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const mn=Symbol("_assign"),Wd={created(t,{modifiers:{lazy:e,trim:n,number:i}},r){t[mn]=fr(r);const s=i||r.props&&r.props.type==="number";en(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),s&&(a=Bi(a)),t[mn](a)}),n&&en(t,"change",()=>{t.value=t.value.trim()}),e||(en(t,"compositionstart",Hd),en(t,"compositionend",Va),en(t,"change",Va))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:i,trim:r,number:s}},o){if(t[mn]=fr(o),t.composing)return;const a=(s||t.type==="number")&&!/^0\d/.test(t.value)?Bi(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(i&&e===n||r&&t.value.trim()===l)||(t.value=l))}},jd={deep:!0,created(t,{value:e,modifiers:{number:n}},i){const r=zi(e);en(t,"change",()=>{const s=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Bi(gr(o)):gr(o));t[mn](t.multiple?r?new Set(s):s:s[0]),t._assigning=!0,ts(()=>{t._assigning=!1})}),t[mn]=fr(i)},mounted(t,{value:e}){Ha(t,e)},beforeUpdate(t,e,n){t[mn]=fr(n)},updated(t,{value:e}){t._assigning||Ha(t,e)}};function Ha(t,e){const n=t.multiple,i=ft(e);if(!(n&&!i&&!zi(e))){for(let r=0,s=t.options.length;r<s;r++){const o=t.options[r],a=gr(o);if(n)if(i){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=Ah(e,a)>-1}else o.selected=e.has(a);else if($i(gr(o),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function gr(t){return"_value"in t?t._value:t.value}const Zd=["ctrl","shift","alt","meta"],qd={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Zd.some(n=>t[`${n}Key`]&&!e.includes(n))},Be=(t,e)=>{const n=t._withMods||(t._withMods={}),i=e.join(".");return n[i]||(n[i]=(r,...s)=>{for(let o=0;o<e.length;o++){const a=qd[e[o]];if(a&&a(r,e))return}return t(r,...s)})},Kd=$t({patchProp:Ud},Pd);let Wa;function ja(){return Wa||(Wa=ju(Kd))}const Yd=(...t)=>{ja().render(...t)},Za=(...t)=>{const e=ja().createApp(...t),{mount:n}=e;return e.mount=i=>{const r=Qd(i);if(!r)return;const s=e._component;!gt(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,Xd(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function Xd(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Qd(t){return Lt(t)?document.querySelector(t):t}var qa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var pr={exports:{}},jn={},Ss={},ws={},Ka;function vt(){return Ka||(Ka=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof qa<"u"?qa:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.21",isBrowser:n(),isUnminified:/param/.test(function(r){}.toString()),dblClickWindow:400,getAngle(r){return t.Konva.angleDeg?r*e:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var r;return(r=t.Konva.Transformer)===null||r===void 0?void 0:r.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(r){t.glob.Konva=r}};const i=r=>{t.Konva[r.prototype.getClassName()]=r};t._registerNode=i,t.Konva._injectGlobal(t.Konva)}(ws)),ws}var xs={},Ya;function zt(){return Ya||(Ya=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=vt();class n{constructor(_=[1,0,0,1,0,0]){this.dirty=!1,this.m=_&&_.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(_){_.m[0]=this.m[0],_.m[1]=this.m[1],_.m[2]=this.m[2],_.m[3]=this.m[3],_.m[4]=this.m[4],_.m[5]=this.m[5]}point(_){const S=this.m;return{x:S[0]*_.x+S[2]*_.y+S[4],y:S[1]*_.x+S[3]*_.y+S[5]}}translate(_,S){return this.m[4]+=this.m[0]*_+this.m[2]*S,this.m[5]+=this.m[1]*_+this.m[3]*S,this}scale(_,S){return this.m[0]*=_,this.m[1]*=_,this.m[2]*=S,this.m[3]*=S,this}rotate(_){const S=Math.cos(_),k=Math.sin(_),O=this.m[0]*S+this.m[2]*k,b=this.m[1]*S+this.m[3]*k,C=this.m[0]*-k+this.m[2]*S,T=this.m[1]*-k+this.m[3]*S;return this.m[0]=O,this.m[1]=b,this.m[2]=C,this.m[3]=T,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(_,S){const k=this.m[0]+this.m[2]*S,O=this.m[1]+this.m[3]*S,b=this.m[2]+this.m[0]*_,C=this.m[3]+this.m[1]*_;return this.m[0]=k,this.m[1]=O,this.m[2]=b,this.m[3]=C,this}multiply(_){const S=this.m[0]*_.m[0]+this.m[2]*_.m[1],k=this.m[1]*_.m[0]+this.m[3]*_.m[1],O=this.m[0]*_.m[2]+this.m[2]*_.m[3],b=this.m[1]*_.m[2]+this.m[3]*_.m[3],C=this.m[0]*_.m[4]+this.m[2]*_.m[5]+this.m[4],T=this.m[1]*_.m[4]+this.m[3]*_.m[5]+this.m[5];return this.m[0]=S,this.m[1]=k,this.m[2]=O,this.m[3]=b,this.m[4]=C,this.m[5]=T,this}invert(){const _=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),S=this.m[3]*_,k=-this.m[1]*_,O=-this.m[2]*_,b=this.m[0]*_,C=_*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),T=_*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=S,this.m[1]=k,this.m[2]=O,this.m[3]=b,this.m[4]=C,this.m[5]=T,this}getMatrix(){return this.m}decompose(){const _=this.m[0],S=this.m[1],k=this.m[2],O=this.m[3],b=this.m[4],C=this.m[5],T=_*O-S*k,A={x:b,y:C,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(_!=0||S!=0){const D=Math.sqrt(_*_+S*S);A.rotation=S>0?Math.acos(_/D):-Math.acos(_/D),A.scaleX=D,A.scaleY=T/D,A.skewX=(_*k+S*O)/T,A.skewY=0}else if(k!=0||O!=0){const D=Math.sqrt(k*k+O*O);A.rotation=Math.PI/2-(O>0?Math.acos(-k/D):-Math.acos(k/D)),A.scaleX=T/D,A.scaleY=D,A.skewX=0,A.skewY=(_*k+S*O)/T}return A.rotation=t.Util._getRotation(A.rotation),A}}t.Transform=n;const i="[object Array]",r="[object Number]",s="[object String]",o="[object Boolean]",a=Math.PI/180,l=180/Math.PI,c="#",h="",g="0",f="Konva warning: ",d="Konva error: ",p="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},w=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let x=[];const m=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(u){setTimeout(u,60)};t.Util={_isElement(u){return!!(u&&u.nodeType==1)},_isFunction(u){return!!(u&&u.constructor&&u.call&&u.apply)},_isPlainObject(u){return!!u&&u.constructor===Object},_isArray(u){return Object.prototype.toString.call(u)===i},_isNumber(u){return Object.prototype.toString.call(u)===r&&!isNaN(u)&&isFinite(u)},_isString(u){return Object.prototype.toString.call(u)===s},_isBoolean(u){return Object.prototype.toString.call(u)===o},isObject(u){return u instanceof Object},isValidSelector(u){if(typeof u!="string")return!1;const _=u[0];return _==="#"||_==="."||_===_.toUpperCase()},_sign(u){return u===0||u>0?1:-1},requestAnimFrame(u){x.push(u),x.length===1&&m(function(){const _=x;x=[],_.forEach(function(S){S()})})},createCanvasElement(){const u=document.createElement("canvas");try{u.style=u.style||{}}catch{}return u},createImageElement(){return document.createElement("img")},_isInDocument(u){for(;u=u.parentNode;)if(u==document)return!0;return!1},_urlToImage(u,_){const S=t.Util.createImageElement();S.onload=function(){_(S)},S.src=u},_rgbToHex(u,_,S){return(16777216+(u<<16)+(_<<8)+S).toString(16).slice(1)},_hexToRgb(u){u=u.replace(c,h);const _=parseInt(u,16);return{r:_>>16&255,g:_>>8&255,b:_&255}},getRandomColor(){let u=(Math.random()*16777215<<0).toString(16);for(;u.length<6;)u=g+u;return c+u},getRGB(u){let _;return u in v?(_=v[u],{r:_[0],g:_[1],b:_[2]}):u[0]===c?this._hexToRgb(u.substring(1)):u.substr(0,4)===p?(_=w.exec(u.replace(/ /g,"")),{r:parseInt(_[1],10),g:parseInt(_[2],10),b:parseInt(_[3],10)}):{r:0,g:0,b:0}},colorToRGBA(u){return u=u||"black",t.Util._namedColorToRBA(u)||t.Util._hex3ColorToRGBA(u)||t.Util._hex4ColorToRGBA(u)||t.Util._hex6ColorToRGBA(u)||t.Util._hex8ColorToRGBA(u)||t.Util._rgbColorToRGBA(u)||t.Util._rgbaColorToRGBA(u)||t.Util._hslColorToRGBA(u)},_namedColorToRBA(u){const _=v[u.toLowerCase()];return _?{r:_[0],g:_[1],b:_[2],a:1}:null},_rgbColorToRGBA(u){if(u.indexOf("rgb(")===0){u=u.match(/rgb\(([^)]+)\)/)[1];const _=u.split(/ *, */).map(Number);return{r:_[0],g:_[1],b:_[2],a:1}}},_rgbaColorToRGBA(u){if(u.indexOf("rgba(")===0){u=u.match(/rgba\(([^)]+)\)/)[1];const _=u.split(/ *, */).map((S,k)=>S.slice(-1)==="%"?k===3?parseInt(S)/100:parseInt(S)/100*255:Number(S));return{r:_[0],g:_[1],b:_[2],a:_[3]}}},_hex8ColorToRGBA(u){if(u[0]==="#"&&u.length===9)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:parseInt(u.slice(7,9),16)/255}},_hex6ColorToRGBA(u){if(u[0]==="#"&&u.length===7)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:1}},_hex4ColorToRGBA(u){if(u[0]==="#"&&u.length===5)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:parseInt(u[4]+u[4],16)/255}},_hex3ColorToRGBA(u){if(u[0]==="#"&&u.length===4)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:1}},_hslColorToRGBA(u){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(u)){const[_,...S]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(u),k=Number(S[0])/360,O=Number(S[1])/100,b=Number(S[2])/100;let C,T,A;if(O===0)return A=b*255,{r:Math.round(A),g:Math.round(A),b:Math.round(A),a:1};b<.5?C=b*(1+O):C=b+O-b*O;const D=2*b-C,L=[0,0,0];for(let U=0;U<3;U++)T=k+.3333333333333333*-(U-1),T<0&&T++,T>1&&T--,6*T<1?A=D+(C-D)*6*T:2*T<1?A=C:3*T<2?A=D+(C-D)*(.6666666666666666-T)*6:A=D,L[U]=A*255;return{r:Math.round(L[0]),g:Math.round(L[1]),b:Math.round(L[2]),a:1}}},haveIntersection(u,_){return!(_.x>u.x+u.width||_.x+_.width<u.x||_.y>u.y+u.height||_.y+_.height<u.y)},cloneObject(u){const _={};for(const S in u)this._isPlainObject(u[S])?_[S]=this.cloneObject(u[S]):this._isArray(u[S])?_[S]=this.cloneArray(u[S]):_[S]=u[S];return _},cloneArray(u){return u.slice(0)},degToRad(u){return u*a},radToDeg(u){return u*l},_degToRad(u){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(u)},_radToDeg(u){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(u)},_getRotation(u){return e.Konva.angleDeg?t.Util.radToDeg(u):u},_capitalize(u){return u.charAt(0).toUpperCase()+u.slice(1)},throw(u){throw new Error(d+u)},error(u){console.error(d+u)},warn(u){e.Konva.showWarnings&&console.warn(f+u)},each(u,_){for(const S in u)_(S,u[S])},_inRange(u,_,S){return _<=u&&u<S},_getProjectionToSegment(u,_,S,k,O,b){let C,T,A;const D=(u-S)*(u-S)+(_-k)*(_-k);if(D==0)C=u,T=_,A=(O-S)*(O-S)+(b-k)*(b-k);else{const L=((O-u)*(S-u)+(b-_)*(k-_))/D;L<0?(C=u,T=_,A=(u-O)*(u-O)+(_-b)*(_-b)):L>1?(C=S,T=k,A=(S-O)*(S-O)+(k-b)*(k-b)):(C=u+L*(S-u),T=_+L*(k-_),A=(C-O)*(C-O)+(T-b)*(T-b))}return[C,T,A]},_getProjectionToLine(u,_,S){const k=t.Util.cloneObject(u);let O=Number.MAX_VALUE;return _.forEach(function(b,C){if(!S&&C===_.length-1)return;const T=_[(C+1)%_.length],A=t.Util._getProjectionToSegment(b.x,b.y,T.x,T.y,u.x,u.y),D=A[0],L=A[1],U=A[2];U<O&&(k.x=D,k.y=L,O=U)}),k},_prepareArrayForTween(u,_,S){const k=[],O=[];if(u.length>_.length){const C=_;_=u,u=C}for(let C=0;C<u.length;C+=2)k.push({x:u[C],y:u[C+1]});for(let C=0;C<_.length;C+=2)O.push({x:_[C],y:_[C+1]});const b=[];return O.forEach(function(C){const T=t.Util._getProjectionToLine(C,k,S);b.push(T.x),b.push(T.y)}),b},_prepareToStringify(u){let _;u.visitedByCircularReferenceRemoval=!0;for(const S in u)if(u.hasOwnProperty(S)&&u[S]&&typeof u[S]=="object"){if(_=Object.getOwnPropertyDescriptor(u,S),u[S].visitedByCircularReferenceRemoval||t.Util._isElement(u[S]))if(_.configurable)delete u[S];else return null;else if(t.Util._prepareToStringify(u[S])===null)if(_.configurable)delete u[S];else return null}return delete u.visitedByCircularReferenceRemoval,u},_assign(u,_){for(const S in _)u[S]=_[S];return u},_getFirstPointerId(u){return u.touches?u.changedTouches[0].identifier:u.pointerId||999},releaseCanvas(...u){e.Konva.releaseCanvasOnDestroy&&u.forEach(_=>{_.width=0,_.height=0})},drawRoundedRectPath(u,_,S,k){let O=0,b=0,C=0,T=0;typeof k=="number"?O=b=C=T=Math.min(k,_/2,S/2):(O=Math.min(k[0]||0,_/2,S/2),b=Math.min(k[1]||0,_/2,S/2),T=Math.min(k[2]||0,_/2,S/2),C=Math.min(k[3]||0,_/2,S/2)),u.moveTo(O,0),u.lineTo(_-b,0),u.arc(_-b,b,b,Math.PI*3/2,0,!1),u.lineTo(_,S-T),u.arc(_-T,S-T,T,0,Math.PI/2,!1),u.lineTo(C,S),u.arc(C,S-C,C,Math.PI/2,Math.PI,!1),u.lineTo(0,O),u.arc(O,O,O,Math.PI,Math.PI*3/2,!1)}}}(xs)),xs}var Zn={},Ne={},Me={},Xa;function Qa(){if(Xa)return Me;Xa=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.HitContext=Me.SceneContext=Me.Context=void 0;const t=zt(),e=vt();function n(x){const m=[],u=x.length,_=t.Util;for(let S=0;S<u;S++){let k=x[S];_._isNumber(k)?k=Math.round(k*1e3)/1e3:_._isString(k)||(k=k+""),m.push(k)}return m}const i=",",r="(",s=")",o="([",a="])",l=";",c="()",h="=",g=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],f=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],d=100;let p=class{constructor(m){this.canvas=m,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(m){m.fillEnabled()&&this._fill(m)}_fill(m){}strokeShape(m){m.hasStroke()&&this._stroke(m)}_stroke(m){}fillStrokeShape(m){m.attrs.fillAfterStrokeEnabled?(this.strokeShape(m),this.fillShape(m)):(this.fillShape(m),this.strokeShape(m))}getTrace(m,u){let _=this.traceArr,S=_.length,k="",O,b,C,T;for(O=0;O<S;O++)b=_[O],C=b.method,C?(T=b.args,k+=C,m?k+=c:t.Util._isArray(T[0])?k+=o+T.join(i)+a:(u&&(T=T.map(A=>typeof A=="number"?Math.floor(A):A)),k+=r+T.join(i)+s)):(k+=b.property,m||(k+=h+b.val)),k+=l;return k}clearTrace(){this.traceArr=[]}_trace(m){let u=this.traceArr,_;u.push(m),_=u.length,_>=d&&u.shift()}reset(){const m=this.getCanvas().getPixelRatio();this.setTransform(1*m,0,0,1*m,0,0)}getCanvas(){return this.canvas}clear(m){const u=this.getCanvas();m?this.clearRect(m.x||0,m.y||0,m.width||0,m.height||0):this.clearRect(0,0,u.getWidth()/u.pixelRatio,u.getHeight()/u.pixelRatio)}_applyLineCap(m){const u=m.attrs.lineCap;u&&this.setAttr("lineCap",u)}_applyOpacity(m){const u=m.getAbsoluteOpacity();u!==1&&this.setAttr("globalAlpha",u)}_applyLineJoin(m){const u=m.attrs.lineJoin;u&&this.setAttr("lineJoin",u)}setAttr(m,u){this._context[m]=u}arc(m,u,_,S,k,O){this._context.arc(m,u,_,S,k,O)}arcTo(m,u,_,S,k){this._context.arcTo(m,u,_,S,k)}beginPath(){this._context.beginPath()}bezierCurveTo(m,u,_,S,k,O){this._context.bezierCurveTo(m,u,_,S,k,O)}clearRect(m,u,_,S){this._context.clearRect(m,u,_,S)}clip(...m){this._context.clip.apply(this._context,m)}closePath(){this._context.closePath()}createImageData(m,u){const _=arguments;if(_.length===2)return this._context.createImageData(m,u);if(_.length===1)return this._context.createImageData(m)}createLinearGradient(m,u,_,S){return this._context.createLinearGradient(m,u,_,S)}createPattern(m,u){return this._context.createPattern(m,u)}createRadialGradient(m,u,_,S,k,O){return this._context.createRadialGradient(m,u,_,S,k,O)}drawImage(m,u,_,S,k,O,b,C,T){const A=arguments,D=this._context;A.length===3?D.drawImage(m,u,_):A.length===5?D.drawImage(m,u,_,S,k):A.length===9&&D.drawImage(m,u,_,S,k,O,b,C,T)}ellipse(m,u,_,S,k,O,b,C){this._context.ellipse(m,u,_,S,k,O,b,C)}isPointInPath(m,u,_,S){return _?this._context.isPointInPath(_,m,u,S):this._context.isPointInPath(m,u,S)}fill(...m){this._context.fill.apply(this._context,m)}fillRect(m,u,_,S){this._context.fillRect(m,u,_,S)}strokeRect(m,u,_,S){this._context.strokeRect(m,u,_,S)}fillText(m,u,_,S){S?this._context.fillText(m,u,_,S):this._context.fillText(m,u,_)}measureText(m){return this._context.measureText(m)}getImageData(m,u,_,S){return this._context.getImageData(m,u,_,S)}lineTo(m,u){this._context.lineTo(m,u)}moveTo(m,u){this._context.moveTo(m,u)}rect(m,u,_,S){this._context.rect(m,u,_,S)}roundRect(m,u,_,S,k){this._context.roundRect(m,u,_,S,k)}putImageData(m,u,_){this._context.putImageData(m,u,_)}quadraticCurveTo(m,u,_,S){this._context.quadraticCurveTo(m,u,_,S)}restore(){this._context.restore()}rotate(m){this._context.rotate(m)}save(){this._context.save()}scale(m,u){this._context.scale(m,u)}setLineDash(m){this._context.setLineDash?this._context.setLineDash(m):"mozDash"in this._context?this._context.mozDash=m:"webkitLineDash"in this._context&&(this._context.webkitLineDash=m)}getLineDash(){return this._context.getLineDash()}setTransform(m,u,_,S,k,O){this._context.setTransform(m,u,_,S,k,O)}stroke(m){m?this._context.stroke(m):this._context.stroke()}strokeText(m,u,_,S){this._context.strokeText(m,u,_,S)}transform(m,u,_,S,k,O){this._context.transform(m,u,_,S,k,O)}translate(m,u){this._context.translate(m,u)}_enableTrace(){let m=this,u=g.length,_=this.setAttr,S,k;const O=function(b){let C=m[b],T;m[b]=function(){return k=n(Array.prototype.slice.call(arguments,0)),T=C.apply(m,arguments),m._trace({method:b,args:k}),T}};for(S=0;S<u;S++)O(g[S]);m.setAttr=function(){_.apply(m,arguments);const b=arguments[0];let C=arguments[1];(b==="shadowOffsetX"||b==="shadowOffsetY"||b==="shadowBlur")&&(C=C/this.canvas.getPixelRatio()),m._trace({property:b,val:C})}}_applyGlobalCompositeOperation(m){const u=m.attrs.globalCompositeOperation;!u||u==="source-over"||this.setAttr("globalCompositeOperation",u)}};Me.Context=p,f.forEach(function(x){Object.defineProperty(p.prototype,x,{get(){return this._context[x]},set(m){this._context[x]=m}})});class v extends p{constructor(m,{willReadFrequently:u=!1}={}){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:u})}_fillColor(m){const u=m.fill();this.setAttr("fillStyle",u),m._fillFunc(this)}_fillPattern(m){this.setAttr("fillStyle",m._getFillPattern()),m._fillFunc(this)}_fillLinearGradient(m){const u=m._getLinearGradient();u&&(this.setAttr("fillStyle",u),m._fillFunc(this))}_fillRadialGradient(m){const u=m._getRadialGradient();u&&(this.setAttr("fillStyle",u),m._fillFunc(this))}_fill(m){const u=m.fill(),_=m.getFillPriority();if(u&&_==="color"){this._fillColor(m);return}const S=m.getFillPatternImage();if(S&&_==="pattern"){this._fillPattern(m);return}const k=m.getFillLinearGradientColorStops();if(k&&_==="linear-gradient"){this._fillLinearGradient(m);return}const O=m.getFillRadialGradientColorStops();if(O&&_==="radial-gradient"){this._fillRadialGradient(m);return}u?this._fillColor(m):S?this._fillPattern(m):k?this._fillLinearGradient(m):O&&this._fillRadialGradient(m)}_strokeLinearGradient(m){const u=m.getStrokeLinearGradientStartPoint(),_=m.getStrokeLinearGradientEndPoint(),S=m.getStrokeLinearGradientColorStops(),k=this.createLinearGradient(u.x,u.y,_.x,_.y);if(S){for(let O=0;O<S.length;O+=2)k.addColorStop(S[O],S[O+1]);this.setAttr("strokeStyle",k)}}_stroke(m){const u=m.dash(),_=m.getStrokeScaleEnabled();if(m.hasStroke()){if(!_){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(m),u&&m.dashEnabled()&&(this.setLineDash(u),this.setAttr("lineDashOffset",m.dashOffset())),this.setAttr("lineWidth",m.strokeWidth()),m.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),m.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(m):this.setAttr("strokeStyle",m.stroke()),m._strokeFunc(this),_||this.restore()}}_applyShadow(m){var u,_,S;const k=(u=m.getShadowRGBA())!==null&&u!==void 0?u:"black",O=(_=m.getShadowBlur())!==null&&_!==void 0?_:5,b=(S=m.getShadowOffset())!==null&&S!==void 0?S:{x:0,y:0},C=m.getAbsoluteScale(),T=this.canvas.getPixelRatio(),A=C.x*T,D=C.y*T;this.setAttr("shadowColor",k),this.setAttr("shadowBlur",O*Math.min(Math.abs(A),Math.abs(D))),this.setAttr("shadowOffsetX",b.x*A),this.setAttr("shadowOffsetY",b.y*D)}}Me.SceneContext=v;class w extends p{constructor(m){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:!0})}_fill(m){this.save(),this.setAttr("fillStyle",m.colorKey),m._fillFuncHit(this),this.restore()}strokeShape(m){m.hasHitStroke()&&this._stroke(m)}_stroke(m){if(m.hasHitStroke()){const u=m.getStrokeScaleEnabled();if(!u){this.save();const k=this.getCanvas().getPixelRatio();this.setTransform(k,0,0,k,0,0)}this._applyLineCap(m);const _=m.hitStrokeWidth(),S=_==="auto"?m.strokeWidth():_;this.setAttr("lineWidth",S),this.setAttr("strokeStyle",m.colorKey),m._strokeFuncHit(this),u||this.restore()}}}return Me.HitContext=w,Me}var Ja;function mr(){if(Ja)return Ne;Ja=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.HitCanvas=Ne.SceneCanvas=Ne.Canvas=void 0;const t=zt(),e=Qa(),n=vt();let i;function r(){if(i)return i;const l=t.Util.createCanvasElement(),c=l.getContext("2d");return i=function(){const h=n.Konva._global.devicePixelRatio||1,g=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1;return h/g}(),t.Util.releaseCanvas(l),i}let s=class{constructor(c){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const g=(c||{}).pixelRatio||n.Konva.pixelRatio||r();this.pixelRatio=g,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(c){const h=this.pixelRatio;this.pixelRatio=c,this.setSize(this.getWidth()/h,this.getHeight()/h)}setWidth(c){this.width=this._canvas.width=c*this.pixelRatio,this._canvas.style.width=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}setHeight(c){this.height=this._canvas.height=c*this.pixelRatio,this._canvas.style.height=c+"px";const h=this.pixelRatio;this.getContext()._context.scale(h,h)}getWidth(){return this.width}getHeight(){return this.height}setSize(c,h){this.setWidth(c||0),this.setHeight(h||0)}toDataURL(c,h){try{return this._canvas.toDataURL(c,h)}catch{try{return this._canvas.toDataURL()}catch(f){return t.Util.error("Unable to get data URL. "+f.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Ne.Canvas=s;class o extends s{constructor(c={width:0,height:0,willReadFrequently:!1}){super(c),this.context=new e.SceneContext(this,{willReadFrequently:c.willReadFrequently}),this.setSize(c.width,c.height)}}Ne.SceneCanvas=o;class a extends s{constructor(c={width:0,height:0}){super(c),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(c.width,c.height)}}return Ne.HitCanvas=a,Ne}var Cs={},tl;function Ps(){return tl||(tl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=vt(),n=zt();t.DD={get isDragging(){let i=!1;return t.DD._dragElements.forEach(r=>{r.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return t.DD._dragElements.forEach(r=>{i=r.node}),i},_dragElements:new Map,_drag(i){const r=[];t.DD._dragElements.forEach((s,o)=>{const{node:a}=s,l=a.getStage();l.setPointersPositions(i),s.pointerId===void 0&&(s.pointerId=n.Util._getFirstPointerId(i));const c=l._changedPointerPositions.find(h=>h.id===s.pointerId);if(c){if(s.dragStatus!=="dragging"){const h=a.dragDistance();if(Math.max(Math.abs(c.x-s.startPointerPos.x),Math.abs(c.y-s.startPointerPos.y))<h||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,s),r.push(a)}}),r.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:i},!0)})},_endDragBefore(i){const r=[];t.DD._dragElements.forEach(s=>{const{node:o}=s,a=o.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(h=>h.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const c=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;c&&r.indexOf(c)===-1&&r.push(c)}),r.forEach(s=>{s.draw()})},_endDragAfter(i){t.DD._dragElements.forEach((r,s)=>{r.dragStatus==="stopped"&&r.node.fire("dragend",{type:"dragend",target:r.node,evt:i},!0),r.dragStatus!=="dragging"&&t.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))}(Cs)),Cs}var Ts={},Jt={},el;function bt(){if(el)return Jt;el=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.RGBComponent=i,Jt.alphaComponent=r,Jt.getNumberValidator=s,Jt.getNumberOrArrayOfNumbersValidator=o,Jt.getNumberOrAutoValidator=a,Jt.getStringValidator=l,Jt.getStringOrGradientValidator=c,Jt.getFunctionValidator=h,Jt.getNumberArrayValidator=g,Jt.getBooleanValidator=f,Jt.getComponentValidator=d;const t=vt(),e=zt();function n(p){return e.Util._isString(p)?'"'+p+'"':Object.prototype.toString.call(p)==="[object Number]"||e.Util._isBoolean(p)?p:Object.prototype.toString.call(p)}function i(p){return p>255?255:p<0?0:Math.round(p)}function r(p){return p>1?1:p<1e-4?1e-4:p}function s(){if(t.Konva.isUnminified)return function(p,v){return e.Util._isNumber(p)||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a number.'),p}}function o(p){if(t.Konva.isUnminified)return function(v,w){let x=e.Util._isNumber(v),m=e.Util._isArray(v)&&v.length==p;return!x&&!m&&e.Util.warn(n(v)+' is a not valid value for "'+w+'" attribute. The value should be a number or Array<number>('+p+")"),v}}function a(){if(t.Konva.isUnminified)return function(p,v){return e.Util._isNumber(p)||p==="auto"||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a number or "auto".'),p}}function l(){if(t.Konva.isUnminified)return function(p,v){return e.Util._isString(p)||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a string.'),p}}function c(){if(t.Konva.isUnminified)return function(p,v){const w=e.Util._isString(p),x=Object.prototype.toString.call(p)==="[object CanvasGradient]"||p&&p.addColorStop;return w||x||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a string or a native gradient.'),p}}function h(){if(t.Konva.isUnminified)return function(p,v){return e.Util._isFunction(p)||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a function.'),p}}function g(){if(t.Konva.isUnminified)return function(p,v){const w=Int8Array?Object.getPrototypeOf(Int8Array):null;return w&&p instanceof w||(e.Util._isArray(p)?p.forEach(function(x){e.Util._isNumber(x)||e.Util.warn('"'+v+'" attribute has non numeric element '+x+". Make sure that all elements are numbers.")}):e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a array of numbers.')),p}}function f(){if(t.Konva.isUnminified)return function(p,v){return p===!0||p===!1||e.Util.warn(n(p)+' is a not valid value for "'+v+'" attribute. The value should be a boolean.'),p}}function d(p){if(t.Konva.isUnminified)return function(v,w){return v==null||e.Util.isObject(v)||e.Util.warn(n(v)+' is a not valid value for "'+w+'" attribute. The value should be an object with properties '+p),v}}return Jt}var nl;function yt(){return nl||(nl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=zt(),n=bt(),i="get",r="set";t.Factory={addGetterSetter(s,o,a,l,c){t.Factory.addGetter(s,o,a),t.Factory.addSetter(s,o,l,c),t.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,a){const l=i+e.Util._capitalize(o);s.prototype[l]=s.prototype[l]||function(){const c=this.attrs[o];return c===void 0?a:c}},addSetter(s,o,a,l){const c=r+e.Util._capitalize(o);s.prototype[c]||t.Factory.overWriteSetter(s,o,a,l)},overWriteSetter(s,o,a,l){const c=r+e.Util._capitalize(o);s.prototype[c]=function(h){return a&&h!==void 0&&h!==null&&(h=a.call(this,h,o)),this._setAttr(o,h),l&&l.call(this),this}},addComponentsGetterSetter(s,o,a,l,c){const h=a.length,g=e.Util._capitalize,f=i+g(o),d=r+g(o);s.prototype[f]=function(){const v={};for(let w=0;w<h;w++){const x=a[w];v[x]=this.getAttr(o+g(x))}return v};const p=(0,n.getComponentValidator)(a);s.prototype[d]=function(v){const w=this.attrs[o];l&&(v=l.call(this,v,o)),p&&p.call(this,v,o);for(const x in v)v.hasOwnProperty(x)&&this._setAttr(o+g(x),v[x]);return v||a.forEach(x=>{this._setAttr(o+g(x),void 0)}),this._fireChangeEvent(o,w,v),c&&c.call(this),this},t.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const a=e.Util._capitalize(o),l=r+a,c=i+a;s.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(s,o,a,l){e.Util.error("Adding deprecated "+o);const c=i+e.Util._capitalize(o),h=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[c]=function(){e.Util.error(h);const g=this.attrs[o];return g===void 0?a:g},t.Factory.addSetter(s,o,l,function(){e.Util.error(h)}),t.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(a,l){const c=s.prototype[l],h=i+e.Util._capitalize(a),g=r+e.Util._capitalize(a);function f(){c.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}s.prototype[a]=f,s.prototype[h]=f,s.prototype[g]=f})},afterSetFilter(){this._filterUpToDate=!1}}}(Ts)),Ts}var il;function Gt(){if(il)return Zn;il=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.Node=void 0;const t=mr(),e=Ps(),n=yt(),i=vt(),r=zt(),s=bt(),o="absoluteOpacity",a="allEventListeners",l="absoluteTransform",c="absoluteScale",h="canvas",g="Change",f="children",d="konva",p="listening",v="mouseenter",w="mouseleave",x="pointerenter",m="pointerleave",u="touchenter",_="touchleave",S="set",k="Shape",O=" ",b="stage",C="transform",T="Stage",A="visible",D=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(O);let L=1,U=class Js{constructor(y){this._id=L++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(y),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(y){(y===C||y===l)&&this._cache.get(y)?this._cache.get(y).dirty=!0:y?this._cache.delete(y):this._cache.clear()}_getCache(y,P){let M=this._cache.get(y);return(M===void 0||(y===C||y===l)&&M.dirty===!0)&&(M=P.call(this),this._cache.set(y,M)),M}_calculate(y,P,M){if(!this._attachedDepsListeners.get(y)){const R=P.map(F=>F+"Change.konva").join(O);this.on(R,()=>{this._clearCache(y)}),this._attachedDepsListeners.set(y,!0)}return this._getCache(y,M)}_getCanvasCache(){return this._cache.get(h)}_clearSelfAndDescendantCache(y){this._clearCache(y),y===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(h)){const{scene:y,filter:P,hit:M,buffer:R}=this._cache.get(h);r.Util.releaseCanvas(y,P,M,R),this._cache.delete(h)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(y){const P=y||{};let M={};(P.x===void 0||P.y===void 0||P.width===void 0||P.height===void 0)&&(M=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let R=Math.ceil(P.width||M.width),F=Math.ceil(P.height||M.height),H=P.pixelRatio,G=P.x===void 0?Math.floor(M.x):P.x,Y=P.y===void 0?Math.floor(M.y):P.y,it=P.offset||0,V=P.drawBorder||!1,N=P.hitCanvasPixelRatio||1;if(!R||!F){r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const $=Math.abs(Math.round(M.x)-G)>.5?1:0,tt=Math.abs(Math.round(M.y)-Y)>.5?1:0;R+=it*2+$,F+=it*2+tt,G-=it,Y-=it;const st=new t.SceneCanvas({pixelRatio:H,width:R,height:F}),ct=new t.SceneCanvas({pixelRatio:H,width:0,height:0,willReadFrequently:!0}),E=new t.HitCanvas({pixelRatio:N,width:R,height:F}),I=st.getContext(),B=E.getContext(),W=new t.SceneCanvas({width:st.width/st.pixelRatio+Math.abs(G),height:st.height/st.pixelRatio+Math.abs(Y),pixelRatio:st.pixelRatio}),q=W.getContext();return E.isCache=!0,st.isCache=!0,this._cache.delete(h),this._filterUpToDate=!1,P.imageSmoothingEnabled===!1&&(st.getContext()._context.imageSmoothingEnabled=!1,ct.getContext()._context.imageSmoothingEnabled=!1),I.save(),B.save(),q.save(),I.translate(-G,-Y),B.translate(-G,-Y),q.translate(-G,-Y),W.x=G,W.y=Y,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this.drawScene(st,this,W),this.drawHit(E,this),this._isUnderCache=!1,I.restore(),B.restore(),V&&(I.save(),I.beginPath(),I.rect(0,0,R,F),I.closePath(),I.setAttr("strokeStyle","red"),I.setAttr("lineWidth",5),I.stroke(),I.restore()),this._cache.set(h,{scene:st,filter:ct,hit:E,buffer:W,x:G,y:Y}),this._requestDraw(),this}isCached(){return this._cache.has(h)}getClientRect(y){throw new Error('abstract "getClientRect" method call')}_transformedRect(y,P){const M=[{x:y.x,y:y.y},{x:y.x+y.width,y:y.y},{x:y.x+y.width,y:y.y+y.height},{x:y.x,y:y.y+y.height}];let R=1/0,F=1/0,H=-1/0,G=-1/0;const Y=this.getAbsoluteTransform(P);return M.forEach(function(it){const V=Y.point(it);R===void 0&&(R=H=V.x,F=G=V.y),R=Math.min(R,V.x),F=Math.min(F,V.y),H=Math.max(H,V.x),G=Math.max(G,V.y)}),{x:R,y:F,width:H-R,height:G-F}}_drawCachedSceneCanvas(y){y.save(),y._applyOpacity(this),y._applyGlobalCompositeOperation(this);const P=this._getCanvasCache();y.translate(P.x,P.y);const M=this._getCachedSceneCanvas(),R=M.pixelRatio;y.drawImage(M._canvas,0,0,M.width/R,M.height/R),y.restore()}_drawCachedHitCanvas(y){const P=this._getCanvasCache(),M=P.hit;y.save(),y.translate(P.x,P.y),y.drawImage(M._canvas,0,0,M.width/M.pixelRatio,M.height/M.pixelRatio),y.restore()}_getCachedSceneCanvas(){let y=this.filters(),P=this._getCanvasCache(),M=P.scene,R=P.filter,F=R.getContext(),H,G,Y,it;if(y){if(!this._filterUpToDate){const V=M.pixelRatio;R.setSize(M.width/M.pixelRatio,M.height/M.pixelRatio);try{for(H=y.length,F.clear(),F.drawImage(M._canvas,0,0,M.getWidth()/V,M.getHeight()/V),G=F.getImageData(0,0,R.getWidth(),R.getHeight()),Y=0;Y<H;Y++){if(it=y[Y],typeof it!="function"){r.Util.error("Filter should be type of function, but got "+typeof it+" instead. Please check correct filters");continue}it.call(this,G),F.putImageData(G,0,0)}}catch(N){r.Util.error("Unable to apply filter. "+N.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return R}return M}on(y,P){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const M=y.split(O);for(let R=0;R<M.length;R++){const H=M[R].split("."),G=H[0],Y=H[1]||"";this.eventListeners[G]||(this.eventListeners[G]=[]),this.eventListeners[G].push({name:Y,handler:P})}return this}off(y,P){let M=(y||"").split(O),R=M.length,F,H,G,Y,it,V;if(this._cache&&this._cache.delete(a),!y)for(H in this.eventListeners)this._off(H);for(F=0;F<R;F++)if(G=M[F],Y=G.split("."),it=Y[0],V=Y[1],it)this.eventListeners[it]&&this._off(it,V,P);else for(H in this.eventListeners)this._off(H,V,P);return this}dispatchEvent(y){const P={target:this,type:y.type,evt:y};return this.fire(y.type,P),this}addEventListener(y,P){return this.on(y,function(M){P.call(this,M.evt)}),this}removeEventListener(y){return this.off(y),this}_delegate(y,P,M){const R=this;this.on(y,function(F){const H=F.target.findAncestors(P,!0,R);for(let G=0;G<H.length;G++)F=r.Util.cloneObject(F),F.currentTarget=H[G],M.call(H[G],F)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(b),this._clearSelfAndDescendantCache(A),this._clearSelfAndDescendantCache(p)}_remove(){this._clearCaches();const y=this.getParent();y&&y.children&&(y.children.splice(this.index,1),y._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(y){const P="get"+r.Util._capitalize(y);return r.Util._isFunction(this[P])?this[P]():this.attrs[y]}getAncestors(){let y=this.getParent(),P=[];for(;y;)P.push(y),y=y.getParent();return P}getAttrs(){return this.attrs||{}}setAttrs(y){return this._batchTransformChanges(()=>{let P,M;if(!y)return this;for(P in y)P!==f&&(M=S+r.Util._capitalize(P),r.Util._isFunction(this[M])?this[M](y[P]):this._setAttr(P,y[P]))}),this}isListening(){return this._getCache(p,this._isListening)}_isListening(y){if(!this.listening())return!1;const M=this.getParent();return M&&M!==y&&this!==y?M._isListening(y):!0}isVisible(){return this._getCache(A,this._isVisible)}_isVisible(y){if(!this.visible())return!1;const M=this.getParent();return M&&M!==y&&this!==y?M._isVisible(y):!0}shouldDrawHit(y,P=!1){if(y)return this._isVisible(y)&&this._isListening(y);const M=this.getLayer();let R=!1;e.DD._dragElements.forEach(H=>{H.dragStatus==="dragging"&&(H.node.nodeType==="Stage"||H.node.getLayer()===M)&&(R=!0)});const F=!P&&!i.Konva.hitOnDragEnabled&&(R||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!F}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let y=this.getDepth(),P=this,M=0,R,F,H,G;function Y(V){for(R=[],F=V.length,H=0;H<F;H++)G=V[H],M++,G.nodeType!==k&&(R=R.concat(G.getChildren().slice())),G._id===P._id&&(H=F);R.length>0&&R[0].getDepth()<=y&&Y(R)}const it=this.getStage();return P.nodeType!==T&&it&&Y(it.getChildren()),M}getDepth(){let y=0,P=this.parent;for(;P;)y++,P=P.parent;return y}_batchTransformChanges(y){this._batchingTransformChange=!0,y(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(C),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(y){return this._batchTransformChanges(()=>{this.x(y.x),this.y(y.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const y=this.getStage();if(!y)return null;const P=y.getPointerPosition();if(!P)return null;const M=this.getAbsoluteTransform().copy();return M.invert(),M.point(P)}getAbsolutePosition(y){let P=!1,M=this.parent;for(;M;){if(M.isCached()){P=!0;break}M=M.parent}P&&!y&&(y=!0);const R=this.getAbsoluteTransform(y).getMatrix(),F=new r.Transform,H=this.offset();return F.m=R.slice(),F.translate(H.x,H.y),F.getTranslation()}setAbsolutePosition(y){const{x:P,y:M,...R}=this._clearTransform();this.attrs.x=P,this.attrs.y=M,this._clearCache(C);const F=this._getAbsoluteTransform().copy();return F.invert(),F.translate(y.x,y.y),y={x:this.attrs.x+F.getTranslation().x,y:this.attrs.y+F.getTranslation().y},this._setTransform(R),this.setPosition({x:y.x,y:y.y}),this._clearCache(C),this._clearSelfAndDescendantCache(l),this}_setTransform(y){let P;for(P in y)this.attrs[P]=y[P]}_clearTransform(){const y={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,y}move(y){let P=y.x,M=y.y,R=this.x(),F=this.y();return P!==void 0&&(R+=P),M!==void 0&&(F+=M),this.setPosition({x:R,y:F}),this}_eachAncestorReverse(y,P){let M=[],R=this.getParent(),F,H;if(!(P&&P._id===this._id)){for(M.unshift(this);R&&(!P||R._id!==P._id);)M.unshift(R),R=R.parent;for(F=M.length,H=0;H<F;H++)y(M[H])}}rotate(y){return this.rotation(this.rotation()+y),this}moveToTop(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const y=this.index,P=this.parent.getChildren().length;return y<P-1?(this.parent.children.splice(y,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;const y=this.index,P=this.parent.getChildren().length;return y<P-1?(this.parent.children.splice(y,1),this.parent.children.splice(y+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;const y=this.index;return y>0?(this.parent.children.splice(y,1),this.parent.children.splice(y-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const y=this.index;return y>0?(this.parent.children.splice(y,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(y){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(y<0||y>=this.parent.children.length)&&r.Util.warn("Unexpected value "+y+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const P=this.index;return this.parent.children.splice(P,1),this.parent.children.splice(y,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let y=this.opacity();const P=this.getParent();return P&&!P._isUnderCache&&(y*=P.getAbsoluteOpacity()),y}moveTo(y){return this.getParent()!==y&&(this._remove(),y.add(this)),this}toObject(){let y=this.getAttrs(),P,M,R,F,H;const G={attrs:{},className:this.getClassName()};for(P in y)M=y[P],H=r.Util.isObject(M)&&!r.Util._isPlainObject(M)&&!r.Util._isArray(M),!H&&(R=typeof this[P]=="function"&&this[P],delete y[P],F=R?R.call(this):null,y[P]=M,F!==M&&(G.attrs[P]=M));return r.Util._prepareToStringify(G)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(y,P,M){const R=[];P&&this._isMatch(y)&&R.push(this);let F=this.parent;for(;F;){if(F===M)return R;F._isMatch(y)&&R.push(F),F=F.parent}return R}isAncestorOf(y){return!1}findAncestor(y,P,M){return this.findAncestors(y,P,M)[0]}_isMatch(y){if(!y)return!1;if(typeof y=="function")return y(this);let P=y.replace(/ /g,"").split(","),M=P.length,R,F;for(R=0;R<M;R++)if(F=P[R],r.Util.isValidSelector(F)||(r.Util.warn('Selector "'+F+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),F.charAt(0)==="#"){if(this.id()===F.slice(1))return!0}else if(F.charAt(0)==="."){if(this.hasName(F.slice(1)))return!0}else if(this.className===F||this.nodeType===F)return!0;return!1}getLayer(){const y=this.getParent();return y?y.getLayer():null}getStage(){return this._getCache(b,this._getStage)}_getStage(){const y=this.getParent();return y?y.getStage():null}fire(y,P={},M){return P.target=P.target||this,M?this._fireAndBubble(y,P):this._fire(y,P),this}getAbsoluteTransform(y){return y?this._getAbsoluteTransform(y):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(y){let P;if(y)return P=new r.Transform,this._eachAncestorReverse(function(M){const R=M.transformsEnabled();R==="all"?P.multiply(M.getTransform()):R==="position"&&P.translate(M.x()-M.offsetX(),M.y()-M.offsetY())},y),P;{P=this._cache.get(l)||new r.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(P):P.reset();const M=this.transformsEnabled();if(M==="all")P.multiply(this.getTransform());else if(M==="position"){const R=this.attrs.x||0,F=this.attrs.y||0,H=this.attrs.offsetX||0,G=this.attrs.offsetY||0;P.translate(R-H,F-G)}return P.dirty=!1,P}}getAbsoluteScale(y){let P=this;for(;P;)P._isUnderCache&&(y=P),P=P.getParent();const R=this.getAbsoluteTransform(y).decompose();return{x:R.scaleX,y:R.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(C,this._getTransform)}_getTransform(){var y,P;const M=this._cache.get(C)||new r.Transform;M.reset();const R=this.x(),F=this.y(),H=i.Konva.getAngle(this.rotation()),G=(y=this.attrs.scaleX)!==null&&y!==void 0?y:1,Y=(P=this.attrs.scaleY)!==null&&P!==void 0?P:1,it=this.attrs.skewX||0,V=this.attrs.skewY||0,N=this.attrs.offsetX||0,$=this.attrs.offsetY||0;return(R!==0||F!==0)&&M.translate(R,F),H!==0&&M.rotate(H),(it!==0||V!==0)&&M.skew(it,V),(G!==1||Y!==1)&&M.scale(G,Y),(N!==0||$!==0)&&M.translate(-1*N,-1*$),M.dirty=!1,M}clone(y){let P=r.Util.cloneObject(this.attrs),M,R,F,H,G;for(M in y)P[M]=y[M];const Y=new this.constructor(P);for(M in this.eventListeners)for(R=this.eventListeners[M],F=R.length,H=0;H<F;H++)G=R[H],G.name.indexOf(d)<0&&(Y.eventListeners[M]||(Y.eventListeners[M]=[]),Y.eventListeners[M].push(G));return Y}_toKonvaCanvas(y){y=y||{};const P=this.getClientRect(),M=this.getStage(),R=y.x!==void 0?y.x:Math.floor(P.x),F=y.y!==void 0?y.y:Math.floor(P.y),H=y.pixelRatio||1,G=new t.SceneCanvas({width:y.width||Math.ceil(P.width)||(M?M.width():0),height:y.height||Math.ceil(P.height)||(M?M.height():0),pixelRatio:H}),Y=G.getContext(),it=new t.SceneCanvas({width:G.width/G.pixelRatio+Math.abs(R),height:G.height/G.pixelRatio+Math.abs(F),pixelRatio:G.pixelRatio});return y.imageSmoothingEnabled===!1&&(Y._context.imageSmoothingEnabled=!1),Y.save(),(R||F)&&Y.translate(-1*R,-1*F),this.drawScene(G,void 0,it),Y.restore(),G}toCanvas(y){return this._toKonvaCanvas(y)._canvas}toDataURL(y){y=y||{};const P=y.mimeType||null,M=y.quality||null,R=this._toKonvaCanvas(y).toDataURL(P,M);return y.callback&&y.callback(R),R}toImage(y){return new Promise((P,M)=>{try{const R=y?.callback;R&&delete y.callback,r.Util._urlToImage(this.toDataURL(y),function(F){P(F),R?.(F)})}catch(R){M(R)}})}toBlob(y){return new Promise((P,M)=>{try{const R=y?.callback;R&&delete y.callback,this.toCanvas(y).toBlob(F=>{P(F),R?.(F)},y?.mimeType,y?.quality)}catch(R){M(R)}})}setSize(y){return this.width(y.width),this.height(y.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(y,P,M){let R=this.eventListeners[y],F,H,G;for(F=0;F<R.length;F++)if(H=R[F].name,G=R[F].handler,(H!=="konva"||P==="konva")&&(!P||H===P)&&(!M||M===G)){if(R.splice(F,1),R.length===0){delete this.eventListeners[y];break}F--}}_fireChangeEvent(y,P,M){this._fire(y+g,{oldVal:P,newVal:M})}addName(y){if(!this.hasName(y)){const P=this.name(),M=P?P+" "+y:y;this.name(M)}return this}hasName(y){if(!y)return!1;const P=this.name();return P?(P||"").split(/\s/g).indexOf(y)!==-1:!1}removeName(y){const P=(this.name()||"").split(/\s/g),M=P.indexOf(y);return M!==-1&&(P.splice(M,1),this.name(P.join(" "))),this}setAttr(y,P){const M=this[S+r.Util._capitalize(y)];return r.Util._isFunction(M)?M.call(this,P):this._setAttr(y,P),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const y=this.getLayer()||this.getStage();y?.batchDraw()}}_setAttr(y,P){const M=this.attrs[y];M===P&&!r.Util.isObject(P)||(P==null?delete this.attrs[y]:this.attrs[y]=P,this._shouldFireChangeEvents&&this._fireChangeEvent(y,M,P),this._requestDraw())}_setComponentAttr(y,P,M){let R;M!==void 0&&(R=this.attrs[y],R||(this.attrs[y]=this.getAttr(y)),this.attrs[y][P]=M,this._fireChangeEvent(y,R,M))}_fireAndBubble(y,P,M){P&&this.nodeType===k&&(P.target=this);const R=[v,w,x,m,u,_];if(!(R.indexOf(y)!==-1&&(M&&(this===M||this.isAncestorOf&&this.isAncestorOf(M))||this.nodeType==="Stage"&&!M))){this._fire(y,P);const H=R.indexOf(y)!==-1&&M&&M.isAncestorOf&&M.isAncestorOf(this)&&!M.isAncestorOf(this.parent);(P&&!P.cancelBubble||!P)&&this.parent&&this.parent.isListening()&&!H&&(M&&M.parent?this._fireAndBubble.call(this.parent,y,P,M):this._fireAndBubble.call(this.parent,y,P))}}_getProtoListeners(y){var P,M,R;const F=(P=this._cache.get(a))!==null&&P!==void 0?P:{};let H=F?.[y];if(H===void 0){H=[];let G=Object.getPrototypeOf(this);for(;G;){const Y=(R=(M=G.eventListeners)===null||M===void 0?void 0:M[y])!==null&&R!==void 0?R:[];H.push(...Y),G=Object.getPrototypeOf(G)}F[y]=H,this._cache.set(a,F)}return H}_fire(y,P){P=P||{},P.currentTarget=this,P.type=y;const M=this._getProtoListeners(y);if(M)for(let F=0;F<M.length;F++)M[F].handler.call(this,P);const R=this.eventListeners[y];if(R)for(let F=0;F<R.length;F++)R[F].handler.call(this,P)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(y){const P=y?y.pointerId:void 0,M=this.getStage(),R=this.getAbsolutePosition();if(!M)return;const F=M._getPointerById(P)||M._changedPointerPositions[0]||R;e.DD._dragElements.set(this._id,{node:this,startPointerPos:F,offset:{x:F.x-R.x,y:F.y-R.y},dragStatus:"ready",pointerId:P})}startDrag(y,P=!0){e.DD._dragElements.has(this._id)||this._createDragElement(y);const M=e.DD._dragElements.get(this._id);M.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:y&&y.evt},P)}_setDragPosition(y,P){const M=this.getStage()._getPointerById(P.pointerId);if(!M)return;let R={x:M.x-P.offset.x,y:M.y-P.offset.y};const F=this.dragBoundFunc();if(F!==void 0){const H=F.call(this,R,y);H?R=H:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==R.x||this._lastPos.y!==R.y)&&(this.setAbsolutePosition(R),this._requestDraw()),this._lastPos=R}stopDrag(y){const P=e.DD._dragElements.get(this._id);P&&(P.dragStatus="stopped"),e.DD._endDragBefore(y),e.DD._endDragAfter(y)}setDraggable(y){this._setAttr("draggable",y),this._dragChange()}isDragging(){const y=e.DD._dragElements.get(this._id);return y?y.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(y){if(!(!(y.evt.button!==void 0)||i.Konva.dragButtons.indexOf(y.evt.button)>=0)||this.isDragging())return;let R=!1;e.DD._dragElements.forEach(F=>{this.isAncestorOf(F.node)&&(R=!0)}),R||this._createDragElement(y)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const P=e.DD._dragElements.get(this._id),M=P&&P.dragStatus==="dragging",R=P&&P.dragStatus==="ready";M?this.stopDrag():R&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(y={x:0,y:0}){const P=this.getStage();if(!P)return!1;const M={x:-y.x,y:-y.y,width:P.width()+2*y.x,height:P.height()+2*y.y};return r.Util.haveIntersection(M,this.getClientRect())}static create(y,P){return r.Util._isString(y)&&(y=JSON.parse(y)),this._createNode(y,P)}static _createNode(y,P){let M=Js.prototype.getClassName.call(y),R=y.children,F,H,G;P&&(y.attrs.container=P),i.Konva[M]||(r.Util.warn('Can not find a node with class name "'+M+'". Fallback to "Shape".'),M="Shape");const Y=i.Konva[M];if(F=new Y(y.attrs),R)for(H=R.length,G=0;G<H;G++)F.add(Js._createNode(R[G]));return F}};Zn.Node=U,U.prototype.nodeType="Node",U.prototype._attrsAffectingSize=[],U.prototype.eventListeners={},U.prototype.on.call(U.prototype,D,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(C),this._clearSelfAndDescendantCache(l)}),U.prototype.on.call(U.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(A)}),U.prototype.on.call(U.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(p)}),U.prototype.on.call(U.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const z=n.Factory.addGetterSetter;return z(U,"zIndex"),z(U,"absolutePosition"),z(U,"position"),z(U,"x",0,(0,s.getNumberValidator)()),z(U,"y",0,(0,s.getNumberValidator)()),z(U,"globalCompositeOperation","source-over",(0,s.getStringValidator)()),z(U,"opacity",1,(0,s.getNumberValidator)()),z(U,"name","",(0,s.getStringValidator)()),z(U,"id","",(0,s.getStringValidator)()),z(U,"rotation",0,(0,s.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"scale",["x","y"]),z(U,"scaleX",1,(0,s.getNumberValidator)()),z(U,"scaleY",1,(0,s.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"skew",["x","y"]),z(U,"skewX",0,(0,s.getNumberValidator)()),z(U,"skewY",0,(0,s.getNumberValidator)()),n.Factory.addComponentsGetterSetter(U,"offset",["x","y"]),z(U,"offsetX",0,(0,s.getNumberValidator)()),z(U,"offsetY",0,(0,s.getNumberValidator)()),z(U,"dragDistance",void 0,(0,s.getNumberValidator)()),z(U,"width",0,(0,s.getNumberValidator)()),z(U,"height",0,(0,s.getNumberValidator)()),z(U,"listening",!0,(0,s.getBooleanValidator)()),z(U,"preventDefault",!0,(0,s.getBooleanValidator)()),z(U,"filters",void 0,function(K){return this._filterUpToDate=!1,K}),z(U,"visible",!0,(0,s.getBooleanValidator)()),z(U,"transformsEnabled","all",(0,s.getStringValidator)()),z(U,"size"),z(U,"dragBoundFunc"),z(U,"draggable",!1,(0,s.getBooleanValidator)()),n.Factory.backCompat(U,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Zn}var qn={},rl;function _r(){if(rl)return qn;rl=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.Container=void 0;const t=yt(),e=Gt(),n=bt();let i=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(s){const o=this.children||[];return s?o.filter(s):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.destroy()}),this.children=[],this._requestDraw(),this}add(...s){if(s.length===0)return this;if(s.length>1){for(let a=0;a<s.length;a++)this.add(s[a]);return this}const o=s[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(s){return this._generalFind(s,!1)}findOne(s){const o=this._generalFind(s,!0);return o.length>0?o[0]:void 0}_generalFind(s,o){const a=[];return this._descendants(l=>{const c=l._isMatch(s);return c&&a.push(l),!!(c&&o)}),a}_descendants(s){let o=!1;const a=this.getChildren();for(const l of a){if(o=s(l),o)return!0;if(l.hasChildren()&&(o=l._descendants(s),o))return!0}return!1}toObject(){const s=e.Node.prototype.toObject.call(this);return s.children=[],this.getChildren().forEach(o=>{s.children.push(o.toObject())}),s}isAncestorOf(s){let o=s.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(s){const o=e.Node.prototype.clone.call(this,s);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(s){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(s)&&o.push(a)}),o}_clearSelfAndDescendantCache(s){var o;super._clearSelfAndDescendantCache(s),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(s)}))}_setChildrenIndices(){var s;(s=this.children)===null||s===void 0||s.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(s,o,a){const l=this.getLayer(),c=s||l&&l.getCanvas(),h=c&&c.getContext(),g=this._getCanvasCache(),f=g&&g.scene,d=c&&c.isCache;if(!this.isVisible()&&!d)return this;if(f){h.save();const p=this.getAbsoluteTransform(o).getMatrix();h.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(h),h.restore()}else this._drawChildren("drawScene",c,o,a);return this}drawHit(s,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),l=s||a&&a.hitCanvas,c=l&&l.getContext(),h=this._getCanvasCache();if(h&&h.hit){c.save();const f=this.getAbsoluteTransform(o).getMatrix();c.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",l,o);return this}_drawChildren(s,o,a,l){var c;const h=o&&o.getContext(),g=this.clipWidth(),f=this.clipHeight(),d=this.clipFunc(),p=typeof g=="number"&&typeof f=="number"||d,v=a===this;if(p){h.save();const x=this.getAbsoluteTransform(a);let m=x.getMatrix();h.transform(m[0],m[1],m[2],m[3],m[4],m[5]),h.beginPath();let u;if(d)u=d.call(this,h,this);else{const _=this.clipX(),S=this.clipY();h.rect(_||0,S||0,g,f)}h.clip.apply(h,u),m=x.copy().invert().getMatrix(),h.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const w=!v&&this.globalCompositeOperation()!=="source-over"&&s==="drawScene";w&&(h.save(),h._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(x){x[s](o,a,l)}),w&&h.restore(),p&&h.restore()}getClientRect(s={}){var o;const a=s.skipTransform,l=s.relativeTo;let c,h,g,f,d={x:1/0,y:1/0,width:0,height:0};const p=this;(o=this.children)===null||o===void 0||o.forEach(function(x){if(!x.visible())return;const m=x.getClientRect({relativeTo:p,skipShadow:s.skipShadow,skipStroke:s.skipStroke});m.width===0&&m.height===0||(c===void 0?(c=m.x,h=m.y,g=m.x+m.width,f=m.y+m.height):(c=Math.min(c,m.x),h=Math.min(h,m.y),g=Math.max(g,m.x+m.width),f=Math.max(f,m.y+m.height)))});const v=this.find("Shape");let w=!1;for(let x=0;x<v.length;x++)if(v[x]._isVisible(this)){w=!0;break}return w&&c!==void 0?d={x:c,y:h,width:g-c,height:f-h}:d={x:0,y:0,width:0,height:0},a?d:this._transformedRect(d,l)}};return qn.Container=i,t.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(i,"clipFunc"),qn}var ks={},$e={},sl;function ol(){if(sl)return $e;sl=1,Object.defineProperty($e,"__esModule",{value:!0}),$e.getCapturedShape=i,$e.createEvent=r,$e.hasPointerCapture=s,$e.setPointerCapture=o,$e.releaseCapture=a;const t=vt(),e=new Map,n=t.Konva._global.PointerEvent!==void 0;function i(l){return e.get(l)}function r(l){return{evt:l,pointerId:l.pointerId}}function s(l,c){return e.get(l)===c}function o(l,c){a(l),c.getStage()&&(e.set(l,c),n&&c._fire("gotpointercapture",r(new PointerEvent("gotpointercapture"))))}function a(l,c){const h=e.get(l);if(!h)return;const g=h.getStage();g&&g.content,e.delete(l),n&&h._fire("lostpointercapture",r(new PointerEvent("lostpointercapture")))}return $e}var al;function tf(){return al||(al=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=zt(),n=yt(),i=_r(),r=vt(),s=mr(),o=Ps(),a=vt(),l=ol(),c="Stage",h="string",g="px",f="mouseout",d="mouseleave",p="mouseover",v="mouseenter",w="mousemove",x="mousedown",m="mouseup",u="pointermove",_="pointerdown",S="pointerup",k="pointercancel",O="lostpointercapture",b="pointerout",C="pointerleave",T="pointerover",A="pointerenter",D="contextmenu",L="touchstart",U="touchend",z="touchmove",K="touchcancel",y="wheel",P=5,M=[[v,"_pointerenter"],[x,"_pointerdown"],[w,"_pointermove"],[m,"_pointerup"],[d,"_pointerleave"],[L,"_pointerdown"],[z,"_pointermove"],[U,"_pointerup"],[K,"_pointercancel"],[p,"_pointerover"],[y,"_wheel"],[D,"_contextmenu"],[_,"_pointerdown"],[u,"_pointermove"],[S,"_pointerup"],[k,"_pointercancel"],[C,"_pointerleave"],[O,"_lostpointercapture"]],R={mouse:{[b]:f,[C]:d,[T]:p,[A]:v,[u]:w,[_]:x,[S]:m,[k]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[b]:"touchout",[C]:"touchleave",[T]:"touchover",[A]:"touchenter",[u]:z,[_]:L,[S]:U,[k]:K,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[b]:b,[C]:C,[T]:T,[A]:A,[u]:u,[_]:_,[S]:S,[k]:k,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},F=V=>V.indexOf("pointer")>=0?"pointer":V.indexOf("touch")>=0?"touch":"mouse",H=V=>{const N=F(V);if(N==="pointer")return r.Konva.pointerEventsEnabled&&R.pointer;if(N==="touch")return R.touch;if(N==="mouse")return R.mouse};function G(V={}){return(V.clipFunc||V.clipWidth||V.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),V}const Y="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class it extends i.Container{constructor(N){super(G(N)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{G(this.attrs)}),this._checkVisibility()}_validateAdd(N){const $=N.getType()==="Layer",tt=N.getType()==="FastLayer";$||tt||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const N=this.visible()?"":"none";this.content.style.display=N}setContainer(N){if(typeof N===h){let $;if(N.charAt(0)==="."){const tt=N.slice(1);N=document.getElementsByClassName(tt)[0]}else N.charAt(0)!=="#"?$=N:$=N.slice(1),N=document.getElementById($);if(!N)throw"Can not find container in document with id "+$}return this._setAttr("container",N),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),N.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const N=this.children,$=N.length;for(let tt=0;tt<$;tt++)N[tt].clear();return this}clone(N){return N||(N={}),N.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,N)}destroy(){super.destroy();const N=this.content;N&&e.Util._isInDocument(N)&&this.container().removeChild(N);const $=t.stages.indexOf(this);return $>-1&&t.stages.splice($,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const N=this._pointerPositions[0]||this._changedPointerPositions[0];return N?{x:N.x,y:N.y}:(e.Util.warn(Y),null)}_getPointerById(N){return this._pointerPositions.find($=>$.id===N)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(N){N=N||{},N.x=N.x||0,N.y=N.y||0,N.width=N.width||this.width(),N.height=N.height||this.height();const $=new s.SceneCanvas({width:N.width,height:N.height,pixelRatio:N.pixelRatio||1}),tt=$.getContext()._context,st=this.children;return(N.x||N.y)&&tt.translate(-1*N.x,-1*N.y),st.forEach(function(ct){if(!ct.isVisible())return;const E=ct._toKonvaCanvas(N);tt.drawImage(E._canvas,N.x,N.y,E.getWidth()/E.getPixelRatio(),E.getHeight()/E.getPixelRatio())}),$}getIntersection(N){if(!N)return null;const $=this.children,tt=$.length,st=tt-1;for(let ct=st;ct>=0;ct--){const E=$[ct].getIntersection(N);if(E)return E}return null}_resizeDOM(){const N=this.width(),$=this.height();this.content&&(this.content.style.width=N+g,this.content.style.height=$+g),this.bufferCanvas.setSize(N,$),this.bufferHitCanvas.setSize(N,$),this.children.forEach(tt=>{tt.setSize({width:N,height:$}),tt.draw()})}add(N,...$){if(arguments.length>1){for(let st=0;st<arguments.length;st++)this.add(arguments[st]);return this}super.add(N);const tt=this.children.length;return tt>P&&e.Util.warn("The stage has "+tt+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),N.setSize({width:this.width(),height:this.height()}),N.draw(),r.Konva.isBrowser&&this.content.appendChild(N.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(N){return l.hasPointerCapture(N,this)}setPointerCapture(N){l.setPointerCapture(N,this)}releaseCapture(N){l.releaseCapture(N,this)}getLayers(){return this.children}_bindContentEvents(){r.Konva.isBrowser&&M.forEach(([N,$])=>{this.content.addEventListener(N,tt=>{this[$](tt)},{passive:!1})})}_pointerenter(N){this.setPointersPositions(N);const $=H(N.type);$&&this._fire($.pointerenter,{evt:N,target:this,currentTarget:this})}_pointerover(N){this.setPointersPositions(N);const $=H(N.type);$&&this._fire($.pointerover,{evt:N,target:this,currentTarget:this})}_getTargetShape(N){let $=this[N+"targetShape"];return $&&!$.getStage()&&($=null),$}_pointerleave(N){const $=H(N.type),tt=F(N.type);if(!$)return;this.setPointersPositions(N);const st=this._getTargetShape(tt),ct=!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled;st&&ct?(st._fireAndBubble($.pointerout,{evt:N}),st._fireAndBubble($.pointerleave,{evt:N}),this._fire($.pointerleave,{evt:N,target:this,currentTarget:this}),this[tt+"targetShape"]=null):ct&&(this._fire($.pointerleave,{evt:N,target:this,currentTarget:this}),this._fire($.pointerout,{evt:N,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(N){const $=H(N.type),tt=F(N.type);if(!$)return;this.setPointersPositions(N);let st=!1;this._changedPointerPositions.forEach(ct=>{const E=this.getIntersection(ct);if(o.DD.justDragged=!1,r.Konva["_"+tt+"ListenClick"]=!0,!E||!E.isListening()){this[tt+"ClickStartShape"]=void 0;return}r.Konva.capturePointerEventsEnabled&&E.setPointerCapture(ct.id),this[tt+"ClickStartShape"]=E,E._fireAndBubble($.pointerdown,{evt:N,pointerId:ct.id}),st=!0;const I=N.type.indexOf("touch")>=0;E.preventDefault()&&N.cancelable&&I&&N.preventDefault()}),st||this._fire($.pointerdown,{evt:N,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(N){const $=H(N.type),tt=F(N.type);if(!$||(r.Konva.isDragging()&&o.DD.node.preventDefault()&&N.cancelable&&N.preventDefault(),this.setPointersPositions(N),!(!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled)))return;const ct={};let E=!1;const I=this._getTargetShape(tt);this._changedPointerPositions.forEach(B=>{const W=l.getCapturedShape(B.id)||this.getIntersection(B),q=B.id,j={evt:N,pointerId:q},Q=I!==W;if(Q&&I&&(I._fireAndBubble($.pointerout,{...j},W),I._fireAndBubble($.pointerleave,{...j},W)),W){if(ct[W._id])return;ct[W._id]=!0}W&&W.isListening()?(E=!0,Q&&(W._fireAndBubble($.pointerover,{...j},I),W._fireAndBubble($.pointerenter,{...j},I),this[tt+"targetShape"]=W),W._fireAndBubble($.pointermove,{...j})):I&&(this._fire($.pointerover,{evt:N,target:this,currentTarget:this,pointerId:q}),this[tt+"targetShape"]=null)}),E||this._fire($.pointermove,{evt:N,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(N){const $=H(N.type),tt=F(N.type);if(!$)return;this.setPointersPositions(N);const st=this[tt+"ClickStartShape"],ct=this[tt+"ClickEndShape"],E={};let I=!1;this._changedPointerPositions.forEach(B=>{const W=l.getCapturedShape(B.id)||this.getIntersection(B);if(W){if(W.releaseCapture(B.id),E[W._id])return;E[W._id]=!0}const q=B.id,j={evt:N,pointerId:q};let Q=!1;r.Konva["_"+tt+"InDblClickWindow"]?(Q=!0,clearTimeout(this[tt+"DblTimeout"])):o.DD.justDragged||(r.Konva["_"+tt+"InDblClickWindow"]=!0,clearTimeout(this[tt+"DblTimeout"])),this[tt+"DblTimeout"]=setTimeout(function(){r.Konva["_"+tt+"InDblClickWindow"]=!1},r.Konva.dblClickWindow),W&&W.isListening()?(I=!0,this[tt+"ClickEndShape"]=W,W._fireAndBubble($.pointerup,{...j}),r.Konva["_"+tt+"ListenClick"]&&st&&st===W&&(W._fireAndBubble($.pointerclick,{...j}),Q&&ct&&ct===W&&W._fireAndBubble($.pointerdblclick,{...j}))):(this[tt+"ClickEndShape"]=null,r.Konva["_"+tt+"ListenClick"]&&this._fire($.pointerclick,{evt:N,target:this,currentTarget:this,pointerId:q}),Q&&this._fire($.pointerdblclick,{evt:N,target:this,currentTarget:this,pointerId:q}))}),I||this._fire($.pointerup,{evt:N,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),r.Konva["_"+tt+"ListenClick"]=!1,N.cancelable&&tt!=="touch"&&tt!=="pointer"&&N.preventDefault()}_contextmenu(N){this.setPointersPositions(N);const $=this.getIntersection(this.getPointerPosition());$&&$.isListening()?$._fireAndBubble(D,{evt:N}):this._fire(D,{evt:N,target:this,currentTarget:this})}_wheel(N){this.setPointersPositions(N);const $=this.getIntersection(this.getPointerPosition());$&&$.isListening()?$._fireAndBubble(y,{evt:N}):this._fire(y,{evt:N,target:this,currentTarget:this})}_pointercancel(N){this.setPointersPositions(N);const $=l.getCapturedShape(N.pointerId)||this.getIntersection(this.getPointerPosition());$&&$._fireAndBubble(S,l.createEvent(N)),l.releaseCapture(N.pointerId)}_lostpointercapture(N){l.releaseCapture(N.pointerId)}setPointersPositions(N){const $=this._getContentPosition();let tt=null,st=null;N=N||window.event,N.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(N.touches,ct=>{this._pointerPositions.push({id:ct.identifier,x:(ct.clientX-$.left)/$.scaleX,y:(ct.clientY-$.top)/$.scaleY})}),Array.prototype.forEach.call(N.changedTouches||N.touches,ct=>{this._changedPointerPositions.push({id:ct.identifier,x:(ct.clientX-$.left)/$.scaleX,y:(ct.clientY-$.top)/$.scaleY})})):(tt=(N.clientX-$.left)/$.scaleX,st=(N.clientY-$.top)/$.scaleY,this.pointerPos={x:tt,y:st},this._pointerPositions=[{x:tt,y:st,id:e.Util._getFirstPointerId(N)}],this._changedPointerPositions=[{x:tt,y:st,id:e.Util._getFirstPointerId(N)}])}_setPointerPosition(N){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(N)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const N=this.content.getBoundingClientRect();return{top:N.top,left:N.left,scaleX:N.width/this.content.clientWidth||1,scaleY:N.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!r.Konva.isBrowser)return;const N=this.container();if(!N)throw"Stage has no container. A container is required.";N.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),N.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(N){N.batchDraw()}),this}}t.Stage=it,it.prototype.nodeType=c,(0,a._registerNode)(it),n.Factory.addGetterSetter(it,"container"),r.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(V=>{V.batchDraw()})})}(ks)),ks}var Kn={},Es={},ll;function Vt(){return ll||(ll=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=vt(),n=zt(),i=yt(),r=Gt(),s=bt(),o=vt(),a=ol(),l="hasShadow",c="shadowRGBA",h="patternImage",g="linearGradient",f="radialGradient";let d;function p(){return d||(d=n.Util.createCanvasElement().getContext("2d"),d)}t.shapes={};function v(C){const T=this.attrs.fillRule;T?C.fill(T):C.fill()}function w(C){C.stroke()}function x(C){const T=this.attrs.fillRule;T?C.fill(T):C.fill()}function m(C){C.stroke()}function u(){this._clearCache(l)}function _(){this._clearCache(c)}function S(){this._clearCache(h)}function k(){this._clearCache(g)}function O(){this._clearCache(f)}class b extends r.Node{constructor(T){super(T);let A;for(;A=n.Util.getRandomColor(),!(A&&!(A in t.shapes)););this.colorKey=A,t.shapes[A]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const A=p().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(A&&A.setTransform){const D=new n.Transform;D.translate(this.fillPatternX(),this.fillPatternY()),D.rotate(e.Konva.getAngle(this.fillPatternRotation())),D.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),D.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const L=D.getMatrix(),U=typeof DOMMatrix>"u"?{a:L[0],b:L[1],c:L[2],d:L[3],e:L[4],f:L[5]}:new DOMMatrix(L);A.setTransform(U)}return A}}_getLinearGradient(){return this._getCache(g,this.__getLinearGradient)}__getLinearGradient(){const T=this.fillLinearGradientColorStops();if(T){const A=p(),D=this.fillLinearGradientStartPoint(),L=this.fillLinearGradientEndPoint(),U=A.createLinearGradient(D.x,D.y,L.x,L.y);for(let z=0;z<T.length;z+=2)U.addColorStop(T[z],T[z+1]);return U}}_getRadialGradient(){return this._getCache(f,this.__getRadialGradient)}__getRadialGradient(){const T=this.fillRadialGradientColorStops();if(T){const A=p(),D=this.fillRadialGradientStartPoint(),L=this.fillRadialGradientEndPoint(),U=A.createRadialGradient(D.x,D.y,this.fillRadialGradientStartRadius(),L.x,L.y,this.fillRadialGradientEndRadius());for(let z=0;z<T.length;z+=2)U.addColorStop(T[z],T[z+1]);return U}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const T=n.Util.colorToRGBA(this.shadowColor());if(T)return"rgba("+T.r+","+T.g+","+T.b+","+T.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const T=this.hitStrokeWidth();return T==="auto"?this.hasStroke():this.strokeEnabled()&&!!T}intersects(T){const A=this.getStage();if(!A)return!1;const D=A.bufferHitCanvas;return D.getContext().clear(),this.drawHit(D,void 0,!0),D.context.getImageData(Math.round(T.x),Math.round(T.y),1,1).data[3]>0}destroy(){return r.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(T){var A;if(!((A=this.attrs.perfectDrawEnabled)!==null&&A!==void 0?A:!0))return!1;const L=T||this.hasFill(),U=this.hasStroke(),z=this.getAbsoluteOpacity()!==1;if(L&&U&&z)return!0;const K=this.hasShadow(),y=this.shadowForStrokeEnabled();return!!(L&&U&&K&&y)}setStrokeHitEnabled(T){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),T?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const T=this.size();return{x:this._centroid?-T.width/2:0,y:this._centroid?-T.height/2:0,width:T.width,height:T.height}}getClientRect(T={}){let A=!1,D=this.getParent();for(;D;){if(D.isCached()){A=!0;break}D=D.getParent()}const L=T.skipTransform,U=T.relativeTo||A&&this.getStage()||void 0,z=this.getSelfRect(),y=!T.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,P=z.width+y,M=z.height+y,R=!T.skipShadow&&this.hasShadow(),F=R?this.shadowOffsetX():0,H=R?this.shadowOffsetY():0,G=P+Math.abs(F),Y=M+Math.abs(H),it=R&&this.shadowBlur()||0,V=G+it*2,N=Y+it*2,$={width:V,height:N,x:-(y/2+it)+Math.min(F,0)+z.x,y:-(y/2+it)+Math.min(H,0)+z.y};return L?$:this._transformedRect($,U)}drawScene(T,A,D){const L=this.getLayer(),U=T||L.getCanvas(),z=U.getContext(),K=this._getCanvasCache(),y=this.getSceneFunc(),P=this.hasShadow();let M;const R=A===this;if(!this.isVisible()&&!R)return this;if(K){z.save();const F=this.getAbsoluteTransform(A).getMatrix();return z.transform(F[0],F[1],F[2],F[3],F[4],F[5]),this._drawCachedSceneCanvas(z),z.restore(),this}if(!y)return this;if(z.save(),this._useBufferCanvas()){M=this.getStage();const F=D||M.bufferCanvas,H=F.getContext();H.clear(),H.save(),H._applyLineJoin(this);const G=this.getAbsoluteTransform(A).getMatrix();H.transform(G[0],G[1],G[2],G[3],G[4],G[5]),y.call(this,H,this),H.restore();const Y=F.pixelRatio;P&&z._applyShadow(this),z._applyOpacity(this),z._applyGlobalCompositeOperation(this),z.drawImage(F._canvas,F.x||0,F.y||0,F.width/Y,F.height/Y)}else{if(z._applyLineJoin(this),!R){const F=this.getAbsoluteTransform(A).getMatrix();z.transform(F[0],F[1],F[2],F[3],F[4],F[5]),z._applyOpacity(this),z._applyGlobalCompositeOperation(this)}P&&z._applyShadow(this),y.call(this,z,this)}return z.restore(),this}drawHit(T,A,D=!1){if(!this.shouldDrawHit(A,D))return this;const L=this.getLayer(),U=T||L.hitCanvas,z=U&&U.getContext(),K=this.hitFunc()||this.sceneFunc(),y=this._getCanvasCache(),P=y&&y.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),P){z.save();const R=this.getAbsoluteTransform(A).getMatrix();return z.transform(R[0],R[1],R[2],R[3],R[4],R[5]),this._drawCachedHitCanvas(z),z.restore(),this}if(!K)return this;if(z.save(),z._applyLineJoin(this),!(this===A)){const R=this.getAbsoluteTransform(A).getMatrix();z.transform(R[0],R[1],R[2],R[3],R[4],R[5])}return K.call(this,z,this),z.restore(),this}drawHitFromCache(T=0){const A=this._getCanvasCache(),D=this._getCachedSceneCanvas(),L=A.hit,U=L.getContext(),z=L.getWidth(),K=L.getHeight();U.clear(),U.drawImage(D._canvas,0,0,z,K);try{const y=U.getImageData(0,0,z,K),P=y.data,M=P.length,R=n.Util._hexToRgb(this.colorKey);for(let F=0;F<M;F+=4)P[F+3]>T?(P[F]=R.r,P[F+1]=R.g,P[F+2]=R.b,P[F+3]=255):P[F+3]=0;U.putImageData(y,0,0)}catch(y){n.Util.error("Unable to draw hit graph from cached scene canvas. "+y.message)}return this}hasPointerCapture(T){return a.hasPointerCapture(T,this)}setPointerCapture(T){a.setPointerCapture(T,this)}releaseCapture(T){a.releaseCapture(T,this)}}t.Shape=b,b.prototype._fillFunc=v,b.prototype._strokeFunc=w,b.prototype._fillFuncHit=x,b.prototype._strokeFuncHit=m,b.prototype._centroid=!1,b.prototype.nodeType="Shape",(0,o._registerNode)(b),b.prototype.eventListeners={},b.prototype.on.call(b.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",u),b.prototype.on.call(b.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),b.prototype.on.call(b.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",S),b.prototype.on.call(b.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",k),b.prototype.on.call(b.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",O),i.Factory.addGetterSetter(b,"stroke",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(b,"strokeWidth",2,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(b,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(b,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(b,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(b,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(b,"lineJoin"),i.Factory.addGetterSetter(b,"lineCap"),i.Factory.addGetterSetter(b,"sceneFunc"),i.Factory.addGetterSetter(b,"hitFunc"),i.Factory.addGetterSetter(b,"dash"),i.Factory.addGetterSetter(b,"dashOffset",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"shadowColor",void 0,(0,s.getStringValidator)()),i.Factory.addGetterSetter(b,"shadowBlur",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"shadowOpacity",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(b,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(b,"shadowOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"shadowOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternImage"),i.Factory.addGetterSetter(b,"fill",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(b,"fillPatternX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(b,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(b,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(b,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(b,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(b,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(b,"fillEnabled",!0),i.Factory.addGetterSetter(b,"strokeEnabled",!0),i.Factory.addGetterSetter(b,"shadowEnabled",!0),i.Factory.addGetterSetter(b,"dashEnabled",!0),i.Factory.addGetterSetter(b,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(b,"fillPriority","color"),i.Factory.addComponentsGetterSetter(b,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(b,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(b,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(b,"fillPatternScaleX",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternScaleY",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(b,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(b,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(b,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(b,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(b,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(b,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(b,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(b,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(b,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(b,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(b,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(b,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(b,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(b,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(b,"fillPatternRotation",0),i.Factory.addGetterSetter(b,"fillRule",void 0,(0,s.getStringValidator)()),i.Factory.backCompat(b,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(Es)),Es}var cl;function hl(){if(cl)return Kn;cl=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.Layer=void 0;const t=zt(),e=_r(),n=Gt(),i=yt(),r=mr(),s=bt(),o=Vt(),a=vt(),l="#",c="beforeDraw",h="draw",g=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],f=g.length;let d=class extends e.Container{constructor(v){super(v),this.canvas=new r.SceneCanvas,this.hitCanvas=new r.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(v){return this.getContext().clear(v),this.getHitCanvas().getContext().clear(v),this}setZIndex(v){super.setZIndex(v);const w=this.getStage();return w&&w.content&&(w.content.removeChild(this.getNativeCanvasElement()),v<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[v+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!n.Node.prototype.moveUp.call(this))return!1;const w=this.getStage();return!w||!w.content?!1:(w.content.removeChild(this.getNativeCanvasElement()),this.index<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[this.index+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const v=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),v&&v.parentNode&&t.Util._isInDocument(v)&&v.parentNode.removeChild(v),this}getStage(){return this.parent}setSize({width:v,height:w}){return this.canvas.setSize(v,w),this.hitCanvas.setSize(v,w),this._setSmoothEnabled(),this}_validateAdd(v){const w=v.getType();w!=="Group"&&w!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(v){return v=v||{},v.width=v.width||this.getWidth(),v.height=v.height||this.getHeight(),v.x=v.x!==void 0?v.x:this.x(),v.y=v.y!==void 0?v.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,v)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(v){if(!this.isListening()||!this.isVisible())return null;let w=1,x=!1;for(;;){for(let m=0;m<f;m++){const u=g[m],_=this._getIntersection({x:v.x+u.x*w,y:v.y+u.y*w}),S=_.shape;if(S)return S;if(x=!!_.antialiased,!_.antialiased)break}if(x)w+=1;else return null}}_getIntersection(v){const w=this.hitCanvas.pixelRatio,x=this.hitCanvas.context.getImageData(Math.round(v.x*w),Math.round(v.y*w),1,1).data,m=x[3];if(m===255){const u=t.Util._rgbToHex(x[0],x[1],x[2]),_=o.shapes[l+u];return _?{shape:_}:{antialiased:!0}}else if(m>0)return{antialiased:!0};return{}}drawScene(v,w,x){const m=this.getLayer(),u=v||m&&m.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&u.getContext().clear(),e.Container.prototype.drawScene.call(this,u,w,x),this._fire(h,{node:this}),this}drawHit(v,w){const x=this.getLayer(),m=v||x&&x.hitCanvas;return x&&x.clearBeforeDraw()&&x.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,m,w),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(v){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(v)}getHitGraphEnabled(v){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const v=this.parent;!!this.hitCanvas._canvas.parentNode?v.content.removeChild(this.hitCanvas._canvas):v.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return Kn.Layer=d,d.prototype.nodeType="Layer",(0,a._registerNode)(d),i.Factory.addGetterSetter(d,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(d,"clearBeforeDraw",!0),i.Factory.addGetterSetter(d,"hitGraphEnabled",!0,(0,s.getBooleanValidator)()),Kn}var Yn={},ul;function ef(){if(ul)return Yn;ul=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.FastLayer=void 0;const t=zt(),e=hl(),n=vt();let i=class extends e.Layer{constructor(s){super(s),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return Yn.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),Yn}var Xn={},dl;function Rs(){if(dl)return Xn;dl=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.Group=void 0;const t=zt(),e=_r(),n=vt();let i=class extends e.Container{_validateAdd(s){const o=s.getType();o!=="Group"&&o!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return Xn.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),Xn}var Qn={},fl;function As(){if(fl)return Qn;fl=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.Animation=void 0;const t=vt(),e=zt(),n=function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}}();let i=class En{constructor(s,o){this.id=En.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=s,this.setLayers(o)}setLayers(s){let o=[];return s&&(o=Array.isArray(s)?s:[s]),this.layers=o,this}getLayers(){return this.layers}addLayer(s){const o=this.layers,a=o.length;for(let l=0;l<a;l++)if(o[l]._id===s._id)return!1;return this.layers.push(s),!0}isRunning(){const o=En.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),En._addAnimation(this),this}stop(){return En._removeAnimation(this),this}_updateFrameObject(s){this.frame.timeDiff=s-this.frame.lastTime,this.frame.lastTime=s,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(s){this.animations.push(s),this._handleAnimation()}static _removeAnimation(s){const o=s.id,a=this.animations,l=a.length;for(let c=0;c<l;c++)if(a[c].id===o){this.animations.splice(c,1);break}}static _runFrames(){const s={},o=this.animations;for(let a=0;a<o.length;a++){const l=o[a],c=l.layers,h=l.func;l._updateFrameObject(n());const g=c.length;let f;if(h?f=h.call(l,l.frame)!==!1:f=!0,!!f)for(let d=0;d<g;d++){const p=c[d];p._id!==void 0&&(s[p._id]=p)}}for(const a in s)s.hasOwnProperty(a)&&s[a].batchDraw()}static _animationLoop(){const s=En;s.animations.length?(s._runFrames(),e.Util.requestAnimFrame(s._animationLoop)):s.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return Qn.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,Qn}var Ns={},gl;function nf(){return gl||(gl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=zt(),n=As(),i=Gt(),r=vt(),s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,l=3,c=["fill","stroke","shadowColor"];let h=0;class g{constructor(p,v,w,x,m,u,_){this.prop=p,this.propFunc=v,this.begin=x,this._pos=x,this.duration=u,this._change=0,this.prevPos=0,this.yoyo=_,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=w,this._change=m-this.begin,this.pause()}fire(p){const v=this[p];v&&v()}setTime(p){p>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():p<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=p,this.update())}getTime(){return this._time}setPosition(p){this.prevPos=this._pos,this.propFunc(p),this._pos=p}getPosition(p){return p===void 0&&(p=this._time),this.func(p,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(p){this.pause(),this._time=p,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const p=this.getTimer()-this._startTime;this.state===a?this.setTime(p):this.state===l&&this.setTime(this.duration-p)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class f{constructor(p){const v=this,w=p.node,x=w._id,m=p.easing||t.Easings.Linear,u=!!p.yoyo;let _,S;typeof p.duration>"u"?_=.3:p.duration===0?_=.001:_=p.duration,this.node=w,this._id=h++;const k=w.getLayer()||(w instanceof r.Konva.Stage?w.getLayers():null);k||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){v.tween.onEnterFrame()},k),this.tween=new g(S,function(O){v._tweenFunc(O)},m,0,1,_*1e3,u),this._addListeners(),f.attrs[x]||(f.attrs[x]={}),f.attrs[x][this._id]||(f.attrs[x][this._id]={}),f.tweens[x]||(f.tweens[x]={});for(S in p)s[S]===void 0&&this._addAttr(S,p[S]);this.reset(),this.onFinish=p.onFinish,this.onReset=p.onReset,this.onUpdate=p.onUpdate}_addAttr(p,v){const w=this.node,x=w._id;let m,u,_,S,k;const O=f.tweens[x][p];O&&delete f.attrs[x][O][p];let b=w.getAttr(p);if(e.Util._isArray(v))if(m=[],u=Math.max(v.length,b.length),p==="points"&&v.length!==b.length&&(v.length>b.length?(S=b,b=e.Util._prepareArrayForTween(b,v,w.closed())):(_=v,v=e.Util._prepareArrayForTween(v,b,w.closed()))),p.indexOf("fill")===0)for(let C=0;C<u;C++)if(C%2===0)m.push(v[C]-b[C]);else{const T=e.Util.colorToRGBA(b[C]);k=e.Util.colorToRGBA(v[C]),b[C]=T,m.push({r:k.r-T.r,g:k.g-T.g,b:k.b-T.b,a:k.a-T.a})}else for(let C=0;C<u;C++)m.push(v[C]-b[C]);else c.indexOf(p)!==-1?(b=e.Util.colorToRGBA(b),k=e.Util.colorToRGBA(v),m={r:k.r-b.r,g:k.g-b.g,b:k.b-b.b,a:k.a-b.a}):m=v-b;f.attrs[x][this._id][p]={start:b,diff:m,end:v,trueEnd:_,trueStart:S},f.tweens[x][p]=this._id}_tweenFunc(p){const v=this.node,w=f.attrs[v._id][this._id];let x,m,u,_,S,k,O,b;for(x in w){if(m=w[x],u=m.start,_=m.diff,b=m.end,e.Util._isArray(u))if(S=[],O=Math.max(u.length,b.length),x.indexOf("fill")===0)for(k=0;k<O;k++)k%2===0?S.push((u[k]||0)+_[k]*p):S.push("rgba("+Math.round(u[k].r+_[k].r*p)+","+Math.round(u[k].g+_[k].g*p)+","+Math.round(u[k].b+_[k].b*p)+","+(u[k].a+_[k].a*p)+")");else for(k=0;k<O;k++)S.push((u[k]||0)+_[k]*p);else c.indexOf(x)!==-1?S="rgba("+Math.round(u.r+_.r*p)+","+Math.round(u.g+_.g*p)+","+Math.round(u.b+_.b*p)+","+(u.a+_.a*p)+")":S=u+_*p;v.setAttr(x,S)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const p=this.node,v=f.attrs[p._id][this._id];v.points&&v.points.trueEnd&&p.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const p=this.node,v=f.attrs[p._id][this._id];v.points&&v.points.trueStart&&p.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(p){return this.tween.seek(p*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const p=this.node._id,v=this._id,w=f.tweens[p];this.pause(),this.anim&&this.anim.stop();for(const x in w)delete f.tweens[p][x];delete f.attrs[p][v],Object.keys(f.tweens[p]).length===0&&delete f.tweens[p],Object.keys(f.attrs[p]).length===0&&delete f.attrs[p]}}t.Tween=f,f.attrs={},f.tweens={},i.Node.prototype.to=function(d){const p=d.onFinish;d.node=this,d.onFinish=function(){this.destroy(),p&&p()},new f(d).play()},t.Easings={BackEaseIn(d,p,v,w){return v*(d/=w)*d*(2.70158*d-1.70158)+p},BackEaseOut(d,p,v,w){return v*((d=d/w-1)*d*(2.70158*d+1.70158)+1)+p},BackEaseInOut(d,p,v,w){let x=1.70158;return(d/=w/2)<1?v/2*(d*d*(((x*=1.525)+1)*d-x))+p:v/2*((d-=2)*d*(((x*=1.525)+1)*d+x)+2)+p},ElasticEaseIn(d,p,v,w,x,m){let u=0;return d===0?p:(d/=w)===1?p+v:(m||(m=w*.3),!x||x<Math.abs(v)?(x=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/x),-(x*Math.pow(2,10*(d-=1))*Math.sin((d*w-u)*(2*Math.PI)/m))+p)},ElasticEaseOut(d,p,v,w,x,m){let u=0;return d===0?p:(d/=w)===1?p+v:(m||(m=w*.3),!x||x<Math.abs(v)?(x=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/x),x*Math.pow(2,-10*d)*Math.sin((d*w-u)*(2*Math.PI)/m)+v+p)},ElasticEaseInOut(d,p,v,w,x,m){let u=0;return d===0?p:(d/=w/2)===2?p+v:(m||(m=w*.44999999999999996),!x||x<Math.abs(v)?(x=v,u=m/4):u=m/(2*Math.PI)*Math.asin(v/x),d<1?-.5*(x*Math.pow(2,10*(d-=1))*Math.sin((d*w-u)*(2*Math.PI)/m))+p:x*Math.pow(2,-10*(d-=1))*Math.sin((d*w-u)*(2*Math.PI)/m)*.5+v+p)},BounceEaseOut(d,p,v,w){return(d/=w)<.36363636363636365?v*(7.5625*d*d)+p:d<.7272727272727273?v*(7.5625*(d-=.5454545454545454)*d+.75)+p:d<.9090909090909091?v*(7.5625*(d-=.8181818181818182)*d+.9375)+p:v*(7.5625*(d-=.9545454545454546)*d+.984375)+p},BounceEaseIn(d,p,v,w){return v-t.Easings.BounceEaseOut(w-d,0,v,w)+p},BounceEaseInOut(d,p,v,w){return d<w/2?t.Easings.BounceEaseIn(d*2,0,v,w)*.5+p:t.Easings.BounceEaseOut(d*2-w,0,v,w)*.5+v*.5+p},EaseIn(d,p,v,w){return v*(d/=w)*d+p},EaseOut(d,p,v,w){return-v*(d/=w)*(d-2)+p},EaseInOut(d,p,v,w){return(d/=w/2)<1?v/2*d*d+p:-v/2*(--d*(d-2)-1)+p},StrongEaseIn(d,p,v,w){return v*(d/=w)*d*d*d*d+p},StrongEaseOut(d,p,v,w){return v*((d=d/w-1)*d*d*d*d+1)+p},StrongEaseInOut(d,p,v,w){return(d/=w/2)<1?v/2*d*d*d*d*d+p:v/2*((d-=2)*d*d*d*d+2)+p},Linear(d,p,v,w){return v*d/w+p}}}(Ns)),Ns}var pl;function rf(){return pl||(pl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=vt(),n=zt(),i=Gt(),r=_r(),s=tf(),o=hl(),a=ef(),l=Rs(),c=Ps(),h=Vt(),g=As(),f=nf(),d=Qa(),p=mr();t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:r.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:c.DD,Shape:h.Shape,shapes:h.shapes,Animation:g.Animation,Tween:f.Tween,Easings:f.Easings,Context:d.Context,Canvas:p.Canvas}),t.default=t.Konva}(Ss)),Ss}var Jn={},ml;function sf(){if(ml)return Jn;ml=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.Arc=void 0;const t=yt(),e=Vt(),n=vt(),i=bt(),r=vt();let s=class extends e.Shape{_sceneFunc(a){const l=n.Konva.getAngle(this.angle()),c=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,c),a.arc(0,0,this.innerRadius(),l,0,!c),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),c=this.clockwise(),h=n.Konva.getAngle(c?360-this.angle():this.angle()),g=Math.cos(Math.min(h,Math.PI)),f=1,d=Math.sin(Math.min(Math.max(Math.PI,h),3*Math.PI/2)),p=Math.sin(Math.min(h,Math.PI/2)),v=g*(g>0?a:l),w=f*l,x=d*(d>0?a:l),m=p*(p>0?l:a);return{x:v,y:c?-1*m:x,width:w-v,height:m-x}}};return Jn.Arc=s,s.prototype._centroid=!0,s.prototype.className="Arc",s.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"innerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"clockwise",!1,(0,i.getBooleanValidator)()),Jn}var ti={},ei={},_l;function vl(){if(_l)return ei;_l=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.Line=void 0;const t=yt(),e=vt(),n=Vt(),i=bt();function r(a,l,c,h,g,f,d){const p=Math.sqrt(Math.pow(c-a,2)+Math.pow(h-l,2)),v=Math.sqrt(Math.pow(g-c,2)+Math.pow(f-h,2)),w=d*p/(p+v),x=d*v/(p+v),m=c-w*(g-a),u=h-w*(f-l),_=c+x*(g-a),S=h+x*(f-l);return[m,u,_,S]}function s(a,l){const c=a.length,h=[];for(let g=2;g<c-2;g+=2){const f=r(a[g-2],a[g-1],a[g],a[g+1],a[g+2],a[g+3],l);isNaN(f[0])||(h.push(f[0]),h.push(f[1]),h.push(a[g]),h.push(a[g+1]),h.push(f[2]),h.push(f[3]))}return h}let o=class extends n.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const c=this.points(),h=c.length,g=this.tension(),f=this.closed(),d=this.bezier();if(!h)return;let p=0;if(l.beginPath(),l.moveTo(c[0],c[1]),g!==0&&h>4){const v=this.getTensionPoints(),w=v.length;for(p=f?0:4,f||l.quadraticCurveTo(v[0],v[1],v[2],v[3]);p<w-2;)l.bezierCurveTo(v[p++],v[p++],v[p++],v[p++],v[p++],v[p++]);f||l.quadraticCurveTo(v[w-2],v[w-1],c[h-2],c[h-1])}else if(d)for(p=2;p<h;)l.bezierCurveTo(c[p++],c[p++],c[p++],c[p++],c[p++],c[p++]);else for(p=2;p<h;p+=2)l.lineTo(c[p],c[p+1]);f?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():s(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),c=l.length,h=this.tension(),g=r(l[c-2],l[c-1],l[0],l[1],l[2],l[3],h),f=r(l[c-4],l[c-3],l[c-2],l[c-1],l[0],l[1],h),d=s(l,h);return[g[2],g[3]].concat(d).concat([f[0],f[1],l[c-2],l[c-1],f[2],f[3],g[0],g[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let c=l[0],h=l[0],g=l[1],f=l[1],d,p;for(let v=0;v<l.length/2;v++)d=l[v*2],p=l[v*2+1],c=Math.min(c,d),h=Math.max(h,d),g=Math.min(g,p),f=Math.max(f,p);return{x:c,y:g,width:h-c,height:f-g}}};return ei.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),t.Factory.addGetterSetter(o,"closed",!1),t.Factory.addGetterSetter(o,"bezier",!1),t.Factory.addGetterSetter(o,"tension",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,"points",[],(0,i.getNumberArrayValidator)()),ei}var ni={},Ms={},yl;function of(){return yl||(yl=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,l)=>{let c,h;const f=l/2;c=0;for(let d=0;d<20;d++)h=f*t.tValues[20][d]+f,c+=t.cValues[20][d]*i(o,a,h);return f*c};t.getCubicArcLength=e;const n=(o,a,l)=>{l===void 0&&(l=1);const c=o[0]-2*o[1]+o[2],h=a[0]-2*a[1]+a[2],g=2*o[1]-2*o[0],f=2*a[1]-2*a[0],d=4*(c*c+h*h),p=4*(c*g+h*f),v=g*g+f*f;if(d===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const w=p/(2*d),x=v/d,m=l+w,u=x-w*w,_=m*m+u>0?Math.sqrt(m*m+u):0,S=w*w+u>0?Math.sqrt(w*w+u):0,k=w+Math.sqrt(w*w+u)!==0?u*Math.log(Math.abs((m+_)/(w+S))):0;return Math.sqrt(d)/2*(m*_-w*S+k)};t.getQuadraticArcLength=n;function i(o,a,l){const c=r(1,l,o),h=r(1,l,a),g=c*c+h*h;return Math.sqrt(g)}const r=(o,a,l)=>{const c=l.length-1;let h,g;if(c===0)return 0;if(o===0){g=0;for(let f=0;f<=c;f++)g+=t.binomialCoefficients[c][f]*Math.pow(1-a,c-f)*Math.pow(a,f)*l[f];return g}else{h=new Array(c);for(let f=0;f<c;f++)h[f]=c*(l[f+1]-l[f]);return r(o-1,a,h)}},s=(o,a,l)=>{let c=1,h=o/a,g=(o-l(h))/a,f=0;for(;c>.001;){const d=l(h+g),p=Math.abs(o-d)/a;if(p<c)c=p,h+=g;else{const v=l(h-g),w=Math.abs(o-v)/a;w<c?(c=w,h-=g):g/=2}if(f++,f>500)break}return h};t.t2length=s}(Ms)),Ms}var bl;function Is(){if(bl)return ni;bl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.Path=void 0;const t=yt(),e=vt(),n=Vt(),i=of();let r=class ee extends n.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=ee.parsePathData(this.data()),this.pathLength=ee.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let l=!1;for(let c=0;c<a.length;c++){const h=a[c].command,g=a[c].points;switch(h){case"L":o.lineTo(g[0],g[1]);break;case"M":o.moveTo(g[0],g[1]);break;case"C":o.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case"Q":o.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case"A":const f=g[0],d=g[1],p=g[2],v=g[3],w=g[4],x=g[5],m=g[6],u=g[7],_=p>v?p:v,S=p>v?1:p/v,k=p>v?v/p:1;o.translate(f,d),o.rotate(m),o.scale(S,k),o.arc(0,0,_,w,w+x,1-u),o.scale(1/S,1/k),o.rotate(-m),o.translate(-f,-d);break;case"z":l=!0,o.closePath();break}}!l&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(d){if(d.command==="A"){const p=d.points[4],v=d.points[5],w=d.points[4]+v;let x=Math.PI/180;if(Math.abs(p-w)<x&&(x=Math.abs(p-w)),v<0)for(let m=p-x;m>w;m-=x){const u=ee.getPointOnEllipticalArc(d.points[0],d.points[1],d.points[2],d.points[3],m,0);o.push(u.x,u.y)}else for(let m=p+x;m<w;m+=x){const u=ee.getPointOnEllipticalArc(d.points[0],d.points[1],d.points[2],d.points[3],m,0);o.push(u.x,u.y)}}else if(d.command==="C")for(let p=0;p<=1;p+=.01){const v=ee.getPointOnCubicBezier(p,d.start.x,d.start.y,d.points[0],d.points[1],d.points[2],d.points[3],d.points[4],d.points[5]);o.push(v.x,v.y)}else o=o.concat(d.points)});let a=o[0],l=o[0],c=o[1],h=o[1],g,f;for(let d=0;d<o.length/2;d++)g=o[d*2],f=o[d*2+1],isNaN(g)||(a=Math.min(a,g),l=Math.max(l,g)),isNaN(f)||(c=Math.min(c,f),h=Math.max(h,f));return{x:a,y:c,width:l-a,height:h-c}}getLength(){return this.pathLength}getPointAtLength(o){return ee.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,l,c){return Math.sqrt((l-o)*(l-o)+(c-a)*(c-a))}static getPathLength(o){let a=0;for(let l=0;l<o.length;++l)a+=o[l].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let l,c=0,h=a.length;if(!h)return null;for(;c<h&&o>a[c].pathLength;)o-=a[c].pathLength,++c;if(c===h)return l=a[c-1].points.slice(-2),{x:l[0],y:l[1]};if(o<.01)return a[c].command==="M"?(l=a[c].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[c].start.x,y:a[c].start.y};const g=a[c],f=g.points;switch(g.command){case"L":return ee.getPointOnLine(o,g.start.x,g.start.y,f[0],f[1]);case"C":return ee.getPointOnCubicBezier((0,i.t2length)(o,ee.getPathLength(a),_=>(0,i.getCubicArcLength)([g.start.x,f[0],f[2],f[4]],[g.start.y,f[1],f[3],f[5]],_)),g.start.x,g.start.y,f[0],f[1],f[2],f[3],f[4],f[5]);case"Q":return ee.getPointOnQuadraticBezier((0,i.t2length)(o,ee.getPathLength(a),_=>(0,i.getQuadraticArcLength)([g.start.x,f[0],f[2]],[g.start.y,f[1],f[3]],_)),g.start.x,g.start.y,f[0],f[1],f[2],f[3]);case"A":const d=f[0],p=f[1],v=f[2],w=f[3],x=f[5],m=f[6];let u=f[4];return u+=x*o/g.pathLength,ee.getPointOnEllipticalArc(d,p,v,w,u,m)}return null}static getPointOnLine(o,a,l,c,h,g,f){g=g??a,f=f??l;const d=this.getLineLength(a,l,c,h);if(d<1e-10)return{x:a,y:l};if(c===a)return{x:g,y:f+(h>l?o:-o)};const p=(h-l)/(c-a),v=Math.sqrt(o*o/(1+p*p))*(c<a?-1:1),w=p*v;if(Math.abs(f-l-p*(g-a))<1e-10)return{x:g+v,y:f+w};const x=((g-a)*(c-a)+(f-l)*(h-l))/(d*d),m=a+x*(c-a),u=l+x*(h-l),_=this.getLineLength(g,f,m,u),S=Math.sqrt(o*o-_*_),k=Math.sqrt(S*S/(1+p*p))*(c<a?-1:1),O=p*k;return{x:m+k,y:u+O}}static getPointOnCubicBezier(o,a,l,c,h,g,f,d,p){function v(S){return S*S*S}function w(S){return 3*S*S*(1-S)}function x(S){return 3*S*(1-S)*(1-S)}function m(S){return(1-S)*(1-S)*(1-S)}const u=d*v(o)+g*w(o)+c*x(o)+a*m(o),_=p*v(o)+f*w(o)+h*x(o)+l*m(o);return{x:u,y:_}}static getPointOnQuadraticBezier(o,a,l,c,h,g,f){function d(m){return m*m}function p(m){return 2*m*(1-m)}function v(m){return(1-m)*(1-m)}const w=g*d(o)+c*p(o)+a*v(o),x=f*d(o)+h*p(o)+l*v(o);return{x:w,y:x}}static getPointOnEllipticalArc(o,a,l,c,h,g){const f=Math.cos(g),d=Math.sin(g),p={x:l*Math.cos(h),y:c*Math.sin(h)};return{x:o+(p.x*f-p.y*d),y:a+(p.x*d+p.y*f)}}static parsePathData(o){if(!o)return[];let a=o;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let w=0;w<l.length;w++)a=a.replace(new RegExp(l[w],"g"),"|"+l[w]);const c=a.split("|"),h=[],g=[];let f=0,d=0;const p=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let v;for(let w=1;w<c.length;w++){let x=c[w],m=x.charAt(0);for(x=x.slice(1),g.length=0;v=p.exec(x);)g.push(v[0]);const u=[];for(let _=0,S=g.length;_<S;_++){if(g[_]==="00"){u.push(0,0);continue}const k=parseFloat(g[_]);isNaN(k)?u.push(0):u.push(k)}for(;u.length>0&&!isNaN(u[0]);){let _="",S=[];const k=f,O=d;let b,C,T,A,D,L,U,z,K,y;switch(m){case"l":f+=u.shift(),d+=u.shift(),_="L",S.push(f,d);break;case"L":f=u.shift(),d=u.shift(),S.push(f,d);break;case"m":const P=u.shift(),M=u.shift();if(f+=P,d+=M,_="M",h.length>2&&h[h.length-1].command==="z"){for(let R=h.length-2;R>=0;R--)if(h[R].command==="M"){f=h[R].points[0]+P,d=h[R].points[1]+M;break}}S.push(f,d),m="l";break;case"M":f=u.shift(),d=u.shift(),_="M",S.push(f,d),m="L";break;case"h":f+=u.shift(),_="L",S.push(f,d);break;case"H":f=u.shift(),_="L",S.push(f,d);break;case"v":d+=u.shift(),_="L",S.push(f,d);break;case"V":d=u.shift(),_="L",S.push(f,d);break;case"C":S.push(u.shift(),u.shift(),u.shift(),u.shift()),f=u.shift(),d=u.shift(),S.push(f,d);break;case"c":S.push(f+u.shift(),d+u.shift(),f+u.shift(),d+u.shift()),f+=u.shift(),d+=u.shift(),_="C",S.push(f,d);break;case"S":C=f,T=d,b=h[h.length-1],b.command==="C"&&(C=f+(f-b.points[2]),T=d+(d-b.points[3])),S.push(C,T,u.shift(),u.shift()),f=u.shift(),d=u.shift(),_="C",S.push(f,d);break;case"s":C=f,T=d,b=h[h.length-1],b.command==="C"&&(C=f+(f-b.points[2]),T=d+(d-b.points[3])),S.push(C,T,f+u.shift(),d+u.shift()),f+=u.shift(),d+=u.shift(),_="C",S.push(f,d);break;case"Q":S.push(u.shift(),u.shift()),f=u.shift(),d=u.shift(),S.push(f,d);break;case"q":S.push(f+u.shift(),d+u.shift()),f+=u.shift(),d+=u.shift(),_="Q",S.push(f,d);break;case"T":C=f,T=d,b=h[h.length-1],b.command==="Q"&&(C=f+(f-b.points[0]),T=d+(d-b.points[1])),f=u.shift(),d=u.shift(),_="Q",S.push(C,T,f,d);break;case"t":C=f,T=d,b=h[h.length-1],b.command==="Q"&&(C=f+(f-b.points[0]),T=d+(d-b.points[1])),f+=u.shift(),d+=u.shift(),_="Q",S.push(C,T,f,d);break;case"A":A=u.shift(),D=u.shift(),L=u.shift(),U=u.shift(),z=u.shift(),K=f,y=d,f=u.shift(),d=u.shift(),_="A",S=this.convertEndpointToCenterParameterization(K,y,f,d,U,z,A,D,L);break;case"a":A=u.shift(),D=u.shift(),L=u.shift(),U=u.shift(),z=u.shift(),K=f,y=d,f+=u.shift(),d+=u.shift(),_="A",S=this.convertEndpointToCenterParameterization(K,y,f,d,U,z,A,D,L);break}h.push({command:_||m,points:S,start:{x:k,y:O},pathLength:this.calcLength(k,O,_||m,S)})}(m==="z"||m==="Z")&&h.push({command:"z",points:[],start:void 0,pathLength:0})}return h}static calcLength(o,a,l,c){let h,g,f,d;const p=ee;switch(l){case"L":return p.getLineLength(o,a,c[0],c[1]);case"C":return(0,i.getCubicArcLength)([o,c[0],c[2],c[4]],[a,c[1],c[3],c[5]],1);case"Q":return(0,i.getQuadraticArcLength)([o,c[0],c[2]],[a,c[1],c[3]],1);case"A":h=0;const v=c[4],w=c[5],x=c[4]+w;let m=Math.PI/180;if(Math.abs(v-x)<m&&(m=Math.abs(v-x)),g=p.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],v,0),w<0)for(d=v-m;d>x;d-=m)f=p.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],d,0),h+=p.getLineLength(g.x,g.y,f.x,f.y),g=f;else for(d=v+m;d<x;d+=m)f=p.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],d,0),h+=p.getLineLength(g.x,g.y,f.x,f.y),g=f;return f=p.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],x,0),h+=p.getLineLength(g.x,g.y,f.x,f.y),h}return 0}static convertEndpointToCenterParameterization(o,a,l,c,h,g,f,d,p){const v=p*(Math.PI/180),w=Math.cos(v)*(o-l)/2+Math.sin(v)*(a-c)/2,x=-1*Math.sin(v)*(o-l)/2+Math.cos(v)*(a-c)/2,m=w*w/(f*f)+x*x/(d*d);m>1&&(f*=Math.sqrt(m),d*=Math.sqrt(m));let u=Math.sqrt((f*f*(d*d)-f*f*(x*x)-d*d*(w*w))/(f*f*(x*x)+d*d*(w*w)));h===g&&(u*=-1),isNaN(u)&&(u=0);const _=u*f*x/d,S=u*-d*w/f,k=(o+l)/2+Math.cos(v)*_-Math.sin(v)*S,O=(a+c)/2+Math.sin(v)*_+Math.cos(v)*S,b=function(z){return Math.sqrt(z[0]*z[0]+z[1]*z[1])},C=function(z,K){return(z[0]*K[0]+z[1]*K[1])/(b(z)*b(K))},T=function(z,K){return(z[0]*K[1]<z[1]*K[0]?-1:1)*Math.acos(C(z,K))},A=T([1,0],[(w-_)/f,(x-S)/d]),D=[(w-_)/f,(x-S)/d],L=[(-1*w-_)/f,(-1*x-S)/d];let U=T(D,L);return C(D,L)<=-1&&(U=Math.PI),C(D,L)>=1&&(U=0),g===0&&U>0&&(U=U-2*Math.PI),g===1&&U<0&&(U=U+2*Math.PI),[k,O,f,d,A,U,v,g]}};return ni.Path=r,r.prototype.className="Path",r.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(r),t.Factory.addGetterSetter(r,"data"),ni}var Sl;function af(){if(Sl)return ti;Sl=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.Arrow=void 0;const t=yt(),e=vl(),n=bt(),i=vt(),r=Is();let s=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,c=this.points();let h=c;const g=this.tension()!==0&&c.length>4;g&&(h=this.getTensionPoints());const f=this.pointerLength(),d=c.length;let p,v;if(g){const m=[h[h.length-4],h[h.length-3],h[h.length-2],h[h.length-1],c[d-2],c[d-1]],u=r.Path.calcLength(h[h.length-4],h[h.length-3],"C",m),_=r.Path.getPointOnQuadraticBezier(Math.min(1,1-f/u),m[0],m[1],m[2],m[3],m[4],m[5]);p=c[d-2]-_.x,v=c[d-1]-_.y}else p=c[d-2]-c[d-4],v=c[d-1]-c[d-3];const w=(Math.atan2(v,p)+l)%l,x=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(c[d-2],c[d-1]),a.rotate(w),a.moveTo(0,0),a.lineTo(-f,x/2),a.lineTo(-f,-x/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(c[0],c[1]),g?(p=(h[0]+h[2])/2-c[0],v=(h[1]+h[3])/2-c[1]):(p=c[2]-c[0],v=c[3]-c[1]),a.rotate((Math.atan2(-v,-p)+l)%l),a.moveTo(0,0),a.lineTo(-f,x/2),a.lineTo(-f,-x/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return ti.Arrow=s,s.prototype.className="Arrow",(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"pointerLength",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"pointerWidth",10,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"pointerAtBeginning",!1),t.Factory.addGetterSetter(s,"pointerAtEnding",!0),ti}var ii={},wl;function lf(){if(wl)return ii;wl=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.Circle=void 0;const t=yt(),e=Vt(),n=bt(),i=vt();let r=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}};return ii.Circle=r,r.prototype._centroid=!0,r.prototype.className="Circle",r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,n.getNumberValidator)()),ii}var ri={},xl;function cf(){if(xl)return ri;xl=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.Ellipse=void 0;const t=yt(),e=Vt(),n=bt(),i=vt();let r=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),l=this.radiusY();o.beginPath(),o.save(),a!==l&&o.scale(1,l/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return ri.Ellipse=r,r.prototype.className="Ellipse",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(r),t.Factory.addComponentsGetterSetter(r,"radius",["x","y"]),t.Factory.addGetterSetter(r,"radiusX",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"radiusY",0,(0,n.getNumberValidator)()),ri}var si={},Cl;function hf(){if(Cl)return si;Cl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.Image=void 0;const t=zt(),e=yt(),n=Vt(),i=vt(),r=bt();let s=class vh extends n.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),c=this.getHeight(),h=this.cornerRadius(),g=this.attrs.image;let f;if(g){const d=this.attrs.cropWidth,p=this.attrs.cropHeight;d&&p?f=[g,this.cropX(),this.cropY(),d,p,0,0,l,c]:f=[g,0,0,l,c]}(this.hasFill()||this.hasStroke()||h)&&(a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)),g&&(h&&a.clip(),a.drawImage.apply(a,f))}_hitFunc(a){const l=this.width(),c=this.height(),h=this.cornerRadius();a.beginPath(),h?t.Util.drawRoundedRectPath(a,l,c,h):a.rect(0,0,l,c),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,c=null){const h=t.Util.createImageElement();h.onload=function(){const g=new vh({image:h});l(g)},h.onerror=c,h.crossOrigin="Anonymous",h.src=a}};return si.Image=s,s.prototype.className="Image",(0,i._registerNode)(s),e.Factory.addGetterSetter(s,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(s,"image"),e.Factory.addComponentsGetterSetter(s,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(s,"cropX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropY",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropWidth",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropHeight",0,(0,r.getNumberValidator)()),si}var nn={},Pl;function uf(){if(Pl)return nn;Pl=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.Tag=nn.Label=void 0;const t=yt(),e=Vt(),n=Rs(),i=bt(),r=vt(),s=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",l="up",c="right",h="down",g="left",f=s.length;let d=class extends n.Group{constructor(w){super(w),this.on("add.konva",function(x){this._addListeners(x.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(w){let x=this,m;const u=function(){x._sync()};for(m=0;m<f;m++)w.on(s[m]+o,u)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let w=this.getText(),x=this.getTag(),m,u,_,S,k,O,b;if(w&&x){switch(m=w.width(),u=w.height(),_=x.pointerDirection(),S=x.pointerWidth(),b=x.pointerHeight(),k=0,O=0,_){case l:k=m/2,O=-1*b;break;case c:k=m+S,O=u/2;break;case h:k=m/2,O=u+b;break;case g:k=-1*S,O=u/2;break}x.setAttrs({x:-1*k,y:-1*O,width:m,height:u}),w.setAttrs({x:-1*k,y:-1*O})}}};nn.Label=d,d.prototype.className="Label",(0,r._registerNode)(d);class p extends e.Shape{_sceneFunc(w){const x=this.width(),m=this.height(),u=this.pointerDirection(),_=this.pointerWidth(),S=this.pointerHeight(),k=this.cornerRadius();let O=0,b=0,C=0,T=0;typeof k=="number"?O=b=C=T=Math.min(k,x/2,m/2):(O=Math.min(k[0]||0,x/2,m/2),b=Math.min(k[1]||0,x/2,m/2),T=Math.min(k[2]||0,x/2,m/2),C=Math.min(k[3]||0,x/2,m/2)),w.beginPath(),w.moveTo(O,0),u===l&&(w.lineTo((x-_)/2,0),w.lineTo(x/2,-1*S),w.lineTo((x+_)/2,0)),w.lineTo(x-b,0),w.arc(x-b,b,b,Math.PI*3/2,0,!1),u===c&&(w.lineTo(x,(m-S)/2),w.lineTo(x+_,m/2),w.lineTo(x,(m+S)/2)),w.lineTo(x,m-T),w.arc(x-T,m-T,T,0,Math.PI/2,!1),u===h&&(w.lineTo((x+_)/2,m),w.lineTo(x/2,m+S),w.lineTo((x-_)/2,m)),w.lineTo(C,m),w.arc(C,m-C,C,Math.PI/2,Math.PI,!1),u===g&&(w.lineTo(0,(m+S)/2),w.lineTo(-1*_,m/2),w.lineTo(0,(m-S)/2)),w.lineTo(0,O),w.arc(O,O,O,Math.PI,Math.PI*3/2,!1),w.closePath(),w.fillStrokeShape(this)}getSelfRect(){let w=0,x=0,m=this.pointerWidth(),u=this.pointerHeight(),_=this.pointerDirection(),S=this.width(),k=this.height();return _===l?(x-=u,k+=u):_===h?k+=u:_===g?(w-=m*1.5,S+=m):_===c&&(S+=m*1.5),{x:w,y:x,width:S,height:k}}}return nn.Tag=p,p.prototype.className="Tag",(0,r._registerNode)(p),t.Factory.addGetterSetter(p,"pointerDirection",a),t.Factory.addGetterSetter(p,"pointerWidth",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(p,"pointerHeight",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(p,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),nn}var oi={},Tl;function kl(){if(Tl)return oi;Tl=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.Rect=void 0;const t=yt(),e=Vt(),n=vt(),i=zt(),r=bt();let s=class extends e.Shape{_sceneFunc(a){const l=this.cornerRadius(),c=this.width(),h=this.height();a.beginPath(),l?i.Util.drawRoundedRectPath(a,c,h,l):a.rect(0,0,c,h),a.closePath(),a.fillStrokeShape(this)}};return oi.Rect=s,s.prototype.className="Rect",(0,n._registerNode)(s),t.Factory.addGetterSetter(s,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),oi}var ai={},El;function df(){if(El)return ai;El=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.RegularPolygon=void 0;const t=yt(),e=Vt(),n=bt(),i=vt();let r=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)o.lineTo(a[l].x,a[l].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let c=0;c<o;c++)l.push({x:a*Math.sin(c*2*Math.PI/o),y:-1*a*Math.cos(c*2*Math.PI/o)});return l}getSelfRect(){const o=this._getPoints();let a=o[0].x,l=o[0].y,c=o[0].x,h=o[0].y;return o.forEach(g=>{a=Math.min(a,g.x),l=Math.max(l,g.x),c=Math.min(c,g.y),h=Math.max(h,g.y)}),{x:a,y:c,width:l-a,height:h-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return ai.RegularPolygon=r,r.prototype.className="RegularPolygon",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"sides",0,(0,n.getNumberValidator)()),ai}var li={},Rl;function ff(){if(Rl)return li;Rl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.Ring=void 0;const t=yt(),e=Vt(),n=bt(),i=vt(),r=Math.PI*2;let s=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,r,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),r,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return li.Ring=s,s.prototype.className="Ring",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),t.Factory.addGetterSetter(s,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"outerRadius",0,(0,n.getNumberValidator)()),li}var ci={},Al;function gf(){if(Al)return ci;Al=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.Sprite=void 0;const t=yt(),e=Vt(),n=As(),i=bt(),r=vt();let s=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new n.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,g=this.animations()[l],f=this.frameOffsets(),d=g[h+0],p=g[h+1],v=g[h+2],w=g[h+3],x=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,v,w),a.closePath(),a.fillStrokeShape(this)),x)if(f){const m=f[l],u=c*2;a.drawImage(x,d,p,v,w,m[u+0],m[u+1],v,w)}else a.drawImage(x,d,p,v,w,0,0,v,w)}_hitFunc(a){const l=this.animation(),c=this.frameIndex(),h=c*4,g=this.animations()[l],f=this.frameOffsets(),d=g[h+2],p=g[h+3];if(a.beginPath(),f){const v=f[l],w=c*2;a.rect(v[w+0],v[w+1],d,p)}else a.rect(0,0,d,p);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),c=this.animations(),h=c[l],g=h.length/4;a<g-1?this.frameIndex(a+1):this.frameIndex(0)}};return ci.Sprite=s,s.prototype.className="Sprite",(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"animation"),t.Factory.addGetterSetter(s,"animations"),t.Factory.addGetterSetter(s,"frameOffsets"),t.Factory.addGetterSetter(s,"image"),t.Factory.addGetterSetter(s,"frameIndex",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"frameRate",17,(0,i.getNumberValidator)()),t.Factory.backCompat(s,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),ci}var hi={},Nl;function pf(){if(Nl)return hi;Nl=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Star=void 0;const t=yt(),e=Vt(),n=bt(),i=vt();let r=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),l=this.outerRadius(),c=this.numPoints();o.beginPath(),o.moveTo(0,0-l);for(let h=1;h<c*2;h++){const g=h%2===0?l:a,f=g*Math.sin(h*Math.PI/c),d=-1*g*Math.cos(h*Math.PI/c);o.lineTo(f,d)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return hi.Star=r,r.prototype.className="Star",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(r),t.Factory.addGetterSetter(r,"numPoints",5,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(r,"outerRadius",0,(0,n.getNumberValidator)()),hi}var _n={},Ml;function Il(){if(Ml)return _n;Ml=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.Text=void 0,_n.stringToArray=o;const t=zt(),e=yt(),n=Vt(),i=vt(),r=bt(),s=vt();function o(H){return[...H].reduce((G,Y,it,V)=>{if(/\p{Emoji}/u.test(Y)){const N=V[it+1];N&&/\p{Emoji_Modifier}|\u200D/u.test(N)?(G.push(Y+N),V[it+1]=""):G.push(Y)}else/\p{Regional_Indicator}{2}/u.test(Y+(V[it+1]||""))?G.push(Y+V[it+1]):it>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(Y)?G[G.length-1]+=Y:Y&&G.push(Y);return G},[])}const a="auto",l="center",c="inherit",h="justify",g="Change.konva",f="2d",d="-",p="left",v="text",w="Text",x="top",m="bottom",u="middle",_="normal",S="px ",k=" ",O="right",b="rtl",C="word",T="char",A="none",D="",L=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],U=L.length;function z(H){return H.split(",").map(G=>{G=G.trim();const Y=G.indexOf(" ")>=0,it=G.indexOf('"')>=0||G.indexOf("'")>=0;return Y&&!it&&(G=`"${G}"`),G}).join(", ")}let K;function y(){return K||(K=t.Util.createCanvasElement().getContext(f),K)}function P(H){H.fillText(this._partialText,this._partialTextX,this._partialTextY)}function M(H){H.setAttr("miterLimit",2),H.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function R(H){return H=H||{},!H.fillLinearGradientColorStops&&!H.fillRadialGradientColorStops&&!H.fillPatternImage&&(H.fill=H.fill||"black"),H}let F=class extends n.Shape{constructor(G){super(R(G)),this._partialTextX=0,this._partialTextY=0;for(let Y=0;Y<U;Y++)this.on(L[Y]+g,this._setTextData);this._setTextData()}_sceneFunc(G){const Y=this.textArr,it=Y.length;if(!this.text())return;let V=this.padding(),N=this.fontSize(),$=this.lineHeight()*N,tt=this.verticalAlign(),st=this.direction(),ct=0,E=this.align(),I=this.getWidth(),B=this.letterSpacing(),W=this.fill(),q=this.textDecoration(),j=q.indexOf("underline")!==-1,Q=q.indexOf("line-through")!==-1,et;st=st===c?G.direction:st;let J=$/2,X=u;if(i.Konva._fixTextRendering){const at=this.measureSize("M");X="alphabetic",J=(at.fontBoundingBoxAscent-at.fontBoundingBoxDescent)/2+$/2}for(st===b&&G.setAttr("direction",st),G.setAttr("font",this._getContextFont()),G.setAttr("textBaseline",X),G.setAttr("textAlign",p),tt===u?ct=(this.getHeight()-it*$-V*2)/2:tt===m&&(ct=this.getHeight()-it*$-V*2),G.translate(V,ct+V),et=0;et<it;et++){let at=0,nt=0;const lt=Y[et],ut=lt.text,dt=lt.width,_t=lt.lastInParagraph;if(G.save(),E===O?at+=I-dt-V*2:E===l&&(at+=(I-dt-V*2)/2),j){G.save(),G.beginPath();const pt=i.Konva._fixTextRendering?Math.round(N/4):Math.round(N/2),At=at,xt=J+nt+pt;G.moveTo(At,xt);const Pt=E===h&&!_t?I-V*2:dt;G.lineTo(At+Math.round(Pt),xt),G.lineWidth=N/15;const Bt=this._getLinearGradient();G.strokeStyle=Bt||W,G.stroke(),G.restore()}if(Q){G.save(),G.beginPath();const pt=i.Konva._fixTextRendering?-Math.round(N/4):0;G.moveTo(at,J+nt+pt);const At=E===h&&!_t?I-V*2:dt;G.lineTo(at+Math.round(At),J+nt+pt),G.lineWidth=N/15;const xt=this._getLinearGradient();G.strokeStyle=xt||W,G.stroke(),G.restore()}if(st!==b&&(B!==0||E===h)){const pt=ut.split(" ").length-1,At=o(ut);for(let xt=0;xt<At.length;xt++){const Pt=At[xt];Pt===" "&&!_t&&E===h&&(at+=(I-V*2-dt)/pt),this._partialTextX=at,this._partialTextY=J+nt,this._partialText=Pt,G.fillStrokeShape(this),at+=this.measureSize(Pt).width+B}}else B!==0&&G.setAttr("letterSpacing",`${B}px`),this._partialTextX=at,this._partialTextY=J+nt,this._partialText=ut,G.fillStrokeShape(this);G.restore(),it>1&&(J+=$)}}_hitFunc(G){const Y=this.getWidth(),it=this.getHeight();G.beginPath(),G.rect(0,0,Y,it),G.closePath(),G.fillStrokeShape(this)}setText(G){const Y=t.Util._isString(G)?G:G==null?"":G+"";return this._setAttr(v,Y),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(G){var Y,it,V,N,$,tt,st,ct,E,I,B;let W=y(),q=this.fontSize(),j;W.save(),W.font=this._getContextFont(),j=W.measureText(G),W.restore();const Q=q/100;return{actualBoundingBoxAscent:(Y=j.actualBoundingBoxAscent)!==null&&Y!==void 0?Y:71.58203125*Q,actualBoundingBoxDescent:(it=j.actualBoundingBoxDescent)!==null&&it!==void 0?it:0,actualBoundingBoxLeft:(V=j.actualBoundingBoxLeft)!==null&&V!==void 0?V:-7.421875*Q,actualBoundingBoxRight:(N=j.actualBoundingBoxRight)!==null&&N!==void 0?N:75.732421875*Q,alphabeticBaseline:($=j.alphabeticBaseline)!==null&&$!==void 0?$:0,emHeightAscent:(tt=j.emHeightAscent)!==null&&tt!==void 0?tt:100*Q,emHeightDescent:(st=j.emHeightDescent)!==null&&st!==void 0?st:-20*Q,fontBoundingBoxAscent:(ct=j.fontBoundingBoxAscent)!==null&&ct!==void 0?ct:91*Q,fontBoundingBoxDescent:(E=j.fontBoundingBoxDescent)!==null&&E!==void 0?E:21*Q,hangingBaseline:(I=j.hangingBaseline)!==null&&I!==void 0?I:72.80000305175781*Q,ideographicBaseline:(B=j.ideographicBaseline)!==null&&B!==void 0?B:-21*Q,width:j.width,height:q}}_getContextFont(){return this.fontStyle()+k+this.fontVariant()+k+(this.fontSize()+S)+z(this.fontFamily())}_addTextLine(G){this.align()===h&&(G=G.trim());const it=this._getTextWidth(G);return this.textArr.push({text:G,width:it,lastInParagraph:!1})}_getTextWidth(G){const Y=this.letterSpacing(),it=G.length;return y().measureText(G).width+Y*it}_setTextData(){let G=this.text().split(`
`),Y=+this.fontSize(),it=0,V=this.lineHeight()*Y,N=this.attrs.width,$=this.attrs.height,tt=N!==a&&N!==void 0,st=$!==a&&$!==void 0,ct=this.padding(),E=N-ct*2,I=$-ct*2,B=0,W=this.wrap(),q=W!==A,j=W!==T&&q,Q=this.ellipsis();this.textArr=[],y().font=this._getContextFont();const et=Q?this._getTextWidth(D):0;for(let J=0,X=G.length;J<X;++J){let at=G[J],nt=this._getTextWidth(at);if(tt&&nt>E)for(;at.length>0;){let lt=0,ut=o(at).length,dt="",_t=0;for(;lt<ut;){const pt=lt+ut>>>1,At=o(at),xt=At.slice(0,pt+1).join(""),Pt=this._getTextWidth(xt);(Q&&st&&B+V>I?Pt+et:Pt)<=E?(lt=pt+1,dt=xt,_t=Pt):ut=pt}if(dt){if(j){const xt=o(at),Pt=o(dt),Bt=xt[Pt.length],fe=Bt===k||Bt===d;let Se;if(fe&&_t<=E)Se=Pt.length;else{const ot=Pt.lastIndexOf(k),rt=Pt.lastIndexOf(d);Se=Math.max(ot,rt)+1}Se>0&&(lt=Se,dt=xt.slice(0,lt).join(""),_t=this._getTextWidth(dt))}if(dt=dt.trimRight(),this._addTextLine(dt),it=Math.max(it,_t),B+=V,this._shouldHandleEllipsis(B)){this._tryToAddEllipsisToLastLine();break}if(at=o(at).slice(lt).join("").trimLeft(),at.length>0&&(nt=this._getTextWidth(at),nt<=E)){this._addTextLine(at),B+=V,it=Math.max(it,nt);break}}else break}else this._addTextLine(at),B+=V,it=Math.max(it,nt),this._shouldHandleEllipsis(B)&&J<X-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),st&&B+V>I)break}this.textHeight=Y,this.textWidth=it}_shouldHandleEllipsis(G){const Y=+this.fontSize(),it=this.lineHeight()*Y,V=this.attrs.height,N=V!==a&&V!==void 0,$=this.padding(),tt=V-$*2;return!(this.wrap()!==A)||N&&G+it>tt}_tryToAddEllipsisToLastLine(){const G=this.attrs.width,Y=G!==a&&G!==void 0,it=this.padding(),V=G-it*2,N=this.ellipsis(),$=this.textArr[this.textArr.length-1];!$||!N||(Y&&(this._getTextWidth($.text+D)<V||($.text=$.text.slice(0,$.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine($.text+D))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const G=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,Y=this.hasShadow();return G&&Y?!0:super._useBufferCanvas()}};return _n.Text=F,F.prototype._fillFunc=P,F.prototype._strokeFunc=M,F.prototype.className=w,F.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,s._registerNode)(F),e.Factory.overWriteSetter(F,"width",(0,r.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(F,"height",(0,r.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(F,"direction",c),e.Factory.addGetterSetter(F,"fontFamily","Arial"),e.Factory.addGetterSetter(F,"fontSize",12,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"fontStyle",_),e.Factory.addGetterSetter(F,"fontVariant",_),e.Factory.addGetterSetter(F,"padding",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"align",p),e.Factory.addGetterSetter(F,"verticalAlign",x),e.Factory.addGetterSetter(F,"lineHeight",1,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"wrap",C),e.Factory.addGetterSetter(F,"ellipsis",!1,(0,r.getBooleanValidator)()),e.Factory.addGetterSetter(F,"letterSpacing",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(F,"text","",(0,r.getStringValidator)()),e.Factory.addGetterSetter(F,"textDecoration",""),_n}var ui={},Ol;function mf(){if(Ol)return ui;Ol=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.TextPath=void 0;const t=zt(),e=yt(),n=Vt(),i=Is(),r=Il(),s=bt(),o=vt(),a="",l="normal";function c(f){f.fillText(this.partialText,0,0)}function h(f){f.strokeText(this.partialText,0,0)}let g=class extends n.Shape{constructor(d){super(d),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(d){if(!this.attrs.data)return null;const p=this.pathLength;return d-1>p?null:i.Path.getPointAtLengthOfDataArray(d,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(d){d.setAttr("font",this._getContextFont()),d.setAttr("textBaseline",this.textBaseline()),d.setAttr("textAlign","left"),d.save();const p=this.textDecoration(),v=this.fill(),w=this.fontSize(),x=this.glyphInfo;p==="underline"&&d.beginPath();for(let m=0;m<x.length;m++){d.save();const u=x[m].p0;d.translate(u.x,u.y),d.rotate(x[m].rotation),this.partialText=x[m].text,d.fillStrokeShape(this),p==="underline"&&(m===0&&d.moveTo(0,w/2+1),d.lineTo(w,w/2+1)),d.restore()}p==="underline"&&(d.strokeStyle=v,d.lineWidth=w/20,d.stroke()),d.restore()}_hitFunc(d){d.beginPath();const p=this.glyphInfo;if(p.length>=1){const v=p[0].p0;d.moveTo(v.x,v.y)}for(let v=0;v<p.length;v++){const w=p[v].p1;d.lineTo(w.x,w.y)}d.setAttr("lineWidth",this.fontSize()),d.setAttr("strokeStyle",this.colorKey),d.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(d){return r.Text.prototype.setText.call(this,d)}_getContextFont(){return r.Text.prototype._getContextFont.call(this)}_getTextSize(d){const v=this.dummyCanvas.getContext("2d");v.save(),v.font=this._getContextFont();const w=v.measureText(d);return v.restore(),{width:w.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:d,height:p}=this._getTextSize(this.attrs.text);if(this.textWidth=d,this.textHeight=p,this.glyphInfo=[],!this.attrs.data)return null;const v=this.letterSpacing(),w=this.align(),x=this.kerningFunc(),m=Math.max(this.textWidth+((this.attrs.text||"").length-1)*v,0);let u=0;w==="center"&&(u=Math.max(0,this.pathLength/2-m/2)),w==="right"&&(u=Math.max(0,this.pathLength-m));const _=(0,r.stringToArray)(this.text());let S=u;for(let k=0;k<_.length;k++){const O=this._getPointAtLength(S);if(!O)return;let b=this._getTextSize(_[k]).width+v;if(_[k]===" "&&w==="justify"){const U=this.text().split(" ").length-1;b+=(this.pathLength-m)/U}const C=this._getPointAtLength(S+b);if(!C)return;const T=i.Path.getLineLength(O.x,O.y,C.x,C.y);let A=0;if(x)try{A=x(_[k-1],_[k])*this.fontSize()}catch{A=0}O.x+=A,C.x+=A,this.textWidth+=A;const D=i.Path.getPointOnLine(A+T/2,O.x,O.y,C.x,C.y),L=Math.atan2(C.y-O.y,C.x-O.x);this.glyphInfo.push({transposeX:D.x,transposeY:D.y,text:_[k],rotation:L,p0:O,p1:C}),S+=b}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const d=[];this.glyphInfo.forEach(function(S){d.push(S.p0.x),d.push(S.p0.y),d.push(S.p1.x),d.push(S.p1.y)});let p=d[0]||0,v=d[0]||0,w=d[1]||0,x=d[1]||0,m,u;for(let S=0;S<d.length/2;S++)m=d[S*2],u=d[S*2+1],p=Math.min(p,m),v=Math.max(v,m),w=Math.min(w,u),x=Math.max(x,u);const _=this.fontSize();return{x:p-_/2,y:w-_/2,width:v-p+_,height:x-w+_}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return ui.TextPath=g,g.prototype._fillFunc=c,g.prototype._strokeFunc=h,g.prototype._fillFuncHit=c,g.prototype._strokeFuncHit=h,g.prototype.className="TextPath",g.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(g),e.Factory.addGetterSetter(g,"data"),e.Factory.addGetterSetter(g,"fontFamily","Arial"),e.Factory.addGetterSetter(g,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(g,"fontStyle",l),e.Factory.addGetterSetter(g,"align","left"),e.Factory.addGetterSetter(g,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(g,"textBaseline","middle"),e.Factory.addGetterSetter(g,"fontVariant",l),e.Factory.addGetterSetter(g,"text",a),e.Factory.addGetterSetter(g,"textDecoration",""),e.Factory.addGetterSetter(g,"kerningFunc",void 0),ui}var di={},Fl;function _f(){if(Fl)return di;Fl=1,Object.defineProperty(di,"__esModule",{value:!0}),di.Transformer=void 0;const t=zt(),e=yt(),n=Gt(),i=Vt(),r=kl(),s=Rs(),o=vt(),a=bt(),l=vt(),c="tr-konva",h=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(b=>b+`.${c}`).join(" "),g="nodesRect",f=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],d={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},p="ontouchstart"in o.Konva._global;function v(b,C,T){if(b==="rotater")return T;C+=t.Util.degToRad(d[b]||0);const A=(t.Util.radToDeg(C)%360+360)%360;return t.Util._inRange(A,337.5,360)||t.Util._inRange(A,0,22.5)?"ns-resize":t.Util._inRange(A,22.5,67.5)?"nesw-resize":t.Util._inRange(A,67.5,112.5)?"ew-resize":t.Util._inRange(A,112.5,157.5)?"nwse-resize":t.Util._inRange(A,157.5,202.5)?"ns-resize":t.Util._inRange(A,202.5,247.5)?"nesw-resize":t.Util._inRange(A,247.5,292.5)?"ew-resize":t.Util._inRange(A,292.5,337.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+A),"pointer")}const w=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function x(b){return{x:b.x+b.width/2*Math.cos(b.rotation)+b.height/2*Math.sin(-b.rotation),y:b.y+b.height/2*Math.cos(b.rotation)+b.width/2*Math.sin(b.rotation)}}function m(b,C,T){const A=T.x+(b.x-T.x)*Math.cos(C)-(b.y-T.y)*Math.sin(C),D=T.y+(b.x-T.x)*Math.sin(C)+(b.y-T.y)*Math.cos(C);return{...b,rotation:b.rotation+C,x:A,y:D}}function u(b,C){const T=x(b);return m(b,C,T)}function _(b,C,T){let A=C;for(let D=0;D<b.length;D++){const L=o.Konva.getAngle(b[D]),U=Math.abs(L-C)%(Math.PI*2);Math.min(U,Math.PI*2-U)<T&&(A=L)}return A}let S=0,k=class extends s.Group{constructor(C){super(C),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(h,this.update),this.getNode()&&this.update()}attachTo(C){return this.setNode(C),this}setNode(C){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([C])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(C=[]){this._nodes&&this._nodes.length&&this.detach();const T=C.filter(D=>D.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=C=T,C.length===1&&this.useSingleNodeRotation()?this.rotation(C[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(D=>{const L=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(D._attrsAffectingSize.length){const U=D._attrsAffectingSize.map(z=>z+"Change."+this._getEventNamespace()).join(" ");D.on(U,L)}D.on(f.map(U=>U+`.${this._getEventNamespace()}`).join(" "),L),D.on(`absoluteTransformChange.${this._getEventNamespace()}`,L),this._proxyDrag(D)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(C){let T;C.on(`dragstart.${this._getEventNamespace()}`,A=>{T=C.getAbsolutePosition(),!this.isDragging()&&C!==this.findOne(".back")&&this.startDrag(A,!1)}),C.on(`dragmove.${this._getEventNamespace()}`,A=>{if(!T)return;const D=C.getAbsolutePosition(),L=D.x-T.x,U=D.y-T.y;this.nodes().forEach(z=>{if(z===C||z.isDragging())return;const K=z.getAbsolutePosition();z.setAbsolutePosition({x:K.x+L,y:K.y+U}),z.startDrag(A)}),T=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(C=>{C.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(g),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(g,this.__getNodeRect)}__getNodeShape(C,T=this.rotation(),A){const D=C.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),L=C.getAbsoluteScale(A),U=C.getAbsolutePosition(A),z=D.x*L.x-C.offsetX()*L.x,K=D.y*L.y-C.offsetY()*L.y,y=(o.Konva.getAngle(C.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),P={x:U.x+z*Math.cos(y)+K*Math.sin(-y),y:U.y+K*Math.cos(y)+z*Math.sin(y),width:D.width*L.x,height:D.height*L.y,rotation:y};return m(P,-o.Konva.getAngle(T),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const T=[];this.nodes().map(y=>{const P=y.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),M=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}],R=y.getAbsoluteTransform();M.forEach(function(F){const H=R.point(F);T.push(H)})});const A=new t.Transform;A.rotate(-o.Konva.getAngle(this.rotation()));let D=1/0,L=1/0,U=-1/0,z=-1/0;T.forEach(function(y){const P=A.point(y);D===void 0&&(D=U=P.x,L=z=P.y),D=Math.min(D,P.x),L=Math.min(L,P.y),U=Math.max(U,P.x),z=Math.max(z,P.y)}),A.invert();const K=A.point({x:D,y:L});return{x:K.x,y:K.y,width:U-D,height:z-L,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),w.forEach(C=>{this._createAnchor(C)}),this._createAnchor("rotater")}_createAnchor(C){const T=new r.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:C+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:p?10:"auto"}),A=this;T.on("mousedown touchstart",function(D){A._handleMouseDown(D)}),T.on("dragstart",D=>{T.stopDrag(),D.cancelBubble=!0}),T.on("dragend",D=>{D.cancelBubble=!0}),T.on("mouseenter",()=>{const D=o.Konva.getAngle(this.rotation()),L=this.rotateAnchorCursor(),U=v(C,D,L);T.getStage().content&&(T.getStage().content.style.cursor=U),this._cursorChange=!0}),T.on("mouseout",()=>{T.getStage().content&&(T.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(T)}_createBack(){const C=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(T,A){const D=A.getParent(),L=D.padding();T.beginPath(),T.rect(-L,-L,A.width()+L*2,A.height()+L*2),T.moveTo(A.width()/2,-L),D.rotateEnabled()&&D.rotateLineVisible()&&T.lineTo(A.width()/2,-D.rotateAnchorOffset()*t.Util._sign(A.height())-L),T.fillStrokeShape(A)},hitFunc:(T,A)=>{if(!this.shouldOverdrawWholeArea())return;const D=this.padding();T.beginPath(),T.rect(-D,-D,A.width()+D*2,A.height()+D*2),T.fillStrokeShape(A)}});this.add(C),this._proxyDrag(C),C.on("dragstart",T=>{T.cancelBubble=!0}),C.on("dragmove",T=>{T.cancelBubble=!0}),C.on("dragend",T=>{T.cancelBubble=!0}),this.on("dragmove",T=>{this.update()})}_handleMouseDown(C){if(this._transforming)return;this._movingAnchorName=C.target.name().split(" ")[0];const T=this._getNodeRect(),A=T.width,D=T.height,L=Math.sqrt(Math.pow(A,2)+Math.pow(D,2));this.sin=Math.abs(D/L),this.cos=Math.abs(A/L),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const U=C.target.getAbsolutePosition(),z=C.target.getStage().getPointerPosition();this._anchorDragOffset={x:z.x-U.x,y:z.y-U.y},S++,this._fire("transformstart",{evt:C.evt,target:this.getNode()}),this._nodes.forEach(K=>{K._fire("transformstart",{evt:C.evt,target:K})})}_handleMouseMove(C){let T,A,D;const L=this.findOne("."+this._movingAnchorName),U=L.getStage();U.setPointersPositions(C);const z=U.getPointerPosition();let K={x:z.x-this._anchorDragOffset.x,y:z.y-this._anchorDragOffset.y};const y=L.getAbsolutePosition();this.anchorDragBoundFunc()&&(K=this.anchorDragBoundFunc()(y,K,C)),L.setAbsolutePosition(K);const P=L.getAbsolutePosition();if(y.x===P.x&&y.y===P.y)return;if(this._movingAnchorName==="rotater"){const V=this._getNodeRect();T=L.x()-V.width/2,A=-L.y()+V.height/2;let N=Math.atan2(-A,T)+Math.PI/2;V.height<0&&(N-=Math.PI);const tt=o.Konva.getAngle(this.rotation())+N,st=o.Konva.getAngle(this.rotationSnapTolerance()),E=_(this.rotationSnaps(),tt,st)-V.rotation,I=u(V,E);this._fitNodesInto(I,C);return}const M=this.shiftBehavior();let R;M==="inverted"?R=this.keepRatio()&&!C.shiftKey:M==="none"?R=this.keepRatio():R=this.keepRatio()||C.shiftKey;let F=this.centeredScaling()||C.altKey;if(this._movingAnchorName==="top-left"){if(R){const V=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};D=Math.sqrt(Math.pow(V.x-L.x(),2)+Math.pow(V.y-L.y(),2));const N=this.findOne(".top-left").x()>V.x?-1:1,$=this.findOne(".top-left").y()>V.y?-1:1;T=D*this.cos*N,A=D*this.sin*$,this.findOne(".top-left").x(V.x-T),this.findOne(".top-left").y(V.y-A)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(L.y());else if(this._movingAnchorName==="top-right"){if(R){const V=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};D=Math.sqrt(Math.pow(L.x()-V.x,2)+Math.pow(V.y-L.y(),2));const N=this.findOne(".top-right").x()<V.x?-1:1,$=this.findOne(".top-right").y()>V.y?-1:1;T=D*this.cos*N,A=D*this.sin*$,this.findOne(".top-right").x(V.x+T),this.findOne(".top-right").y(V.y-A)}var H=L.position();this.findOne(".top-left").y(H.y),this.findOne(".bottom-right").x(H.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(L.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(L.x());else if(this._movingAnchorName==="bottom-left"){if(R){const V=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};D=Math.sqrt(Math.pow(V.x-L.x(),2)+Math.pow(L.y()-V.y,2));const N=V.x<L.x()?-1:1,$=L.y()<V.y?-1:1;T=D*this.cos*N,A=D*this.sin*$,L.x(V.x-T),L.y(V.y+A)}H=L.position(),this.findOne(".top-left").x(H.x),this.findOne(".bottom-right").y(H.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(L.y());else if(this._movingAnchorName==="bottom-right"){if(R){const V=F?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};D=Math.sqrt(Math.pow(L.x()-V.x,2)+Math.pow(L.y()-V.y,2));const N=this.findOne(".bottom-right").x()<V.x?-1:1,$=this.findOne(".bottom-right").y()<V.y?-1:1;T=D*this.cos*N,A=D*this.sin*$,this.findOne(".bottom-right").x(V.x+T),this.findOne(".bottom-right").y(V.y+A)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(F=this.centeredScaling()||C.altKey,F){const V=this.findOne(".top-left"),N=this.findOne(".bottom-right"),$=V.x(),tt=V.y(),st=this.getWidth()-N.x(),ct=this.getHeight()-N.y();N.move({x:-$,y:-tt}),V.move({x:st,y:ct})}const G=this.findOne(".top-left").getAbsolutePosition();T=G.x,A=G.y;const Y=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),it=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:T,y:A,width:Y,height:it,rotation:o.Konva.getAngle(this.rotation())},C)}_handleMouseUp(C){this._removeEvents(C)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(C){var T;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const A=this.getNode();S--,this._fire("transformend",{evt:C,target:A}),(T=this.getLayer())===null||T===void 0||T.batchDraw(),A&&this._nodes.forEach(D=>{var L;D._fire("transformend",{evt:C,target:D}),(L=D.getLayer())===null||L===void 0||L.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(C,T){const A=this._getNodeRect(),D=1;if(t.Util._inRange(C.width,-this.padding()*2-D,D)){this.update();return}if(t.Util._inRange(C.height,-this.padding()*2-D,D)){this.update();return}const L=new t.Transform;if(L.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&C.width<0&&this._movingAnchorName.indexOf("left")>=0){const R=L.point({x:-this.padding()*2,y:0});C.x+=R.x,C.y+=R.y,C.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y}else if(this._movingAnchorName&&C.width<0&&this._movingAnchorName.indexOf("right")>=0){const R=L.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,C.width+=this.padding()*2}if(this._movingAnchorName&&C.height<0&&this._movingAnchorName.indexOf("top")>=0){const R=L.point({x:0,y:-this.padding()*2});C.x+=R.x,C.y+=R.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,C.height+=this.padding()*2}else if(this._movingAnchorName&&C.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const R=L.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=R.x,this._anchorDragOffset.y-=R.y,C.height+=this.padding()*2}if(this.boundBoxFunc()){const R=this.boundBoxFunc()(A,C);R?C=R:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const U=1e7,z=new t.Transform;z.translate(A.x,A.y),z.rotate(A.rotation),z.scale(A.width/U,A.height/U);const K=new t.Transform,y=C.width/U,P=C.height/U;this.flipEnabled()===!1?(K.translate(C.x,C.y),K.rotate(C.rotation),K.translate(C.width<0?C.width:0,C.height<0?C.height:0),K.scale(Math.abs(y),Math.abs(P))):(K.translate(C.x,C.y),K.rotate(C.rotation),K.scale(y,P));const M=K.multiply(z.invert());this._nodes.forEach(R=>{var F;const H=R.getParent().getAbsoluteTransform(),G=R.getTransform().copy();G.translate(R.offsetX(),R.offsetY());const Y=new t.Transform;Y.multiply(H.copy().invert()).multiply(M).multiply(H).multiply(G);const it=Y.decompose();R.setAttrs(it),(F=R.getLayer())===null||F===void 0||F.batchDraw()}),this.rotation(t.Util._getRotation(C.rotation)),this._nodes.forEach(R=>{this._fire("transform",{evt:T,target:R}),R._fire("transform",{evt:T,target:R})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(C,T){this.findOne(C).setAttrs(T)}update(){var C;const T=this._getNodeRect();this.rotation(t.Util._getRotation(T.rotation));const A=T.width,D=T.height,L=this.enabledAnchors(),U=this.resizeEnabled(),z=this.padding(),K=this.anchorSize(),y=this.find("._anchor");y.forEach(M=>{M.setAttrs({width:K,height:K,offsetX:K/2,offsetY:K/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:K/2+z,offsetY:K/2+z,visible:U&&L.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:A/2,y:0,offsetY:K/2+z,visible:U&&L.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:A,y:0,offsetX:K/2-z,offsetY:K/2+z,visible:U&&L.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:D/2,offsetX:K/2+z,visible:U&&L.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:A,y:D/2,offsetX:K/2-z,visible:U&&L.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:D,offsetX:K/2+z,offsetY:K/2-z,visible:U&&L.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:A/2,y:D,offsetY:K/2-z,visible:U&&L.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:A,y:D,offsetX:K/2-z,offsetY:K/2-z,visible:U&&L.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:A/2,y:-this.rotateAnchorOffset()*t.Util._sign(D)-z,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:A,height:D,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const P=this.anchorStyleFunc();P&&y.forEach(M=>{P(M)}),(C=this.getLayer())===null||C===void 0||C.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const C=this.findOne("."+this._movingAnchorName);C&&C.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),s.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(C){return n.Node.prototype.clone.call(this,C)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};di.Transformer=k,k.isTransforming=()=>S>0;function O(b){return b instanceof Array||t.Util.warn("enabledAnchors value should be an array"),b instanceof Array&&b.forEach(function(C){w.indexOf(C)===-1&&t.Util.warn("Unknown anchor name: "+C+". Available names are: "+w.join(", "))}),b||[]}return k.prototype.className="Transformer",(0,l._registerNode)(k),e.Factory.addGetterSetter(k,"enabledAnchors",w,O),e.Factory.addGetterSetter(k,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(k,"resizeEnabled",!0),e.Factory.addGetterSetter(k,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateEnabled",!0),e.Factory.addGetterSetter(k,"rotateLineVisible",!0),e.Factory.addGetterSetter(k,"rotationSnaps",[]),e.Factory.addGetterSetter(k,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(k,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderEnabled",!0),e.Factory.addGetterSetter(k,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"anchorFill","white"),e.Factory.addGetterSetter(k,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(k,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"borderDash"),e.Factory.addGetterSetter(k,"keepRatio",!0),e.Factory.addGetterSetter(k,"shiftBehavior","default"),e.Factory.addGetterSetter(k,"centeredScaling",!1),e.Factory.addGetterSetter(k,"ignoreStroke",!1),e.Factory.addGetterSetter(k,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(k,"nodes"),e.Factory.addGetterSetter(k,"node"),e.Factory.addGetterSetter(k,"boundBoxFunc"),e.Factory.addGetterSetter(k,"anchorDragBoundFunc"),e.Factory.addGetterSetter(k,"anchorStyleFunc"),e.Factory.addGetterSetter(k,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(k,"useSingleNodeRotation",!0),e.Factory.backCompat(k,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),di}var fi={},Dl;function vf(){if(Dl)return fi;Dl=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.Wedge=void 0;const t=yt(),e=Vt(),n=vt(),i=bt(),r=vt();let s=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return fi.Wedge=s,s.prototype.className="Wedge",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,r._registerNode)(s),t.Factory.addGetterSetter(s,"radius",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,"clockwise",!1),t.Factory.backCompat(s,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),fi}var gi={},zl;function yf(){if(zl)return gi;zl=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.Blur=void 0;const t=yt(),e=Gt(),n=bt();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const r=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],s=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(l,c){const h=l.data,g=l.width,f=l.height;let d,p,v,w,x,m,u,_,S,k,O,b,C,T,A,D,L,U,z,K;const y=c+c+1,P=g-1,M=f-1,R=c+1,F=R*(R+1)/2,H=new i,G=r[c],Y=s[c];let it=null,V=H,N=null,$=null;for(let tt=1;tt<y;tt++)V=V.next=new i,tt===R&&(it=V);V.next=H,v=p=0;for(let tt=0;tt<f;tt++){b=C=T=A=w=x=m=u=0,_=R*(D=h[p]),S=R*(L=h[p+1]),k=R*(U=h[p+2]),O=R*(z=h[p+3]),w+=F*D,x+=F*L,m+=F*U,u+=F*z,V=H;for(let st=0;st<R;st++)V.r=D,V.g=L,V.b=U,V.a=z,V=V.next;for(let st=1;st<R;st++)d=p+((P<st?P:st)<<2),w+=(V.r=D=h[d])*(K=R-st),x+=(V.g=L=h[d+1])*K,m+=(V.b=U=h[d+2])*K,u+=(V.a=z=h[d+3])*K,b+=D,C+=L,T+=U,A+=z,V=V.next;N=H,$=it;for(let st=0;st<g;st++)h[p+3]=z=u*G>>Y,z!==0?(z=255/z,h[p]=(w*G>>Y)*z,h[p+1]=(x*G>>Y)*z,h[p+2]=(m*G>>Y)*z):h[p]=h[p+1]=h[p+2]=0,w-=_,x-=S,m-=k,u-=O,_-=N.r,S-=N.g,k-=N.b,O-=N.a,d=v+((d=st+c+1)<P?d:P)<<2,b+=N.r=h[d],C+=N.g=h[d+1],T+=N.b=h[d+2],A+=N.a=h[d+3],w+=b,x+=C,m+=T,u+=A,N=N.next,_+=D=$.r,S+=L=$.g,k+=U=$.b,O+=z=$.a,b-=D,C-=L,T-=U,A-=z,$=$.next,p+=4;v+=g}for(let tt=0;tt<g;tt++){C=T=A=b=x=m=u=w=0,p=tt<<2,_=R*(D=h[p]),S=R*(L=h[p+1]),k=R*(U=h[p+2]),O=R*(z=h[p+3]),w+=F*D,x+=F*L,m+=F*U,u+=F*z,V=H;for(let ct=0;ct<R;ct++)V.r=D,V.g=L,V.b=U,V.a=z,V=V.next;let st=g;for(let ct=1;ct<=c;ct++)p=st+tt<<2,w+=(V.r=D=h[p])*(K=R-ct),x+=(V.g=L=h[p+1])*K,m+=(V.b=U=h[p+2])*K,u+=(V.a=z=h[p+3])*K,b+=D,C+=L,T+=U,A+=z,V=V.next,ct<M&&(st+=g);p=tt,N=H,$=it;for(let ct=0;ct<f;ct++)d=p<<2,h[d+3]=z=u*G>>Y,z>0?(z=255/z,h[d]=(w*G>>Y)*z,h[d+1]=(x*G>>Y)*z,h[d+2]=(m*G>>Y)*z):h[d]=h[d+1]=h[d+2]=0,w-=_,x-=S,m-=k,u-=O,_-=N.r,S-=N.g,k-=N.b,O-=N.a,d=tt+((d=ct+R)<M?d:M)*g<<2,w+=b+=N.r=h[d],x+=C+=N.g=h[d+1],m+=T+=N.b=h[d+2],u+=A+=N.a=h[d+3],N=N.next,_+=D=$.r,S+=L=$.g,k+=U=$.b,O+=z=$.a,b-=D,C-=L,T-=U,A-=z,$=$.next,p+=g}}const a=function(c){const h=Math.round(this.blurRadius());h>0&&o(c,h)};return gi.Blur=a,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),gi}var pi={},Ll;function bf(){if(Ll)return pi;Ll=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Brighten=void 0;const t=yt(),e=Gt(),n=bt(),i=function(r){const s=this.brightness()*255,o=r.data,a=o.length;for(let l=0;l<a;l+=4)o[l]+=s,o[l+1]+=s,o[l+2]+=s};return pi.Brighten=i,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),pi}var mi={},Gl;function Sf(){if(Gl)return mi;Gl=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.Contrast=void 0;const t=yt(),e=Gt(),n=bt(),i=function(r){const s=Math.pow((this.contrast()+100)/100,2),o=r.data,a=o.length;let l=150,c=150,h=150;for(let g=0;g<a;g+=4)l=o[g],c=o[g+1],h=o[g+2],l/=255,l-=.5,l*=s,l+=.5,l*=255,c/=255,c-=.5,c*=s,c+=.5,c*=255,h/=255,h-=.5,h*=s,h+=.5,h*=255,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,h=h<0?0:h>255?255:h,o[g]=l,o[g+1]=c,o[g+2]=h};return mi.Contrast=i,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),mi}var _i={},Ul;function wf(){if(Ul)return _i;Ul=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.Emboss=void 0;const t=yt(),e=Gt(),n=zt(),i=bt(),r=function(s){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),c=this.embossBlend(),h=s.data,g=s.width,f=s.height,d=g*4;let p=0,v=0,w=f;switch(l){case"top-left":p=-1,v=-1;break;case"top":p=-1,v=0;break;case"top-right":p=-1,v=1;break;case"right":p=0,v=1;break;case"bottom-right":p=1,v=1;break;case"bottom":p=1,v=0;break;case"bottom-left":p=1,v=-1;break;case"left":p=0,v=-1;break;default:n.Util.error("Unknown emboss direction: "+l)}do{const x=(w-1)*d;let m=p;w+m<1&&(m=0),w+m>f&&(m=0);const u=(w-1+m)*g*4;let _=g;do{const S=x+(_-1)*4;let k=v;_+k<1&&(k=0),_+k>g&&(k=0);const O=u+(_-1+k)*4,b=h[S]-h[O],C=h[S+1]-h[O+1],T=h[S+2]-h[O+2];let A=b;const D=A>0?A:-A,L=C>0?C:-C,U=T>0?T:-T;if(L>D&&(A=C),U>D&&(A=T),A*=o,c){const z=h[S]+A,K=h[S+1]+A,y=h[S+2]+A;h[S]=z>255?255:z<0?0:z,h[S+1]=K>255?255:K<0?0:K,h[S+2]=y>255?255:y<0?0:y}else{let z=a-A;z<0?z=0:z>255&&(z=255),h[S]=h[S+1]=h[S+2]=z}}while(--_)}while(--w)};return _i.Emboss=r,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,t.Factory.afterSetFilter),_i}var vi={},Bl;function xf(){if(Bl)return vi;Bl=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.Enhance=void 0;const t=yt(),e=Gt(),n=bt();function i(s,o,a,l,c){const h=a-o,g=c-l;if(h===0)return l+g/2;if(g===0)return l;let f=(s-o)/h;return f=g*f+l,f}const r=function(s){const o=s.data,a=o.length;let l=o[0],c=l,h,g=o[1],f=g,d,p=o[2],v=p,w;const x=this.enhance();if(x===0)return;for(let b=0;b<a;b+=4)h=o[b+0],h<l?l=h:h>c&&(c=h),d=o[b+1],d<g?g=d:d>f&&(f=d),w=o[b+2],w<p?p=w:w>v&&(v=w);c===l&&(c=255,l=0),f===g&&(f=255,g=0),v===p&&(v=255,p=0);let m,u,_,S,k,O;if(x>0)m=c+x*(255-c),u=l-x*(l-0),_=f+x*(255-f),S=g-x*(g-0),k=v+x*(255-v),O=p-x*(p-0);else{const b=(c+l)*.5;m=c+x*(c-b),u=l+x*(l-b);const C=(f+g)*.5;_=f+x*(f-C),S=g+x*(g-C);const T=(v+p)*.5;k=v+x*(v-T),O=p+x*(p-T)}for(let b=0;b<a;b+=4)o[b+0]=i(o[b+0],l,c,u,m),o[b+1]=i(o[b+1],g,f,S,_),o[b+2]=i(o[b+2],p,v,O,k)};return vi.Enhance=r,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),vi}var yi={},$l;function Cf(){if($l)return yi;$l=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.Grayscale=void 0;const t=function(e){const n=e.data,i=n.length;for(let r=0;r<i;r+=4){const s=.34*n[r]+.5*n[r+1]+.16*n[r+2];n[r]=s,n[r+1]=s,n[r+2]=s}};return yi.Grayscale=t,yi}var bi={},Vl;function Pf(){if(Vl)return bi;Vl=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.HSL=void 0;const t=yt(),e=Gt(),n=bt();t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter);const i=function(r){const s=r.data,o=s.length,a=1,l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=this.luminance()*127,g=a*l*Math.cos(c*Math.PI/180),f=a*l*Math.sin(c*Math.PI/180),d=.299*a+.701*g+.167*f,p=.587*a-.587*g+.33*f,v=.114*a-.114*g-.497*f,w=.299*a-.299*g-.328*f,x=.587*a+.413*g+.035*f,m=.114*a-.114*g+.293*f,u=.299*a-.3*g+1.25*f,_=.587*a-.586*g-1.05*f,S=.114*a+.886*g-.2*f;let k,O,b,C;for(let T=0;T<o;T+=4)k=s[T+0],O=s[T+1],b=s[T+2],C=s[T+3],s[T+0]=d*k+p*O+v*b+h,s[T+1]=w*k+x*O+m*b+h,s[T+2]=u*k+_*O+S*b+h,s[T+3]=C};return bi.HSL=i,bi}var Si={},Hl;function Tf(){if(Hl)return Si;Hl=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.HSV=void 0;const t=yt(),e=Gt(),n=bt(),i=function(r){const s=r.data,o=s.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,h=a*l*Math.cos(c*Math.PI/180),g=a*l*Math.sin(c*Math.PI/180),f=.299*a+.701*h+.167*g,d=.587*a-.587*h+.33*g,p=.114*a-.114*h-.497*g,v=.299*a-.299*h-.328*g,w=.587*a+.413*h+.035*g,x=.114*a-.114*h+.293*g,m=.299*a-.3*h+1.25*g,u=.587*a-.586*h-1.05*g,_=.114*a+.886*h-.2*g;for(let S=0;S<o;S+=4){const k=s[S+0],O=s[S+1],b=s[S+2],C=s[S+3];s[S+0]=f*k+d*O+p*b,s[S+1]=v*k+w*O+x*b,s[S+2]=m*k+u*O+_*b,s[S+3]=C}};return Si.HSV=i,t.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Si}var wi={},Wl;function kf(){if(Wl)return wi;Wl=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.Invert=void 0;const t=function(e){const n=e.data,i=n.length;for(let r=0;r<i;r+=4)n[r]=255-n[r],n[r+1]=255-n[r+1],n[r+2]=255-n[r+2]};return wi.Invert=t,wi}var xi={},jl;function Ef(){if(jl)return xi;jl=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.Kaleidoscope=void 0;const t=yt(),e=Gt(),n=zt(),i=bt(),r=function(a,l,c){const h=a.data,g=l.data,f=a.width,d=a.height,p=c.polarCenterX||f/2,v=c.polarCenterY||d/2;let w=Math.sqrt(p*p+v*v),x=f-p,m=d-v;const u=Math.sqrt(x*x+m*m);w=u>w?u:w;const _=d,S=f,k=360/S*Math.PI/180;for(let O=0;O<S;O+=1){const b=Math.sin(O*k),C=Math.cos(O*k);for(let T=0;T<_;T+=1){x=Math.floor(p+w*T/_*C),m=Math.floor(v+w*T/_*b);let A=(m*f+x)*4;const D=h[A+0],L=h[A+1],U=h[A+2],z=h[A+3];A=(O+T*f)*4,g[A+0]=D,g[A+1]=L,g[A+2]=U,g[A+3]=z}}},s=function(a,l,c){const h=a.data,g=l.data,f=a.width,d=a.height,p=c.polarCenterX||f/2,v=c.polarCenterY||d/2;let w=Math.sqrt(p*p+v*v),x=f-p,m=d-v;const u=Math.sqrt(x*x+m*m);w=u>w?u:w;const _=d,S=f,k=0;let O,b;for(x=0;x<f;x+=1)for(m=0;m<d;m+=1){const C=x-p,T=m-v,A=Math.sqrt(C*C+T*T)*_/w;let D=(Math.atan2(T,C)*180/Math.PI+360+k)%360;D=D*S/360,O=Math.floor(D),b=Math.floor(A);let L=(b*f+O)*4;const U=h[L+0],z=h[L+1],K=h[L+2],y=h[L+3];L=(m*f+x)*4,g[L+0]=U,g[L+1]=z,g[L+2]=K,g[L+3]=y}},o=function(a){const l=a.width,c=a.height;let h,g,f,d,p,v,w,x,m,u,_=Math.round(this.kaleidoscopePower());const S=Math.round(this.kaleidoscopeAngle()),k=Math.floor(l*(S%360)/360);if(_<1)return;const O=n.Util.createCanvasElement();O.width=l,O.height=c;const b=O.getContext("2d").getImageData(0,0,l,c);n.Util.releaseCanvas(O),r(a,b,{polarCenterX:l/2,polarCenterY:c/2});let C=l/Math.pow(2,_);for(;C<=8;)C=C*2,_-=1;C=Math.ceil(C);let T=C,A=0,D=T,L=1;for(k+C>l&&(A=T,D=0,L=-1),g=0;g<c;g+=1)for(h=A;h!==D;h+=L)f=Math.round(h+k)%l,m=(l*g+f)*4,p=b.data[m+0],v=b.data[m+1],w=b.data[m+2],x=b.data[m+3],u=(l*g+h)*4,b.data[u+0]=p,b.data[u+1]=v,b.data[u+2]=w,b.data[u+3]=x;for(g=0;g<c;g+=1)for(T=Math.floor(C),d=0;d<_;d+=1){for(h=0;h<T+1;h+=1)m=(l*g+h)*4,p=b.data[m+0],v=b.data[m+1],w=b.data[m+2],x=b.data[m+3],u=(l*g+T*2-h-1)*4,b.data[u+0]=p,b.data[u+1]=v,b.data[u+2]=w,b.data[u+3]=x;T*=2}s(b,a,{})};return xi.Kaleidoscope=o,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),xi}var Ci={},Zl;function Rf(){if(Zl)return Ci;Zl=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.Mask=void 0;const t=yt(),e=Gt(),n=bt();function i(f,d,p){let v=(p*f.width+d)*4;const w=[];return w.push(f.data[v++],f.data[v++],f.data[v++],f.data[v++]),w}function r(f,d){return Math.sqrt(Math.pow(f[0]-d[0],2)+Math.pow(f[1]-d[1],2)+Math.pow(f[2]-d[2],2))}function s(f){const d=[0,0,0];for(let p=0;p<f.length;p++)d[0]+=f[p][0],d[1]+=f[p][1],d[2]+=f[p][2];return d[0]/=f.length,d[1]/=f.length,d[2]/=f.length,d}function o(f,d){const p=i(f,0,0),v=i(f,f.width-1,0),w=i(f,0,f.height-1),x=i(f,f.width-1,f.height-1),m=d||10;if(r(p,v)<m&&r(v,x)<m&&r(x,w)<m&&r(w,p)<m){const u=s([v,p,x,w]),_=[];for(let S=0;S<f.width*f.height;S++){const k=r(u,[f.data[S*4],f.data[S*4+1],f.data[S*4+2]]);_[S]=k<m?0:255}return _}}function a(f,d){for(let p=0;p<f.width*f.height;p++)f.data[4*p+3]=d[p]}function l(f,d,p){const v=[1,1,1,1,0,1,1,1,1],w=Math.round(Math.sqrt(v.length)),x=Math.floor(w/2),m=[];for(let u=0;u<p;u++)for(let _=0;_<d;_++){const S=u*d+_;let k=0;for(let O=0;O<w;O++)for(let b=0;b<w;b++){const C=u+O-x,T=_+b-x;if(C>=0&&C<p&&T>=0&&T<d){const A=C*d+T,D=v[O*w+b];k+=f[A]*D}}m[S]=k===2040?255:0}return m}function c(f,d,p){const v=[1,1,1,1,1,1,1,1,1],w=Math.round(Math.sqrt(v.length)),x=Math.floor(w/2),m=[];for(let u=0;u<p;u++)for(let _=0;_<d;_++){const S=u*d+_;let k=0;for(let O=0;O<w;O++)for(let b=0;b<w;b++){const C=u+O-x,T=_+b-x;if(C>=0&&C<p&&T>=0&&T<d){const A=C*d+T,D=v[O*w+b];k+=f[A]*D}}m[S]=k>=1020?255:0}return m}function h(f,d,p){const v=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],w=Math.round(Math.sqrt(v.length)),x=Math.floor(w/2),m=[];for(let u=0;u<p;u++)for(let _=0;_<d;_++){const S=u*d+_;let k=0;for(let O=0;O<w;O++)for(let b=0;b<w;b++){const C=u+O-x,T=_+b-x;if(C>=0&&C<p&&T>=0&&T<d){const A=C*d+T,D=v[O*w+b];k+=f[A]*D}}m[S]=k}return m}const g=function(f){const d=this.threshold();let p=o(f,d);return p&&(p=l(p,f.width,f.height),p=c(p,f.width,f.height),p=h(p,f.width,f.height),a(f,p)),f};return Ci.Mask=g,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Ci}var Pi={},ql;function Af(){if(ql)return Pi;ql=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.Noise=void 0;const t=yt(),e=Gt(),n=bt(),i=function(r){const s=this.noise()*255,o=r.data,a=o.length,l=s/2;for(let c=0;c<a;c+=4)o[c+0]+=l-2*l*Math.random(),o[c+1]+=l-2*l*Math.random(),o[c+2]+=l-2*l*Math.random()};return Pi.Noise=i,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Pi}var Ti={},Kl;function Nf(){if(Kl)return Ti;Kl=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.Pixelate=void 0;const t=yt(),e=zt(),n=Gt(),i=bt(),r=function(s){let o=Math.ceil(this.pixelSize()),a=s.width,l=s.height,c=Math.ceil(a/o),h=Math.ceil(l/o),g=s.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let f=0;f<c;f+=1)for(let d=0;d<h;d+=1){let p=0,v=0,w=0,x=0;const m=f*o,u=m+o,_=d*o,S=_+o;let k=0;for(let O=m;O<u;O+=1)if(!(O>=a))for(let b=_;b<S;b+=1){if(b>=l)continue;const C=(a*b+O)*4;p+=g[C+0],v+=g[C+1],w+=g[C+2],x+=g[C+3],k+=1}p=p/k,v=v/k,w=w/k,x=x/k;for(let O=m;O<u;O+=1)if(!(O>=a))for(let b=_;b<S;b+=1){if(b>=l)continue;const C=(a*b+O)*4;g[C+0]=p,g[C+1]=v,g[C+2]=w,g[C+3]=x}}};return Ti.Pixelate=r,t.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),Ti}var ki={},Yl;function Mf(){if(Yl)return ki;Yl=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.Posterize=void 0;const t=yt(),e=Gt(),n=bt(),i=function(r){const s=Math.round(this.levels()*254)+1,o=r.data,a=o.length,l=255/s;for(let c=0;c<a;c+=1)o[c]=Math.floor(o[c]/l)*l};return ki.Posterize=i,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),ki}var Ei={},Xl;function If(){if(Xl)return Ei;Xl=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.RGB=void 0;const t=yt(),e=Gt(),n=bt(),i=function(r){const s=r.data,o=s.length,a=this.red(),l=this.green(),c=this.blue();for(let h=0;h<o;h+=4){const g=(.34*s[h]+.5*s[h+1]+.16*s[h+2])/255;s[h]=g*a,s[h+1]=g*l,s[h+2]=g*c,s[h+3]=s[h+3]}};return Ei.RGB=i,t.Factory.addGetterSetter(e.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),Ei}var Ri={},Ql;function Of(){if(Ql)return Ri;Ql=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.RGBA=void 0;const t=yt(),e=Gt(),n=bt(),i=function(r){const s=r.data,o=s.length,a=this.red(),l=this.green(),c=this.blue(),h=this.alpha();for(let g=0;g<o;g+=4){const f=1-h;s[g]=a*h+s[g]*f,s[g+1]=l*h+s[g+1]*f,s[g+2]=c*h+s[g+2]*f}};return Ri.RGBA=i,t.Factory.addGetterSetter(e.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),t.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r}),Ri}var Ai={},Jl;function Ff(){if(Jl)return Ai;Jl=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.Sepia=void 0;const t=function(e){const n=e.data,i=n.length;for(let r=0;r<i;r+=4){const s=n[r+0],o=n[r+1],a=n[r+2];n[r+0]=Math.min(255,s*.393+o*.769+a*.189),n[r+1]=Math.min(255,s*.349+o*.686+a*.168),n[r+2]=Math.min(255,s*.272+o*.534+a*.131)}};return Ai.Sepia=t,Ai}var Ni={},tc;function Df(){if(tc)return Ni;tc=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.Solarize=void 0;const t=function(e){const n=e.data,i=e.width,r=e.height,s=i*4;let o=r;do{const a=(o-1)*s;let l=i;do{const c=a+(l-1)*4;let h=n[c],g=n[c+1],f=n[c+2];h>127&&(h=255-h),g>127&&(g=255-g),f>127&&(f=255-f),n[c]=h,n[c+1]=g,n[c+2]=f}while(--l)}while(--o)};return Ni.Solarize=t,Ni}var Mi={},ec;function zf(){if(ec)return Mi;ec=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.Threshold=void 0;const t=yt(),e=Gt(),n=bt(),i=function(r){const s=this.threshold()*255,o=r.data,a=o.length;for(let l=0;l<a;l+=1)o[l]=o[l]<s?0:255};return Mi.Threshold=i,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Mi}var nc;function Lf(){if(nc)return jn;nc=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.Konva=void 0;const t=rf(),e=sf(),n=af(),i=lf(),r=cf(),s=hf(),o=uf(),a=vl(),l=Is(),c=kl(),h=df(),g=ff(),f=gf(),d=pf(),p=Il(),v=mf(),w=_f(),x=vf(),m=yf(),u=bf(),_=Sf(),S=wf(),k=xf(),O=Cf(),b=Pf(),C=Tf(),T=kf(),A=Ef(),D=Rf(),L=Af(),U=Nf(),z=Mf(),K=If(),y=Of(),P=Ff(),M=Df(),R=zf();return jn.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:r.Ellipse,Image:s.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:l.Path,Rect:c.Rect,RegularPolygon:h.RegularPolygon,Ring:g.Ring,Sprite:f.Sprite,Star:d.Star,Text:p.Text,TextPath:v.TextPath,Transformer:w.Transformer,Wedge:x.Wedge,Filters:{Blur:m.Blur,Brighten:u.Brighten,Contrast:_.Contrast,Emboss:S.Emboss,Enhance:k.Enhance,Grayscale:O.Grayscale,HSL:b.HSL,HSV:C.HSV,Invert:T.Invert,Kaleidoscope:A.Kaleidoscope,Mask:D.Mask,Noise:L.Noise,Pixelate:U.Pixelate,Posterize:z.Posterize,RGB:K.RGB,RGBA:y.RGBA,Sepia:P.Sepia,Solarize:M.Solarize,Threshold:R.Threshold}}),jn}var Gf=pr.exports,ic;function Uf(){if(ic)return pr.exports;ic=1,Object.defineProperty(Gf,"__esModule",{value:!0});const t=Lf();return pr.exports=t.Konva,pr.exports}var Bf=Uf();const jt=Jd(Bf),$f=()=>({stage:void 0,konvaContainer:void 0,notes:new Map,selection:{selectedIds:new Set,selectionRect:void 0},viewport:{scrollX:0,scrollY:55*20,zoomX:1,zoomY:1},grid:{quarterNoteWidth:120,noteHeight:20,baseQuarterNoteWidth:120,baseNoteHeight:20,subdivision:16,numMeasures:100,timeSignature:4,maxLength:64,backgroundColor1:"#ddd",backgroundColor2:"#bbb",noteColor:"#f23",selectedNoteColor:"#2ee"},interaction:{isDragging:!1,dragStartPos:void 0,draggedNoteInitialStates:new Map,quantDragActivated:!1,dragBeforeState:void 0,isResizing:!1,resizeTargetId:void 0,resizeIsEnd:!1,resizeInitialStates:new Map,quantResizeActivated:!1,resizeBeforeState:void 0,isMarqueeSelecting:!1,marqueeStart:void 0,marqueeCurrent:void 0,marqueeIsShift:!1,hiddenNoteIds:new Set,truncatedNotes:new Map,createEmptyOverlapAdjustments:()=>({toDelete:new Set,toTruncate:new Map})},command:{stack:void 0},layers:{grid:void 0,notes:void 0,overlay:void 0},renderCache:{grid:{lastScrollX:-1,lastScrollY:-1,lastSubdivision:-1,lastQuarterNoteWidth:-1,lastNoteHeight:-1}},needsRedraw:!1,rafHandle:void 0,queuePlayhead:{position:0,element:void 0},livePlayhead:{position:0,element:void 0},notifyExternalChange:void 0});function Z(t,e,n){function i(a,l){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:l,constr:o,traits:new Set},enumerable:!1}),a._zod.traits.has(t))return;a._zod.traits.add(t),e(a,l);const c=o.prototype,h=Object.keys(c);for(let g=0;g<h.length;g++){const f=h[g];f in a||(a[f]=c[f].bind(a))}}const r=n?.Parent??Object;class s extends r{}Object.defineProperty(s,"name",{value:t});function o(a){var l;const c=n?.Parent?new s:this;i(c,a),(l=c._zod).deferred??(l.deferred=[]);for(const h of c._zod.deferred)h();return c}return Object.defineProperty(o,"init",{value:i}),Object.defineProperty(o,Symbol.hasInstance,{value:a=>n?.Parent&&a instanceof n.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(o,"name",{value:t}),o}class vn extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class rc extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const sc={};function Ve(t){return sc}function Vf(t){const e=Object.values(t).filter(i=>typeof i=="number");return Object.entries(t).filter(([i,r])=>e.indexOf(+i)===-1).map(([i,r])=>r)}function Os(t,e){return typeof e=="bigint"?e.toString():e}function vr(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function Fs(t){return t==null}function Ds(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}function Hf(t,e){const n=(t.toString().split(".")[1]||"").length,i=e.toString();let r=(i.split(".")[1]||"").length;if(r===0&&/\d?e-\d?/.test(i)){const l=i.match(/\d?e-(\d?)/);l?.[1]&&(r=Number.parseInt(l[1]))}const s=n>r?n:r,o=Number.parseInt(t.toFixed(s).replace(".","")),a=Number.parseInt(e.toFixed(s).replace(".",""));return o%a/10**s}const oc=Symbol("evaluating");function kt(t,e,n){let i;Object.defineProperty(t,e,{get(){if(i!==oc)return i===void 0&&(i=oc,i=n()),i},set(r){Object.defineProperty(t,e,{value:r})},configurable:!0})}function rn(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function sn(...t){const e={};for(const n of t){const i=Object.getOwnPropertyDescriptors(n);Object.assign(e,i)}return Object.defineProperties({},e)}function ac(t){return JSON.stringify(t)}function Wf(t){return t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const lc="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function Ii(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const jf=vr(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function yn(t){if(Ii(t)===!1)return!1;const e=t.constructor;if(e===void 0||typeof e!="function")return!0;const n=e.prototype;return!(Ii(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function cc(t){return yn(t)?{...t}:Array.isArray(t)?[...t]:t}const Zf=new Set(["string","number","symbol"]);function bn(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function He(t,e,n){const i=new t._zod.constr(e??t._zod.def);return(!e||n?.parent)&&(i._zod.parent=t),i}function ht(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function qf(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const Kf={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Yf(t,e){const n=t._zod.def,i=sn(t._zod.def,{get shape(){const r={};for(const s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&(r[s]=n.shape[s])}return rn(this,"shape",r),r},checks:[]});return He(t,i)}function Xf(t,e){const n=t._zod.def,i=sn(t._zod.def,{get shape(){const r={...t._zod.def.shape};for(const s in e){if(!(s in n.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&delete r[s]}return rn(this,"shape",r),r},checks:[]});return He(t,i)}function Qf(t,e){if(!yn(e))throw new Error("Invalid input to extend: expected a plain object");const n=t._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const r=sn(t._zod.def,{get shape(){const s={...t._zod.def.shape,...e};return rn(this,"shape",s),s},checks:[]});return He(t,r)}function Jf(t,e){if(!yn(e))throw new Error("Invalid input to safeExtend: expected a plain object");const n={...t._zod.def,get shape(){const i={...t._zod.def.shape,...e};return rn(this,"shape",i),i},checks:t._zod.def.checks};return He(t,n)}function t0(t,e){const n=sn(t._zod.def,{get shape(){const i={...t._zod.def.shape,...e._zod.def.shape};return rn(this,"shape",i),i},get catchall(){return e._zod.def.catchall},checks:[]});return He(t,n)}function e0(t,e,n){const i=sn(e._zod.def,{get shape(){const r=e._zod.def.shape,s={...r};if(n)for(const o in n){if(!(o in r))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(s[o]=t?new t({type:"optional",innerType:r[o]}):r[o])}else for(const o in r)s[o]=t?new t({type:"optional",innerType:r[o]}):r[o];return rn(this,"shape",s),s},checks:[]});return He(e,i)}function n0(t,e,n){const i=sn(e._zod.def,{get shape(){const r=e._zod.def.shape,s={...r};if(n)for(const o in n){if(!(o in s))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(s[o]=new t({type:"nonoptional",innerType:r[o]}))}else for(const o in r)s[o]=new t({type:"nonoptional",innerType:r[o]});return rn(this,"shape",s),s},checks:[]});return He(e,i)}function Sn(t,e=0){if(t.aborted===!0)return!0;for(let n=e;n<t.issues.length;n++)if(t.issues[n]?.continue!==!0)return!0;return!1}function on(t,e){return e.map(n=>{var i;return(i=n).path??(i.path=[]),n.path.unshift(t),n})}function yr(t){return typeof t=="string"?t:t?.message}function We(t,e,n){const i={...t,path:t.path??[]};if(!t.message){const r=yr(t.inst?._zod.def?.error?.(t))??yr(e?.error?.(t))??yr(n.customError?.(t))??yr(n.localeError?.(t))??"Invalid input";i.message=r}return delete i.inst,delete i.continue,e?.reportInput||delete i.input,i}function zs(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Oi(...t){const[e,n,i]=t;return typeof e=="string"?{message:e,code:"custom",input:n,inst:i}:{...e}}const hc=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,Os,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},uc=Z("$ZodError",hc),dc=Z("$ZodError",hc,{Parent:Error});function i0(t,e=n=>n.message){const n={},i=[];for(const r of t.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(e(r))):i.push(e(r));return{formErrors:i,fieldErrors:n}}function r0(t,e=n=>n.message){const n={_errors:[]},i=r=>{for(const s of r.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(o=>i({issues:o}));else if(s.code==="invalid_key")i({issues:s.issues});else if(s.code==="invalid_element")i({issues:s.issues});else if(s.path.length===0)n._errors.push(e(s));else{let o=n,a=0;for(;a<s.path.length;){const l=s.path[a];a===s.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(e(s))):o[l]=o[l]||{_errors:[]},o=o[l],a++}}};return i(t),n}const Ls=t=>(e,n,i,r)=>{const s=i?Object.assign(i,{async:!1}):{async:!1},o=e._zod.run({value:n,issues:[]},s);if(o instanceof Promise)throw new vn;if(o.issues.length){const a=new(r?.Err??t)(o.issues.map(l=>We(l,s,Ve())));throw lc(a,r?.callee),a}return o.value},Gs=t=>async(e,n,i,r)=>{const s=i?Object.assign(i,{async:!0}):{async:!0};let o=e._zod.run({value:n,issues:[]},s);if(o instanceof Promise&&(o=await o),o.issues.length){const a=new(r?.Err??t)(o.issues.map(l=>We(l,s,Ve())));throw lc(a,r?.callee),a}return o.value},br=t=>(e,n,i)=>{const r=i?{...i,async:!1}:{async:!1},s=e._zod.run({value:n,issues:[]},r);if(s instanceof Promise)throw new vn;return s.issues.length?{success:!1,error:new(t??uc)(s.issues.map(o=>We(o,r,Ve())))}:{success:!0,data:s.value}},s0=br(dc),Sr=t=>async(e,n,i)=>{const r=i?Object.assign(i,{async:!0}):{async:!0};let s=e._zod.run({value:n,issues:[]},r);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new t(s.issues.map(o=>We(o,r,Ve())))}:{success:!0,data:s.value}},o0=Sr(dc),a0=t=>(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Ls(t)(e,n,r)},l0=t=>(e,n,i)=>Ls(t)(e,n,i),c0=t=>async(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Gs(t)(e,n,r)},h0=t=>async(e,n,i)=>Gs(t)(e,n,i),u0=t=>(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return br(t)(e,n,r)},d0=t=>(e,n,i)=>br(t)(e,n,i),f0=t=>async(e,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Sr(t)(e,n,r)},g0=t=>async(e,n,i)=>Sr(t)(e,n,i),p0=/^[cC][^\s-]{8,}$/,m0=/^[0-9a-z]+$/,_0=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,v0=/^[0-9a-vA-V]{20}$/,y0=/^[A-Za-z0-9]{27}$/,b0=/^[a-zA-Z0-9_-]{21}$/,S0=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,w0=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,fc=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,x0=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,C0="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function P0(){return new RegExp(C0,"u")}const T0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,k0=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,E0=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,R0=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,A0=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,gc=/^[A-Za-z0-9_-]*$/,N0=/^\+(?:[0-9]){6,14}[0-9]$/,pc="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",M0=new RegExp(`^${pc}$`);function mc(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function I0(t){return new RegExp(`^${mc(t)}$`)}function O0(t){const e=mc({precision:t.precision}),n=["Z"];t.local&&n.push(""),t.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const i=`${e}(?:${n.join("|")})`;return new RegExp(`^${pc}T(?:${i})$`)}const F0=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},D0=/^-?\d+$/,z0=/^-?\d+(?:\.\d+)?/,L0=/^(?:true|false)$/i,G0=/^[^A-Z]*$/,U0=/^[^a-z]*$/,te=Z("$ZodCheck",(t,e)=>{var n;t._zod??(t._zod={}),t._zod.def=e,(n=t._zod).onattach??(n.onattach=[])}),_c={number:"number",bigint:"bigint",object:"date"},vc=Z("$ZodCheckLessThan",(t,e)=>{te.init(t,e);const n=_c[typeof e.value];t._zod.onattach.push(i=>{const r=i._zod.bag,s=(e.inclusive?r.maximum:r.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?r.maximum=e.value:r.exclusiveMaximum=e.value)}),t._zod.check=i=>{(e.inclusive?i.value<=e.value:i.value<e.value)||i.issues.push({origin:n,code:"too_big",maximum:e.value,input:i.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),yc=Z("$ZodCheckGreaterThan",(t,e)=>{te.init(t,e);const n=_c[typeof e.value];t._zod.onattach.push(i=>{const r=i._zod.bag,s=(e.inclusive?r.minimum:r.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?r.minimum=e.value:r.exclusiveMinimum=e.value)}),t._zod.check=i=>{(e.inclusive?i.value>=e.value:i.value>e.value)||i.issues.push({origin:n,code:"too_small",minimum:e.value,input:i.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),B0=Z("$ZodCheckMultipleOf",(t,e)=>{te.init(t,e),t._zod.onattach.push(n=>{var i;(i=n._zod.bag).multipleOf??(i.multipleOf=e.value)}),t._zod.check=n=>{if(typeof n.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%e.value===BigInt(0):Hf(n.value,e.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:e.value,input:n.value,inst:t,continue:!e.abort})}}),$0=Z("$ZodCheckNumberFormat",(t,e)=>{te.init(t,e),e.format=e.format||"float64";const n=e.format?.includes("int"),i=n?"int":"number",[r,s]=Kf[e.format];t._zod.onattach.push(o=>{const a=o._zod.bag;a.format=e.format,a.minimum=r,a.maximum=s,n&&(a.pattern=D0)}),t._zod.check=o=>{const a=o.value;if(n){if(!Number.isInteger(a)){o.issues.push({expected:i,format:e.format,code:"invalid_type",continue:!1,input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?o.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:i,continue:!e.abort}):o.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:i,continue:!e.abort});return}}a<r&&o.issues.push({origin:"number",input:a,code:"too_small",minimum:r,inclusive:!0,inst:t,continue:!e.abort}),a>s&&o.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inst:t})}}),V0=Z("$ZodCheckMaxLength",(t,e)=>{var n;te.init(t,e),(n=t._zod.def).when??(n.when=i=>{const r=i.value;return!Fs(r)&&r.length!==void 0}),t._zod.onattach.push(i=>{const r=i._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<r&&(i._zod.bag.maximum=e.maximum)}),t._zod.check=i=>{const r=i.value;if(r.length<=e.maximum)return;const o=zs(r);i.issues.push({origin:o,code:"too_big",maximum:e.maximum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),H0=Z("$ZodCheckMinLength",(t,e)=>{var n;te.init(t,e),(n=t._zod.def).when??(n.when=i=>{const r=i.value;return!Fs(r)&&r.length!==void 0}),t._zod.onattach.push(i=>{const r=i._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>r&&(i._zod.bag.minimum=e.minimum)}),t._zod.check=i=>{const r=i.value;if(r.length>=e.minimum)return;const o=zs(r);i.issues.push({origin:o,code:"too_small",minimum:e.minimum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),W0=Z("$ZodCheckLengthEquals",(t,e)=>{var n;te.init(t,e),(n=t._zod.def).when??(n.when=i=>{const r=i.value;return!Fs(r)&&r.length!==void 0}),t._zod.onattach.push(i=>{const r=i._zod.bag;r.minimum=e.length,r.maximum=e.length,r.length=e.length}),t._zod.check=i=>{const r=i.value,s=r.length;if(s===e.length)return;const o=zs(r),a=s>e.length;i.issues.push({origin:o,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:i.value,inst:t,continue:!e.abort})}}),wr=Z("$ZodCheckStringFormat",(t,e)=>{var n,i;te.init(t,e),t._zod.onattach.push(r=>{const s=r._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(n=t._zod).check??(n.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:e.format,input:r.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(i=t._zod).check??(i.check=()=>{})}),j0=Z("$ZodCheckRegex",(t,e)=>{wr.init(t,e),t._zod.check=n=>{e.pattern.lastIndex=0,!e.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),Z0=Z("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=G0),wr.init(t,e)}),q0=Z("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=U0),wr.init(t,e)}),K0=Z("$ZodCheckIncludes",(t,e)=>{te.init(t,e);const n=bn(e.includes),i=new RegExp(typeof e.position=="number"?`^.{${e.position}}${n}`:n);e.pattern=i,t._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(i)}),t._zod.check=r=>{r.value.includes(e.includes,e.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:r.value,inst:t,continue:!e.abort})}}),Y0=Z("$ZodCheckStartsWith",(t,e)=>{te.init(t,e);const n=new RegExp(`^${bn(e.prefix)}.*`);e.pattern??(e.pattern=n),t._zod.onattach.push(i=>{const r=i._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),t._zod.check=i=>{i.value.startsWith(e.prefix)||i.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:i.value,inst:t,continue:!e.abort})}}),X0=Z("$ZodCheckEndsWith",(t,e)=>{te.init(t,e);const n=new RegExp(`.*${bn(e.suffix)}$`);e.pattern??(e.pattern=n),t._zod.onattach.push(i=>{const r=i._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),t._zod.check=i=>{i.value.endsWith(e.suffix)||i.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:i.value,inst:t,continue:!e.abort})}}),Q0=Z("$ZodCheckOverwrite",(t,e)=>{te.init(t,e),t._zod.check=n=>{n.value=e.tx(n.value)}});class J0{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const i=e.split(`
`).filter(o=>o),r=Math.min(...i.map(o=>o.length-o.trimStart().length)),s=i.map(o=>o.slice(r)).map(o=>" ".repeat(this.indent*2)+o);for(const o of s)this.content.push(o)}compile(){const e=Function,n=this?.args,r=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...n,r.join(`
`))}}const tg={major:4,minor:1,patch:13},Nt=Z("$ZodType",(t,e)=>{var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=tg;const i=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&i.unshift(t);for(const r of i)for(const s of r._zod.onattach)s(t);if(i.length===0)(n=t._zod).deferred??(n.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const r=(o,a,l)=>{let c=Sn(o),h;for(const g of a){if(g._zod.def.when){if(!g._zod.def.when(o))continue}else if(c)continue;const f=o.issues.length,d=g._zod.check(o);if(d instanceof Promise&&l?.async===!1)throw new vn;if(h||d instanceof Promise)h=(h??Promise.resolve()).then(async()=>{await d,o.issues.length!==f&&(c||(c=Sn(o,f)))});else{if(o.issues.length===f)continue;c||(c=Sn(o,f))}}return h?h.then(()=>o):o},s=(o,a,l)=>{if(Sn(o))return o.aborted=!0,o;const c=r(a,i,l);if(c instanceof Promise){if(l.async===!1)throw new vn;return c.then(h=>t._zod.parse(h,l))}return t._zod.parse(c,l)};t._zod.run=(o,a)=>{if(a.skipChecks)return t._zod.parse(o,a);if(a.direction==="backward"){const c=t._zod.parse({value:o.value,issues:[]},{...a,skipChecks:!0});return c instanceof Promise?c.then(h=>s(h,o,a)):s(c,o,a)}const l=t._zod.parse(o,a);if(l instanceof Promise){if(a.async===!1)throw new vn;return l.then(c=>r(c,i,a))}return r(l,i,a)}}t["~standard"]={validate:r=>{try{const s=s0(t,r);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return o0(t,r).then(o=>o.success?{value:o.data}:{issues:o.error?.issues})}},vendor:"zod",version:1}}),Us=Z("$ZodString",(t,e)=>{Nt.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??F0(t._zod.bag),t._zod.parse=(n,i)=>{if(e.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:t}),n}}),It=Z("$ZodStringFormat",(t,e)=>{wr.init(t,e),Us.init(t,e)}),eg=Z("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=w0),It.init(t,e)}),ng=Z("$ZodUUID",(t,e)=>{if(e.version){const i={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(i===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=fc(i))}else e.pattern??(e.pattern=fc());It.init(t,e)}),ig=Z("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=x0),It.init(t,e)}),rg=Z("$ZodURL",(t,e)=>{It.init(t,e),t._zod.check=n=>{try{const i=n.value.trim(),r=new URL(i);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(r.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:e.hostname.source,input:n.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(r.protocol.endsWith(":")?r.protocol.slice(0,-1):r.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:t,continue:!e.abort})),e.normalize?n.value=r.href:n.value=i;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:t,continue:!e.abort})}}}),sg=Z("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=P0()),It.init(t,e)}),og=Z("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=b0),It.init(t,e)}),ag=Z("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=p0),It.init(t,e)}),lg=Z("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=m0),It.init(t,e)}),cg=Z("$ZodULID",(t,e)=>{e.pattern??(e.pattern=_0),It.init(t,e)}),hg=Z("$ZodXID",(t,e)=>{e.pattern??(e.pattern=v0),It.init(t,e)}),ug=Z("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=y0),It.init(t,e)}),dg=Z("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=O0(e)),It.init(t,e)}),fg=Z("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=M0),It.init(t,e)}),gg=Z("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=I0(e)),It.init(t,e)}),pg=Z("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=S0),It.init(t,e)}),mg=Z("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=T0),It.init(t,e),t._zod.bag.format="ipv4"}),_g=Z("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=k0),It.init(t,e),t._zod.bag.format="ipv6",t._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:t,continue:!e.abort})}}}),vg=Z("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=E0),It.init(t,e)}),yg=Z("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=R0),It.init(t,e),t._zod.check=n=>{const i=n.value.split("/");try{if(i.length!==2)throw new Error;const[r,s]=i;if(!s)throw new Error;const o=Number(s);if(`${o}`!==s)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:t,continue:!e.abort})}}});function bc(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const bg=Z("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=A0),It.init(t,e),t._zod.bag.contentEncoding="base64",t._zod.check=n=>{bc(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:t,continue:!e.abort})}});function Sg(t){if(!gc.test(t))return!1;const e=t.replace(/[-_]/g,i=>i==="-"?"+":"/"),n=e.padEnd(Math.ceil(e.length/4)*4,"=");return bc(n)}const wg=Z("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=gc),It.init(t,e),t._zod.bag.contentEncoding="base64url",t._zod.check=n=>{Sg(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:t,continue:!e.abort})}}),xg=Z("$ZodE164",(t,e)=>{e.pattern??(e.pattern=N0),It.init(t,e)});function Cg(t,e=null){try{const n=t.split(".");if(n.length!==3)return!1;const[i]=n;if(!i)return!1;const r=JSON.parse(atob(i));return!("typ"in r&&r?.typ!=="JWT"||!r.alg||e&&(!("alg"in r)||r.alg!==e))}catch{return!1}}const Pg=Z("$ZodJWT",(t,e)=>{It.init(t,e),t._zod.check=n=>{Cg(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:t,continue:!e.abort})}}),Sc=Z("$ZodNumber",(t,e)=>{Nt.init(t,e),t._zod.pattern=t._zod.bag.pattern??z0,t._zod.parse=(n,i)=>{if(e.coerce)try{n.value=Number(n.value)}catch{}const r=n.value;if(typeof r=="number"&&!Number.isNaN(r)&&Number.isFinite(r))return n;const s=typeof r=="number"?Number.isNaN(r)?"NaN":Number.isFinite(r)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:r,inst:t,...s?{received:s}:{}}),n}}),Tg=Z("$ZodNumberFormat",(t,e)=>{$0.init(t,e),Sc.init(t,e)}),kg=Z("$ZodBoolean",(t,e)=>{Nt.init(t,e),t._zod.pattern=L0,t._zod.parse=(n,i)=>{if(e.coerce)try{n.value=!!n.value}catch{}const r=n.value;return typeof r=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:r,inst:t}),n}}),Eg=Z("$ZodUnknown",(t,e)=>{Nt.init(t,e),t._zod.parse=n=>n}),Rg=Z("$ZodNever",(t,e)=>{Nt.init(t,e),t._zod.parse=(n,i)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)});function wc(t,e,n){t.issues.length&&e.issues.push(...on(n,t.issues)),e.value[n]=t.value}const Ag=Z("$ZodArray",(t,e)=>{Nt.init(t,e),t._zod.parse=(n,i)=>{const r=n.value;if(!Array.isArray(r))return n.issues.push({expected:"array",code:"invalid_type",input:r,inst:t}),n;n.value=Array(r.length);const s=[];for(let o=0;o<r.length;o++){const a=r[o],l=e.element._zod.run({value:a,issues:[]},i);l instanceof Promise?s.push(l.then(c=>wc(c,n,o))):wc(l,n,o)}return s.length?Promise.all(s).then(()=>n):n}});function xr(t,e,n,i){t.issues.length&&e.issues.push(...on(n,t.issues)),t.value===void 0?n in i&&(e.value[n]=void 0):e.value[n]=t.value}function xc(t){const e=Object.keys(t.shape);for(const i of e)if(!t.shape?.[i]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${i}": expected a Zod schema`);const n=qf(t.shape);return{...t,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(n)}}function Cc(t,e,n,i,r,s){const o=[],a=r.keySet,l=r.catchall._zod,c=l.def.type;for(const h in e){if(a.has(h))continue;if(c==="never"){o.push(h);continue}const g=l.run({value:e[h],issues:[]},i);g instanceof Promise?t.push(g.then(f=>xr(f,n,h,e))):xr(g,n,h,e)}return o.length&&n.issues.push({code:"unrecognized_keys",keys:o,input:e,inst:s}),t.length?Promise.all(t).then(()=>n):n}const Ng=Z("$ZodObject",(t,e)=>{if(Nt.init(t,e),!Object.getOwnPropertyDescriptor(e,"shape")?.get){const a=e.shape;Object.defineProperty(e,"shape",{get:()=>{const l={...a};return Object.defineProperty(e,"shape",{value:l}),l}})}const i=vr(()=>xc(e));kt(t._zod,"propValues",()=>{const a=e.shape,l={};for(const c in a){const h=a[c]._zod;if(h.values){l[c]??(l[c]=new Set);for(const g of h.values)l[c].add(g)}}return l});const r=Ii,s=e.catchall;let o;t._zod.parse=(a,l)=>{o??(o=i.value);const c=a.value;if(!r(c))return a.issues.push({expected:"object",code:"invalid_type",input:c,inst:t}),a;a.value={};const h=[],g=o.shape;for(const f of o.keys){const p=g[f]._zod.run({value:c[f],issues:[]},l);p instanceof Promise?h.push(p.then(v=>xr(v,a,f,c))):xr(p,a,f,c)}return s?Cc(h,c,a,l,i.value,t):h.length?Promise.all(h).then(()=>a):a}}),Mg=Z("$ZodObjectJIT",(t,e)=>{Ng.init(t,e);const n=t._zod.parse,i=vr(()=>xc(e)),r=f=>{const d=new J0(["shape","payload","ctx"]),p=i.value,v=u=>{const _=ac(u);return`shape[${_}]._zod.run({ value: input[${_}], issues: [] }, ctx)`};d.write("const input = payload.value;");const w=Object.create(null);let x=0;for(const u of p.keys)w[u]=`key_${x++}`;d.write("const newResult = {};");for(const u of p.keys){const _=w[u],S=ac(u);d.write(`const ${_} = ${v(u)};`),d.write(`
        if (${_}.issues.length) {
          payload.issues = payload.issues.concat(${_}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${S}, ...iss.path] : [${S}]
          })));
        }
        
        
        if (${_}.value === undefined) {
          if (${S} in input) {
            newResult[${S}] = undefined;
          }
        } else {
          newResult[${S}] = ${_}.value;
        }
        
      `)}d.write("payload.value = newResult;"),d.write("return payload;");const m=d.compile();return(u,_)=>m(f,u,_)};let s;const o=Ii,a=!sc.jitless,c=a&&jf.value,h=e.catchall;let g;t._zod.parse=(f,d)=>{g??(g=i.value);const p=f.value;return o(p)?a&&c&&d?.async===!1&&d.jitless!==!0?(s||(s=r(e.shape)),f=s(f,d),h?Cc([],p,f,d,g,t):f):n(f,d):(f.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),f)}});function Pc(t,e,n,i){for(const s of t)if(s.issues.length===0)return e.value=s.value,e;const r=t.filter(s=>!Sn(s));return r.length===1?(e.value=r[0].value,r[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(s=>s.issues.map(o=>We(o,i,Ve())))}),e)}const Tc=Z("$ZodUnion",(t,e)=>{Nt.init(t,e),kt(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),kt(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),kt(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),kt(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){const r=e.options.map(s=>s._zod.pattern);return new RegExp(`^(${r.map(s=>Ds(s.source)).join("|")})$`)}});const n=e.options.length===1,i=e.options[0]._zod.run;t._zod.parse=(r,s)=>{if(n)return i(r,s);let o=!1;const a=[];for(const l of e.options){const c=l._zod.run({value:r.value,issues:[]},s);if(c instanceof Promise)a.push(c),o=!0;else{if(c.issues.length===0)return c;a.push(c)}}return o?Promise.all(a).then(l=>Pc(l,r,t,s)):Pc(a,r,t,s)}}),Ig=Z("$ZodDiscriminatedUnion",(t,e)=>{Tc.init(t,e);const n=t._zod.parse;kt(t._zod,"propValues",()=>{const r={};for(const s of e.options){const o=s._zod.propValues;if(!o||Object.keys(o).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(const[a,l]of Object.entries(o)){r[a]||(r[a]=new Set);for(const c of l)r[a].add(c)}}return r});const i=vr(()=>{const r=e.options,s=new Map;for(const o of r){const a=o._zod.propValues?.[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(o)}"`);for(const l of a){if(s.has(l))throw new Error(`Duplicate discriminator value "${String(l)}"`);s.set(l,o)}}return s});t._zod.parse=(r,s)=>{const o=r.value;if(!Ii(o))return r.issues.push({code:"invalid_type",expected:"object",input:o,inst:t}),r;const a=i.value.get(o?.[e.discriminator]);return a?a._zod.run(r,s):e.unionFallback?n(r,s):(r.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:e.discriminator,input:o,path:[e.discriminator],inst:t}),r)}}),Og=Z("$ZodIntersection",(t,e)=>{Nt.init(t,e),t._zod.parse=(n,i)=>{const r=n.value,s=e.left._zod.run({value:r,issues:[]},i),o=e.right._zod.run({value:r,issues:[]},i);return s instanceof Promise||o instanceof Promise?Promise.all([s,o]).then(([l,c])=>kc(n,l,c)):kc(n,s,o)}});function Bs(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(yn(t)&&yn(e)){const n=Object.keys(e),i=Object.keys(t).filter(s=>n.indexOf(s)!==-1),r={...t,...e};for(const s of i){const o=Bs(t[s],e[s]);if(!o.valid)return{valid:!1,mergeErrorPath:[s,...o.mergeErrorPath]};r[s]=o.data}return{valid:!0,data:r}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let i=0;i<t.length;i++){const r=t[i],s=e[i],o=Bs(r,s);if(!o.valid)return{valid:!1,mergeErrorPath:[i,...o.mergeErrorPath]};n.push(o.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function kc(t,e,n){if(e.issues.length&&t.issues.push(...e.issues),n.issues.length&&t.issues.push(...n.issues),Sn(t))return t;const i=Bs(e.value,n.value);if(!i.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(i.mergeErrorPath)}`);return t.value=i.data,t}const Fg=Z("$ZodTuple",(t,e)=>{Nt.init(t,e);const n=e.items;t._zod.parse=(i,r)=>{const s=i.value;if(!Array.isArray(s))return i.issues.push({input:s,inst:t,expected:"tuple",code:"invalid_type"}),i;i.value=[];const o=[],a=[...n].reverse().findIndex(h=>h._zod.optin!=="optional"),l=a===-1?0:n.length-a;if(!e.rest){const h=s.length>n.length,g=s.length<l-1;if(h||g)return i.issues.push({...h?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length},input:s,inst:t,origin:"array"}),i}let c=-1;for(const h of n){if(c++,c>=s.length&&c>=l)continue;const g=h._zod.run({value:s[c],issues:[]},r);g instanceof Promise?o.push(g.then(f=>Cr(f,i,c))):Cr(g,i,c)}if(e.rest){const h=s.slice(n.length);for(const g of h){c++;const f=e.rest._zod.run({value:g,issues:[]},r);f instanceof Promise?o.push(f.then(d=>Cr(d,i,c))):Cr(f,i,c)}}return o.length?Promise.all(o).then(()=>i):i}});function Cr(t,e,n){t.issues.length&&e.issues.push(...on(n,t.issues)),e.value[n]=t.value}const Dg=Z("$ZodRecord",(t,e)=>{Nt.init(t,e),t._zod.parse=(n,i)=>{const r=n.value;if(!yn(r))return n.issues.push({expected:"record",code:"invalid_type",input:r,inst:t}),n;const s=[],o=e.keyType._zod.values;if(o){n.value={};const a=new Set;for(const c of o)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){a.add(typeof c=="number"?c.toString():c);const h=e.valueType._zod.run({value:r[c],issues:[]},i);h instanceof Promise?s.push(h.then(g=>{g.issues.length&&n.issues.push(...on(c,g.issues)),n.value[c]=g.value})):(h.issues.length&&n.issues.push(...on(c,h.issues)),n.value[c]=h.value)}let l;for(const c in r)a.has(c)||(l=l??[],l.push(c));l&&l.length>0&&n.issues.push({code:"unrecognized_keys",input:r,inst:t,keys:l})}else{n.value={};for(const a of Reflect.ownKeys(r)){if(a==="__proto__")continue;const l=e.keyType._zod.run({value:a,issues:[]},i);if(l instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(l.issues.length){n.issues.push({code:"invalid_key",origin:"record",issues:l.issues.map(h=>We(h,i,Ve())),input:a,path:[a],inst:t}),n.value[l.value]=l.value;continue}const c=e.valueType._zod.run({value:r[a],issues:[]},i);c instanceof Promise?s.push(c.then(h=>{h.issues.length&&n.issues.push(...on(a,h.issues)),n.value[l.value]=h.value})):(c.issues.length&&n.issues.push(...on(a,c.issues)),n.value[l.value]=c.value)}}return s.length?Promise.all(s).then(()=>n):n}}),zg=Z("$ZodEnum",(t,e)=>{Nt.init(t,e);const n=Vf(e.entries),i=new Set(n);t._zod.values=i,t._zod.pattern=new RegExp(`^(${n.filter(r=>Zf.has(typeof r)).map(r=>typeof r=="string"?bn(r):r.toString()).join("|")})$`),t._zod.parse=(r,s)=>{const o=r.value;return i.has(o)||r.issues.push({code:"invalid_value",values:n,input:o,inst:t}),r}}),Lg=Z("$ZodLiteral",(t,e)=>{if(Nt.init(t,e),e.values.length===0)throw new Error("Cannot create literal schema with no valid values");const n=new Set(e.values);t._zod.values=n,t._zod.pattern=new RegExp(`^(${e.values.map(i=>typeof i=="string"?bn(i):i?bn(i.toString()):String(i)).join("|")})$`),t._zod.parse=(i,r)=>{const s=i.value;return n.has(s)||i.issues.push({code:"invalid_value",values:e.values,input:s,inst:t}),i}}),Gg=Z("$ZodTransform",(t,e)=>{Nt.init(t,e),t._zod.parse=(n,i)=>{if(i.direction==="backward")throw new rc(t.constructor.name);const r=e.transform(n.value,n);if(i.async)return(r instanceof Promise?r:Promise.resolve(r)).then(o=>(n.value=o,n));if(r instanceof Promise)throw new vn;return n.value=r,n}});function Ec(t,e){return t.issues.length&&e===void 0?{issues:[],value:void 0}:t}const Ug=Z("$ZodOptional",(t,e)=>{Nt.init(t,e),t._zod.optin="optional",t._zod.optout="optional",kt(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),kt(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${Ds(n.source)})?$`):void 0}),t._zod.parse=(n,i)=>{if(e.innerType._zod.optin==="optional"){const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>Ec(s,n.value)):Ec(r,n.value)}return n.value===void 0?n:e.innerType._zod.run(n,i)}}),Bg=Z("$ZodNullable",(t,e)=>{Nt.init(t,e),kt(t._zod,"optin",()=>e.innerType._zod.optin),kt(t._zod,"optout",()=>e.innerType._zod.optout),kt(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${Ds(n.source)}|null)$`):void 0}),kt(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(n,i)=>n.value===null?n:e.innerType._zod.run(n,i)}),$g=Z("$ZodDefault",(t,e)=>{Nt.init(t,e),t._zod.optin="optional",kt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,i)=>{if(i.direction==="backward")return e.innerType._zod.run(n,i);if(n.value===void 0)return n.value=e.defaultValue,n;const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>Rc(s,e)):Rc(r,e)}});function Rc(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const Vg=Z("$ZodPrefault",(t,e)=>{Nt.init(t,e),t._zod.optin="optional",kt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,i)=>(i.direction==="backward"||n.value===void 0&&(n.value=e.defaultValue),e.innerType._zod.run(n,i))}),Hg=Z("$ZodNonOptional",(t,e)=>{Nt.init(t,e),kt(t._zod,"values",()=>{const n=e.innerType._zod.values;return n?new Set([...n].filter(i=>i!==void 0)):void 0}),t._zod.parse=(n,i)=>{const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>Ac(s,t)):Ac(r,t)}});function Ac(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const Wg=Z("$ZodCatch",(t,e)=>{Nt.init(t,e),kt(t._zod,"optin",()=>e.innerType._zod.optin),kt(t._zod,"optout",()=>e.innerType._zod.optout),kt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,i)=>{if(i.direction==="backward")return e.innerType._zod.run(n,i);const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(s=>(n.value=s.value,s.issues.length&&(n.value=e.catchValue({...n,error:{issues:s.issues.map(o=>We(o,i,Ve()))},input:n.value}),n.issues=[]),n)):(n.value=r.value,r.issues.length&&(n.value=e.catchValue({...n,error:{issues:r.issues.map(s=>We(s,i,Ve()))},input:n.value}),n.issues=[]),n)}}),jg=Z("$ZodPipe",(t,e)=>{Nt.init(t,e),kt(t._zod,"values",()=>e.in._zod.values),kt(t._zod,"optin",()=>e.in._zod.optin),kt(t._zod,"optout",()=>e.out._zod.optout),kt(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(n,i)=>{if(i.direction==="backward"){const s=e.out._zod.run(n,i);return s instanceof Promise?s.then(o=>Pr(o,e.in,i)):Pr(s,e.in,i)}const r=e.in._zod.run(n,i);return r instanceof Promise?r.then(s=>Pr(s,e.out,i)):Pr(r,e.out,i)}});function Pr(t,e,n){return t.issues.length?(t.aborted=!0,t):e._zod.run({value:t.value,issues:t.issues},n)}const Zg=Z("$ZodReadonly",(t,e)=>{Nt.init(t,e),kt(t._zod,"propValues",()=>e.innerType._zod.propValues),kt(t._zod,"values",()=>e.innerType._zod.values),kt(t._zod,"optin",()=>e.innerType?._zod?.optin),kt(t._zod,"optout",()=>e.innerType?._zod?.optout),t._zod.parse=(n,i)=>{if(i.direction==="backward")return e.innerType._zod.run(n,i);const r=e.innerType._zod.run(n,i);return r instanceof Promise?r.then(Nc):Nc(r)}});function Nc(t){return t.value=Object.freeze(t.value),t}const qg=Z("$ZodCustom",(t,e)=>{te.init(t,e),Nt.init(t,e),t._zod.parse=(n,i)=>n,t._zod.check=n=>{const i=n.value,r=e.fn(i);if(r instanceof Promise)return r.then(s=>Mc(s,n,i,t));Mc(r,n,i,t)}});function Mc(t,e,n,i){if(!t){const r={code:"custom",input:n,inst:i,path:[...i._zod.def.path??[]],continue:!i._zod.def.abort};i._zod.def.params&&(r.params=i._zod.def.params),e.issues.push(Oi(r))}}var Ic;class Kg{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...n){const i=n[0];if(this._map.set(e,i),i&&typeof i=="object"&&"id"in i){if(this._idmap.has(i.id))throw new Error(`ID ${i.id} already exists in the registry`);this._idmap.set(i.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const i={...this.get(n)??{}};delete i.id;const r={...i,...this._map.get(e)};return Object.keys(r).length?r:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function Yg(){return new Kg}(Ic=globalThis).__zod_globalRegistry??(Ic.__zod_globalRegistry=Yg());const Tr=globalThis.__zod_globalRegistry;function Xg(t,e){return new t({type:"string",...ht(e)})}function Qg(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...ht(e)})}function Oc(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...ht(e)})}function Jg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...ht(e)})}function tp(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ht(e)})}function ep(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ht(e)})}function np(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ht(e)})}function ip(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...ht(e)})}function rp(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...ht(e)})}function sp(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...ht(e)})}function op(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...ht(e)})}function ap(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...ht(e)})}function lp(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...ht(e)})}function cp(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...ht(e)})}function hp(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...ht(e)})}function up(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...ht(e)})}function dp(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...ht(e)})}function fp(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ht(e)})}function gp(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ht(e)})}function pp(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...ht(e)})}function mp(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...ht(e)})}function _p(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...ht(e)})}function vp(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...ht(e)})}function yp(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ht(e)})}function bp(t,e){return new t({type:"string",format:"date",check:"string_format",...ht(e)})}function Sp(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...ht(e)})}function wp(t,e){return new t({type:"string",format:"duration",check:"string_format",...ht(e)})}function xp(t,e){return new t({type:"number",checks:[],...ht(e)})}function Cp(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...ht(e)})}function Pp(t,e){return new t({type:"boolean",...ht(e)})}function Tp(t){return new t({type:"unknown"})}function kp(t,e){return new t({type:"never",...ht(e)})}function Fc(t,e){return new vc({check:"less_than",...ht(e),value:t,inclusive:!1})}function $s(t,e){return new vc({check:"less_than",...ht(e),value:t,inclusive:!0})}function Dc(t,e){return new yc({check:"greater_than",...ht(e),value:t,inclusive:!1})}function Vs(t,e){return new yc({check:"greater_than",...ht(e),value:t,inclusive:!0})}function zc(t,e){return new B0({check:"multiple_of",...ht(e),value:t})}function Lc(t,e){return new V0({check:"max_length",...ht(e),maximum:t})}function kr(t,e){return new H0({check:"min_length",...ht(e),minimum:t})}function Gc(t,e){return new W0({check:"length_equals",...ht(e),length:t})}function Ep(t,e){return new j0({check:"string_format",format:"regex",...ht(e),pattern:t})}function Rp(t){return new Z0({check:"string_format",format:"lowercase",...ht(t)})}function Ap(t){return new q0({check:"string_format",format:"uppercase",...ht(t)})}function Np(t,e){return new K0({check:"string_format",format:"includes",...ht(e),includes:t})}function Mp(t,e){return new Y0({check:"string_format",format:"starts_with",...ht(e),prefix:t})}function Ip(t,e){return new X0({check:"string_format",format:"ends_with",...ht(e),suffix:t})}function wn(t){return new Q0({check:"overwrite",tx:t})}function Op(t){return wn(e=>e.normalize(t))}function Fp(){return wn(t=>t.trim())}function Dp(){return wn(t=>t.toLowerCase())}function zp(){return wn(t=>t.toUpperCase())}function Lp(){return wn(t=>Wf(t))}function Gp(t,e,n){return new t({type:"array",element:e,...ht(n)})}function Up(t,e,n){return new t({type:"custom",check:"custom",fn:e,...ht(n)})}function Bp(t){const e=$p(n=>(n.addIssue=i=>{if(typeof i=="string")n.issues.push(Oi(i,n.value,e._zod.def));else{const r=i;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=e),r.continue??(r.continue=!e._zod.def.abort),n.issues.push(Oi(r))}},t(n.value,n)));return e}function $p(t,e){const n=new te({check:"custom",...ht(e)});return n._zod.check=t,n}const Vp=Z("ZodISODateTime",(t,e)=>{dg.init(t,e),Ft.init(t,e)});function Hp(t){return yp(Vp,t)}const Wp=Z("ZodISODate",(t,e)=>{fg.init(t,e),Ft.init(t,e)});function jp(t){return bp(Wp,t)}const Zp=Z("ZodISOTime",(t,e)=>{gg.init(t,e),Ft.init(t,e)});function qp(t){return Sp(Zp,t)}const Kp=Z("ZodISODuration",(t,e)=>{pg.init(t,e),Ft.init(t,e)});function Yp(t){return wp(Kp,t)}const le=Z("ZodError",(t,e)=>{uc.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:n=>r0(t,n)},flatten:{value:n=>i0(t,n)},addIssue:{value:n=>{t.issues.push(n),t.message=JSON.stringify(t.issues,Os,2)}},addIssues:{value:n=>{t.issues.push(...n),t.message=JSON.stringify(t.issues,Os,2)}},isEmpty:{get(){return t.issues.length===0}}})},{Parent:Error}),Xp=Ls(le),Qp=Gs(le),Jp=br(le),t1=Sr(le),e1=a0(le),n1=l0(le),i1=c0(le),r1=h0(le),s1=u0(le),o1=d0(le),a1=f0(le),l1=g0(le),Ot=Z("ZodType",(t,e)=>(Nt.init(t,e),t.def=e,t.type=e.type,Object.defineProperty(t,"_def",{value:e}),t.check=(...n)=>t.clone(sn(e,{checks:[...e.checks??[],...n.map(i=>typeof i=="function"?{_zod:{check:i,def:{check:"custom"},onattach:[]}}:i)]})),t.clone=(n,i)=>He(t,n,i),t.brand=()=>t,t.register=(n,i)=>(n.add(t,i),t),t.parse=(n,i)=>Xp(t,n,i,{callee:t.parse}),t.safeParse=(n,i)=>Jp(t,n,i),t.parseAsync=async(n,i)=>Qp(t,n,i,{callee:t.parseAsync}),t.safeParseAsync=async(n,i)=>t1(t,n,i),t.spa=t.safeParseAsync,t.encode=(n,i)=>e1(t,n,i),t.decode=(n,i)=>n1(t,n,i),t.encodeAsync=async(n,i)=>i1(t,n,i),t.decodeAsync=async(n,i)=>r1(t,n,i),t.safeEncode=(n,i)=>s1(t,n,i),t.safeDecode=(n,i)=>o1(t,n,i),t.safeEncodeAsync=async(n,i)=>a1(t,n,i),t.safeDecodeAsync=async(n,i)=>l1(t,n,i),t.refine=(n,i)=>t.check(i2(n,i)),t.superRefine=n=>t.check(r2(n)),t.overwrite=n=>t.check(wn(n)),t.optional=()=>Kc(t),t.nullable=()=>Yc(t),t.nullish=()=>Kc(Yc(t)),t.nonoptional=n=>Y1(t,n),t.array=()=>Ws(t),t.or=n=>O1([t,n]),t.and=n=>z1(t,n),t.transform=n=>Qc(t,H1(n)),t.default=n=>Z1(t,n),t.prefault=n=>K1(t,n),t.catch=n=>Q1(t,n),t.pipe=n=>Qc(t,n),t.readonly=()=>e2(t),t.describe=n=>{const i=t.clone();return Tr.add(i,{description:n}),i},Object.defineProperty(t,"description",{get(){return Tr.get(t)?.description},configurable:!0}),t.meta=(...n)=>{if(n.length===0)return Tr.get(t);const i=t.clone();return Tr.add(i,n[0]),i},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),Uc=Z("_ZodString",(t,e)=>{Us.init(t,e),Ot.init(t,e);const n=t._zod.bag;t.format=n.format??null,t.minLength=n.minimum??null,t.maxLength=n.maximum??null,t.regex=(...i)=>t.check(Ep(...i)),t.includes=(...i)=>t.check(Np(...i)),t.startsWith=(...i)=>t.check(Mp(...i)),t.endsWith=(...i)=>t.check(Ip(...i)),t.min=(...i)=>t.check(kr(...i)),t.max=(...i)=>t.check(Lc(...i)),t.length=(...i)=>t.check(Gc(...i)),t.nonempty=(...i)=>t.check(kr(1,...i)),t.lowercase=i=>t.check(Rp(i)),t.uppercase=i=>t.check(Ap(i)),t.trim=()=>t.check(Fp()),t.normalize=(...i)=>t.check(Op(...i)),t.toLowerCase=()=>t.check(Dp()),t.toUpperCase=()=>t.check(zp()),t.slugify=()=>t.check(Lp())}),c1=Z("ZodString",(t,e)=>{Us.init(t,e),Uc.init(t,e),t.email=n=>t.check(Qg(h1,n)),t.url=n=>t.check(ip(u1,n)),t.jwt=n=>t.check(vp(T1,n)),t.emoji=n=>t.check(rp(d1,n)),t.guid=n=>t.check(Oc(Bc,n)),t.uuid=n=>t.check(Jg(Er,n)),t.uuidv4=n=>t.check(tp(Er,n)),t.uuidv6=n=>t.check(ep(Er,n)),t.uuidv7=n=>t.check(np(Er,n)),t.nanoid=n=>t.check(sp(f1,n)),t.guid=n=>t.check(Oc(Bc,n)),t.cuid=n=>t.check(op(g1,n)),t.cuid2=n=>t.check(ap(p1,n)),t.ulid=n=>t.check(lp(m1,n)),t.base64=n=>t.check(pp(x1,n)),t.base64url=n=>t.check(mp(C1,n)),t.xid=n=>t.check(cp(_1,n)),t.ksuid=n=>t.check(hp(v1,n)),t.ipv4=n=>t.check(up(y1,n)),t.ipv6=n=>t.check(dp(b1,n)),t.cidrv4=n=>t.check(fp(S1,n)),t.cidrv6=n=>t.check(gp(w1,n)),t.e164=n=>t.check(_p(P1,n)),t.datetime=n=>t.check(Hp(n)),t.date=n=>t.check(jp(n)),t.time=n=>t.check(qp(n)),t.duration=n=>t.check(Yp(n))});function xn(t){return Xg(c1,t)}const Ft=Z("ZodStringFormat",(t,e)=>{It.init(t,e),Uc.init(t,e)}),h1=Z("ZodEmail",(t,e)=>{ig.init(t,e),Ft.init(t,e)}),Bc=Z("ZodGUID",(t,e)=>{eg.init(t,e),Ft.init(t,e)}),Er=Z("ZodUUID",(t,e)=>{ng.init(t,e),Ft.init(t,e)}),u1=Z("ZodURL",(t,e)=>{rg.init(t,e),Ft.init(t,e)}),d1=Z("ZodEmoji",(t,e)=>{sg.init(t,e),Ft.init(t,e)}),f1=Z("ZodNanoID",(t,e)=>{og.init(t,e),Ft.init(t,e)}),g1=Z("ZodCUID",(t,e)=>{ag.init(t,e),Ft.init(t,e)}),p1=Z("ZodCUID2",(t,e)=>{lg.init(t,e),Ft.init(t,e)}),m1=Z("ZodULID",(t,e)=>{cg.init(t,e),Ft.init(t,e)}),_1=Z("ZodXID",(t,e)=>{hg.init(t,e),Ft.init(t,e)}),v1=Z("ZodKSUID",(t,e)=>{ug.init(t,e),Ft.init(t,e)}),y1=Z("ZodIPv4",(t,e)=>{mg.init(t,e),Ft.init(t,e)}),b1=Z("ZodIPv6",(t,e)=>{_g.init(t,e),Ft.init(t,e)}),S1=Z("ZodCIDRv4",(t,e)=>{vg.init(t,e),Ft.init(t,e)}),w1=Z("ZodCIDRv6",(t,e)=>{yg.init(t,e),Ft.init(t,e)}),x1=Z("ZodBase64",(t,e)=>{bg.init(t,e),Ft.init(t,e)}),C1=Z("ZodBase64URL",(t,e)=>{wg.init(t,e),Ft.init(t,e)}),P1=Z("ZodE164",(t,e)=>{xg.init(t,e),Ft.init(t,e)}),T1=Z("ZodJWT",(t,e)=>{Pg.init(t,e),Ft.init(t,e)}),$c=Z("ZodNumber",(t,e)=>{Sc.init(t,e),Ot.init(t,e),t.gt=(i,r)=>t.check(Dc(i,r)),t.gte=(i,r)=>t.check(Vs(i,r)),t.min=(i,r)=>t.check(Vs(i,r)),t.lt=(i,r)=>t.check(Fc(i,r)),t.lte=(i,r)=>t.check($s(i,r)),t.max=(i,r)=>t.check($s(i,r)),t.int=i=>t.check(Vc(i)),t.safe=i=>t.check(Vc(i)),t.positive=i=>t.check(Dc(0,i)),t.nonnegative=i=>t.check(Vs(0,i)),t.negative=i=>t.check(Fc(0,i)),t.nonpositive=i=>t.check($s(0,i)),t.multipleOf=(i,r)=>t.check(zc(i,r)),t.step=(i,r)=>t.check(zc(i,r)),t.finite=()=>t;const n=t._zod.bag;t.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),t.isFinite=!0,t.format=n.format??null});function Ut(t){return xp($c,t)}const k1=Z("ZodNumberFormat",(t,e)=>{Tg.init(t,e),$c.init(t,e)});function Vc(t){return Cp(k1,t)}const E1=Z("ZodBoolean",(t,e)=>{kg.init(t,e),Ot.init(t,e)});function Hc(t){return Pp(E1,t)}const R1=Z("ZodUnknown",(t,e)=>{Eg.init(t,e),Ot.init(t,e)});function Hs(){return Tp(R1)}const A1=Z("ZodNever",(t,e)=>{Rg.init(t,e),Ot.init(t,e)});function N1(t){return kp(A1,t)}const M1=Z("ZodArray",(t,e)=>{Ag.init(t,e),Ot.init(t,e),t.element=e.element,t.min=(n,i)=>t.check(kr(n,i)),t.nonempty=n=>t.check(kr(1,n)),t.max=(n,i)=>t.check(Lc(n,i)),t.length=(n,i)=>t.check(Gc(n,i)),t.unwrap=()=>t.element});function Ws(t,e){return Gp(M1,t,e)}const I1=Z("ZodObject",(t,e)=>{Mg.init(t,e),Ot.init(t,e),kt(t,"shape",()=>e.shape),t.keyof=()=>Zc(Object.keys(t._zod.def.shape)),t.catchall=n=>t.clone({...t._zod.def,catchall:n}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Hs()}),t.loose=()=>t.clone({...t._zod.def,catchall:Hs()}),t.strict=()=>t.clone({...t._zod.def,catchall:N1()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=n=>Qf(t,n),t.safeExtend=n=>Jf(t,n),t.merge=n=>t0(t,n),t.pick=n=>Yf(t,n),t.omit=n=>Xf(t,n),t.partial=(...n)=>e0(qc,t,n[0]),t.required=(...n)=>n0(Xc,t,n[0])});function se(t,e){const n={type:"object",shape:t??{},...ht(e)};return new I1(n)}const Wc=Z("ZodUnion",(t,e)=>{Tc.init(t,e),Ot.init(t,e),t.options=e.options});function O1(t,e){return new Wc({type:"union",options:t,...ht(e)})}const F1=Z("ZodDiscriminatedUnion",(t,e)=>{Wc.init(t,e),Ig.init(t,e)});function jc(t,e,n){return new F1({type:"union",options:e,discriminator:t,...ht(n)})}const D1=Z("ZodIntersection",(t,e)=>{Og.init(t,e),Ot.init(t,e)});function z1(t,e){return new D1({type:"intersection",left:t,right:e})}const L1=Z("ZodTuple",(t,e)=>{Fg.init(t,e),Ot.init(t,e),t.rest=n=>t.clone({...t._zod.def,rest:n})});function G1(t,e,n){const i=e instanceof Nt,r=i?n:e,s=i?e:null;return new L1({type:"tuple",items:t,rest:s,...ht(r)})}const U1=Z("ZodRecord",(t,e)=>{Dg.init(t,e),Ot.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function B1(t,e,n){return new U1({type:"record",keyType:t,valueType:e,...ht(n)})}const js=Z("ZodEnum",(t,e)=>{zg.init(t,e),Ot.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));t.extract=(i,r)=>{const s={};for(const o of i)if(n.has(o))s[o]=e.entries[o];else throw new Error(`Key ${o} not found in enum`);return new js({...e,checks:[],...ht(r),entries:s})},t.exclude=(i,r)=>{const s={...e.entries};for(const o of i)if(n.has(o))delete s[o];else throw new Error(`Key ${o} not found in enum`);return new js({...e,checks:[],...ht(r),entries:s})}});function Zc(t,e){const n=Array.isArray(t)?Object.fromEntries(t.map(i=>[i,i])):t;return new js({type:"enum",entries:n,...ht(e)})}const $1=Z("ZodLiteral",(t,e)=>{Lg.init(t,e),Ot.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function Ie(t,e){return new $1({type:"literal",values:Array.isArray(t)?t:[t],...ht(e)})}const V1=Z("ZodTransform",(t,e)=>{Gg.init(t,e),Ot.init(t,e),t._zod.parse=(n,i)=>{if(i.direction==="backward")throw new rc(t.constructor.name);n.addIssue=s=>{if(typeof s=="string")n.issues.push(Oi(s,n.value,e));else{const o=s;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=n.value),o.inst??(o.inst=t),n.issues.push(Oi(o))}};const r=e.transform(n.value,n);return r instanceof Promise?r.then(s=>(n.value=s,n)):(n.value=r,n)}});function H1(t){return new V1({type:"transform",transform:t})}const qc=Z("ZodOptional",(t,e)=>{Ug.init(t,e),Ot.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Kc(t){return new qc({type:"optional",innerType:t})}const W1=Z("ZodNullable",(t,e)=>{Bg.init(t,e),Ot.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Yc(t){return new W1({type:"nullable",innerType:t})}const j1=Z("ZodDefault",(t,e)=>{$g.init(t,e),Ot.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function Z1(t,e){return new j1({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():cc(e)}})}const q1=Z("ZodPrefault",(t,e)=>{Vg.init(t,e),Ot.init(t,e),t.unwrap=()=>t._zod.def.innerType});function K1(t,e){return new q1({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():cc(e)}})}const Xc=Z("ZodNonOptional",(t,e)=>{Hg.init(t,e),Ot.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Y1(t,e){return new Xc({type:"nonoptional",innerType:t,...ht(e)})}const X1=Z("ZodCatch",(t,e)=>{Wg.init(t,e),Ot.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function Q1(t,e){return new X1({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const J1=Z("ZodPipe",(t,e)=>{jg.init(t,e),Ot.init(t,e),t.in=e.in,t.out=e.out});function Qc(t,e){return new J1({type:"pipe",in:t,out:e})}const t2=Z("ZodReadonly",(t,e)=>{Zg.init(t,e),Ot.init(t,e),t.unwrap=()=>t._zod.def.innerType});function e2(t){return new t2({type:"readonly",innerType:t})}const n2=Z("ZodCustom",(t,e)=>{qg.init(t,e),Ot.init(t,e)});function i2(t,e={}){return Up(n2,t,e)}function r2(t){return Bp(t)}const Jc=Zc(["notes","selection","playhead","viewport","grid","other"]),th=B1(xn(),Hs()).optional(),s2=se({id:xn().optional(),pitch:Ut().int().min(0).max(127),position:Ut(),duration:Ut().positive(),velocity:Ut().int().min(0).max(127).optional(),metadata:th}),o2=se({id:xn(),pitch:Ut().int().min(0).max(127),position:Ut(),duration:Ut().positive(),velocity:Ut().int().min(0).max(127),metadata:th}),a2=se({type:Ie("setNotes"),notes:Ws(s2)}),l2=se({type:Ie("setLivePlayhead"),position:Ut().nonnegative()}),c2=se({type:Ie("fitZoomToNotes")}),h2=se({type:Ie("getPlayStartPosition"),requestId:xn().optional()}),u2=se({type:Ie("setConfig"),width:Ut().positive().optional(),height:Ut().positive().optional(),interactive:Hc().optional(),showControlPanel:Hc().optional()}),d2=jc("type",[a2,l2,c2,h2,u2]),f2=se({type:Ie("notesUpdate"),notes:Ws(G1([xn(),o2])),source:Jc.optional()}),g2=se({type:Ie("stateUpdate"),viewport:se({scrollX:Ut(),scrollY:Ut(),zoomX:Ut(),zoomY:Ut()}),grid:se({quarterNoteWidth:Ut(),noteHeight:Ut(),subdivision:Ut()}),source:Jc.optional()}),p2=se({type:Ie("playStartPositionResponse"),position:Ut(),requestId:xn().optional()}),m2=se({type:Ie("connectionReady")}),_2=jc("type",[f2,g2,p2,m2]);class v2{ws=null;reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;reconnectTimer=null;address;handlers={};constructor(e){this.address=e}setHandlers(e){this.handlers=e}connect(){if(this.ws?.readyState!==WebSocket.OPEN)try{this.ws=new WebSocket(this.address),this.ws.onopen=()=>{this.reconnectAttempts=0,this.send({type:"connectionReady"})},this.ws.onmessage=e=>{this.handleMessage(e.data)},this.ws.onclose=()=>{this.scheduleReconnect()},this.ws.onerror=()=>{}}catch{this.scheduleReconnect()}}scheduleReconnect(){this.reconnectAttempts>=this.maxReconnectAttempts||(this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.reconnectAttempts++,this.connect()},this.reconnectDelay*Math.pow(2,this.reconnectAttempts)))}handleMessage(e){let n;try{n=JSON.parse(e)}catch{console.warn("[PianoRollWS] Invalid JSON received:",e);return}const i=d2.safeParse(n);if(!i.success){console.warn("[PianoRollWS] Invalid message format:",i.error.format());return}const r=i.data;switch(r.type){case"setNotes":this.handlers.onSetNotes?.(r.notes);break;case"setLivePlayhead":this.handlers.onSetLivePlayhead?.(r.position);break;case"fitZoomToNotes":this.handlers.onFitZoomToNotes?.();break;case"getPlayStartPosition":this.handlers.onGetPlayStartPosition?.(r.requestId);break;case"setConfig":this.handlers.onSetConfig?.({width:r.width,height:r.height,interactive:r.interactive,showControlPanel:r.showControlPanel});break}}send(e){if(this.ws?.readyState!==WebSocket.OPEN)return;const n=_2.safeParse(e);if(!n.success){console.warn("[PianoRollWS] Invalid outgoing message:",n.error.format());return}this.ws.send(JSON.stringify(e))}sendNotesUpdate(e,n){this.send({type:"notesUpdate",notes:e,source:n})}sendStateUpdate(e,n){this.send({type:"stateUpdate",viewport:{scrollX:e.viewport.scrollX,scrollY:e.viewport.scrollY,zoomX:e.viewport.zoomX,zoomY:e.viewport.zoomY},grid:{quarterNoteWidth:e.grid.quarterNoteWidth,noteHeight:e.grid.noteHeight,subdivision:e.grid.subdivision},source:n})}sendPlayStartPositionResponse(e,n){this.send({type:"playStartPositionResponse",position:e,requestId:n})}disconnect(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.onclose=null,this.ws.close(),this.ws=null)}get isConnected(){return this.ws?.readyState===WebSocket.OPEN}}const y2=(t="note_")=>`${t}${Date.now()}_${Math.random().toString(36).substr(2,9)}`;function eh(t,e){const{scrollX:n,scrollY:i}=e.viewport,{quarterNoteWidth:r,noteHeight:s}=e.grid,o=t.x+n,a=t.y+i,l=o/r;return{pitch:127-Math.floor(a/s),position:l}}function Rr(t,e,n){const{scrollX:i,scrollY:r}=n.viewport,{quarterNoteWidth:s,noteHeight:o}=n.grid,a=e*s,l=(127-t)*o;return{x:a-i,y:l-r}}function nh(t,e){const n=e/4;return Math.floor(t*n)/n}function ih(t){return t.grid.quarterNoteWidth*(4/t.grid.subdivision)}function rh(t,e){const{scrollX:n,scrollY:i}=e.viewport,{quarterNoteWidth:r,noteHeight:s}=e.grid,o=e.stage;if(!o)return!1;const a=o.width(),l=o.height(),c=n/r,h=(n+a)/r,g=Math.floor(i/s),f=Math.ceil((i+l)/s),d=t.position+t.duration,p=127-t.pitch;return!(d<c||t.position>h||p<g||p>f)}function b2(t,e){const{scrollX:n,scrollY:i}=t.viewport,{quarterNoteWidth:r,noteHeight:s}=t.grid,o=[];return t.notes.forEach((a,l)=>{const c=Rr(a.pitch,a.position,t),h=a.duration*r,g=c.x+h,f=c.y+s,d=e.x+e.width,p=e.y+e.height;!(g<e.x||c.x>d||f<e.y||c.y>p)&&o.push(l)}),o}function sh(t,e){const n=new Set(e);if(n.size===0)return t.interaction.createEmptyOverlapAdjustments();const i=new Set,r=new Map;return n.forEach(s=>{const o=t.notes.get(s);if(!o)return;const a=o.position+o.duration;t.notes.forEach((l,c)=>{if(n.has(c)||l.pitch!==o.pitch)return;const h=l.position+l.duration;if(l.position<o.position&&o.position<h){const g=o.position-l.position;g>0?i.has(c)||r.set(c,g):(i.add(c),r.delete(c))}else o.position<=l.position&&l.position<a&&(i.add(c),r.delete(c))})}),i.size===0&&r.size===0?t.interaction.createEmptyOverlapAdjustments():{toDelete:i,toTruncate:r}}function oh(t){t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear();const e=sh(t,t.selection.selectedIds);e.toDelete.forEach(n=>t.interaction.hiddenNoteIds.add(n)),e.toTruncate.forEach((n,i)=>t.interaction.truncatedNotes.set(i,n))}function S2(t,e,n){return t.interaction.truncatedNotes.get(e)??n}function Zs(t,e){let n=null,i=!1;if(!e&&(t.interaction.hiddenNoteIds.size>0||t.interaction.truncatedNotes.size>0))n={toDelete:new Set(t.interaction.hiddenNoteIds),toTruncate:new Map(t.interaction.truncatedNotes)},i=!0;else{const r=e??t.selection.selectedIds;n=sh(t,r)}return n.toDelete.size===0&&n.toTruncate.size===0?(i||(t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear()),n):(n.toDelete.forEach(r=>{t.notes.delete(r),t.selection.selectedIds.delete(r)}),n.toTruncate.forEach((r,s)=>{const o=t.notes.get(s);o&&(o.duration=Math.max(r,0))}),t.needsRedraw=!0,i||(t.interaction.hiddenNoteIds.clear(),t.interaction.truncatedNotes.clear()),n)}function ah(t){t.interaction.truncatedNotes.clear(),t.interaction.hiddenNoteIds.clear()}function w2(t){let n=null;for(const i of t.selection.selectedIds){const r=t.notes.get(i);if(!r)continue;let s=1/0,o=null;if(t.notes.forEach((a,l)=>{if(t.selection.selectedIds.has(l))return;const c=Math.abs(r.position-a.position);c<s&&c<.1&&(s=c,o=a.position)}),o!==null){n=o-r.position;break}}n!==null&&t.selection.selectedIds.forEach(i=>{const r=t.notes.get(i);r&&(r.position+=n)})}const x2=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function lh(t){return x2[t%12]+(Math.floor(t/12)-2)}class C2{constructor(e,n,i){this.captureState=e,this.restoreState=n,this.onChangeCallback=i}stack=[];currentIndex=-1;onChangeCallback;executeCommand(e,n){const i=this.captureState();n();const r=this.captureState();i!==r&&this.pushCommand(e,i,r)}pushCommand(e,n,i){this.stack=this.stack.slice(0,this.currentIndex+1),this.stack.push({name:e,beforeState:n,afterState:i}),this.currentIndex++,this.onChangeCallback?.()}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.stack.length-1}undo(){if(!this.canUndo())return;const e=this.stack[this.currentIndex];this.restoreState(e.beforeState),this.currentIndex--,this.onChangeCallback?.()}redo(){if(!this.canRedo())return;this.currentIndex++;const e=this.stack[this.currentIndex];this.restoreState(e.afterState),this.onChangeCallback?.()}clear(){this.stack=[],this.currentIndex=-1,this.onChangeCallback?.()}}function Fi(t){return JSON.stringify({notes:Array.from(t.notes.entries()),selection:Array.from(t.selection.selectedIds)})}function P2(t,e){const n=JSON.parse(e);t.notes=new Map(n.notes),t.selection.selectedIds=new Set(n.selection),t.needsRedraw=!0}function T2(t,e){if(t.size!==e.size)return!0;for(const n of t)if(!e.has(n))return!0;return!1}function qs(t,e){const n=new Set(t.selection.selectedIds);e();const i=T2(n,t.selection.selectedIds);return i&&t.notifyExternalChange?.("selection"),i}function k2(t,e,n){const i=new jt.Layer({listening:!1,name:"grid-layer"});e.add(i),t.layers.grid=i;const r=new jt.Layer({name:"notes-layer"});e.add(r),t.layers.notes=r;const s=new jt.Layer({name:"overlay-layer"});e.add(s),t.layers.overlay=s,t.selection.selectionRect=new jt.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),s.add(t.selection.selectionRect);const o=128*t.grid.noteHeight;t.queuePlayhead.element=new jt.Line({points:[0,0,0,o],stroke:"#00ff00",strokeWidth:2,listening:!1}),s.add(t.queuePlayhead.element),t.livePlayhead.element=new jt.Line({points:[0,0,0,o],stroke:"#ff8800",strokeWidth:2,listening:!1}),s.add(t.livePlayhead.element),t.command.stack=new C2(()=>Fi(t),a=>P2(t,a),()=>{t.needsRedraw=!0,n?.()})}function E2(t){const e=t.layers.grid;if(!e||!t.stage)return;const n=t.renderCache.grid;if(n.lastScrollX===t.viewport.scrollX&&n.lastScrollY===t.viewport.scrollY&&n.lastSubdivision===t.grid.subdivision&&n.lastQuarterNoteWidth===t.grid.quarterNoteWidth&&n.lastNoteHeight===t.grid.noteHeight)return;n.lastScrollX=t.viewport.scrollX,n.lastScrollY=t.viewport.scrollY,n.lastSubdivision=t.grid.subdivision,n.lastQuarterNoteWidth=t.grid.quarterNoteWidth,n.lastNoteHeight=t.grid.noteHeight,e.destroyChildren();const{scrollX:i,scrollY:r}=t.viewport,{quarterNoteWidth:s,noteHeight:o,numMeasures:a,timeSignature:l}=t.grid,c=t.stage,h=c.width(),g=c.height(),f=128*o,d=l*4,p=s*d,v=Math.floor(i/p),w=Math.ceil((i+h)/p);for(let O=v;O<=w&&O<a;O++){const b=O%2===0?t.grid.backgroundColor1:t.grid.backgroundColor2,C=O*p-i;e.add(new jt.Rect({x:C,y:-r,width:p,height:f,fill:b,listening:!1}))}const x=a*d*(t.grid.subdivision/4),m=s*(4/t.grid.subdivision),u=Math.floor(i/m),_=Math.ceil((i+h)/m);for(let O=u;O<=_&&O<x;O++){const b=O*m-i,T=O*m%s===0?1.8:1;e.add(new jt.Line({points:[b,-r,b,f-r],stroke:"#000",strokeWidth:T,listening:!1}))}const S=Math.floor(r/o),k=Math.ceil((r+g)/o);for(let O=S;O<=k&&O<128;O++){const b=O*o-r;e.add(new jt.Line({points:[0-i,b,a*p-i,b],stroke:"#000",strokeWidth:1,listening:!1}))}e.batchDraw()}function R2(t){const e=t.layers.notes;if(!e||!t.stage)return;e.destroyChildren();const{scrollX:n,scrollY:i}=t.viewport,{quarterNoteWidth:r,noteHeight:s}=t.grid,o=[],a=[];t.notes.forEach((l,c)=>{rh(l,t)&&(t.selection.selectedIds.has(c)?a.push([c,l]):o.push([c,l]))}),o.forEach(([l,c])=>{const h=Rr(c.pitch,c.position,t),f=S2(t,l,c.duration)*r,d=t.interaction.hiddenNoteIds.has(l),p=new jt.Rect({x:h.x,y:h.y,width:f,height:s,fill:t.grid.noteColor,stroke:"#000",strokeWidth:1,opacity:d?.3:1,listening:!0});p.setAttr("noteId",l),e.add(p);const v=lh(c.pitch),w=new jt.Text({x:h.x+4,y:h.y+2,text:v,fontSize:14,fill:"#000",listening:!1});e.add(w)}),a.forEach(([l,c])=>{const h=Rr(c.pitch,c.position,t),g=c.duration*r,f=t.interaction.hiddenNoteIds.has(l),d=new jt.Rect({x:h.x,y:h.y,width:g,height:s,fill:t.grid.selectedNoteColor,stroke:"#000",strokeWidth:1,opacity:f?.3:1,listening:!0});d.setAttr("noteId",l),e.add(d);const p=lh(c.pitch),v=new jt.Text({x:h.x+4,y:h.y+2,text:p,fontSize:14,fill:"#000",listening:!1});e.add(v)}),e.batchDraw()}function A2(t){const e=t.layers.notes;if(!e)return;const{quarterNoteWidth:n,noteHeight:i}=t.grid,r=5;e.find(".resize-handle").forEach(s=>s.destroy()),t.selection.selectedIds.forEach(s=>{const o=t.notes.get(s);if(!o||!rh(o,t))return;const a=Rr(o.pitch,o.position,t),l=o.duration*n,c=new jt.Circle({x:a.x,y:a.y+i/2,radius:r,fill:"#000",listening:!0,name:"resize-handle"});c.setAttr("handleNoteId",s),c.setAttr("handleIsEnd",!1),e.add(c);const h=new jt.Circle({x:a.x+l,y:a.y+i/2,radius:r,fill:"#000",listening:!0,name:"resize-handle"});h.setAttr("handleNoteId",s),h.setAttr("handleIsEnd",!0),e.add(h)}),e.batchDraw()}function N2(t){if(!t.selection.selectionRect||!t.interaction.marqueeStart||!t.interaction.marqueeCurrent)return;const e=t.interaction.marqueeStart,n=t.interaction.marqueeCurrent,i=Math.min(e.x,n.x),r=Math.min(e.y,n.y),s=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y);t.selection.selectionRect.setAttrs({x:i,y:r,width:s,height:o,visible:s>5||o>5}),t.layers.overlay?.batchDraw()}function M2(t){if(!t.queuePlayhead.element)return;const{scrollX:e}=t.viewport,n=t.queuePlayhead.position*t.grid.quarterNoteWidth-e;t.queuePlayhead.element.x(n),t.layers.overlay?.batchDraw()}function I2(t){if(!t.livePlayhead.element)return;const{scrollX:e}=t.viewport,n=t.livePlayhead.position*t.grid.quarterNoteWidth-e;t.livePlayhead.element.x(n),t.layers.overlay?.batchDraw()}function O2(t,e){t.layers.notes;const n=t.layers.grid;e.on("dblclick",i=>{if(i.target===e||i.target.getLayer()===n){const r=e.getPointerPosition();if(!r)return;const{pitch:s,position:o}=eh(r,t),a=nh(o,t.grid.subdivision),l=Math.round(s);t.command.stack?.executeCommand("Add Note",()=>{const c={id:y2(),pitch:l,position:a,duration:4/t.grid.subdivision,velocity:.8};t.notes.set(c.id,c),t.needsRedraw=!0})}}),e.on("mousedown touchstart",i=>{const r=i.target,s=r.getAttr?.("handleNoteId");if(s){const a=r.getAttr("handleIsEnd");L2(t,e,s,a);return}const o=r.getAttr?.("noteId");if(o){const a=i.evt.shiftKey||i.evt.ctrlKey,l=t.selection.selectedIds.has(o);qs(t,()=>{a?l?t.selection.selectedIds.delete(o):t.selection.selectedIds.add(o):l||(t.selection.selectedIds.clear(),t.selection.selectedIds.add(o))}),F2(t,e),t.needsRedraw=!0;return}if(r===e||r.getLayer()===n){const a=e.getPointerPosition();if(!a)return;t.interaction.isMarqueeSelecting=!0,t.interaction.marqueeStart=a,t.interaction.marqueeCurrent=a,t.interaction.marqueeIsShift=i.evt.shiftKey||i.evt.ctrlKey,t.interaction.marqueeIsShift||qs(t,()=>{t.selection.selectedIds.clear()}),t.needsRedraw=!0}}),e.on("mousemove touchmove",i=>{const r=e.getPointerPosition();if(r){if(t.interaction.isDragging){D2(t,e);return}if(t.interaction.isResizing){G2(t,e);return}if(t.interaction.isMarqueeSelecting){t.interaction.marqueeCurrent=r,N2(t);const s={x:Math.min(t.interaction.marqueeStart.x,r.x),y:Math.min(t.interaction.marqueeStart.y,r.y),width:Math.abs(r.x-t.interaction.marqueeStart.x),height:Math.abs(r.y-t.interaction.marqueeStart.y)},o=b2(t,s);qs(t,()=>{t.interaction.marqueeIsShift?o.forEach(a=>{t.selection.selectedIds.add(a)}):(t.selection.selectedIds.clear(),o.forEach(a=>{t.selection.selectedIds.add(a)}))}),t.needsRedraw=!0}}}),e.on("mouseup touchend",i=>{if(t.interaction.isDragging){z2(t);return}if(t.interaction.isResizing){U2(t);return}if(t.interaction.isMarqueeSelecting){const r=t.interaction.marqueeStart&&t.interaction.marqueeCurrent&&Math.abs(t.interaction.marqueeStart.x-t.interaction.marqueeCurrent.x)<5&&Math.abs(t.interaction.marqueeStart.y-t.interaction.marqueeCurrent.y)<5;if(t.interaction.isMarqueeSelecting=!1,t.selection.selectionRect&&(t.selection.selectionRect.visible(!1),t.layers.overlay?.batchDraw()),r&&i.target===e||i.target.getLayer()===n){const s=e.getPointerPosition();if(s){const{position:o}=eh(s,t),a=nh(o,t.grid.subdivision);t.queuePlayhead.position=Math.max(0,Math.min(a,t.grid.maxLength)),t.needsRedraw=!0,t.notifyExternalChange?.("playhead")}}}})}function F2(t,e){const n=e.getPointerPosition();n&&(t.interaction.isDragging=!0,t.interaction.dragStartPos=n,t.interaction.quantDragActivated=!1,t.interaction.dragBeforeState=Fi(t),t.interaction.draggedNoteInitialStates.clear(),t.selection.selectedIds.forEach(i=>{const r=t.notes.get(i);r&&t.interaction.draggedNoteInitialStates.set(i,{position:r.position,pitch:r.pitch})}))}function D2(t,e){const n=e.getPointerPosition();if(!n||!t.interaction.dragStartPos)return;const i=n.x-t.interaction.dragStartPos.x,r=n.y-t.interaction.dragStartPos.y,s=ih(t);let o;Math.abs(i)<s*.9&&!t.interaction.quantDragActivated?o=i:(o=Math.round(i/s)*s,t.interaction.quantDragActivated=!0);const a=Math.round(r/t.grid.noteHeight);t.interaction.draggedNoteInitialStates.forEach((l,c)=>{const h=t.notes.get(c);h&&(h.position=l.position+o/t.grid.quarterNoteWidth,h.pitch=Math.max(0,Math.min(127,l.pitch-a)))}),w2(t),oh(t),t.needsRedraw=!0}function z2(t){Zs(t);const e=Fi(t);t.interaction.dragBeforeState&&t.interaction.dragBeforeState!==e&&t.command.stack?.pushCommand("Move Notes",t.interaction.dragBeforeState,e),t.interaction.isDragging=!1,ah(t),t.needsRedraw=!0}function L2(t,e,n,i){const r=e.getPointerPosition();r&&(t.interaction.isResizing=!0,t.interaction.resizeTargetId=n,t.interaction.resizeIsEnd=i,t.interaction.quantResizeActivated=!1,t.interaction.dragStartPos=r,t.interaction.resizeBeforeState=Fi(t),t.interaction.resizeInitialStates.clear(),t.selection.selectedIds.forEach(s=>{const o=t.notes.get(s);o&&t.interaction.resizeInitialStates.set(s,{position:o.position,duration:o.duration})}))}function G2(t,e){const n=e.getPointerPosition();if(!n||!t.interaction.dragStartPos)return;const i=n.x-t.interaction.dragStartPos.x,r=ih(t);let s;Math.abs(i)<r*.9&&!t.interaction.quantResizeActivated?s=i:(s=Math.round(i/r)*r,t.interaction.quantResizeActivated=!0);const o=s/t.grid.quarterNoteWidth;t.interaction.resizeInitialStates.forEach((a,l)=>{const c=t.notes.get(l);c&&(t.interaction.resizeIsEnd?c.duration=Math.max(.25,a.duration+o):(c.position=a.position+o,c.duration=Math.max(.25,a.duration-o)))}),oh(t),t.needsRedraw=!0}function U2(t){Zs(t);const e=Fi(t);t.interaction.resizeBeforeState&&t.interaction.resizeBeforeState!==e&&t.command.stack?.pushCommand("Resize Notes",t.interaction.resizeBeforeState,e),t.interaction.isResizing=!1,ah(t),t.needsRedraw=!0}const Cn=.25,Pn=1,Qt=128,ch=4,hh=12,B2=55,Et=(t,e,n)=>n<e?e:Math.min(Math.max(t,e),n),Tn=(t,e)=>t.stage?.width()??e,kn=(t,e)=>t.stage?.height()??e,$2=t=>t.grid.maxLength*t.grid.quarterNoteWidth,V2=t=>Qt*t.grid.noteHeight,H2=(t,e)=>{t.grid.quarterNoteWidth=e,t.viewport.zoomX=e/t.grid.baseQuarterNoteWidth},W2=(t,e)=>{t.grid.noteHeight=e,t.viewport.zoomY=e/t.grid.baseNoteHeight},j2=(t,e)=>{const n=t.grid.quarterNoteWidth,i=Tn(t,e),r=n===0?0:t.viewport.scrollX/n,s=r+i/(n||1);return{startQuarter:r,endQuarter:s}},Z2=(t,e)=>{const n=t.grid.noteHeight,i=kn(t,e),r=n===0?0:t.viewport.scrollY/n,s=r+i/(n||1);return{topIndex:r,bottomIndex:s}},Ks=(t,e,n,i)=>{const r=Tn(t,e),s=kn(t,n),o=Math.max(0,$2(t)-r),a=Et(t.viewport.scrollX,0,o);a!==t.viewport.scrollX&&(t.viewport.scrollX=a,t.needsRedraw=!0,i());const l=Math.max(0,V2(t)-s),c=Et(t.viewport.scrollY,0,l);c!==t.viewport.scrollY&&(t.viewport.scrollY=c,t.needsRedraw=!0,i())},Ys=(t,e,n,i,r,s)=>{if(!Number.isFinite(e)||e<=0)return;H2(t,e);const a=Tn(t,i)/t.grid.quarterNoteWidth,l=Math.max(0,t.grid.maxLength-a),c=Et(n,0,l);t.viewport.scrollX=c*t.grid.quarterNoteWidth,Ks(t,i,r,s),t.needsRedraw=!0,s()},Xs=(t,e,n,i,r,s)=>{if(!Number.isFinite(e)||e<=0)return;W2(t,e);const a=kn(t,r)/t.grid.noteHeight,l=Math.max(0,Qt-a),c=Et(n,0,l);t.viewport.scrollY=c*t.grid.noteHeight,Ks(t,i,r,s),t.needsRedraw=!0,s()},q2=(t,e,n,i)=>{const r=Tn(t,e),s=kn(t,n);if(r<=0||s<=0)return;const o=Array.from(t.notes.values());if(o.length===0){const D=r/ch;Ys(t,D,0,e,n,i);const L=hh,U=s/L,z=127-B2,K=Math.max(0,Qt-L),y=Et(z-(L-1),0,K);Xs(t,U,y,e,n,i);return}const a=o.reduce((A,D)=>Math.min(A,D.position),Number.POSITIVE_INFINITY),l=o.reduce((A,D)=>Math.max(A,D.position+D.duration),Number.NEGATIVE_INFINITY),c=Math.max(l-a,0),h=Math.max(c,ch),g=r/h,f=Math.max(0,t.grid.maxLength-h),d=Math.max(h-c,0),p=a-d/2,v=Et(p,0,f);Ys(t,g,v,e,n,i);const w=o.reduce((A,D)=>Math.max(A,D.pitch),Number.NEGATIVE_INFINITY),x=o.reduce((A,D)=>Math.min(A,D.pitch),Number.POSITIVE_INFINITY),m=127-w,u=127-x,_=Math.max(u-m+1,1),S=Math.max(_,hh),k=s/S,O=Math.max(S-_,0),b=m-O/2,C=Math.max(0,Qt-S),T=Et(b,0,C);Xs(t,k,T,e,n,i)};class K2{constructor(e){this.options=e}dragState=null;getThumbMetrics=()=>{const e=this.options.state.grid.maxLength;if(e<=0)return{start:0,size:1};const n=this.options.state.grid.quarterNoteWidth,i=Tn(this.options.state,this.options.getFallbackWidth());if(n<=0||i<=0)return{start:0,size:1};const r=this.options.state.viewport.scrollX/n,s=i/n,o=Math.min(1,s/e);if(o>=1)return{start:0,size:1};const a=r/e;return{start:Et(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:e,size:n}=this.getThumbMetrics(),i=Et(n,0,1),r=Math.min(1,Math.max(i,.01));return{left:`${Et(e,0,1-r)*100}%`,width:`${r*100}%`}};startDrag=(e,n)=>{if(!this.options.isInteractive())return;const i=this.options.horizontalTrack.value;if(!i)return;this.stopDrag();const r=i.getBoundingClientRect();if(r.width<=0)return;const{startQuarter:s,endQuarter:o}=this.options.getViewportRange(),a=Math.max(Cn,o-s),l=Tn(this.options.state,this.options.getFallbackWidth()),c=this.options.state.grid.maxLength;if(l<=0||c<=0)return;const h=s/c,g=o/c;let f=0;e==="resize-start"?f=n.clientX-(r.left+h*r.width):e==="resize-end"&&(f=n.clientX-(r.left+g*r.width)),this.dragState={mode:e,pointerId:n.pointerId,pointerStart:n.clientX,trackRect:r,startQuarter:s,endQuarter:o,anchorQuarter:e==="resize-start"?o:s,spanQuarter:a,stageWidth:l,pointerOffset:f},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),n.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=e=>{const n=this.dragState;if(!n||e.pointerId!==n.pointerId)return;const i=this.options.state.grid.maxLength,r=n.trackRect;if(i<=0||r.width<=0||n.stageWidth<=0)return;if(e.preventDefault(),n.mode==="move"){const c=(e.clientX-n.pointerStart)/r.width*i,h=Math.max(0,i-n.spanQuarter),g=Et(n.startQuarter+c,0,h);this.options.state.viewport.scrollX=g*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const s=Et(e.clientX,r.left,r.right),a=(Et(s-n.pointerOffset,r.left,r.right)-r.left)/r.width;if(n.mode==="resize-start"){let l=a*i;const c=n.anchorQuarter-Cn;l=Et(l,0,Math.max(0,c));const h=Math.max(Cn,n.anchorQuarter-l),g=n.stageWidth/h;this.options.applyHorizontalZoom(g,l),n.startQuarter=l,n.spanQuarter=h;return}if(n.mode==="resize-end"){let l=a*i;const c=n.anchorQuarter+Cn;l=Et(l,Math.min(c,i),i);const h=Math.max(Cn,l-n.anchorQuarter),g=n.stageWidth/h;this.options.applyHorizontalZoom(g,n.anchorQuarter),n.endQuarter=l,n.spanQuarter=h}};onTrackPointerDown=e=>{if(!this.options.isInteractive())return;const n=this.options.horizontalTrack.value;if(!n)return;const i=n.getBoundingClientRect();if(i.width<=0)return;const r=Et((e.clientX-i.left)/i.width,0,1),{startQuarter:s,endQuarter:o}=this.options.getViewportRange(),a=Math.max(Cn,o-s),l=this.options.state.grid.maxLength,c=Math.max(0,l-a),h=Et(r*l-a/2,0,c);this.options.state.viewport.scrollX=h*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}class Y2{constructor(e){this.options=e}dragState=null;getThumbMetrics=()=>{const e=Qt,n=this.options.state.grid.noteHeight,i=kn(this.options.state,this.options.getFallbackHeight());if(n<=0||i<=0)return{start:0,size:1};const r=this.options.state.viewport.scrollY/n,s=i/n,o=Math.min(1,s/e);if(o>=1)return{start:0,size:1};const a=r/e;return{start:Et(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:e,size:n}=this.getThumbMetrics(),i=Et(n,0,1),r=Math.min(1,Math.max(i,.01));return{top:`${Et(e,0,1-r)*100}%`,height:`${r*100}%`}};startDrag=(e,n)=>{if(!this.options.isInteractive())return;const i=this.options.verticalTrack.value;if(!i)return;this.stopDrag();const r=i.getBoundingClientRect();if(r.height<=0)return;const{topIndex:s,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(Pn,o-s),l=kn(this.options.state,this.options.getFallbackHeight());if(l<=0)return;const c=s/Qt,h=o/Qt;let g=0;e==="resize-start"?g=n.clientY-(r.top+c*r.height):e==="resize-end"&&(g=n.clientY-(r.top+h*r.height)),this.dragState={mode:e,pointerId:n.pointerId,pointerStart:n.clientY,trackRect:r,topIndex:s,bottomIndex:o,anchorIndex:e==="resize-start"?o:s,span:a,stageHeight:l,pointerOffset:g},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),n.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=e=>{const n=this.dragState;if(!n||e.pointerId!==n.pointerId)return;const i=n.trackRect;if(i.height<=0||n.stageHeight<=0)return;if(e.preventDefault(),n.mode==="move"){const l=(e.clientY-n.pointerStart)/i.height*Qt,c=Math.max(0,Qt-n.span),h=Et(n.topIndex+l,0,c);this.options.state.viewport.scrollY=h*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const r=Et(e.clientY,i.top,i.bottom),o=(Et(r-n.pointerOffset,i.top,i.bottom)-i.top)/i.height;if(n.mode==="resize-start"){let a=o*Qt;const l=n.anchorIndex-Pn;a=Et(a,0,Math.max(0,l));const c=Math.max(Pn,n.anchorIndex-a),h=n.stageHeight/c;this.options.applyVerticalZoom(h,a),n.topIndex=a,n.span=c;return}if(n.mode==="resize-end"){let a=o*Qt;const l=n.anchorIndex+Pn;a=Et(a,Math.min(l,Qt),Qt);const c=Math.max(Pn,a-n.anchorIndex),h=n.stageHeight/c;this.options.applyVerticalZoom(h,n.anchorIndex),n.bottomIndex=a,n.span=c}};onTrackPointerDown=e=>{if(!this.options.isInteractive())return;const n=this.options.verticalTrack.value;if(!n)return;const i=n.getBoundingClientRect();if(i.height<=0)return;const r=Et((e.clientY-i.top)/i.height,0,1),{topIndex:s,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(Pn,o-s),l=Math.max(0,Qt-a),c=Et(r*Qt-a/2,0,l);this.options.state.viewport.scrollY=c*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}const X2=({state:t,canUndo:e,canRedo:n,emitStateUpdate:i})=>{const r=()=>{e.value=t.command.stack?.canUndo()??!1,n.value=t.command.stack?.canRedo()??!1};return{undo:()=>{t.command.stack?.undo(),r()},redo:()=>{t.command.stack?.redo(),r()},deleteSelected:()=>{t.selection.selectedIds.size!==0&&(t.command.stack?.executeCommand("Delete Selected",()=>{t.selection.selectedIds.forEach(c=>t.notes.delete(c)),t.selection.selectedIds.clear(),t.needsRedraw=!0}),r())},updateCommandStackButtons:r,handleCommandStackUpdate:()=>{r(),i()}}},Q2=({state:t,isInteractive:e,undo:n,redo:i,deleteSelected:r,updateCommandStackButtons:s,executeOverlapChanges:o})=>{let a=!1;const l=g=>{if(e()){if((g.metaKey||g.ctrlKey)&&g.key==="z"&&!g.shiftKey){g.preventDefault(),n();return}if((g.metaKey||g.ctrlKey)&&g.key==="z"&&g.shiftKey){g.preventDefault(),i();return}if(g.key==="Backspace"||g.key==="Delete"){g.preventDefault(),r();return}if(g.key.startsWith("Arrow")&&t.selection.selectedIds.size>0){g.preventDefault(),t.command.stack?.executeCommand("Move Selection",()=>{t.selection.selectedIds.forEach(f=>{const d=t.notes.get(f);if(d)switch(g.key){case"ArrowUp":d.pitch=Math.min(127,d.pitch+1);break;case"ArrowDown":d.pitch=Math.max(0,d.pitch-1);break;case"ArrowLeft":d.position=Math.max(0,d.position-.25);break;case"ArrowRight":d.position+=.25;break}}),o(t,t.selection.selectedIds),t.needsRedraw=!0}),s();return}if((g.metaKey||g.ctrlKey)&&g.key==="c"&&t.selection.selectedIds.size>0){g.preventDefault();const f=Array.from(t.selection.selectedIds).map(p=>{const v=t.notes.get(p);return v?{...v}:null}).filter(p=>p!==null);if(f.length===0)return;const d=Math.min(...f.map(p=>p.position));sessionStorage.setItem("copiedPianoRollNotes",JSON.stringify({notes:f.map(p=>({...p,position:p.position-d}))}));return}if((g.metaKey||g.ctrlKey)&&g.key==="v"){g.preventDefault();const f=sessionStorage.getItem("copiedPianoRollNotes");if(!f)return;try{const{notes:d}=JSON.parse(f);t.command.stack?.executeCommand("Paste Notes",()=>{t.selection.selectedIds.clear(),d.forEach(p=>{const v={...p,id:`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,position:t.queuePlayhead.position+p.position};t.notes.set(v.id,v),t.selection.selectedIds.add(v.id)}),o(t,t.selection.selectedIds),t.needsRedraw=!0}),s()}catch(d){console.error("Failed to paste notes",d)}}}};return{attach:()=>{a||(window.addEventListener("keydown",l),a=!0)},detach:()=>{a&&(window.removeEventListener("keydown",l),a=!1)},isAttached:()=>a}};class J2{constructor(e){this.deps=e}eventHandlersInitialized=!1;keyboardAttached=!1;renderFrame=()=>{this.deps.state.needsRedraw&&(this.deps.renderGrid(this.deps.state),this.deps.renderVisibleNotes(this.deps.state),this.deps.renderResizeHandles(this.deps.state),this.deps.updateQueuePlayheadPosition(this.deps.state),this.deps.updateLivePlayheadPosition(this.deps.state),this.deps.state.needsRedraw=!1),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)};startRenderLoop(){this.stopRenderLoop(),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)}stopRenderLoop(){this.deps.state.rafHandle&&(cancelAnimationFrame(this.deps.state.rafHandle),this.deps.state.rafHandle=void 0)}enableInteractivity(){this.deps.state.stage&&(this.eventHandlersInitialized||(this.deps.setupEventHandlers(this.deps.state,this.deps.state.stage),this.eventHandlersInitialized=!0),this.deps.state.stage.listening(!0),this.keyboardAttached||(this.deps.attachKeyboard(),this.keyboardAttached=!0))}disableInteractivity(){this.deps.state.stage&&(this.deps.state.stage.listening(!1),this.deps.state.interaction.isDragging=!1,this.deps.state.interaction.isResizing=!1,this.deps.state.interaction.isMarqueeSelecting=!1,this.deps.state.selection.selectionRect?.visible(!1),this.keyboardAttached&&(this.deps.detachKeyboard(),this.keyboardAttached=!1),this.deps.state.layers.overlay?.batchDraw(),this.deps.syncUiCounters())}mount({width:e,height:n,interactive:i,initialNotes:r}){if(!this.deps.konvaContainer.value){console.error("Konva container ref not found");return}const s=new jt.Stage({container:this.deps.konvaContainer.value,width:e,height:n});this.deps.state.stage=s,this.deps.state.konvaContainer=this.deps.konvaContainer.value,this.deps.initializeLayers(this.deps.state,s,this.deps.handleCommandStackUpdate),i?this.enableInteractivity():this.disableInteractivity(),r.length>0&&(this.deps.state.notes=new Map(r),this.deps.state.needsRedraw=!0,this.deps.syncUiCounters()),this.startRenderLoop(),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds(),this.deps.handleCommandStackUpdate()}unmount(){this.stopRenderLoop(),this.disableInteractivity(),this.deps.state.stage?.destroy(),this.deps.state.stage=void 0,this.deps.state.konvaContainer=void 0,this.eventHandlersInitialized=!1}setInteractive(e){this.deps.state.stage&&(e?this.enableInteractivity():this.disableInteractivity())}resize(e,n){this.deps.state.stage&&(this.deps.state.stage.width(e),this.deps.state.stage.height(n),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds())}}const tm={key:0,class:"metadata-editor"},em={class:"header"},nm={key:0,class:"unsaved-indicator"},im={key:0},rm={class:"buttons"},sm=["disabled"],om=["disabled"],am={key:1,class:"warning"},lm=is({__name:"NoteMetadataEditor",props:{metadata:{type:null},visible:{type:Boolean},canEdit:{type:Boolean}},emits:["apply","cancel"],setup(t,{emit:e}){const n=t,i=e,r=qt(""),s=qt(""),o=Dt(()=>r.value!==s.value);Le(()=>[n.metadata,n.canEdit],([c,h])=>{if(h){const g=JSON.stringify(c??{},null,2);r.value=g,s.value=g}else r.value="",s.value=""},{immediate:!0,deep:!0});const a=()=>{try{const c=JSON.parse(r.value||"{}");i("apply",c),s.value=r.value}catch{alert("Invalid JSON format")}},l=()=>{r.value=s.value,i("cancel")};return(c,h)=>c.visible?(Ge(),tn("div",tm,[mt("div",em,[o.value?(Ge(),tn("div",nm,h[1]||(h[1]=[mt("span",{class:"dot"},null,-1),gs(" Unsaved changes ")]))):lr("",!0)]),c.canEdit?(Ge(),tn("div",im,[h[2]||(h[2]=mt("p",{class:"help"},"Edit the selected note metadata as JSON:",-1)),Ho(mt("textarea",{"onUpdate:modelValue":h[0]||(h[0]=g=>r.value=g),class:"textarea",placeholder:"{}"},null,512),[[Wd,r.value]]),mt("div",rm,[mt("button",{onClick:a,class:"btn save",disabled:!o.value}," Save ",8,sm),mt("button",{onClick:l,class:"btn cancel",disabled:!o.value}," Cancel ",8,om)])])):(Ge(),tn("div",am,h[3]||(h[3]=[mt("p",null,"Select exactly one note to edit its metadata.",-1)])))])):lr("",!0)}}),cm=".metadata-editor[data-v-18cfcf98]{background:#fff;border:1px solid #ddd;border-radius:6px;padding:6px 16px;margin-top:8px;box-shadow:0 1px 4px #0000001a;max-width:700px;font-size:15px}.header[data-v-18cfcf98]{display:flex;align-items:center;justify-content:space-between;margin-bottom:4px}.unsaved-indicator[data-v-18cfcf98]{display:flex;align-items:center;gap:6px;font-size:13px;color:#f39c12;font-weight:500}.dot[data-v-18cfcf98]{width:6px;height:6px;background:#f39c12;border-radius:50%;animation:pulse-18cfcf98 1.5s infinite}@keyframes pulse-18cfcf98{0%,to{opacity:1}50%{opacity:.5}}.help[data-v-18cfcf98]{margin:0 0 4px;color:#666;font-size:14px}.textarea[data-v-18cfcf98]{width:100%;min-height:120px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:Monaco,Consolas,monospace;font-size:14px;line-height:1.3;resize:vertical;margin-bottom:4px}.textarea[data-v-18cfcf98]:focus{outline:none;border-color:#06f;box-shadow:0 0 0 2px #0066ff26}.buttons[data-v-18cfcf98]{display:flex;gap:8px}.btn[data-v-18cfcf98]{padding:4px 12px;border:1px solid;border-radius:4px;cursor:pointer;font-size:14px;transition:all .2s}.btn[data-v-18cfcf98]:disabled{opacity:.5;cursor:not-allowed}.save[data-v-18cfcf98]{background:#28a745;color:#fff;border-color:#28a745}.save[data-v-18cfcf98]:hover:not(:disabled){background:#218838}.cancel[data-v-18cfcf98]{background:#6c757d;color:#fff;border-color:#6c757d}.cancel[data-v-18cfcf98]:hover:not(:disabled){background:#5a6268}.warning[data-v-18cfcf98]{text-align:center;color:#e67e22;padding:8px}",uh=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},hm=uh(lm,[["styles",[cm]],["__scopeId","data-v-18cfcf98"]]),um={class:"piano-roll-root"},dm={key:0,class:"control-panel"},fm=["disabled"],gm=["disabled"],pm=["disabled"],mm=["disabled"],_m={class:"info"},vm={class:"piano-roll-layout"},ym={class:"stage-wrapper"},bm={key:1,class:"metadata-editor-wrapper"},dh=1/3,fh=1,gh=12,Sm=uh(is({__name:"PianoRollRoot",props:{width:{default:640,type:Number},height:{default:360,type:Number},initialNotes:{default:()=>[],type:Array},syncState:{type:Function},showControlPanel:{type:Boolean,default:!0},interactive:{type:Boolean,default:!0},wsAddress:{type:String}},emits:["notes-update"],setup(t,{expose:e,emit:n}){const i=t,r=hn({width:void 0,height:void 0,interactive:void 0,showControlPanel:void 0}),s=Dt(()=>r.width??i.width),o=Dt(()=>r.height??i.height),a=Dt(()=>r.interactive??i.interactive),l=Dt(()=>r.showControlPanel??i.showControlPanel),c=Dt(()=>s.value),h=Dt(()=>o.value),g=qt(),f=qt(null);let d=null;const p=Dt(()=>gh+fh),v=Dt(()=>Number.isFinite(f.value??NaN)?Math.max(0,f.value-p.value):null),w=Dt(()=>{const ot=c.value;if(!Number.isFinite(ot)||ot<=0)return 1;const St=(v.value??ot)/ot;return Number.isFinite(St)?Math.min(1,Math.max(dh,St)):1}),x=Dt(()=>Math.round(c.value*w.value)),m=Dt(()=>Math.round(h.value*w.value)),u=Dt(()=>Math.round(c.value*dh)),_=Dt(()=>Math.round(c.value+p.value)),S=Dt(()=>Math.round(u.value+p.value)),k=nu(null),O=n,b=$f();b.viewport=hn(b.viewport),b.grid=hn(b.grid);const C=qt(),T=qt(),A=qt(),D=qt(!1),L=qt(!1),U=qt(b.grid.subdivision),z=qt(!1),K=qt(null),y=qt(null),P=qt(b.notes.size),M=qt(b.selection.selectedIds.size),R=Dt(()=>a.value),F=Dt(()=>l.value),H=Dt(()=>K.value!==null&&R.value),G=Dt(()=>F.value&&z.value),Y=ot=>{if(ot==null)return{};try{return JSON.parse(JSON.stringify(ot))}catch{return ot}},it=()=>{if(P.value=b.notes.size,M.value=b.selection.selectedIds.size,b.selection.selectedIds.size===1){const[ot]=Array.from(b.selection.selectedIds),rt=b.notes.get(ot);K.value=rt?.id??null,y.value=rt?Y(rt.metadata):{}}else K.value=null,y.value=null},V=()=>{i.syncState?.(b)},N=()=>{q2(b,x.value,m.value,V)},$=()=>{Ks(b,x.value,m.value,V)},tt=(ot,rt)=>{Ys(b,ot,rt,x.value,m.value,V)},st=(ot,rt)=>{Xs(b,ot,rt,x.value,m.value,V)},ct=()=>j2(b,x.value),E=()=>Z2(b,m.value),I=new K2({state:b,horizontalTrack:T,isInteractive:()=>a.value,getViewportRange:ct,applyHorizontalZoom:tt,enforceScrollBounds:$,notifyViewportChange:V,getFallbackWidth:()=>x.value}),B=new Y2({state:b,verticalTrack:A,isInteractive:()=>a.value,getViewportRange:E,applyVerticalZoom:st,enforceScrollBounds:$,notifyViewportChange:V,getFallbackHeight:()=>m.value}),W=Dt(()=>I.getThumbStyle()),q=Dt(()=>B.getThumbStyle()),j=(ot,rt)=>{I.startDrag(ot,rt)},Q=()=>{I.stopDrag()},et=(ot,rt)=>{B.startDrag(ot,rt)},J=()=>{B.stopDrag()},X=ot=>{I.onTrackPointerDown(ot)},at=ot=>{B.onTrackPointerDown(ot)};Le(U,ot=>{b.grid.subdivision=ot,b.needsRedraw=!0,i.syncState?.(b)});const nt=(ot={})=>{const rt=ot.source??"notes";it();const St=Array.from(b.notes.entries());O("notes-update",St),i.syncState?.(b),k.value?.isConnected&&(!ot.suppressWsNotes&&rt==="notes"&&k.value.sendNotesUpdate(St,rt),k.value.sendStateUpdate(b,rt))};Le(F,ot=>{ot||(z.value=!1)});const lt=ot=>{if(!K.value)return;const rt=K.value,St=b.notes.get(rt);if(!St)return;const ge=ot??{},Qs=St.metadata??{};JSON.stringify(Qs)!==JSON.stringify(ge)&&b.command.stack?.executeCommand("Edit Note Metadata",()=>{const je=b.notes.get(rt);if(!je)return;const Ar=ge&&Object.keys(ge).length===0?void 0:ge,_h={...je,metadata:Ar};Ar||delete _h.metadata,b.notes.set(rt,_h),b.needsRedraw=!0})};b.notifyExternalChange=ot=>{nt({source:ot??"other"})};const{undo:ut,redo:dt,deleteSelected:_t,updateCommandStackButtons:pt,handleCommandStackUpdate:At}=X2({state:b,canUndo:D,canRedo:L,emitStateUpdate:nt}),xt=Q2({state:b,isInteractive:()=>a.value,undo:ut,redo:dt,deleteSelected:_t,updateCommandStackButtons:pt,executeOverlapChanges:Zs}),Pt=new J2({state:b,konvaContainer:C,initializeLayers:k2,setupEventHandlers:O2,renderGrid:E2,renderVisibleNotes:R2,renderResizeHandles:A2,updateQueuePlayheadPosition:M2,updateLivePlayheadPosition:I2,handleCommandStackUpdate:At,syncUiCounters:it,enforceScrollBounds:$,attachKeyboard:()=>xt.attach(),detachKeyboard:()=>xt.detach()});qo(()=>{g.value&&(d=new ResizeObserver(ot=>{const rt=ot[0];if(!rt)return;const ge=(Array.isArray(rt.contentBoxSize)?rt.contentBoxSize[0]:rt.contentBoxSize)?.inlineSize??rt.contentRect.width;Number.isFinite(ge)&&(f.value=ge)}),d.observe(g.value)),Pt.mount({width:x.value,height:m.value,interactive:a.value,initialNotes:i.initialNotes??[]}),i.wsAddress&&(k.value=new v2(i.wsAddress),k.value.setHandlers({onSetNotes:ot=>Bt(ot,{suppressWsNotes:!0}),onSetLivePlayhead:ot=>fe(ot),onFitZoomToNotes:()=>N(),onGetPlayStartPosition:ot=>{const rt=Se();k.value?.sendPlayStartPositionResponse(rt,ot)},onSetConfig:ot=>{ot.width!==void 0&&(r.width=ot.width),ot.height!==void 0&&(r.height=ot.height),ot.interactive!==void 0&&(r.interactive=ot.interactive),ot.showControlPanel!==void 0&&(r.showControlPanel=ot.showControlPanel)}}),k.value.connect())}),ss(()=>{Q(),J(),Pt.unmount(),k.value?.disconnect(),d?.disconnect(),d=null}),Le(a,ot=>{Pt.setInteractive(ot),ot||(Q(),J())}),Le([x,m],([ot,rt])=>{Pt.resize(ot,rt)});const Bt=(ot,rt={})=>{const St=new Set;b.notes.clear(),ot.forEach((ge,Qs)=>{let je=ge.id||`note_${Date.now()}_${Qs}`;for(;St.has(je);)je=`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;St.add(je);const Ar={...ge,id:je,velocity:ge.velocity??100};b.notes.set(je,Ar)}),b.needsRedraw=!0,nt({...rt,source:"notes"})},fe=ot=>{b.livePlayhead.position=Math.max(0,Math.min(ot,b.grid.maxLength)),b.needsRedraw=!0},Se=()=>b.queuePlayhead.position;return e({setNotes:Bt,setLivePlayheadPosition:fe,getPlayStartPosition:Se,fitZoomToNotes:N}),(ot,rt)=>(Ge(),tn("div",um,[mt("div",{ref_key:"sizeObserver",ref:g,class:"piano-roll-shell",style:we({maxWidth:_.value+"px",minWidth:S.value+"px","--scrollbar-thickness":gh+"px","--scrollbar-gap":fh+"px"})},[F.value?(Ge(),tn("div",dm,[mt("button",{onClick:rt[0]||(rt[0]=(...St)=>De(ut)&&De(ut)(...St)),disabled:!R.value||!D.value}," Undo",8,fm),mt("button",{onClick:rt[1]||(rt[1]=(...St)=>De(dt)&&De(dt)(...St)),disabled:!R.value||!L.value}," Redo",8,gm),rt[13]||(rt[13]=mt("span",{class:"separator"},"|",-1)),mt("label",null,[rt[12]||(rt[12]=gs(" Grid: ")),Ho(mt("select",{"onUpdate:modelValue":rt[2]||(rt[2]=St=>U.value=St),disabled:!R.value},rt[11]||(rt[11]=[mt("option",{value:4},"Quarter",-1),mt("option",{value:8},"Eighth",-1),mt("option",{value:16},"16th",-1),mt("option",{value:32},"32nd",-1)]),8,pm),[[jd,U.value,void 0,{number:!0}]])]),rt[14]||(rt[14]=mt("span",{class:"separator"},"|",-1)),mt("button",{onClick:rt[3]||(rt[3]=(...St)=>De(_t)&&De(_t)(...St)),disabled:!R.value||M.value===0},"  Delete ",8,mm),rt[15]||(rt[15]=mt("span",{class:"separator"},"|",-1)),mt("button",{class:Ze(["metadata-toggle",{active:z.value}]),onClick:rt[4]||(rt[4]=St=>z.value=!z.value)},"  Metadata ",2),rt[16]||(rt[16]=mt("span",{class:"separator"},"|",-1)),mt("span",_m,zr(P.value)+" notes, "+zr(M.value)+" selected",1)])):lr("",!0),mt("div",vm,[mt("div",ym,[mt("div",{ref_key:"konvaContainer",ref:C,class:Ze(["piano-roll-container",{"is-disabled":!R.value}]),style:we({width:x.value+"px",height:m.value+"px"})},null,6),mt("div",{ref_key:"horizontalTrack",ref:T,class:Ze(["scrollbar horizontal",{"is-disabled":!R.value}]),style:we({width:x.value+"px"}),onPointerdown:Be(X,["self"])},[mt("div",{class:"scrollbar-thumb horizontal-thumb",style:we(W.value)},[mt("div",{class:"scrollbar-handle handle-left",onPointerdown:rt[5]||(rt[5]=Be(St=>j("resize-start",St),["stop","prevent"]))},null,32),mt("div",{class:"scrollbar-body",onPointerdown:rt[6]||(rt[6]=Be(St=>j("move",St),["stop","prevent"]))},null,32),mt("div",{class:"scrollbar-handle handle-right",onPointerdown:rt[7]||(rt[7]=Be(St=>j("resize-end",St),["stop","prevent"]))},null,32)],4)],38)]),mt("div",{ref_key:"verticalTrack",ref:A,class:Ze(["scrollbar vertical",{"is-disabled":!R.value}]),style:we({height:m.value+"px"}),onPointerdown:Be(at,["self"])},[mt("div",{class:"scrollbar-thumb vertical-thumb",style:we(q.value)},[mt("div",{class:"scrollbar-handle handle-top",onPointerdown:rt[8]||(rt[8]=Be(St=>et("resize-start",St),["stop","prevent"]))},null,32),mt("div",{class:"scrollbar-body vertical-body",onPointerdown:rt[9]||(rt[9]=Be(St=>et("move",St),["stop","prevent"]))},null,32),mt("div",{class:"scrollbar-handle handle-bottom",onPointerdown:rt[10]||(rt[10]=Be(St=>et("resize-end",St),["stop","prevent"]))},null,32)],4)],38)]),F.value?(Ge(),tn("div",bm,[de(hm,{visible:G.value,metadata:y.value??void 0,"can-edit":H.value,onApply:lt},null,8,["visible","metadata","can-edit"])])):lr("",!0)],4)]))}}),[["styles",[".piano-roll-root[data-v-5d21d098]{display:flex;flex-direction:column;align-items:center;padding:8px 10px}.piano-roll-shell[data-v-5d21d098]{width:100%;display:flex;flex-direction:column;align-items:center;gap:10px;margin:0 auto}.control-panel[data-v-5d21d098]{background:#fff;border:1px solid #ccc;border-radius:8px;padding:6px 8px;display:flex;align-items:center;flex-wrap:wrap;column-gap:6px;row-gap:6px;align-self:stretch;box-sizing:border-box;justify-content:center;box-shadow:0 2px 10px #0000001a}.control-panel button[data-v-5d21d098]{background:#f0f0f0;border:1px solid #ccc;border-radius:4px;padding:4px 10px;cursor:pointer;font-size:14px;transition:all .2s}.control-panel button[data-v-5d21d098]:hover:not(:disabled){background:#e0e0e0}.control-panel button[data-v-5d21d098]:disabled{opacity:.5;cursor:not-allowed}.separator[data-v-5d21d098]{color:#ccc}.metadata-toggle[data-v-5d21d098]{display:flex;align-items:center;gap:6px}.metadata-toggle.active[data-v-5d21d098]{background:#d6eaff;border-color:#6aa8ff;color:#0b5394}.info[data-v-5d21d098]{color:#666;font-size:14px}.piano-roll-container[data-v-5d21d098]{background-color:#fff;border:1px solid black;cursor:default;box-sizing:border-box;border-radius:8px}.piano-roll-container.is-disabled[data-v-5d21d098]{pointer-events:none;cursor:not-allowed}.piano-roll-layout[data-v-5d21d098]{display:flex;align-items:flex-start;gap:var(--scrollbar-gap)}.stage-wrapper[data-v-5d21d098]{display:flex;flex-direction:column;gap:var(--scrollbar-gap);align-items:stretch}.scrollbar[data-v-5d21d098]{position:relative;background:#f5f5f5;border:1px solid #ccc;border-radius:10px;box-sizing:border-box;user-select:none;touch-action:none}.scrollbar.horizontal[data-v-5d21d098]{height:var(--scrollbar-thickness)}.scrollbar.vertical[data-v-5d21d098]{width:var(--scrollbar-thickness)}.scrollbar.is-disabled[data-v-5d21d098]{opacity:.45;pointer-events:none}.scrollbar-thumb[data-v-5d21d098]{position:absolute;background:#0000002e;border-radius:6px;display:flex;align-items:center;justify-content:space-between;min-width:calc(var(--scrollbar-thickness) * .66);min-height:calc(var(--scrollbar-thickness) * .66);cursor:grab;transition:background .15s ease;box-sizing:border-box}.scrollbar-thumb.horizontal-thumb[data-v-5d21d098]{top:0;height:100%;align-items:stretch}.scrollbar-thumb.vertical-thumb[data-v-5d21d098]{left:0;width:100%;flex-direction:column;justify-content:space-between;align-items:stretch}.scrollbar-thumb[data-v-5d21d098]:hover{background:#00000040}.scrollbar-body[data-v-5d21d098]{flex:1;height:100%;cursor:grab}.scrollbar-body.vertical-body[data-v-5d21d098]{width:100%}.scrollbar-handle[data-v-5d21d098]{background:#00000059;border-radius:4px;flex:0 0 auto}.handle-left[data-v-5d21d098],.handle-right[data-v-5d21d098]{width:calc(var(--scrollbar-thickness) / 3);height:100%;cursor:ew-resize}.handle-top[data-v-5d21d098],.handle-bottom[data-v-5d21d098]{width:100%;height:calc(var(--scrollbar-thickness) / 3);cursor:ns-resize}label[data-v-5d21d098]{display:flex;align-items:center;gap:5px;font-size:14px}select[data-v-5d21d098]{padding:3px 8px;border:1px solid #ccc;border-radius:4px;font-size:14px;cursor:pointer}.metadata-editor-wrapper[data-v-5d21d098]{width:100%;display:flex;justify-content:center}"]],["__scopeId","data-v-5d21d098"]]),ph="piano-roll-component",mh=$d(Sm);return customElements.get(ph)||customElements.define(ph,mh),Nr.PianoRollElement=mh,Object.defineProperty(Nr,Symbol.toStringTag,{value:"Module"}),Nr}({});
